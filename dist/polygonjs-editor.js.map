{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/engine/nodes/utils/params/ParamsConfig.ts","webpack:///./src/engine/nodes/sop/_Base.ts","webpack:///./src/engine/poly/InputCloneMode.ts","webpack:///./src/editor/store/controllers/StoreController.ts","webpack:///./src/engine/poly/ParamType.ts","webpack:///./src/engine/poly/NodeContext.ts","webpack:///./src/core/geometry/Constant.ts","webpack:///./src/core/String.ts","webpack:///./src/engine/poly/NodeEvent.ts","webpack:///./src/core/geometry/Geometry.ts","webpack:///./src/engine/Poly.ts","webpack:///./src/core/graph/CoreGraphNode.ts","webpack:///./src/engine/expressions/methods/_Base.ts","webpack:///./src/engine/nodes/_Base.ts","webpack:///./modules/three/examples/jsm/postprocessing/Pass.js","webpack:///./src/engine/nodes/mat/_Base.ts","webpack:///./src/engine/nodes/obj/_Base.ts","webpack:///./src/engine/params/_Base.ts","webpack:///./src/engine/nodes/obj/utils/TransformController.ts","webpack:///./src/engine/poly/ParamEvent.ts","webpack:///./src/engine/nodes/utils/connections/ConnectionPointType.ts","webpack:///./src/core/Walker.ts","webpack:///./src/engine/nodes/utils/FlagsController.ts","webpack:///./src/engine/nodes/utils/shaders/ShaderName.ts","webpack:///./src/core/Transform.ts","webpack:///./src/core/math/_Module.ts","webpack:///./src/engine/nodes/utils/ContainerController.ts","webpack:///./src/core/geometry/Attribute.ts","webpack:///./src/engine/params/Ramp.ts","webpack:///./src/engine/containers/_Base.ts","webpack:///./src/engine/params/_Multiple.ts","webpack:///./src/engine/nodes/utils/connections/NamedConnectionPoint.ts","webpack:///./src/editor/components/panels/params/components/fields/mixins/FieldCommon.ts","webpack:///./src/engine/poly/registers/Category.ts","webpack:///./src/engine/nodes/gl/_Base.ts","webpack:///./src/engine/io/json/export/Param.ts","webpack:///./src/engine/nodes/obj/utils/cameras/background/_BaseController.ts","webpack:///./src/core/ThreeToGl.ts","webpack:///./src/editor/components/panels/network/helpers/Constants.ts","webpack:///./src/editor/components/panels/params/components/mixins/ContextMenu.ts","webpack:///./src/engine/nodes/cop/_Base.ts","webpack:///./src/engine/nodes/cop/File.ts","webpack:///./src/engine/nodes/gl/utils/GLDefinition.ts","webpack:///./src/engine/nodes/mat/utils/ColorsController.ts","webpack:///./src/engine/nodes/mat/utils/SideController.ts","webpack:///./src/engine/nodes/gl/code/assemblers/_BaseRender.ts","webpack:///./src/core/MapUtils.ts","webpack:///./src/editor/history/commands/_Base.ts","webpack:///./src/engine/params/_Numeric.ts","webpack:///./src/engine/poly/Assert.ts","webpack:///./src/editor/history/commands/ParamSet.ts","webpack:///./src/engine/nodes/mat/utils/_BaseController.ts","webpack:///./src/engine/nodes/mat/utils/SkinningController.ts","webpack:///./src/engine/nodes/mat/utils/TextureMapController.ts","webpack:///./src/engine/nodes/mat/utils/TextureAlphaMapController.ts","webpack:///./src/engine/io/json/export/Dispatcher.ts","webpack:///./src/engine/io/json/export/Scene.ts","webpack:///./src/engine/nodes/obj/_BaseLightTransformed.ts","webpack:///./src/engine/nodes/obj/utils/helpers/_BaseLightHelper.ts","webpack:///./src/engine/nodes/obj/utils/HelperController.ts","webpack:///./src/engine/nodes/obj/_BaseManager.ts","webpack:///./src/engine/nodes/obj/utils/LayersController.ts","webpack:///./src/engine/nodes/obj/utils/cameras/PostProcessController.ts","webpack:///./src/engine/io/json/import/Param.ts","webpack:///./src/engine/params/String.ts","webpack:///./src/core/geometry/Material.ts","webpack:///./src/core/Dom.ts","webpack:///./src/engine/nodes/utils/NameController.ts","webpack:///./src/core/DecomposedPath.ts","webpack:///./src/core/Object.ts","webpack:///./src/engine/expressions/traversers/_Base.ts","webpack:///./src/engine/nodes/event/CameraOrbitControls.ts","webpack:///./src/engine/nodes/gl/Attribute.ts","webpack:///./src/engine/nodes/mat/utils/_BaseTextureController.ts","webpack:///./src/engine/nodes/gl/code/utils/LineType.ts","webpack:///./src/engine/nodes/obj/_BaseLight.ts","webpack:///./src/core/geometry/Object.ts","webpack:///./modules/three/examples/jsm/utils/BufferGeometryUtils.js","webpack:///./src/core/geometry/util/Curve.ts","webpack:///./src/core/EventHelper.ts","webpack:///./src/editor/components/panels/params/components/fields/mixins/GlobalSliderOwner.ts","webpack:///./src/engine/params/Float.ts","webpack:///./src/engine/params/OperatorPath.ts","webpack:///./src/engine/nodes/gl/code/globals/Geometry.ts","webpack:///./src/engine/io/code/export/Param.ts","webpack:///./src/editor/helpers/Clipboard.ts","webpack:///./src/editor/components/panels/params/components/fields/Numeric.vue","webpack:///./src/engine/scene/PolyScene.ts","webpack:///./src/engine/nodes/utils/Serializer.ts","webpack:///./src/engine/params/types/ParamConstructorByType.ts","webpack:///./src/engine/params/utils/ExpressionController.ts","webpack:///./src/engine/expressions/traversers/ParsedTree.ts","webpack:///./src/core/math/Easing.ts","webpack:///./src/engine/nodes/utils/flags/Base.ts","webpack:///./modules/three/examples/jsm/controls/OrbitControls.js","webpack:///./src/engine/nodes/gl/Globals.ts","webpack:///./src/engine/nodes/gl/utils/GLDefinitionCollection.ts","webpack:///./src/engine/nodes/utils/code/controllers/ParamConfigsController.ts","webpack:///./src/engine/nodes/obj/_BaseCamera.ts","webpack:///./src/core/geometry/Group.ts","webpack:///./src/core/geometry/Point.ts","webpack:///./src/core/geometry/Entity.ts","webpack:///./src/core/Iterator.ts","webpack:///./src/core/geometry/util/Circle.ts","webpack:///./src/core/loader/geometry/JsonData.ts","webpack:///./modules/three/examples/jsm/loaders/DRACOLoader.js","webpack:///./src/core/geometry/operation/Skin.ts","webpack:///./src/engine/io/json/import/Dispatcher.ts","webpack:///./src/engine/io/code/export/Dispatcher.ts","webpack:///./src/engine/params/Integer.ts","webpack:///./src/engine/params/ramp/RampValue.ts","webpack:///./src/engine/poly/SceneEvent.ts","webpack:///./src/engine/nodes/gl/code/assemblers/_Base.ts","webpack:///./src/engine/nodes/utils/shaders/NodeTraverser.ts","webpack:///./src/engine/nodes/gl/code/globals/_Base.ts","webpack:///./src/engine/nodes/gl/code/utils/NodeFinder.ts","webpack:///./src/engine/nodes/gl/code/Controller.ts","webpack:///./src/engine/nodes/sop/Cache.ts","webpack:///./src/editor/components/widgets/DropDownMenu.vue","webpack:///./src/editor/components/widgets/dialogs/Modal.vue","webpack:///./src/editor/components/panels/params/components/fields/mixins/MultipleParamCommon.ts","webpack:///./src/editor/components/editor/Editor.vue?e972","webpack:///./src/editor/components/editor/Editor.vue?b8c7","webpack:///./src/editor/components/editor/top/Top.vue?9b78","webpack:///./src/editor/components/editor/top/Top.vue?3acf","webpack:///./src/editor/components/widgets/DropDownMenu.vue?2262","webpack:///./src/editor/components/widgets/DropDownMenu.vue?d9d1","webpack:///./src/editor/components/widgets/DropDownMenu.vue?85af","webpack:///./src/editor/components/editor/top/Top.vue?dc9b","webpack:///./src/editor/components/widgets/dialogs/Alert.vue?9850","webpack:///./src/editor/components/widgets/dialogs/Alert.vue?720e","webpack:///./src/editor/components/widgets/dialogs/Modal.vue?e92d","webpack:///./src/editor/components/widgets/dialogs/Modal.vue?3940","webpack:///./src/editor/components/widgets/dialogs/Modal.vue?006d","webpack:///./src/editor/components/widgets/dialogs/Alert.vue?2458","webpack:///./src/editor/components/widgets/dialogs/Confirm.vue?51c4","webpack:///./src/editor/components/widgets/dialogs/Confirm.vue?1cac","webpack:///./src/editor/components/widgets/dialogs/Confirm.vue?896a","webpack:///./src/editor/components/widgets/dialogs/Prompt.vue?d3bd","webpack:///./src/editor/components/widgets/dialogs/Prompt.vue?3d2d","webpack:///./src/editor/components/widgets/dialogs/Prompt.vue?8566","webpack:///./src/editor/components/panels/multiple/Multiple.vue?a422","webpack:///./src/editor/components/panels/multiple/Multiple.vue?462c","webpack:///./src/editor/components/panels/network/Network.vue?8390","webpack:///./src/editor/components/panels/network/Network.vue?97d6","webpack:///./src/editor/components/panels/network/components/TabMenu.vue?c4b8","webpack:///./src/editor/components/panels/network/components/TabMenu.vue?9bc6","webpack:///./src/editor/components/panels/network/components/TabMenu.vue?0dc5","webpack:///./src/editor/components/panels/network/components/Node.vue?addc","webpack:///./src/editor/components/panels/network/components/Node.vue?800a","webpack:///./src/editor/components/panels/network/components/Connection.vue?d0c3","webpack:///./src/editor/components/panels/network/components/Connection.vue?c3c3","webpack:///./src/editor/components/panels/network/components/Connection.vue?ecb4","webpack:///./src/editor/components/panels/network/components/NodeInfo.vue?7218","webpack:///./src/editor/components/panels/network/components/NodeInfo.vue?cc94","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Sop.vue?2ba6","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Sop.vue?cdec","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Sop.vue?47db","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Mat.vue?ac48","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Mat.vue?8176","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Mat.vue?1a57","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Gl.vue?f867","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Gl.vue?7d91","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Gl.vue?0cae","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Cop.vue?d9b7","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Cop.vue?2a84","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Cop.vue?9a41","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue?a135","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue?eb85","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue?0136","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue?6f62","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue?89cf","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue?d445","webpack:///./src/editor/components/panels/network/components/NodeInfo.vue?f242","webpack:///./src/editor/components/panels/network/components/Node.vue?ec06","webpack:///./src/editor/components/panels/network/components/InterractiveConnection.vue?43a8","webpack:///./src/editor/components/panels/network/components/InterractiveConnection.vue?c3d5","webpack:///./src/editor/components/panels/network/components/InterractiveConnection.vue?aaa4","webpack:///./src/editor/components/panels/network/Network.vue?dc39","webpack:///./src/editor/components/panels/params/Params.vue?28d3","webpack:///./src/editor/components/panels/params/Params.vue?2316","webpack:///./src/editor/components/panels/params/components/Param.vue?980e","webpack:///./src/editor/components/panels/params/components/Param.vue?292a","webpack:///./src/editor/components/panels/params/components/fields/Boolean.vue?c25c","webpack:///./src/editor/components/panels/params/components/fields/Boolean.vue?1803","webpack:///./src/editor/components/panels/params/components/fields/Numeric.vue?31f4","webpack:///./src/editor/components/panels/params/components/fields/Numeric.vue?80aa","webpack:///./src/editor/components/panels/params/components/fields/Boolean.vue?9558","webpack:///./src/editor/components/panels/params/components/fields/Button.vue?6447","webpack:///./src/editor/components/panels/params/components/fields/Button.vue?7a96","webpack:///./src/editor/components/panels/params/components/fields/Button.vue?e019","webpack:///./src/editor/components/panels/params/components/fields/Color.vue?d2a3","webpack:///./src/editor/components/panels/params/components/fields/Color.vue?7c48","webpack:///./src/editor/components/panels/params/components/fields/Color.vue?9581","webpack:///./src/editor/components/panels/params/components/fields/Float.vue?f26e","webpack:///./src/editor/components/panels/params/components/fields/Float.vue?71a4","webpack:///./src/editor/components/panels/params/components/fields/Float.vue?a02f","webpack:///./src/editor/components/panels/params/components/fields/Folder.vue?3c30","webpack:///./src/editor/components/panels/params/components/fields/Folder.vue?cfed","webpack:///./src/editor/components/panels/params/components/fields/Folder.vue?5d4a","webpack:///./src/editor/components/panels/params/components/fields/Integer.vue?ed70","webpack:///./src/editor/components/panels/params/components/fields/Integer.vue?81cd","webpack:///./src/editor/components/panels/params/components/fields/Integer.vue?99fa","webpack:///./src/editor/components/panels/params/components/fields/OperatorPath.vue?d48f","webpack:///./src/editor/components/panels/params/components/fields/OperatorPath.vue?98ac","webpack:///./src/editor/components/panels/params/components/fields/OperatorPath.vue?c38e","webpack:///./src/editor/components/panels/params/components/fields/Radio.vue?b311","webpack:///./src/editor/components/panels/params/components/fields/Radio.vue?6986","webpack:///./src/editor/components/panels/params/components/fields/Radio.vue?1d44","webpack:///./src/editor/components/panels/params/components/fields/Separator.vue?fce6","webpack:///./src/editor/components/panels/params/components/fields/Separator.vue?6f6b","webpack:///./src/editor/components/panels/params/components/fields/Separator.vue?4610","webpack:///./src/editor/components/panels/params/components/fields/String.vue?8890","webpack:///./src/editor/components/panels/params/components/fields/String.vue?a627","webpack:///./src/editor/components/panels/params/components/fields/String.vue?3bc3","webpack:///./src/editor/components/panels/params/components/fields/Vector2.vue?b384","webpack:///./src/editor/components/panels/params/components/fields/Vector2.vue?66b3","webpack:///./src/editor/components/panels/params/components/fields/Vector2.vue?44fc","webpack:///./src/editor/components/panels/params/components/fields/Vector3.vue?996d","webpack:///./src/editor/components/panels/params/components/fields/Vector3.vue?df29","webpack:///./src/editor/components/panels/params/components/fields/Vector3.vue?1623","webpack:///./src/editor/components/panels/params/components/fields/Vector4.vue?62fa","webpack:///./src/editor/components/panels/params/components/fields/Vector4.vue?875e","webpack:///./src/editor/components/panels/params/components/fields/Vector4.vue?a814","webpack:///./src/editor/components/panels/params/components/fields/Ramp.vue?3c6a","webpack:///./src/editor/components/panels/params/components/fields/Ramp.vue?8ee0","webpack:///./src/editor/components/panels/params/components/fields/Ramp.vue?298b","webpack:///./src/editor/components/panels/params/components/Param.vue?0e8b","webpack:///./src/editor/components/panels/params/Params.vue?bafe","webpack:///./src/editor/components/panels/viewer/Viewer.vue?c65a","webpack:///./src/editor/components/panels/viewer/Viewer.vue?0bc4","webpack:///./src/editor/components/panels/viewer/components/Threejs.vue?8468","webpack:///./src/editor/components/panels/viewer/components/Threejs.vue?907a","webpack:///./src/editor/components/panels/viewer/components/Threejs.vue?0bc5","webpack:///./src/editor/components/panels/viewer/Viewer.vue?4916","webpack:///./src/editor/components/panels/spreadsheet/Spreadsheet.vue?f2cf","webpack:///./src/editor/components/panels/spreadsheet/Spreadsheet.vue?bb2e","webpack:///./src/editor/components/panels/spreadsheet/Spreadsheet.vue?26ed","webpack:///./src/editor/components/panels/multiple/Multiple.vue?f984","webpack:///./src/editor/components/editor/top/Navigation.vue?6979","webpack:///./src/editor/components/editor/top/Navigation.vue?bc19","webpack:///./src/editor/components/editor/top/Navigation.vue?5d81","webpack:///./src/editor/components/editor/widgets/PlayBar.vue?b4dd","webpack:///./src/editor/components/editor/widgets/PlayBar.vue?e9b7","webpack:///./src/editor/components/editor/widgets/PlayBar.vue?8b0e","webpack:///./src/editor/components/editor/widgets/PanelNodeSelector.vue?7e3e","webpack:///./src/editor/components/editor/widgets/PanelNodeSelector.vue?ee3b","webpack:///./src/editor/components/widgets/NodeTree.vue?eccc","webpack:///./src/editor/components/widgets/NodeTree.vue?53ed","webpack:///./src/editor/components/widgets/NodeTree.vue?6e14","webpack:///./src/editor/components/editor/widgets/PanelNodeSelector.vue?11b9","webpack:///./src/editor/components/widgets/NumericSlider.vue?a75e","webpack:///./src/editor/components/widgets/NumericSlider.vue?6cf9","webpack:///./src/editor/components/widgets/NumericSlider.vue?1ad3","webpack:///./src/editor/components/widgets/context_menus/NodeContextMenu.vue?07b5","webpack:///./src/editor/components/widgets/context_menus/NodeContextMenu.vue?31ec","webpack:///./src/editor/components/widgets/context_menus/NodeContextMenu.vue?9595","webpack:///./src/editor/components/widgets/context_menus/ParamContextMenu.vue?be00","webpack:///./src/editor/components/widgets/context_menus/ParamContextMenu.vue?afd7","webpack:///./src/editor/components/widgets/context_menus/ParamContextMenu.vue?2990","webpack:///./src/editor/components/editor/widgets/Retractable.vue?3288","webpack:///./src/editor/components/editor/widgets/Retractable.vue?4085","webpack:///./src/editor/components/editor/widgets/Retractable.vue?9bc8","webpack:///./src/editor/components/editor/Editor.vue?f591","webpack:///./modules/three/examples/jsm/libs/inflate.module.min.js","webpack:///./src/engine/scene/utils/CamerasController.ts","webpack:///./src/engine/scene/utils/Cooker.ts","webpack:///./src/core/graph/CoreGraph.ts","webpack:///./src/engine/scene/utils/CookController.ts","webpack:///./src/engine/scene/utils/EventsController.ts","webpack:///./src/engine/poly/RenderersController.ts","webpack:///./src/engine/poly/NodesRegister.ts","webpack:///./src/engine/scene/utils/LifeCycleController.ts","webpack:///./src/engine/scene/utils/LoadingController.ts","webpack:///./src/engine/expressions/MissingReferencesController.ts","webpack:///./src/engine/expressions/MissingReference.ts","webpack:///./src/engine/scene/utils/NodesController.ts","webpack:///./src/engine/nodes/manager/ObjectsManager.ts","webpack:///./src/engine/nodes/manager/_Base.ts","webpack:///./src/core/graph/DirtyController.ts","webpack:///./src/engine/nodes/utils/UIData.ts","webpack:///./src/engine/nodes/utils/StatesController.ts","webpack:///./src/engine/nodes/utils/states/TimeDependent.ts","webpack:///./src/engine/nodes/utils/states/Error.ts","webpack:///./src/engine/nodes/utils/hierarchy/ParentController.ts","webpack:///./src/core/WalkerEmbed.ts","webpack:///./src/engine/nodes/utils/hierarchy/ChildrenController.ts","webpack:///./src/core/NodeSelection.ts","webpack:///./src/engine/nodes/utils/LifeCycleController.ts","webpack:///./src/engine/nodes/utils/CookController.ts","webpack:///./src/engine/nodes/utils/DependenciesController.ts","webpack:///./src/engine/params/utils/OptionsController.ts","webpack:///./src/engine/params/utils/EmitController.ts","webpack:///./src/engine/params/utils/Serializer.ts","webpack:///./src/engine/params/utils/StatesController.ts","webpack:///./src/engine/params/utils/states/TimeDependent.ts","webpack:///./src/engine/params/utils/states/Error.ts","webpack:///./src/engine/nodes/utils/params/ParamsController.ts","webpack:///./src/engine/params/Boolean.ts","webpack:///./src/engine/expressions/ExpressionManager.ts","webpack:///./src/engine/expressions/traversers/FunctionGenerator.ts","webpack:///./src/engine/expressions/LiteralConstructsController.ts","webpack:///./src/engine/expressions/methods/_Module.ts","webpack:///./src/engine/expressions/methods/bbox.ts","webpack:///./src/engine/expressions/MethodDependency.ts","webpack:///./src/engine/expressions/methods/centroid.ts","webpack:///./src/engine/expressions/methods/ch.ts","webpack:///./src/engine/expressions/methods/copy.ts","webpack:///./src/engine/expressions/methods/cop_res.ts","webpack:///./src/engine/expressions/methods/local.ts","webpack:///./src/engine/expressions/methods/opdigits.ts","webpack:///./src/engine/expressions/methods/point.ts","webpack:///./src/engine/expressions/methods/points_count.ts","webpack:///./src/engine/expressions/methods/str_chars_count.ts","webpack:///./src/engine/expressions/methods/str_concat.ts","webpack:///./src/engine/expressions/methods/str_index.ts","webpack:///./src/engine/expressions/methods/str_sub.ts","webpack:///./src/engine/expressions/AttributeRequirementsController.ts","webpack:///./src/engine/expressions/traversers/ExpressionStringGenerator.ts","webpack:///./src/engine/expressions/DependenciesController.ts","webpack:///./src/engine/params/Button.ts","webpack:///./src/engine/params/Color.ts","webpack:///./src/engine/params/Folder.ts","webpack:///./src/engine/params/Separator.ts","webpack:///./src/engine/params/Vector2.ts","webpack:///./src/engine/params/Vector3.ts","webpack:///./src/engine/params/Vector4.ts","webpack:///./src/engine/nodes/utils/params/ParamsValueAccessor.ts","webpack:///./src/engine/nodes/utils/ProcessingContext.ts","webpack:///./src/engine/nodes/utils/connections/IOController.ts","webpack:///./src/engine/nodes/utils/connections/ConnectionsController.ts","webpack:///./src/engine/nodes/utils/connections/InputsController.ts","webpack:///./src/engine/nodes/utils/connections/NodeConnection.ts","webpack:///./src/engine/nodes/utils/connections/OutputsController.ts","webpack:///./src/engine/nodes/utils/params/ParamsAccessor.ts","webpack:///./src/engine/containers/Manager.ts","webpack:///./src/core/performance/CorePerformance.ts","webpack:///./src/core/performance/PerformanceNode.ts","webpack:///./src/engine/scene/utils/TimeController.ts","webpack:///./src/engine/scene/utils/Serializer.ts","webpack:///./src/engine/scene/utils/UniformsController.ts","webpack:///./src/engine/scene/utils/WebGLController.ts","webpack:///./src/engine/poly/registers/All.ts","webpack:///./src/engine/poly/registers/Cop.ts","webpack:///./src/engine/nodes/cop/EnvMap.ts","webpack:///./src/engine/containers/Texture.ts","webpack:///./src/engine/nodes/utils/flags/Bypass.ts","webpack:///./src/engine/nodes/utils/flags/Display.ts","webpack:///./src/core/loader/Texture.ts","webpack:///./modules/three/examples/jsm/loaders/RGBELoader.js","webpack:///./modules/three/examples/jsm/loaders/BasisTextureLoader.js","webpack:///./src/engine/nodes/cop/Null.ts","webpack:///./src/engine/nodes/cop/Switch.ts","webpack:///./src/engine/poly/registers/Event.ts","webpack:///./src/engine/nodes/event/CameraMapControls.ts","webpack:///./src/engine/nodes/event/_BaseCameraControls.ts","webpack:///./src/engine/nodes/event/_Base.ts","webpack:///./src/engine/containers/Event.ts","webpack:///./src/engine/poly/registers/Gl.ts","webpack:///./src/engine/nodes/utils/params/ParamValueToDefaultConverter.ts","webpack:///./src/engine/nodes/gl/Constant.ts","webpack:///./src/engine/nodes/gl/FloatToVec3.ts","webpack:///./src/engine/nodes/gl/Output.ts","webpack:///./src/engine/nodes/gl/Param.ts","webpack:///./src/engine/nodes/utils/code/configs/ParamConfig.ts","webpack:///./src/engine/poly/registers/Mat.ts","webpack:///./src/engine/nodes/mat/MeshBasic.ts","webpack:///./src/engine/containers/Material.ts","webpack:///./src/engine/nodes/mat/MeshBasicBuilder.ts","webpack:///./src/engine/nodes/gl/code/assemblers/Basic.ts","webpack:///./src/engine/nodes/gl/code/assemblers/_BaseMesh.ts","webpack:///./src/engine/nodes/gl/code/configs/ShaderConfig.ts","webpack:///./src/engine/nodes/gl/code/configs/VariableConfig.ts","webpack:///./src/engine/nodes/gl/code/utils/CodeBuilder.ts","webpack:///./src/engine/nodes/gl/code/utils/ShadersCollectionController.ts","webpack:///./src/engine/nodes/gl/code/utils/LinesController.ts","webpack:///./src/engine/nodes/gl/code/utils/CodeFormatter.ts","webpack:///./src/engine/nodes/utils/shaders/BaseAssembler.ts","webpack:///./src/engine/nodes/gl/code/assemblers/CustomMeshDistance.ts","webpack:///./src/engine/nodes/gl/code/assemblers/CustomMeshDepth.ts","webpack:///./src/engine/nodes/gl/code/assemblers/CustomMeshDepthDOF.ts","webpack:///./src/engine/nodes/gl/code/templates/CustomMeshDepthDOF.vert.glsl","webpack:///./src/engine/nodes/gl/code/templates/CustomMeshDepthDOF.frag.glsl","webpack:///./src/engine/nodes/mat/_BaseBuilder.ts","webpack:///./src/engine/io/json/export/Node.ts","webpack:///./src/engine/io/json/export/param/Multiple.ts","webpack:///./src/engine/io/json/export/param/Numeric.ts","webpack:///./src/engine/io/json/export/param/OperatorPath.ts","webpack:///./src/engine/io/json/export/param/String.ts","webpack:///./src/engine/io/json/export/param/Ramp.ts","webpack:///./src/engine/nodes/mat/MeshLambert.ts","webpack:///./src/engine/nodes/mat/MeshStandard.ts","webpack:///./src/engine/nodes/mat/utils/TextureEnvMapController.ts","webpack:///./src/engine/nodes/mat/Points.ts","webpack:///./src/engine/poly/registers/Obj.ts","webpack:///./src/engine/nodes/obj/AmbientLight.ts","webpack:///./src/engine/containers/Object.ts","webpack:///./src/engine/nodes/obj/AreaLight.ts","webpack:///./src/engine/nodes/obj/DirectionalLight.ts","webpack:///./src/engine/nodes/obj/utils/helpers/DirectionalLightHelper.ts","webpack:///./src/engine/nodes/obj/HemisphereLight.ts","webpack:///./src/engine/nodes/obj/utils/helpers/HemisphereLightHelper.ts","webpack:///./src/engine/nodes/obj/PointLight.ts","webpack:///./src/engine/nodes/obj/utils/helpers/PointLightHelper.ts","webpack:///./src/engine/nodes/obj/SpotLight.ts","webpack:///./src/engine/nodes/obj/utils/helpers/SpotLightHelper.ts","webpack:///./src/engine/nodes/obj/Events.ts","webpack:///./src/engine/nodes/obj/Materials.ts","webpack:///./src/engine/nodes/obj/Cop.ts","webpack:///./src/engine/nodes/obj/PostProcess.ts","webpack:///./src/engine/nodes/obj/Geo.ts","webpack:///./src/engine/nodes/utils/DisplayNodeController.ts","webpack:///./src/engine/nodes/obj/Null.ts","webpack:///./src/engine/nodes/obj/Fog.ts","webpack:///./src/engine/nodes/obj/OrthographicCamera.ts","webpack:///./src/engine/nodes/obj/utils/cameras/ControlsController.ts","webpack:///./src/engine/nodes/event/utils/CameraControlConfig.ts","webpack:///./modules/three/examples/jsm/postprocessing/RenderPass.js","webpack:///./src/engine/viewers/Threejs.ts","webpack:///./src/engine/viewers/_Base.ts","webpack:///./src/engine/viewers/utils/CamerasController.ts","webpack:///./src/engine/viewers/utils/ControlsController.ts","webpack:///./src/engine/viewers/utils/EventsController.ts","webpack:///./src/engine/viewers/utils/WebglController.ts","webpack:///./src/engine/nodes/obj/utils/cameras/background/OrthographicCameraController.ts","webpack:///./src/engine/nodes/obj/PerspectiveCamera.ts","webpack:///./src/engine/nodes/obj/utils/cameras/background/PerspectiveCameraController.ts","webpack:///./src/engine/poly/registers/Sop.ts","webpack:///./src/engine/nodes/sop/Add.ts","webpack:///./src/core/geometry/Face.ts","webpack:///./src/core/geometry/MonkeyPatcher.ts","webpack:///./src/engine/containers/Geometry.ts","webpack:///./src/engine/nodes/sop/AnimationCopy.ts","webpack:///./src/engine/nodes/sop/AnimationMixer.ts","webpack:///./src/engine/nodes/sop/AttribAddMult.ts","webpack:///./src/engine/nodes/sop/AttribCopy.ts","webpack:///./src/engine/nodes/sop/AttribCreate.ts","webpack:///./src/engine/nodes/sop/AttribDelete.ts","webpack:///./src/engine/nodes/sop/AttribNormalize.ts","webpack:///./src/engine/nodes/sop/AttribPromote.ts","webpack:///./src/engine/nodes/sop/AttribRemap.ts","webpack:///./src/engine/nodes/sop/AttribRename.ts","webpack:///./src/engine/nodes/sop/AttribTransfer.ts","webpack:///./src/core/math/Interpolate.ts","webpack:///./src/core/math/octree/Octree.ts","webpack:///./src/core/math/octree/Node.ts","webpack:///./src/engine/nodes/sop/BboxScatter.ts","webpack:///./src/engine/nodes/sop/Blend.ts","webpack:///./src/engine/nodes/sop/Box.ts","webpack:///./src/engine/nodes/sop/Circle.ts","webpack:///./src/engine/nodes/sop/Color.ts","webpack:///./src/core/Color.ts","webpack:///./src/engine/nodes/sop/Copy.ts","webpack:///./src/core/geometry/Instancer.ts","webpack:///./src/engine/nodes/sop/utils/CopyStamp.ts","webpack:///./src/engine/nodes/sop/Data.ts","webpack:///./src/core/geometry/AttributeData.ts","webpack:///./src/engine/nodes/sop/DataUrl.ts","webpack:///./src/engine/nodes/sop/Delay.ts","webpack:///./src/engine/nodes/sop/Delete.ts","webpack:///./src/engine/nodes/sop/Face.ts","webpack:///./src/engine/nodes/sop/File.ts","webpack:///./src/core/loader/Geometry.ts","webpack:///./modules/three/examples/jsm/loaders/OBJLoader.js","webpack:///./src/engine/nodes/sop/Fuse.ts","webpack:///./src/engine/nodes/sop/Hexagons.ts","webpack:///./src/core/geometry/operation/Hexagon.ts","webpack:///./src/engine/nodes/sop/Hierarchy.ts","webpack:///./src/engine/nodes/sop/Jitter.ts","webpack:///./src/engine/nodes/sop/Layer.ts","webpack:///./src/engine/nodes/sop/Line.ts","webpack:///./src/engine/nodes/sop/Material.ts","webpack:///./src/engine/nodes/sop/Merge.ts","webpack:///./src/engine/nodes/sop/Noise.ts","webpack:///./modules/three/examples/jsm/math/SimplexNoise.js","webpack:///./src/engine/nodes/sop/Normals.ts","webpack:///./src/engine/nodes/sop/Null.ts","webpack:///./src/engine/nodes/sop/ObjectMerge.ts","webpack:///./src/engine/nodes/sop/Occlusion.ts","webpack:///./src/engine/nodes/sop/Peak.ts","webpack:///./src/engine/nodes/sop/Plane.ts","webpack:///./src/engine/nodes/sop/Point.ts","webpack:///./src/engine/nodes/sop/Polywire.ts","webpack:///./src/engine/nodes/sop/Ray.ts","webpack:///./src/engine/nodes/sop/Resample.ts","webpack:///./src/engine/nodes/sop/Scatter.ts","webpack:///./src/engine/nodes/sop/Shadows.ts","webpack:///./src/engine/nodes/sop/Skin.ts","webpack:///./src/engine/nodes/sop/Sphere.ts","webpack:///./src/engine/nodes/sop/Switch.ts","webpack:///./src/engine/nodes/sop/Text.ts","webpack:///./modules/three/examples/jsm/loaders/TTFLoader.js","webpack:///./src/engine/nodes/sop/Torus.ts","webpack:///./src/engine/nodes/sop/TorusKnot.ts","webpack:///./src/engine/nodes/sop/Transform.ts","webpack:///./src/engine/nodes/sop/Tube.ts","webpack:///./src/engine/nodes/sop/UvProject.ts","webpack:///./src/core/CameraController.ts","webpack:///./src/engine/io/json/import/Scene.ts","webpack:///./src/engine/io/json/import/Node.ts","webpack:///./src/engine/io/json/import/param/Multiple.ts","webpack:///./src/engine/io/json/import/param/String.ts","webpack:///./src/engine/io/json/import/param/Ramp.ts","webpack:///./src/editor/history/Stack.ts","webpack:///./src/engine/io/code/export/Nodes.ts","webpack:///./src/editor/core/MouseButton.ts","webpack:///./src/editor/helpers/KeyEventsDispatcher.ts","webpack:///./src/editor/history/commands/NodeSetName.ts","webpack:///./src/engine/nodes/gl/code/globals/Texture.ts","webpack:///./modules/three/examples/jsm/shaders/CopyShader.js","webpack:///./modules/three/examples/jsm/postprocessing/ShaderPass.js","webpack:///./modules/three/examples/jsm/postprocessing/MaskPass.js","webpack:///./modules/three/examples/jsm/postprocessing/EffectComposer.js","webpack:///./src/editor/components/editor/Editor.vue?f140","webpack:///./src/editor/components/editor/Editor.vue?ba2c","webpack:///./src/editor/components/editor/top/Top.vue?dc7a","webpack:///./src/editor/components/editor/top/Top.vue?8eb9","webpack:///./src/editor/components/widgets/DropDownMenu.vue?ff71","webpack:///./src/editor/components/widgets/DropDownMenu.vue?9930","webpack:///./src/editor/components/widgets/dialogs/Alert.vue?2c9a","webpack:///./src/editor/components/widgets/dialogs/Alert.vue?de52","webpack:///./src/editor/components/widgets/dialogs/Confirm.vue?c679","webpack:///./src/editor/components/widgets/dialogs/Confirm.vue?02c5","webpack:///./src/editor/components/widgets/dialogs/Prompt.vue?a1c2","webpack:///./src/editor/components/widgets/dialogs/Prompt.vue?42a6","webpack:///./src/editor/components/panels/multiple/Multiple.vue?598e","webpack:///./src/editor/components/panels/multiple/Multiple.vue?1a65","webpack:///./src/editor/components/editor/top/Navigation.vue?49bd","webpack:///./src/editor/components/editor/top/Navigation.vue?e182","webpack:///./src/editor/components/editor/widgets/PlayBar.vue?9cd8","webpack:///./src/editor/components/editor/widgets/PlayBar.vue?a96e","webpack:///./src/editor/components/editor/widgets/PanelNodeSelector.vue?c991","webpack:///./src/editor/components/editor/widgets/PanelNodeSelector.vue?ae49","webpack:///./src/editor/components/widgets/NodeTree.vue?f1e9","webpack:///./src/editor/components/widgets/NodeTree.vue?a064","webpack:///./src/editor/components/widgets/NumericSlider.vue?764a","webpack:///./src/editor/components/widgets/NumericSlider.vue?59eb","webpack:///./src/editor/components/widgets/context_menus/NodeContextMenu.vue?0d06","webpack:///./src/editor/components/widgets/context_menus/NodeContextMenu.vue?a8d1","webpack:///./src/editor/components/widgets/context_menus/ParamContextMenu.vue?011a","webpack:///./src/editor/components/widgets/context_menus/ParamContextMenu.vue?712c","webpack:///./src/editor/components/editor/widgets/Retractable.vue?858e","webpack:///./src/editor/components/editor/widgets/Retractable.vue?566b","webpack:///./src/editor/components/widgets/dialogs/Modal.vue?6cb4","webpack:///./src/editor/components/widgets/dialogs/Modal.vue?50e2","webpack:///./src/editor/components/panels/network/Network.vue?2fb1","webpack:///./src/editor/components/panels/network/Network.vue?dc12","webpack:///./src/editor/components/panels/params/Params.vue?691b","webpack:///./src/editor/components/panels/params/Params.vue?e8fe","webpack:///./src/editor/components/panels/viewer/Viewer.vue?1494","webpack:///./src/editor/components/panels/viewer/Viewer.vue?c6c7","webpack:///./src/editor/components/panels/spreadsheet/Spreadsheet.vue?7d7f","webpack:///./src/editor/components/panels/spreadsheet/Spreadsheet.vue?4203","webpack:///./src/editor/components/panels/network/components/TabMenu.vue?1c29","webpack:///./src/editor/components/panels/network/components/TabMenu.vue?7eab","webpack:///./src/editor/components/panels/network/components/Node.vue?624b","webpack:///./src/editor/components/panels/network/components/Node.vue?53a6","webpack:///./src/editor/components/panels/network/components/InterractiveConnection.vue?abbc","webpack:///./src/editor/components/panels/network/components/InterractiveConnection.vue?a824","webpack:///./src/editor/components/panels/params/components/Param.vue?6b71","webpack:///./src/editor/components/panels/params/components/Param.vue?07fd","webpack:///./src/editor/components/panels/viewer/components/Threejs.vue?d1d4","webpack:///./src/editor/components/panels/viewer/components/Threejs.vue?f34d","webpack:///./src/editor/components/panels/network/components/Connection.vue?b7a4","webpack:///./src/editor/components/panels/network/components/Connection.vue?e75c","webpack:///./src/editor/components/panels/network/components/NodeInfo.vue?405f","webpack:///./src/editor/components/panels/network/components/NodeInfo.vue?4896","webpack:///./src/editor/components/panels/params/components/fields/Boolean.vue?35c9","webpack:///./src/editor/components/panels/params/components/fields/Boolean.vue?4c19","webpack:///./src/editor/components/panels/params/components/fields/Numeric.vue?ed92","webpack:///./src/editor/components/panels/params/components/fields/Numeric.vue?e8e0","webpack:///./src/editor/components/panels/params/components/fields/Button.vue?58c4","webpack:///./src/editor/components/panels/params/components/fields/Button.vue?cd3c","webpack:///./src/editor/components/panels/params/components/fields/Color.vue?0446","webpack:///./src/editor/components/panels/params/components/fields/Color.vue?36be","webpack:///./src/editor/components/panels/params/components/fields/Float.vue?c342","webpack:///./src/editor/components/panels/params/components/fields/Float.vue?ecf7","webpack:///./src/editor/components/panels/params/components/fields/Folder.vue?14e8","webpack:///./src/editor/components/panels/params/components/fields/Folder.vue?b3b3","webpack:///./src/editor/components/panels/params/components/fields/Integer.vue?0b78","webpack:///./src/editor/components/panels/params/components/fields/Integer.vue?bbbd","webpack:///./src/editor/components/panels/params/components/fields/OperatorPath.vue?cba0","webpack:///./src/editor/components/panels/params/components/fields/OperatorPath.vue?3e08","webpack:///./src/editor/components/panels/params/components/fields/Radio.vue?a20a","webpack:///./src/editor/components/panels/params/components/fields/Radio.vue?6f3a","webpack:///./src/editor/components/panels/params/components/fields/Separator.vue?1498","webpack:///./src/editor/components/panels/params/components/fields/Separator.vue?d39e","webpack:///./src/editor/components/panels/params/components/fields/String.vue?220e","webpack:///./src/editor/components/panels/params/components/fields/String.vue?f173","webpack:///./src/editor/components/panels/params/components/fields/Vector2.vue?9c97","webpack:///./src/editor/components/panels/params/components/fields/Vector2.vue?1878","webpack:///./src/editor/components/panels/params/components/fields/Vector3.vue?13a1","webpack:///./src/editor/components/panels/params/components/fields/Vector3.vue?dbd2","webpack:///./src/editor/components/panels/params/components/fields/Vector4.vue?f952","webpack:///./src/editor/components/panels/params/components/fields/Vector4.vue?1fee","webpack:///./src/editor/components/panels/params/components/fields/Ramp.vue?bd75","webpack:///./src/editor/components/panels/params/components/fields/Ramp.vue?8d46","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Sop.vue?d5a1","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Sop.vue?d312","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Mat.vue?54c6","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Mat.vue?8ba3","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Gl.vue?88cb","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Gl.vue?7d17","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Cop.vue?d8ec","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Cop.vue?9977","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue?5278","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue?c674","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue?1d2c","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue?cfc4","webpack:///./src/editor/Editor.ts","webpack:///./src/editor/store/modules/Engine.ts","webpack:///./src/editor/store/modules/editor/Clipboard.ts","webpack:///./src/editor/store/modules/editor/ContextMenu.ts","webpack:///./src/editor/store/modules/editor/DialogAlert.ts","webpack:///./src/editor/store/modules/editor/DialogConfirm.ts","webpack:///./src/editor/store/modules/editor/DialogPrompt.ts","webpack:///./src/editor/store/modules/editor/Network.ts","webpack:///./src/editor/store/modules/editor/NumericSlider.ts","webpack:///./src/editor/store/modules/editor/Panel.ts","webpack:///./src/editor/store/modules/editor/PanelNodeSelector.ts","webpack:///./src/editor/components/panels/multiple/mixins/Panels.ts","webpack:///./src/editor/components/types/props.ts","webpack:///./src/engine/io/code/export/Scene.ts","webpack:///./src/editor/components/panels/params/components/fields/mixins/NumericSlider.ts","webpack:///./src/editor/components/mixins/SelectedNode.ts","webpack:///./src/editor/components/widgets/NodeTree.vue","webpack:///./src/editor/index.ts","webpack:///./src/editor/store/Store.ts","webpack:///./src/editor/store/controllers/EditorStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorClipboardStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorContextMenuStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorDialogAlertStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorDialogConfirmStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorDialogPromptStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorNetworkStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorNumericSliderStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorPanelStoreController.ts","webpack:///./src/editor/store/controllers/editor/EditorPanelNodeSelectorController.ts","webpack:///./src/editor/store/controllers/EngineStoreController.ts","webpack:///./src/editor/store/modules/Editor.ts","webpack:///./src/editor/components/Icons.ts","webpack:///./src/editor/components/editor/Editor.vue","webpack:///./src/editor/components/editor/top/Top.vue","webpack:///./src/editor/components/widgets/DropDownMenu.vue?e38d","webpack:///./src/editor/components/widgets/DropDownMenu.vue?047b","webpack:///./src/editor/components/editor/top/Top.vue?f09a","webpack:///./src/editor/components/editor/top/Top.vue?db98","webpack:///./src/editor/components/widgets/dialogs/Alert.vue","webpack:///./src/editor/components/widgets/dialogs/Modal.vue?273a","webpack:///./src/editor/components/widgets/dialogs/Modal.vue?afbc","webpack:///./src/editor/components/widgets/dialogs/Alert.vue?0802","webpack:///./src/editor/components/widgets/dialogs/Alert.vue?5c5c","webpack:///./src/editor/components/widgets/dialogs/Confirm.vue","webpack:///./src/editor/components/widgets/dialogs/Confirm.vue?3b35","webpack:///./src/editor/components/widgets/dialogs/Confirm.vue?e625","webpack:///./src/editor/components/widgets/dialogs/Prompt.vue","webpack:///./src/editor/components/widgets/dialogs/Prompt.vue?4520","webpack:///./src/editor/components/widgets/dialogs/Prompt.vue?04ee","webpack:///./src/editor/components/panels/multiple/Multiple.vue","webpack:///./src/editor/components/panels/multiple/mixins/Json.ts","webpack:///./src/editor/components/panels/multiple/mixins/Split.ts","webpack:///./src/editor/components/panels/network/Network.vue","webpack:///./src/editor/components/panels/network/mixins/Camera.ts","webpack:///./src/editor/components/panels/network/mixins/EventKey.ts","webpack:///./src/editor/history/commands/NodeDelete.ts","webpack:///./src/engine/io/code/export/Node.ts","webpack:///./src/engine/io/code/export/param/Multiple.ts","webpack:///./src/engine/io/code/export/param/Numeric.ts","webpack:///./src/engine/io/code/export/param/OperatorPath.ts","webpack:///./src/engine/io/code/export/param/String.ts","webpack:///./src/engine/io/code/export/param/Ramp.ts","webpack:///./src/editor/components/panels/network/mixins/EventMouse.ts","webpack:///./src/editor/components/panels/network/mixins/Json.ts","webpack:///./src/editor/components/panels/network/mixins/NodeAnimation.ts","webpack:///./src/editor/components/panels/network/mixins/NodeConnection.ts","webpack:///./src/editor/components/panels/network/mixins/NodeCreation.ts","webpack:///./src/editor/components/panels/network/mixins/NodeEvent.ts","webpack:///./src/editor/history/commands/SetDisplayFlag.ts","webpack:///./src/editor/history/commands/SetBypassFlag.ts","webpack:///./src/editor/components/panels/network/mixins/NodeNavigation.ts","webpack:///./src/editor/components/panels/network/mixins/NodeSelection.ts","webpack:///./src/editor/components/panels/network/mixins/TabMenuOwner.ts","webpack:///./src/editor/components/panels/network/components/TabMenu.vue","webpack:///./src/editor/components/panels/network/components/TabMenu.vue?d37d","webpack:///./src/editor/components/panels/network/components/TabMenu.vue?9c0a","webpack:///./src/editor/components/panels/network/components/Node.vue","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Capture.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/ChildrenOwner.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Commentable.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/ContextMenu.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/BypassFlag.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/DisplayFlag.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Errored.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/EventMouse.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Icon.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Infos.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Inputs.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Named.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Outputs.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Position.ts","webpack:///./src/editor/components/panels/network/components/nodes/mixins/Selection.ts","webpack:///./src/editor/components/panels/network/components/Connection.vue","webpack:///./src/editor/components/panels/network/components/Connection.vue?1b20","webpack:///./src/editor/components/panels/network/components/Connection.vue?f643","webpack:///./src/editor/components/panels/network/components/NodeInfo.vue","webpack:///./src/engine/nodes/sop/ParticlesSystemGpu.ts","webpack:///./src/engine/nodes/gl/code/assemblers/Particles.ts","webpack:///./src/engine/nodes/gl/code/templates/particles/Default.glsl","webpack:///./src/engine/nodes/gl/code/utils/TextureAllocationsController.ts","webpack:///./src/engine/nodes/gl/code/utils/TextureAllocation.ts","webpack:///./src/engine/nodes/gl/code/utils/TextureVariable.ts","webpack:///./src/engine/nodes/sop/utils/ParticlesSystemGPU/RenderController.ts","webpack:///./src/engine/nodes/sop/utils/ParticlesSystemGPU/GPUComputeController.ts","webpack:///./src/engine/nodes/sop/utils/ParticlesSystemGPU/GPUComputationRenderer.js","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Sop.vue","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Sop.vue?ddbc","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Sop.vue?f72a","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Mat.vue","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Mat.vue?b69c","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Mat.vue?5b21","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Gl.vue","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Gl.vue?4573","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Gl.vue?e3f8","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Cop.vue","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Cop.vue?98c0","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/Cop.vue?a2db","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue?5b23","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue?524d","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue?e018","webpack:///./src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue?4be3","webpack:///./src/editor/components/panels/network/components/NodeInfo.vue?9c55","webpack:///./src/editor/components/panels/network/components/NodeInfo.vue?5270","webpack:///./src/editor/components/panels/network/components/Node.vue?0dba","webpack:///./src/editor/components/panels/network/components/Node.vue?1316","webpack:///./src/editor/components/panels/network/components/InterractiveConnection.vue","webpack:///./src/editor/components/panels/network/components/InterractiveConnection.vue?db0f","webpack:///./src/editor/components/panels/network/components/InterractiveConnection.vue?36b9","webpack:///./src/editor/components/panels/network/helpers/NodeCreation.ts","webpack:///./src/editor/history/commands/NodeCreate.ts","webpack:///./src/editor/components/panels/network/helpers/CameraAnimation.ts","webpack:///./src/editor/components/panels/network/helpers/ClipBoard.ts","webpack:///./src/editor/components/panels/network/helpers/NodeAnimation.ts","webpack:///./src/editor/history/commands/NodeMove.ts","webpack:///./src/editor/components/panels/network/helpers/Connection.ts","webpack:///./src/editor/history/commands/NodeConnect.ts","webpack:///./src/editor/components/panels/network/helpers/NodeSelection.ts","webpack:///./src/editor/history/commands/NodeSelect.ts","webpack:///./src/editor/components/panels/network/Network.vue?ed44","webpack:///./src/editor/components/panels/network/Network.vue?29ba","webpack:///./src/editor/components/panels/params/Params.vue","webpack:///./src/editor/components/panels/params/mixins/Folders.ts","webpack:///./src/editor/components/panels/params/components/Param.vue","webpack:///./src/editor/components/panels/params/components/fields/Boolean.vue","webpack:///./src/editor/components/panels/params/components/fields/Boolean.vue?8bc6","webpack:///./src/editor/components/panels/params/components/fields/Boolean.vue?c7ad","webpack:///./src/editor/components/panels/params/components/fields/Button.vue","webpack:///./src/editor/components/panels/params/components/fields/Button.vue?7b45","webpack:///./src/editor/components/panels/params/components/fields/Button.vue?e8f6","webpack:///./src/editor/components/panels/params/components/fields/Color.vue","webpack:///./src/editor/components/panels/params/components/fields/Color.vue?c7e8","webpack:///./src/editor/components/panels/params/components/fields/Color.vue?c7a6","webpack:///./src/editor/components/panels/params/components/fields/Float.vue","webpack:///./src/editor/components/panels/params/components/fields/Float.vue?6c11","webpack:///./src/editor/components/panels/params/components/fields/Float.vue?82a1","webpack:///./src/editor/components/panels/params/components/fields/Folder.vue","webpack:///./src/editor/components/panels/params/components/fields/Folder.vue?10bb","webpack:///./src/editor/components/panels/params/components/fields/Folder.vue?bbe5","webpack:///./src/editor/components/panels/params/components/fields/Integer.vue","webpack:///./src/editor/components/panels/params/components/fields/Integer.vue?be8b","webpack:///./src/editor/components/panels/params/components/fields/Integer.vue?26d5","webpack:///./src/editor/components/panels/params/components/fields/OperatorPath.vue","webpack:///./src/editor/components/panels/params/components/fields/OperatorPath.vue?cc62","webpack:///./src/editor/components/panels/params/components/fields/OperatorPath.vue?2a6c","webpack:///./src/editor/components/panels/params/components/fields/Radio.vue","webpack:///./src/editor/components/panels/params/components/fields/Radio.vue?f316","webpack:///./src/editor/components/panels/params/components/fields/Radio.vue?29a3","webpack:///./src/editor/components/panels/params/components/fields/Separator.vue","webpack:///./src/editor/components/panels/params/components/fields/Separator.vue?db1b","webpack:///./src/editor/components/panels/params/components/fields/Separator.vue?ac77","webpack:///./src/editor/components/panels/params/components/fields/String.vue","webpack:///./src/editor/components/panels/params/components/fields/String.vue?9dc3","webpack:///./src/editor/components/panels/params/components/fields/String.vue?602e","webpack:///./src/editor/components/panels/params/components/fields/Vector2.vue","webpack:///./src/editor/components/panels/params/components/fields/Vector2.vue?9f6e","webpack:///./src/editor/components/panels/params/components/fields/Vector2.vue?59d2","webpack:///./src/editor/components/panels/params/components/fields/Vector3.vue","webpack:///./src/editor/components/panels/params/components/fields/Vector3.vue?2059","webpack:///./src/editor/components/panels/params/components/fields/Vector3.vue?3487","webpack:///./src/editor/components/panels/params/components/fields/Vector4.vue","webpack:///./src/editor/components/panels/params/components/fields/Vector4.vue?734e","webpack:///./src/editor/components/panels/params/components/fields/Vector4.vue?9d17","webpack:///./src/editor/components/panels/params/components/fields/Ramp.vue","webpack:///./src/editor/components/panels/params/components/fields/Ramp.vue?eba6","webpack:///./src/editor/components/panels/params/components/fields/Ramp.vue?bc9e","webpack:///./src/editor/components/panels/params/components/Param.vue?8e4f","webpack:///./src/editor/components/panels/params/components/Param.vue?a619","webpack:///./src/editor/components/panels/params/Params.vue?4508","webpack:///./src/editor/components/panels/params/Params.vue?9603","webpack:///./src/editor/components/panels/viewer/Viewer.vue","webpack:///./src/editor/components/panels/viewer/components/Threejs.vue","webpack:///./src/editor/components/panels/viewer/components/Threejs.vue?7244","webpack:///./src/editor/components/panels/viewer/components/Threejs.vue?b651","webpack:///./src/editor/components/panels/viewer/Viewer.vue?9961","webpack:///./src/editor/components/panels/viewer/Viewer.vue?c38e","webpack:///./src/editor/components/panels/spreadsheet/Spreadsheet.vue","webpack:///./src/editor/components/panels/spreadsheet/Spreadsheet.vue?8a51","webpack:///./src/editor/components/panels/spreadsheet/Spreadsheet.vue?1a60","webpack:///./src/editor/components/panels/multiple/Multiple.vue?8dda","webpack:///./src/editor/components/panels/multiple/Multiple.vue?a905","webpack:///./src/editor/components/editor/top/Navigation.vue","webpack:///./src/editor/components/editor/top/Navigation.vue?197c","webpack:///./src/editor/components/editor/top/Navigation.vue?e30d","webpack:///./src/editor/components/editor/widgets/PlayBar.vue","webpack:///./src/editor/components/editor/widgets/PlayBar.vue?1ec8","webpack:///./src/editor/components/editor/widgets/PlayBar.vue?9e68","webpack:///./src/editor/components/editor/widgets/PanelNodeSelector.vue","webpack:///./src/editor/components/widgets/NodeTree.vue?0e7f","webpack:///./src/editor/components/widgets/NodeTree.vue?37ce","webpack:///./src/editor/components/editor/widgets/PanelNodeSelector.vue?2381","webpack:///./src/editor/components/editor/widgets/PanelNodeSelector.vue?4d2d","webpack:///./src/editor/components/widgets/NumericSlider.vue","webpack:///./src/editor/components/widgets/NumericSlider.vue?ac06","webpack:///./src/editor/components/widgets/NumericSlider.vue?6cc8","webpack:///./src/editor/components/widgets/context_menus/NodeContextMenu.vue","webpack:///./src/editor/history/commands/NodeSetComment.ts","webpack:///./src/editor/history/commands/NodeSetOverrideClonableState.ts","webpack:///./src/editor/components/widgets/context_menus/NodeContextMenu.vue?42ea","webpack:///./src/editor/components/widgets/context_menus/NodeContextMenu.vue?944d","webpack:///./src/editor/components/widgets/context_menus/ParamContextMenu.vue","webpack:///./src/editor/components/widgets/context_menus/ParamContextMenu.vue?1dc8","webpack:///./src/editor/components/widgets/context_menus/ParamContextMenu.vue?615b","webpack:///./src/editor/components/editor/widgets/Retractable.vue","webpack:///./src/editor/components/editor/widgets/Retractable.vue?fcd3","webpack:///./src/editor/components/editor/widgets/Retractable.vue?e160","webpack:///./src/editor/components/editor/Editor.vue?b382","webpack:///./src/editor/components/editor/Editor.vue?9d0e"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","9","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","type","init_value","options","ParamTemplate","BUTTON","ParamType","BOOLEAN","COLOR","FLOAT","FOLDER","INTEGER","OPERATOR_PATH","RAMP","RampParam","DEFAULT_VALUE","SEPARATOR","STRING","VECTOR2","VECTOR3","VECTOR4","ParamConfig","NodeParamsConfig","MESSAGE","DEFAULT_INPUT_NAMES","container_controller","TypedContainerController","GeometryContainer","flags","FlagsControllerDB","node_context","NodeContext","SOP","displayed_input_names","initialize_base_node","this","display","set","add_hook","active","parent","display_node_controller","set_display_node","io","outputs","set_has_one_output","set_core_group","core_group","objects","_set_object_attributes","set_container","FROM_SET_CORE_GROUP","set_object","set_container_objects","FROM_SET_OBJECT","set_objects","FROM_SET_OBJECTS","set_geometry","geometry","create_object","FROM_SET_GEOMETRY","set_geometries","geometries","forEach","FROM_SET_GEOMETRIES","message","container","core_content","CoreGroup","touch","index","position_array","getAttribute","array","setIndex","CoreConstant","OBJECT_TYPE","MESH","object_constructor","CONSTRUCTORS_BY_NAME","MATERIALS","clone","castShadow","receiveShadow","frustumCulled","material","scene","console","log","material_node","CoreMaterial","node","add_render_hook","_add_index","points_count","indices","TypedNode","TypedSopNode","BaseSopNodeClass","InputCloneMode","editor","EditorStoreController","engine","EngineStoreController","instance","_instance","StoreControllerClass","set_scene","_scene","events_controller","set_listener","set_current_node","root","save_scene","SceneJsonExporter","exporter","StoreController","callback","Editor","on_save_callback","set_store","store","close_all_popups","process_events","emitter","event_name","CoreGraphNode","SceneEvent","FRAME_UPDATED","update_frame","FRAME_RANGE_UPDATED","update_frame_range","PLAY_STATE_UPDATED","update_play_state","NodeEvent","ERROR_UPDATED","update_node_error","graph_node_id","UI_DATA_POSITION_UPDATED","update_node_ui_data_position","UI_DATA_COMMENT_UPDATED","update_node_ui_data_comment","SELECTION_UPDATED","update_node_selection","FLAG_DISPLAY_UPDATED","update_node_display_flag","FLAG_BYPASS_UPDATED","update_node_bypass_flag","NAME_UPDATED","update_node_name","INPUTS_UPDATED","update_node_inputs","NAMED_INPUTS_UPDATED","update_node_named_inputs","NAMED_OUTPUTS_UPDATED","update_node_named_outputs","PARAMS_UPDATED","update_params","CREATED","add_node","DELETED","delete_node","ParamEvent","RAW_INPUT_UPDATED","update_param_raw_input","VALUE_UPDATED","update_param_value","EXPRESSION_UPDATED","update_param_expression","update_param_error","VISIBLE_UPDATED","update_param_visible_state","warn","ObjectType","ObjectTypes","POINTS","LINE_SEGMENTS","ObjectTypeMenuEntries","indexOf","AttribClass","AttribType","materials","MeshStandard","MeshStandardMaterial","color","side","FrontSide","metalness","roughness","MeshLambertMaterial","Color","vertexColors","NoColors","transparent","depthTest","PointsMaterial","size","LineBasicMaterial","linewidth","AttribClassMenuEntries","VERTEX","OBJECT","AttribTypeMenuEntries","NUMERIC","ATTRIB_CLASS","ATTRIB_TYPE","OBJECT_TYPES","CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME","Scene","Group","Object3D","Mesh","Points","LineSegments","Bone","SkinnedMesh","BooleanString","ATTRIB_NAMES_SEPARATOR","TAIL_DIGIT_MATCH_REGEXP","INDICES_LIST_SEPARATOR","NUM_REGEXP","is_boolean","word","TRUE","FALSE","to_boolean","is_number","test","tail_digits","match","parseInt","increment","digits","substring","pluralize","camel_case","upper_first","snake_case","titleize","replace","type_to_class_name","timestamp_to_seconds","Date","parse","seconds_to_timestamp","seconds","setTime","toISOString","substr","precision","val","decimals","Math","max","elements","split","frac","undefined","string_to_pad","pad","ensure_float","num","num_as_string","match_mask","rule","join","RegExp","matches_one_mask","masks","mask","CoreString","attrib_names","trimed_elements","map","e","to_id","reverse","id","exp","element","charCodeAt","Number","MAX_SAFE_INTEGER","indices_string","sort","a","b","range_elements","escape_line_breaks","_geometry","uuid","bounding_box","_bounding_box","_create_bounding_box","computeBoundingBox","boundingBox","mark_as_instance","userData","marked_as_instance","CoreGeometry","position_attrib_name","compute_vertex_normals","computeVertexNormals","user_data_attribs","indexed_attribute_names","keys","user_data_attrib","CoreAttribute","remap_name","is_attrib_indexed","has_attrib","attributes","attrib_type","attrib_sizes","h","attrib_name","itemSize","attrib_size","attrib","set_indexed_attribute_values","values","set_indexed_attribute","setAttribute","Int32BufferAttribute","add_numeric_attrib","default_value","attribute_added","vec2","x","y","vec3","z","col","g","vec4","w","Float32BufferAttribute","init_position_attribute","Vector3","add_attribute","attrib_data","rename_attribute","old_name","new_name","old_attrib","deleteAttribute","delete_attribute","src_geometry","src_userData","attribute_name","attribute","constructor","InterleavedBufferAttribute","MonkeyPatcher","patch","new_geometry","position","count","points","_points","points_from_geometry","reset_points","position_attrib","point_index","point","CorePoint","geometry_from_points","object_type","BufferGeometry","geometry_wrapper","first_point","old_geometry","old_geometry_wrapper","_indices_from_points","new_values","attrib_value","new_value","new_attrib_indices","new_index","new_index_by_old_index","index_attrib","old_index","old_index0","old_index1","old_index2","new_index0","new_index1","new_index2","merge_geometries","core_geometries","new_values_by_attribute_name","indexed_attribute_name","index_by_values","all_geometries_points","set_attrib_index","merged_geometry","BufferGeometryUtils","mergeBufferGeometries","merged_geometry_wrapper","mergedUserData","segments","faces","faces_from_geometry","faces_count","CoreFace","renderers_controller","RenderersController","nodes_register","NodesRegister","scenes_by_uuid","Poly","register_node","tab_menu_category","registered_nodes","parent_context","in_worker_thread","desktop_controller","player_mode","args","set_env","env","_env","POLY","_name","_dirty_controller","DirtyController","_graph_node_id","graph","next_id","setNode","_graph","set_name","set_dirty","trigger","set_successors_dirty","remove_dirty_state","is_dirty","add_post_dirty_hook","graph_remove","removeNode","add_graph_input","src","connect","remove_graph_input","disconnect","graph_disconnect_predecessors","disconnect_predecessors","graph_disconnect_successors","disconnect_successors","graph_predecessor_ids","predecessor_ids","graph_predecessors","predecessors","graph_successors","successors","graph_all_predecessors","all_predecessors","graph_all_successors","all_successors","param","required_arguments","optional_arguments","min_allowed_arguments_count","max_allowed_arguments_count","allowed_arguments_count","process_arguments","get_referenced_node_container","index_or_path","referenced_node","get_referenced_node","request_container","full_path","get_referenced_param","path","decomposed_path","CoreWalker","find_param","find_referenced_graph_node","inputs","input_graph_node","find_node","input","find_dependency","create_dependency_from_index_or_path","DecomposedPath","create_dependency","CoreObject","is_a","TypedParam","node_or_param","MethodDependency","named_nodes","BaseMethod","BaseContainer","pv","ParamsValueAccessor","ParamsAccessor","_initialized","_display_node_controller","_parent_controller","HierarchyParentController","_children_controller_context","_create_children_controller","HierarchyChildrenController","_children_controller","children_allowed","_ui_data","UIData","_dependencies_controller","DependenciesController","_states","StatesController","_lifecycle","LifeCycleController","_serializer","NodeSerializer","_cook_controller","CookController","_io","IOController","_name_controller","NameController","name_controller","_set_core_name","_params_controller","ParamsController","_processing_context","ProcessingContext","initialize_base_and_node","initialize_node","required_three_imports","required_imports","three_imports","require_webgl2","set_parent","parent_controller","create_params","add_param","cook","input_contents","content","set_content","cook_controller","end_cook","create_node","children_controller","remove_node","children","nodes_by_type","set_input","input_index_or_name","output_index_or_name","emit","dispatch","to_json","include_param_components","serializer","BaseNodeClass","camera","FullScreenQuad","Pass","enabled","needsSwap","clear","renderToScreen","assign","setSize","render","error","_mesh","dispose","renderer","MaterialContainer","_cook_main_without_inputs_when_dirty_bound","_cook_main_without_inputs_when_dirty","MAT","add_post_set_full_path_hook","set_material_name","cook_main_without_inputs","_material","create_material","set_material","TypedMatNode","Material","BaseMatNodeClass","ObjNodeRenderOrder","ObjectContainer","render_order","MANAGER","_children_group","_attachable_to_hierarchy","_used_in_scene","OBJ","set_used_in_scene","state","loading_controller","is_loading","update_object","add_object_to_parent","attachable_to_hierarchy","add","remove_object_from_parent","remove","_object","_create_object_with_attributes","set_object_name","is_display_node_cooking","is_displayed","TypedObjNode","BaseObjNodeClass","_options","OptionsController","_emit_controller","EmitController","_is_computing","initialize_param","_expression_controller","ParamSerializer","initialize_value","_value","convert","raw_val","are_raw_input_equal","val1","val2","is_raw_input_equal","other_raw_input","_raw_input","are_values_equal","is_value_equal","other_val","_clone_raw_input","raw_input","emit_controller","process_raw_input","_default_value","compute","process_computation","_compute_resolves","pop","Promise","resolve","reject","set_init_value","is_multiple","set_node","_node","makes_node_dirty_when_dirty","parent_param","params","params_node","components","set_parent_param","_parent_param","has_parent_param","path_relative_to","relative_path","emit_allowed","increment_count","_components","component_names","init_components","has_expression","expression_controller","BaseParamClass","TransformedParamConfig","Base","transform","scale","transform_controller","TransformController","TransformedObjNode","_update_transform_from_params_scale","set_count","set_depends_on_inputs","on_input_updated","hook_name","dirty_controller","has_hook","add_to_parent_transform","remove_from_parent_transform","update","matrix","update_transform_with_matrix","equals","update_transform_from_params","matrixAutoUpdate","dispatchEvent","rotation","copy","multiplyScalar","radians","CoreMath","degrees_to_radians","euler","Euler","updateMatrix","set_params_from_matrix","CoreTransform","ConnectionPointType","ConnectionPointTypes","BOOL","INT","VEC2","VEC3","VEC4","ConnectionPointTypeToParamTypeMap","SAMPLER_2D","ParamTypeToConnectionPointTypeMap","ConnectionPointInitValueMap","DEFAULT_VALUE_JSON","ConnectionPointComponentsCountMap","node_src","node_path","param_name","src_graph_node","dest_graph_node","closest_common_parent","distance","distance_to_parent","up","ups","PARENT","parent_path_elements","filter","remaining_elements","cmptr","dest_path_element","graph_node1","graph_node2","parents1","parents","parents2","min_depth","min","found_parent","graph_node","dest","current","dest_id","CURRENT","CURRENT_WITH_SLASH","PARENT_WITH_SLASH","CoreWalkerEmbed","has_display","has_bypass","Display","DisplayFlag","Bypass","bypass","BypassFlag","FlagsController","FlagsControllerD","FlagsControllerB","ShaderName","ParticleShaderNames","PARTICLES_0","PARTICLES_1","PARTICLES_2","PARTICLES_3","PARTICLES_4","PARTICLES_5","PARTICLES_6","PARTICLES_7","PARTICLES_8","PARTICLES_9","_translation_matrix","Matrix4","_translation_matrix_q","Quaternion","_translation_matrix_s","_matrix","identity","_matrix_q","_matrix_e","_matrix_s","_rotate_geometry_m","_rotate_geometry_q","_rotate_geometry_vec_dest","update_scale","quaternion","decompose","setFromQuaternion","toVector3","divideScalar","PI","batch_update","set_vector3","toArray","set_float","set_params_from_object","translation_matrix","compose","matrix_quaternion","quat","setFromEuler","rotate_geometry","vec_origin","vec_dest","normalize","setFromUnitVectors","makeRotationFromQuaternion","applyMatrix","THREE","Triangle","RAD_DEG_RATIO","clamp","fit01","dest_min","dest_max","fit","src_min","src_max","degrees","radians_to_degrees","deg2rad","deg","rad2deg","rad","rand","number","rand_float","rand_vec2","round","step_size","steps_count","rounded_steps_count","ceil","floor","highest_even","vec","uv","sn","fract","sin","geodesic_distance","lnglat1","lnglat2","1","lat","2","","","lng","cos","atan2","sqrt","expand_triangle","triangle","margin","TriangleProp","mid_point","getMidpoint","prop","delta","sub","delta_n","nearestPower2","pow","Easing","container_class","_callbacks","_container","setTimeout","process_container_request","request_input_container","then","notify_requesters","states","reset_caches","cook_main","input_index","input_node","processing_context","callbacks","BaseContainerController","Vector2","ATTRIB_NAME_MAP","P","N","Cd","array_to_indexed_arrays","index_by_value","current_index","_reset_ramp_interpolant_and_texture_bound","_reset_ramp_interpolant_and_texture","RampValue","from_json","raw_input1","raw_input2","is_equal","is_equal_json","are_json_equal","_ramp_interpolant","_ramp_texture","ramp_texture","_create_ramp_texture","Uint8Array","stride","width","value_at_position","texture","DataTexture","RGBFormat","needsUpdate","create_interpolant","positions","interpolated_values","Float32Array","CubicInterpolant","interpolant","_create_interpolant","sorted_points","sorted_point","evaluate","RampInterpolation","LINEAR","RampPoint","cloned_container","_content","_post_set_content","has_content","core_content_cloned","infos","TypedContainer","_components_contructor","FloatParam","is_default","Array","component_name","component","default_val","compute_components","set_value_from_components","promises","all","cooker","block","block_parent_emit","unblock","unblock_parent_emit","TypedMultipleParam","_type","_init_value","_json","_create_json","TypedNamedConnectionPoint","SetupFieldCommonProps","json_param","default","tabindex","displays_expression_result","Boolean","props","computed","expression","error_message","is_errored","field_component_type","class_object","input_value_class_object","is_field_visible","is_field_hidden","displays_expression_result_computed","create_set_command","ParamSetCommand","watch","new_display","old_display","on_update_value","target","currentTarget","on_keyup","offset","ctrlKey","shiftKey","IntegerParam","preventDefault","reset_to_default","CATEGORY_OBJ","LIGHT","GEOMETRY","CAMERA","MISC","CATEGORY_COP","INPUT","ADVANCED","CATEGORY_EVENT","CATEGORY_GL","CONVERSION","DYNAMICS","GLOBALS","MATH","QUAT","TRIGO","UTIL","INSTANCE","CATEGORY_MAT","LINE","VOLUME","CATEGORY_SOP","ANIMATION","ATTRIBUTE","MODIFIER","RENDER","CATEGORY_POST","PASS","_set_mat_to_recompile_bound","_set_mat_to_recompile","_allow_inputs_created_from_params","GL","connections","init_inputs","ui_data","set_layout_horizontal","set_named_output_connection_points","set_post_create_params_hook","create_inputs_from_params","assembler_controller","set_compilation_required_and_dirty","gl_var_name","variable_for_input","get_input_index","connection","input_connection","output_name","named_output_connection_points","output_index","ThreeToGl","any","set_lines","shaders_collection_controller","reset_code","_param_configs_controller","reset","inputless_params_names","names","add_input","includes","connection_type","set_named_input_connection_points","create_spare_parameters","values_by_param_name","Map","current_param_names","spare_names","has_deleted_a_param","has_created_a_param","delete_param","named_input_connection_points","connection_point","last_param_value","param_type","ParamValueToDefaultConverter","from_value","default_value_from_name","gl_input_default_value","spare","set_param_configs","param_configs","list","make_output_nodes_dirty","output_connections","node_dest","TypedGlNode","BaseGlNodeClass","_param","_complex_data","is_spare_and_not_component","is_spare","value_changed","_require_data_complex","_data_complex","_data_simple","raw_input_serialized","default_value_serialized","add_main","has_options_overridden","overridden_options","options_overridden","option_name","option_value","JSON","stringify","ParamJsonExporter","background","use_background","use_material","visible_if","background_color","background_material","node_selection","context","dependent_on_found_node","background_ratio","_bg_raycaster","Raycaster","_screen_quad","_create_screen_quad","PlaneBufferGeometry","quad","screen_quad_flat_material","_screen_quad_flat_material","MeshBasicMaterial","add_params","boolean","use_background_color","update_screen_quad","update_background_color","use_background_material","update_background_material","screen_quad","bg_node","found_node","BaseBackgroundController","v","vector3","vector2","vector3_float","float3","float2","float","int","bool","Constants","NODE_HEIGHT","CONNECTION_VERTICAL_MARGIN","CONNECTION_VERTICAL_SPACING","CONNECTION_VERTICAL_START","NODE_UNIT","on_contextmenu_close","context_menu","set_param_id","on_contextmenu","event","menu_param_id","param_id","current_param_id","set_position","pageX","pageY","Uint16Array","EMPTY_DATA_TEXTURE","LuminanceFormat","HalfFloatType","TextureContainer","COP","set_texture","clear_texture","TypedCopNode","BaseCopNodeClass","MAPPINGS","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","CubeUVReflectionMapping","CubeUVRefractionMapping","WRAPPINGS","ClampToEdgeWrapping","RepeatWrapping","MirroredRepeatWrapping","MAG_FILTERS","LinearFilter","NearestFilter","MIN_FILTERS","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","ATTRIB_MAPPING_KEYS","ATTRIB_MAPPING","mapping","wrapS","wrapT","minFilter","magFilter","ParamsConfig","url","CoreTextureLoader","PARAM_DEFAULT","desktop_browse","file_type","reload","FileCopNode","PARAM_CALLBACK_reload","menu","entries","wrap_s","wrap_t","mag_filter","min_filter","params_config","_is_static_image_url","cook_for_image","cook_for_video","_load_texture","_update_texture_params","_param_url_changed","_add_video_spare_params_if_required","_previous_param_url","_set_video_current_time","resolved_url","texture_attrib","param_value","param_callback_reload","_video","has","currentTime","VideoTexture","image","has_param","VIDEO_TIME_PARAM_NAME","duration","range","range_locked","_remove_spare_params","_texture_loader","load_texture_from_url_or_op","DEFAULT_NODE_PATH","UV","ENV_MAP","GLDefinitionType","_definition_type","_data_type","collection_instance","TypedGLDefinitionCollection","TypedGLDefinition","data_type","AttributeGLDefinition","FUNCTION","FunctionGLDefinition","UNIFORM","UniformGLDefinition","VARYING","VaryingGLDefinition","ColorParamConfig","use_vertex_colors","opacity","alpha_test","use_fog","ColoredMaterial","VertexColors","alphaTest","fog","BaseController","ColorsController","SideParamConfig","double_sided","front","SidedMaterial","prev","single_side","BackSide","DoubleSide","SideController","CustomMaterialName","_assemblers_by_custom_name","custom_assembler_class_by_custom_name","compile_custom_materials","class_by_custom_name","assembler_class","custom_name","_code_builder","assembler","_gl_parent_node","set_root_nodes","_root_nodes","set_param_configs_owner","set_shader_configs","shader_configs","set_variable_configs","variable_configs","custom_material","custom_materials","compile_material","shadow_assembler_class_by_custom_name","add_output_body_line","output_node","input_name","named_input","var_input","variable_config","new_var","default_from_attribute","named_input_connection_points_by_name","gl_type","attr_read","globals_handler","read_attribute","variable_config_default","prefix","suffix","if_condition","add_body_lines","set_node_lines_output","shader_name","current_shader_name","input_names","shader_config","set_node_lines_attribute","attribute_node","var_name","handle_gl_FragCoord","body_lines","FRAGMENT","handle_resolution","set_node_lines_globals","globals_node","definition","body_line","dependencies","definitions_by_shader_name","body_lines_by_shader_name","used_output_names","globals_shader_name","MapUtils","push_on_array_at_entry","dependency","set_frame_dependent","set_resolution_dependent","handle_globals_node","definitions","add_definitions","BaseGlShaderAssembler","ShaderAssemblerRender","new_element","unshift_on_array_at_entry","unshift","concat_on_array_at_entry","new_elements","HistoryStack","push_command","BaseCommand","converted","set_expression","_update_value","ExpressionController","requires_entities","compute_expression","expression_result","execute_callback","TypedNumericParam","unreachable","Error","TypeAssert","_new_raw_input","_old_raw_input","do","undo","SkinningParamConfig","skinning","SkinnedMaterial","SkinningController","TextureMapParamConfig","use_map","BooleanParamOptions","TextureMapController","OperatorPathOptions","TextureMapMaterial","add_hooks","_update_texture","texture_map_controller","BaseTextureMapController","TextureAlphaMapParamConfig","use_alpha_map","TextureAlphaMapController","alpha_map","TextureAlphaMaterial","texture_alpha_map_controller","dispatch_node","NodeJsonExporter","dispatch_param","ParamMultipleJsonExporter","ParamNumericJsonExporter","OperatorPathParam","ParamOperatorPathJsonExporter","StringParam","ParamStringJsonExporter","ParamRampJsonExporter","JsonExportDispatcher","_data","nodes_controller","reset_node_context_signatures","root_exporter","nodes_data","properties","frame","frame_range","frame_range_locked","time_controller","fps","master_camera_node_path","cameras_controller","ui","sanitize_string","update_light_params","update_shadow_params","TypedLightObjNode","BaseLightTransformedObjNode","BaseLightHelperParamConfig","show_helper","helper_size","BaseLightHelperObjNode","wireframe","build","build_helper","BaseLightHelper","_helper_constructor","update_helper_attachment","helper","_helper","_create_helper","light","visible","HelperController","BaseManagerObjNode","layer","layers","enable","integer","LayersController","operator_path_param_options","POST","do_post_process","post_process","use_post_process_node0","post_process_node0","use_post_process_node1","post_process_node1","use_post_process_node2","post_process_node2","use_post_process_node3","post_process_node3","_renderers_by_canvas_id","_composers_by_canvas_id","_resolution_by_canvas_id","_composers_set_in_progress_by_canvas_id","_fetch_post_process_nodes_in_progress","_post_process_nodes","_post_process_use_node_path_params","_post_process_node_path_params","canvas","aspect","composer","setup_for_aspect_ratio","display_scene","create_renderer","gl","rendering_context","WebGLRenderer","antialias","alpha","shadowMap","physicallyCorrectLights","toneMapping","ACESFilmicToneMapping","toneMappingExposure","outputEncoding","sRGBEncoding","register_renderer","set_renderer_size","setPixelRatio","devicePixelRatio","delete_renderer","deregister_renderer","_create_composer","EffectComposer","set_composer_passes","update_composer_passes","composer_passes_nodes_changed","toggle_param","post_process_node","set_composers_passes","clear_render_passes","render_scene_pass","RenderPass","clearAlpha","addPass","apply_to_composer","render_pass","passes","disposable_pass","visible_options","node_path_options","PostProcessController","process_data","ParamJsonImporter","_value_elements","ParsedTree","string_value_elements","src_material","clone_single","apply_custom_materials","material_with_custom","mat_name","assign_custom_uniforms","mat","uniform_name","uniform_value","uniforms","init_custom_material_uniforms","add_drag_classes","document","body","classList","remove_drag_classes","set_cursor_col_resize","unset_cursor_col_resize","CoreDom","_graph_node","base_name","base","last_char","request_name_to_parent","set_child_name","update_name_from_parent","post_set_name","post_set_full_path","child_node","add_post_set_name_hook","hook","_on_set_name_hooks","_on_set_full_path_hooks","graph_node_ids","node_element_by_graph_node_id","update_from_name_change","to_path","moduleKeywords","include","obj","dest_class","src_class","included","current_proto","__proto__","VARIABLE_PREFIX","set_error","traverse_node","method_name","traverse_BinaryExpression","left","operator","right","traverse_LogicalExpression","traverse_MemberExpression","traverse_ConditionalExpression","consequent","alternate","traverse_Compound","traversed_args","arg_node","traverse_Literal","raw","BaseTraverser","allow_pan","allow_rotate","allow_zoom","tdamping","damping","screen_space_panning","rotate_speed","min_distance","max_distance","polar_angle_range","create_controls_instance","OrbitControls","setup_controls","controls","enablePan","enableRotate","enableZoom","enableDamping","dampingFactor","rotateSpeed","screenSpacePanning","minDistance","maxDistance","minPolarAngle","maxPolarAngle","enableKeys","set_from_camera_node","camera_node","TypedCameraControlsEventNode","CameraOrbitControlsEventNode","ConnectionPointTypesAvailableForAttribute","_update_signature_if_required_bound","_update_signature_if_required","add_on_scene_load_hook","allow_attribute_exports","connected_input_node","connected_input_connection_point","named_input_connection_point","output_connection_point","named_output_connection_points_by_name","export_when_connected","dirty_trigger","lifecycle","creation_completed","update_input_and_output_types","AttributeGlNode","controller_class","controller","use_map_name","use_map_param","path_param","mat_attrib_name","has_no_texture","texture_is_different","LineType","_color_with_intensity","_light","create_light","update_light_attachment","create_shadow_params_main","shadow","create_shadow_params","create_light_params","intensity","core_geometry","geo","points_from_group","group","set_attrib_value","add_numeric_vertex_attrib","attribute_names","human_type","src_object","new_object","sourceLookup","cloneLookup","parallelTraverse","sourceNode","clonedNode","traverse","src_node","mesh_node","src_node_geometry","mesh_node_geometry","material_with_color","src_node_with_animations","animations","animation","skinned_node","isSkinnedMesh","clonedMesh","sourceMesh","sourceBones","skeleton","bones","bindMatrix","new_bones","bone","CoreEntity","computeTangents","normal","normals","uvs","nVertices","tangent","tangents","tan1","tan2","vA","vB","vC","uvA","uvB","uvC","sdir","tdir","groups","start","il","jl","handleTriangle","tmp","tmp2","n2","handleVertex","fromArray","isFinite","addScaledVector","dot","crossVectors","useGroups","isIndexed","attributesUsed","Set","morphAttributesUsed","morphAttributes","morphTargetsRelative","mergedGeometry","addGroup","indexOffset","mergedIndex","getX","mergedAttribute","mergeBufferAttributes","numMorphTargets","morphAttributesToMerge","mergedMorphAttribute","TypedArray","normalized","arrayLength","isInterleavedBufferAttribute","interleaveAttributes","interleavedBuffer","res","getters","setters","iba","k","estimateBytesUsed","mem","attr","BYTES_PER_ELEMENT","getIndex","mergeVertices","tolerance","EPSILON","hashToIndex","vertexCount","nextIndex","attributeNames","attrArrays","morphAttrsArrays","newIndices","morphAttr","fill","decimalShift","log10","shiftMultiplier","hash","newarray","newMorphArrays","getterFunc","ml","oldAttribute","buffer","oldMorphAttribute","morphAttribute","toTrianglesDrawMode","drawMode","numberOfTriangles","newGeometry","clearGroups","accumulated_curve_point_indices","curve_point_indices","last_index_added","previous_index","create_line_segment_geometry","attrib_sizes_by_name","new_indices","new_attribute_values_by_name","line_segment_to_geometries","CoreGeometryUtilCurve","set_element","element_position","dim","getBoundingClientRect","changedTouches","element_position_old","normalized_position","scrollX","scrollY","height","normalized_position_0_1","EventHelper","open_numeric_slider","button","MouseButton","MIDDLE","numeric_slider","open","clientX","clientY","on_paste","parsed","parseFloat","ensure_in_range","_found_node","expected_context","node_selection_context","VARIABLE_CONFIG_DEFAULT_BY_NAME","variable_name","GlobalsGeometryHandler","PRE_DEFINED_ATTRIBUTES","varying_definition","set_varying_body_line","handle_attribute_node","IF_RULE","GlobalsBaseController","_lines","process","create_line","node_var_name","add_options","CodeExporterDispatcher","overridden_option_names","line","ParamCodeExporter","copy_node","_copied_node","clipboard","set_node_id","copy_param","_copied_param","text","createElement","appendChild","select","execCommand","removeChild","ClipboardHelper","__file","_display_scene","_cameras_controller","CamerasController","_cooker","Cooker","CoreGraph","_missing_expression_references_controller","MissingReferencesController","_nodes_controller","NodesController","_time_controller","TimeController","init","set_uuid","_uuid","wait_for_cooks_completed","_events_controller","EventsController","_lifecycle_controller","_loading_controller","LoadingController","_performance","CorePerformance","set_frame","play","pause","PolySceneSerializer","_uniforms_controller","UniformsController","_webgl_controller","WebGLController","PolyScene","ui_data_json","children_ids","input_ids","input_connection_output_indices","connection_input_indices","named_input_connections","named_output_connections","param_ids","to_json_params","override_clonable_state","inputs_clonable_state_with_override","selection","input_connections","to_json_params_from_names","param_names","include_components","ParamConstructorByType","BooleanParam","ButtonParam","ColorParam","FolderParam","SeparatorParam","Vector2Param","Vector3Param","Vector4Param","_expression","_manager","is_expression_for_entities","ExpressionManager","parse_expression","update_from_method_dependency_name_change","compute_function","compute_expression_for_entities","entities","set_entities","reset_entities","compute_expression_for_points","compute_expression_for_objects","_entities","_entity_callback","addUnaryOp","addBinaryOp","string","parse_expression_for_string_param","nodes","arguments","callee","ease_i","power","ease_o","abs","ease_io","linear","ease_i2","ease_o2","ease_io2","ease_i3","ease_o3","ease_io3","ease_i4","ease_o4","ease_io4","ease_i_sin","ease_o_sin","ease_io_sin","ease_i_elastic","ease_o_elastic","ease_io_elastic","_state","_hooks","on_update","new_state","run_hooks","toggle","BaseFlag","domElement","quatInverse","lastPosition","lastQuaternion","Infinity","minZoom","maxZoom","minAzimuthAngle","maxAzimuthAngle","zoomSpeed","panSpeed","keyPanSpeed","autoRotate","autoRotateSpeed","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ROTATE","DOLLY","PAN","touches","ONE","TWO","DOLLY_PAN","target0","position0","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","scope","updateProjectionMatrix","changeEvent","STATE","NONE","inverse","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","makeSafe","radius","panOffset","setFromSpherical","lookAt","zoomChanged","distanceToSquared","EPS","removeEventListener","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","onKeyDown","startEvent","endEvent","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","angle","rotateUp","panLeft","objectMatrix","setFromMatrixColumn","panUp","pan","deltaX","deltaY","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","isOrthographicCamera","clientWidth","top","bottom","dollyIn","dollyScale","dollyOut","handleMouseDownRotate","handleMouseDownPan","handleTouchStartRotate","handleTouchStartPan","handleTouchStartDolly","dx","dy","handleTouchMoveRotate","subVectors","handleTouchMovePan","handleTouchMoveDolly","focus","metaKey","handleMouseDownDolly","addEventListener","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","stopPropagation","handleMouseWheel","keyCode","handleKeyDown","handleTouchStartDollyPan","DOLLY_ROTATE","handleTouchStartDollyRotate","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","tabIndex","MapControls","add_globals_params","GlobalsGlNode","_definitions","_errored","_error_message","uniq","definitions_by_name","existing","uniq_definitions","_param_configs","param_config","create_and_push","ParamConfigsController","EVENT_CHANGE","BASE_CAMERA_DEFAULT","near","far","CameraTransformParamConfig","EVENT","set_master_camera","BaseCameraObjNodeClass","PARAM_CALLBACK_set_master_camera","CameraPostProcessParamConfig","CameraBackgroundParamConfig","LayerParamConfig","BaseCameraObjParamsConfig","_aspect","_background_controller","background_controller_constructor","_controls_controller","ControlsController","_layers_controller","_post_process_controller","layers_controller","background_controller","post_process_controller","update_camera","controls_controller","update_controls","on_create","on_delete","set_as_master_camera","set_master_camera_node_path","_update_for_aspect_ratio","update_transform_params_from_object","create_viewer","ThreejsViewer","TypedCameraObjNode","timestamp","_timestamp","performance","now","_core_geometries","_core_objects","_objects","core_objects","_create_core_objects","core_object","create_core_geometries","__geometry_from_object","geometry_from_object","isMesh","isLine","isPoints","from_objects","objects_from_group","group_name","core_objects_from_group","co","_compute_bounding_box","center","getCenter","getSize","bbox","Box3","expandByObject","first_geometry","rename_attrib","attrib_class","child","object_attrib_names","first_object","attrib_names_matching_mask","masks_string","matching_attrib_names","add_numeric_object_attrib","src_group","new_group","ComponentName","ATTRIB_NAMES","COMPONENT_INDICES","_core_geometry","remapped_name","component_index","remaped_name","value_index","attrib_value_index","start_index","_index","Vector4","_position","new_position","set_attrib_value_vector3","_normal","set_normal","new_normal","v2","v3","new_value_index","_array_index","_count","_current_count_index","_resolve","_max_time_per_chunk","max_time_per_chunk","_check_every_interations","check_every_interations","start_with_count","iteratee_method","_iteratee_method_count","_bound_next_with_count","next_with_count","start_time","start_with_array","_array","_iteratee_method_array","_bound_next_with_array","next_with_array","_current_array_element","CoreIterator","segments_count","arc_angle","radian_per_segment","point_radian","position_2d","positions_2d","CoreGeometryUtilCircle","_attribute_datas_by_name","data_keys_prefix","skip_entries","do_convert","convert_to_numeric","load","success_callback","progress_callback","error_callback","response","get_prefixed_json","catch","json","prefixes","first_prefix","set_json","core_geo","_find_attributes","convert_to_numeric_masks","attrib_values","_attribute_values_for_name","numerical_attrib_values","index_data","first_pt","_value_has_subentries","deep_attrib_name","deep_attrib_value","CoreAttributeData","json_element","JsonDataLoader","DRACOLoader","manager","decoderPath","decoderConfig","decoderBinary","decoderPending","workerLimit","workerPool","workerNextTaskID","workerSourceURL","defaultAttributeIDs","defaultAttributeTypes","setDecoderPath","setDecoderConfig","config","setWorkerLimit","setVerbosity","setDrawMode","setSkipDequantization","onLoad","onProgress","onError","loader","setPath","setResponseType","crossOrigin","setWithCredentials","taskConfig","attributeIDs","attributeTypes","useUniqueIDs","decodeGeometry","decodeDracoFile","worker","taskKey","taskCache","cachedTask","promise","byteLength","taskID","taskCost","geometryPending","_getWorker","_worker","postMessage","_createGeometry","finally","_releaseTask","geometryData","_loadLibrary","responseType","preload","_initDecoder","useJS","WebAssembly","librariesPending","libraries","jsContent","wasmBinary","fn","DRACOWorker","toString","lastIndexOf","URL","createObjectURL","Blob","Worker","_taskCosts","_taskLoad","onmessage","debug","terminate","decodeAttribute","draco","decoder","dracoGeometry","attributeName","attributeType","dracoArray","numComponents","num_components","numValues","num_points","DracoFloat32Array","GetAttributeFloatForAllPoints","Int8Array","DracoInt8Array","GetAttributeInt8ForAllPoints","Int16Array","DracoInt16Array","GetAttributeInt16ForAllPoints","Int32Array","DracoInt32Array","GetAttributeInt32ForAllPoints","DracoUInt8Array","GetAttributeUInt8ForAllPoints","DracoUInt16Array","GetAttributeUInt16ForAllPoints","Uint32Array","DracoUInt32Array","GetAttributeUInt32ForAllPoints","GetValue","destroy","onModuleLoaded","DracoDecoderModule","Decoder","decoderBuffer","DecoderBuffer","Init","decodingStatus","geometryType","GetEncodedGeometryType","TRIANGULAR_MESH","DecodeBufferToMesh","POINT_CLOUD","PointCloud","DecodeBufferToPointCloud","ok","ptr","error_msg","attributeID","self","GetAttributeByUniqueId","GetAttributeId","GetAttribute","numFaces","num_faces","indexArray","GetFaceFromMesh","buffers","WeakMap","releaseDecoderModule","getDecoderModule","geometry1","geometry0","geometry_wrapper0","geometry_wrapper1","segments0","segments1","geometries_by_segments_count","smallest_geometry","largest_geometry","smallest_segments","largest_segments","smallest_points","largest_points","smallest_points_count","all_points","points_indices","segment","matched_segment","CoreGeometryOperationSkin","NodeJsonImporter","ParamMultipleJsonImporter","ParamStringJsonImporter","ParamRampJsonImporter","JsonImportDispatcher","NodeCodeExporter","ParamMultipleCodeExporter","ParamNumericCodeExporter","ParamOperatorPathCodeExporter","ParamStringCodeExporter","ParamRampCodeExporter","other_point","are_equal_json","json1","json2","_interpolation","_Math","generateUUID","json_point","interpolation","ramp","current_point","other_ramp_value","other_points","point1","point2","INSERT_DEFINE_AFTER_MAP","INSERT_BODY_AFTER_MAP","LINES_TO_REMOVE_MAP","_shaders_by_name","_leaf_nodes","_frame_dependent","_resolution_dependent","compile","_template_shader_for_shader_name","_template_shader","vertexShader","fragmentShader","compile_allowed","shaders_by_name","_create_material","_build_lines","shader_names","template","_replace_template","root_nodes","build_uniforms","template_uniforms","new_uniforms","UniformsUtils","uniform","frame_dependent","resolution_dependent","root_nodes_by_shader_name","leaf_nodes_by_shader_name","CodeBuilder","build_code_from_nodes","code_builder","build_from_nodes","allow_new_param_configs","disallow_new_param_configs","builder_param_configs","builder_lines","line_type","lines","all_builder_lines","all_lines","_param_config_owner","param_config_owner","add_output_params","output_child","hidden","create_globals_node_output_connections","reset_configs","_reset_shader_configs","_reset_variable_configs","_reset_frame_dependency","_reset_resolution_dependency","_shader_configs","create_shader_configs","sc","ShaderConfig","_variable_configs","create_variable_configs","vc","VariableConfig","if","input_names_for_shader_name","root_node","insert_define_after","insert_body_after","lines_to_remove","function_declaration","FUNCTION_DECLARATION","define","DEFINE","BODY","template_lines","new_lines","line_before_define","line_before_body","line_before_define_found","line_before_body_found","template_line","_insert_lines","line_remove_required","line_to_remove","lines_to_add","line_to_add","get_custom_materials","TypedAssembler","_assembler","_leaves_graph_id","_graph_ids_by_shader_name","_outputs_by_graph_id","_depth_by_graph_id","_graph_id_by_depth","_shader_name","find_leaves_from_root_node","set_nodes_depth","depth","graph_id","leaves_from_nodes","LEAVES_FROM_NODES_SHADER","find_leaves","node_ids","nodes_from_ids","nodes_for_shader_name","depths","graph_ids_for_depth","node_from_id","sorted_nodes","ids","unique_inputs","booleans_by_graph_id","set_node_depth","current_depth","output_ids","output_id","TypedNodeTraverser","_id","__next_id","find_output_nodes","find_attribute_export_nodes","is_exporting","GlNodeFinder","AssemblerControllerNode","_compile_required","_deleted_params_data","_new_params","add_create_hook","set_assembler_globals_handler","_globals_handler","globals","output","set_compilation_required","trigger_node","compile_required","post_compile","assign_uniform_values","set_uniform_value","current_spare_param_names","assembler_param_names","spare_param_names_to_add","spare_param_names_to_remove","spare_params_with_same_name_as_params","param_exporter","required","params_data","param_options","post_create_spare_params","GlAssemblerController","cache","CacheSopNode","PARAM_CALLBACK_reset","is_cache_empty","toJSON","obj_loader","ObjectLoader","all_objects","param_callback_PARAM_CALLBACK_reset","json_components","cell_class_object","defineComponent","DialogAlert","DialogConfirm","DialogPrompt","NavigationBar","MultiplePanel","NodeContextMenu","ParamContextMenu","PanelNodeSelector","PlayBar","Retractable","NumericSlider","TopBar","scene_update_allowed","username","String","setup","multiple_panel","ref","KeyEventsDispatcher","activate","full_screen_activated","panel","fullscreen_panel_id","FileEntryId","EditEntryId","DesktopEntryId","DropDownMenu","display_desktop_entries","file_menu_entries","SAVE","disabled","edit_menu_entries","UNDO","REDO","desktop_menu_entries","UPLOAD","label","ABOUT","on_file_menu_entry_select","entry","_save","on_edit_menu_entry_select","redo","on_desktop_menu_entry_select","level","on_hover","display_label","label_padding","always_visible","sort_entries","right_aligned","event_id_prefix","emphasis","init_position_top","displayed","position_top_offset","content_max_height","scroll_bars_required","hovered_entry_index","dropdown_menu_content","entry_element","onBeforeMount","onMounted","compute_max_height","content_top_position","hovered_entry_has_children","entry_has_children","sub_dropdown_style_object","entry_parent","offsetWidth","sub_dropdown_init_position_top","current_entry_element","entry_parent_top","hovered_entry_children","entry_children","hovered_entry_id","entry_ids","has_emphasis","sorted_entries","entry_labels","emphasis_indices","entry_label","entry_labels_pre_emphasis","entry_labels_post_emphasis","entry_disabled_states","entry_class_objects","dropdown_menu_class_object","menu_label_style_object","padding","pixel_class_object","is_root","bottom_left","top_right","content_class_object","content_style_object","maxHeight","overflowY","dropdown_menu_label_object","dropdown_menu_label","rect","element_height","window_height","innerHeight","hidden_height","set_hovered_entry_index","unset_hovered_entry","emitted","on_entry_select","toggle_display","locals","Modal","dialog_alert","title","close","hide","resizable","pos","resized_size","style_object","start_mouse_pos","start_pos","current_mouse_pos","on_move_drag","on_move_end","start_size","on_resize_drag","on_resize_end","on_move_start","on_resize_start","cancel_button","dialog_confirm","question","accept_label","accept","on_accept","main_input","dialog_prompt","confirm_label","save","on_save","on_keypress","code","DEFAULT_PANELS","PanelType","VIEWER","PARAMS","NETWORK","DEFAULT_LAYOUT","split_mode","MultiplePanelSplitMode","HORIZONTAL","sub_panels_init_properties","VERTICAL","panel_types","current_panel_index","Network","Params","Viewer","Spreadsheet","init_properties","panel_id","tab_menu_label_padding","split_panel1","split_panel2","current_panel","PanelsMixin","SetupMultiplePanelPanels","SetupMultiplePanelJson","SetupMultiplePanelSplit","TabMenu","Node","InterractiveConnection","nodes_container","json_node","current_json_node","json_children","current_node_graph_id","node_creation_data","camera_data","camera_history","connection_data","node_src_id","node_dest_id","mouse_start","mouse_progress","node_selection_data","end","cam_animation_helper","CameraAnimationHelper","clipboard_helper","ClipBoardHelper","node_creation_helper","NodeCreationHelper","node_animation_helper","NodeAnimationHelper","connection_helper","ConnectionHelper","node_selection_helper","NodeSelectionHelper","helpers","camera_options","SetupCamera","tab_menu_options","SetupTabMenu","event_key_options","SetupEventKey","event_mouse_options","SetupEventMouse","action_in_progress","SetupJson","SetupNodeAnimation","SetupNodeConnection","SetupNodeCreation","SetupNodeEvent","SetupNodeNavigation","SetupNodeSelection","deactivate","_on_keypress","_on_keydown","_on_keyup","onBeforeUnmount","menu_entries","compute_menu_entries","trim_filter","filter_empty","letter","key_processed","current_node","registered_entries","parent_node_type","nodes_by_category","registered_nodes_for_context_and_parent_type","category","registered_category","tab_menu_entries","sub_entry","toLowerCase","on_select","entry_id","Connection","NodeInfo","json_parent","layout_vertical","is_layout_vertical","body_size","bypass_options","SetupBypassFlag","position_options","SetupPosition","selection_options","SetupSelection","capture_options","SetupCapture","infos_options","SetupInfos","selected","is_selected","is_being_moved","bypassed","is_bypassed","layout_horizontal","node_body_style_object","borderRadius","SetupChildrenOwner","SetupContextMenu","SetupCommentable","SetupDisplayFlag","SetupErrored","SetupIcon","SetupInputs","SetupNamed","SetupOutputs","src_json_node","dest_json_node","dest_node","is_src_not_cloned","src_node_pos_v","dest_node_pos_v","src_node_pos","dest_node_pos","src_node_height","node_height","dest_node_height","src_node_box","node_box","dest_node_box","dest_node_inputs_count","max_inputs_count","dest_node_width","src_node_box_clone","Box2","svg_bounds","union","src_node_pos_clone","src_node_delta","src_position","connection_pos","dest_node_pos_clone","dest_node_delta","dest_position","connection_x","interval_size","svg_bound_min","svg_style_object","line_class_object","has_named_inputs","named_input_connection","named_output_connection","mismatched_types","node_box_in_place","connections_height","max_outputs_count","box","node_box_v","translate","COMPONENTS_BY_NODE_CONTEXT","COMPONENTS_BY_NODE_CONTEXT_AND_TYPE","ParticlesSystemGpuSopNode","NodeInfoSop","time_dependent","scene_predecessor_paths","scene_successor_paths","node_by_path","node_name","scene_predecessors","dependencies_controller","scene_successors","get_full_or_direct_paths","compute_node","time_dependency_label","time_dependency_class_object","current_node_info_type","components_for_context","has_same_parent","absolute_path","go_to_node_path","on_name_click","show","NodeSetNameCommand","objects_count","objects_visible_count","objects_count_by_type","objects_names_by_type","vertex_attribute_sizes_by_name","vertex_attribute_types_by_name","table_props","table_prop_names","objects_count_visible_class_object","highlighted","object_types","vertex_attribute_names","vertex_class_objects_by_name","vertex_human_labels_by_name","shader","set_shaders_by_name","copy_shader","escaped","assembler_node","resolution","image_data","getContext","image_data_ctx","createImageData","mult","new_val","putImageData","draw_data_texture","drawImage","draw_texture","draw_texture_on_canvas","copy_cache","DEFAULT_POINT_BOX_HALF_SIZE","DEFAULT_POINT_BOX","src_pos_vec","dest_pos_vec","src_box_box","dest_box_box","svg_bounds_box","src_position_vec","dest_position_vec","src_pos","dest_pos","src_box","dest_box","ParamFieldContainer","display_toolbar","SetupSelectedNode","display_node_doc_help","node_doc_url","first_selected_node","SetupFolders","BooleanField","ButtonField","ColorField","FloatField","FolderField","IntegerField","NumericField","OperatorPathField","RadioField","SeparatorField","StringField","Vector2Field","Vector3Field","Vector4Field","RampField","description","set_ui_data_dependency","update_visibility","human_description","param_menu_entry","entry_name","description_entry","label_tooltip","converted_type","has_menu_radio","param_visible","is_visible","is_label_hidden","slider_options","SetupGlobalSliderOwner","toggle_expression_mode","open_numeric_slider_if_numeric_or_color","is_numeric","Numeric","setup_field_common","SetupFieldCommon","checkbox_id","checked","on_checkbox_update","on_click","press_button","init_color_style","getStyle","input_color","getHexString","update_input_color_from_param","color_input_name","color_value","input_color_w","new_color","old_color","new_style","input_color_c","setStyle","SetupMultipleParamCommon","text_input_focused","param_range","slider_step","step","display_slider","on_focus","on_blur","SetupNumericSlider","go_to_node","__attempt_finding_parent","parent_path","parent_node","open_node_selector","panel_node_selector","selected_states","set_from_select","is_multiline","is_single_line","rows","display_browse_button","browse_file","ramp_points","curve_points","dragged_point_index","point_about_to_be_removed","svg","_start_normalized_mouse_pos","control_point_positions_percent","control_point_values_percent","curve_point_positions_percent","curve_point_values_percent","control_point_class_objects","dragged","interpolated_curve_class_object","update_curve","ramp_point","parentElement","results_count","i_n","_start_point_value","normalized_pos","on_pointmove_drag","pos_far_enough_to_remove_point","on_pointmove_end_normalized_pos","on_pointmove_end","create_history_command","add_point","new_point_index","new_json_point","on_point_move_start","current_camera_node_graph_id","master_camera_node","current_camera_node","camera_menu_label","camera_menu_entries","root_json_children","camera_types","on_select_camera_menu_entry_select","on_capture_render_completed","toggle_fullscreen","set_fullscreen_panel_id","camera_viewer","viewer","AgGridVue","loading","attrib_class_vertex","attrib_selected_states_by_name","header_names","table_data","AllCommunityModules","first_selected_node_id","first_selected_sop_node","connect_graph_node_if_node_is_sop","load_geometry","class_object_object_button","defaultColDef","editable","sortable","columnTypes","indexColumn","attrib_selected_states","columnDefs","header_name","headerName","field","pinned","column_type","_build_headers_for_points","geo_attrib_names","point_attribute_values","P_x","P_y","P_z","_build_table_data_for_points","build_for_points","new_id","old_id","getRowClass","rowIndex","set_attrib_class_vertex","toggle_attrib_selection","inverted_selection","select_all_attributes","select_no_attributes","history","push_to_history","current_path","path_elements","go_backward_allowed","go_forward_allowed","go_backward_class_object","go_forward_class_object","go_to_path","old_path","go_to_path_elements_index","go_backward","go_forward","scrubber","scrubber_width","frame_range_start","set_frame_range","frame_range_end","frame_range_start_locked","set_frame_range_locked","frame_range_end_locked","frames_count","frame_indicator_style_object","playing","playing_state","scrubber_set_frame","on_mouse_up","on_mouse_move","toggle_play_pause","decrement_frame","increment_frame","on_mouse_down","NodeTree","selected_graph_node_id","root_id","accept_button_class_object","accept_selected","selected_node","init_expanded","expanded","expand_label","expand_button_class_object","expandable","selectable_children","has_children_with_context","has_children_and_grandchildren_with_context","is_context","toggle_expanded","on_child_select","node_id","INTEGER_INCREMENTS","FLOAT_INCREMENTS","current_increment_index","start_x","has_modified_param","main_style_object","starters_container_class_object","is_param_integer","increments","increment_starter_class_objects","inactive","increment_starter_class_actives","current_increment","displayed_value","unset_events","_on_mouse_move","_on_mouse_up","pos_delta","scaled_pos_delta","rounded_scaled_pos_delta","value_delta","increment_inverse","new_vector","addScalar","_close","new_display_value","set_current_increment_index","NodeContextMenuEntryId","EDIT_COMMENT","COPY_FULL_PATH","override_clonable_state_allowed","TOGGLE_CLONE_INPUTS","current_comment","node_tmp","comment","new_comment","NodeSetCommentCommand","edit_comment","NodeSetOverrideClonableStateCommand","ParamContextMenuEntryId","PasteParamContextMenuEntryId","param_to_paste","copied_param_graph_node_id","_set_param","params_are_multiple","params_are_single","raw_input_as_array","new_active","COPY","PASTE","VALUE","_paste_values","AS_RELATIVE","_paste_relative_reference","AS_ABSOLUTE","first_component","_paste_absolute_reference","REVERT_TO_DEFAULT","_revert_to_default","paste_entries","param_disabled","retracted","mod","aa","execScript","DataView","f","POSITIVE_INFINITY","bufferSize","bufferType","resize","A","B","C","subarray","ba","ca","S","T","U","V","D","u","M","F","q","E","fa","G","H","I","J","K","L","da","ea","O","R","ga","Q","W","verify","ha","method","Y","Z","$","ia","X","ADAPTIVE","BLOCK","Zlib","_master_camera_node_path","camera_node_path","_find_any_camera","_queue","_block_level","_process_item_bound","_process_item","process_queue","enqueue","original_trigger_graph_node","blocked","delete","run_post_dirty_hooks","_next_id","Graph","directed","compound","multigraph","src_id","hasNode","setEdge","graph_has_cycle","alg","isAcyclic","removeEdge","clear_successors_cache_with_predecessors","src_id_s","dest_id_s","predecessor","successor","successor_ids","all_next_ids","next_ids","next_next_ids","next_next_id","all_predecessor_ids","all_successor_ids","_cooking_nodes_by_id","_resolves","flush","events_listener","_events_listener","loaded","auto_updating","CONTEXT_OPTIONS","_next_renderer_id","_next_env_map_id","_renderers","_env_maps","_require_webgl2","set_require_webgl2","_rendering_context_webgl","webgl2","context_name","_polygon_id","flush_callbacks_with_renderer","first_renderer","first_id","renderers","wait_for_renderer","_node_register","_node_register_categories","_node_register_options","node_type","deregister_node","_lifecycle_on_create_allowed","on_create_hook_allowed","on_create_prevent","_loading_state","_auto_updating","_first_object_loaded","mark_as_loading","_set_loading_state","mark_as_loaded","set_auto_update","on_first_object_loaded","getElementById","references","next_id_s","register","jsep_node","missing_expression_reference","MissingExpressionReference","unregister","check_for_references","refs","ref_id","resolve_with_node","found_graph_nodes","missing_paths","set_found_graph_nodes","graph_nodes","set_missing_paths","paths","ReferenceSearchResult","_node_context_signatures","_instanciated_nodes_by_context_and_type","_root","ObjectsManagerNode","init_display_scene","objects_from_mask","all_nodes","current_parents","current_parent","register_node_context_signature","node_context_signature","node_context_signatures","add_to_instanciated_node","remove_from_instanciated_node","instanciated_nodes","nodes_by_ids","_queued_nodes_by_id","_queued_nodes_by_path","_expected_geo_nodes","_process_queue_start","add_on_child_add_hook","_on_child_add","add_on_child_remove_hook","_on_child_remove","multiple_display_flags_allowed","add_to_queue","path_id","expected_loading_geo_nodes_by_id","add_to_scene","get_parent_for_node","node_input","children_group","parent_object","used_in_scene","remove_from_scene","are_children_cooking","geo_nodes","node_by_id","geo_node","TypedBaseManagerNode","ManagerContainer","BaseManagerNodeClass","_dirty_count","_dirty","_dirty_timestamp","_post_dirty_hook_names","_post_dirty_hooks","set_forbidden_trigger_nodes","_forbidden_trigger_nodes","propagate","_cached_successors","clear_successors_cache","_width","_border_radius","_color","_layout_vertical","set_border_radius","border_radius","set_width","set_comment","_comment","set_color","snap","TimeDependentState","ErrorState","are_params_time_dependent","are_inputs_time_dependent","force_time_dependent","frame_node","unforce_time_dependent","_message","_parent","contains","separator","parent_full_path","on_set_parent","_on_set_parent_hooks","first_element","next_node","remainder","path_from_root","_context","_children","_children_by_type","_children_and_grandchildren_by_context","_is_dependent_on_children","_selection","dependent","_children_node","current_child_with_name","current_name","_add_to_nodes_by_type","available_children_classes","node_class","child_node_json","lifecycle_controller","on_child_add","webgl_controller","first_input_connection","output_connection","old_src","old_output_index","old_dest","old_input_index","_remove_from_nodes_by_type","on_child_remove","parent_id","add_to_children_and_grandchildren_by_context","remove_from_children_and_grandchildren_by_context","children_names","traverse_children","_node_ids","send_update_event","nodes_to_add","node_ids_to_add","nodes_to_remove","node_ids_to_remove","_creation_completed","_on_child_add_hooks","_on_child_remove_hooks","_on_create_hooks","_on_delete_hooks","set_creation_completed","execute_hooks_with_child_node","execute_hooks","add_delete_hook","hooks","_cooking","_cooks_count","_max_cook_time","_cook_time_with_inputs","_cook_time","_cook_time_params","_inputs_evaluation_required","disallow_inputs_evaluation","_init_cooking_state","_cooking_dirty_timestamp","dirty_timestamp","_init_cooking_start_time","perf_active","started","_cook_time_start","_start_cook_if_no_errors","is_cooking","_cook_time_with_inputs_start","evaluate_inputs_and_params","input_containers","input_container","input_clonable_state_with_override","eval_all","_increment_cooks_count","_terminate_cook_process","_record_cook_time","cook_time_end","_cook_time_params_start","record_node_cook_data","eval_required_inputs_p","_time_with_precision","time","METHODS","_find_scene_node_scene_nodes","SUCCESSORS","PREDECESSORS","base_nodes","start_node","_find_base_nodes_from_node","param_nodes_referree","scene_node","base_nodes_by_graph_node_id","uniq_base_nodes","className","add_param_referree","_params_referrees_by_graph_node_id","remove_param_referree","params_referree","node_by_graph_node_id","_programatic_visible_state","_update_visibility_and_remove_dirty_bound","update_visibility_and_remove_dirty","_ui_data_dependency_set","_default_options","options_controller","set_option","overriden","has_callback","get_callback","create_callback_from_string","callback_string","Function","cook_options","desktop_browse_option","desktop_browse_file_type","expr_option","menu_options","has_menu","node_selection_options","texture_as_env","texture_options","is_hidden","set_visible_state","ui_data_depends_on_other_params","visibility_predecessors","predecessor_names","_visibility_graph_node","expected_val","_blocked_emit","_blocked_parent_emit","_count_by_event_name","block_emit","unblock_emit","events_count","value_serialized","frame_graph_node_id","_param_create_mode","_params_by_name","_params_list","_param_names","_non_spare_params","_spare_params","_non_spare_param_names","_spare_param_names","_params_added_since_last_params_eval","init_dependency_node","_params_node","init_from_params_config","_post_create_params","_update_caches","init_param_accessors","run_post_create_params_hook","current_names_in_accessor","getOwnPropertyNames","_remove_unneeded_accessors","configurable","names_to_remove","current_name_in_accessor","name_to_remove","set_with_type","param_with_type","get_float","get_operator_path","value_with_type","delete_params","child_name","existing_param","_eval_param","eval_params","_post_create_params_hook","_on_scene_load_hook_names","_on_scene_load_hooks","run_on_scene_load_hooks","parse_completed","parse_started","parsed_tree","function_generator","FunctionGenerator","parse_tree","compute_allowed","eval_function","eval_allowed","expression_string_generator","ExpressionStringGenerator","new_expression_string","NATIVE_MATH_METHODS_RENAMED","math_random","EASING_METHODS","DIRECT_EXPRESSION_FUNCTIONS","remaped","LITERAL_CONSTRUCT","LiteralConstructsController","GLOBAL_CONSTANTS","INDIRECT_EXPRESSION_METHODS","MethodModule","PROPERTY_OFFSETS","AsyncFunction","getPrototypeOf","_attribute_requirements_controller","AttributeRequirementsController","methods","method_index","method_dependencies","immutable_dependencies","function_main_string","function","function_body","assign_attributes_lines","attribute_presence_check_line","assign_arrays_lines","traverse_CallExpression","method_arguments","arg","literal_contruct","arguments_joined","direct_function_name","path_node","function_string","path_argument","path_argument_function","_create_method_and_dependencies","traverse_UnaryExpression","argument","argument_member_expression","attrib_node","property_node","var_attribute_size","var_array","traverse_Identifier","identifier_name_without_dollar_sign","direct_constant_name","traverse_Identifier_F","traverse_Identifier_FPS","traverse_Identifier_T","traverse_Identifier_CH","traverse_Identifier_CEX","_method_centroid","traverse_Identifier_CEY","traverse_Identifier_CEZ","method_constructor","method_dependency","set_jsep_node","Bbox","ch","Ch","centroid","Centroid","cop_res","CopRes","local","Local","opdigits","Opdigits","Point","PointsCount","Copy","str_chars_count","StrCharsCount","str_concat","StrConcat","str_index","StrIndex","str_sub","StrSub","VECTOR_NAMES","COMPONENT_NAMES","vector_name","_get_value_from_container","vector","_update_from_name_change_bound","_update_from_name_change","new_path","literal","listen_for_name_changes","node_in_path","set_resolved_graph_node","resolved_graph_node","set_unresolved_path","unresolved_path","nodes_in_path","is_index","stamp_node","stamp_value","request_asset_url","add_local_path","local_path_server_url","name_node","sub_string","range_start","range_size","_attribute_names","assign_attribute_line","assign_item_size_line","assign_array_line","var_attribute","cyclic_graph_detected","connect_immutable_dependencies","handle_method_dependencies","handle_method_dependency","node_simple","COMPONENT_NAMES_COLOR","COMPONENT_NAMES_VECTOR2","COMPONENT_NAMES_VECTOR3","COMPONENT_NAMES_VECTOR4","_frame","src_context","_connections","ConnectionsController","_inputs","InputsController","has_inputs","_outputs","OutputsController","has_outputs","_output_connections","_input_connections","add_input_connection","remove_input_connection","last_input_connection","add_output_connection","connections_by_id","remove_output_connection","_graph_node_inputs","_has_named_inputs","_min_inputs_count","_max_inputs_count","_depends_on_inputs","_override_clonable_state","depends_on_inputs","set_min_inputs_count","min_inputs_count","set_max_inputs_count","init_graph_node_inputs","_named_input_connection_points","connection_points","_create_graph_node_input","graph_input_node","init_inputs_clonable_state","init_connections_controller_inputs","containers","eval_required_input","input_error_message","get_named_input_index","has_named_outputs","get_output_index","old_input_node","old_connection","NodeConnection","_on_update_hooks","remove_input","has_named_input","has_input","inputs_clonable_state","FROM_NODE","_inputs_clonable_states","input_cloned","ALWAYS","NEVER","_user_inputs_clonable_states","_default_inputs_clonale_state_values","set_override_clonable_state","OVERRIDE_CLONABLE_STATE_UPDATE","_node_src","_node_dest","_output_index","_input_index","_has_outputs","_has_named_outputs","set_has_no_output","has_named_output","get_named_output_index","_named_output_connection_points","output_indices","_started","_start_time","_previous_timestamp","_nodes_cook_data","_durations_by_name","_durations_count_by_name","profile","total_time","stop","PerformanceNode","update_cook_data","record","current_timestamp","print","print_node_cook_data","print_recordings","performance_nodes","print_objects","performance_node","cook_time_total","print_object","table_entries","table","durations_by_name","durations_count_by_name","durations","names_by_duration","sorted_durations","duration_per_iteration","_cook_time_total","_cook_time_total_with_inputs","_cook_time_total_params","cook_time","cook_time_with_inputs","cook_time_params","cooks_count","cook_time_per_iteration","cook_time_total_with_inputs","cook_time_total_with_inputs_per_iteration","cook_time_total_params","cook_time_total_params_per_iteration","_frame_range","_frame_range_locked","_playing","_fps","_frame_interval","_next_frame_bound","play_next_frame","start_frame","end_frame","start_locked","end_locked","set_fps","_ensure_frame_within_bounds","uniforms_controller","update_frame_dependent_uniform_owners","set_first_frame","include_node_param_components","nodes_by_graph_node_id","params_by_graph_node_id","node_serializer","_frame_dependent_uniform_owners","_frame_dependent_uniform_owners_ids","_resolution","_resolution_dependent_uniform_owners","_resolution_dependent_uniform_owners_ids","add_frame_dependent_uniform_owner","_update_frame_dependent_uniform_owners_ids","remove_frame_dependent_uniform_owner","add_resolution_dependent_uniform_owner","_update_resolution_dependent_uniform_owners_ids","update_resolution_dependent_uniforms","remove_resolution_dependent_uniform_owner","update_resolution_dependent_uniform_owners","CopRegister","run","EventRegister","GlRegister","MatRegister","ObjRegister","SopRegister","poly","EnvMapCopNode","NullCopNode","SwitchCopNode","convert_texture_to_env_map","env_map","pmremGenerator","PMREMGenerator","exrCubeRenderTarget","fromEquirectangular","Extension","load_url","set_texture_for_mapping","ext","_ext","VIDEO_EXTENSIONS","_load_as_video","loader_for_ext","ext_lowercase","EXR","HDR","BASIS","EXRLoader","RGBELoader","setDataType","UnsignedByteType","BasisTextureLoader","setTranscoderPath","detectSupport","TextureLoader","video","onloadedmetadata","source","VIDEO_SOURCE_TYPE_BY_EXT","_default_video_source_type","pixel_data","img","getImageData","PARAM_ENV_DEFAULT","ogg","ogv","mp4","rgbe_error","rgbe_error_code","msg","fgets","lineLimit","consume","len","chunk","fromCharCode","RGBEByteToRGBHalf","floatView","int32View","toHalf","bits","sourceArray","sourceOffset","destArray","destOffset","byteArray","rgbe_header_info","gamma_re","exposure_re","format_re","dimensions_re","header","valid","comments","programtype","format","gamma","exposure","charAt","RGBE_ReadHeader","image_rgba_data","data_rgba","byteValue","scanline_buffer","ptr_end","off","isEncodedRun","rgbeStart","scanline_width","num_scanlines","RGBE_ReadPixels_RLE","numElements","floatArray","halfArray","texData","encoding","generateMipmaps","flipY","transcoderPath","transcoderBinary","transcoderPending","workerConfig","astcSupported","etcSupported","dxtSupported","pvrtcSupported","extensions","BASIS_FORMAT","cTFASTC_4x4","cTFBC3","cTFPVRTC1_4_RGBA","cTFETC1","_createTexture","texturePending","_allocateWorker","mipmaps","cTFBC1","DXT_FORMAT_MAP","cTFPVRTC1_4_RGB","_initTranscoder","jsLoader","binaryLoader","binaryContent","BasisWorker","cTFETC2","cTFBC4","cTFBC5","cTFBC7_M6_OPAQUE_ONLY","cTFBC7_M5","cTFATC_RGB","cTFATC_RGBA_INTERPOLATED_ALPHA","cTFRGBA32","cTFRGB565","cTFBGR565","cTFRGBA4444","DXT_FORMAT","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","_BasisFile","BasisModule","onRuntimeInitialized","BasisFile","initializeBasis","hasAlpha","basisFile","getImageWidth","getImageHeight","levels","getNumLevels","getHasAlpha","cleanup","startTranscoding","mip","mipWidth","mipHeight","dst","getImageTranscodedSizeInBytes","transcodeImage","transcode","CameraMapControlsEventNode","apply_controls","html_element","controls_id","TypedEventNode","EventContainer","_eval_all_params_on_dirty_bound","_eval_all_params_on_dirty","BaseEventNodeClass","ConstantGlNode","FloatToVec3GlNode","OutputGlNode","ParamGlNode","ParamValuetoInitValueMap","v4","typed_visible_options","value_bool","value_int","value_float","value_vec2","value_vec3","value_vec4","update_output_type","_current_param","_current_connection_type","_current_var_name","_params_by_type","current_connection","as_color","_update_if_type_changed_bound","_update_if_type_changed","_uniform_name","from_param","_uniform","_create_uniform","uniform_by_type","callback_bound","_callback","has_value_changed","is_video_texture","set_uniform_value_from_texture","set_uniform_value_from_ramp","param_constructor","_cached_param_value","has_changed","clone_value","MeshBasicMatNode","MeshBasicBuilderMatNode","MeshLambertMatNode","MeshStandardMatNode","PointsMatNode","has_material","_create_assembler_controller","ShaderAssemblerBasic","compile_if_required","_compile","TypedBuilderMatNode","ShaderLib","basic","template_shader","ShaderMaterial","lights","ShaderAssemblerMesh","ASSEMBLER_MAP","DISTANCE","ShaderAssemblerCustomMeshDistance","DEPTH","ShaderAssemblerCustomMeshDepth","DEPTH_DOF","ShaderAssemblerCustomMeshDepthDOF","output_nodes","_update_shaders","new_vertex_shader","new_fragment_shader","_input_names","_dependencies","_param_configs_set_allowed","_function_declared","node_traverser","nodes_by_shader_name","root_nodes_for_shader","leaf_nodes_for_shader","leaf_node","sorted_node_ids","_shaders_collection_controller","ShadersCollectionController","set_current_shader_name","set_code_lines","lines_map","add_code_lines","add_code_line_for_nodes_and_line_type","definition_type","node_definitions","collection","errored","first_definition","CodeFormatter","node_comment","line_wrap","post_line_separator","nodes_count","is_last","add_code_line_for_node_and_line_type","_shader_names","_current_shader_name","_lines_controller_by_shader_name","LinesController","lines_controller","_definitions_by_node_id","_body_lines_by_node_id","LINE_SUFFIXES","LINE_PREFIXES","add_suffix","distanceRGBA","defines","DEPTH_PACKING","RGBADepthPacking","BasicDepthPacking","mNear","mFar","_assembler_controller","inputs_data","selected_children","selected_ids","override","add_custom","node_exporter","components_data","TextureEnvMapParamConfig","texture_env_map_controller","TextureEnvMapController","envMapIntensity","env_map_intensity","use_env_map","TextureEnvMaterial","PointsParamConfig","size_attenuation","sizeAttenuation","AmbientLightObjNode","AreaLightObjNode","DirectionalLightObjNode","HemisphereLightObjNode","PointLightObjNode","SpotLightObjNode","EventsObjNode","MaterialsObjNode","CopObjNode","PostProcessObjNode","GeoObjNode","NullObjNode","OrthographicCameraObjNode","PerspectiveCameraObjNode","FogObjNode","AmbientLight","has_object","AreaLightParamConfig","RectAreaLight","RectAreaLightUniformsLib","initialized","DirectionalLightParamConfig","cast_shadows","shadow_res","shadow_bias","_helper_controller","DirectionalLightHelper","DirectionalLight","bias","mapSize","_target_target","_square","Line","_line_material","rotateX","setScalar","sky_color","ground_color","HemisphereLightHelper","HemisphereLight","groundColor","OctahedronBufferGeometry","_quat","_default_position","_color1","_color2","rotateZ","colors","BufferAttribute","setRotationFromQuaternion","setXYZ","decay","shadow_near","shadow_far","PointLightHelper","PointLight","SphereBufferGeometry","penumbra","SpotLightHelper","SpotLight","_cone","p1","p2","coneLength","coneWidth","DisplayNodeController","_sop_group","_create_sop_group","set_sop_group_name","sop_group","request_display_node","display_node","post_display_flag_node_set_dirty","post_add_node","_children_uuids_dict","_children_length","_request_display_node_container_bound","request_display_node_container","_display_node","set_parent_object","_parent_object","new_display_node","old_display_node","remove_children","new_objects","new_objects_are_different","AxesHelper","DEFAULT","density","exponential","_linear_fog","Fog","getHex","_linear_fogexp2","FogExp2","OrthographicCameraObjParamConfigMixin","OrthographicCameraBackgroundController","OrthographicCamera","horizontal_size","_applied_controls_by_element_id","_controls_node","controls_param","controls_node","dispose_control_refs","controls_aleady_applied","CameraControlsConfig","set_controls_events","dispose_controls","controls_start_listener","on_controls_start","controls_end_listener","on_controls_end","_camera_node_id","_controls","other_config","camera_node_id","overrideMaterial","clearColor","clearDepth","writeBuffer","readBuffer","oldClearColor","oldClearAlpha","oldAutoClear","autoClear","getClearColor","getClearAlpha","setClearColor","setRenderTarget","autoClearColor","autoClearDepth","autoClearStencil","do_render","_animate_method","animate","_canvas","random","style","outline","_set_events","_build","_init_display","_cancel_animate","onresize","on_resize","compute_size_and_aspect","prepare_current_camera","_request_animation_frame_id","requestAnimationFrame","cancelAnimationFrame","BaseViewer","_active","_init_from_scene","set_camera_node","reset_container_class","set_container_class_hovered","_camera_node","_size","_update_graph_node","create_controls","_create_graph_node","update_camera_aspect","_update_size","_get_aspect","offsetHeight","_update_from_camera_container","_bound_on_controls_start","_on_controls_start","_bound_on_controls_end","_on_controls_end","_mousedown_pos","_mouse_distance_travelled","_bound_on_mousedown","_on_mousedown","_bound_on_mousemove","_on_mousemove","_bound_on_mouseup","_on_mouseup","MouseEvent","onwebglcontextlost","_on_webglcontextlost","onwebglcontextrestored","_on_webglcontextrestored","request_animation_frame_id","PerspectiveCameraObjParamConfigMixin","PerspectiveCameraBackgroundController","PerspectiveCamera","SCREEN_COORD","bl","br","tl","tr","CORNER_NAMES","_bg_corner","_bg_center","corner_name","_update_corner_vector","distanceTo","z_ratio","desired_ratio","coord","setFromCamera","ray","direction","origin","AddSopNode","AnimationCopySopNode","AnimationMixerSopNode","AttribAddMultSopNode","AttribCopySopNode","AttribCreateSopNode","AttribDeleteSopNode","AttribNormalizeSopNode","AttribPromoteSopNode","AttribRemapSopNode","AttribRenameSopNode","AttribTransferSopNode","BboxScatterSopNode","BlendSopNode","BoxSopNode","CircleSopNode","ColorSopNode","CopySopNode","DataSopNode","DataUrlSopNode","DelaySopNode","DeleteSopNode","FaceSopNode","FileSopNode","FuseSopNode","HexagonsSopNode","HierarchySopNode","JitterSopNode","LayerSopNode","LineSopNode","MaterialSopNode","MergeSopNode","NoiseSopNode","NormalsSopNode","NullSopNode","ObjectMergeSopNode","OcclusionSopNode","PeakSopNode","PlaneSopNode","PointSopNode","PolywireSopNode","RaySopNode","ResampleSopNode","ScatterSopNode","SkinSopNode","ShadowsSopNode","SphereSopNode","SwitchSopNode","TextSopNode","TorusSopNode","TorusKnotSopNode","TransformSopNode","TubeSopNode","UvProjectSopNode","create_point","connect_to_last_point","_create_point","_get_points","index_array","_positions","_get_positions","_triangle","_get_triangle","_deltas","_get_deltas","getArea","random_position","seed","weights","deltas","attrib_value_at_position","barycentric_coordinates","getBarycoord","new_attrib_value","sum","point_values","weighted_value","interpolated_value","face","intersect_point","point_indices","position_attrib_array","point_positions","attrib_array","dist_to_points","distance_total","point_indx","count_by_type","names_by_type","sizes_by_name","types_by_name","object_attribute_names","core_group_target","target_object","src_animations","prepare","PARAM_CALLBACK_prepare","_previous_time","_mixer","_actions_by_name","_values_by_param_name","_update_mixer","create_mixer","_animation_target","AnimationMixer","prev_value","action","clipAction","materials_by_id","object3d","morphTargets","_update_mixer_weights","_update_mixer_time","cache_value","setEffectiveWeight","prepare_animation_mixer","pre_add","post_add","_update_attrib","tnew_name","core_group_dest","core_group_src","copy_vertex_attribute_between_core_groups","src_objects","dest_objects","dest_geometry","copy_vertex_attribute_between_geometries","src_attrib","src_points_count","dest_points_count","sub_array","dest_name","class","value1","for_entities","value2","value3","value4","_x_arrays_by_geometry_uuid","_y_arrays_by_geometry_uuid","_z_arrays_by_geometry_uuid","_w_arrays_by_geometry_uuid","add_point_attribute","add_object_attribute","add_numeric_attribute_to_points","add_string_attribute_to_points","add_numeric_attribute_to_object","add_string_attribute_to_object","vparam","component_param","arrays_by_geometry_uuid","_init_array_if_required","tmp_array","string_values","current_array","delete_vertex_attribute","delete_object_attribute","change_name","_normalize_attribute","normalized_values","normalized_value","target_name","AttribPromoteMode","PromoteModeMenuEntries","MIN","MAX","FIRST_FOUND","class_from","class_to","_values_per_attrib_name","_filtered_values_per_attrib_name","_core_group","_core_object","find_values","filter_values","set_values","find_values_from_points","find_values_from_object","set_values_to_points","set_values_to_object","_remap_attribute","only_integer_values","sorted_values","sorted_value","dest_group","max_samples_count","distance_threshold","blend_width","_core_group_dest","dest_points","_core_group_src","_attrib_names","_error_if_attribute_not_found_on_second_input","_build_octree_if_required","_add_attribute_if_required","_transfer_attributes","second_input_changed","_octree_timestamp","_prev_param_src_group","points_src","_octree","CoreOctree","set_points","_transfer_attributes_for_point","dest_point","total_dist","nearest_points","find_points","_interpolate_points","point_dest","src_points","CoreInterpolate","perform","blend_with","_interpolate_with_1_point","_interpolate_with_multiple_points","point_src","position_dest","position_src","value_src","_weighted_value_from_distance","_weight_from_distance","value_dest","blend","weighted_values_src","current_position","other_positions","_weights_from_2","_weights_from_3","dist_to_positions","other_position","OctreeNode","max_points_count","sphere","Sphere","found_points","intersects_sphere","points_in_sphere","_bbox","_level","_leaves_by_octant","_points_by_octant_id","_leaves","_bounding_boxes_by_octant","_bounding_boxes_by_octant_prepared","_center","intersectsSphere","accumulated_points","containsPoint","leaf","octant_ids","octant_id","create_leaf","_leaf_bbox","_octant_id","_prepare_leaves_bboxes","_bbox_center","x_pos","y_pos","z_pos","corner","bbox_centers","bbox_size_quarter","bbox_center","object0","object1","core_group0","core_group1","objects0","objects1","attrib0","attrib1","c0","c1","attrib0_array","attrib1_array","divisions","_core_transform","_cook_with_input","_cook_without_input","BoxBufferGeometry","DEFAULT_UP","_create_circle","_create_disk","CircleBufferGeometry","DEFAULT_COLOR","from_attribute","as_hsv","_r_arrays_by_geometry_uuid","_g_arrays_by_geometry_uuid","_b_arrays_by_geometry_uuid","_set_from_attribute","_eval_expressions","_eval_simple_values","_create_init_color","src_attrib_size","src_array","dest_array","dest_i","src_i","CoreColor","set_hsv","_update_from_param","tmp_array_r","tmp_array_g","tmp_array_b","_commit_tmp_values","target_array","euclideanModulo","setHSL","transform_only","copy_attributes","attributes_to_copy","use_copy_expr","_attribute_names_to_copy","container0","container1","cook_with_template","cook_without_template","instance_core_group","template_core_group","template_points","instancer","CoreInstancer","instance_matrices","matrices","_copy_moved_objects_on_template_points","_copy_moved_object_on_template_point","template_point","set_point","_get_moved_objects_for_template_point","moved_object","_copy_attributes_from_template","_stamp_instance_group_if_required","moved_objects","_copy_moved_objects_for_each_instance","_copy_moved_objects_for_instance","set_global_index","stamped_instance_core_group","_stamp_node","create_stamp_node","CopyStamp","SCALE","PSCALE","EYE","DEFAULT_UV","_group_wrapper","_matrices","_is_pscale_present","_is_scale_present","_is_normal_present","_is_up_present","_do_rotate_matrices","_matrix_from_point","pscale","scale_matrix","makeScale","translate_matrix","makeTranslation","multiply","rotate_matrix","eye","create_instance_buffer_geo","geometry_to_instance","instance_pts","InstancedBufferGeometry","instances_count","scales","orients","has_color","instance_pt","index3","index4","has_uv","index2","InstancedBufferAttribute","pt","_global_index","_point","DEFAULT_DATA_STR","json_data_keys_prefix","_on_load","_on_error","inputs_contents","ComparisonOperator","ComparisonOperatorMenuEntries","invert","hide_objects","by_object_type","by_expression","by_attrib","attrib_string","attrib_numeric","attrib_comparison_operator","by_bbox","bbox_size","by_visible","keep_points","_marked_for_deletion_per_object_index","_bbox_cache","_eval_for_points","_eval_for_objects","objects_to_keep","_eval_expressions_for_objects","_eval_type_for_objects","_eval_attrib_for_objects","marked_for_deletion","object_index","point_objects_from_deleted_objects","_point_object","init_points_count","_eval_expressions_for_points","_eval_attrib_for_points","_eval_bbox_for_points","kept_points","keep_point","first_attrib_value","comparison_attrib_value","_comparison","attrib_ComparisonOperator","object_type_name","attrib_float","in_bbox","core_points","make_faces_unique","add_face_center_attribute","add_face_id","_make_faces_unique","_add_face_center_attribute","_add_face_id","_transform_faces","current_value","face_center","fi","pi","always_reference_asset","CoreLoaderGeometry","on_success","on_error","load_auto","on_load_success","object2","on_load_succes_gltf","on_load_succes_drc","gltf","loader_for_gltf","loader_for_glb","loader_for_drc","loader_for_obj","GLTFLoader","draco_loader","setDRACOLoader","OBJLoader","object_pattern","material_library_pattern","material_use_pattern","map_use_pattern","ParserState","vertices","materialLibraries","startObject","fromDeclaration","previousMaterial","currentMaterial","_finalize","smooth","startMaterial","previous","inherited","groupCount","mtllib","isArray","groupStart","groupEnd","cloned","lastMultiMaterial","mi","declared","finalize","parseVertexIndex","parseNormalIndex","parseUVIndex","addVertex","addVertexPoint","addVertexLine","addNormal","addColor","addUV","addUVLine","addFace","ua","ub","uc","na","nb","nc","vLen","ib","ic","uvLen","nLen","addPointGeometry","vi","addLineGeometry","uvi","setMaterials","lineFirstChar","trimLeft","trim","vertexData","faceVertices","vertex","vertexParts","v1","lineParts","lineVertices","lineUVs","li","llen","parts","pointData","exec","concat","hasVertexColors","buffergeometry","mesh","createdMaterials","miLen","sourceMaterial","materialPoints","materialLine","flatShading","timeEnd","dist","_fuse_core_object","points_by_position","hexagon_radius","points_only","CoreGeometryOperationHexagon","_param_size","_param_hexagon_radius","_param_points_only","side_length","half_side_length","HierarchyMode","HIERARCHY_MODES","ADD_PARENT","REMOVE_PARENT","_add_parent_to_core_group","_remove_parent_from_core_group","_add_parent_to_object","new_parent","_add_new_parent","new_parent2","_remove_parent_from_object","new_child","current_children","_get_children_from_objects","amount","last_pt","apply_to_children","core_groups","grand_child","apply_material","INPUT_NAME","compact","input_core_group","_make_compact","objects_by_type","merged_objects","isLineSegments","Operation","Operations","ADD","SET","MULT","SUBSTRACT","DIVIDE","freq","octaves","amp_attenuation","freq_increase","use_normals","operation","compute_normals","_simplex_by_seed","_rest_points","core_group_rest","_rest_core_group_timestamp","simplex","_get_simplex","target_attrib_size","rest_point","current_attrib_value","noise_value","noise","_fbm","divide","amplitude","noise3d","_create_simplex","random_generator","SimplexNoise","grad3","grad4","perm","dot3","dot4","xin","yin","i1","j1","G2","x0","y0","x1","y1","x2","y2","ii","jj","gi0","gi1","gi2","t0","t1","t2","zin","k1","i2","j2","k2","G3","z0","z1","z2","x3","y3","z3","kk","gi3","t3","noise4d","l1","l2","i3","j3","k3","l3","F4","G4","w0","w1","w2","w3","x4","y4","z4","w4","ll","gi4","t4","edit","update_x","update_y","update_z","recompute","_eval_expressions_for_core_group","_invert_normals","_eval_expressions_for_core_object","normal_attrib","geometry_node","import_input","samples","sep","buffer_resolution","_process_occlusion_on_object","normal_array","aoSampler","cells","sample","ao","report","child_object","ROTATE_START","ROTATE_END","use_segments_count","_create_plane","size2d","update_normals","tmp_array_x","tmp_array_y","tmp_array_z","do_update_param","value_param","do_update","new_array","_array_for_component","DEFAULT_R","DEFAULT_S","segments_radial","closed","_geometries","_create_tube","line_segment","current_points","_create_tube_from_points","circle_template","circles","new_circle","circle","prev_circle","_skin","MAT_DOUBLE_SIDED","transfer_face_normals","_bound_assign_mat","_assign_double_sided_material_to_object","_raycaster","double_sided_material","core_group_collision","first_intersect","_assign_double_sided_material_to_core_group","intersectObjects","METHOD","CURVE_TYPE","POINTS_COUNT","SEGMENT_LENGTH","CURVE_TYPES","CENTRIPETAL","CHORDAL","CATMULLROM","curve_type","tension","segment_length","resampled_objects","resampled_object","_resample","_create_curve_from_points","old_curve_positions","curve","CatmullRomCurve3","new_curve_points","_get_points_from_curve","getSpacedPoints","getLength","transfer_attributes","attributes_to_transfer","add_id_attribute","areas_thresholds","area_sum","area_by_face_index","area","sorted_faces","attrib_values_by_name","face_index","cast_shadow","receive_shadow","process_one_input","process_two_inputs","line_segments0","_get_line_segments","first_line_segment","prev_src_geometry","line_segments1","line_segments","smallest_array","largest_array","other_line_segment","other_geo","SphereType","SPHERE_TYPE","isocahedron","SPHERE_TYPES","ISOCAHEDRON","angle_range_x","angle_range_y","detail","_create_default_sphere","_create_default_isocahedron","IcosahedronBufferGeometry","TEXT_TYPE","opentype","TEXT_TYPES","FLAT","STROKE","font","multiline","extrude","stroke_width","_font_loader","FontLoader","_loaded_fonts","_load_url","_create_geometry_from_type_mesh","_create_geometry_from_type_flat","_create_geometry_from_type_line","_create_geometry_from_type_stroke","displayed_text","parameters","curveSegments","TextBufferGeometry","err","shapes","_get_shapes","ShapeBufferGeometry","shapes_from_font","getPoints","_svg_loader","_load_svg_loader","getStrokeStyle","shape","pointsToStroke","holeShapes","holes","hole","generateShapes","elements2","_load_ttf","_load_json","_ttf_loader","_load_ttf_loader","fnt","TTFLoader","reversed","arraybuffer","reverseCommands","commands","command","glyphs","unitsPerEm","glyphIndexMap","cmap","unicodes","unicode","glyph","token","advanceWidth","x_min","xMin","x_max","xMax","fromCodePoint","familyName","getEnglishName","ascender","descender","underlinePosition","tables","post","underlineThickness","head","yMin","yMax","original_font_information","radius_tube","segments_tube","TorusBufferGeometry","TorusKnotBufferGeometry","look_at","pivot","applyMatrix4","segments_height","cap","CylinderBufferGeometry","_camera_controller","CameraController","_update_uvs_from_camera","_processed_core_group","_camera_object","set_target","remove_target","look_at_target","matrixWorld","uvw","_vector_in_camera_space","obj_world_matrix","project","_update_always","_listener_added","_listener","_execute_callback","_remove_camera_event","old_target","_target","_add_camera_event","set_update_always","new_update_always","_current_event_name","CHANGE","MOVEEND","load_data","SceneJsonImporter","importer","process_ui_data","create_nodes","set_selection","set_flags","set_params","from_data_custom","process_inputs_data","set_inputs","process_nodes_ui_data","importers","input_data","input_node_name","node_data","param_data","_is_param_data_complex","_process_param_data_complex","_process_param_data_simple","has_param_and_same_type","LINE_BREAK_REGEXP","_commands","_index_at_scene_save","mark_scene_as_saved","_nodes","parent_var_name","position_x_offset","add_process","process_with_existing_nodes","add_existing_nodes","multi_push","create_function_declare","create_function_call","set_up","child_line","child_lines","NodesCodeExporter","EventName","_on_keypress_bound","_on_keydown_bound","_on_keyup_bound","register_processor","processor","_processor","deregister_processor","_process_on_key_event","PRESS","DOWN","event_type","on_key_press","go_up","go_down","on_key_down","on_key_up","_new_name","_old_name","_uv_name","set_texture_allocations_controller","_texture_allocations_controller","variable","globals_geometry_handler","texture_variable","add_particles_sim_uv_attribute","allocation","var_name_texture","texture_name","texture_definition","particles_sim_uv_attrib_definition","GlobalsTextureHandler","UV_ATTRIB","particles_sim_uv_varying_definition","UV_VARYING","PARTICLE_SIM_UV","CopyShader","ShaderPass","textureID","fsQuad","MaskPass","writeValue","clearValue","setMask","setLocked","stencil","setTest","setOp","REPLACE","setFunc","setClear","EQUAL","KEEP","ClearMaskPass","renderTarget","stencilBuffer","_pixelRatio","getPixelRatio","_height","WebGLRenderTarget","renderTarget1","renderTarget2","copyPass","clock","Clock","swapBuffers","pass","insertPass","isLastEnabledPass","passIndex","deltaTime","getDelta","currentRenderTarget","getRenderTarget","maskActive","NOTEQUAL","effectiveWidth","effectiveHeight","pixelRatio","_h","$createElement","_c","_self","staticClass","on","$event","_e","attrs","staticRenderFns","_withStripped","_vm","click","_v","_s","mouseleave","_l","refInFor","mouseenter","domProps","keypress","keyup","keydown","is_split","split_container_class_object","cell_style_objects","split_panel_init_properties","cell_panel_ids","delete_split_panel","split_panel_separator_style_object","mousedown","panel_type","tab_class_objects","set_current_panel_index","tab_delete_allowed","remove_tab","available_panel_types","add_tab","split_types","set_split_mode","current_panel_type","tag","created","on_component_created","path_element","submit","directives","rawName","modifiers","composing","_n","blur","$forceUpdate","_i","change","$$a","$$el","$$c","$$i","_t","toggle_tab_menu","display_go_up_button","canvas_class_object","wheel","on_wheel","zoom_container_style_object","pan_container_style_object","mousemove","mouseup","selection_rectangle_style_object","node_creation_rectangle_style_object","json_child","capture_node_for_move","on_capture_node_for_move","capture_node_src_for_connection","on_capture_node_src_for_connection","capture_node_dest_for_connection","on_capture_node_dest_for_connection","capture_node_final_for_connection","on_capture_node_final_for_connection","set_display_flag","on_set_display_flag","set_bypass_flag","on_set_bypass_flag","tab_menu_opened","tab_menu_style_object","close_tab_menu","on_tab_menu_select","first_selected_json_node","selected_node_name","selected_node_type","display_top_folders","top_folder_json_params","folder_class_objects","set_active_folder_id","selected_node_json_params_for_current_folder","rowData","on_body_mousedown","on_body_mouseup","dblclick","on_body_dblclick","contextmenu","display_icon","icon","error_flag_container_style_object","has_bypass_flag","bypass_flag_container_style_object","bypass_flag_class_object","bypass_flag_style_object","on_bypass_flag_click","has_display_flag","display_flag_container_style_object","display_flag_class_object","display_flag_style_object","on_display_flag_click","name_container_style_object","comment_container_style_object","display_comment","enter_button_container_style_object","open_node","inputs_container_style_object","available_inputs","connection_pixel_input_class_objects","inputs_pixel_style_objects","connection_name_element_class_objects","input_titles","on_input_mousedown","on_input_mouseup","output_container_style_object","available_outputs","connection_pixel_output_class_objects","outputs_pixel_style_objects","output_names","output_titles","on_output_mousedown","on_output_mouseup","input_valid_states","input_json_nodes","display_node_info","paste","readonly","json_component","on_slider_mousedown","on_slider_mouseup","on_slider_change","on_slider_drag","blue","_m","curve_point","cx","cy","prop_name","use","productionTip","EditorStore","_loaded","load_scene","element_or_id","set_on_save_callback","_on_save_callback","el","EngineMutation","store_json_node","update_node_inputs_and_outputs","EngineStoreModule","namespaced","scene_uuid","json_nodes_by_name","json_root","children_id","compacted_children","json_params","mutations","SCENE","SCENE_FRAME_UPDATED","SCENE_FRAME_RANGE_UPDATED","SCENE_PLAY_STATE_UPDATED","NODE_ERROR_UPDATED","NODE_UI_DATA_POSITION_UPDATED","NODE_UI_DATA_COMMENT_UPDATED","NODE_SELECTION_UPDATED","NODE_DISPLAY_FLAG_UPDATED","NODE_BYPASS_FLAG_UPDATED","NODE_NAME_UPDATED","NODE_INPUTS_UPDATED","NODE_NAMED_INPUTS_UPDATED","NODE_NAMED_OUTPUTS_UPDATED","NODE_ADD_PARAMS_TO_STORE","NODE_PARAMS_UPDATED","override_clonable_state_update","payload","NODE_DELETED","parent_node_id","parent_data","child_id","NODE_CREATED","PARAM_RAW_INPUT_UPDATED","PARAM_VALUE_UPDATED","PARAM_EXPRESSION_UPDATED","PARAM_ERROR_UPDATED","PARAM_VISIBLE_STATE","EditorClipboardMutation","EditorClipboardStateModule","NODE_ID","PARAM_ID","EditorContextMenuMutation","reset_menu","EditorContextMenuStateModule","POSITION","EditorDialogAlertMutation","EditorDialogAlertStateModule","on_close","SHOW","HIDE","EditorDialogConfirmMutation","EditorDialogConfirmStateModule","EditorDialogPromptMutation","EditorDialogPromptStateModule","EditorNetworkGetter","EditorNetworkMutation","EditorNetworkStateModule","node_ids_being_moved","NODE_IDS_BEING_MOVED","SET_NODE_IDS_BEING_MOVED","RESET_NODE_IDS_BEING_MOVED","EditorNumericSliderMutation","EditorNumericSliderStateModule","OPEN","CLOSE","EditorPanelMutation","EditorPanelStateModule","FULLSCREEN_PANEL_ID","EditorPanelNodeSelectorMutation","EditorPanelNodeSelectorStateModule","PanelTypeS","ASSET","CUSTOM_NODE_EDITOR","PARAM_EDIT","PERFORMANCE","SPREADSHEET","GUEST_PanelTypeS","set_panel_types_from_split_panel","remaining_panel","set_panel_types_from_json","new_panel_types","root_line","camera_path","add_semi_colons","SceneCodeExporter","slider_start_value","slider_start_expression","parent_node_json","url_params","URLSearchParams","location","search","perf","Store","EditortoreModule","EditorClipboardStoreController","EditorContextMenuStoreController","EditorDialogAlertStoreController","EditorDialogConfirmStoreController","EditorDialogPromptStoreController","network","EditorNetworkStoreController","EditorNumericSliderStoreController","EditorPanelStoreController","EditorPanelNodeSelectorStoreController","EditorStoreControllerClass","_store","commit","EditorClipboardStoreControllerClass","local_state","EditorContextMenuStoreControllerClass","EditorDialogAlertStoreControllerClass","options_with_callback","EditorDialogConfirmStoreControllerClass","EditorDialogPromptStoreControllerClass","EditorNetworkStoreControllerClass","set_node_ids_being_moved","reset_node_ids_being_moved","EditorNumericSliderStoreControllerClass","EditorPanelStoreControllerClass","Event","EditorPanelNodeSelectorStoreControllerClass","EngineStoreControllerClass","update_scene","_commit","add_node_params_to_store","mutation","current_node_id","current_camera_name","current_node_selection_ids","display_loader","hide_loader","___CSS_LOADER_API_IMPORT___","MultiplePanelSplitLabel","MultiplePanelSplitAction","left_column_init_properties","network_init_properties","init_properties_for_split_panels","split_ratio","cells_visible_state","overriden_split_ratio","is_split_horizontally","is_split_vertically","DELETE","style_keys","style0","style1","current_element_bbox","ratio","set_camera_helper_node","set_parent_node","save_camera_history_for_json_node","node_graph_id","prev_node_graph_id","node_history","delete_selected_nodes","NodeDeleteCommand","cut","copy_from_node","paste_in_node","frame_selection","close_node_create","_undo_code_lines","_required_nodes_code_by_name","_required_outputs_code_by_name","required_nodes_by_name","_remove_node","_change_display_flag","start_lines","end_lines","create_node_function","_revert_display_flag","add_create","add_name","add_children","add_selection","add_position","add_input_clonable_state","add_bypass_flag","add_display_flag","ls","function_name","create_node_line","input_exporter","input_connection_point_name","x_offset","param_line","as_code_default_value_string","component_line","escaped_expression","pan_in_progress","zoom_in_progress","move_start","pan_start","zoom_start","update_tab_menu_position","pan_progress","zoom_progress","move_progress","move_in_progress","node_move_barely_moved","mouse_barely_moved","move_end","pan_end","zoom_end","on_context_menu","json_camera_history","node_connection_data","connection_src_json_node","connection_dest_json_node","set_node_creation_helper_node","old_val","capture_node","capture_node_src","capture_node_dest","capture_node_final","SetDisplayFlagCommand","SetBypassFlagCommand","_first_node","_old_node","_new_display_state","_current_state","set_selection_helper_node","tab_menu_mouse_position","_set_tab_menu_state","open_tab_menu","last_element","menu_node_id","v_padding","display_info","hide_info","on_name_mouseup","marginLeft","named_element","non_named_element","position_v","auto_textures_size","max_textures_size","textures_size","ShaderAssemblerParticles","gpu_controller","ParticlesSystemGpuComputeController","render_controller","ParticlesSystemGpuRenderController","_reset_material_if_dirty_bound","_reset_material_if_dirty","reset_gpu_compute_and_set_dirty","reset_render_material","is_on_frame_start","init_render_material","reset_particle_groups","init_core_group","compute_similation","run_assembler","reset_gpu_compute","_find_root_nodes","points_mat","points_mat_constant_point_size","points_mat_output1","create_points_mat","setup_shader_names_and_variables","update_shaders","TextureAllocationsController","allocate_connections_from_root_nodes","texture_allocations_controller","add_export_body_line","export_node","is_importing","_handle_globals_frame","_handle_globals_default","attrib_read","_allocations","_next_allocation_index","leaf_nodes","variables","TextureVariable","add_graph_node_id","output_names_attributes","allocate_variables","allocate_variable","new_variable","allocated","has_variable","has_space_for_variable","add_variable","new_allocation","TextureAllocation","next_allocation_name","explicit_shader_names","allocation_for_shader_name","input_names_for_node","_variables","set_allocation","variables_for_input_node","_allocation","_graph_node_ids","_particles_group_objects","assign_render_material","_render_material","update_render_material_uniforms","getCurrentRenderTarget","mat_node","new_texture_allocations_json","_texture_allocations_json","_simulation_restart_required","variables_by_name","_created_textures_by_name","_used_textures_size","init_particle_group_points","create_gpu_compute","_gpu_compute","_particles_core_group","_last_simulated_frame","_compute_simulation","update_simulation_material_uniforms","nearest_power_of_two","isPowerOfTwo","max_particles_count","_init_particles_uvs","_renderer","GPUComputationRenderer","renderTargets","all_variables","addVariable","setVariableDependencies","_create_texture_render_targets","_fill_textures","create_simulation_material_uniforms","uv_attrib_name","attribute_constructor","created_textures_by_name","texture_allocation","texture_variables","texture_position","createTexture","_restart_simulation","renderTexture","selected_geometries","sizeX","sizeY","currentTextureIndex","passThruUniforms","passThruTexture","passThruShader","createShaderMaterial","addResolutionDefine","materialShader","toFixed","computeFragmentShader","variableName","initialValueTexture","capabilities","isWebGL2","maxVertexTextures","createRenderTarget","depVar","found","nextTextureIndex","dl","doRenderTarget","getAlternateRenderTarget","sizeXTexture","sizeYTexture","navigator","userAgent","depthBuffer","move_progress_position","create_position","event_helper","_node_type","activated","NodeCreateCommand","_node_pos","ZOOM_PROJ_VECTOR","pan_start_mouse_position","pan_start_camera_position","mouse_position","pan_progress_position","_pan_in_progress","zoom_start_mouse_position","zoom_current_mouse_position","_zoom_offset","_zoom_in_progress","min_zoom","max_zoom","is_pan_in_progress","is_zoom_in_progress","pan_mouse_offset","new_zoom","set_zoom","wheel_event","selected_nodes","expandByPoint","_nodes_by_parent_node_type","child_nodes","create_code_for_nodes","write_cache","read_cache","code_wrapped_timestamp","code_wrapped_function_name","code_wrapped","eval","new_node_ids","new_nodes","camera_position","offset_nodes","positions_xs","min_x","max_x","cache_name","localStorage","setItem","getItem","node_start_positions","start_position","move_progress_current_position","move_offset","_move_in_progress","_captured_node","has_captured_nodes","captured_nodes","new_pos","NodeMoveCommand","_offset","_inverted_offset","move_position","both_end_captured","create_connection","has_captured_node","disconnect_dest","NodeConnectCommand","_old_node_src","_old_node_output_index","SelectionMethod","end_position","node_around_mouse_position","capture_nodes","NodeSelectCommand","clear_selection","move_barely_moved","REMOVE","OVERRIDE","nodes_inside_box","node_around_mouse","intersectsBox","subScalar","_method","_old_nodes","selected_node_options","active_folder_param_id","history_active_folder_id_by_param_graph_id","_is_json_param_top_folder","param_ids_by_top_folder_ids","last_folder_param_id","dict","init_folder_name","folder_id","_new_comment","_old_comment","_new_state","_old_state"],"mappings":"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","file":"polygonjs-editor.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t9: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1283,7,6,5,0,3,2,4,1,8]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// import {BaseNode} from 'src/engine/nodes/_Base';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamOptions} from 'src/engine/params/utils/OptionsController';\nimport {RampParam} from 'src/engine/params/Ramp';\nimport {ParamValuesTypeMap} from '../../../params/types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from '../../../params/types/ParamInitValuesTypeMap';\nimport {ParamConstructorMap} from '../../../params/types/ParamConstructorMap';\nimport {ParamOptionsByTypeMap} from '../../../params/types/ParamOptionsByTypeMap';\n\n// function _ParamCheckNameConsistency<T extends BaseNode>(name: string, target: T, key: keyof T, type: ParamType) {\n// \tconst key_s = key as string;\n// \tif (key_s != `_param_${name}`) {\n// \t\tconsole.warn('param name inconsistent');\n// \t}\n// \tconst param = target.params.get(name);\n// \tif (param && param.type != type) {\n// \t\tconsole.warn('param type inconsistent');\n// \t}\n// }\n// export const _ParamBoolean = function ParamF(name: string) {\n// \treturn <T extends BaseNode>(target: T, key: keyof T) => {\n// \t\t_ParamCheckNameConsistency(name, target, key, ParamType.BOOLEAN);\n// \t\tObject.defineProperty(target, key, {\n// \t\t\tget: () => target.params.boolean(name),\n// \t\t});\n// \t};\n// };\n// export const _ParamFloat = function ParamF(name: string) {\n// \treturn <T extends BaseNode>(target: T, key: keyof T) => {\n// \t\t_ParamCheckNameConsistency(name, target, key, ParamType.FLOAT);\n// \t\tObject.defineProperty(target, key, {\n// \t\t\tget: () => target.params.float(name),\n// \t\t});\n// \t};\n// };\n// export const _ParamFloat = function ParamF(default_value: number, options?: ParamOptions) {\n// \treturn <T extends NodeParamsConfig>(target: T, key: string) => {\n// \t\t// _ParamCheckNameConsistency(name, target, key, ParamType.FLOAT);\n// \t\t// const config = new ParamConfig(ParamType.FLOAT, default_value, options);\n// \t\t// target.add_config(key, config);\n// \t\t// target.set_default_value(key, default_value);\n// \t\t// target.set_options(key, options);\n// \t\t// Object.defineProperty(target.options, key, {\n// \t\t// \tget: () => target.params.float(name),\n// \t\t// });\n// \t};\n// };\n// export const _ParamString = function ParamF(name: string) {\n// \treturn <T extends BaseNode>(target: T, key: keyof T) => {\n// \t\t_ParamCheckNameConsistency(name, target, key, ParamType.STRING);\n// \t\tObject.defineProperty(target, key, {\n// \t\t\tget: () => target.params.string(name),\n// \t\t});\n// \t};\n// };\n// export const _ParamVector2 = function ParamF(name: string) {\n// \treturn <T extends BaseNode>(target: T, key: keyof T) => {\n// \t\t_ParamCheckNameConsistency(name, target, key, ParamType.VECTOR2);\n// \t\tObject.defineProperty(target, key, {\n// \t\t\tget: () => target.params.vector2(name),\n// \t\t});\n// \t};\n// };\n// export const _ParamVector3 = function ParamF(name: string) {\n// \treturn <T extends BaseNode>(target: T, key: keyof T) => {\n// \t\t_ParamCheckNameConsistency(name, target, key, ParamType.VECTOR3);\n// \t\tObject.defineProperty(target, key, {\n// \t\t\tget: () => target.params.vector3(name),\n// \t\t});\n// \t};\n// };\n// export const _ParamColor = function ParamF(name: string) {\n// \treturn <T extends BaseNode>(target: T, key: keyof T) => {\n// \t\t_ParamCheckNameConsistency(name, target, key, ParamType.COLOR);\n// \t\tObject.defineProperty(target, key, {\n// \t\t\tget: () => target.params.color(name),\n// \t\t});\n// \t};\n// };\n// declare global {\n// \tconst ParamB: typeof _ParamBoolean;\n// \tconst ParamF: typeof _ParamFloat;\n// \tconst ParamS: typeof _ParamString;\n// \tconst ParamV2: typeof _ParamVector2;\n// \tconst ParamV3: typeof _ParamVector3;\n// \tconst ParamC: typeof _ParamColor;\n// }\n// class ParamConfig<T extends ParamType> {\n// \tconstructor(readonly type: T, readonly default_value: ParamValuesTypeMap[T], readonly options: ParamOptions = {}) {}\n// }\nexport class ParamTemplate<T extends ParamType> {\n\treadonly value_type!: ParamValuesTypeMap[T];\n\treadonly param_class!: ParamConstructorMap[T];\n\t// readonly options?: ParamOptions;\n\n\tconstructor(public type: T, public init_value: ParamInitValuesTypeMap[T], public options?: ParamOptions) {}\n}\n\n// class Test1 {\n// \ta: number\n// \tb: string\n// }\n// type test = Extract<typeof Test1, string>;\n// type test2 = Pick<typeof Test1, 'b'>;\n// type test3 = Test1['b'];\n// type test2 = keyof BoxSopParamConfig;\nexport class ParamConfig {\n\t// static _GENERIC<T extends ParamType> (type: T, init_value: ParamInitValuesTypeMap[T], options?: ParamOptions) {\n\t// \treturn new ParamTemplate<T>(type, init_value, options);\n\t// }\n\t// static BUTTON(init_value: ParamInitValuesTypeMap[ParamType.BUTTON], options?: ParamOptions) {\n\t// \treturn this._GENERIC<ParamType.BUTTON>(ParamType.BUTTON, init_value, options)\n\t// }\n\tstatic BUTTON(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.BUTTON],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.BUTTON]\n\t) {\n\t\treturn new ParamTemplate<ParamType.BUTTON>(ParamType.BUTTON, init_value, options);\n\t}\n\tstatic BOOLEAN(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.BOOLEAN],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.BOOLEAN]\n\t) {\n\t\treturn new ParamTemplate<ParamType.BOOLEAN>(ParamType.BOOLEAN, init_value, options);\n\t}\n\tstatic COLOR(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.COLOR],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.COLOR]\n\t) {\n\t\treturn new ParamTemplate<ParamType.COLOR>(ParamType.COLOR, init_value, options);\n\t}\n\tstatic FLOAT(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.FLOAT],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.FLOAT]\n\t) {\n\t\treturn new ParamTemplate<ParamType.FLOAT>(ParamType.FLOAT, init_value, options);\n\t}\n\tstatic FOLDER(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.FOLDER] = null,\n\t\toptions?: ParamOptionsByTypeMap[ParamType.FOLDER]\n\t) {\n\t\treturn new ParamTemplate<ParamType.FOLDER>(ParamType.FOLDER, init_value, options);\n\t}\n\tstatic INTEGER(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.INTEGER],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.INTEGER]\n\t) {\n\t\treturn new ParamTemplate<ParamType.INTEGER>(ParamType.INTEGER, init_value, options);\n\t}\n\tstatic OPERATOR_PATH(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.OPERATOR_PATH],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.OPERATOR_PATH]\n\t) {\n\t\treturn new ParamTemplate<ParamType.OPERATOR_PATH>(ParamType.OPERATOR_PATH, init_value, options);\n\t}\n\tstatic RAMP(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.RAMP] = RampParam.DEFAULT_VALUE,\n\t\toptions?: ParamOptionsByTypeMap[ParamType.RAMP]\n\t) {\n\t\treturn new ParamTemplate<ParamType.RAMP>(ParamType.RAMP, init_value, options);\n\t}\n\tstatic SEPARATOR(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.SEPARATOR] = null,\n\t\toptions?: ParamOptionsByTypeMap[ParamType.SEPARATOR]\n\t) {\n\t\treturn new ParamTemplate<ParamType.SEPARATOR>(ParamType.SEPARATOR, init_value, options);\n\t}\n\tstatic STRING(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.STRING] = '',\n\t\toptions?: ParamOptionsByTypeMap[ParamType.STRING]\n\t) {\n\t\treturn new ParamTemplate<ParamType.STRING>(ParamType.STRING, init_value, options);\n\t}\n\tstatic VECTOR2(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.VECTOR2],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.VECTOR2]\n\t) {\n\t\treturn new ParamTemplate<ParamType.VECTOR2>(ParamType.VECTOR2, init_value, options);\n\t}\n\tstatic VECTOR3(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.VECTOR3],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.VECTOR3]\n\t) {\n\t\treturn new ParamTemplate<ParamType.VECTOR3>(ParamType.VECTOR3, init_value, options);\n\t}\n\tstatic VECTOR4(\n\t\tinit_value: ParamInitValuesTypeMap[ParamType.VECTOR4],\n\t\toptions?: ParamOptionsByTypeMap[ParamType.VECTOR4]\n\t) {\n\t\treturn new ParamTemplate<ParamType.VECTOR4>(ParamType.VECTOR4, init_value, options);\n\t}\n}\n\nexport class NodeParamsConfig implements Dictionary<ParamTemplate<ParamType>> {\n\t[name: string]: ParamTemplate<ParamType>;\n}\n// export class NodeParamsConfig {}\n\n// interface ParamConfig {\n// \ttype: ParamType;\n// \tvalue: any;\n// \toptions?: ParamOptions;\n// }\n// export type ParamConfigsArray = ParamConfig[];\n\n// declare global {\n// \tinterface Window {\n// \t\tParamB: typeof _ParamB;\n// \t\tParamC: typeof _ParamC;\n// \t}\n// }\n// window.ParamC = _ParamC;\n","import {Object3D} from 'three/src/core/Object3D';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {Material} from 'three/src/materials/Material';\n// import {Group} from 'three/src/objects/Group';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n// import lodash_includes from 'lodash/includes';\nimport lodash_range from 'lodash/range';\nimport lodash_times from 'lodash/times';\nimport {TypedNode} from '../_Base';\nimport {CoreConstant} from 'src/core/geometry/Constant';\nimport {CoreGroup, Object3DWithGeometry} from 'src/core/geometry/Group';\nimport {CoreMaterial} from 'src/core/geometry/Material';\nimport {ObjectType} from 'src/core/geometry/Constant';\n\nimport {GeometryContainer} from 'src/engine/containers/Geometry';\nimport {TypedContainerController} from '../utils/ContainerController';\nimport {BaseMatNodeType} from '../mat/_Base';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\n\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {FlagsControllerDB} from '../utils/FlagsController';\n// import * as Container from '../../Container/Geometry';\n\n// import {AttribTypeParam} from './concerns/AttribTypeParam';\n// import {Bypass} from './Concerns/Bypass';\n// import {GroupParam} from './concerns/GroupParam';\n// import {Named} from './concerns/Named'; // TODO; typescript\n// import {ObjectTypeParam} from './concerns/ObjectTypeParam';\n\n// TODO: do I really need to add attributes in objects?\n// TODO: after setting a node dirty, it should clear its object\n\n// import {RequestContainerGeometryCallback} from 'src/Engine/Container/Geometry'\n// const CONTAINER_CLASS = 'Geometry';\n\nenum MESSAGE {\n\tFROM_SET_CORE_GROUP = 'from set_core_group',\n\tFROM_SET_GROUP = 'from set_group',\n\tFROM_SET_OBJECTS = 'from set_objects',\n\tFROM_SET_OBJECT = 'from set_object',\n\tFROM_SET_GEOMETRIES = 'from set_geometries',\n\tFROM_SET_GEOMETRY = 'from set_geometry',\n}\n\nconst INPUT_GEOMETRY_NAME = 'input geometry';\nconst DEFAULT_INPUT_NAMES = [INPUT_GEOMETRY_NAME, INPUT_GEOMETRY_NAME, INPUT_GEOMETRY_NAME, INPUT_GEOMETRY_NAME];\n\nexport class TypedSopNode<K extends NodeParamsConfig> extends TypedNode<'GEOMETRY', BaseSopNodeType, K> {\n\tcontainer_controller: TypedContainerController<GeometryContainer> = new TypedContainerController<GeometryContainer>(\n\t\tthis,\n\t\tGeometryContainer\n\t);\n\tpublic readonly flags: FlagsControllerDB = new FlagsControllerDB(this);\n\n\tstatic node_context(): NodeContext {\n\t\treturn NodeContext.SOP;\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn DEFAULT_INPUT_NAMES;\n\t}\n\n\t// _master_group: Group\n\t// _objects: Object3D[] = []\n\n\tinitialize_base_node() {\n\t\t// this.flags.add_bypass();\n\n\t\t// this.flags.add_display();\n\t\tif (this.flags.display) {\n\t\t\tthis.flags.display.set(false);\n\t\t\tthis.flags.display.add_hook(() => {\n\t\t\t\tif (this.flags.display.active) {\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif (parent && parent.display_node_controller) {\n\t\t\t\t\t\tparent.display_node_controller.set_display_node(this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.io.outputs.set_has_one_output();\n\t\t// this.container_controller.init(CONTAINER_CLASS);\n\t}\n\n\t// request_container() {\n\t// \treturn super.request_container(); //as Promise<GeometryContainer>;\n\t// }\n\n\t//\n\t//\n\t// GEOMETRY\n\t//\n\t//\n\t// group(): Group {\n\t// \treturn this._master_group = this._master_group || this._create_group()\n\t// }\n\t// set_group(group: Group){\n\t// \tthis._clear_objectsI() //(MESSAGE.FROM_SET_GROUP);\n\t// \tthis._master_group.add(group)\n\t// \t// let child;\n\n\t// \t// const new_children = [];\n\t// \t// while (child = group.children[0]) {\n\t// \t// \tnew_children.push(child);\n\t// \t// \tgroup.remove(child);\n\t// \t// }\n\n\t// \t// new_children.forEach(child=> {\n\t// \t// \tthis._master_group.add( child );\n\t// \t// });\n\n\t// \t// // if (this.allow_add_object_attributes()) {\n\t// \t// \tthis._master_group.traverse(object=> {\n\t// \t// \t\tthis._set_object_attributes(object);\n\t// \t// \t});\n\t// \t// // }\n\t// \tthis.set_container(this._master_group, MESSAGE.FROM_SET_GROUP);\n\t// }\n\tset_core_group(core_group: CoreGroup) {\n\t\tconst objects = core_group.objects();\n\t\tfor (let object of objects) {\n\t\t\tthis._set_object_attributes(object);\n\t\t}\n\t\tthis.set_container(core_group, MESSAGE.FROM_SET_CORE_GROUP);\n\t}\n\n\tset_object(object: Object3D) {\n\t\t// this._clear_objects();\n\t\t// this.add_object(object);\n\t\t// this.set_container(this.group(), MESSAGE.FROM_SET_OBJECT);\n\t\tthis._set_object_attributes(object);\n\t\t// const core_group = new CoreGroup();\n\t\t// core_group.set_objects([object]);\n\t\tthis.set_container_objects([object], MESSAGE.FROM_SET_OBJECT);\n\t}\n\tset_objects(objects: Object3D[]) {\n\t\t// this._clear_objects();\n\t\t// const list = objects;\n\t\t// lodash_times(list.length, i=> {\n\t\t// \tconst object = list[i];\n\t\t// \tthis.add_object(object);\n\t\t// });\n\t\tfor (let object of objects) {\n\t\t\tthis._set_object_attributes(object);\n\t\t}\n\t\t// const core_group = new CoreGroup();\n\t\t// core_group.set_objects(objects);\n\t\tthis.set_container_objects(objects, MESSAGE.FROM_SET_OBJECTS);\n\t}\n\n\t// add_object(object: Object3D) {\n\t// \tif (object != null) {\n\t// \t\tthis.group().add(object);\n\t// \t\t// if (this.allow_add_object_attributes()) {\n\t// \t\tthis._set_object_attributes(object);\n\t// \t\t// }\n\t// \t\treturn object;\n\t// \t}\n\t// }\n\t// add_geometry(geometry: BufferGeometry, type: ObjectType) {\n\t// \tlet object;\n\t// \tif (geometry.index == null) {\n\t// \t\tthis._add_index(geometry);\n\t// \t}\n\n\t// \tif ((object = this.create_object(geometry, type)) != null) {\n\t// \t\tthis.add_object(object);\n\t// \t}\n\t// }\n\n\tset_geometry(geometry: BufferGeometry, type?: ObjectType) {\n\t\t// this._clear_objects();\n\t\t// this.add_geometry(geometry, type);\n\t\t// this.set_container(this.group(), MESSAGE.FROM_SET_GEOMETRY);\n\t\tconst object = this.create_object(geometry, type);\n\t\t// const core_group = new CoreGroup();\n\t\t// core_group.set_objects([object]);\n\t\tthis.set_container_objects([object], MESSAGE.FROM_SET_GEOMETRY);\n\t}\n\t//this.end_cook()\n\n\tset_geometries(geometries: BufferGeometry[], type?: ObjectType) {\n\t\t// this._clear_objects();\n\t\tconst objects: Object3D[] = [];\n\t\tlet object;\n\t\tgeometries.forEach((geometry) => {\n\t\t\tobject = this.create_object(geometry, type);\n\t\t\tthis._set_object_attributes(object);\n\t\t\tobjects.push(object);\n\t\t});\n\t\t// const core_group = new CoreGroup();\n\t\t// core_group.set_objects(objects);\n\t\tthis.set_container_objects(objects, MESSAGE.FROM_SET_GEOMETRIES);\n\t}\n\n\tset_container_objects(objects: Object3D[], message: MESSAGE) {\n\t\tconst core_group = this.container_controller.container.core_content() || new CoreGroup();\n\t\tcore_group.set_objects(objects);\n\t\tcore_group.touch();\n\t\tthis.set_container(core_group);\n\t}\n\n\t// do_clone_inputs() {\n\t// \tlet result = true;\n\t// \tif (this.has_param('do_not_clone_inputs')) {\n\t// \t\tresult = false;\n\t// \t}\n\t// \treturn result;\n\t// }\n\t// allow_add_object_attributes() {\n\t// \tif (!this.do_clone_inputs()) { return false; }\n\t// \tlet result = true;\n\t// \tif (this.has_param('do_not_add_object_attributes')) {\n\t// \t\tresult = false;\n\t// \t}\n\t// \treturn result;\n\t// }\n\n\t// _create_group() {\n\t// \tconst group = new Group();\n\t// \tgroup.name = this.full_path();\n\n\t// \tthis._init_sop_bypass_group(group)\n\n\t// \treturn group;\n\t// }\n\n\tcreate_object(geometry: BufferGeometry, type?: ObjectType): Object3DWithGeometry {\n\t\t// ensure it has an index\n\t\tif (!geometry.index) {\n\t\t\tconst position_array = geometry.getAttribute('position').array;\n\t\t\tgeometry.setIndex(lodash_range(position_array.length / 3));\n\t\t}\n\n\t\tif (type == null) {\n\t\t\ttype = CoreConstant.OBJECT_TYPE.MESH;\n\t\t}\n\t\t// if (!lodash_includes(CoreConstant.OBJECT_TYPES, type)) {\n\t\t// \tconst human_type = CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[type];\n\t\t// \tconst human_names = CoreConstant.OBJECT_TYPES.map(\n\t\t// \t\t(n) => CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[n]\n\t\t// \t);\n\t\t// \tthrow `type '${human_type}' not recognized. Available types are ${human_names.join(', ')}.`;\n\t\t// }\n\n\t\t// if (geometry != null) {\n\t\tconst object_constructor = CoreConstant.CONSTRUCTORS_BY_NAME[type]; //THREE[type];\n\t\tconst material = CoreConstant.MATERIALS[type].clone();\n\t\tconst object = new object_constructor(geometry, material) as Object3DWithGeometry;\n\t\tobject.castShadow = true;\n\t\tobject.receiveShadow = true;\n\t\tobject.frustumCulled = false;\n\n\t\treturn object;\n\t\t// }\n\t}\n\n\t_set_object_attributes(object: Object3D) {\n\t\t// if (!this.allow_add_object_attributes()) { return; }\n\t\t// TODO: the exception below are just to debug when a geo could be reused or not cloned properly\n\t\t// I could remove that when more sure it all refreshes fine, and this would allow the null or merge to\n\t\t// not have to clone the data\n\t\t// if ((object.name == null) && (object.name !== '')) {\n\t\t// \tif (this.do_clone_inputs()) {\n\t\t// \t\tthrow `object.name already set to ${object.node_name} (attempt to set by ${this.full_path()})`;\n\t\t// \t}\n\t\t// } else {\n\t\t// \tobject.name = this.full_path();\n\t\t// }\n\n\t\t// if ((geometry = object.geometry) != null) {\n\t\t// \tif ((geometry.name == null) && (geometry.name !== '')) {\n\t\t// \t\tif (this.do_clone_inputs()) {\n\t\t// \t\t\tthrow `geometry.node_name already set to ${geometry.node_name} (attempt to set by ${this.full_path()})`;\n\t\t// \t\t}\n\t\t// \t} else {\n\t\t// \t\tgeometry.name = this.full_path();\n\t\t// \t}\n\t\t// }\n\t\tconst material: Material = (object as Mesh).material as Material;\n\t\tif (material) {\n\t\t\tif (!this.scene) {\n\t\t\t\tconsole.log('no scene');\n\t\t\t\tthrow 'no scene';\n\t\t\t}\n\t\t\tconst material_node = CoreMaterial.node(this.scene, material) as BaseMatNodeType;\n\t\t\tif (material_node) {\n\t\t\t\tmaterial_node.add_render_hook(object);\n\t\t\t}\n\t\t}\n\t}\n\n\t// _clear_objects() {\n\t// \tconst group = this.group();\n\n\t// \tlet child\n\t// \twhile(child = group.children[0]) {\n\t// \t\tgroup.remove(child);\n\t// \t}\n\t// \t// const children = lodash_clone(group.children);\n\t// \t// let child;\n\t// \t// for(let i=0; i < children.length; i++){\n\t// \t// \tchild = children[i]\n\t// \t// \tgroup.remove(child);\n\t// \t// \tchild.traverse((object)=>{\n\t// \t// \t\tif (object.geometry != null) {\n\t// \t// \t\t\tobject.geometry.dispose();\n\t// \t// \t\t}\n\t// \t// \t\t// no more material dispose since each the materials are not cloned\n\t// \t// \t\t// if (object.material){\n\t// \t// \t\t// \tif (lodash_isArray(object.material)){\n\t// \t// \t\t// \t\tobject.material.forEach((mat)=>{mat.dispose()})\n\t// \t// \t\t// \t} else {\n\t// \t// \t\t// \t\tobject.material.dispose()\n\t// \t// \t\t// \t}\n\t// \t// \t\t// }\n\t// \t// \t});\n\t// \t// }\n\t// }\n\n\t_add_index(geometry: BufferGeometry) {\n\t\tconst position_attrib = geometry.getAttribute('position');\n\t\tconst position_array = position_attrib.array;\n\t\tconst points_count = position_array.length / 3;\n\t\tconst indices: number[] = [];\n\t\tlodash_times(points_count, (i) => indices.push(i));\n\n\t\tgeometry.setIndex(indices);\n\t}\n}\n\nexport type BaseSopNodeType = TypedSopNode<NodeParamsConfig>;\nexport class BaseSopNodeClass extends TypedSopNode<NodeParamsConfig> {}\n","export enum InputCloneMode {\n\tALWAYS = 'always',\n\tNEVER = 'never',\n\tFROM_NODE = 'from_node',\n}\n","import {PolyScene} from 'src/engine/scene/PolyScene';\n\nimport {EditorStoreController, EditorStoreControllerClass} from './EditorStoreController';\nimport {EngineStoreController, EngineStoreControllerClass} from './EngineStoreController';\nimport {Store} from 'vuex';\nimport {State} from '../Store';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {SceneEvent} from 'src/engine/poly/SceneEvent';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n// import {BaseNodeType, EmitDataByNodeEventMap} from 'src/engine/nodes/_Base';\nimport {ParamEvent} from 'src/engine/poly/ParamEvent';\nimport {Editor} from 'src/editor/Editor';\n\nclass StoreControllerClass {\n\tprivate static _instance: StoreControllerClass;\n\tprivate _scene!: PolyScene;\n\n\tpublic readonly editor: EditorStoreControllerClass = EditorStoreController;\n\tpublic readonly engine: EngineStoreControllerClass = EngineStoreController;\n\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new StoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\tset_scene(scene: PolyScene) {\n\t\tthis._scene = scene;\n\t\tthis._scene.events_controller.set_listener(this);\n\t\tthis.editor.set_scene(scene);\n\t\tthis.engine.set_scene(scene);\n\n\t\tthis.editor.set_current_node(scene.root);\n\t}\n\tget scene() {\n\t\treturn this._scene;\n\t}\n\tasync save_scene() {\n\t\tconst {SceneJsonExporter} = await import('src/engine/io/json/export/Scene');\n\t\tconst exporter = new SceneJsonExporter(StoreController.scene);\n\t\tconst data = exporter.data();\n\t\tconst callback = Editor.instance().on_save_callback;\n\t\tif (callback) {\n\t\t\tcallback(data);\n\t\t}\n\t}\n\n\tset_store(store: Store<State>) {\n\t\tthis.editor.set_store(store);\n\t\tthis.engine.set_store(store);\n\t}\n\n\tclose_all_popups() {\n\t\tthis.editor.close_all_popups();\n\t}\n\n\tprocess_events(emitter: CoreGraphNode, event_name: SceneEvent | NodeEvent | ParamEvent, data?: any): void {\n\t\t// console.log('process_events', emitter, event_name);\n\t\tif (emitter instanceof CoreGraphNode) {\n\t\t\tswitch (event_name) {\n\t\t\t\t// scene events\n\t\t\t\tcase SceneEvent.FRAME_UPDATED:\n\t\t\t\t\treturn this.engine.update_frame();\n\t\t\t\tcase SceneEvent.FRAME_RANGE_UPDATED:\n\t\t\t\t\treturn this.engine.update_frame_range();\n\t\t\t\tcase SceneEvent.PLAY_STATE_UPDATED:\n\t\t\t\t\treturn this.engine.update_play_state();\n\n\t\t\t\t// node events\n\t\t\t\tcase NodeEvent.ERROR_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_error(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.UI_DATA_POSITION_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_ui_data_position(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.UI_DATA_COMMENT_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_ui_data_comment(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.SELECTION_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_selection(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.FLAG_DISPLAY_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_display_flag(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.FLAG_BYPASS_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_bypass_flag(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.NAME_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_name(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.INPUTS_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_inputs(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.NAMED_INPUTS_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_named_inputs(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.NAMED_OUTPUTS_UPDATED:\n\t\t\t\t\treturn this.engine.update_node_named_outputs(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.PARAMS_UPDATED:\n\t\t\t\t\treturn this.engine.update_params(emitter.graph_node_id);\n\t\t\t\tcase NodeEvent.CREATED:\n\t\t\t\t\treturn this.engine.add_node(emitter.graph_node_id, data);\n\t\t\t\tcase NodeEvent.DELETED:\n\t\t\t\t\treturn this.engine.delete_node(emitter.graph_node_id, data);\n\t\t\t\t// TODO: override_clonable_input_state\n\n\t\t\t\t// param events\n\t\t\t\tcase ParamEvent.RAW_INPUT_UPDATED:\n\t\t\t\t\treturn this.engine.update_param_raw_input(emitter.graph_node_id);\n\t\t\t\tcase ParamEvent.VALUE_UPDATED:\n\t\t\t\t\treturn this.engine.update_param_value(emitter.graph_node_id);\n\t\t\t\tcase ParamEvent.EXPRESSION_UPDATED:\n\t\t\t\t\treturn this.engine.update_param_expression(emitter.graph_node_id);\n\t\t\t\tcase ParamEvent.ERROR_UPDATED:\n\t\t\t\t\treturn this.engine.update_param_error(emitter.graph_node_id);\n\t\t\t\tcase ParamEvent.VISIBLE_UPDATED:\n\t\t\t\t\treturn this.engine.update_param_visible_state(emitter.graph_node_id);\n\t\t\t}\n\t\t}\n\t\tconsole.warn('event not processed', emitter, event_name, data);\n\t}\n}\n\nexport const StoreController = StoreControllerClass.instance();\n","export enum ParamType {\n\tBOOLEAN = 'boolean',\n\tBUTTON = 'button',\n\tCOLOR = 'color',\n\tFLOAT = 'float',\n\tFOLDER = 'folder',\n\tINTEGER = 'integer',\n\tOPERATOR_PATH = 'operator_path',\n\tRAMP = 'ramp',\n\tSEPARATOR = 'separator',\n\tSTRING = 'string',\n\tVECTOR2 = 'vector2',\n\tVECTOR3 = 'vector3',\n\tVECTOR4 = 'vector4',\n}\n// export type ParamTypeKey = ParamType\n// export type ParamTypeKeysArray = Array<ParamTypeKey>\n// const ParamTypeKeysArray: ParamTypeKeysArray = [ParamType.BOOLEAN]\n","export enum NodeContext {\n\tCOP = 'cop',\n\tEVENT = 'event',\n\tGL = 'gl',\n\tJS = 'js',\n\tMANAGER = 'managers',\n\tMAT = 'mat',\n\tOBJ = 'objects',\n\tSOP = 'sop',\n\tPOST = 'post',\n}\n","// import {VertexColors} from 'three/src/constants'\nimport {SkinnedMesh} from 'three/src/objects/SkinnedMesh';\nimport {Scene} from 'three/src/scenes/Scene';\nimport {Points} from 'three/src/objects/Points';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {NoColors} from 'three/src/constants';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {LineSegments} from 'three/src/objects/LineSegments';\nimport {Group} from 'three/src/objects/Group';\nimport {FrontSide} from 'three/src/constants';\n// import {DoubleSide} from 'three/src/constants'\nimport {Color} from 'three/src/math/Color';\nimport {Bone} from 'three/src/objects/Bone';\n// import {AdditiveBlending} from 'three/src/constants'\nimport {Material} from 'three/src/materials/Material';\nimport {PointsMaterial} from 'three/src/materials/PointsMaterial';\nimport {MeshStandardMaterial} from 'three/src/materials/MeshStandardMaterial';\nimport {MeshLambertMaterial} from 'three/src/materials/MeshLambertMaterial';\nimport {LineBasicMaterial} from 'three/src/materials/LineBasicMaterial';\n// const THREE = {AdditiveBlending, Bone, Color, DoubleSide, FrontSide, Group, LineBasicMaterial, LineSegments, Mesh, MeshLambertMaterial, MeshStandardMaterial, NoColors, Object3D, Points, PointsMaterial, Scene, SkinnedMesh, VertexColors}\n\ninterface MaterialsByString {\n\t[propName: string]: Material;\n}\n\n// export enum AttribClass {\n// \tVERTEX = \"vertex\",\n// \tOBJECT = \"object\"\n// }\n// materials['MeshStandard'] = new MeshStandardMaterial({\n// \tcolor: 0xffffff,\n// \t//vertexColors: VertexColors\n// \tside: FrontSide, // DoubleSide\n// \tmetalness: 0.5,\n// \troughness: 0.9\n// })\n// materials[Mesh.name] = new MeshLambertMaterial({ // MeshStandardMaterial\n// \tcolor: new Color(0.5,0.5,1),\n// \tside: FrontSide,\n// \tvertexColors: NoColors,\n// \ttransparent: true,\n// \tdepthTest: true\n// })\n// materials[Points.name] = new PointsMaterial({\n// \tcolor: 0xffffff,\n// \tsize: 0.1,\n// \t//blending: AdditiveBlending\n// \tdepthTest: true\n// })\n// materials[LineSegments.name] = new LineBasicMaterial({\n// \tcolor: 0xffffff,\n// \tlinewidth: 1\n// })\nexport enum ObjectType {\n\tMESH = 'MESH',\n\tPOINTS = 'POINTS',\n\tLINE_SEGMENTS = 'LINE_SEGMENTS',\n}\nexport const ObjectTypes = [ObjectType.MESH, ObjectType.POINTS, ObjectType.LINE_SEGMENTS];\nexport const ObjectTypeMenuEntries = [\n\t{name: 'Mesh', value: ObjectTypes.indexOf(ObjectType.MESH)},\n\t{name: 'Points', value: ObjectTypes.indexOf(ObjectType.POINTS)},\n\t{name: 'LineSegments', value: ObjectTypes.indexOf(ObjectType.LINE_SEGMENTS)},\n];\n\nconst materials: MaterialsByString = {\n\tMeshStandard: new MeshStandardMaterial({\n\t\tcolor: 0xffffff,\n\t\t//vertexColors: VertexColors\n\t\tside: FrontSide, // DoubleSide\n\t\tmetalness: 0.5,\n\t\troughness: 0.9,\n\t}),\n\t[ObjectType.MESH]: new MeshLambertMaterial({\n\t\t// MeshStandardMaterial\n\t\tcolor: new Color(0.5, 0.5, 1),\n\t\tside: FrontSide,\n\t\tvertexColors: NoColors,\n\t\ttransparent: true,\n\t\tdepthTest: true,\n\t}),\n\t[ObjectType.POINTS]: new PointsMaterial({\n\t\tcolor: 0xffffff,\n\t\tsize: 0.1,\n\t\t//blending: AdditiveBlending\n\t\tdepthTest: true,\n\t}),\n\t[ObjectType.LINE_SEGMENTS]: new LineBasicMaterial({\n\t\tcolor: 0xffffff,\n\t\tlinewidth: 1,\n\t}),\n};\n\n// TODO: typescript: check that this works after using uglifier\n\nexport enum AttribClass {\n\tVERTEX = 0,\n\tOBJECT = 1,\n}\n\nexport const AttribClassMenuEntries = [\n\t{name: 'vertex', value: AttribClass.VERTEX},\n\t{name: 'object', value: AttribClass.OBJECT},\n];\n\nexport enum AttribType {\n\tNUMERIC = 0,\n\tSTRING = 1,\n}\nexport const AttribTypeMenuEntries = [\n\t{name: 'numeric', value: AttribType.NUMERIC},\n\t{name: 'string', value: AttribType.STRING},\n];\n\nexport const CoreConstant = {\n\tATTRIB_CLASS: {\n\t\tVERTEX: AttribClass.VERTEX,\n\t\tOBJECT: AttribClass.OBJECT,\n\t},\n\n\tATTRIB_TYPE: {\n\t\tNUMERIC: 0,\n\t\tSTRING: 1,\n\t},\n\n\tOBJECT_TYPE: {\n\t\t// TODO: typescript\n\t\tMESH: ObjectType.MESH,\n\t\tPOINTS: ObjectType.POINTS,\n\t\tLINE_SEGMENTS: ObjectType.LINE_SEGMENTS,\n\t},\n\tOBJECT_TYPES: ObjectTypes,\n\tCONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME: {\n\t\t[Scene.name]: 'Scene',\n\t\t[Group.name]: 'Group',\n\t\t[Object3D.name]: 'Object3D',\n\t\t[Mesh.name]: 'Mesh',\n\t\t[Points.name]: 'Points',\n\t\t[LineSegments.name]: 'LineSegments',\n\t\t[Bone.name]: 'Bone',\n\t\t[SkinnedMesh.name]: 'SkinnedMesh',\n\t},\n\tCONSTRUCTORS_BY_NAME: {\n\t\t[ObjectType.MESH]: Mesh,\n\t\t[ObjectType.POINTS]: Points,\n\t\t[ObjectType.LINE_SEGMENTS]: LineSegments,\n\t},\n\t// CONSTRUCTORS_BY_TYPE: {\n\t// \t['MESH']: Mesh,\n\t// \t['POINTS']: Points,\n\t// \t['LINE_SEGMENTS']: LineSegments,\n\t// },\n\t// OBJECT_TYPE_BY_CONSTRUCTOR_NAME: {\n\t// \t[Mesh.name]: 'MESH',\n\t// \t[Points.name]: 'POINTS',\n\t// \t[LineSegments.name]: 'LINE_SEGMENTS',\n\t// },\n\tMATERIALS: materials,\n};\n\n// CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[Scene.name] = 'Scene'\n// CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[Group.name] = 'Group'\n// CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[Object3D.name] = 'Object3D'\n// CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[Mesh.name] = 'Mesh'\n// CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[Points.name] = 'Points'\n// CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[LineSegments.name] = 'LineSegments'\n// CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[Bone.name] = 'Bone'\n// CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[SkinnedMesh.name] = 'SkinnedMesh'\n\n// CoreConstant.CONSTRUCTORS_BY_NAME[Mesh.name] = Mesh\n// CoreConstant.CONSTRUCTORS_BY_NAME[Points.name] = Points\n// CoreConstant.CONSTRUCTORS_BY_NAME[LineSegments.name] = LineSegments\n\n// CoreConstant.CONSTRUCTORS_BY_TYPE['MESH'] = Mesh\n// CoreConstant.CONSTRUCTORS_BY_TYPE['POINTS'] = Points\n// CoreConstant.CONSTRUCTORS_BY_TYPE['LINE_SEGMENTS'] = LineSegments\n\n// CoreConstant.OBJECT_TYPE_BY_CONSTRUCTOR_NAME[Mesh.name] = 'MESH'\n// CoreConstant.OBJECT_TYPE_BY_CONSTRUCTOR_NAME[Points.name] = 'POINTS'\n// CoreConstant.OBJECT_TYPE_BY_CONSTRUCTOR_NAME[LineSegments.name] = 'LINE_SEGMENTS'\n","import lodash_range from 'lodash/range';\nimport lodash_uniq from 'lodash/uniq';\nimport lodash_trim from 'lodash/trim';\nimport lodash_compact from 'lodash/compact';\nimport lodash_flatten from 'lodash/flatten';\nimport lodash_padEnd from 'lodash/padEnd';\nimport lodash_capitalize from 'lodash/capitalize';\nimport lodash_snakeCase from 'lodash/snakeCase';\nimport lodash_upperFirst from 'lodash/upperFirst';\nimport lodash_camelCase from 'lodash/camelCase';\n\nconst ATTRIB_NAMES_SEPARATOR = /[, ]/; //[',', ' ']\n\n// const LETTERS = 'abcdefghijklmnopqrstuvwxyz'\n// const LETTERS_UPPERCASE = LETTERS.toUpperCase()\n// const NUMBERS = '0123645789'\n// const ALL = LETTERS + LETTERS_UPPERCASE + NUMBERS\n\nconst TAIL_DIGIT_MATCH_REGEXP = /\\d+$/;\n// const DIGIT_PREDEDED_BY_UNDERSCOPE = /_\\d$/\nconst INDICES_LIST_SEPARATOR = /,| /;\n\n// https://stackoverflow.com/questions/41856126/regexp-optional-dot-in-a-decimal-number\nconst NUM_REGEXP = /^\\d+\\.?\\d*$/;\nenum BooleanString {\n\tTRUE = 'true',\n\tFALSE = 'false',\n}\n\nexport class CoreString {\n\t// static has_tail_digits(word: string): boolean {\n\t// \tconst match = word.match(TAIL_DIGIT_MATCH_REGEXP)\n\t// \treturn (match != null)\n\t// }\n\tstatic is_boolean(word: string): boolean {\n\t\treturn word == BooleanString.TRUE || word == BooleanString.FALSE;\n\t}\n\tstatic to_boolean(word: string): boolean {\n\t\treturn word == BooleanString.TRUE;\n\t}\n\tstatic is_number(word: string): boolean {\n\t\treturn NUM_REGEXP.test(word);\n\t}\n\n\tstatic tail_digits(word: string): number {\n\t\tconst match = word.match(TAIL_DIGIT_MATCH_REGEXP);\n\t\tif (match) {\n\t\t\treturn parseInt(match[0]);\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tstatic increment(word: string): string {\n\t\tlet match;\n\t\tif ((match = word.match(TAIL_DIGIT_MATCH_REGEXP))) {\n\t\t\tconst digits = parseInt(match[0]);\n\t\t\tconst prefix = word.substring(0, word.length - match[0].length);\n\t\t\treturn `${prefix}${digits + 1}`;\n\t\t} else {\n\t\t\treturn `${word}1`;\n\t\t}\n\t}\n\n\tstatic pluralize(word: string): string {\n\t\tconst last_char = word[word.length - 1];\n\t\tif (last_char !== 's') {\n\t\t\treturn `${word}s`;\n\t\t} else {\n\t\t\treturn word;\n\t\t}\n\t}\n\n\tstatic camel_case(word: string): string {\n\t\treturn lodash_camelCase(word);\n\t}\n\tstatic upper_first(word: string): string {\n\t\treturn lodash_upperFirst(word);\n\t}\n\tstatic snake_case(word: string): string {\n\t\treturn lodash_snakeCase(word);\n\t}\n\tstatic titleize(word: string): string {\n\t\treturn lodash_capitalize(word.replace(/_/g, ' '));\n\t}\n\n\tstatic type_to_class_name(word: string): string {\n\t\treturn this.upper_first(lodash_camelCase(word));\n\t}\n\t// static class_name_to_type(word): string {\n\t// \t// if(this.has_tail_digits(word)){\n\t// \t// \tconst tail_digits = `${this.tail_digits(word)}`\n\t// \t// \tconst head = word.substr(0, word.length-tail_digits.length)\n\t// \t// \tconst head_snake_case = this.snake_case(head)\n\t// \t// \tconsole.log(word, tail_digits, head, head_snake_case)\n\t// \t// \treturn `${head_snake_case}${tail_digits}`;\n\t// \t// } else {\n\t// \t// \treturn this.snake_case(word)\n\t// \t// }\n\t// \tconst snake_case = this.snake_case(word)\n\t// \tconst match = snake_case.match(DIGIT_PREDEDED_BY_UNDERSCOPE)\n\t// \tconsole.log(\"-----\", snake_case, match)\n\t// \treturn snake_case\n\t// }\n\t// static class_name_to_human(word): string {\n\t// \tconst human_name = this.class_name_to_type(word).replace(/\\s/, ' ');\n\t// \treturn human_name.replace(/_/g, \" \");\n\t// }\n\n\tstatic timestamp_to_seconds(word: string): number {\n\t\treturn Date.parse(word) / 1000;\n\t}\n\tstatic seconds_to_timestamp(seconds: number): string {\n\t\tconst d = new Date();\n\t\td.setTime(seconds * 1000);\n\t\treturn d.toISOString().substr(11, 8);\n\t}\n\n\tstatic precision(val: number, decimals: number = 2): string {\n\t\t// if (decimals == null) { decimals = 2; }\n\t\t// const factor = Math.pow(10, decimals);\n\t\t// const num = Math.floor(factor * val) / factor;\n\t\t// let number_s = `${num}`;\n\n\t\t// let elements = number_s.split('.');\n\t\t// if (decimals <= 0){\n\t\t// \treturn elements[0];\n\t\t// }\n\n\t\t// if (elements.length === 1) {\n\t\t// \t// number_s = `${number_s}.00`;\n\t\t// \tconst string_to_pad = `${number_s}.`\n\t\t// \tconst pad = string_to_pad.length + decimals\n\t\t// \treturn lodash_padEnd(string_to_pad, pad, '0');\n\t\t// } else {\n\t\t// \tconst integer_element = elements[0];\n\t\t// \tlet fraction_element = elements[1];\n\t\t// \tif (fraction_element.length === 1) {\n\t\t// \t\tnumber_s = `${integer_element}.${fraction_element}0`;\n\t\t// \t} else if (fraction_element.length > 2) {\n\t\t// \t\tfraction_element = fraction_element.slice(0, 2);\n\t\t// \t\tnumber_s = `${integer_element}.${fraction_element}`;\n\t\t// \t}\n\t\t// }\n\n\t\t// elements = number_s.split('.');\n\t\t// console.log(\"decimals:\", decimals, elements[1].length, number_s)\n\t\t// if (elements[1].length < decimals){\n\t\t// \tconst string_to_pad = number_s\n\t\t// \tconst pad = string_to_pad.length + (decimals - elements[1].length)\n\t\t// \tnumber_s = lodash_padEnd(string_to_pad, pad, '0');\n\t\t// }\n\n\t\t// return number_s;\n\t\tdecimals = Math.max(decimals, 0);\n\t\tconst elements = `${val}`.split('.');\n\n\t\tif (decimals <= 0) {\n\t\t\treturn elements[0];\n\t\t}\n\n\t\tlet frac = elements[1];\n\t\tif (frac !== undefined) {\n\t\t\tif (frac.length > decimals) {\n\t\t\t\tfrac = frac.substring(0, decimals);\n\t\t\t}\n\n\t\t\tfrac = lodash_padEnd(frac, decimals, '0');\n\t\t\treturn `${elements[0]}.${frac}`;\n\t\t} else {\n\t\t\tconst string_to_pad = `${val}.`;\n\t\t\tconst pad = string_to_pad.length + decimals;\n\t\t\treturn lodash_padEnd(string_to_pad, pad, '0');\n\t\t}\n\t}\n\n\tstatic ensure_float(num: number): string {\n\t\t// const integer = Math.floor(num)\n\t\t// const delta = num - integer\n\t\t// if(delta)\n\t\tconst num_as_string = `${num}`;\n\t\tconst dot_pos = num_as_string.indexOf('.');\n\t\tif (dot_pos >= 0) {\n\t\t\treturn num_as_string;\n\t\t} else {\n\t\t\treturn `${num_as_string}.0`;\n\t\t}\n\t}\n\n\t// https://stackoverflow.com/questions/26246601/wildcard-string-comparison-in-javascript#32402438\n\tstatic match_mask(word: string, rule: string) {\n\t\tif (rule === '*') {\n\t\t\treturn true;\n\t\t}\n\t\t// \".\"  => Find a single character, except newline or line terminator\n\t\t// \".*\" => Matches any string that contains zero or more characters\n\t\trule = rule.split('*').join('.*');\n\n\t\t// \"^\"  => Matches any string with the following at the beginning of it\n\t\t// \"$\"  => Matches any string with that in front at the end of it\n\t\trule = `^${rule}$`;\n\n\t\t// Create a regular expression object for matching string\n\t\tconst regex = new RegExp(rule);\n\n\t\t// Returns true if it finds a match, otherwise it returns false\n\t\treturn regex.test(word);\n\t}\n\tstatic matches_one_mask(word: string, masks: string[]): boolean {\n\t\tlet matches_one_mask = false;\n\t\tfor (let mask of masks) {\n\t\t\tif (CoreString.match_mask(word, mask)) {\n\t\t\t\tmatches_one_mask = true;\n\t\t\t}\n\t\t}\n\t\treturn matches_one_mask;\n\t}\n\n\tstatic attrib_names(word: string): string[] {\n\t\t// let elements = [word];\n\t\t// lodash_each(ATTRIB_NAMES_SEPARATORS, separator => elements = lodash_flatten(lodash_map(elements, element => element.split(separator))));\n\t\tconst elements = word.split(ATTRIB_NAMES_SEPARATOR);\n\t\tconst trimed_elements = lodash_compact(\n\t\t\telements.map((e) => {\n\t\t\t\treturn lodash_trim(e);\n\t\t\t})\n\t\t);\n\t\tconst uniq = lodash_uniq(trimed_elements);\n\n\t\t// const names: string[] = []\n\t\t// ATTRIB_NAMES_SEPARATORS.forEach(separator=>{\n\t\t// \tword.split(separator).forEach( element=>{\n\t\t// \t\tnames.push(element.trim())\n\t\t// \t} )\n\t\t// })\n\n\t\t// // elements = lodash_filter(elements, element => (element != null) && (element.length > 0));\n\t\t// return lodash_uniq(names)\n\n\t\t// return lodash_map(elements, attr_name => lodash_trim(attr_name));\n\t\treturn uniq;\n\t}\n\tstatic to_id(val: string): number {\n\t\tif (val == null) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst elements = val.split('').reverse();\n\t\tlet id = 0;\n\t\tlet exp = 0;\n\t\telements.forEach((element, i) => {\n\t\t\tlet index = element.charCodeAt(0);\n\n\t\t\tif (index >= 0) {\n\t\t\t\texp = i % 10;\n\t\t\t\tid += index * 10 ** exp;\n\t\t\t\tid = id % Number.MAX_SAFE_INTEGER;\n\t\t\t}\n\t\t});\n\t\treturn id;\n\t}\n\n\tstatic indices(indices_string: string): number[] {\n\t\tconst elements = indices_string.split(INDICES_LIST_SEPARATOR);\n\t\tif (elements.length > 1) {\n\t\t\treturn lodash_uniq(lodash_flatten(elements.map((element) => this.indices(element)))).sort((a, b) => a - b);\n\t\t} else {\n\t\t\tconst element = elements[0];\n\t\t\tif (element) {\n\t\t\t\tconst range_separator = '-';\n\t\t\t\tif (element.indexOf(range_separator) > 0) {\n\t\t\t\t\tconst range_elements = element.split(range_separator);\n\t\t\t\t\treturn lodash_range(parseInt(range_elements[0]), parseInt(range_elements[1]) + 1);\n\t\t\t\t} else {\n\t\t\t\t\treturn [parseInt(element)];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic escape_line_breaks(word: string): string {\n\t\treturn word.replace(/(\\r\\n|\\n|\\r)/gm, '\\\\n');\n\t}\n}\n","// events\nexport enum NodeEvent {\n\tCREATED = 'node_created',\n\tDELETED = 'node_deleted',\n\tNAME_UPDATED = 'node_name_update',\n\tOVERRIDE_CLONABLE_STATE_UPDATE = 'node_override_clonable_state_update',\n\tNAMED_OUTPUTS_UPDATED = 'node_named_outputs_updated',\n\tNAMED_INPUTS_UPDATED = 'node_named_inputs_updated',\n\tINPUTS_UPDATED = 'node_inputs_updated',\n\tPARAMS_UPDATED = 'node_params_updated',\n\tUI_DATA_POSITION_UPDATED = 'node_ui_data_position_updated',\n\tUI_DATA_COMMENT_UPDATED = 'node_ui_data_comment_updated',\n\tERROR_UPDATED = 'node_error_updated',\n\tFLAG_BYPASS_UPDATED = 'bypass_flag_updated',\n\tFLAG_DISPLAY_UPDATED = 'display_flag_updated',\n\tSELECTION_UPDATED = 'selection_updated',\n}\n","import {Vector3} from 'three/src/math/Vector3';\n// import {Vector2} from 'three/src/math/Vector2'\nimport {Int32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Box3} from 'three/src/math/Box3';\nimport {InterleavedBufferAttribute} from 'three/src/core/InterleavedBufferAttribute';\n\n// const THREE = {\n// \tBox3,\n// \tBufferGeometry,\n// \tFloat32BufferAttribute,\n// \tInt32BufferAttribute,\n// \tInterleavedBufferAttribute,\n// \tVector2,\n// \tVector3,\n// }\nimport lodash_range from 'lodash/range';\nimport lodash_uniq from 'lodash/uniq';\nimport lodash_each from 'lodash/each';\nimport lodash_chunk from 'lodash/chunk';\nimport lodash_cloneDeep from 'lodash/cloneDeep';\nimport lodash_clone from 'lodash/clone';\nimport lodash_isArray from 'lodash/isArray';\nimport lodash_isNumber from 'lodash/isNumber';\nimport {CorePoint} from './Point';\nimport {CoreFace} from './Face';\nimport {CoreConstant, ObjectType} from './Constant';\nimport {CoreAttribute} from './Attribute';\nimport {MonkeyPatcher} from './MonkeyPatcher';\n\nimport {BufferGeometryUtils} from 'modules/three/examples/jsm/utils/BufferGeometryUtils';\nimport {CoreAttributeData} from './AttributeData';\n\nexport class CoreGeometry {\n\t_bounding_box: Box3 | undefined;\n\tprivate _points: CorePoint[] | undefined;\n\n\t// @INDEX_MODE_POINTS = 'INDEX_MODE_POINTS'\n\t// @INDEX_MODE_FACES = 'INDEX_MODE_FACES'\n\t// @INDEX_MODE_LINES = 'INDEX_MODE_LINES'\n\n\tconstructor(private _geometry: BufferGeometry) {}\n\t//\n\n\tgeometry() {\n\t\treturn this._geometry;\n\t}\n\tuuid() {\n\t\treturn this._geometry.uuid;\n\t}\n\n\tbounding_box() {\n\t\treturn (this._bounding_box = this._bounding_box || this._create_bounding_box());\n\t}\n\t_create_bounding_box() {\n\t\tthis._geometry.computeBoundingBox();\n\t\treturn this._geometry.boundingBox;\n\t}\n\n\tmark_as_instance() {\n\t\tthis._geometry.userData['is_instance'] = true;\n\t}\n\tstatic marked_as_instance(geometry: BufferGeometry): boolean {\n\t\treturn geometry.userData['is_instance'] === true;\n\t}\n\tmarked_as_instance(): boolean {\n\t\treturn CoreGeometry.marked_as_instance(this._geometry);\n\t}\n\tposition_attrib_name() {\n\t\tlet name = 'position';\n\t\tif (this.marked_as_instance()) {\n\t\t\tname = 'instancePosition';\n\t\t}\n\t\treturn name;\n\t}\n\n\tcompute_vertex_normals() {\n\t\tthis._geometry.computeVertexNormals();\n\t}\n\n\tuser_data_attribs() {\n\t\tconst key = 'indexed_attrib_values';\n\t\treturn (this._geometry.userData[key] = this._geometry.userData[key] || {});\n\t}\n\tindexed_attribute_names() {\n\t\treturn Object.keys(this.user_data_attribs() || {});\n\t}\n\tuser_data_attrib(name: string) {\n\t\tname = CoreAttribute.remap_name(name);\n\t\treturn this.user_data_attribs()[name];\n\t}\n\tis_attrib_indexed(name: string): boolean {\n\t\tname = CoreAttribute.remap_name(name);\n\t\treturn this.user_data_attrib(name) != null;\n\t}\n\n\thas_attrib(name: string): boolean {\n\t\tif (name === 'ptnum') {\n\t\t\treturn true;\n\t\t}\n\t\tname = CoreAttribute.remap_name(name);\n\t\treturn this._geometry.attributes[name] != null;\n\t}\n\tattrib_type(name: string) {\n\t\tif (this.is_attrib_indexed(name)) {\n\t\t\treturn CoreConstant.ATTRIB_TYPE.STRING;\n\t\t} else {\n\t\t\treturn CoreConstant.ATTRIB_TYPE.NUMERIC;\n\t\t}\n\t}\n\n\tattrib_names(): string[] {\n\t\treturn Object.keys(this._geometry.attributes);\n\t}\n\tattrib_sizes() {\n\t\tconst h: Dictionary<number> = {};\n\t\tfor (let attrib_name of this.attrib_names()) {\n\t\t\th[attrib_name] = this._geometry.attributes[attrib_name].itemSize;\n\t\t}\n\t\treturn h;\n\t}\n\tattrib_size(name: string): number {\n\t\tlet attrib;\n\t\tname = CoreAttribute.remap_name(name);\n\t\tif ((attrib = this._geometry.attributes[name]) != null) {\n\t\t\treturn attrib.itemSize;\n\t\t} else {\n\t\t\tif (name === 'ptnum') {\n\t\t\t\t// to ensure attrib copy with ptnum as source works\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tset_indexed_attribute_values(name: string, values: string[]) {\n\t\tthis.user_data_attribs()[name] = values;\n\t}\n\n\tset_indexed_attribute(name: string, values: string[], indices: number[]) {\n\t\tthis.set_indexed_attribute_values(name, values);\n\t\tthis._geometry.setAttribute(name, new Int32BufferAttribute(indices, 1));\n\t}\n\n\tadd_numeric_attrib(name: string, size: number = 1, default_value: NumericAttribValue = 0) {\n\t\tconst values = [];\n\n\t\tlet attribute_added = false;\n\t\tif (lodash_isNumber(default_value)) {\n\t\t\t// adding number\n\t\t\tfor (let i = 0; i < this.points_count(); i++) {\n\t\t\t\tfor (let j = 0; j < size; j++) {\n\t\t\t\t\tvalues.push(default_value);\n\t\t\t\t}\n\t\t\t}\n\t\t\tattribute_added = true;\n\t\t} else {\n\t\t\tif (size > 1) {\n\t\t\t\tif (lodash_isArray(default_value)) {\n\t\t\t\t\t// adding array\n\t\t\t\t\tfor (let i = 0; i < this.points_count(); i++) {\n\t\t\t\t\t\tfor (let j = 0; j < size; j++) {\n\t\t\t\t\t\t\tvalues.push(default_value[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tattribute_added = true;\n\t\t\t\t} else {\n\t\t\t\t\t// adding Vector2\n\t\t\t\t\tconst vec2 = default_value as Vector2Like;\n\t\t\t\t\tif (size == 2 && vec2.x != null && vec2.y != null) {\n\t\t\t\t\t\tfor (let i = 0; i < this.points_count(); i++) {\n\t\t\t\t\t\t\tvalues.push(vec2.x);\n\t\t\t\t\t\t\tvalues.push(vec2.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tattribute_added = true;\n\t\t\t\t\t}\n\t\t\t\t\t// adding Vector3\n\t\t\t\t\tconst vec3 = default_value as Vector3Like;\n\t\t\t\t\tif (size == 3 && vec3.x != null && vec3.y != null && vec3.z != null) {\n\t\t\t\t\t\tfor (let i = 0; i < this.points_count(); i++) {\n\t\t\t\t\t\t\tvalues.push(vec3.x);\n\t\t\t\t\t\t\tvalues.push(vec3.y);\n\t\t\t\t\t\t\tvalues.push(vec3.z);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tattribute_added = true;\n\t\t\t\t\t}\n\t\t\t\t\t// adding Color\n\t\t\t\t\tconst col = default_value as ColorLike;\n\t\t\t\t\tif (size == 3 && col.r != null && col.g != null && col.b != null) {\n\t\t\t\t\t\tfor (let i = 0; i < this.points_count(); i++) {\n\t\t\t\t\t\t\tvalues.push(col.r);\n\t\t\t\t\t\t\tvalues.push(col.g);\n\t\t\t\t\t\t\tvalues.push(col.b);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tattribute_added = true;\n\t\t\t\t\t}\n\t\t\t\t\t// adding Vector4\n\t\t\t\t\tconst vec4 = default_value as Vector4Like;\n\t\t\t\t\tif (size == 4 && vec4.x != null && vec4.y != null && vec4.z != null && vec4.w != null) {\n\t\t\t\t\t\tfor (let i = 0; i < this.points_count(); i++) {\n\t\t\t\t\t\t\tvalues.push(vec4.x);\n\t\t\t\t\t\t\tvalues.push(vec4.y);\n\t\t\t\t\t\t\tvalues.push(vec4.z);\n\t\t\t\t\t\t\tvalues.push(vec4.w);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tattribute_added = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (attribute_added) {\n\t\t\tthis._geometry.setAttribute(name, new Float32BufferAttribute(values, size));\n\t\t} else {\n\t\t\tthrow 'no other default value allowed for now in add_numeric_attrib';\n\t\t}\n\t}\n\n\tinit_position_attribute(points_count: number, default_value?: Vector3) {\n\t\tconst values = [];\n\t\tif (default_value == null) {\n\t\t\tdefault_value = new Vector3();\n\t\t}\n\n\t\tfor (let i = 0; i < points_count; i++) {\n\t\t\tvalues.push(default_value.x);\n\t\t\tvalues.push(default_value.y);\n\t\t\tvalues.push(default_value.z);\n\t\t}\n\n\t\treturn this._geometry.setAttribute('position', new Float32BufferAttribute(values, 3));\n\t}\n\n\tadd_attribute(name: string, attrib_data: CoreAttributeData) {\n\t\tswitch (attrib_data.type()) {\n\t\t\tcase CoreConstant.ATTRIB_TYPE.STRING:\n\t\t\t\treturn console.log('TODO: to implement');\n\t\t\tcase CoreConstant.ATTRIB_TYPE.NUMERIC:\n\t\t\t\treturn this.add_numeric_attrib(name, attrib_data.size());\n\t\t}\n\t}\n\n\trename_attribute(old_name: string, new_name: string) {\n\t\tif (this.is_attrib_indexed(old_name)) {\n\t\t\tthis.user_data_attribs()[new_name] = lodash_clone(this.user_data_attribs()[old_name]);\n\t\t\tdelete this.user_data_attribs()[old_name];\n\t\t}\n\n\t\tconst old_attrib = this._geometry.getAttribute(old_name);\n\t\tthis._geometry.setAttribute(new_name, new Float32BufferAttribute(old_attrib.array, old_attrib.itemSize));\n\t\treturn this._geometry.deleteAttribute(old_name);\n\t}\n\n\tdelete_attribute(name: string) {\n\t\tif (this.is_attrib_indexed(name)) {\n\t\t\tdelete this.user_data_attribs()[name];\n\t\t}\n\n\t\treturn this._geometry.deleteAttribute(name);\n\t}\n\n\tclone(): BufferGeometry {\n\t\treturn CoreGeometry.clone(this._geometry);\n\t}\n\n\tstatic clone(src_geometry: BufferGeometry): BufferGeometry {\n\t\tlet src_userData;\n\n\t\t// monkey path\n\t\tfor (let attribute_name of Object.keys(src_geometry.attributes)) {\n\t\t\tconst attribute = src_geometry.getAttribute(attribute_name);\n\t\t\tif (attribute.constructor.name == InterleavedBufferAttribute.name) {\n\t\t\t\tMonkeyPatcher.patch(attribute as InterleavedBufferAttribute);\n\t\t\t}\n\t\t}\n\n\t\tconst new_geometry = src_geometry.clone();\n\t\tif ((src_userData = src_geometry.userData) != null) {\n\t\t\tnew_geometry.userData = lodash_cloneDeep(src_userData);\n\t\t}\n\t\treturn new_geometry;\n\t}\n\n\tpoints_count(): number {\n\t\treturn CoreGeometry.points_count(this._geometry);\n\t}\n\n\tstatic points_count(geometry: BufferGeometry): number {\n\t\tlet position;\n\t\tlet count = 0;\n\t\tconst core_geometry = new this(geometry);\n\t\tlet position_attrib_name = 'position';\n\t\tif (core_geometry.marked_as_instance()) {\n\t\t\tposition_attrib_name = 'instancePosition';\n\t\t}\n\n\t\tif ((position = geometry.getAttribute(position_attrib_name)) != null) {\n\t\t\tlet array;\n\t\t\tif ((array = position.array) != null) {\n\t\t\t\tcount = array.length / 3;\n\t\t\t}\n\t\t}\n\n\t\treturn count;\n\t}\n\n\t// TODO: use lodash_chunk\n\t// like: lodash_chunk(template_geometry.getAttribute('position').array, 3)\n\tpoints(): CorePoint[] {\n\t\treturn (this._points = this._points || this.points_from_geometry());\n\t}\n\treset_points() {\n\t\tthis._points = undefined;\n\t}\n\tpoints_from_geometry(): CorePoint[] {\n\t\tconst points = [];\n\t\tconst position_attrib = this._geometry.getAttribute(this.position_attrib_name());\n\n\t\tif (position_attrib != null) {\n\t\t\tconst points_count = position_attrib.array.length / 3;\n\t\t\tfor (let point_index = 0; point_index < points_count; point_index++) {\n\t\t\t\tconst point = new CorePoint(this, point_index);\n\n\t\t\t\t// lodash_each lodash_keys(@_geometry.attributes), (attrib_name) =>\n\n\t\t\t\t// \tattribute = @_geometry.getAttribute(attrib_name)\n\t\t\t\t// \titem_size = attribute.itemSize\n\t\t\t\t// \tcurrent_index = point_index  *item_size\n\n\t\t\t\t// \tattrib_value = switch item_size\n\t\t\t\t// \t\twhen 1\n\t\t\t\t// \t\t\tattribute.array[current_index]\n\t\t\t\t// \t\twhen 2\n\t\t\t\t// \t\t\tnew Vector2(\n\t\t\t\t// \t\t\t\tattribute.array[current_index + 0]\n\t\t\t\t// \t\t\t\tattribute.array[current_index + 1]\n\t\t\t\t// \t\t\t\t)\n\t\t\t\t// \t\twhen 3\n\t\t\t\t// \t\t\tnew Vector3(\n\t\t\t\t// \t\t\t\tattribute.array[current_index + 0]\n\t\t\t\t// \t\t\t\tattribute.array[current_index + 1]\n\t\t\t\t// \t\t\t\tattribute.array[current_index + 2]\n\t\t\t\t// \t\t\t\t)\n\n\t\t\t\t// \tpoint.add_attribute(attrib_name, item_size, attrib_value)\n\n\t\t\t\tpoints.push(point);\n\t\t\t}\n\t\t}\n\n\t\treturn points;\n\t}\n\n\tstatic geometry_from_points(points: CorePoint[], object_type: ObjectType): BufferGeometry {\n\t\tconst geometry = new BufferGeometry();\n\t\tconst geometry_wrapper = new this(geometry);\n\n\t\tconst first_point = points[0];\n\t\tif (first_point != null) {\n\t\t\tconst old_geometry = first_point.geometry();\n\t\t\tconst old_geometry_wrapper = first_point.geometry_wrapper();\n\n\t\t\t// index\n\t\t\tconst new_index_by_old_index: Dictionary<number> = {};\n\t\t\tlodash_each(points, (point, i) => (new_index_by_old_index[point.index] = i));\n\n\t\t\tconst indices = this._indices_from_points(new_index_by_old_index, old_geometry, object_type);\n\t\t\tif (indices != null && indices.length !== 0) {\n\t\t\t\tgeometry.setIndex(indices);\n\t\t\t}\n\n\t\t\t// attributes\n\t\t\tconst {attributes} = old_geometry;\n\t\t\t// const new_attributes = {}\n\t\t\tfor (let attribute_name of Object.keys(attributes)) {\n\t\t\t\tconst attrib_values = old_geometry_wrapper.user_data_attribs()[attribute_name];\n\t\t\t\tconst is_attrib_indexed = attrib_values != null;\n\n\t\t\t\tif (is_attrib_indexed) {\n\t\t\t\t\tconst new_values = lodash_uniq(points.map((point) => point.attrib_value(attribute_name)));\n\t\t\t\t\tconst new_index_by_value: Dictionary<number> = {};\n\t\t\t\t\tlodash_each(new_values, (new_value, i) => (new_index_by_value[new_value] = i));\n\n\t\t\t\t\tgeometry_wrapper.user_data_attribs()[attribute_name] = new_values;\n\n\t\t\t\t\t// const old_attrib = old_geometry.getAttribute(attribute_name)\n\t\t\t\t\t// const old_attrib_array = old_attrib.array\n\t\t\t\t\tconst new_attrib_indices = [];\n\t\t\t\t\tfor (let point of points) {\n\t\t\t\t\t\t// const old_index = old_attrib_array[point.index()]\n\t\t\t\t\t\tconst new_index = new_index_by_value[point.attrib_value(attribute_name)];\n\t\t\t\t\t\tnew_attrib_indices.push(new_index);\n\t\t\t\t\t}\n\n\t\t\t\t\tgeometry.setAttribute(attribute_name, new Float32BufferAttribute(new_attrib_indices, 1));\n\t\t\t\t} else {\n\t\t\t\t\tconst values = [];\n\t\t\t\t\tconst attrib_size = attributes[attribute_name].itemSize;\n\t\t\t\t\tfor (let point of points) {\n\t\t\t\t\t\tconst value = point.attrib_value(attribute_name);\n\t\t\t\t\t\tswitch (attrib_size) {\n\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\tvalues.push(value);\n\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\tvalues.push(value.x);\n\t\t\t\t\t\t\t\tvalues.push(value.y);\n\t\t\t\t\t\t\t\tvalues.push(value.z);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tgeometry.setAttribute(attribute_name, new Float32BufferAttribute(values, attrib_size));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn geometry;\n\t}\n\n\tstatic _indices_from_points(\n\t\tnew_index_by_old_index: Dictionary<number>,\n\t\told_geometry: BufferGeometry,\n\t\tobject_type: ObjectType\n\t) {\n\t\tconst index_attrib = old_geometry.index;\n\t\tif (index_attrib != null) {\n\t\t\tconst old_indices = index_attrib.array;\n\n\t\t\tconst new_indices: number[] = [];\n\n\t\t\tswitch (object_type) {\n\t\t\t\tcase CoreConstant.OBJECT_TYPE.POINTS:\n\t\t\t\t\tlodash_each(old_indices, function(old_index, i: number) {\n\t\t\t\t\t\tconst new_index = new_index_by_old_index[old_index];\n\t\t\t\t\t\tif (new_index != null) {\n\t\t\t\t\t\t\tnew_indices.push(new_index);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CoreConstant.OBJECT_TYPE.MESH:\n\t\t\t\t\tlodash_each(old_indices, function(old_index, i: number) {\n\t\t\t\t\t\tif (i % 3 === 0) {\n\t\t\t\t\t\t\tconst old_index0 = old_indices[i];\n\t\t\t\t\t\t\tconst old_index1 = old_indices[i + 1];\n\t\t\t\t\t\t\tconst old_index2 = old_indices[i + 2];\n\t\t\t\t\t\t\tconst new_index0 = new_index_by_old_index[old_index0];\n\t\t\t\t\t\t\tconst new_index1 = new_index_by_old_index[old_index1];\n\t\t\t\t\t\t\tconst new_index2 = new_index_by_old_index[old_index2];\n\t\t\t\t\t\t\tif (new_index0 != null && new_index1 != null && new_index2 != null) {\n\t\t\t\t\t\t\t\tnew_indices.push(new_index0);\n\t\t\t\t\t\t\t\tnew_indices.push(new_index1);\n\t\t\t\t\t\t\t\tnew_indices.push(new_index2);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase CoreConstant.OBJECT_TYPE.LINE_SEGMENTS:\n\t\t\t\t\tlodash_each(old_indices, function(old_index, i: number) {\n\t\t\t\t\t\tif (i % 2 === 0) {\n\t\t\t\t\t\t\tconst old_index0 = old_indices[i];\n\t\t\t\t\t\t\tconst old_index1 = old_indices[i + 1];\n\t\t\t\t\t\t\tconst new_index0 = new_index_by_old_index[old_index0];\n\t\t\t\t\t\t\tconst new_index1 = new_index_by_old_index[old_index1];\n\t\t\t\t\t\t\tif (new_index0 != null && new_index1 != null) {\n\t\t\t\t\t\t\t\tnew_indices.push(new_index0);\n\t\t\t\t\t\t\t\tnew_indices.push(new_index1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn new_indices;\n\t\t}\n\t}\n\n\tstatic merge_geometries(geometries: BufferGeometry[]) {\n\t\tif (geometries.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t//\n\t\t// 1/3. set the new attrib indices for the indexed attributes\n\t\t//\n\t\tconst core_geometries = geometries.map((geometry) => new CoreGeometry(geometry));\n\t\tconst indexed_attribute_names = core_geometries[0].indexed_attribute_names();\n\n\t\tconst new_values_by_attribute_name: Dictionary<string[]> = {};\n\t\tfor (let indexed_attribute_name of indexed_attribute_names) {\n\t\t\tconst index_by_values: Dictionary<number> = {};\n\t\t\tconst all_geometries_points = [];\n\t\t\tfor (let core_geometry of core_geometries) {\n\t\t\t\tconst geometry_points = core_geometry.points();\n\t\t\t\tfor (let point of geometry_points) {\n\t\t\t\t\tall_geometries_points.push(point);\n\t\t\t\t\tconst value = point.attrib_value(indexed_attribute_name);\n\t\t\t\t\t//value_index = point.attrib_value_index(indexed_attribute_name)\n\t\t\t\t\t// TODO: typescript: that doesn't seem right\n\t\t\t\t\tindex_by_values[value] != null\n\t\t\t\t\t\t? index_by_values[value]\n\t\t\t\t\t\t: (index_by_values[value] = Object.keys(index_by_values).length);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst values = Object.keys(index_by_values);\n\t\t\tfor (let point of all_geometries_points) {\n\t\t\t\tconst value = point.attrib_value(indexed_attribute_name);\n\t\t\t\tconst new_index = index_by_values[value];\n\t\t\t\tpoint.set_attrib_index(indexed_attribute_name, new_index);\n\t\t\t}\n\n\t\t\tnew_values_by_attribute_name[indexed_attribute_name] = values;\n\t\t}\n\n\t\t//\n\t\t// 2/3. merge the geos\n\t\t//\n\t\tconst merged_geometry = BufferGeometryUtils.mergeBufferGeometries(geometries);\n\n\t\t//\n\t\t// 3/3. add the index attrib values\n\t\t//\n\n\t\tconst merged_geometry_wrapper = new this(merged_geometry);\n\t\tObject.keys(new_values_by_attribute_name).forEach((indexed_attribute_name) => {\n\t\t\tconst values = new_values_by_attribute_name[indexed_attribute_name];\n\t\t\tmerged_geometry_wrapper.set_indexed_attribute_values(indexed_attribute_name, values);\n\t\t});\n\n\t\tif (merged_geometry) {\n\t\t\tdelete merged_geometry.userData.mergedUserData;\n\t\t}\n\n\t\treturn merged_geometry;\n\t}\n\n\tsegments() {\n\t\t// const points = this.points();\n\t\tconst index = this.geometry().index?.array || [];\n\t\treturn lodash_chunk(index, 2);\n\t}\n\n\tfaces(): CoreFace[] {\n\t\treturn this.faces_from_geometry();\n\t}\n\tfaces_from_geometry(): CoreFace[] {\n\t\tconst index_array = this.geometry().index?.array || [];\n\t\tconst faces_count = index_array.length / 3;\n\t\treturn lodash_range(faces_count).map((i) => new CoreFace(this, i));\n\t}\n}\n\n// segments_count = 0.5*index.length\n// segments = []\n// lodash_times segments_count, (i)->\n// \tindices = [i, i+1]\n// \tsegments.push(indices) #lodash_map(indices, (index)->points[index])\n\n// segments\n","import {BaseNodeClass} from './nodes/_Base';\nimport {PolyScene} from './scene/PolyScene';\nimport {RenderersController} from './poly/RenderersController';\nimport {NodesRegister, RegisterOptions, BaseNodeConstructor} from './poly/NodesRegister';\nimport {NodeContext} from './poly/NodeContext';\n// import {ViewerLoadersManager} from 'src/engine/viewers/LoadersManager';\n\nexport class Poly {\n\tstatic _instance: Poly | undefined;\n\trenderers_controller: RenderersController = new RenderersController();\n\tnodes_register: NodesRegister = new NodesRegister();\n\n\tscenes_by_uuid: Dictionary<PolyScene> = {};\n\t_env: string | undefined;\n\t// public viewer_loaders_manager: ViewerLoadersManager = new ViewerLoadersManager();\n\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new Poly());\n\t}\n\tprivate constructor() {}\n\n\tregister_node(node: BaseNodeConstructor, tab_menu_category?: string, options?: RegisterOptions) {\n\t\tthis.nodes_register.register_node(node, tab_menu_category, options);\n\t}\n\tregistered_nodes(parent_context: NodeContext, type: string): Dictionary<typeof BaseNodeClass> {\n\t\treturn this.nodes_register.registered_nodes(parent_context, type);\n\t}\n\tin_worker_thread() {\n\t\treturn false;\n\t}\n\tdesktop_controller(): any {}\n\t// notify_scene_loaded(scene: PolyScene) {}\n\n\tplayer_mode(): boolean {\n\t\treturn false;\n\t}\n\n\tlog(...args: any[]) {\n\t\tconsole.log(...args);\n\t}\n\tset_env(env: string) {\n\t\tthis._env = env;\n\t}\n\tget env() {\n\t\treturn this._env;\n\t}\n}\n\n// declare global {\n// \tconst POLY: Poly;\n// }\n\n// declare global {\n// \tinterface Window {\n// \t\tPOLY: Poly;\n// \t}\n// }\n// make sure not to have library: 'POLY' in webpack for this to work\nexport const POLY = Poly.instance();\n","import {CoreGraph, CoreGraphNodeId} from './CoreGraph';\nimport {DirtyController, PostDirtyHook} from './DirtyController';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\n// import {SceneNodeDirtyable} from './SceneNodeDirtyable';\n\n// type Constructor<T = {}> = new (...args: any[]) => T;\nexport class CoreGraphNode {\n\t// protected _scene: PolyScene;\n\tprivate _graph: CoreGraph;\n\tprivate _graph_node_id: CoreGraphNodeId;\n\tprivate _dirty_controller: DirtyController = new DirtyController(this);\n\t// protected _name: string;\n\tconstructor(protected _scene: PolyScene, protected _name: string) {\n\t\t// super(...args);\n\t\tthis._graph_node_id = _scene.graph.next_id();\n\t\t_scene.graph.setNode(this);\n\t\tthis._graph = _scene.graph;\n\t}\n\tget name() {\n\t\treturn this._name;\n\t}\n\tset_name(name: string) {\n\t\tthis._name = name;\n\t}\n\t// set_scene(scene: PolyScene) {\n\t// \tthis._scene = scene;\n\t// \t// this._graph_node = new CoreGraphNode();\n\t// \t// this._graph_node.init(this._scene.graph);\n\t// \tthis._graph = scene.graph;\n\t// \tthis._graph_node_id = this.graph.next_id();\n\t// \tthis.graph.setNode(this);\n\t// }\n\t// init(graph: CoreGraph) {\n\t// \tthis._graph = graph;\n\t// \tthis._id = this.graph.next_id();\n\t// \tthis.graph.setNode(this);\n\t// }\n\t// full_path: ->\n\t// \t\"node with unknown path #{this.graph_node_id}\"\n\tget scene() {\n\t\treturn this._scene;\n\t}\n\tget graph() {\n\t\treturn this._graph;\n\t}\n\tget graph_node_id(): CoreGraphNodeId {\n\t\treturn this._graph_node_id;\n\t}\n\n\t//\n\t//\n\t// DIRTY CONTROLLER\n\t//\n\t//\n\tget dirty_controller() {\n\t\treturn this._dirty_controller;\n\t}\n\tset_dirty(trigger?: CoreGraphNode | null) {\n\t\ttrigger = trigger || this;\n\t\tthis._dirty_controller.set_dirty(trigger);\n\t}\n\tset_successors_dirty(trigger?: CoreGraphNode) {\n\t\tthis._dirty_controller.set_successors_dirty(trigger);\n\t}\n\tremove_dirty_state() {\n\t\tthis._dirty_controller.remove_dirty_state();\n\t}\n\tget is_dirty() {\n\t\treturn this._dirty_controller.is_dirty;\n\t}\n\tadd_post_dirty_hook(name: string, callback: PostDirtyHook) {\n\t\tthis._dirty_controller.add_post_dirty_hook(name, callback);\n\t}\n\n\t//\n\t//\n\t// GRAPH\n\t//\n\t//\n\n\t// private graph_add() {\n\t// }\n\tgraph_remove() {\n\t\tthis.graph.removeNode(this);\n\t}\n\n\t// _graph_connect: (src, dest)->\n\t// \tthis.graph().connect(src, dest)\n\tadd_graph_input(src: CoreGraphNode): boolean {\n\t\treturn this.graph.connect(src, this);\n\t}\n\tremove_graph_input(src: CoreGraphNode) {\n\t\tthis.graph.disconnect(src, this);\n\t}\n\n\t// graph_disconnect: (src, dest)->\n\t// \tthis.graph().disconnect(src, dest)\n\n\tgraph_disconnect_predecessors() {\n\t\tthis.graph.disconnect_predecessors(this);\n\t}\n\tgraph_disconnect_successors() {\n\t\tthis.graph.disconnect_successors(this);\n\t}\n\n\tgraph_predecessor_ids(): CoreGraphNodeId[] {\n\t\treturn this.graph.predecessor_ids(this._graph_node_id) || [];\n\t}\n\tgraph_predecessors(): CoreGraphNode[] {\n\t\treturn this.graph.predecessors(this);\n\t}\n\tgraph_successors(): CoreGraphNode[] {\n\t\treturn this.graph.successors(this);\n\t}\n\tgraph_all_predecessors(): CoreGraphNode[] {\n\t\treturn this.graph.all_predecessors(this);\n\t}\n\tgraph_all_successors(): CoreGraphNode[] {\n\t\treturn this.graph.all_successors(this);\n\t}\n}\n","import {CoreWalker} from 'src/core/Walker';\nimport {DecomposedPath} from 'src/core/DecomposedPath';\n// import {NodeSimple} from 'src/core/graph/NodeSimple'\nimport {BaseParamType, TypedParam} from 'src/engine/params/_Base';\nimport {BaseNodeType, TypedNode} from 'src/engine/nodes/_Base';\nimport {MethodDependency} from '../MethodDependency';\nimport lodash_isString from 'lodash/isString';\nimport lodash_isNumber from 'lodash/isNumber';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {BaseContainer} from 'src/engine/containers/_Base';\nimport {CoreObject} from 'src/core/Object';\n\n// type NodeOrParam = BaseNode | BaseParam;\n\nexport abstract class BaseMethod {\n\tpublic node: BaseNodeType;\n\n\tconstructor(public param: BaseParamType) {\n\t\t// this._init_update_dependencies_mode();\n\t\tthis.node = this.param.node;\n\t}\n\n\tstatic required_arguments(): any[] {\n\t\tconsole.warn('Expression.Method._Base.required_arguments virtual method call. Please override');\n\t\treturn [];\n\t}\n\tstatic optional_arguments(): any[] {\n\t\treturn [];\n\t}\n\tstatic min_allowed_arguments_count() {\n\t\treturn this.required_arguments().length;\n\t}\n\tstatic max_allowed_arguments_count() {\n\t\treturn this.min_allowed_arguments_count() + this.optional_arguments().length;\n\t}\n\tstatic allowed_arguments_count(count: number) {\n\t\treturn count >= this.min_allowed_arguments_count() && count <= this.max_allowed_arguments_count();\n\t}\n\n\t// process_arguments_and_dependencies(args){\n\t// \treturn new Promise((resolve, reject)=> {\n\t// \t\treturn this.process_arguments(args, value=> {\n\t// \t\t\tif (this.update_dependencies_mode()) {\n\t// \t\t\t\tthis.update_dependencies();\n\t// \t\t\t}\n\n\t// \t\t\treturn resolve(value);\n\t// \t\t});\n\t// \t});\n\t// }\n\n\tprocess_arguments(args: any): Promise<any> {\n\t\tthrow 'Expression.Method._Base.process_arguments virtual method call. Please override';\n\t}\n\n\tasync get_referenced_node_container(index_or_path: number | string): Promise<BaseContainer> {\n\t\tconst referenced_node = this.get_referenced_node(index_or_path);\n\n\t\tif (referenced_node) {\n\t\t\tconst container = await referenced_node.request_container();\n\t\t\tif (container) {\n\t\t\t\tconst core_group = container.core_content();\n\t\t\t\tif (core_group) {\n\t\t\t\t\treturn container;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthrow `referenced node invalid: ${referenced_node.full_path()}`;\n\t\t} else {\n\t\t\tthrow `invalid input (${index_or_path})`;\n\t\t}\n\t}\n\n\tget_referenced_param(path: string, decomposed_path?: DecomposedPath): BaseParamType | null {\n\t\tconst referenced_param = CoreWalker.find_param(this.node, path, decomposed_path);\n\n\t\t// if (referenced_param != null) {\n\n\t\t// \tif (this.update_dependencies_mode()) {\n\n\t\t// \t\t//param_connect_result = this.param().add_graph_input(referenced_param)\n\t\t// \t\tconst expression_node_connect_result = this.jsep_node()._graph_node.add_graph_input(referenced_param);\n\t\t// \t\t//if !(param_connect_result && expression_node_connect_result)\n\t\t// \t\tif (!expression_node_connect_result) {\n\t\t// \t\t\tthrow \"cannot create infinite graph\";\n\t\t// \t\t}\n\t\t// \t}\n\n\t\t// } else {\n\t\t// \tthrow `no param found for argument ${path}`;\n\t\t// }\n\n\t\treturn referenced_param || null;\n\t}\n\n\tfind_referenced_graph_node(index_or_path: number | string, decomposed_path?: DecomposedPath): CoreGraphNode | null {\n\t\tconst is_index = lodash_isNumber(index_or_path);\n\t\t// let node\n\t\tif (is_index) {\n\t\t\tconst index = index_or_path as number;\n\t\t\treturn this.node.io.inputs.input_graph_node(index);\n\t\t} else {\n\t\t\tconst path = index_or_path as string;\n\t\t\treturn this.get_referenced_node(path, decomposed_path);\n\t\t}\n\t}\n\tget_referenced_node(index_or_path: string | number, decomposed_path?: DecomposedPath): BaseNodeType | null {\n\t\t// if ((index_or_path != null) && (index_or_path.is_a != null) && index_or_path.is_a(BaseNode)) {\n\t\t// \tindex_or_path = index_or_path.full_path();\n\t\t// }\n\t\tif (lodash_isString(index_or_path)) {\n\t\t\tconst path = index_or_path;\n\t\t\treturn CoreWalker.find_node(this.node, path, decomposed_path);\n\t\t} else {\n\t\t\tconst index = index_or_path;\n\t\t\treturn this.node.io.inputs.input(index);\n\t\t}\n\n\t\t// if (referenced_node != null) {\n\n\t\t// \tif (this.update_dependencies_mode()) {\n\t\t// \t\t//node_connect_result = this.param().add_graph_input(referenced_node)\n\n\t\t// \t\tconst expression_node_connect_result = this.jsep_node()._graph_node.add_graph_input(referenced_node);\n\t\t// \t\t//if !(node_connect_result && expression_node_connect_result)\n\t\t// \t\tif (!expression_node_connect_result) {\n\t\t// \t\t\tthrow \"cannot create infinite graph\";\n\t\t// \t\t}\n\t\t// \t}\n\n\t\t// } else {\n\t\t// \tthrow `no node found for argument ${index_or_path}`;\n\t\t// }\n\n\t\t// return referenced_node;\n\t}\n\n\tfind_dependency(args: any): MethodDependency | null {\n\t\treturn null;\n\t}\n\n\tcreate_dependency_from_index_or_path(index_or_path: number | string): MethodDependency | null {\n\t\t// console.log(\"is_index\", index_or_path)\n\t\tconst decomposed_path = new DecomposedPath();\n\t\tconst node = this.find_referenced_graph_node(index_or_path, decomposed_path);\n\t\tif (node) {\n\t\t\treturn this.create_dependency(node, index_or_path, decomposed_path);\n\t\t}\n\t\treturn null;\n\t}\n\tcreate_dependency(\n\t\tnode: CoreGraphNode,\n\t\tindex_or_path: number | string,\n\t\tdecomposed_path?: DecomposedPath\n\t): MethodDependency | null {\n\t\tif (CoreObject.is_a(node, TypedNode) || CoreObject.is_a(node, TypedParam)) {\n\t\t\tconst node_or_param = node as BaseNodeType;\n\t\t\treturn MethodDependency.create(this.param, index_or_path, node_or_param, decomposed_path?.named_nodes);\n\t\t}\n\t\treturn MethodDependency.create(this.param, index_or_path, node, decomposed_path?.named_nodes);\n\t}\n\n\t//\n\t//\n\t// UPDATE DEPENDENCIES\n\t//\n\t//\n\t// _init_update_dependencies_mode() {\n\t// \treturn this.set_update_dependencies_mode(false);\n\t// }\n\t// set_update_dependencies_mode(mode){\n\t// \treturn this._update_dependencies_mode = mode;\n\t// }\n\t// update_dependencies_mode() {\n\t// \treturn this._update_dependencies_mode;\n\t// }\n\t// update_dependencies() {}\n}\n//\n","import {PolyScene} from '../scene/PolyScene';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n// import {NamedGraphNode} from 'src/core/graph/NamedGraphNode';\n\n// import {BaseParam} from 'src/engine/params/_Base';\n// import {GeometryContainer} from 'src/engine/containers/Geometry';\n// import {UIData} from './UIData';\n\n// import {Bypass} from './concerns/Bypass';\n// import {ConnectionsOwner} from './concerns/ConnectionsOwner';\n// import {ContainerOwner} from './concerns/ContainerOwner';\n// import {Cook} from './concerns/Cook';\n// import {CustomNode} from './concerns/CustomNode';\n// import {Dependencies} from './concerns/old/Dependencies';\n// import {DisplayFlag} from './concerns/DisplayFlag';\n// import {Errored} from './concerns/Errored';\n// import {HierarchyChildrenOwner} from './concerns/HierarchyChildrenOwner';\n// import {HierarchyParentOwner} from './concerns/old/HierarchyParentOwner';\n// import {InputsClonable} from './concerns/InputsClonable';\n// import {InputsOwner} from './concerns/InputsOwner';\n// import {Json} from './concerns/Json';\n// import {LifeCycle} from './concerns/old/LifeCycle';\n// import {Named} from './concerns/Named';\n// import {OutputsOwner} from './concerns/OutputsOwner';\n// import {ParamsOwner} from './concerns/ParamsOwner';\n// import {Selectable} from './concerns/old/Selectable';\n// import {TimeDependent} from './concerns/TimeDependent';\n// import {UIDataOwner} from './concerns/UIDataOwner';\n// import {Visit} from './concerns/Visit';\n\nimport {UIData} from './utils/UIData';\nimport {FlagsController} from './utils/FlagsController';\nimport {StatesController} from './utils/StatesController';\nimport {HierarchyParentController} from './utils/hierarchy/ParentController';\nimport {HierarchyChildrenController} from './utils/hierarchy/ChildrenController';\nimport {LifeCycleController} from './utils/LifeCycleController';\nimport {TypedContainerController} from './utils/ContainerController';\nimport {CookController} from './utils/CookController';\nimport {DependenciesController} from './utils/DependenciesController';\nimport {NameController} from './utils/NameController';\nimport {NodeSerializer, NodeSerializerData} from './utils/Serializer';\nimport {ParamsController} from './utils/params/ParamsController';\nimport {ParamConstructorMap} from '../params/types/ParamConstructorMap';\nimport {ParamInitValuesTypeMap} from '../params/types/ParamInitValuesTypeMap';\n\nimport {NodeParamsConfig} from './utils/params/ParamsConfig';\nimport {ParamsValueAccessor, ParamsValueAccessorType} from 'src/engine/nodes/utils/params/ParamsValueAccessor';\nimport {ProcessingContext} from './utils/ProcessingContext';\nimport {IOController} from './utils/connections/IOController';\n\n// import {BaseContainer} from '../containers/_Base';\n\n// import {BaseParam} from 'src/engine/params/_Base';\n// import {BooleanParam} from 'src/engine/params/Boolean';\n// import {ButtonParam} from 'src/engine/params/Button';\n// import {ColorParam} from 'src/engine/params/Color';\n// import {FloatParam} from 'src/engine/params/Float';\n// import {IntegerParam} from 'src/engine/params/Integer';\n// import {OperatorPathParam} from 'src/engine/params/OperatorPath';\n// import {RampParam} from 'src/engine/params/Ramp';\n// import {SeparatorParam} from 'src/engine/params/Separator';\n// import {StringParam} from 'src/engine/params/String';\n// import {Vector2Param} from 'src/engine/params/Vector2';\n// import {Vector3Param} from 'src/engine/params/Vector3';\n// import {Vector4Param} from 'src/engine/params/Vector4';\nimport {NodeEvent} from '../poly/NodeEvent';\nimport {NodeContext} from '../poly/NodeContext';\n\n// import {TypedContainer} from 'src/engine/containers/_Base';\nimport {ParamsAccessorType, ParamsAccessor} from './utils/params/ParamsAccessor';\n\nexport interface NodeVisitor {\n\tvisit_node: (node: BaseNodeType) => any;\n\tvisit_node_obj: (node: BaseNodeType) => any;\n}\n\ninterface NodeDeletedEmitData {\n\tparent_id: string;\n}\ninterface NodeCreatedEmitData {\n\tchild_node_json: NodeSerializerData;\n}\ntype EmitDataByNodeEventMapGeneric = {[key in NodeEvent]: any};\nexport interface EmitDataByNodeEventMap extends EmitDataByNodeEventMapGeneric {\n\t[NodeEvent.CREATED]: NodeCreatedEmitData;\n\t[NodeEvent.DELETED]: NodeDeletedEmitData;\n\t[NodeEvent.ERROR_UPDATED]: undefined;\n}\n// emit(event_name: NodeEvent.CREATED, data: EmitDataByNodeEventMap[NodeEvent.CREATED]): void;\n// \temit(event_name: NodeEvent.DELETED, data: NodeDeletedEmitData): void;\n// \temit(event_name: NodeEvent.NAME_UPDATED): void;\n// \temit(event_name: NodeEvent.OVERRIDE_CLONABLE_STATE_UPDATE): void;\n// \temit(event_name: NodeEvent.NAMED_INPUTS_UPDATED): void;\n// \temit(event_name: NodeEvent.NAMED_OUTPUTS_UPDATED): void;\n// \temit(event_name: NodeEvent.INPUTS_UPDATED): void;\n// \temit(event_name: NodeEvent.PARAMS_UPDATED): void;\n// \temit(event_name: NodeEvent.UI_DATA_POSITION_UPDATED): void;\n// \temit(event_name: NodeEvent.UI_DATA_COMMENT_UPDATED): void;\n// \temit(event_name: NodeEvent.ERROR_UPDATED): void;\n// \temit(event_name: NodeEvent.FLAG_BYPASS_UPDATED): void;\n// \temit(event_name: NodeEvent.FLAG_DISPLAY_UPDATED): void;\n// \temit(event_name: NodeEvent.SELECTION_UPDATED): void;\n\nimport {ContainerMap} from 'src/engine/containers/utils/ContainerMap';\nimport {ContainableMap} from 'src/engine/containers/utils/ContainableMap';\nimport {BaseContainer} from '../containers/_Base';\nimport {ParamOptions} from '../params/utils/OptionsController';\nimport {ParamType} from '../poly/ParamType';\nimport {DisplayNodeController} from './utils/DisplayNodeController';\n\n// type Container = ContainerMap[KT];\ntype KT = keyof ContainerMap;\nexport class TypedNode<T extends KT, NT extends BaseNodeType, K extends NodeParamsConfig> extends CoreGraphNode {\n\tcontainer_controller: TypedContainerController<ContainerMap[T]> = new TypedContainerController<ContainerMap[T]>(\n\t\tthis,\n\t\tBaseContainer\n\t);\n\n\tprivate _parent_controller: HierarchyParentController | undefined;\n\n\tprivate _ui_data: UIData | undefined;\n\n\tprivate _dependencies_controller: DependenciesController | undefined;\n\tprivate _states: StatesController | undefined;\n\tprivate _lifecycle: LifeCycleController | undefined;\n\tprivate _serializer: NodeSerializer | undefined;\n\tprivate _cook_controller: CookController | undefined;\n\tpublic readonly flags: FlagsController | undefined;\n\tprotected _display_node_controller: DisplayNodeController | undefined;\n\tget display_node_controller() {\n\t\treturn this._display_node_controller;\n\t}\n\n\tprivate _params_controller: ParamsController | undefined;\n\treadonly params_config: K | undefined;\n\treadonly pv: ParamsValueAccessorType<K> = (<unknown>new ParamsValueAccessor<K>()) as ParamsValueAccessorType<K>;\n\t// readonly pv: ParamsValueAccessor<K> = new ParamsValueAccessor<K>(this);\n\treadonly p: ParamsAccessorType<K> = (<unknown>new ParamsAccessor<K>()) as ParamsAccessorType<K>;\n\t// readonly p: ParamsAccessor<K> = new ParamsAccessor<K>(this);\n\n\tprivate _processing_context: ProcessingContext | undefined;\n\tprivate _name_controller: NameController | undefined;\n\tprivate _io: IOController<NT> | undefined;\n\tget parent_controller(): HierarchyParentController {\n\t\treturn (this._parent_controller = this._parent_controller || new HierarchyParentController(this));\n\t}\n\tstatic displayed_input_names(): string[] {\n\t\treturn [];\n\t}\n\n\tprivate _children_controller: HierarchyChildrenController | undefined;\n\tprotected _children_controller_context: NodeContext | undefined;\n\tget children_controller_context() {\n\t\treturn this._children_controller_context;\n\t}\n\tprivate _create_children_controller(): HierarchyChildrenController | undefined {\n\t\tif (this._children_controller_context) {\n\t\t\treturn new HierarchyChildrenController(this, this._children_controller_context);\n\t\t}\n\t}\n\tget children_controller(): HierarchyChildrenController | undefined {\n\t\treturn (this._children_controller = this._children_controller || this._create_children_controller());\n\t}\n\tchildren_allowed(): boolean {\n\t\treturn this._children_controller_context != null;\n\t}\n\n\tget ui_data(): UIData {\n\t\treturn (this._ui_data = this._ui_data || new UIData(this));\n\t}\n\tget dependencies_controller(): DependenciesController {\n\t\treturn (this._dependencies_controller = this._dependencies_controller || new DependenciesController(this));\n\t}\n\tget states(): StatesController {\n\t\treturn (this._states = this._states || new StatesController(this));\n\t}\n\tget lifecycle(): LifeCycleController {\n\t\treturn (this._lifecycle = this._lifecycle || new LifeCycleController(this));\n\t}\n\tget serializer(): NodeSerializer {\n\t\treturn (this._serializer = this._serializer || new NodeSerializer(this));\n\t}\n\t// get container_controller(): TypedContainerController<T> {\n\t// \treturn (this._container_controller = this._container_controller || new TypedContainerController<T>(this));\n\t// }\n\tget cook_controller(): CookController {\n\t\treturn (this._cook_controller = this._cook_controller || new CookController(this));\n\t}\n\tget io(): IOController<NT> {\n\t\treturn (this._io = this._io || new IOController<NT>((<unknown>this) as NT));\n\t}\n\tget name_controller(): NameController {\n\t\treturn (this._name_controller = this._name_controller || new NameController(this));\n\t}\n\tset_name(name: string) {\n\t\tthis.name_controller.set_name(name);\n\t}\n\t_set_core_name(name: string) {\n\t\tthis._name = name;\n\t}\n\tget params(): ParamsController {\n\t\treturn (this._params_controller = this._params_controller || new ParamsController(this));\n\t}\n\tget processing_context(): ProcessingContext {\n\t\treturn (this._processing_context = this._processing_context || new ProcessingContext(this));\n\t}\n\n\tconstructor(scene: PolyScene, name: string = 'BaseNode') {\n\t\tsuper(scene, name);\n\t}\n\n\tprivate _initialized: boolean = false;\n\tpublic initialize_base_and_node() {\n\t\tif (!this._initialized) {\n\t\t\tthis.initialize_base_node(); // for base classes of Sop, Obj...\n\t\t\tthis.initialize_node(); // for Derivated node clases, like BoxSop, TransformSop...\n\t\t\tthis._initialized = true;\n\t\t} else {\n\t\t\tconsole.warn('node already initialized');\n\t\t}\n\t}\n\tprotected initialize_base_node() {}\n\tprotected initialize_node() {}\n\t// constructor() {\n\t// \tsuper('base_node');\n\n\t// \t// this._init_node_scene()\n\t// \t// this._init_context_owner()\n\t// \t// this._init_dirtyable()\n\t// \t// this._init_graph_node()\n\n\t// \t// this._init_bypass_flag();\n\t// \t// this._init_display_flag();\n\t// \t//this._init_context()\n\t// \t// this._init_cook();\n\t// \t// this._init_error();\n\t// \t// this._init_inputs();\n\t// \t// this._init_outputs();\n\t// \t// this._init_hierarchy_parent_owner();\n\t// \t//this._init_time_dependent()\n\t// \t// this._init_ui_data();\n\t// }\n\tstatic type(): string {\n\t\tthrow 'type to be overriden';\n\t}\n\tget type() {\n\t\tconst c = this.constructor as typeof BaseNodeClass;\n\t\treturn c.type();\n\t}\n\tstatic node_context(): NodeContext {\n\t\tthrow 'requires override';\n\t}\n\tnode_context(): NodeContext {\n\t\tconst c = this.constructor as typeof BaseNodeClass;\n\t\treturn c.node_context();\n\t}\n\n\tstatic required_three_imports(): string[] {\n\t\treturn [];\n\t}\n\tstatic required_imports() {\n\t\tlet three_imports = this.required_three_imports();\n\t\tif (three_imports) {\n\t\t\t// if (!lodash_isArray(three_imports)) {\n\t\t\t// \tthree_imports = [<unknown>three_imports as string];\n\t\t\t// }\n\t\t\treturn three_imports.map((e) => `three/examples/jsm/${e}`);\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\trequired_imports() {\n\t\tconst c = this.constructor as typeof BaseNodeClass;\n\t\treturn c.required_imports();\n\t}\n\tstatic require_webgl2(): boolean {\n\t\treturn false;\n\t}\n\trequire_webgl2(): boolean {\n\t\tconst c = this.constructor as typeof BaseNodeClass;\n\t\treturn c.require_webgl2();\n\t}\n\n\t// set_scene(scene: PolyScene) {\n\t// \tsuper.set_scene(scene);\n\t// \t// this.io.inputs._init_graph_node_inputs();\n\t// }\n\n\t// accepts_visitor<T extends NodeVisitor>(visitor: T): ReturnType<T['visit_node']> {\n\t// \treturn visitor.visit_node(this);\n\t// }\n\tset_parent(parent: BaseNodeType | null) {\n\t\tthis.parent_controller.set_parent(parent);\n\t}\n\tget parent() {\n\t\treturn this.parent_controller.parent;\n\t}\n\tget root() {\n\t\treturn this._scene.root;\n\t}\n\tfull_path(): string {\n\t\treturn this.parent_controller.full_path();\n\t}\n\n\t// params\n\tcreate_params() {}\n\tadd_param<T extends ParamType>(\n\t\ttype: T,\n\t\tname: string,\n\t\tdefault_value: ParamInitValuesTypeMap[T],\n\t\toptions?: ParamOptions\n\t): ParamConstructorMap[T] | undefined {\n\t\treturn this._params_controller?.add_param(type, name, default_value, options);\n\t}\n\t// within_param_folder(folder_name: string, callback: () => void) {\n\t// \tthis._params_controller?.within_param_folder(folder_name, callback);\n\t// }\n\n\t// cook\n\tcook(input_contents: any[]): any {\n\t\treturn null;\n\t}\n\n\t// container\n\trequest_container() {\n\t\treturn this.container_controller.request_container();\n\t}\n\tset_container(content: ContainableMap[T], message: string | null = null) {\n\t\t// if message?\n\t\t// TODO: typescript: why is this a type of never\n\t\tthis.container_controller.container.set_content(content as never); //, this.self.cook_eval_key());\n\t\tif (content != null) {\n\t\t\tif (!(content as any).name) {\n\t\t\t\t(content as any).name = this.full_path();\n\t\t\t}\n\t\t\tif (!(content as any).node) {\n\t\t\t\t(content as any).node = this;\n\t\t\t}\n\t\t}\n\t\t//if @_container.has_content()?\n\t\tthis.cook_controller.end_cook(message);\n\t}\n\n\t// hierarchy\n\tcreate_node(type: string) {\n\t\treturn this.children_controller?.create_node(type);\n\t}\n\tremove_node(node: BaseNodeType) {\n\t\tthis.children_controller?.remove_node(node);\n\t}\n\tchildren() {\n\t\treturn this.children_controller?.children() || [];\n\t}\n\tnode(path: string) {\n\t\treturn this.children_controller?.find_node(path) || null;\n\t}\n\tnodes_by_type(type: string) {\n\t\treturn this.children_controller?.nodes_by_type(type) || [];\n\t}\n\n\t// inputs\n\tset_input(input_index_or_name: number | string, node: NT | null, output_index_or_name: number | string = 0) {\n\t\tthis.io.inputs.set_input(input_index_or_name, node, output_index_or_name);\n\t}\n\n\t// emit\n\n\temit(event_name: NodeEvent.CREATED, data: EmitDataByNodeEventMap[NodeEvent.CREATED]): void;\n\temit(event_name: NodeEvent.DELETED, data: EmitDataByNodeEventMap[NodeEvent.DELETED]): void;\n\temit(event_name: NodeEvent.NAME_UPDATED): void;\n\temit(event_name: NodeEvent.OVERRIDE_CLONABLE_STATE_UPDATE): void;\n\temit(event_name: NodeEvent.NAMED_INPUTS_UPDATED): void;\n\temit(event_name: NodeEvent.NAMED_OUTPUTS_UPDATED): void;\n\temit(event_name: NodeEvent.INPUTS_UPDATED): void;\n\temit(event_name: NodeEvent.PARAMS_UPDATED): void;\n\temit(event_name: NodeEvent.UI_DATA_POSITION_UPDATED): void;\n\temit(event_name: NodeEvent.UI_DATA_COMMENT_UPDATED): void;\n\temit(event_name: NodeEvent.ERROR_UPDATED): void;\n\temit(event_name: NodeEvent.FLAG_BYPASS_UPDATED): void;\n\temit(event_name: NodeEvent.FLAG_DISPLAY_UPDATED): void;\n\temit(event_name: NodeEvent.SELECTION_UPDATED): void;\n\temit(event_name: NodeEvent, data: object | null = null): void {\n\t\t// super.emit(event_name, data);\n\t\tthis.scene.events_controller.dispatch(this, event_name, data);\n\t}\n\n\t// serializer\n\tto_json(include_param_components: boolean = false) {\n\t\treturn this.serializer.to_json(include_param_components);\n\t}\n}\n\nexport type BaseNodeType = TypedNode<any, BaseNodeType, any>;\nexport class BaseNodeClass extends TypedNode<any, BaseNodeType, any> {}\n","import {Mesh} from 'three/src/objects/Mesh';\nimport {OrthographicCamera} from 'three/src/cameras/OrthographicCamera';\nimport {PlaneBufferGeometry} from 'three/src/geometries/PlaneGeometry';\n\nfunction Pass() {\n\n\t// if set to true, the pass is processed by the composer\n\tthis.enabled = true;\n\n\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\tthis.needsSwap = true;\n\n\t// if set to true, the pass clears its buffer before rendering\n\tthis.clear = false;\n\n\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\tthis.renderToScreen = false;\n\n}\n\nObject.assign( Pass.prototype, {\n\n\tsetSize: function ( /* width, height */ ) {},\n\n\trender: function ( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n} );\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nPass.FullScreenQuad = ( function () {\n\n\tvar camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tvar geometry = new PlaneBufferGeometry( 2, 2 );\n\n\tvar FullScreenQuad = function ( material ) {\n\n\t\tthis._mesh = new Mesh( geometry, material );\n\n\t};\n\n\tObject.defineProperty( FullScreenQuad.prototype, 'material', {\n\n\t\tget: function () {\n\n\t\t\treturn this._mesh.material;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tthis._mesh.material = value;\n\n\t\t}\n\n\t} );\n\n\tObject.assign( FullScreenQuad.prototype, {\n\n\t\tdispose: function () {\n\n\t\t\tthis._mesh.geometry.dispose();\n\n\t\t},\n\n\t\trender: function ( renderer ) {\n\n\t\t\trenderer.render( this._mesh, camera );\n\n\t\t}\n\n\t} );\n\n\treturn FullScreenQuad;\n\n} )();\n\nexport { Pass };\n","import {TypedNode} from '../_Base';\n\nimport {Material} from 'three/src/materials/Material';\n\n// import DisplayFlag from '../Concerns/DisplayFlag';\n\nimport {MaterialContainer} from 'src/engine/containers/Material';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {TypedContainerController} from '../utils/ContainerController';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\n// type RenderHook = (object: Object3D) => void;\n\nexport abstract class TypedMatNode<M extends Material, K extends NodeParamsConfig> extends TypedNode<\n\t'MATERIAL',\n\tBaseMatNodeType,\n\tK\n> {\n\tcontainer_controller: TypedContainerController<MaterialContainer> = new TypedContainerController<MaterialContainer>(\n\t\tthis,\n\t\tMaterialContainer\n\t);\n\tstatic node_context(): NodeContext {\n\t\treturn NodeContext.MAT;\n\t}\n\n\tprotected _material: M | undefined;\n\t// protected _update_methods: RenderHook[] = [];\n\n\tinitialize_base_node() {\n\t\tsuper.initialize_base_node();\n\t\t// this._update_methods = [];\n\n\t\t// this._init_bypass_flag({\n\t\t// \thas_bypass_flag: false,\n\t\t// });\n\t\t// this._init_display_flag({\n\t\t// \thas_display_flag: false,\n\t\t// });\n\n\t\t// this.set_inputs_count_to_zero();\n\t\t// this._init_outputs({has_outputs: false});\n\n\t\t// this.container_controller.init(MaterialContainer);\n\n\t\tthis.name_controller.add_post_set_full_path_hook(this.set_material_name.bind(this));\n\n\t\tthis.add_post_dirty_hook(\n\t\t\t'_cook_main_without_inputs_when_dirty',\n\t\t\tthis._cook_main_without_inputs_when_dirty_bound\n\t\t);\n\n\t\t// it's probably good not to have to create any material in the constructor\n\t\t// but only on request\n\t\t// this._material = this.create_material();\n\t\t// this.set_material(this._material);\n\t}\n\tprivate _cook_main_without_inputs_when_dirty_bound = this._cook_main_without_inputs_when_dirty.bind(this);\n\tprivate async _cook_main_without_inputs_when_dirty() {\n\t\tawait this.cook_controller.cook_main_without_inputs();\n\t}\n\n\tprivate set_material_name() {\n\t\t// ensures the material has a full path set\n\t\t// allowing the render hook to be set\n\t\t//this.set_material(@_material)\n\t\tif (this._material) {\n\t\t\tthis._material.name = this.full_path();\n\t\t}\n\t}\n\n\tabstract create_material(): M;\n\tget material() {\n\t\treturn (this._material = this._material || this.create_material());\n\t}\n\t//\n\n\tset_material(material: Material) {\n\t\tthis.set_container(material);\n\t}\n\n\t// add_update_method(method, arg?: any) {\n\t// \tthis._update_methods.push([method.bind(this), arg]);\n\t// }\n\n\t//run_update_methods: ->\n\n\tadd_render_hook(object: Object3D) {}\n}\n//delete object.onBeforeRender\n\nexport type BaseMatNodeType = TypedMatNode<Material, any>;\nexport class BaseMatNodeClass extends TypedMatNode<Material, any> {\n\tcreate_material() {\n\t\treturn new Material();\n\t}\n}\n","import {Object3D} from 'three/src/core/Object3D';\n\nimport {TypedNode, BaseNodeType} from '../_Base';\n// import {BaseSopNode} from '../sop/_Base';\n// import {LookAt} from './Concerns/LookAt';\nimport {ObjectContainer} from 'src/engine/containers/Object';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {TypedContainerController} from '../utils/ContainerController';\nimport {ObjectsManagerNode} from '../manager/ObjectsManager';\nimport {Group} from 'three/src/objects/Group';\n\nconst INPUT_OBJECT_NAME = 'parent object';\nconst DEFAULT_INPUT_NAMES = [INPUT_OBJECT_NAME, INPUT_OBJECT_NAME, INPUT_OBJECT_NAME, INPUT_OBJECT_NAME];\n\ninterface Object3DWithNode extends Object3D {\n\tnode: BaseNodeType;\n}\n// interface BaseObjNodeVisitor extends BaseNodeVisitor {\n// \tvisit_node_obj: (node: BaseObjNodeType) => any;\n// }\n\nexport enum ObjNodeRenderOrder {\n\tMANAGER = 0,\n\tFOG = 1,\n\tCAMERA = 2,\n\tLIGHT = 3,\n\tEVENT = 4,\n\tMAT = 5,\n}\n\nexport class TypedObjNode<O extends Object3D, K extends NodeParamsConfig> extends TypedNode<\n\t'OBJECT',\n\tBaseObjNodeType,\n\tK\n> {\n\tcontainer_controller: TypedContainerController<ObjectContainer> = new TypedContainerController<ObjectContainer>(\n\t\tthis,\n\t\tObjectContainer\n\t);\n\tpublic readonly render_order: number = ObjNodeRenderOrder.MANAGER;\n\t// public readonly add_to_hierarchy: boolean = true;\n\tstatic node_context(): NodeContext {\n\t\treturn NodeContext.OBJ;\n\t}\n\tstatic displayed_input_names(): string[] {\n\t\treturn DEFAULT_INPUT_NAMES;\n\t}\n\n\t// protected _main_group = new Group();\n\tprotected _children_group = new Group();\n\tprotected _object!: O;\n\t// _sop_loaded: boolean = false;\n\n\t// protected _look_at_controller: LookAtController | undefined;\n\t// get look_at_controller(): LookAtController {\n\t// \treturn (this._look_at_controller = this._look_at_controller || new LookAtController(this));\n\t// }\n\t// protected _transform_controller: TransformController | undefined;\n\t// get transform_controller(): TransformController {\n\t// \treturn (this._transform_controller = this._transform_controller || new TransformController(this));\n\t// }\n\n\tprotected _attachable_to_hierarchy: boolean = true;\n\tget attachable_to_hierarchy() {\n\t\treturn this._attachable_to_hierarchy;\n\t}\n\tprotected _used_in_scene: boolean = true;\n\tget used_in_scene() {\n\t\treturn this._used_in_scene;\n\t}\n\t// TODO call set_used_in_scene(false) when node is deleted\n\tset_used_in_scene(state: boolean) {\n\t\tthis._used_in_scene = state;\n\t\tif (!this.scene.loading_controller.is_loading) {\n\t\t\tconst root = this.parent as ObjectsManagerNode;\n\t\t\tif (root) {\n\t\t\t\troot.update_object(this);\n\t\t\t}\n\t\t}\n\t}\n\tadd_object_to_parent(parent: Object3D) {\n\t\tif (this.attachable_to_hierarchy) {\n\t\t\tparent.add(this.object);\n\t\t}\n\t}\n\tremove_object_from_parent() {\n\t\tif (this.attachable_to_hierarchy) {\n\t\t\tconst parent = this.object.parent;\n\t\t\tif (parent) {\n\t\t\t\tparent.remove(this.object);\n\t\t\t}\n\t\t}\n\t}\n\n\t// protected _displayed_in_scene: boolean = true;\n\t// get displayed_in_scene() {\n\t// \treturn this._displayed_in_scene;\n\t// }\n\t// set_displayed_in_scene(state:boolean){\n\t// \tthis._displayed_in_scene = state;\n\t// }\n\n\tinitialize_base_node() {\n\t\t// this.container_controller.init(ObjectContainer);\n\t\tthis._object = this._create_object_with_attributes();\n\t\t// this._init_container_owner('Object');\n\t\t// this.flags.add_display();\n\t\tthis.name_controller.add_post_set_full_path_hook(this.set_object_name.bind(this));\n\t\tthis.set_object_name();\n\n\t\t// this.io.inputs.add_hook(() => {\n\t\t// \tthis.transform_controller.on_input_updated();\n\t\t// });\n\t\t// this._init_bypass_flag({\n\t\t// \thas_bypass_flag: false,\n\t\t// });\n\n\t\t// this._sop_loaded = false; // TODO: typescript, this should be moved to GeoObjNode\n\t}\n\n\t// this.add_param 'toggle', 'display', 1,\n\t// \tcallback: this.post_state_display_flag.bind(this)\n\n\t// cook: ->\n\t// \tsuper\n\t// \tconsole.error(this.constructor, 'cook method is not overloaded')\n\n\t// post_set_dirty: (original_trigger_graph_node, direct_trigger_graph_node)->\n\t// \t#console.log(\"#{this.full_path()} set dirty by #{original_trigger_graph_node?.full_path()} and #{direct_trigger_graph_node?.full_path()}\")\n\t// \tthis.is_displayed (is_displayed)=>\n\t// \t\tif is_displayed\n\t// \t\t\tthis.parent().update_object(this)\n\n\t//post_remove_dirty_state: ->\n\t//console.log(\"obj #{this.full_path()} remove dirty\")\n\t//console.log(\"remove_dirty_state: #{this.full_path()}\")\n\n\t// set_object: (object)->\n\n\t// \tif object?\n\t// \t\tobject.name = this.name()\n\t// \t\tthis.set_container(object)\n\t// get main_group() {\n\t// \treturn this._main_group;\n\t// }\n\tget children_group() {\n\t\treturn this._children_group;\n\t}\n\tget object() {\n\t\treturn this._object; //= this._object || this._create_object_with_attributes()\n\t}\n\n\t_create_object_with_attributes(): O {\n\t\tconst object = this.create_object();\n\t\t// object.name = 'content';\n\t\t// if (object != null) {\n\t\t// \tobject.name = this.full_path();\n\t\t(object as Object3DWithNode).node = this;\n\t\t// }\n\t\t// this._main_group.add(this._children_group);\n\t\tobject.add(this._children_group);\n\t\treturn object as O;\n\t}\n\tprivate set_object_name() {\n\t\tif (this._object) {\n\t\t\tthis._object.name = this.full_path();\n\t\t\tthis._children_group.name = `${this.full_path()}:parented_outputs`;\n\t\t}\n\t}\n\t// private set_group_name() {\n\t// \t// ensures the material has a full path set\n\t// \t// allowing the render hook to be set\n\t// \t//this.set_material(@_material)\n\t// \tconst group = this.group;\n\t// \tif (group) {\n\t// \t\tgroup.name = this.full_path();\n\t// \t}\n\t// }\n\n\tcreate_object(): Object3D {\n\t\treturn new Object3D();\n\t}\n\n\t// request_display_node() {}\n\n\tis_display_node_cooking(): boolean {\n\t\treturn false;\n\t}\n\n\t// post_state_display_flag() {\n\t// \tconst object = this.object;\n\t// \tif (object != null) {\n\t// \t\tconst displayed = this.is_displayed();\n\t// \t\tif (displayed) {\n\t// \t\t\tobject.visible = displayed;\n\n\t// \t\t\tif (!this._sop_loaded) {\n\t// \t\t\t\tthis.request_display_node();\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// }\n\n\tis_displayed(): boolean {\n\t\treturn this.flags?.display?.active || false;\n\t\t// if (callback == null) {\n\t\t// \tthrow 'no callback given to is_displayed';\n\t\t// }\n\n\t\t// const display_flag_state = this.display_flag_state();\n\t\t// return callback(display_flag_state);\n\t}\n\t// if !display_flag_state\n\t// \tcallback(false)\n\n\t// else\n\t// \tthis.param('display').eval (val)->\n\t// \t\tcallback(val)\n\n\t// accepts_visitor<T extends NodeVisitor>(visitor: T): ReturnType<T['visit_node_obj']> {\n\t// \treturn visitor.visit_node_obj(this);\n\t// }\n\n\t// replaces Dirtyable (TODO: try and replace this method name)\n\t// protected _init_dirtyable_hook() {\n\t// this.add_post_dirty_hook(this._cook_main_without_inputs_later.bind(this));\n\t// }\n\t// private _cook_main_without_inputs_later() {\n\t// \tconst c = () => {\n\t// \t\tthis.cook_controller.cook_main_without_inputs();\n\t// \t};\n\t// \tsetTimeout(c, 0);\n\t// \t// this.eval_all_params().then( ()=>{ this.cook() } )\n\t// }\n}\n\nexport type BaseObjNodeType = TypedObjNode<Object3D, any>;\nexport class BaseObjNodeClass extends TypedObjNode<Object3D, any> {}\n","// import {Vector3} from 'three/src/math/Vector3'\n// import {Vector2} from 'three/src/math/Vector2'\n\nimport {CoreWalker} from 'src/core/Walker';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n// import {NodeScene} from 'src/core/graph/NodeScene';\n// import {NamedGraphNode} from 'src/core/graph/NamedGraphNode';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\n// import {CallbackOption} from './concerns/options/Callback'\n// import {ColorOption} from './concerns/options/Color'\n// import {CookOption} from './concerns/options/Cook'\n// import {DesktopOption} from './concerns/options/Desktop'\n// import {ExpressionOption} from './concerns/options/Expression'\n// import {MenuOption} from './concerns/options/Menu'\n// import {NodeSelectionOption} from './concerns/options/NodeSelection'\n// import {RangeOption} from './concerns/options/Range'\n// import {AssetReferenceOption} from './concerns/options/AssetReference'\n// import {SpareOption} from './concerns/options/Spare'\n// import {MultilineOption} from './concerns/options/Multiline'\n// import {TextureOption} from './concerns/options/Texture'\n// import {VisibleOption} from './concerns/options/Visible'\n\n// import {Emit} from './concerns/Emit';\n// import {Errored} from './concerns/Errored';\n// import {Eval} from './concerns/Eval';\n// import {Expression} from './concerns/Expression';\n// import {Hierarchy} from './concerns/Hierarchy';\n// import {Json} from './concerns/Json';\n// import {Named} from './concerns/Named';\n// import {Node} from './concerns/Node';\n// import {Options} from './concerns/Options';\n// import {TimeDependent} from './concerns/TimeDependent';\n// import {Type} from './concerns/Type';\n// import {UIDataOwner} from './concerns/UIDataOwner';\n// import {VisitorsBase} from './concerns/visitors/_Base';\n\nimport {OptionsController} from './utils/OptionsController';\nimport {ExpressionController} from './utils/ExpressionController';\nimport {EmitController} from './utils/EmitController';\nimport {ParamSerializer} from './utils/Serializer';\nimport {StatesController} from './utils/StatesController';\n// import {UIData} from './utils/UIData';\n\nimport {TypedMultipleParam} from './_Multiple';\nimport {FloatParam} from './Float';\nimport {ParamType} from '../poly/ParamType';\nimport {ParamEvent} from '../poly/ParamEvent';\nimport {PolyScene} from '../scene/PolyScene';\n\nimport {ParamInitValuesTypeMap} from '../params/types/ParamInitValuesTypeMap';\nimport {ParamValuesTypeMap} from '../params/types/ParamValuesTypeMap';\nimport {ParamValueSerializedTypeMap} from '../params/types/ParamValueSerializedTypeMap';\nimport {ParamInitValueSerializedTypeMap} from './types/ParamInitValueSerializedTypeMap';\n// import {TypedNumericParam} from './_Numeric';\n\n// export interface ParamVisitor {\n// \tvisit_param: (param: BaseParamType) => any;\n// \tvisit_multiple_param: (param: TypedMultipleParam<any>) => any;\n// \tvisit_numeric_param: (param: TypedNumericParam<any>) => any;\n// }\n\n// type ParamTypeElem = ParamType;\ntype ComputeCallback = (value: void) => void;\n\nexport abstract class TypedParam<T extends ParamType> extends CoreGraphNode {\n\t// protected _raw_input: ParamInitValuesTypeMap[T];\n\tprotected _default_value!: ParamInitValuesTypeMap[T];\n\tprotected _raw_input!: ParamInitValuesTypeMap[T];\n\tprotected _value!: ParamValuesTypeMap[T];\n\t// protected _expression: string;\n\tprotected _node!: BaseNodeType;\n\tprotected _parent_param: TypedMultipleParam<any> | undefined;\n\tprotected _components: FloatParam[] | undefined;\n\tprotected _compute_resolves: ComputeCallback[] | undefined;\n\n\tprivate _options: OptionsController = new OptionsController(this);\n\tget options(): OptionsController {\n\t\treturn (this._options = this._options || new OptionsController(this));\n\t}\n\tprivate _emit_controller: EmitController = new EmitController(this);\n\tget emit_controller(): EmitController {\n\t\treturn (this._emit_controller = this._emit_controller || new EmitController(this));\n\t}\n\tprotected _expression_controller: ExpressionController<T> | undefined;\n\tget expression_controller(): ExpressionController<T> | undefined {\n\t\treturn this._expression_controller; // =\n\t\t//this._expression_controller || new ExpressionController(this);\n\t}\n\tprivate _serializer: ParamSerializer | undefined;\n\tget serializer(): ParamSerializer {\n\t\treturn (this._serializer = this._serializer || new ParamSerializer(this));\n\t}\n\tprivate _states: StatesController | undefined;\n\tget states(): StatesController {\n\t\treturn (this._states = this._states || new StatesController(this));\n\t}\n\t// private _ui_data: UIData | undefined;\n\t// get ui_data(): UIData {\n\t// \treturn (this._ui_data = this._ui_data || new UIData(this.scene, this));\n\t// }\n\n\tconstructor(scene: PolyScene) {\n\t\tsuper(scene, 'BaseParam');\n\t\tthis.initialize_param();\n\t}\n\tinitialize_value() {}\n\tinitialize_param() {}\n\t// \t// this.add_post_dirty_hook(this._remove_node_param_cache.bind(this))\n\t// }\n\t// initialize() {\n\t// \tthis.init_components();\n\t// \t// this.init_expression()\n\t// \t// this._init_ui_data()\n\t// }\n\t// accepts_visitor<T extends ParamVisitor>(visitor: T): ReturnType<T['visit_param']> {\n\t// \treturn visitor.visit_param(this);\n\t// }\n\n\t//\n\t// init_expression() {}\n\n\t// type\n\tstatic type(): ParamType {\n\t\treturn ParamType.FLOAT; // adding a type here, but just to not have a compile error\n\t}\n\tget type(): T {\n\t\treturn (this.constructor as typeof BaseParamClass).type() as T;\n\t}\n\tget is_numeric(): boolean {\n\t\treturn false;\n\t}\n\n\t// name\n\tset_name(name: string) {\n\t\tsuper.set_name(name);\n\t\t// this.self.name_graph_node().set_dirty();\n\t\t// this.self.name_graph_node().remove_dirty_state();\n\t}\n\n\tget value(): ParamValuesTypeMap[T] {\n\t\treturn this._value;\n\t}\n\tabstract get default_value_serialized(): ParamInitValueSerializedTypeMap[T];\n\tabstract get raw_input_serialized(): ParamInitValueSerializedTypeMap[T];\n\tabstract get value_serialized(): ParamValueSerializedTypeMap[T];\n\tconvert(raw_val: any): ParamValuesTypeMap[T] | null {\n\t\treturn null;\n\t}\n\tstatic are_raw_input_equal(val1: any, val2: any) {\n\t\treturn false;\n\t}\n\tis_raw_input_equal(other_raw_input: ParamInitValuesTypeMap[T]) {\n\t\treturn (this.constructor as any).are_raw_input_equal(this._raw_input, other_raw_input);\n\t}\n\tstatic are_values_equal(val1: any, val2: any) {\n\t\treturn false;\n\t}\n\tis_value_equal(other_val: ParamValuesTypeMap[T]) {\n\t\treturn (this.constructor as any).are_values_equal(this.value, other_val);\n\t}\n\tprotected _clone_raw_input(raw_input: ParamInitValuesTypeMap[T]): ParamInitValuesTypeMap[T] {\n\t\treturn raw_input;\n\t}\n\tset(raw_input: ParamInitValuesTypeMap[T]): void {\n\t\tthis._raw_input = this._clone_raw_input(raw_input);\n\t\tthis.emit_controller.emit(ParamEvent.RAW_INPUT_UPDATED);\n\t\tthis.process_raw_input();\n\t}\n\tget default_value() {\n\t\treturn this._default_value;\n\t}\n\tget is_default(): boolean {\n\t\treturn true;\n\t}\n\tget raw_input() {\n\t\treturn this._raw_input;\n\t}\n\n\tprotected process_raw_input() {}\n\tprivate _is_computing: boolean = false;\n\tasync compute(): Promise<void> {\n\t\tif (this.scene.loading_controller.is_loading) {\n\t\t\tconsole.warn(`param attempt to compute ${this.full_path()}`);\n\t\t}\n\n\t\tif (this.is_dirty) {\n\t\t\tif (!this._is_computing) {\n\t\t\t\tthis._is_computing = true;\n\t\t\t\tawait this.process_computation();\n\t\t\t\tthis._is_computing = false;\n\n\t\t\t\tif (this._compute_resolves) {\n\t\t\t\t\tlet callback: ComputeCallback | undefined;\n\t\t\t\t\twhile ((callback = this._compute_resolves.pop())) {\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis._compute_resolves = this._compute_resolves || [];\n\t\t\t\t\tthis._compute_resolves.push(resolve);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\tprotected async process_computation(): Promise<void> {}\n\t// set_default_value(default_value: ParamValuesTypeMap[T]) {\n\t// \tthis._default_value = default_value;\n\t// }\n\tset_init_value(init_value: ParamInitValuesTypeMap[T]) {\n\t\tthis._default_value = init_value; //this.convert(init_value);\n\t\tthis._raw_input = this._clone_raw_input(init_value);\n\t\tif (!this.is_multiple) {\n\t\t\tthis.set(init_value);\n\t\t}\n\t}\n\t// eval_p(): Promise<ParamValuesTypeMap[T]> {\n\t// \treturn new Promise((resolve, reject) => {\n\t// \t\tresolve();\n\t// \t});\n\t// }\n\n\t// node\n\tset_node(node: BaseNodeType | null) {\n\t\tif (!node) {\n\t\t\tif (this._node) {\n\t\t\t\tthis._node.params.params_node?.remove_graph_input(this);\n\t\t\t}\n\t\t} else {\n\t\t\tthis._node = node;\n\t\t\tif (this.options.makes_node_dirty_when_dirty() && !this.parent_param) {\n\t\t\t\tnode.params.params_node?.add_graph_input(this);\n\t\t\t}\n\t\t}\n\n\t\tif (this.components) {\n\t\t\tfor (let c of this.components) {\n\t\t\t\tc.set_node(node);\n\t\t\t}\n\t\t}\n\t}\n\tget node() {\n\t\treturn this._node;\n\t}\n\tget parent() {\n\t\treturn this.node;\n\t}\n\n\t// hierarchy\n\tset_parent_param(param: TypedMultipleParam<any>) {\n\t\tparam.add_graph_input(this);\n\t\tthis._parent_param = param;\n\t}\n\tget parent_param(): TypedMultipleParam<any> | undefined {\n\t\treturn this._parent_param;\n\t}\n\thas_parent_param(): boolean {\n\t\treturn this._parent_param != null;\n\t}\n\tfull_path(): string {\n\t\treturn this.node?.full_path() + '/' + this.name;\n\t}\n\tpath_relative_to(node: BaseNodeType | BaseParamType): string {\n\t\treturn CoreWalker.relative_path(node, this);\n\t}\n\n\t// emit\n\temit(event_name: ParamEvent): void {\n\t\tif (this.emit_controller.emit_allowed) {\n\t\t\tthis.emit_controller.increment_count(event_name);\n\t\t\tthis.scene.events_controller.dispatch(this, event_name);\n\t\t}\n\t}\n\n\t// multiple\n\tget components() {\n\t\treturn this._components;\n\t}\n\tstatic get component_names(): string[] {\n\t\treturn [];\n\t}\n\tget component_names(): string[] {\n\t\tconst c = (<unknown>this.constructor) as TypedParam<T>;\n\t\treturn c.component_names;\n\t}\n\tget is_multiple(): boolean {\n\t\treturn this.component_names.length > 0;\n\t}\n\t// create_components() {}\n\tinit_components() {}\n\n\t// expression\n\t// set_expression(expression: string | null) {\n\t// \tthis.expression_controller.set_expression(expression);\n\t// }\n\thas_expression(): boolean {\n\t\treturn this.expression_controller != null && this.expression_controller.active; // use this._expression_controller to avoid creating it\n\t}\n\n\t// serialize\n\tto_json() {\n\t\treturn this.serializer.to_json();\n\t}\n}\nexport type BaseParamType = TypedParam<ParamType>;\nexport class BaseParamClass extends TypedParam<ParamType> {\n\tget default_value_serialized() {\n\t\treturn 'BaseParamClass.default_value_serialized overriden';\n\t}\n\tget raw_input_serialized() {\n\t\treturn 'BaseParamClass.raw_input_serialized overriden';\n\t}\n\tget value_serialized() {\n\t\treturn 'BaseParamClass.value_serialized overriden';\n\t}\n}\n","import {Euler} from 'three/src/math/Euler';\nimport {Matrix4} from 'three/src/math/Matrix4';\nimport {Vector3} from 'three/src/math/Vector3';\n\n// import {Object3D} from 'three/src/core/Object3D';\n// import {BaseTransformedObjNodeType} from '../_BaseTransformed';\nimport {CoreMath} from 'src/core/math/_Module';\nimport {CoreTransform, SetParamsFromMatrixOptions} from 'src/core/Transform';\n// import {BaseObjNodeType} from '../_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\n// import {NodeContext} from 'src/engine/poly/NodeContext';\nimport {TypedObjNode, BaseObjNodeType} from '../_Base';\nimport {Object3D} from 'three/src/core/Object3D';\n// import {FlagsControllerD} from '../../utils/FlagsController';\n// import {LookAtController} from './LookAtController';\nexport function TransformedParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\ttransform = ParamConfig.FOLDER();\n\t\tt = ParamConfig.VECTOR3([0, 0, 0]);\n\t\tr = ParamConfig.VECTOR3([0, 0, 0]);\n\t\ts = ParamConfig.VECTOR3([1, 1, 1]);\n\t\tscale = ParamConfig.FLOAT(1);\n\t\t// look_at = ParamConfig.OPERATOR_PATH('', {node_selection: {context: NodeContext.OBJ}});\n\t\t// up = ParamConfig.VECTOR3([0, 1, 0]);\n\t\t// pivot = ParamConfig.VECTOR3([0, 0, 0]);\n\t};\n}\nclass TransformedParamsConfig extends TransformedParamConfig(NodeParamsConfig) {}\nexport class TransformedObjNode extends TypedObjNode<Object3D, TransformedParamsConfig> {\n\t// public readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\treadonly transform_controller: TransformController = new TransformController(this);\n\t// get transform_controller(): TransformController {\n\t// \treturn this._transform_controller; // = this._transform_controller || new TransformController(this));\n\t// }\n}\n\nexport class TransformController {\n\tconstructor(private node: TransformedObjNode) {}\n\n\t// protected _look_at_controller = new LookAtController(this.node);\n\t// get look_at_controller(): LookAtController {\n\t// \treturn (this._look_at_controller = this._look_at_controller || new LookAtController(this));\n\t// }\n\n\tinitialize_node() {\n\t\t// not sure we should change if it is used in the scene, as parented children may still be\n\t\t// this.node.flags.display.add_hook(() => {\n\t\t// \t// this.node.set_used_in_scene(this.node.flags.display.active || false);\n\t\t// \tthis.node.object.visible = this.node.flags.display.active;\n\t\t// });\n\t\t// this.node.set_used_in_scene(true);\n\n\t\tthis.node.io.inputs.set_count(0, 1);\n\t\tthis.node.io.inputs.set_depends_on_inputs(false);\n\t\tthis.node.io.outputs.set_has_one_output();\n\t\tthis.node.io.inputs.add_hook(() => {\n\t\t\tthis.on_input_updated();\n\t\t});\n\n\t\tconst hook_name = '_cook_main_without_inputs_when_dirty';\n\t\tif (!this.node.dirty_controller.has_hook(hook_name)) {\n\t\t\tthis.node.dirty_controller.add_post_dirty_hook(hook_name, this._cook_main_without_inputs_when_dirty_bound);\n\t\t}\n\t}\n\t// TODO: this will have to be checked via the parent, when I will have obj managers at lower levels than root\n\tprivate _cook_main_without_inputs_when_dirty_bound = this._cook_main_without_inputs_when_dirty.bind(this);\n\tprivate async _cook_main_without_inputs_when_dirty() {\n\t\t// if (this.node.used_in_scene) {\n\t\tawait this.node.cook_controller.cook_main_without_inputs();\n\t\t// }\n\t}\n\n\tstatic on_input_updated(node: BaseObjNodeType) {\n\t\tif (node.io.inputs.input(0) != null) {\n\t\t\tnode.root.add_to_parent_transform(node);\n\t\t} else {\n\t\t\tnode.root.remove_from_parent_transform(node);\n\t\t}\n\t}\n\ton_input_updated() {\n\t\tTransformController.on_input_updated(this.node);\n\t}\n\n\tupdate(matrix?: Matrix4) {\n\t\t// const object = this.node.object;\n\t\t// const update_full_matrix = false; // if true the camera controls do not work anymore\n\t\t//matrix = Core.Transform.matrix_from_node_with_transform_params(this)\n\n\t\t// if (object) {\n\t\t// if update_full_matrix\n\t\t// \tobject.matrixAutoUpdate = false\n\t\t// \tobject.matrix = matrix\n\t\t// else\n\n\t\t// if (this._look_at_controller.active == true) {\n\t\t// \treturn this._look_at_controller.compute(); //this._use_look_at_param();\n\t\t// } else {\n\t\tthis.update_transform_with_matrix(matrix);\n\t\t// }\n\t\t// if matrix?\n\t\t// \t# do not apply to cameras with control\n\t\t// \tobject.matrixAutoUpdate = false\n\t\t// \tobject.matrix = matrix\n\t\t// else\n\t\t// \tthis.update_transform_from_params()\n\t\t// } else {\n\t\t// \tconsole.warn(`no object to update for ${this.node.full_path()}`);\n\t\t// \t// return false;\n\t\t// }\n\t}\n\n\tupdate_transform_with_matrix(matrix?: Matrix4) {\n\t\t//console.warn \"no object to update for #{this.full_path()}\"\n\t\tconst object = this.node.object;\n\t\t//matrix ?= Core.Transform.matrix_from_node_with_transform_params(this)\n\t\tif (matrix != null && !matrix.equals(object.matrix)) {\n\t\t\t// do not apply to cameras with control\n\n\t\t\tobject.matrixAutoUpdate = false;\n\t\t\tobject.matrix = matrix;\n\n\t\t\treturn object.dispatchEvent({type: 'change'});\n\t\t} else {\n\t\t\treturn this.update_transform_from_params();\n\t\t}\n\t}\n\n\tprivate _update_transform_from_params_scale = new Vector3();\n\tupdate_transform_from_params() {\n\t\tconst object = this.node.object;\n\t\tif (object) {\n\t\t\tconst position: Vector3 = this.node.pv.t;\n\t\t\t//quaternion = new Quaternion()\n\t\t\tconst rotation: Vector3 = this.node.pv.r;\n\n\t\t\tthis._update_transform_from_params_scale.copy(this.node.pv.s).multiplyScalar(this.node.pv.scale);\n\t\t\t// const scale: Vector3 = this.node.pv.s\n\t\t\t// \t.clone()\n\t\t\t// \t.multiplyScalar(this.node.pv.scale);\n\t\t\t//matrix.decompose( position, quaternion, scale )\n\n\t\t\tobject.matrixAutoUpdate = false;\n\t\t\tobject.position.copy(position);\n\t\t\t//object.quaternion.copy(quaternion)\n\t\t\tconst radians = [\n\t\t\t\tCoreMath.degrees_to_radians(rotation.x),\n\t\t\t\tCoreMath.degrees_to_radians(rotation.y),\n\t\t\t\tCoreMath.degrees_to_radians(rotation.z),\n\t\t\t];\n\t\t\tconst euler = new Euler(\n\t\t\t\tradians[0],\n\t\t\t\tradians[1],\n\t\t\t\tradians[2]\n\t\t\t\t//'XYZ'\n\t\t\t);\n\t\t\tobject.rotation.copy(euler);\n\t\t\tobject.scale.copy(this._update_transform_from_params_scale);\n\t\t\tobject.matrixAutoUpdate = true;\n\t\t\tobject.updateMatrix();\n\n\t\t\tobject.dispatchEvent({type: 'change'});\n\t\t}\n\t}\n\n\tset_params_from_matrix(matrix: Matrix4, options: SetParamsFromMatrixOptions = {}) {\n\t\tCoreTransform.set_params_from_matrix(matrix, this.node, options);\n\t}\n}\n","export enum ParamEvent {\n\tVISIBLE_UPDATED = 'param_visible_updated',\n\t// UPDATED = 'param_updated',\n\tRAW_INPUT_UPDATED = 'raw_input_updated',\n\tVALUE_UPDATED = 'param_value_updated',\n\tEXPRESSION_UPDATED = 'param_expression_update',\n\tERROR_UPDATED = 'param_error_updated',\n\tDELETED = 'param_deleted',\n}\n","import {ParamInitValuesTypeMap} from '../../../params/types/ParamInitValuesTypeMap';\n\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {RampParam} from 'src/engine/params/Ramp';\n\n// TODO: simplify GLDataType into one enum\n// http://learnwebgl.brown37.net/12_shader_language/glsl_data_types.html\n\n//\n//\n// GL Data types\n//\n//\nexport enum ConnectionPointType {\n\tBOOL = 'bool',\n\t// BVEC2 = 'bvec2',\n\t// BVEC3 = 'bvec3',\n\t// BVEC4 = 'bvec4',\n\tINT = 'int',\n\t// IVEC2 = 'ivec2',\n\t// IVEC3 = 'ivec3',\n\t// IVEC4 = 'ivec4',\n\tFLOAT = 'float',\n\tVEC2 = 'vec2',\n\tVEC3 = 'vec3',\n\tVEC4 = 'vec4',\n\t// matrices to be used later\n\t// MAT2 = 'mat2',\n\t// MAT3 = 'mat3',\n\t// MAT4 = 'mat4',\n\tSAMPLER_2D = 'sampler2D',\n}\n\n//\n//\n// ALL GL Data types in an array\n//\n//\nexport const ConnectionPointTypes: Array<ConnectionPointType> = [\n\tConnectionPointType.BOOL,\n\t// ConnectionPointType.BVEC2,\n\t// ConnectionPointType.BVEC3,\n\t// ConnectionPointType.BVEC4,\n\tConnectionPointType.INT,\n\t// ConnectionPointType.IVEC2,\n\t// ConnectionPointType.IVEC3,\n\t// ConnectionPointType.IVEC4,\n\tConnectionPointType.FLOAT,\n\tConnectionPointType.VEC2,\n\tConnectionPointType.VEC3,\n\tConnectionPointType.VEC4,\n];\n\n//\n//\n// Map to convert from a GL Data type to a ParamType\n//\n//\ntype ConnectionPointTypeToParamTypeMapGeneric = {[key in ConnectionPointType]: ParamType};\nexport interface IConnectionPointTypeToParamTypeMap extends ConnectionPointTypeToParamTypeMapGeneric {\n\t[ConnectionPointType.BOOL]: ParamType.BOOLEAN;\n\t// [ConnectionPointType.BVEC2]: [ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC3]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC4]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t[ConnectionPointType.INT]: ParamType.INTEGER;\n\t// [ConnectionPointType.IVEC2]: [ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC3]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC4]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t[ConnectionPointType.FLOAT]: ParamType.FLOAT;\n\t[ConnectionPointType.VEC2]: ParamType.VECTOR2;\n\t[ConnectionPointType.VEC3]: ParamType.VECTOR3;\n\t[ConnectionPointType.VEC4]: ParamType.VECTOR4;\n}\nexport const ConnectionPointTypeToParamTypeMap: IConnectionPointTypeToParamTypeMap = {\n\t[ConnectionPointType.BOOL]: ParamType.BOOLEAN,\n\t// [ConnectionPointType.BVEC2]: [ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC3]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC4]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t[ConnectionPointType.INT]: ParamType.INTEGER,\n\t// [ConnectionPointType.IVEC2]: [ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC3]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC4]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t[ConnectionPointType.FLOAT]: ParamType.FLOAT,\n\t[ConnectionPointType.VEC2]: ParamType.VECTOR2,\n\t[ConnectionPointType.VEC3]: ParamType.VECTOR3,\n\t[ConnectionPointType.VEC4]: ParamType.VECTOR4,\n\n\t[ConnectionPointType.SAMPLER_2D]: ParamType.RAMP,\n};\n\n//\n//\n// Map to convert from a ParamType to GL Data type\n//\n//\ntype ParamTypeToConnectionPointTypeMapGeneric = {[key in ParamType]: ConnectionPointType | undefined};\nexport interface IParamTypeToConnectionPointTypeMap extends ParamTypeToConnectionPointTypeMapGeneric {\n\t[ParamType.BOOLEAN]: ConnectionPointType.BOOL;\n\t[ParamType.COLOR]: ConnectionPointType.VEC3;\n\t// [ConnectionPointType.BVEC2]: [ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC3]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC4]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t[ParamType.INTEGER]: ConnectionPointType.INT;\n\t// [ConnectionPointType.IVEC2]: [ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC3]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC4]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t[ParamType.FLOAT]: ConnectionPointType.FLOAT;\n\t[ParamType.FOLDER]: undefined;\n\t[ParamType.VECTOR2]: ConnectionPointType.VEC2;\n\t[ParamType.VECTOR3]: ConnectionPointType.VEC3;\n\t[ParamType.VECTOR4]: ConnectionPointType.VEC4;\n\t[ParamType.BUTTON]: undefined;\n\t[ParamType.OPERATOR_PATH]: undefined;\n\t[ParamType.RAMP]: undefined;\n\t[ParamType.SEPARATOR]: undefined;\n\t[ParamType.STRING]: undefined;\n}\nexport const ParamTypeToConnectionPointTypeMap: IParamTypeToConnectionPointTypeMap = {\n\t[ParamType.BOOLEAN]: ConnectionPointType.BOOL,\n\t[ParamType.COLOR]: ConnectionPointType.VEC3,\n\t// [ConnectionPointType.BVEC2]: [ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC3]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC4]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t[ParamType.INTEGER]: ConnectionPointType.INT,\n\t// [ConnectionPointType.IVEC2]: [ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC3]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC4]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t[ParamType.FLOAT]: ConnectionPointType.FLOAT,\n\t[ParamType.FOLDER]: undefined,\n\t[ParamType.VECTOR2]: ConnectionPointType.VEC2,\n\t[ParamType.VECTOR3]: ConnectionPointType.VEC3,\n\t[ParamType.VECTOR4]: ConnectionPointType.VEC4,\n\t[ParamType.BUTTON]: undefined,\n\t[ParamType.OPERATOR_PATH]: undefined,\n\t[ParamType.RAMP]: undefined,\n\t[ParamType.SEPARATOR]: undefined,\n\t[ParamType.STRING]: undefined,\n};\n\n//\n//\n// Map of GL Data type default values\n//\n//\nexport type ConnectionPointInitValueMapGeneric = {\n\t[key in ConnectionPointType]: ParamInitValuesTypeMap[IConnectionPointTypeToParamTypeMap[key]];\n};\nexport const ConnectionPointInitValueMap: ConnectionPointInitValueMapGeneric = {\n\t[ConnectionPointType.BOOL]: false,\n\t// [ConnectionPointType.BVEC2]: [ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC3]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC4]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t[ConnectionPointType.INT]: 0,\n\t// [ConnectionPointType.IVEC2]: [ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC3]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC4]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t[ConnectionPointType.FLOAT]: 0,\n\t[ConnectionPointType.VEC2]: [0, 0],\n\t[ConnectionPointType.VEC3]: [0, 0, 0],\n\t[ConnectionPointType.VEC4]: [0, 0, 0, 0],\n\n\t[ConnectionPointType.SAMPLER_2D]: RampParam.DEFAULT_VALUE_JSON,\n};\n\n//\n//\n// Map of GL Data type component counts\n//\n//\nexport type ConnectionPointComponentsCountMapGeneric = {\n\t[key in ConnectionPointType]: number;\n};\nexport const ConnectionPointComponentsCountMap: ConnectionPointComponentsCountMapGeneric = {\n\t[ConnectionPointType.BOOL]: 1,\n\t// [ConnectionPointType.BVEC2]: [ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC3]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t// [ConnectionPointType.BVEC4]: [ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN, ParamType.BOOLEAN]\n\t[ConnectionPointType.INT]: 1,\n\t// [ConnectionPointType.IVEC2]: [ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC3]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t// [ConnectionPointType.IVEC4]: [ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER, ParamType.INTEGER];\n\t[ConnectionPointType.FLOAT]: 1,\n\t[ConnectionPointType.VEC2]: 2,\n\t[ConnectionPointType.VEC3]: 3,\n\t[ConnectionPointType.VEC4]: 4,\n\t[ConnectionPointType.SAMPLER_2D]: 1,\n};\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {DecomposedPath} from './DecomposedPath';\n// import {NodeSimple} from 'src/core/graph/NodeSimple'\n\nimport {CoreWalkerEmbed} from './WalkerEmbed';\n\ntype NodeOrParam = BaseNodeType | BaseParamType;\n\nexport class CoreWalker extends CoreWalkerEmbed {\n\tpublic static readonly SEPARATOR = '/';\n\tpublic static readonly CURRENT = '.';\n\tpublic static readonly PARENT = '..';\n\tpublic static readonly CURRENT_WITH_SLASH = `${CoreWalker.CURRENT}/`;\n\tpublic static readonly PARENT_WITH_SLASH = `${CoreWalker.PARENT}/`;\n\n\tstatic find_param(node_src: BaseNodeType, path: string, decomposed_path?: DecomposedPath): BaseParamType | null {\n\t\tif (!node_src) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst elements = path.split(CoreWalker.SEPARATOR);\n\n\t\tif (elements.length === 1) {\n\t\t\treturn node_src.params.get(elements[0]);\n\t\t} else {\n\t\t\tconst node_path = elements.slice(0, +(elements.length - 2) + 1 || undefined).join(CoreWalker.SEPARATOR);\n\t\t\tconst node = this.find_node(node_src, node_path, decomposed_path);\n\t\t\tif (node != null) {\n\t\t\t\tconst param_name = elements[elements.length - 1];\n\t\t\t\tconst param = node.params.get(param_name);\n\t\t\t\tif (decomposed_path && param) {\n\t\t\t\t\tdecomposed_path.add_node(param_name, param);\n\t\t\t\t}\n\t\t\t\treturn param;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t\t// throw `no node found for path ${node_path}`;\n\t\t\t}\n\t\t}\n\t}\n\tstatic relative_path(src_graph_node: Readonly<NodeOrParam>, dest_graph_node: Readonly<NodeOrParam>): string {\n\t\tconst parent = this.closest_common_parent(src_graph_node, dest_graph_node);\n\t\tif (!parent) {\n\t\t\treturn dest_graph_node.full_path();\n\t\t} else {\n\t\t\tconst distance = this.distance_to_parent(src_graph_node, parent);\n\t\t\t// const up = lodash_padStart(\"\", (distance-1)*3, \"../\")\n\t\t\tlet up = '';\n\t\t\tif (distance - 1 > 0) {\n\t\t\t\tlet i = 0;\n\t\t\t\tconst ups = [];\n\t\t\t\twhile (i++ < distance - 1) {\n\t\t\t\t\tups.push(CoreWalker.PARENT);\n\t\t\t\t}\n\t\t\t\tup = ups.join(CoreWalker.SEPARATOR) + CoreWalker.SEPARATOR;\n\t\t\t}\n\n\t\t\tconst parent_path_elements = parent\n\t\t\t\t.full_path()\n\t\t\t\t.split(CoreWalker.SEPARATOR)\n\t\t\t\t.filter((e) => e.length > 0);\n\t\t\tconst dest_path_elements = dest_graph_node\n\t\t\t\t.full_path()\n\t\t\t\t.split(CoreWalker.SEPARATOR)\n\t\t\t\t.filter((e) => e.length > 0);\n\t\t\tconst remaining_elements = [];\n\t\t\tlet cmptr = 0;\n\t\t\tfor (let dest_path_element of dest_path_elements) {\n\t\t\t\tif (!parent_path_elements[cmptr]) {\n\t\t\t\t\tremaining_elements.push(dest_path_element);\n\t\t\t\t}\n\t\t\t\tcmptr++;\n\t\t\t}\n\t\t\tconst down = remaining_elements.join(CoreWalker.SEPARATOR);\n\t\t\treturn `${up}${down}`;\n\t\t}\n\t}\n\n\tstatic closest_common_parent(\n\t\tgraph_node1: Readonly<NodeOrParam>,\n\t\tgraph_node2: Readonly<NodeOrParam>\n\t): BaseNodeType | null {\n\t\tconst parents1 = this.parents(graph_node1).reverse();\n\t\tconst parents2 = this.parents(graph_node2).reverse();\n\n\t\tconst min_depth = Math.min(parents1.length, parents2.length);\n\t\tlet found_parent = null;\n\n\t\tfor (let i = 0; i < min_depth; i++) {\n\t\t\tif (parents1[i].graph_node_id == parents2[i].graph_node_id) {\n\t\t\t\tfound_parent = parents1[i];\n\t\t\t}\n\t\t}\n\t\treturn found_parent;\n\t}\n\tstatic parents(graph_node: Readonly<NodeOrParam>): BaseNodeType[] {\n\t\tconst parents = [];\n\t\tlet parent = graph_node.parent;\n\t\twhile (parent) {\n\t\t\tparents.push(parent);\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn parents;\n\t}\n\tstatic distance_to_parent(graph_node: Readonly<NodeOrParam>, dest: Readonly<BaseNodeType>): number {\n\t\tlet distance = 0;\n\t\tlet current: Readonly<NodeOrParam | null> = graph_node;\n\t\tconst dest_id = dest.graph_node_id;\n\t\twhile (current && current.graph_node_id != dest_id) {\n\t\t\tdistance += 1;\n\t\t\tcurrent = current.parent;\n\t\t}\n\t\tif (current && current.graph_node_id == dest_id) {\n\t\t\treturn distance;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\t// static make_absolute(node_src: BaseNode, path: string): string {\n\t// \treturn \"\"\n\t// }\n}\n","import {BaseNodeType} from '../_Base';\n\nimport {BypassFlag} from './flags/Bypass';\nimport {DisplayFlag} from './flags/Display';\n\nexport class FlagsController {\n\tpublic readonly bypass: DisplayFlag | undefined;\n\tpublic readonly display: BypassFlag | undefined;\n\tconstructor(protected node: BaseNodeType) {}\n\thas_display(): boolean {\n\t\treturn false;\n\t}\n\thas_bypass(): boolean {\n\t\treturn false;\n\t}\n}\n\nfunction Display<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tprotected node!: BaseNodeType;\n\t\tpublic display: DisplayFlag = new DisplayFlag(this.node);\n\t\thas_display(): boolean {\n\t\t\treturn true;\n\t\t}\n\t};\n}\nfunction Bypass<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tprotected node!: BaseNodeType;\n\t\tpublic readonly bypass: BypassFlag = new BypassFlag(this.node);\n\t\thas_bypass(): boolean {\n\t\t\treturn true;\n\t\t}\n\t};\n}\n\nexport class FlagsControllerD extends Display(FlagsController) {}\nexport class FlagsControllerB extends Bypass(FlagsController) {}\nexport class FlagsControllerDB extends Bypass(Display(FlagsController)) {}\n","export enum ShaderName {\n\tVERTEX = 'vertex',\n\tFRAGMENT = 'fragment',\n\tLEAVES_FROM_NODES_SHADER = 'leaves_from_nodes_shader',\n\tPARTICLES_0 = 'particles_0',\n\tPARTICLES_1 = 'particles_1',\n\tPARTICLES_2 = 'particles_2',\n\tPARTICLES_3 = 'particles_3',\n\tPARTICLES_4 = 'particles_4',\n\tPARTICLES_5 = 'particles_5',\n\tPARTICLES_6 = 'particles_6',\n\tPARTICLES_7 = 'particles_7',\n\tPARTICLES_8 = 'particles_8',\n\tPARTICLES_9 = 'particles_9',\n}\nexport const ParticleShaderNames: Array<ShaderName> = [\n\tShaderName.PARTICLES_0,\n\tShaderName.PARTICLES_1,\n\tShaderName.PARTICLES_2,\n\tShaderName.PARTICLES_3,\n\tShaderName.PARTICLES_4,\n\tShaderName.PARTICLES_5,\n\tShaderName.PARTICLES_6,\n\tShaderName.PARTICLES_7,\n\tShaderName.PARTICLES_8,\n\tShaderName.PARTICLES_9,\n];\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Quaternion} from 'three/src/math/Quaternion';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {Matrix4} from 'three/src/math/Matrix4';\nimport {Euler} from 'three/src/math/Euler';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nconst ROTATION_ORDER = 'XYZ';\n\nexport interface SetParamsFromMatrixOptions {\n\tscale?: boolean;\n}\n\n// TODO: remove the \"new\" in this whole file\n// const euler = new Euler(0, 0, 0, ROTATION_ORDER)\n\nexport class CoreTransform {\n\t// static create_params(node: BaseNodeType) {\n\t// \tnode.add_param(ParamType.VECTOR3, 't', [0, 0, 0]);\n\t// \tnode.add_param(ParamType.VECTOR3, 'r', [0, 0, 0]);\n\t// \tnode.add_param(ParamType.VECTOR3, 's', [1, 1, 1]);\n\t// \tnode.add_param(ParamType.FLOAT, 'scale', 1, {range: [0, 10]});\n\t// \tnode.add_param(ParamType.OPERATOR_PATH, 'look_at', '');\n\t// \tnode.add_param(ParamType.VECTOR3, 'up', [0, 1, 0]);\n\t// }\n\n\t// static matrix_from_node_with_transform_params(node: BaseNodeType): Matrix4 {\n\t// \tconst t = node.params.vector3('t');\n\t// \tconst r = node.params\n\t// \t\t.vector3('r')\n\t// \t\t.clone()\n\t// \t\t.multiplyScalar(Math.PI / 180);\n\t// \tconst s = node.params.vector3('s');\n\t// \tconst scale = node.params.float('scale');\n\t// \treturn this.matrix(t, r, s, scale);\n\t// }\n\n\t// if this is done, make sure to use eval with a  callback\n\t// @matrix_from_params: (node) ->\n\t// \tt = node.param('t').eval()\n\t// \tr = node.param('r').eval().multiplyScalar( Math.PI / 180 )\n\t// \ts = node.param('s').eval()\n\t// \tscale = node.param('scale').eval()\n\t// \tthis.matrix(t, r, s, scale)\n\n\tstatic set_params_from_matrix(matrix: Matrix4, node: BaseNodeType, options: SetParamsFromMatrixOptions = {}) {\n\t\tlet update_scale = options['scale'];\n\t\tif (update_scale == null) {\n\t\t\tupdate_scale = true;\n\t\t}\n\n\t\t// EPSILON = 0.0000001\n\t\t// PRECISION = 1000\n\t\t// components = ['x', 'y', 'z']\n\n\t\tconst position = new Vector3();\n\t\tconst quaternion = new Quaternion();\n\t\tconst scale = new Vector3();\n\t\tmatrix.decompose(position, quaternion, scale);\n\n\t\tconst euler = new Euler().setFromQuaternion(quaternion);\n\t\tconst rotation = euler.toVector3();\n\t\trotation.divideScalar(Math.PI / 180);\n\n\t\t// limit precision of position and rotation\n\t\t// lodash_each [position, rotation], (vector)->\n\t\t// \tlodash_each ['x', 'y', 'z'], (c)->\n\t\t// \t\tval = vector[c]\n\t\t// \t\tapproximation = parseInt(val * PRECISION) / PRECISION\n\t\t// \t\tvector[c] = approximation\n\n\t\t// round scale if we get values like 0.9999999999 or 1.00000000001\n\t\t// lodash_each ['x', 'y', 'z'], (c)->\n\t\t// \tval = scale[c]\n\t\t// \trounded = Math.round(val)\n\t\t// \tif Math.abs(val - rounded) < EPSILON\n\t\t// \t\tscale[c] = rounded\n\n\t\tnode.scene.batch_update(() => {\n\t\t\tnode.params.set_vector3('r', rotation.toArray() as Number3);\n\t\t\tnode.params.set_vector3('t', position.toArray() as Number3);\n\t\t\tnode.params.set_vector3('s', scale.toArray() as Number3);\n\t\t\tif (update_scale) {\n\t\t\t\tnode.params.set_float('scale', 1);\n\t\t\t}\n\t\t});\n\t}\n\t// this.object().position.copy(position)\n\t// this.object().quaternion.copy(quaternion)\n\t// this.object().scale.copy(scale)\n\n\tstatic set_params_from_object(object: Object3D, node: BaseNodeType) {\n\t\tconst position = object.position.toArray() as Number3;\n\t\tconst rotation = object.rotation.toArray().map((c) => c * (180 / Math.PI)) as Number3;\n\n\t\tnode.scene.batch_update(() => {\n\t\t\tnode.params.set_vector3('t', position);\n\t\t\tnode.params.set_vector3('r', rotation);\n\t\t});\n\t}\n\n\t// static translation_matrix(x: number, y: number, z: number): Matrix4 {\n\t// \tconst t = new Vector3(x, y, z);\n\t// \tconst quaternion = new Quaternion();\n\t// \tconst s = new Vector3(1, 1, 1);\n\n\t// \tconst matrix = new Matrix4();\n\t// \tmatrix.compose(t, quaternion, s);\n\t// \treturn matrix;\n\t// }\n\n\tprivate _translation_matrix: Matrix4 = new Matrix4();\n\tprivate _translation_matrix_q = new Quaternion();\n\tprivate _translation_matrix_s = new Vector3(1, 1, 1);\n\ttranslation_matrix(t: Vector3): Matrix4 {\n\t\tthis._translation_matrix.compose(t, this._translation_matrix_q, this._translation_matrix_s);\n\t\treturn this._translation_matrix;\n\t}\n\n\tstatic matrix_quaternion(matrix: Matrix4): Quaternion {\n\t\tconst t = new Vector3();\n\t\tconst quat = new Quaternion();\n\t\tconst s = new Vector3();\n\t\tmatrix.decompose(t, quat, s);\n\t\treturn quat;\n\t}\n\n\t// static matrix(t: Vector3, r: Vector3, s: Vector3, scale: number) {\n\t// \t// if I don't clone here, it created issues in the transform SOP\n\t// \ts = s.clone().multiplyScalar(scale);\n\n\t// \tconst quaternion = new Quaternion();\n\t// \tconst euler = new Euler(r.x, r.y, r.z, ROTATION_ORDER);\n\t// \tquaternion.setFromEuler(euler);\n\n\t// \tconst matrix = new Matrix4();\n\t// \tmatrix.compose(t, quaternion, s);\n\t// \treturn matrix;\n\t// }\n\tprivate _matrix = new Matrix4().identity();\n\tprivate _matrix_q = new Quaternion();\n\tprivate _matrix_e = new Euler();\n\tprivate _matrix_s = new Vector3();\n\tmatrix(t: Vector3, r: Vector3, s: Vector3, scale: number) {\n\t\tthis._matrix_e.set(r.x, r.y, r.z, ROTATION_ORDER);\n\t\tthis._matrix_q.setFromEuler(this._matrix_e);\n\n\t\tthis._matrix_s.copy(s).multiplyScalar(scale);\n\n\t\tthis._matrix.compose(t, this._matrix_q, this._matrix_s);\n\t\treturn this._matrix;\n\t}\n\n\t// static rotate_geometry(geometry: BufferGeometry, vec_origin: Vector3, vec_dest: Vector3) {\n\t// \tconst quaternion = new Quaternion();\n\t// \tquaternion.setFromUnitVectors(vec_origin, vec_dest.clone().normalize());\n\t// \tconst matrix = new Matrix4();\n\t// \tmatrix.makeRotationFromQuaternion(quaternion);\n\t// \tgeometry.applyMatrix(matrix);\n\t// }\n\n\tprivate _rotate_geometry_m = new Matrix4();\n\tprivate _rotate_geometry_q = new Quaternion();\n\tprivate _rotate_geometry_vec_dest = new Vector3();\n\trotate_geometry(geometry: BufferGeometry, vec_origin: Vector3, vec_dest: Vector3) {\n\t\tthis._rotate_geometry_vec_dest.copy(vec_dest);\n\t\tthis._rotate_geometry_vec_dest.normalize();\n\t\tthis._rotate_geometry_q.setFromUnitVectors(vec_origin, this._rotate_geometry_vec_dest);\n\t\t// this._rotate_geometry_m.identity(); // not entirely sure this is necessary\n\t\tthis._rotate_geometry_m.makeRotationFromQuaternion(this._rotate_geometry_q);\n\t\tgeometry.applyMatrix(this._rotate_geometry_m);\n\t}\n}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Triangle} from 'three/src/math/Triangle';\nconst THREE = {Triangle, Vector3};\nimport lodash_isNumber from 'lodash/isNumber';\n// import {Octree} from './Octree'\n// import Interpolate from './Interpolate'\nimport {Easing} from './Easing';\n\nconst RAD_DEG_RATIO = Math.PI / 180;\n\nexport class CoreMath {\n\t// static Octree = Octree\n\t// static Interpolate = Interpolate\n\tstatic Easing = Easing; // used in expressins\n\n\tstatic clamp(val: number, min: number, max: number): number {\n\t\tif (val < min) {\n\t\t\treturn min;\n\t\t} else if (val > max) {\n\t\t\treturn max;\n\t\t} else {\n\t\t\treturn val;\n\t\t}\n\t}\n\n\tstatic fit01(val: number, dest_min: number, dest_max: number): number {\n\t\t// const size = max - min;\n\t\t// return (val - min) / size;\n\t\treturn this.fit(val, 0, 1, dest_min, dest_max);\n\t}\n\n\tstatic fit(val: number, src_min: number, src_max: number, dest_min: number, dest_max: number): number {\n\t\tconst src_range = src_max - src_min;\n\t\tconst dest_range = dest_max - dest_min;\n\n\t\tconst r = (val - src_min) / src_range;\n\t\treturn r * dest_range + dest_min;\n\t}\n\n\tstatic degrees_to_radians(degrees: number): number {\n\t\treturn degrees * RAD_DEG_RATIO;\n\t}\n\tstatic radians_to_degrees(radians: number): number {\n\t\treturn radians / RAD_DEG_RATIO;\n\t}\n\tstatic deg2rad(deg: number): number {\n\t\treturn this.degrees_to_radians(deg);\n\t}\n\tstatic rad2deg(rad: number): number {\n\t\treturn this.radians_to_degrees(rad);\n\t}\n\n\tstatic fract = (number: number) => number - Math.floor(number);\n\n\t// from threejs glsl rand\n\tstatic rand(number: number): number {\n\t\tif (lodash_isNumber(number)) {\n\t\t\treturn this.rand_float(number);\n\t\t} else {\n\t\t\treturn this.rand_vec2(number);\n\t\t}\n\t}\n\n\tstatic round(number: number, step_size: number): number {\n\t\tconst steps_count = number / step_size;\n\t\tconst rounded_steps_count = number < 0 ? Math.ceil(steps_count) : Math.floor(steps_count);\n\t\tconsole.log('round', step_size, number, steps_count, rounded_steps_count, rounded_steps_count * step_size);\n\t\treturn rounded_steps_count * step_size;\n\t}\n\n\tstatic highest_even(number: number): number {\n\t\treturn 2 * Math.ceil(number * 0.5);\n\t}\n\n\tstatic rand_float(number: number): number {\n\t\tconst vec = {\n\t\t\tx: number,\n\t\t\ty: 136574,\n\t\t};\n\t\treturn this.rand_vec2(vec);\n\t}\n\n\tstatic rand_vec2(uv: Vector2Like) {\n\t\tconst a = 12.9898;\n\t\tconst b = 78.233;\n\t\tconst c = 43758.5453;\n\t\tconst dt = uv.x * a + uv.y * b; //dot( uv.xy, vec2( a,b ) )\n\t\tconst sn = dt % Math.PI;\n\t\treturn this.fract(Math.sin(sn) * c);\n\t}\n\n\t// https://www.movable-type.co.uk/scripts/latlong.html\n\tstatic geodesic_distance(lnglat1: LngLatLike, lnglat2: LngLatLike): number {\n\t\tvar R = 6371e3; // metres\n\t\tvar 1 = this.deg2rad(lnglat1.lat);\n\t\tvar 2 = this.deg2rad(lnglat2.lat);\n\t\tvar  = this.deg2rad(lnglat2.lat - lnglat1.lat);\n\t\tvar  = this.deg2rad(lnglat2.lng - lnglat1.lng);\n\n\t\tvar a = Math.sin( / 2) * Math.sin( / 2) + Math.cos(1) * Math.cos(2) * Math.sin( / 2) * Math.sin( / 2);\n\t\tvar c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\n\t\tvar d = R * c;\n\t\treturn d;\n\t}\n\n\tstatic expand_triangle(triangle: Triangle, margin: number): Triangle {\n\t\tconst mid_point = new THREE.Vector3();\n\t\ttriangle.getMidpoint(mid_point);\n\n\t\tenum TriangleProp {\n\t\t\ta = 'a',\n\t\t\tb = 'b',\n\t\t\tc = 'c',\n\t\t}\n\t\tfor (let prop of ['a', 'b', 'c']) {\n\t\t\tconst delta = triangle[prop as TriangleProp].clone().sub(mid_point);\n\t\t\tconst delta_n = delta.clone().normalize();\n\t\t\tconst length = delta.length() + margin;\n\n\t\t\ttriangle[prop as TriangleProp] = mid_point.clone().add(delta_n.multiplyScalar(length));\n\t\t}\n\t\treturn triangle;\n\t}\n\n\tstatic nearestPower2(num: number) {\n\t\treturn Math.pow(2, Math.ceil(Math.log(num) / Math.log(2)));\n\t}\n}\n","import {BaseContainer, TypedContainer} from '../../containers/_Base';\nimport {BaseNodeType} from '../_Base';\n\ntype Callback<T extends TypedContainer<any>> = (container: T | undefined) => void;\n\nexport class TypedContainerController<T extends TypedContainer<any>> {\n\tprivate _callbacks: Callback<T>[] = [];\n\tprotected _container: T;\n\n\tconstructor(protected node: BaseNodeType, container_class: typeof BaseContainer) {\n\t\tthis._container = new container_class(this.node) as T;\n\t}\n\n\tget container() {\n\t\treturn this._container;\n\t}\n\n\trequest_container(): Promise<T> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis._callbacks.push(resolve);\n\t\t\tthis.node.scene.cook_controller.add_node(this.node);\n\n\t\t\t// const cooker = this.node.scene.cooker;\n\t\t\t// if (cooker.blocked()) {\n\t\t\t// \tcooker.enqueue(this.node);\n\t\t\t// } else {\n\t\t\tsetTimeout(this.process_container_request.bind(this), 0);\n\t\t\t// }\n\t\t});\n\t}\n\n\tprocess_container_request() {\n\t\tif (this.node.flags?.bypass?.active) {\n\t\t\tconst input_index = 0;\n\t\t\tthis.request_input_container(input_index).then((container) => {\n\t\t\t\tthis.node.remove_dirty_state();\n\t\t\t\tif (container) {\n\t\t\t\t\tthis.notify_requesters(container);\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.states.error.set('input invalid');\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tif (this.node.is_dirty) {\n\t\t\t\tthis.node.container_controller.container.reset_caches();\n\t\t\t\tthis.node.cook_controller.cook_main();\n\t\t\t} else {\n\t\t\t\tthis.notify_requesters();\n\t\t\t}\n\t\t}\n\t}\n\n\tasync request_input_container(input_index: number) {\n\t\tconst input_node = this.node.io.inputs.input(input_index);\n\t\tif (input_node) {\n\t\t\tinput_node.processing_context.copy(this.node.processing_context);\n\t\t\tconst container = await input_node.container_controller.request_container();\n\t\t\treturn container;\n\t\t} else {\n\t\t\tthis.node.states.error.set(`input ${input_index} required`);\n\t\t\tthis.notify_requesters();\n\t\t\treturn null;\n\t\t}\n\t}\n\tnotify_requesters(container?: T) {\n\t\t// make a copy of the callbacks first,\n\t\t// to ensure that new ones are not added to this list\n\t\t// in side effects from those callbacks\n\t\t// (the test suite for the File SOP is a good test for this)\n\t\tlet callback;\n\t\tconst callbacks = [];\n\t\twhile ((callback = this._callbacks.pop())) {\n\t\t\tcallbacks.push(callback);\n\t\t}\n\n\t\tif (!container) {\n\t\t\tcontainer = this.node.container_controller.container.clone();\n\t\t}\n\t\t// removing the clone, as this seems to defeat the no cloning of inputs\n\t\t// container = container || this._container\n\t\twhile ((callback = callbacks.pop())) {\n\t\t\tcallback(container);\n\t\t}\n\t\tthis.node.scene.cook_controller.remove_node(this.node);\n\t}\n}\n\nexport class BaseContainerController extends TypedContainerController<any> {}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Vector2} from 'three/src/math/Vector2';\nconst THREE = {Vector2, Vector3};\n\nconst ATTRIB_NAME_MAP: Dictionary<string> = {\n\tP: 'position',\n\tN: 'normal',\n\tCd: 'color',\n};\n\nexport class CoreAttribute {\n\t// constructor: (@_size, @_value)->\n\t// \t#\n\n\t// size: ->\n\t// \t@_size\n\n\t// value: ->\n\t// \t@_value\n\n\t// set_value: (value)->\n\t// \t@_value = value\n\n\tstatic remap_name(name: string): string {\n\t\treturn ATTRIB_NAME_MAP[name] || name;\n\t}\n\n\tstatic array_to_indexed_arrays(array: string[]) {\n\t\tconst index_by_value: Dictionary<number> = {};\n\t\tlet current_index = 0;\n\t\tconst indices = [];\n\t\tconst values = [];\n\n\t\tlet i = 0;\n\t\twhile (i < array.length) {\n\t\t\t//(value = array[i++])?\n\t\t\tconst value = array[i];\n\t\t\tconst index = index_by_value[value];\n\t\t\tif (index != null) {\n\t\t\t\tindices.push(index);\n\t\t\t} else {\n\t\t\t\tvalues.push(value);\n\t\t\t\tindices.push(current_index);\n\t\t\t\tindex_by_value[value] = current_index;\n\t\t\t\tcurrent_index += 1;\n\t\t\t}\n\n\t\t\ti++;\n\t\t}\n\n\t\treturn {\n\t\t\tindices,\n\t\t\tvalues,\n\t\t};\n\t}\n\n\tstatic default_value(size: number) {\n\t\tswitch (size) {\n\t\t\tcase 1:\n\t\t\t\treturn 0;\n\t\t\tcase 2:\n\t\t\t\treturn new THREE.Vector2(0, 0);\n\t\t\tcase 3:\n\t\t\t\treturn new THREE.Vector3(0, 0, 0);\n\t\t\tdefault:\n\t\t\t\tthrow `size ${size} not yet implemented`;\n\t\t}\n\t}\n}\n","import lodash_sortBy from 'lodash/sortBy';\n// import lodash_isArray from 'lodash/isArray'\n// import lodash_isString from 'lodash/isString'\nimport {RGBFormat} from 'three/src/constants';\nimport {DataTexture} from 'three/src/textures/DataTexture';\nimport {CubicInterpolant} from 'three/src/math/interpolants/CubicInterpolant';\n// import {ClampToEdgeWrapping} from 'three/src/constants'\n// import {TypedParamVisitor} from './_Base';\nimport {TypedParam} from './_Base';\nimport {RampValue, RampPoint, RampValueJson, RampInterpolation} from './ramp/RampValue';\n\n// import {AsCodeRamp} from './concerns/visitors/Ramp';\nimport {ParamType} from '../poly/ParamType';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamEvent} from '../poly/ParamEvent';\n\n// interface RampParamVisitor extends TypedParamVisitor {\n// \tvisit_ramp_param: (param: RampParam) => any;\n// }\n\nexport class RampParam extends TypedParam<ParamType.RAMP> {\n\tstatic type() {\n\t\treturn ParamType.RAMP;\n\t}\n\n\tprivate _ramp_interpolant: CubicInterpolant | undefined;\n\tprivate _ramp_texture: DataTexture | undefined;\n\n\tstatic DEFAULT_VALUE = new RampValue(RampInterpolation.LINEAR, [new RampPoint(0, 0), new RampPoint(1, 1)]);\n\tstatic DEFAULT_VALUE_JSON: RampValueJson = RampParam.DEFAULT_VALUE.to_json();\n\n\tget default_value_serialized() {\n\t\tif (this.default_value instanceof RampValue) {\n\t\t\treturn this.default_value.to_json();\n\t\t} else {\n\t\t\treturn this.default_value;\n\t\t}\n\t}\n\tprotected _clone_raw_input(raw_input: ParamInitValuesTypeMap[ParamType.RAMP]) {\n\t\tif (raw_input instanceof RampValue) {\n\t\t\treturn raw_input.clone();\n\t\t} else {\n\t\t\treturn RampValue.from_json(raw_input).to_json();\n\t\t}\n\t}\n\tget raw_input_serialized() {\n\t\tif (this._raw_input instanceof RampValue) {\n\t\t\treturn this._raw_input.to_json();\n\t\t} else {\n\t\t\treturn RampValue.from_json(this._raw_input).to_json();\n\t\t}\n\t}\n\tget value_serialized() {\n\t\treturn this.value.to_json();\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.RAMP],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.RAMP]\n\t) {\n\t\tif (raw_input1 instanceof RampValue) {\n\t\t\tif (raw_input2 instanceof RampValue) {\n\t\t\t\treturn raw_input1.is_equal(raw_input2);\n\t\t\t} else {\n\t\t\t\treturn raw_input1.is_equal_json(raw_input2);\n\t\t\t}\n\t\t} else {\n\t\t\tif (raw_input2 instanceof RampValue) {\n\t\t\t\treturn raw_input2.is_equal_json(raw_input1);\n\t\t\t} else {\n\t\t\t\treturn RampValue.are_json_equal(raw_input1, raw_input2);\n\t\t\t}\n\t\t}\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.RAMP], val2: ParamValuesTypeMap[ParamType.RAMP]) {\n\t\treturn val1.is_equal(val2);\n\t}\n\tprivate _reset_ramp_interpolant_and_texture_bound = this._reset_ramp_interpolant_and_texture.bind(this);\n\tinitialize_param() {\n\t\tthis.add_post_dirty_hook('_reset_ramp_interpolant_and_texture', this._reset_ramp_interpolant_and_texture_bound);\n\t}\n\t// accepts_visitor(visitor: RampParamVisitor) {\n\t// \treturn visitor.visit_ramp_param(this);\n\t// }\n\tget is_default(): boolean {\n\t\tif (this.default_value instanceof RampValue) {\n\t\t\treturn this.value.is_equal(this.default_value);\n\t\t} else {\n\t\t\treturn this.value.is_equal_json(this.default_value);\n\t\t}\n\t}\n\tprotected process_raw_input() {\n\t\tif (this._raw_input instanceof RampValue) {\n\t\t\tif (!this._value) {\n\t\t\t\tthis._value = this._raw_input;\n\t\t\t} else {\n\t\t\t\tthis._value.copy(this._raw_input);\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this._value) {\n\t\t\t\tthis._value = RampValue.from_json(this._raw_input);\n\t\t\t} else {\n\t\t\t\tthis._value.from_json(this._raw_input);\n\t\t\t}\n\t\t}\n\n\t\tthis.emit_controller.emit(ParamEvent.VALUE_UPDATED);\n\t}\n\n\t// convert_value(v) {\n\t// \tlet is_json = false\n\n\t// \tif (lodash_isString(v)) {\n\t// \t\tv = JSON.parse(v)\n\t// \t\tis_json = true\n\t// \t}\n\n\t// \tif (!is_json) {\n\t// \t\tif (v.interpolation && v.points) {\n\t// \t\t\tif (lodash_isArray(v.points)) {\n\t// \t\t\t\tis_json = true\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// \tif (is_json) {\n\t// \t\tv = RampValue.from_json(v)\n\t// \t}\n\n\t// \treturn v\n\t// }\n\t// convert_default_value(v) {\n\t// \treturn this.convert_value(v)\n\t// }\n\n\thas_expression() {\n\t\treturn false;\n\t}\n\n\t_reset_ramp_interpolant_and_texture() {\n\t\tthis._ramp_interpolant = undefined;\n\t\tthis._ramp_texture = undefined;\n\t}\n\tramp_texture() {\n\t\treturn (this._ramp_texture = this._ramp_texture || this._create_ramp_texture());\n\t}\n\t_create_ramp_texture() {\n\t\tconst width = 1024;\n\t\tconst height = 1;\n\n\t\tconst size = width * height;\n\t\tconst data = new Uint8Array(3 * size);\n\n\t\tlet stride = 0;\n\t\tlet position = 0;\n\t\tlet value = 0;\n\t\tfor (var i = 0; i < size; i++) {\n\t\t\tstride = i * 3;\n\t\t\tposition = i / width;\n\t\t\tvalue = this.value_at_position(position);\n\t\t\tdata[stride] = value * 255; // if I set 256, a value of 1 will become 0\n\t\t\t// data[ stride+1 ] = 1\n\t\t\t// data[ stride+2 ] = 2\n\t\t}\n\n\t\tconst texture = new DataTexture(data, width, height, RGBFormat);\n\t\t// texture.wrapS = ClampToEdgeWrapping\n\t\t// texture.wrapT = ClampToEdgeWrapping\n\t\t// texture.wrapS = ClampToEdgeWrapping\n\t\t// texture.wrapT = ClampToEdgeWrapping\n\t\ttexture.needsUpdate = true;\n\t\treturn texture;\n\t}\n\n\tstatic create_interpolant(positions: Float32Array, values: Float32Array) {\n\t\tconst values_count = 1;\n\t\tconst interpolated_values = new Float32Array(values_count);\n\t\treturn new CubicInterpolant(positions, values, values_count, interpolated_values);\n\t}\n\tinterpolant() {\n\t\treturn (this._ramp_interpolant = this._ramp_interpolant || this._create_interpolant());\n\t}\n\t_create_interpolant() {\n\t\tconst points = this.value.points;\n\t\tconst sorted_points = lodash_sortBy(points, (point) => point.position);\n\t\tconst positions = new Float32Array(sorted_points.length);\n\t\tconst values = new Float32Array(sorted_points.length);\n\n\t\tlet i = 0;\n\t\tfor (let sorted_point of sorted_points) {\n\t\t\tpositions[i] = sorted_point.position;\n\t\t\tvalues[i] = sorted_point.value;\n\t\t\ti++;\n\t\t}\n\n\t\treturn RampParam.create_interpolant(positions, values);\n\t}\n\n\tvalue_at_position(position: number): number {\n\t\treturn (<unknown>this.interpolant().evaluate(position)[0]) as number;\n\t}\n}\n","import {CoreObject} from 'src/core/Object';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\n// interface ContentOption {\n// \tclone?: boolean\n// }\n\nimport {ContainableMap} from './utils/ContainableMap';\ntype K = keyof ContainableMap;\ntype Containable = ContainableMap[K];\n\nexport abstract class TypedContainer<T extends Containable> extends CoreObject {\n\t// protected _node: BaseNode;\n\t// protected _eval_key: number\n\tprotected _content!: T;\n\n\tconstructor(protected _node: BaseNodeType) {\n\t\tsuper();\n\t\t// this.update_eval_key();\n\t\t// this.set_content(this._default_content());\n\t}\n\n\tset_node(node: BaseNodeType) {\n\t\tthis._node = node;\n\t}\n\tnode(): BaseNodeType {\n\t\treturn this._node;\n\t}\n\n\tclone() {\n\t\tlet content;\n\t\tconst cloned_container = new (<any>this.constructor)() as TypedContainer<T>;\n\t\tcloned_container.set_node(this.node());\n\t\tif ((content = this.content()) != null) {\n\t\t\tcloned_container.set_content(content); //, this.eval_key() );\n\t\t}\n\t\treturn cloned_container;\n\t}\n\treset_caches() {}\n\t// abstract _default_content(): T;\n\n\tset_content(content: T) {\n\t\t//, eval_key?: number){\n\t\tthis.reset_caches();\n\t\tthis._content = content; //|| this._default_content();\n\t\t// this.update_eval_key(eval_key);\n\t\tthis._post_set_content();\n\t}\n\thas_content(): boolean {\n\t\treturn this._content != null;\n\t}\n\t// content(options: ContentOption = {}) {\n\t// \tconst clone = options['clone'] || false\n\t// \tif (clone) {\n\t// \t\treturn this.clone_content()\n\t// \t} else {\n\t// \t\treturn this._content\n\t// \t}\n\t// }\n\tcontent() {\n\t\treturn this._content;\n\t}\n\tprotected _post_set_content() {}\n\tpublic core_content(): T | undefined {\n\t\treturn this._content;\n\t}\n\tpublic core_content_cloned(): T | undefined {\n\t\treturn this._content;\n\t}\n\t// abstract clone_content(): T\n\n\t// update_eval_key(eval_key?: number){\n\t// \tthis._eval_key = eval_key || performance.now();\n\t// }\n\t// eval_key(): number {\n\t// \treturn this._eval_key;\n\t// }\n\n\tinfos(): any {\n\t\treturn [];\n\t}\n}\n\nexport class BaseContainer extends TypedContainer<any> {}\n","import lodash_isArray from 'lodash/isArray';\nimport {TypedParam} from './_Base';\nimport {FloatParam} from './Float';\nimport {ParamType} from '../poly/ParamType';\nimport {ParamEvent} from '../poly/ParamEvent';\nimport {ParamInitValueSerializedTypeMap} from './types/ParamInitValueSerializedTypeMap';\n\nexport abstract class TypedMultipleParam<T extends ParamType> extends TypedParam<T> {\n\tprivate _components_contructor = FloatParam;\n\tprotected _components!: FloatParam[];\n\tget components() {\n\t\treturn this._components;\n\t}\n\tget is_numeric() {\n\t\treturn true;\n\t}\n\tget is_default() {\n\t\tfor (let c of this.components) {\n\t\t\tif (!c.is_default) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tget raw_input() {\n\t\treturn this._components.map((c) => c.raw_input) as ParamInitValueSerializedTypeMap[T];\n\t}\n\tget raw_input_serialized() {\n\t\treturn this.raw_input;\n\t}\n\n\tinit_components() {\n\t\tif (this._components != null) {\n\t\t\treturn;\n\t\t}\n\t\tlet index = 0;\n\t\tthis._components = new Array(this.component_names.length);\n\t\tfor (let component_name of this.component_names) {\n\t\t\tconst component = new this._components_contructor(this.scene); //, `${this.name}${name}`);\n\t\t\tlet default_val;\n\t\t\tif (lodash_isArray(this._default_value)) {\n\t\t\t\tdefault_val = this._default_value[index];\n\t\t\t} else {\n\t\t\t\tdefault_val = (this._default_value as any)[component_name];\n\t\t\t}\n\t\t\tcomponent.options.copy(this.options);\n\t\t\tcomponent.set_init_value(default_val);\n\n\t\t\t// component.set_scene(this.scene);\n\t\t\tcomponent.set_name(`${this.name}${component_name}`);\n\t\t\tcomponent.set_parent_param(this);\n\n\t\t\tthis.add_graph_input(component);\n\t\t\t// component.initialize();\n\t\t\tthis._components[index] = component;\n\t\t\tindex++;\n\t\t}\n\t\t// this.compute();\n\t}\n\n\tprotected async process_computation(): Promise<void> {\n\t\tawait this.compute_components();\n\t\tthis.set_value_from_components();\n\t}\n\tset_value_from_components() {}\n\t// set_raw_input_from_components() {}\n\n\thas_expression() {\n\t\tfor (let c of this.components) {\n\t\t\tif (c.expression_controller?.active) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate async compute_components() {\n\t\tconst components = this.components;\n\t\t// const component_evaluation_states = lodash_map(components, ()=> false);\n\t\t// const expected_values_count = components.length;\n\t\t// const component_values = [];\n\t\t// let component;\n\t\t// return lodash_each(this.components(), (component, index)=> {\n\t\tconst promises = [];\n\t\tfor (let c of components) {\n\t\t\tif (c.is_dirty) {\n\t\t\t\tpromises.push(c.compute()); //component_value=> {\n\t\t\t}\n\t\t}\n\t\tawait Promise.all(promises);\n\t\t// component_values[index] = component_value;\n\t\t// component_evaluation_states[index] = true;\n\t\t// const evaluated_values_count = lodash_compact(component_evaluation_states).length;\n\t\t// check if all components have been evaluated succesfully\n\t\t// if (evaluated_values_count === expected_values_count) {\n\t\tthis.remove_dirty_state();\n\t\t// return component_values;\n\t\t// }\n\t\t// });\n\t\t// }\n\t}\n\n\tprotected process_raw_input() {\n\t\tconst cooker = this.scene.cooker;\n\t\tcooker.block();\n\t\tconst components = this.components;\n\t\tfor (let c of components) {\n\t\t\tc.emit_controller.block_parent_emit();\n\t\t}\n\n\t\t// if (lodash_isArray(values)) {\n\t\tconst value = this._raw_input;\n\t\tif (lodash_isArray(value)) {\n\t\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\t\tcomponents[i].set((value as any)[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\t\tconst component_name = this.component_names[i];\n\t\t\t\tcomponents[i].set((value as any)[component_name]);\n\t\t\t}\n\t\t}\n\t\t// } else {\n\t\t// \tconst component_names = this.component_names()\n\t\t// \tfor (let i = 0; i < components.length; i++) {\n\t\t// \t\tcomponents[i].set(values[component_names[i]])\n\t\t// \t}\n\t\t// }\n\n\t\tcooker.unblock();\n\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tcomponents[i].emit_controller.unblock_parent_emit();\n\t\t}\n\t\t// this.emit(ParamEvent.UPDATED);\n\n\t\tthis.emit_controller.emit(ParamEvent.VALUE_UPDATED);\n\t}\n}\n\n// export class BaseMultipleParam extends TypedMultipleParam<Vector> {}\n","import {\n\tConnectionPointType,\n\tConnectionPointInitValueMapGeneric,\n\tConnectionPointInitValueMap,\n\tConnectionPointTypeToParamTypeMap,\n\tIConnectionPointTypeToParamTypeMap,\n} from './ConnectionPointType';\n// import {ParamInitValuesTypeMap} from '../params/ParamsController';\n\nexport interface TypedNamedConnectionPointData<T extends ConnectionPointType> {\n\tname: string;\n\ttype: T;\n}\n\nexport class TypedNamedConnectionPoint<T extends ConnectionPointType> {\n\tprivate _json: TypedNamedConnectionPointData<T> | undefined;\n\n\tconstructor(\n\t\tprotected _name: string,\n\t\tprotected _type: T,\n\t\tprotected _init_value?: ConnectionPointInitValueMapGeneric[T]\n\t) {\n\t\tif (this._init_value === undefined) {\n\t\t\tthis._init_value = ConnectionPointInitValueMap[this._type];\n\t\t}\n\t}\n\tget name() {\n\t\treturn this._name;\n\t}\n\tget type() {\n\t\treturn this._type;\n\t}\n\tget param_type(): IConnectionPointTypeToParamTypeMap[T] {\n\t\treturn ConnectionPointTypeToParamTypeMap[this._type];\n\t}\n\tget init_value() {\n\t\treturn this._init_value;\n\t}\n\n\tto_json(): TypedNamedConnectionPointData<T> {\n\t\treturn (this._json = this._json || this._create_json());\n\t}\n\tprivate _create_json(): TypedNamedConnectionPointData<T> {\n\t\treturn {\n\t\t\tname: this._name,\n\t\t\ttype: this._type,\n\t\t};\n\t}\n}\n\nexport type BaseNamedConnectionPointType = TypedNamedConnectionPoint<ConnectionPointType>;\n","import {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {EngineParamData} from 'src/editor/store/modules/Engine';\n\nexport const SetupFieldCommonProps = {\n\tjson_param: {\n\t\ttype: Object,\n\t\tdefault() {\n\t\t\treturn {};\n\t\t},\n\t},\n\ttabindex: {\n\t\ttype: Number,\n\t\tdefault: -1,\n\t},\n\tdisplays_expression_result: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n};\nexport interface ISetupFieldCommonProps {\n\tjson_param: EngineParamData;\n\ttabindex: number;\n\tdisplays_expression_result: boolean;\n}\n\nimport {computed, watch} from '@vue/composition-api';\nimport {ParamSetCommand} from 'src/editor/history/commands/ParamSet';\nimport {FloatParam} from 'src/engine/params/Float';\nimport {IntegerParam} from 'src/engine/params/Integer';\nexport function SetupFieldCommon(props: ISetupFieldCommonProps) {\n\tconst param = StoreController.engine.param(props.json_param.graph_node_id)!;\n\n\t// param() {\n\t// \treturn $store.scene.graph().node_from_id(json_param != null ? json_param.graph_node_id : undefined);\n\t// },\n\tconst name = computed(() => {\n\t\treturn props.json_param.name;\n\t});\n\n\tconst raw_input = computed(() => {\n\t\treturn props.json_param.raw_input;\n\t});\n\tconst value = computed(() => {\n\t\treturn props.json_param.value;\n\t});\n\tconst expression = computed(() => {\n\t\treturn props.json_param.expression;\n\t});\n\tconst has_expression = computed(() => {\n\t\treturn expression.value != null;\n\t});\n\tconst error_message = computed(() => {\n\t\treturn props.json_param.error_message;\n\t});\n\tconst is_errored = computed(() => {\n\t\treturn error_message.value != null;\n\t});\n\t// const is_dirty = computed(() => {\n\t// \treturn json_param.is_dirty;\n\t// });\n\n\tconst field_component_type = computed(() => {\n\t\treturn props.json_param.type;\n\t});\n\n\tconst class_object = computed(() => {\n\t\t// TODO: no idea why this gets called forever for a string\n\t\t// if (param.options.displays_expression_only === true) {\n\t\t// \tif (is_dirty) {\n\t\t// \t\tparam.eval((value) => {\n\t\t// \t\t\treturn console.log(value, json_param.result);\n\t\t// \t\t});\n\t\t// \t}\n\t\t// \treturn (object = {\n\t\t// \t\tdisplays_expression_result: true,\n\t\t// \t\tdisplays_expression_only: true,\n\t\t// \t});\n\t\t// } else {\n\t\treturn {displays_expression_result: props.displays_expression_result};\n\t\t// }\n\t});\n\n\tconst input_value_class_object = computed(() => {\n\t\treturn {\n\t\t\thas_expression: has_expression.value,\n\t\t\tis_errored: is_errored.value,\n\t\t};\n\t});\n\n\tconst is_field_visible = computed(() => {\n\t\treturn !param.options.is_field_hidden();\n\t});\n\tconst displays_expression_result_computed = computed(() => {\n\t\treturn props.displays_expression_result;\n\t});\n\n\twatch(displays_expression_result_computed, async (new_display, old_display) => {\n\t\tif (new_display) {\n\t\t\tif (param.is_dirty) {\n\t\t\t\tawait param.compute();\n\t\t\t}\n\t\t}\n\t});\n\n\t// functions\n\tfunction on_update_value(e: Event) {\n\t\tconst target = e.currentTarget as HTMLInputElement | null;\n\t\tif (target) {\n\t\t\tconst new_value = target.value;\n\t\t\tif (!param.is_raw_input_equal(new_value)) {\n\t\t\t\tcreate_set_command(target.value);\n\t\t\t}\n\t\t}\n\t}\n\tfunction on_keyup(e: KeyboardEvent) {\n\t\tlet offset: number | undefined = undefined;\n\n\t\tswitch (e.key) {\n\t\t\tcase 'ArrowUp':\n\t\t\t\toffset = 1;\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowDown':\n\t\t\t\toffset = -1;\n\t\t\t\tbreak;\n\t\t}\n\t\tif (offset) {\n\t\t\tif (e.ctrlKey) {\n\t\t\t\toffset *= 0.1;\n\t\t\t} else {\n\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\toffset *= 10;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (param instanceof FloatParam || param instanceof IntegerParam) {\n\t\t\t\tconst value = param.value;\n\t\t\t\tconst cmd = new ParamSetCommand(param, value + offset);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t}\n\n\t\te.preventDefault();\n\t}\n\n\t// NOT USED, since it is annoying when trying to scroll\n\t// function on_wheel(e: WheelEvent) {\n\t// \tif (has_expression.value) {\n\t// \t\treturn;\n\t// \t}\n\n\t// \tconst type = field_component_type.value;\n\t// \tif (type == ParamType.FLOAT || type == ParamType.INTEGER) {\n\t// \t\tconst down = e.deltaY > 0;\n\t// \t\tlet offset = 0.1;\n\t// \t\tif (down) {\n\t// \t\t\toffset *= -1;\n\t// \t\t}\n\t// \t\tparam.set(((<any>value) as number) + offset);\n\t// \t}\n\t// \t// TODO: how can I generate a command only when the mouse wheel has stopped?\n\t// }\n\n\tfunction reset_to_default() {\n\t\tif (!param.is_default) {\n\t\t\tcreate_set_command(param.default_value);\n\t\t}\n\t}\n\tfunction create_set_command(value: any) {\n\t\tconst cmd = new ParamSetCommand(param as any, value);\n\t\tcmd.push();\n\t}\n\n\treturn {\n\t\tname,\n\t\tvalue,\n\t\texpression,\n\t\traw_input,\n\t\thas_expression,\n\t\terror_message,\n\t\tis_errored,\n\t\t// is_dirty,\n\t\tfield_component_type,\n\t\tclass_object,\n\t\tinput_value_class_object,\n\t\tis_field_visible,\n\t\t// functions\n\t\ton_update_value,\n\t\ton_keyup,\n\t\t// on_wheel,\n\t\treset_to_default,\n\t};\n}\n","export const CATEGORY_OBJ = {\n\tLIGHT: 'lights',\n\tMANAGER: 'managers',\n\tGEOMETRY: 'geometries',\n\tCAMERA: 'cameras',\n\tMISC: 'misc',\n};\nexport const CATEGORY_COP = {\n\tINPUT: 'inputs',\n\tADVANCED: 'advanced',\n\tMISC: 'misc',\n};\nexport const CATEGORY_EVENT = {\n\tCAMERA: 'cameras',\n\tMISC: 'misc',\n};\nexport const CATEGORY_GL = {\n\tCOLOR: 'color',\n\tCONVERSION: 'conversion',\n\tDYNAMICS: 'dynamics',\n\tGEOMETRY: 'geometry',\n\tGLOBALS: 'globals',\n\tMATH: 'math',\n\tQUAT: 'quat',\n\tTRIGO: 'trigo',\n\tUTIL: 'util',\n\tINSTANCE: 'instance',\n};\nexport const CATEGORY_MAT = {\n\tADVANCED: 'advanced',\n\tMESH: 'meshes',\n\tPOINTS: 'points',\n\tLINE: 'lines',\n\tVOLUME: 'volumes',\n\tINSTANCE: 'instances',\n};\nexport const CATEGORY_SOP = {\n\tANIMATION: 'animation',\n\tATTRIBUTE: 'attributes',\n\tDYNAMICS: 'dynamics',\n\tINPUT: 'inputs',\n\tMISC: 'misc',\n\tMODIFIER: 'modifiers',\n\tRENDER: 'render',\n};\nexport const CATEGORY_POST = {\n\tPASS: 'passes',\n};\n","import {TypedNode} from '../_Base';\n\n// import {LineType} from './code/utils/CodeBuilder';\nimport {ThreeToGl} from 'src/core/ThreeToGl';\nimport {BaseGlShaderAssembler} from './code/assemblers/_Base';\n\nimport {AssemblerControllerNode} from './code/Controller';\n\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamValue} from 'src/engine/params/types/ParamValue';\n\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\nimport {BaseNamedConnectionPointType, TypedNamedConnectionPoint} from '../utils/connections/NamedConnectionPoint';\nimport {ParamTypeToConnectionPointTypeMap} from '../utils/connections/ConnectionPointType';\nimport {ParamValueToDefaultConverter} from '../utils/params/ParamValueToDefaultConverter';\n// import {ShaderName} from '../utils/shaders/ShaderName';\nimport {ParamConfigsController} from '../utils/code/controllers/ParamConfigsController';\nimport {ShadersCollectionController} from './code/utils/ShadersCollectionController';\n\nexport class TypedGlNode<K extends NodeParamsConfig> extends TypedNode<'GL', BaseGlNodeType, K> {\n\tstatic node_context(): NodeContext {\n\t\treturn NodeContext.GL;\n\t}\n\tprotected _param_configs_controller: ParamConfigsController | undefined;\n\tprotected _assembler: BaseGlShaderAssembler | undefined;\n\tprivate _set_mat_to_recompile_bound = this._set_mat_to_recompile.bind(this);\n\n\tinitialize_base_node() {\n\t\tthis.io.inputs.set_depends_on_inputs(false);\n\t\tthis.io.connections.init_inputs();\n\t\tthis.ui_data.set_layout_horizontal();\n\t\tthis.io.outputs.set_named_output_connection_points([]);\n\t\tthis.add_post_dirty_hook('_set_mat_to_recompile', this._set_mat_to_recompile_bound);\n\n\t\tthis.params.set_post_create_params_hook(this.create_inputs_from_params.bind(this));\n\t}\n\tprivate _set_mat_to_recompile() {\n\t\tthis.material_node?.assembler_controller.set_compilation_required_and_dirty(this);\n\t}\n\tget material_node(): AssemblerControllerNode | undefined {\n\t\tif (this.parent) {\n\t\t\tif (this.parent.type == this.type) {\n\t\t\t\treturn (this.parent as BaseGlNodeType)?.material_node;\n\t\t\t} else {\n\t\t\t\treturn this.parent as AssemblerControllerNode;\n\t\t\t}\n\t\t}\n\t}\n\n\t//\n\t//\n\t// VARIABLES\n\t//\n\t//\n\tgl_var_name(name: string) {\n\t\treturn `v_POLY_${this.name}_${name}`;\n\t}\n\n\tvariable_for_input(name: string): string {\n\t\tconst input_index = this.io.inputs.get_input_index(name);\n\t\tconst connection = this.io.connections.input_connection(input_index);\n\t\tif (connection) {\n\t\t\tconst input_node = (<unknown>connection.node_src) as BaseGlNodeType;\n\t\t\tconst output_name = input_node.io.outputs.named_output_connection_points[connection.output_index].name;\n\t\t\treturn input_node.gl_var_name(output_name);\n\t\t} else {\n\t\t\treturn ThreeToGl.any(this.params.get(name)?.value);\n\t\t}\n\t}\n\n\t//\n\t//\n\t// ADDED LINES\n\t//\n\t//\n\tset_lines(shaders_collection_controller: ShadersCollectionController) {}\n\n\treset_code() {\n\t\tthis._param_configs_controller?.reset();\n\t\t// this.reset_lines();\n\t}\n\n\t//\n\t//\n\t// PARAMS\n\t//\n\t//\n\n\tprotected _allow_inputs_created_from_params: boolean = true;\n\tcreate_inputs_from_params() {\n\t\tif (!this._allow_inputs_created_from_params) {\n\t\t\treturn;\n\t\t}\n\t\tconst connections: BaseNamedConnectionPointType[] = [];\n\t\tconst inputless_params_names = this.inputless_params_names();\n\t\tthis.params.names.forEach((param_name) => {\n\t\t\tlet add_input = true;\n\t\t\tif (inputless_params_names.length > 0 && inputless_params_names.includes(param_name)) {\n\t\t\t\tadd_input = false;\n\t\t\t}\n\t\t\tif (add_input) {\n\t\t\t\tconst param = this.params.get(param_name);\n\t\t\t\tif (param && !param.parent_param) {\n\t\t\t\t\tconst connection_type = ParamTypeToConnectionPointTypeMap[param.type];\n\t\t\t\t\tif (connection_type) {\n\t\t\t\t\t\tconst connection = new TypedNamedConnectionPoint(param.name, connection_type);\n\t\t\t\t\t\tconnections.push(connection);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.io.inputs.set_named_input_connection_points(connections);\n\t}\n\tinputless_params_names(): string[] {\n\t\treturn [];\n\t}\n\tprotected create_spare_parameters() {\n\t\tconst values_by_param_name: Map<string, ParamValue> = new Map();\n\t\tconst current_param_names: string[] = this.params.spare_names;\n\t\tlet has_deleted_a_param = false;\n\t\tlet has_created_a_param = false;\n\t\tcurrent_param_names.forEach((param_name) => {\n\t\t\tconst param = this.params.get(param_name);\n\t\t\tif (param) {\n\t\t\t\tvalues_by_param_name.set(param_name, param.value);\n\t\t\t\tthis.params.delete_param(param_name);\n\t\t\t\thas_deleted_a_param = true;\n\t\t\t}\n\t\t});\n\n\t\t// TODO: typescript: fix this confusion between named_inputs and NamedConnection\n\t\tthis.io.inputs.named_input_connection_points.forEach((connection_point) => {\n\t\t\tconst param_name = connection_point.name;\n\n\t\t\tconst last_param_value = values_by_param_name.get(param_name);\n\t\t\tif (last_param_value != null) {\n\t\t\t\tconst param_type: ParamType = connection_point.param_type;\n\t\t\t\tlet init_value = ParamValueToDefaultConverter.from_value(param_type, last_param_value);\n\t\t\t\tif (init_value == null) {\n\t\t\t\t\tconst default_value_from_name = this.gl_input_default_value(param_name);\n\t\t\t\t\tif (default_value_from_name != null) {\n\t\t\t\t\t\tinit_value = default_value_from_name;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// if (default_value == null) {\n\t\t\t\t// \tdefault_value = gl_connection.default_value();\n\t\t\t\t// }\n\t\t\t\tif (init_value == null && connection_point.init_value) {\n\t\t\t\t\tinit_value = connection_point.init_value;\n\t\t\t\t}\n\n\t\t\t\tthis.add_param(param_type, param_name, init_value, {\n\t\t\t\t\tspare: true,\n\t\t\t\t\tcook: true,\n\t\t\t\t});\n\t\t\t\thas_created_a_param = true;\n\t\t\t}\n\t\t});\n\n\t\tif (has_created_a_param || has_deleted_a_param) {\n\t\t\tif (!this.scene.loading_controller.is_loading) {\n\t\t\t\tthis.emit(NodeEvent.PARAMS_UPDATED);\n\t\t\t}\n\t\t}\n\t}\n\t//\n\t//\n\t// PARAM CONFIGS\n\t//\n\t//\n\tpublic set_param_configs() {}\n\tparam_configs() {\n\t\treturn this._param_configs_controller?.list;\n\t}\n\t// private reset_param_configs() {\n\t// \tthis._param_configs = [];\n\t// }\n\t// add_param_config<T extends ParamType>(\n\t// \ttype: T,\n\t// \tname: string,\n\t// \tdefault_value: ParamInitValuesTypeMap[T],\n\t// \tuniform_name: string\n\t// ) {\n\t// \tconst param_config = new ParamConfig(type, name, default_value, uniform_name);\n\t// \tthis._param_configs.push(param_config);\n\t// }\n\t// param_configs() {\n\t// \treturn this._param_configs;\n\t// }\n\t//\n\t//\n\t// INPUT\n\t//\n\t//\n\tprotected gl_input_default_value(name: string) {\n\t\treturn null;\n\t}\n\n\t//\n\t//\n\t// MISC\n\t//\n\t//\n\n\t// used when a node changes its signature, adn the output nodes need to adapt their own signatures\n\tprotected make_output_nodes_dirty() {\n\t\tthis.io.connections\n\t\t\t.output_connections()\n\t\t\t.map((c) => c.node_dest)\n\t\t\t.forEach((o) => {\n\t\t\t\to.set_dirty(this);\n\t\t\t});\n\t}\n\n\t//\n\t//\n\t// NEEDED?\n\t//\n\t//\n\t// set_assembler(assembler: BaseGlShaderAssembler) {\n\t// \tthis._assembler = assembler;\n\t// }\n\t// get assembler(): BaseGlShaderAssembler | undefined {\n\t// \treturn this._assembler;\n\t// }\n\n\t// shader_configs() {\n\t// \treturn this.assembler?.shader_configs || [];\n\t// }\n\t// shader_config(name: string) {\n\t// \treturn this.assembler?.shader_config(name);\n\t// }\n\t// shader_names() {\n\t// \treturn this.assembler?.shader_names || [];\n\t// }\n}\n\nexport type BaseGlNodeType = TypedGlNode<NodeParamsConfig>;\nexport class BaseGlNodeClass extends TypedGlNode<NodeParamsConfig> {}\n","// import lodash_isArray from 'lodash/isArray'\n// import lodash_isString from 'lodash/isString'\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamInitValueSerializedTypeMap} from 'src/engine/params/types/ParamInitValueSerializedTypeMap';\n\nimport {ParamOptions} from 'src/engine/params/utils/OptionsController';\n\ntype OverridenOptions = Dictionary<string>;\n\nexport type SimpleParamJsonExporterData<T extends ParamType> = ParamInitValueSerializedTypeMap[T];\n\nexport interface ComplexParamJsonExporterData<T extends ParamType> {\n\ttype?: T;\n\tdefault_value?: ParamInitValueSerializedTypeMap[T];\n\traw_input?: ParamInitValueSerializedTypeMap[T];\n\toptions?: ParamOptions;\n\toverriden_options?: OverridenOptions;\n\t// components?: ParamJsonExporterDataByName;\n\t// expression?: string;\n}\nexport type ParamJsonExporterData<T extends ParamType> =\n\t| SimpleParamJsonExporterData<T>\n\t| ComplexParamJsonExporterData<T>;\nexport type ParamJsonExporterDataByName = Dictionary<ParamJsonExporterData<ParamType>>;\n\nexport class ParamJsonExporter<T extends BaseParamType> {\n\t// protected _simple_data: SimpleParamJsonExporterData<ParamType>=0;\n\tprotected _complex_data: ComplexParamJsonExporterData<ParamType> = {};\n\tconstructor(protected _param: T) {}\n\n\tget required(): boolean {\n\t\tconst is_spare_and_not_component = this._param.options.is_spare && !this._param.parent_param;\n\n\t\t// we should not need to check if it has an expression anymore,\n\t\t// as it could have an expression AND be of default value\n\t\tconst value_changed = !this._param.is_default; //|| this._param.has_expression();\n\t\t// const referencing_asset = this._param.is_referencing_asset()\n\t\treturn is_spare_and_not_component || value_changed; // || referencing_asset\n\t}\n\n\tdata() {\n\t\tif (this._param.parent_param) {\n\t\t\tthrow 'no component should be saved';\n\t\t}\n\n\t\tif (this._require_data_complex()) {\n\t\t\treturn this._data_complex();\n\t\t} else {\n\t\t\treturn this._data_simple();\n\t\t}\n\t}\n\n\tprivate _data_simple() {\n\t\treturn this._param.raw_input_serialized;\n\t}\n\n\tprivate _data_complex() {\n\t\tthis._complex_data = {};\n\n\t\tif (this._param.options.is_spare && !this._param.parent_param) {\n\t\t\tthis._complex_data['type'] = this._param.type;\n\t\t\tthis._complex_data['default_value'] = this._param.default_value_serialized;\n\t\t\tthis._complex_data['options'] = this._param.options.current;\n\t\t}\n\n\t\tif (!this._param.is_default) {\n\t\t\tthis.add_main();\n\t\t}\n\n\t\t// if(this._param.is_referencing_asset()){\n\t\t// \t// console.log(\"this._param.is_referencing_asset()\", this._param.is_referencing_asset())\n\t\t// \tthis._data['referenced_asset'] = this._param.referenced_asset()\n\t\t// }\n\n\t\tif (this._param.options.has_options_overridden) {\n\t\t\tconst overridden_options: OverridenOptions = {};\n\t\t\tconst options_overridden = this._param.options.overridden_options;\n\t\t\tfor (let option_name of Object.keys(options_overridden)) {\n\t\t\t\tconst option_value = options_overridden[option_name as keyof ParamOptions];\n\t\t\t\toverridden_options[option_name] = JSON.stringify(option_value);\n\t\t\t}\n\t\t\tthis._complex_data['overriden_options'] = overridden_options;\n\t\t}\n\t\treturn this._complex_data;\n\t}\n\n\tprotected _require_data_complex() {\n\t\tif (this._param.options.is_spare) {\n\t\t\treturn true;\n\t\t}\n\t\tif (this._param.options.has_options_overridden) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// default_value(): ParamValueSerialized {\n\t// \treturn this._param.default_value_serialized;\n\t// }\n\n\t// cannot remember why this is useful, but it messes up\n\t// with gl nodes like the noise node, as the default value\n\t// gets saved as a string '[1,1]' instead of an array [1,1] (should be without quotes)\n\t// protected default_value(){\n\t// \tlet default_value = this._param.default_value()\n\t// \tif(lodash_isString(default_value)){\n\t// \t\tdefault_value = `'${default_value}'`\n\t// \t}\n\t// \tif (lodash_isArray(default_value)){\n\t// \t\tdefault_value = `[${default_value}]`\n\t// \t}\n\t// \treturn default_value\n\t// }\n\n\tprotected add_main() {}\n}\n","// import {Vector3} from 'three/src/math/Vector3';\n// import {Texture} from 'three/src/textures/Texture';\nimport {Raycaster} from 'three/src/core/Raycaster';\nimport {PlaneBufferGeometry} from 'three/src/geometries/PlaneGeometry';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {Color} from 'three/src/math/Color';\nimport {MeshBasicMaterial} from 'three/src/materials/MeshBasicMaterial';\n// const THREE = {Color, Mesh, MeshBasicMaterial, PlaneBufferGeometry, Raycaster, Texture, Vector3}\n// import lodash_isNaN from 'lodash/isNaN'\n// import lodash_sum from 'lodash/sum'\n// import {BaseParam} from 'src/Engine/Param/_Base'\n// import {BaseNodePostProcess} from 'src/Engine/Node/PostProcess/_Base'\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\nimport {BaseMatNodeType} from 'src/engine/nodes/mat/_Base';\n// import {NodeContext} from 'src/engine/poly/NodeContext';\n// import {ParamType} from 'src/engine/poly/ParamType';\n// import {EffectComposer} from 'modules/three/examples/jsm/postprocessing/EffectComposer'\n// import {RenderPass} from 'modules/three/examples/jsm/postprocessing/RenderPass'\n\n// import {File} from 'src/Engine/Node/Cop/File'\n\n// import {ScreenQuad} from '../Camera/ScreenQuad'\nimport {NodeContext} from 'src/engine/poly/NodeContext';\n\nimport {ParamConfig} from '../../../../utils/params/ParamsConfig';\nexport function CameraBackgroundParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tbackground = ParamConfig.FOLDER();\n\t\tuse_background = ParamConfig.BOOLEAN(0);\n\t\tuse_material = ParamConfig.BOOLEAN(0, {\n\t\t\tvisible_if: {use_background: true},\n\t\t});\n\t\tbackground_color = ParamConfig.COLOR([0, 0, 0], {\n\t\t\tvisible_if: {use_background: true, use_material: false},\n\t\t});\n\t\tbackground_material = ParamConfig.OPERATOR_PATH('', {\n\t\t\tvisible_if: {use_background: true, use_material: true},\n\t\t\tnode_selection: {context: NodeContext.MAT},\n\t\t\tdependent_on_found_node: false,\n\t\t});\n\t\tbackground_ratio = ParamConfig.FLOAT(1, {\n\t\t\tvisible_if: {use_background: true, use_material: true},\n\t\t});\n\t};\n}\n\nexport class BaseBackgroundController {\n\t// private _param_use_background: boolean;\n\t// private _param_use_material: boolean;\n\t// private _param_background_color: Color;\n\t// private _param_background_material: string;\n\t// private _param_background_ratio: number;\n\n\tprivate _screen_quad: Mesh | undefined;\n\tprivate _screen_quad_flat_material: MeshBasicMaterial | undefined;\n\n\tprotected _bg_raycaster = new Raycaster();\n\n\tconstructor(protected node: BaseCameraObjNodeType) {}\n\n\tget screen_quad() {\n\t\treturn (this._screen_quad = this._screen_quad || this._create_screen_quad()); // new ScreenQuad()\n\t}\n\tprivate _create_screen_quad() {\n\t\tconst size = 2; // better than 1 for color, as the edges can be visible if canvas ratio extreme\n\t\tconst segments = 1;\n\t\tconst geometry = new PlaneBufferGeometry(size, size, segments, segments);\n\t\tconst quad = new Mesh(geometry);\n\t\tthis.node.object.add(quad);\n\t\treturn quad;\n\t}\n\tscreen_quad_flat_material() {\n\t\treturn (this._screen_quad_flat_material = this._screen_quad_flat_material || new MeshBasicMaterial());\n\t}\n\n\tadd_params() {\n\t\t// this.node.within_param_folder('background', () => {\n\t\t// this.node.add_param(ParamType.BOOLEAN, 'use_background', 0);\n\t\t// this.node.add_param(ParamType.BOOLEAN, 'use_material', 0, {\n\t\t// \tvisible_if: {use_background: true},\n\t\t// });\n\t\t// this.node.add_param(ParamType.COLOR, 'background_color', [0, 0, 0], {\n\t\t// \tvisible_if: {use_background: true, use_material: false},\n\t\t// });\n\t\t// this.node.add_param(ParamType.OPERATOR_PATH, 'background_material', '', {\n\t\t// \tvisible_if: {use_background: true, use_material: true},\n\t\t// \tnode_selection: {context: NodeContext.MAT},\n\t\t// \tdependent_on_found_node: false,\n\t\t// });\n\t\t// this.node.add_param(ParamType.FLOAT, 'background_ratio', 1, {\n\t\t// \tvisible_if: {use_background: true, use_material: true},\n\t\t// });\n\t\t// });\n\t\t// this.self.add_param( ParamType.TOGGLE, 'use_background_color', 1 )\n\t\t// this.self.add_param( ParamType.COLOR, 'background_color', [0,0,0], {\n\t\t// \tvisible_if: {use_background_color: 1}\n\t\t// })\n\t\t// this.self.add_param( ParamType.TOGGLE, 'use_background_image', 0 )\n\t\t// this.self.add_param( ParamType.OPERATOR_PATH, 'background_image', File.DEFAULT_NODE_PATH.UV, {\n\t\t// \tvisible_if: {use_background_image: true},\n\t\t// \tnode_selection: {context: NodeContext.COP}\n\t\t// } )\n\t}\n\n\tget use_background(): boolean {\n\t\treturn this.node.params.boolean('use_background');\n\t}\n\tget use_background_material(): boolean {\n\t\treturn this.use_background && this.node.params.boolean('use_material');\n\t}\n\tget use_background_color(): boolean {\n\t\treturn this.use_background && !this.node.params.boolean('use_material');\n\t}\n\tget background_color(): Color | null {\n\t\tif (this.use_background_color) {\n\t\t\treturn this.node.params.color('background_color');\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\t// background_image_url(){\n\t// \tif(this._param_use_background_image){\n\t// \t\t// this.param('background_image').mark_as_referencing_asset(this._param_background_image)\n\t// \t\t// return this._param_background_image\n\t// \t\treturn this._background_image_url\n\t// \t}\n\t// }\n\t// background_texture(){\n\t// \tif(this._param_use_background_image){\n\t// \t\treturn this._background_texture\n\t// \t}\n\t// }\n\tprotected update_screen_quad() {}\n\tasync update() {\n\t\tif (this.use_background) {\n\t\t\tthis.update_screen_quad();\n\n\t\t\tawait this.update_background_color();\n\t\t\tif (this.use_background_material) {\n\t\t\t\tawait this.update_background_material();\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._screen_quad) {\n\t\t\t\tthis.node.object.remove(this._screen_quad);\n\t\t\t}\n\t\t}\n\n\t\t// if(this._param_use_background_image){\n\t\t// \tconst bg_node = this.self.param('background_image').found_node();\n\t\t// \tif(bg_node){\n\t\t// \t\tconst container = await bg_node.request_container();\n\t\t// \t\tthis._background_texture = container.core_content()\n\t\t// \t\t// this._background_image_url = bg_node.resolved_url()\n\t\t// \t} else {\n\t\t// \t\tthis._background_texture = null\n\t\t// \t}\n\t\t// } else {\n\t\t// \tthis._background_texture = null\n\t\t// }\n\t}\n\tprivate async update_background_color() {\n\t\tconst material = this.screen_quad_flat_material();\n\t\tmaterial.color = this.node.pv.background_color;\n\t\tthis.screen_quad.material = material;\n\t}\n\n\tprivate async update_background_material() {\n\t\tconst bg_node = this.node.p.background_material.found_node() as BaseMatNodeType;\n\t\tif (bg_node) {\n\t\t\tawait bg_node.request_container();\n\t\t\tconst material = bg_node.material;\n\t\t\tthis.screen_quad.material = material;\n\t\t\t// this.screen_quad().material.uniforms.uTexture.value = texture\n\t\t} else {\n\t\t\tthis.node.states.error.set('bg node not found');\n\t\t}\n\t}\n}\n","import {CoreString} from './String'\nimport {Vector3} from 'three/src/math/Vector3'\nimport {Vector2} from 'three/src/math/Vector2'\nimport lodash_isNumber from 'lodash/isNumber'\nimport lodash_isBoolean from 'lodash/isBoolean'\nimport lodash_isString from 'lodash/isString'\n\nexport class ThreeToGl {\n\tstatic any(value: any) {\n\t\tif (lodash_isString(value)) {\n\t\t\treturn value\n\t\t}\n\t\tif (lodash_isBoolean(value)) {\n\t\t\treturn `${value}`\n\t\t}\n\n\t\tif (lodash_isNumber(value)) {\n\t\t\treturn `${CoreString.ensure_float(value)}`\n\t\t} else {\n\t\t\tconst values = value.toArray().map((v: number) => {\n\t\t\t\treturn `${CoreString.ensure_float(v)}`\n\t\t\t})\n\t\t\tconst gl_type = `vec${values.length}`\n\t\t\treturn `${gl_type}(${values.join(', ')})`\n\t\t}\n\t}\n\n\tstatic vector3(vec: Vector3 | string): string {\n\t\tif (lodash_isString(vec)) {\n\t\t\treturn vec\n\t\t}\n\t\tconst values = vec.toArray().map((v) => {\n\t\t\treturn `${CoreString.ensure_float(v)}`\n\t\t})\n\t\treturn `vec3(${values.join(', ')})`\n\t}\n\tstatic vector2(vec: Vector2 | string): string {\n\t\tif (lodash_isString(vec)) {\n\t\t\treturn vec\n\t\t}\n\t\tconst values = vec.toArray().map((v) => {\n\t\t\treturn `${CoreString.ensure_float(v)}`\n\t\t})\n\t\treturn `vec2(${values.join(', ')})`\n\t}\n\n\tstatic vector3_float(vec: Vector3 | string, num: number | string): string {\n\t\tif (!lodash_isString(num)) {\n\t\t\tnum = CoreString.ensure_float(num)\n\t\t}\n\t\treturn `vec4(${this.vector3(vec)}, ${num})`\n\t}\n\n\tstatic float3(x: number | string, y: number | string, z: number | string) {\n\t\tif (!lodash_isString(x)) {\n\t\t\tx = CoreString.ensure_float(x)\n\t\t}\n\t\tif (!lodash_isString(y)) {\n\t\t\ty = CoreString.ensure_float(y)\n\t\t}\n\t\tif (!lodash_isString(z)) {\n\t\t\tz = CoreString.ensure_float(z)\n\t\t}\n\t\treturn `vec3(${x}, ${y}, ${z})`\n\t}\n\tstatic float2(x: number | string, y: number | string) {\n\t\tif (!lodash_isString(x)) {\n\t\t\tx = CoreString.ensure_float(x)\n\t\t}\n\t\tif (!lodash_isString(y)) {\n\t\t\ty = CoreString.ensure_float(y)\n\t\t}\n\t\treturn `vec2(${x}, ${y})`\n\t}\n\tstatic float(x: number | string) {\n\t\tif (!lodash_isString(x)) {\n\t\t\tx = CoreString.ensure_float(x)\n\t\t}\n\t\treturn `${x}`\n\t}\n\tstatic int(x: number | string) {\n\t\treturn `${x}`\n\t}\n\tstatic bool(x: number | string) {\n\t\treturn `${x}`\n\t}\n}\n","export const Constants = {\n\tNODE_HEIGHT: 50,\n\tCONNECTION_VERTICAL_MARGIN: 12,\n\tCONNECTION_VERTICAL_SPACING: 20,\n\tCONNECTION_VERTICAL_START: 10,\n\tNODE_UNIT: 50,\n\t// NODE_SIZE: 50,\n\t// NODE_POS_MULT: 1\n};\n","import {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {EngineParamData} from 'src/editor/store/modules/Engine';\nimport {BaseParamType} from 'src/engine/params/_Base';\n\nexport function SetupContextMenu(json_param: EngineParamData, param: BaseParamType) {\n\tfunction on_contextmenu(event: MouseEvent) {\n\t\tconst menu_param_id = StoreController.editor.context_menu.param_id();\n\t\tconst current_param_id = json_param.graph_node_id;\n\t\tif (menu_param_id == current_param_id) {\n\t\t\ton_contextmenu_close();\n\t\t} else {\n\t\t\tStoreController.editor.context_menu.set_param_id(current_param_id);\n\t\t}\n\t\tStoreController.editor.context_menu.set_position({\n\t\t\tx: event.pageX,\n\t\t\ty: event.pageY,\n\t\t});\n\t}\n\tfunction on_contextmenu_close() {\n\t\tStoreController.editor.context_menu.set_param_id(null);\n\t}\n\n\treturn {\n\t\ton_contextmenu,\n\t\ton_contextmenu_close,\n\t};\n}\n","import {TypedNode} from '../_Base';\nimport {TextureContainer} from 'src/engine/containers/Texture';\nimport {Texture} from 'three/src/textures/Texture';\nimport {TypedContainerController} from '../utils/ContainerController';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\nimport {FlagsControllerB} from '../utils/FlagsController';\nimport {DataTexture} from 'three/src/textures/DataTexture';\nimport {LuminanceFormat, HalfFloatType} from 'three/src/constants';\n\nconst INPUT_COP_NAME = 'input texture';\nconst DEFAULT_INPUT_NAMES = [INPUT_COP_NAME, INPUT_COP_NAME, INPUT_COP_NAME, INPUT_COP_NAME];\n\nvar size = 32;\nvar data = new Uint16Array(size);\nfor (var i = 0; i < size; i++) {\n\tdata[i] = 0x70e2; // Half float 10000\n}\nconst EMPTY_DATA_TEXTURE = new DataTexture(data, size, 1, LuminanceFormat, HalfFloatType);\n\nexport class TypedCopNode<K extends NodeParamsConfig> extends TypedNode<'TEXTURE', BaseCopNodeType, K> {\n\tcontainer_controller: TypedContainerController<TextureContainer> = new TypedContainerController<TextureContainer>(\n\t\tthis,\n\t\tTextureContainer\n\t);\n\tpublic readonly flags: FlagsControllerB = new FlagsControllerB(this);\n\t// private _typed_array = new Uint8ClampedArray(512 * 512 * 4);\n\t// protected _texture: Texture = new DataTexture(this._typed_array, 512, 512, RGBFormat);\n\t// get texture() {\n\t// \treturn this._data_texture;\n\t// }\n\n\tstatic node_context(): NodeContext {\n\t\treturn NodeContext.COP;\n\t}\n\tstatic displayed_input_names(): string[] {\n\t\treturn DEFAULT_INPUT_NAMES;\n\t}\n\n\tconstructor(scene: PolyScene) {\n\t\tsuper(scene, 'BaseCopNode');\n\t}\n\n\tinitialize_base_node() {\n\t\t// this.flags.add_bypass();\n\n\t\t// this.flags.add_display();\n\t\t// if (this.flags.display) {\n\t\t// \tthis.flags.display.set(false);\n\t\t// }\n\t\tthis.io.outputs.set_has_one_output();\n\t\t// this.container_controller.init(CONTAINER_CLASS);\n\t}\n\n\tset_texture(texture: Texture) {\n\t\t// this._copy_texture(texture);\n\t\ttexture.name = this.full_path();\n\t\tthis.set_container(texture);\n\t}\n\tclear_texture() {\n\t\tthis.set_container(EMPTY_DATA_TEXTURE);\n\t}\n\n\t// private _copy_texture(texture: Texture) {\n\t// \tconsole.log('_copy_texture', texture);\n\t// \tif (texture instanceof DataTexture) {\n\t// \t\tthis._data_texture.image = texture.image;\n\t// \t} else {\n\t// \t\tconst canvas = document.createElement('canvas');\n\t// \t\t// document.body.appendChild(canvas);\n\t// \t\tconst width = texture.image.width;\n\t// \t\tconst height = texture.image.height;\n\t// \t\tcanvas.width = width;\n\t// \t\tcanvas.height = height;\n\t// \t\tconst context = canvas.getContext('2d') as CanvasRenderingContext2D;\n\t// \t\tcontext.drawImage(texture.image, 0, 0);\n\t// \t\tconst image_data = context.getImageData(0, 0, width, height);\n\t// \t\tconsole.log(this._typed_array.length, image_data.data.length, image_data);\n\t// \t\tthis._data_texture.image = image_data;\n\t// \t}\n\t// \tthis._data_texture.format = texture.format;\n\t// \t// this._data_texture.mapping = texture.mapping;\n\t// \t// this._data_texture.wrapS = texture.wrapS;\n\t// \t// this._data_texture.wrapT = texture.wrapT;\n\t// \t// this._data_texture.minFilter = texture.minFilter;\n\t// \t// this._data_texture.magFilter = texture.magFilter;\n\t// \tthis._data_texture.needsUpdate = true;\n\t// \tconsole.log('updated data tex', this._data_texture);\n\n\t// \t// if (!this._texture || this._texture.uuid != texture.uuid) {\n\t// \t// \tif (!this._texture) {\n\t// \t// \t\tconsole.log('assign');\n\t// \t// \t\tthis._texture = texture.clone();\n\t// \t// \t\t// this._texture.name = this.full_path();\n\t// \t// \t} else {\n\t// \t// \t\tconsole.log('copy');\n\t// \t// \t\tconst keys = Object.keys(texture) as Array<keyof Texture>;\n\t// \t// \t\tconst protected_keys = ['uuid', 'name', 'node'];\n\t// \t// \t\tfor (let key of keys) {\n\t// \t// \t\t\tif (!protected_keys.includes(key)) {\n\t// \t// \t\t\t\tthis._texture[key] = texture[key] as never; // but why is 'never' needed?!\n\t// \t// \t\t\t}\n\t// \t// \t\t}\n\t// \t// \t}\n\t// \t// }\n\t// }\n}\n\nexport type BaseCopNodeType = TypedCopNode<any>;\nexport class BaseCopNodeClass extends TypedCopNode<any> {}\n","import {VideoTexture} from 'three/src/textures/VideoTexture';\nimport {\n\tUVMapping,\n\tCubeReflectionMapping,\n\tCubeRefractionMapping,\n\tEquirectangularReflectionMapping,\n\tEquirectangularRefractionMapping,\n\tSphericalReflectionMapping,\n\tCubeUVReflectionMapping,\n\tCubeUVRefractionMapping,\n\tClampToEdgeWrapping,\n\tRepeatWrapping,\n\tMirroredRepeatWrapping,\n\tLinearFilter,\n\tNearestFilter,\n\tNearestMipMapNearestFilter,\n\tNearestMipMapLinearFilter,\n\tLinearMipMapNearestFilter,\n\tLinearMipMapLinearFilter,\n\t// UnsignedByteType,\n\t// ByteType,\n\t// ShortType,\n\t// UnsignedShortType,\n\t// IntType,\n\t// UnsignedIntType,\n\t// FloatType,\n\t// HalfFloatType,\n\t// UnsignedShort4444Type,\n\t// UnsignedShort5551Type,\n\t// UnsignedShort565Type,\n\t// UnsignedInt248Type,\n\t// AlphaFormat,\n\t// RGBFormat,\n\t// RGBAFormat,\n\t// LuminanceFormat,\n\t// LuminanceAlphaFormat,\n\t// RGBEFormat,\n\t// DepthFormat,\n\t// DepthStencilFormat,\n\t// LinearEncoding,\n\t// sRGBEncoding,\n\t// GammaEncoding,\n\t// RGBEEncoding,\n\t// LogLuvEncoding,\n\t// RGBM7Encoding,\n\t// RGBM16Encoding,\n\t// RGBDEncoding,\n\t// BasicDepthPacking,\n\t// RGBADepthPacking,\n} from 'three/src/constants';\nimport {Texture} from 'three/src/textures/Texture';\n// const THREE = {\n// \tTexture,\n// \tUVMapping,\n// \tVideoTexture,\n// \tCubeReflectionMapping,\n// \tCubeRefractionMapping,\n// \tEquirectangularReflectionMapping,\n// \tEquirectangularRefractionMapping,\n// \tSphericalReflectionMapping,\n// \tCubeUVReflectionMapping,\n// \tCubeUVRefractionMapping,\n// \tClampToEdgeWrapping,\n// \tRepeatWrapping,\n// \tMirroredRepeatWrapping,\n// \tLinearFilter,\n// \tNearestFilter,\n// \tNearestMipMapNearestFilter,\n// \tNearestMipMapLinearFilter,\n// \tLinearMipMapNearestFilter,\n// \tLinearMipMapLinearFilter,\n// \tUnsignedByteType,\n// \tByteType,\n// \tShortType,\n// \tUnsignedShortType,\n// \tIntType,\n// \tUnsignedIntType,\n// \tFloatType,\n// \tHalfFloatType,\n// \tUnsignedShort4444Type,\n// \tUnsignedShort5551Type,\n// \tUnsignedShort565Type,\n// \tUnsignedInt248Type,\n// \tAlphaFormat,\n// \tRGBFormat,\n// \tRGBAFormat,\n// \tLuminanceFormat,\n// \tLuminanceAlphaFormat,\n// \tRGBEFormat,\n// \tDepthFormat,\n// \tDepthStencilFormat,\n// \tLinearEncoding,\n// \tsRGBEncoding,\n// \tGammaEncoding,\n// \tRGBEEncoding,\n// \tLogLuvEncoding,\n// \tRGBM7Encoding,\n// \tRGBM16Encoding,\n// \tRGBDEncoding,\n// \tBasicDepthPacking,\n// \tRGBADepthPacking,\n// };\n// import lodash_last from 'lodash/last';\n// import NodeBase from '../_Base'\n\nimport {TypedCopNode} from './_Base';\n// import {BaseParam} from 'src/Engine/Param/_Base'\nimport {CoreTextureLoader} from 'src/core/loader/Texture';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\n// this used to be named file_in, but I can't recall the decision of not calling it simply 'file'\n// so renaming it back to file for now\n\nconst MAPPINGS = [\n\t{UVMapping},\n\t{CubeReflectionMapping},\n\t{CubeRefractionMapping},\n\t{EquirectangularReflectionMapping},\n\t{EquirectangularRefractionMapping},\n\t{SphericalReflectionMapping},\n\t{CubeUVReflectionMapping},\n\t{CubeUVRefractionMapping},\n];\n\nconst WRAPPINGS: Dictionary<number>[] = [{ClampToEdgeWrapping}, {RepeatWrapping}, {MirroredRepeatWrapping}];\n\nconst MAG_FILTERS: Dictionary<number>[] = [{LinearFilter}, {NearestFilter}];\nconst MIN_FILTERS: Dictionary<number>[] = [\n\t{NearestFilter},\n\t{NearestMipMapNearestFilter},\n\t{NearestMipMapLinearFilter},\n\t{LinearFilter},\n\t{LinearMipMapNearestFilter},\n\t{LinearMipMapLinearFilter},\n];\n\n// const TYPES = [\n// \t\"UnsignedByteType\",\n// \t\"ByteType\",\n// \t\"ShortType\",\n// \t\"UnsignedShortType\",\n// \t\"IntType\",\n// \t\"UnsignedIntType\",\n// \t\"FloatType\",\n// \t\"HalfFloatType\",\n// \t\"UnsignedShort4444Type\",\n// \t\"UnsignedShort5551Type\",\n// \t\"UnsignedShort565Type\",\n// \t\"UnsignedInt248Type\"\n// ];\n\n// const FORMATS = [\n// \t\"AlphaFormat\",\n// \t\"RGBFormat\",\n// \t\"RGBAFormat\",\n// \t\"LuminanceFormat\",\n// \t\"LuminanceAlphaFormat\",\n// \t\"RGBEFormat\",\n// \t\"DepthFormat\",\n// \t\"DepthStencilFormat\"\n// ];\n\n// const ENCODINGS = [\n// \t\"LinearEncoding\",\n// \t\"sRGBEncoding\",\n// \t\"GammaEncoding\",\n// \t\"RGBEEncoding\",\n// \t\"LogLuvEncoding\",\n// \t\"RGBM7Encoding\",\n// \t\"RGBM16Encoding\",\n// \t\"RGBDEncoding\",\n// \t\"BasicDepthPacking\",\n// \t\"RGBADepthPacking\"\n// ];\n\ninterface AttribMapping {\n\tmapping: string;\n\twrapS: string;\n\twrapT: string;\n\tminFilter: string;\n\tmagFilter: string;\n}\nconst ATTRIB_MAPPING_KEYS: Array<keyof AttribMapping> = ['mapping', 'wrapS', 'wrapT', 'minFilter', 'magFilter'];\nconst ATTRIB_MAPPING: AttribMapping = {\n\tmapping: 'mapping',\n\twrapS: 'wrap_s',\n\twrapT: 'wrap_t',\n\tminFilter: 'min_filter',\n\tmagFilter: 'mag_filter',\n\t// type: 'type',\n\t// encoding: 'encoding'\n\t// format: 'format',\n};\n\nimport {BaseNodeType} from '../_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass FileCopParamsConfig extends NodeParamsConfig {\n\t// video_time = ParamConfig.FLOAT(1);\n\turl = ParamConfig.STRING(CoreTextureLoader.PARAM_DEFAULT, {\n\t\tdesktop_browse: {file_type: 'texture'},\n\t});\n\treload = ParamConfig.BUTTON(null, {\n\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\tFileCopNode.PARAM_CALLBACK_reload(node as FileCopNode, param);\n\t\t},\n\t});\n\tmapping = ParamConfig.INTEGER(UVMapping, {\n\t\tmenu: {\n\t\t\tentries: MAPPINGS.map((m) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: Object.keys(m)[0],\n\t\t\t\t\tvalue: Object.values(m)[0] as number,\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n\twrap_s = ParamConfig.INTEGER(Object.values(WRAPPINGS[0])[0], {\n\t\tmenu: {\n\t\t\t// type: 'radio',\n\t\t\tentries: WRAPPINGS.map((m) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: Object.keys(m)[0],\n\t\t\t\t\tvalue: Object.values(m)[0] as number,\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n\twrap_t = ParamConfig.INTEGER(Object.values(WRAPPINGS[0])[0], {\n\t\tmenu: {\n\t\t\t// type: 'radio',\n\t\t\tentries: WRAPPINGS.map((m) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: Object.keys(m)[0],\n\t\t\t\t\tvalue: Object.values(m)[0] as number,\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n\tmag_filter = ParamConfig.INTEGER(Object.values(MAG_FILTERS[0])[0], {\n\t\tmenu: {\n\t\t\t// type: 'radio',\n\t\t\tentries: MAG_FILTERS.map((m) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: Object.keys(m)[0],\n\t\t\t\t\tvalue: Object.values(m)[0] as number,\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n\tmin_filter = ParamConfig.INTEGER(Object.values(MIN_FILTERS[0])[0], {\n\t\tmenu: {\n\t\t\t// type: 'radio',\n\t\t\tentries: MIN_FILTERS.map((m) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: Object.keys(m)[0],\n\t\t\t\t\tvalue: Object.values(m)[0] as number,\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n}\n\nconst ParamsConfig = new FileCopParamsConfig();\n\nexport class FileCopNode extends TypedCopNode<FileCopParamsConfig> {\n\tparams_config = ParamsConfig;\n\t// @ParamF('video_time') _param_video_time: number;\n\t// @ParamS('url') _param_url: string;\n\tprivate _previous_param_url: string | undefined;\n\tprivate _video: HTMLVideoElement | undefined;\n\n\tstatic type() {\n\t\treturn 'file';\n\t}\n\n\t// _param_video_time_param: BaseParam\n\tprivate _texture_loader: CoreTextureLoader | undefined;\n\n\tstatic VIDEO_TIME_PARAM_NAME = 'video_time';\n\tstatic DEFAULT_NODE_PATH = {\n\t\tUV: '/COP/file_uv',\n\t\tENV_MAP: '/COP/env_map',\n\t};\n\n\t// initialize_node() {\n\t// \t// this.io.inputs.set_count_to_zero();\n\t// }\n\n\t// create_params() {\n\t// \t// this.add_param(ParamType.STRING, 'url', CoreTextureLoader.PARAM_DEFAULT, {\n\t// \t// \tdesktop_browse: {file_type: 'texture'},\n\t// \t// });\n\t// \t// this.add_param(ParamType.BUTTON, 'reload', null, {\n\t// \t// \tcallback: this._reload.bind(this),\n\t// \t// });\n\t// \t// this.add_param(ParamType.FLOAT, 'video_time', 0, {range: [0, 10]})\n\t// \t// this.add_param(ParamType.INTEGER, 'mapping', UVMapping as number, {\n\t// \t// \tmenu: {\n\t// \t// \t\tentries: MAPPINGS.map((m) => {\n\t// \t// \t\t\treturn {\n\t// \t// \t\t\t\tname: Object.keys(m)[0],\n\t// \t// \t\t\t\tvalue: Object.values(m)[0] as number,\n\t// \t// \t\t\t};\n\t// \t// \t\t}),\n\t// \t// \t},\n\t// \t// });\n\t// \t// for (let wrap_name of ['wrap_s', 'wrap_t']) {\n\t// \t// \tconst wrap = Object.values(WRAPPINGS[0])[0] as number;\n\t// \t// \tthis.add_param(ParamType.INTEGER, wrap_name, wrap, {\n\t// \t// \t\tmenu: {\n\t// \t// \t\t\t// type: 'radio',\n\t// \t// \t\t\tentries: WRAPPINGS.map((m) => {\n\t// \t// \t\t\t\treturn {\n\t// \t// \t\t\t\t\tname: Object.keys(m)[0],\n\t// \t// \t\t\t\t\tvalue: Object.values(m)[0] as number,\n\t// \t// \t\t\t\t};\n\t// \t// \t\t\t}),\n\t// \t// \t\t},\n\t// \t// \t});\n\t// \t// }\n\t// \t// const mag_filter = Object.values(MAG_FILTERS[0])[0] as number;\n\t// \t// this.add_param(ParamType.INTEGER, 'mag_filter', mag_filter, {\n\t// \t// \tmenu: {\n\t// \t// \t\t// type: 'radio',\n\t// \t// \t\tentries: MAG_FILTERS.map((m) => {\n\t// \t// \t\t\treturn {\n\t// \t// \t\t\t\tname: Object.keys(m)[0],\n\t// \t// \t\t\t\tvalue: Object.values(m)[0] as number,\n\t// \t// \t\t\t};\n\t// \t// \t\t}),\n\t// \t// \t},\n\t// \t// });\n\t// \t// const min_filter: number = Object.values(MIN_FILTERS[0])[0] as number;\n\t// \t// this.add_param(ParamType.INTEGER, 'min_filter', min_filter, {\n\t// \t// \tmenu: {\n\t// \t// \t\t// type: 'radio',\n\t// \t// \t\tentries: MIN_FILTERS.map((m) => {\n\t// \t// \t\t\treturn {\n\t// \t// \t\t\t\tname: Object.keys(m)[0],\n\t// \t// \t\t\t\tvalue: Object.values(m)[0] as number,\n\t// \t// \t\t\t};\n\t// \t// \t\t}),\n\t// \t// \t},\n\t// \t// });\n\t// \t// TODO: to be added when I have some level of control\n\t// \t// for now, the type attribute overrides what piz_compressed.exr creates\n\t// \t// which in turns fucks up with the env_map\n\t// \t// advanced\n\t// \t// this.add_param(ParamType.TOGGLE, 'advanced', 0)\n\t// \t// this.add_param(ParamType.INTEGER, 'type', THREE[TYPES[0]], {\n\t// \t// \tmenu: { type: 'radio', entries: TYPES.map(m=>{ return { name: m, value: THREE[m] } })},\n\t// \t// \tvisible_if: {advanced: 1}\n\t// \t// })\n\t// \t// this.add_param(ParamType.INTEGER, 'format', THREE[FORMATS[0]], {\n\t// \t// \tmenu: { type: 'radio', entries: FORMATS.map(m=>{ return { name: m, value: THREE[m] } })},\n\t// \t// \tvisible_if: {advanced: 1}\n\t// \t// })\n\t// \t// this.add_param(ParamType.INTEGER, 'encoding', THREE[ENCODINGS[0]], {\n\t// \t// \tmenu: { type: 'radio', entries: ENCODINGS.map(m=>{ return { name: m, value: THREE[m] } })},\n\t// \t// \tvisible_if: {advanced: 1}\n\t// \t// })\n\t// }\n\n\tasync cook() {\n\t\tif (this._is_static_image_url(this.pv.url)) {\n\t\t\tawait this.cook_for_image();\n\t\t} else {\n\t\t\tawait this.cook_for_video();\n\t\t}\n\t}\n\n\tprivate _is_static_image_url(url: string) {\n\t\treturn true;\n\t}\n\n\tprivate async cook_for_image() {\n\t\tconst texture = await this._load_texture(this.pv.url);\n\n\t\tif (texture) {\n\t\t\tthis._update_texture_params(texture);\n\t\t\tthis.set_texture(texture);\n\t\t} else {\n\t\t\tthis.clear_texture();\n\t\t}\n\t}\n\n\tprivate async cook_for_video() {\n\t\tif (this._param_url_changed()) {\n\t\t\tconst texture = await this._load_texture(this.pv.url);\n\t\t\t// if (texture) {\n\t\t\t// \tthis._texture = texture;\n\t\t\t// }\n\n\t\t\tif (texture) {\n\t\t\t\tthis._add_video_spare_params_if_required(texture);\n\t\t\t}\n\t\t\tthis._previous_param_url = this.pv.url;\n\n\t\t\tthis._set_video_current_time();\n\n\t\t\tif (texture) {\n\t\t\t\tthis._update_texture_params(texture);\n\t\t\t\tthis.set_texture(texture);\n\t\t\t} else {\n\t\t\t\tthis.cook_controller.end_cook();\n\t\t\t}\n\t\t} else {\n\t\t\t// this._set_video_current_time();\n\t\t\t// this._update_texture_params();\n\t\t\t// if (texture?.needsUpdate) {\n\t\t\t// \tthis.set_texture(texture);\n\t\t\t// } else {\n\t\t\t// \tthis.cook_controller.end_cook();\n\t\t\t// }\n\t\t}\n\t}\n\n\tresolved_url() {\n\t\treturn this.pv.url;\n\t}\n\n\tprivate _update_texture_params(texture: Texture) {\n\t\t// const keys = Object.keys(ATTRIB_MAPPING) as keyof AttribMapping\n\t\tfor (let texture_attrib of ATTRIB_MAPPING_KEYS) {\n\t\t\tconst param_name = ATTRIB_MAPPING[texture_attrib];\n\t\t\tconst param_value = this.params.float(param_name);\n\t\t\t// const texture_attrib = ATTRIB_MAPPING[attrib];\n\n\t\t\tif (param_value != null && texture) {\n\t\t\t\tif (texture[texture_attrib] != param_value) {\n\t\t\t\t\ttexture[texture_attrib] = param_value;\n\t\t\t\t\ttexture.needsUpdate = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tstatic PARAM_CALLBACK_reload(node: FileCopNode, param: BaseParamType) {\n\t\tnode.param_callback_reload();\n\t}\n\tprivate param_callback_reload() {\n\t\tthis._previous_param_url = undefined;\n\n\t\t// set the param dirty is preferable, in case this is used to refresh a local asset\n\t\tthis.p.url.set_successors_dirty();\n\t\t// this.set_dirty()\n\t}\n\n\tprivate _set_video_current_time() {\n\t\tif (this._video) {\n\t\t\tif (this.params.has('video_time')) {\n\t\t\t\tthis._video.currentTime = this.params.float('video_time');\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _add_video_spare_params_if_required(texture: Texture | VideoTexture | null) {\n\t\tif (texture) {\n\t\t\tconst is_video = texture.constructor == VideoTexture;\n\t\t\tif (is_video) {\n\t\t\t\tthis._video = texture.image;\n\t\t\t\tif (this._video) {\n\t\t\t\t\tif (!this.params.has_param(FileCopNode.VIDEO_TIME_PARAM_NAME)) {\n\t\t\t\t\t\tconst duration = this._video.duration;\n\n\t\t\t\t\t\tthis.add_param(ParamType.FLOAT, FileCopNode.VIDEO_TIME_PARAM_NAME, '$T', {\n\t\t\t\t\t\t\tspare: true,\n\t\t\t\t\t\t\tcook: true,\n\t\t\t\t\t\t\trange: [0, duration],\n\t\t\t\t\t\t\trange_locked: [true, true],\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.emit(NodeEvent.PARAMS_UPDATED);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._remove_spare_params();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._remove_spare_params();\n\t\t}\n\t}\n\n\tprivate _remove_spare_params() {\n\t\tif (this.params.has_param(FileCopNode.VIDEO_TIME_PARAM_NAME)) {\n\t\t\tthis.params.delete_param(FileCopNode.VIDEO_TIME_PARAM_NAME);\n\t\t\tthis.emit(NodeEvent.PARAMS_UPDATED);\n\t\t}\n\t}\n\n\tprivate _param_url_changed(): boolean {\n\t\treturn this._previous_param_url != this.pv.url;\n\t}\n\n\tprivate async _load_texture(url: string) {\n\t\tlet texture: Texture | VideoTexture | null = null;\n\t\tconst param = this.params.get('url');\n\t\tif (url && param) {\n\t\t\tthis._texture_loader = this._texture_loader || new CoreTextureLoader(this, param);\n\t\t\t// const ext = lodash_last(url.split('.')).toLowerCase()\n\t\t\ttry {\n\t\t\t\ttexture = await this._texture_loader.load_texture_from_url_or_op(url);\n\t\t\t} catch (e) {\n\t\t\t\t//console.log('FAIL');\n\t\t\t}\n\t\t\t// if(texture){\n\t\t\t// \tcallback(texture)\n\t\t\t// } else {\n\t\t\tif (!texture) {\n\t\t\t\tthis.states.error.set(`could not load texture '${url}'`);\n\t\t\t}\n\t\t\t// }).catch(error=>{\n\t\t\t// \tthis.self.set_error(`could not load texture ${url} (${error})`);\n\t\t\t// })\n\t\t} else {\n\t\t\tthis.states.error.set('not url given to Mat/Base._load_texture');\n\t\t}\n\t\treturn texture;\n\t}\n}\n","import {BaseGlNodeType} from '../_Base';\nimport {TypedGLDefinitionCollection} from './GLDefinitionCollection';\nimport {ConnectionPointType} from '../../utils/connections/ConnectionPointType';\n\nexport enum GLDefinitionType {\n\tATTRIBUTE = 'attribute',\n\tFUNCTION = 'function',\n\tUNIFORM = 'uniform',\n\tVARYING = 'varying',\n}\n\nexport abstract class TypedGLDefinition<T extends GLDefinitionType> {\n\t// constructor(protected _node: BaseGlNodeType, protected _name: string) {}\n\tconstructor(\n\t\tprotected _definition_type: T,\n\t\tprotected _data_type: ConnectionPointType,\n\t\tprotected _node: BaseGlNodeType,\n\t\tprotected _name: string\n\t) {\n\t\t// super(_node, _name);\n\t}\n\n\tget definition_type() {\n\t\treturn this._definition_type;\n\t}\n\tget data_type() {\n\t\treturn this._data_type;\n\t}\n\tget node() {\n\t\treturn this._node;\n\t}\n\tget name() {\n\t\treturn this._name;\n\t}\n\t// get id() {\n\t// \treturn this._data_type;\n\t// }\n\n\tabstract get line(): string;\n\tcollection_instance() {\n\t\treturn new TypedGLDefinitionCollection<T>();\n\t}\n}\n\nexport class AttributeGLDefinition extends TypedGLDefinition<GLDefinitionType.ATTRIBUTE> {\n\tconstructor(protected _node: BaseGlNodeType, protected _data_type: ConnectionPointType, protected _name: string) {\n\t\tsuper(GLDefinitionType.ATTRIBUTE, _data_type, _node, _name);\n\t}\n\tget line() {\n\t\treturn `attribute ${this.data_type} ${this.name}`;\n\t}\n}\n\nexport class FunctionGLDefinition extends TypedGLDefinition<GLDefinitionType.FUNCTION> {\n\tconstructor(protected _node: BaseGlNodeType, protected _data_type: ConnectionPointType, protected _name: string) {\n\t\tsuper(GLDefinitionType.FUNCTION, _data_type, _node, _name);\n\t}\n\tget line() {\n\t\treturn this.name;\n\t}\n}\n\nexport class UniformGLDefinition extends TypedGLDefinition<GLDefinitionType.UNIFORM> {\n\tconstructor(protected _node: BaseGlNodeType, protected _data_type: ConnectionPointType, protected _name: string) {\n\t\tsuper(GLDefinitionType.UNIFORM, _data_type, _node, _name);\n\t}\n\tget line() {\n\t\treturn `uniform ${this.data_type} ${this.name}`;\n\t}\n}\n\nexport class VaryingGLDefinition extends TypedGLDefinition<GLDefinitionType.VARYING> {\n\tconstructor(protected _node: BaseGlNodeType, protected _data_type: ConnectionPointType, protected _name: string) {\n\t\tsuper(GLDefinitionType.VARYING, _data_type, _node, _name);\n\t}\n\tget line() {\n\t\treturn `varying ${this.data_type} ${this.name}`;\n\t}\n}\nexport type BaseGLDefinition = TypedGLDefinition<GLDefinitionType>;\n","import {BaseController} from './_BaseController';\nimport {TypedMatNode} from '../_Base';\n\nimport {VertexColors} from 'three/src/constants';\nimport {NoColors} from 'three/src/constants';\nimport {Material} from 'three/src/materials/Material';\nimport {Color} from 'three/src/math/Color';\n// import {Material} from 'three/src/materials/Material';\n// import {IUniform} from 'three/src/renderers/shaders/UniformsLib';\n// import {Color} from 'three/src/math/Color';\n// import {MeshBasicMaterial} from 'three/src/materials/MeshBasicMaterial';\n\n// interface AddParamsOptions {\n// \tflat_shading?: boolean;\n// }\n\n// interface MaterialWithUniforms extends Material {\n// \tcolor: Color;\n// \tuniforms: {\n// \t\tdiffuse: IUniform;\n// \t\topacity: IUniform;\n// \t\tuse_fog: IUniform;\n// \t};\n// }\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\n\nexport function ColorParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tcolor = ParamConfig.COLOR([1, 1, 1]);\n\t\tuse_vertex_colors = ParamConfig.BOOLEAN(0);\n\t\ttransparent = ParamConfig.BOOLEAN(0);\n\t\topacity = ParamConfig.FLOAT(1);\n\t\talpha_test = ParamConfig.FLOAT(0);\n\t\tuse_fog = ParamConfig.BOOLEAN(0);\n\t};\n}\n\nclass ColoredMaterial extends Material {\n\tpublic color!: Color;\n\tvertexColors!: number;\n\ttransparent!: boolean;\n\tdepthTest!: boolean;\n\talphaTest!: number;\n\tfog!: boolean;\n}\nclass ColorParamsConfig extends ColorParamConfig(NodeParamsConfig) {}\nclass ColoredMatNode extends TypedMatNode<ColoredMaterial, ColorParamsConfig> {\n\tcreate_material() {\n\t\treturn new ColoredMaterial();\n\t}\n}\n\nexport class ColorsController extends BaseController {\n\t// add_params(options: AddParamsOptions = {}) {\n\t// \t// this.node.add_param(ParamType.COLOR, 'color', [1, 1, 1]);\n\t// \t// this.node.add_param(ParamType.BOOLEAN, 'use_vertex_colors', 0);\n\t// \t// if (options['flat_shading'] != false) {\n\t// \t// \t// for points\n\t// \t// \tthis.node.add_param(ParamType.BOOLEAN, 'flat_shading', 0);\n\t// \t// }\n\t// \t// this.node.add_param(ParamType.BOOLEAN, 'transparent', 0);\n\t// \t// this.node.add_param(ParamType.FLOAT, 'opacity', 1);\n\t// \t// this.node.add_param(ParamType.FLOAT, 'alpha_test', 0);\n\t// \t// if (this.__fog_used_in_uniforms()) {\n\t// \t// \tthis.node.add_param(ParamType.BOOLEAN, 'use_fog', 1);\n\t// \t// }\n\t// }\n\n\tstatic update(node: ColoredMatNode) {\n\t\tconst material = node.material;\n\t\tconst pv = node.pv;\n\t\tmaterial.color.copy(pv.color);\n\t\tmaterial.vertexColors = pv.use_vertex_colors ? VertexColors : NoColors;\n\n\t\tmaterial.opacity = pv.opacity;\n\t\tmaterial.transparent = pv.transparent || pv.opacity < 1;\n\t\tif (material.transparent) {\n\t\t\tmaterial.depthTest = true;\n\t\t}\n\t\tmaterial.alphaTest = pv.alpha_test;\n\t\tmaterial.fog = pv.use_fog;\n\t}\n\n\t// update() {\n\t// \tif (this.__has_uniforms()) {\n\t// \t\tthis.material.uniforms.diffuse.value = this._param_color;\n\t// \t} else {\n\t// \t\tthis.material.color = this._param_color;\n\t// \t\tthis.material.flatShading = this._param_flat_shading;\n\t// \t}\n\n\t// \tif (this.__has_uniforms()) {\n\t// \t\tthis.material.uniforms.opacity.value = this._param_opacity;\n\t// \t} else {\n\t// \t\tthis.material.opacity = this._param_opacity;\n\t// \t}\n\t// \tthis.material.transparent = this._param_transparent || this.material.opacity < 1;\n\t// \tif (this.material.transparent) {\n\t// \t\tthis.material.depthTest = true;\n\t// \t}\n\t// \tthis.material.alphaTest = this._param_alpha_test;\n\n\t// \tthis.set_user_vertex_colors(this.material, this._param_use_vertex_colors);\n\n\t// \tif (this.__fog_used_in_uniforms()) {\n\t// \t\tthis.material.fog = this._param_use_fog;\n\t// \t}\n\t// }\n\n\t// get material() {\n\t// \treturn this.node.material as MaterialWithUniforms;\n\t// }\n\t// get _param_color() {\n\t// \treturn this.node.params.color('color');\n\t// }\n\t// get _param_flat_shading() {\n\t// \treturn this.node.params.boolean('flat_shading');\n\t// }\n\t// get _param_opacity() {\n\t// \treturn this.node.params.float('opacity');\n\t// }\n\t// get _param_transparent() {\n\t// \treturn this.node.params.boolean('transparent');\n\t// }\n\t// get _param_alpha_test() {\n\t// \treturn this.node.params.float('alpha_test');\n\t// }\n\t// get _param_use_vertex_colors() {\n\t// \treturn this.node.params.boolean('use_vertex_colors');\n\t// }\n\t// get _param_use_fog() {\n\t// \treturn this.node.params.boolean('use_fog');\n\t// }\n\n\t// protected __has_uniforms(): boolean {\n\t// \treturn this.material && this.material.uniforms != null;\n\t// }\n\t// protected __fog_used_in_uniforms(): boolean {\n\t// \treturn this.material && (this.material.uniforms == null || this.material.uniforms.use_fog != null);\n\t// }\n\n\t// private set_user_vertex_colors(material: Material, use_vertex_colors: boolean) {\n\t// \tmaterial.vertexColors = use_vertex_colors ? VertexColors : NoColors;\n\t// \tif (this.__has_uniforms()) {\n\t// \t\tmaterial.needsUpdate = true;\n\t// \t}\n\t// }\n}\n","import {BaseController} from './_BaseController';\n\nimport {FrontSide} from 'three/src/constants';\nimport {DoubleSide} from 'three/src/constants';\nimport {BackSide} from 'three/src/constants';\nimport {Material} from 'three/src/materials/Material';\nimport {TypedMatNode} from '../_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nexport function SideParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tdouble_sided = ParamConfig.BOOLEAN(0);\n\t\tfront = ParamConfig.BOOLEAN(1, {visible_if: {double_sided: false}});\n\t};\n}\n\nclass SidedMaterial extends Material {\n\tside!: number;\n}\nclass SideParamsConfig extends SideParamConfig(NodeParamsConfig) {}\nclass SideMatNode extends TypedMatNode<SidedMaterial, SideParamsConfig> {\n\tcreate_material() {\n\t\treturn new SidedMaterial();\n\t}\n}\n\nexport class SideController extends BaseController {\n\t// add_params() {\n\t// \tthis.node.add_param(ParamType.BOOLEAN, 'double_sided', 0);\n\t// \tthis.node.add_param(ParamType.BOOLEAN, 'front', 1, {visible_if: {double_sided: false}});\n\t// }\n\n\tstatic update(node: SideMatNode) {\n\t\tconst prev = node.material.side;\n\t\tconst single_side = node.pv.front ? FrontSide : BackSide;\n\t\tnode.material.side = node.pv.double_sided ? DoubleSide : single_side;\n\t\tif (prev != node.material.side) {\n\t\t\tnode.material.needsUpdate = true;\n\t\t}\n\t}\n\n\t// update() {\n\t// \tthis.material.side = this._param_double_sided ? DoubleSide : this._param_front ? FrontSide : BackSide;\n\t// }\n\n\t// get _param_front() {\n\t// \treturn this.node.params.boolean('front');\n\t// }\n\t// get _param_double_sided() {\n\t// \treturn this.node.params.boolean('double_sided');\n\t// }\n}\n","import {BaseGlShaderAssembler} from './_Base';\n\nimport {ThreeToGl} from 'src/core/ThreeToGl';\nimport {OutputGlNode} from '../../Output';\nimport {AttributeGlNode} from '../../Attribute';\nimport {ShaderName} from '../../../utils/shaders/ShaderName';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\nimport {GlobalsGlNode} from '../../Globals';\nimport {BaseGLDefinition, UniformGLDefinition} from '../../utils/GLDefinition';\nimport {ConnectionPointType} from '../../../utils/connections/ConnectionPointType';\nimport {MapUtils} from 'src/core/MapUtils';\nimport {ShaderMaterialWithCustomMaterials} from 'src/core/geometry/Material';\nimport {ShadersCollectionController} from '../utils/ShadersCollectionController';\n// import {BaseNodeType} from '../../_Base';\n// import {GlobalsGeometryHandler} from './Globals/Geometry'\n\nexport enum CustomMaterialName {\n\tDISTANCE = 'customDistanceMaterial',\n\tDEPTH = 'customDepthMaterial',\n\tDEPTH_DOF = 'customDepthDOFMaterial',\n}\n// export type ShaderAssemblerRenderDerivated = {new (node: BaseNodeType): ShaderAssemblerRender};\n// type ShaderAssemblerRenderDerivatedClass = new (...args: any[]) => ShaderAssemblerRender;\nexport type CustomAssemblerMap = Map<CustomMaterialName, typeof ShaderAssemblerRender>;\n\nexport class ShaderAssemblerRender extends BaseGlShaderAssembler {\n\tprivate _assemblers_by_custom_name: Map<CustomMaterialName, ShaderAssemblerRender> = new Map();\n\n\tcustom_assembler_class_by_custom_name(): CustomAssemblerMap | undefined {\n\t\treturn undefined;\n\t}\n\n\tasync compile_custom_materials(material: ShaderMaterialWithCustomMaterials): Promise<void> {\n\t\t// const custom_materials_by_name: Map<CustomMaterialName, ShaderMaterial> = new Map();\n\t\t// this._assemblers_by_custom_name.clear();\n\n\t\tconst class_by_custom_name = this.custom_assembler_class_by_custom_name();\n\t\tif (class_by_custom_name) {\n\t\t\tclass_by_custom_name.forEach(\n\t\t\t\tasync (assembler_class: typeof ShaderAssemblerRender, custom_name: CustomMaterialName) => {\n\t\t\t\t\tif (this._code_builder) {\n\t\t\t\t\t\tlet assembler: ShaderAssemblerRender | undefined = this._assemblers_by_custom_name.get(\n\t\t\t\t\t\t\tcustom_name\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (!assembler) {\n\t\t\t\t\t\t\tassembler = new assembler_class(this._gl_parent_node);\n\t\t\t\t\t\t\tthis._assemblers_by_custom_name.set(custom_name, assembler);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tassembler.set_root_nodes(this._root_nodes);\n\t\t\t\t\t\tassembler.set_param_configs_owner(this._code_builder);\n\t\t\t\t\t\tassembler.set_shader_configs(this.shader_configs);\n\t\t\t\t\t\tassembler.set_variable_configs(this.variable_configs());\n\n\t\t\t\t\t\tconst custom_material = material.custom_materials[custom_name];\n\t\t\t\t\t\tif (custom_material) {\n\t\t\t\t\t\t\tawait assembler.compile_material(custom_material);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// if (material) {\n\t\t\t\t\t\t// \t// add needsUpdate = true, as we always get the same material\n\t\t\t\t\t\t// \t// material.needsUpdate = true;\n\t\t\t\t\t\t// \tcustom_materials_by_name.set(custom_name, material);\n\t\t\t\t\t\t// }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\t// for (let custom_name of Object.keys(class_by_custom_name)) {\n\t\t// \tconst assembler_class = class_by_custom_name[custom_name];\n\t\t// \t// const assembler = new assembler_class(this._gl_parent_node)\n\n\t\t// }\n\n\t\t// return custom_materials_by_name;\n\t}\n\tasync compile_material(material: ShaderMaterial) {}\n\n\tshadow_assembler_class_by_custom_name() {\n\t\treturn {};\n\t}\n\n\tadd_output_body_line(\n\t\toutput_node: OutputGlNode,\n\t\tshaders_collection_controller: ShadersCollectionController,\n\t\tinput_name: string\n\t) {\n\t\tconst input = output_node.io.inputs.named_input(input_name);\n\t\tconst var_input = output_node.variable_for_input(input_name);\n\t\tconst variable_config = this.variable_config(input_name);\n\n\t\tlet new_var: string | null = null;\n\t\tif (input) {\n\t\t\tnew_var = ThreeToGl.vector3(var_input);\n\t\t} else {\n\t\t\tif (variable_config.default_from_attribute()) {\n\t\t\t\tconst connection_point = output_node.io.inputs.named_input_connection_points_by_name(input_name);\n\t\t\t\tif (connection_point) {\n\t\t\t\t\tconst gl_type = connection_point.type;\n\t\t\t\t\tconst attr_read = this.globals_handler?.read_attribute(\n\t\t\t\t\t\toutput_node,\n\t\t\t\t\t\tgl_type,\n\t\t\t\t\t\tinput_name,\n\t\t\t\t\t\tshaders_collection_controller\n\t\t\t\t\t);\n\t\t\t\t\tif (attr_read) {\n\t\t\t\t\t\tnew_var = attr_read;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst variable_config_default = variable_config.default();\n\t\t\t\tif (variable_config_default) {\n\t\t\t\t\tnew_var = variable_config_default;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// const default_value = variable_config.default()\n\t\t\t// new_var = default_value\n\t\t\t// const definition_configs = variable_config.required_definitions() || []\n\t\t\t// for(let definition_config of definition_configs){\n\t\t\t// \tconst definition = definition_config.create_definition(output_node)\n\t\t\t// \toutput_node.add_definitions([definition])\n\t\t\t// }\n\t\t}\n\t\tif (new_var) {\n\t\t\tconst prefix = variable_config.prefix();\n\t\t\tconst suffix = variable_config.suffix();\n\t\t\tconst if_condition = variable_config.if_condition();\n\t\t\tif (if_condition) {\n\t\t\t\tshaders_collection_controller.add_body_lines(output_node, [`#if ${if_condition}`]);\n\t\t\t}\n\t\t\tshaders_collection_controller.add_body_lines(output_node, [`${prefix}${new_var}${suffix}`]);\n\t\t\tif (if_condition) {\n\t\t\t\tshaders_collection_controller.add_body_lines(output_node, [`#endif`]);\n\t\t\t}\n\t\t}\n\t}\n\n\tset_node_lines_output(output_node: OutputGlNode, shaders_collection_controller: ShadersCollectionController) {\n\t\t// const body_lines = [];\n\t\tconst shader_name = shaders_collection_controller.current_shader_name;\n\t\tconst input_names = this.shader_config(shader_name)?.input_names();\n\t\tif (input_names) {\n\t\t\t// shaders_collection_controller.set_body_lines([], shader_name);\n\t\t\tfor (let input_name of input_names) {\n\t\t\t\tthis.add_output_body_line(output_node, shaders_collection_controller, input_name);\n\t\t\t}\n\t\t}\n\t}\n\tset_node_lines_attribute(\n\t\tattribute_node: AttributeGlNode,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {\n\t\t// const named_output = attribute_node.connected_output()\n\t\t// const named_connection = attribute_node.connected_input()\n\t\tconst gl_type = attribute_node.gl_type();\n\t\tconst new_var = this.globals_handler?.read_attribute(\n\t\t\tattribute_node,\n\t\t\tgl_type,\n\t\t\tattribute_node.attribute_name,\n\t\t\tshaders_collection_controller\n\t\t);\n\t\tconst var_name = attribute_node.gl_var_name(attribute_node.output_name);\n\t\tshaders_collection_controller.add_body_lines(attribute_node, [`${gl_type} ${var_name} = ${new_var}`]);\n\t\t// this.add_output_body_line(\n\t\t// \tattribute_node,\n\t\t// \tshader_name,\n\t\t// \tinput_name\n\t\t// \t)\n\n\t\t// const vertex_definitions = []\n\t\t// const vertex_body_lines = []\n\t\t// const fragment_definitions = []\n\n\t\t// const named_output = attribute_node.named_outputs()[0]\n\t\t// const gl_type = named_output.type()\n\t\t// const var_name = attribute_node.gl_var_name(named_output.name())\n\n\t\t// const attribute_name = attribute_node.attribute_name()\n\t\t// // TODO: I should probably raise an error in the node\n\t\t// // maybe when doint the initial eval of all nodes and check for errors?\n\t\t// if(!attribute_name){\n\t\t// \tconsole.error(attribute_node.full_path())\n\t\t// \tthrow new Error(\"empty attr name\")\n\t\t// }\n\t\t// if(GlobalsGeometryHandler.PRE_DEFINED_ATTRIBUTES.indexOf(attribute_name) < 0){\n\t\t// \tvertex_definitions.push(new Definition.Attribute(attribute_node, gl_type, attribute_name))\n\t\t// }\n\t\t// vertex_definitions.push(new Definition.Varying(attribute_node, gl_type, var_name))\n\t\t// vertex_body_lines.push( `${var_name} = ${attribute_name}` )\n\t\t// fragment_definitions.push(new Definition.Varying(attribute_node, gl_type, var_name))\n\n\t\t// attribute_node.set_definitions(vertex_definitions, 'vertex')\n\t\t// attribute_node.set_definitions(fragment_definitions, 'fragment')\n\t\t// attribute_node.add_body_lines(vertex_body_lines, 'vertex')\n\t}\n\n\thandle_gl_FragCoord(body_lines: string[], shader_name: ShaderName, var_name: string) {\n\t\tif (shader_name == ShaderName.FRAGMENT) {\n\t\t\tbody_lines.push(`vec4 ${var_name} = gl_FragCoord`);\n\t\t}\n\t}\n\thandle_resolution(body_lines: string[], shader_name: ShaderName, var_name: string) {\n\t\tif (shader_name == ShaderName.FRAGMENT) {\n\t\t\tbody_lines.push(`vec2 ${var_name} = resolution`);\n\t\t}\n\t}\n\n\tset_node_lines_globals(globals_node: GlobalsGlNode, shaders_collection_controller: ShadersCollectionController) {\n\t\t// const vertex_definitions = [];\n\t\t// const fragment_definitions = [];\n\t\t// const definitions = [];\n\t\t// const vertex_body_lines = []\n\t\t// const fragment_body_lines = [];\n\t\tconst body_lines = [];\n\t\tconst shader_name = shaders_collection_controller.current_shader_name;\n\t\tconst shader_config = this.shader_config(shader_name);\n\t\tif (!shader_config) {\n\t\t\treturn;\n\t\t}\n\t\tconst dependencies = shader_config.dependencies();\n\n\t\tconst definitions_by_shader_name: Map<ShaderName, BaseGLDefinition[]> = new Map();\n\t\t// definitions_by_shader_nameshader_name] = [];\n\t\t// for (let dependency of dependencies) {\n\t\t// \tdefinitions_by_shader_name[dependency] = [];\n\t\t// }\n\n\t\tconst body_lines_by_shader_name: Map<ShaderName, string[]> = new Map();\n\t\t// body_lines_by_shader_name[shader_name] = [];\n\t\t// for (let dependency of dependencies) {\n\t\t// \tbody_lines_by_shader_name[dependency] = [];\n\t\t// }\n\n\t\tlet definition;\n\t\tlet body_line;\n\t\tfor (let output_name of globals_node.io.outputs.used_output_names()) {\n\t\t\tconst var_name = globals_node.gl_var_name(output_name);\n\t\t\tconst globals_shader_name = shaders_collection_controller.current_shader_name;\n\n\t\t\tswitch (output_name) {\n\t\t\t\tcase 'frame':\n\t\t\t\t\tdefinition = new UniformGLDefinition(globals_node, ConnectionPointType.FLOAT, output_name);\n\t\t\t\t\tif (globals_shader_name) {\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(definitions_by_shader_name, globals_shader_name, definition);\n\t\t\t\t\t}\n\n\t\t\t\t\tbody_line = `float ${var_name} = ${output_name}`;\n\t\t\t\t\tfor (let dependency of dependencies) {\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(definitions_by_shader_name, dependency, definition);\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(body_lines_by_shader_name, dependency, body_line);\n\t\t\t\t\t}\n\n\t\t\t\t\t// vertex_body_lines.push(`float ${var_name} = ${output_name}`)\n\t\t\t\t\tbody_lines.push(body_line);\n\t\t\t\t\tthis.set_frame_dependent();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'gl_FragCoord':\n\t\t\t\t\tthis.handle_gl_FragCoord(body_lines, shader_name, var_name);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'resolution':\n\t\t\t\t\tthis.handle_resolution(body_lines, shader_name, var_name);\n\t\t\t\t\tdefinition = new UniformGLDefinition(globals_node, ConnectionPointType.VEC2, output_name);\n\t\t\t\t\tif (globals_shader_name) {\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(definitions_by_shader_name, globals_shader_name, definition);\n\t\t\t\t\t}\n\t\t\t\t\tfor (let dependency of dependencies) {\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(definitions_by_shader_name, dependency, definition);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.set_resolution_dependent();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'gl_PointCoord':\n\t\t\t\t\tif (shader_name == ShaderName.FRAGMENT) {\n\t\t\t\t\t\tbody_lines.push(`vec2 ${var_name} = gl_PointCoord`);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t// const named_output = globals_node.named_output_by_name(output_name)\n\t\t\t\t\t// const gl_type = named_output.gl_type()\n\t\t\t\t\t// const new_var = this.globals_handler().read_attribute(\n\t\t\t\t\t// \tglobals_node,\n\t\t\t\t\t// \tgl_type,\n\t\t\t\t\t// \toutput_name\n\t\t\t\t\t// )\n\t\t\t\t\t// const body_line = `${var_name} = ${new_var}`\n\t\t\t\t\t// globals_node.add_body_lines([body_line])\n\t\t\t\t\tthis.globals_handler?.handle_globals_node(\n\t\t\t\t\t\tglobals_node,\n\t\t\t\t\t\toutput_name,\n\t\t\t\t\t\tshaders_collection_controller\n\t\t\t\t\t\t// definitions_by_shader_name,\n\t\t\t\t\t\t// body_lines_by_shader_name,\n\t\t\t\t\t\t// body_lines,\n\t\t\t\t\t\t// dependencies,\n\t\t\t\t\t\t// shader_name\n\t\t\t\t\t);\n\t\t\t\t// const named_output = globals_node.named_output_by_name(output_name)\n\t\t\t\t// const gl_type = named_output.gl_type()\n\t\t\t\t// definition = new Definition.Varying(globals_node, gl_type, var_name)\n\t\t\t\t// definitions_by_shader_name[shader_name].push(definition)\n\t\t\t\t// throw \"debug\"\n\n\t\t\t\t// body_line = `${var_name} = vec3(${output_name})`\n\t\t\t\t// for(let dependency of dependencies){\n\t\t\t\t// \tdefinitions_by_shader_name[dependency].push(definition)\n\t\t\t\t// \tbody_lines_by_shader_name[dependency].push(body_line)\n\t\t\t\t// }\n\t\t\t\t// if(dependencies.length == 0){\n\t\t\t\t// \tbody_lines.push(body_line)\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\t\t// this.set_vertex_definitions(vertex_definitions)\n\t\t// this.set_fragment_definitions(fragment_definitions)\n\t\tdefinitions_by_shader_name.forEach((definitions, shader_name) => {\n\t\t\tshaders_collection_controller.add_definitions(globals_node, definitions, shader_name);\n\t\t});\n\t\tbody_lines_by_shader_name.forEach((body_lines, shader_name) => {\n\t\t\tshaders_collection_controller.add_body_lines(globals_node, body_lines, shader_name);\n\t\t});\n\t\t// this.add_definitions(definitions)\n\t\t// this.set_vertex_body_lines(vertex_body_lines)\n\t\t// this.set_fragment_body_lines(fragment_body_lines)\n\n\t\tshaders_collection_controller.add_body_lines(globals_node, body_lines);\n\t}\n}\n","export class MapUtils {\n\tstatic push_on_array_at_entry<K, V>(map: Map<K, V[]>, key: K, new_element: V) {\n\t\tlet has_entry = map.has(key);\n\t\tif (has_entry) {\n\t\t\tmap.get(key)!.push(new_element);\n\t\t} else {\n\t\t\tmap.set(key, [new_element]);\n\t\t}\n\t}\n\tstatic unshift_on_array_at_entry<K, V>(map: Map<K, V[]>, key: K, new_element: V) {\n\t\tlet has_entry = map.has(key);\n\t\tif (has_entry) {\n\t\t\tmap.get(key)!.unshift(new_element);\n\t\t} else {\n\t\t\tmap.set(key, [new_element]);\n\t\t}\n\t}\n\tstatic concat_on_array_at_entry<K, V>(map: Map<K, V[]>, key: K, new_elements: V[]) {\n\t\tlet has_entry = map.has(key);\n\t\tif (has_entry) {\n\t\t\tlet array: V[] = map.get(key)!;\n\t\t\tfor (let element of new_elements) {\n\t\t\t\tarray.push(element);\n\t\t\t}\n\t\t} else {\n\t\t\tmap.set(key, new_elements);\n\t\t}\n\t}\n}\n","import {HistoryStack} from '../Stack';\n\nexport abstract class BaseCommand {\n\tpush() {\n\t\tHistoryStack.instance().push_command(this);\n\t}\n\n\tabstract do(): void;\n\tabstract undo(): void;\n}\n","import lodash_isString from 'lodash/isString';\n// import lodash_isNumber from 'lodash/isNumber';\n// import lodash_isBoolean from 'lodash/isBoolean';\n// import {TypedParamVisitor} from './_Base';\nimport {TypedParam} from './_Base';\nimport {ParamType} from '../poly/ParamType';\n// import {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\nimport {ExpressionController} from './utils/ExpressionController';\nimport {ParamEvent} from '../poly/ParamEvent';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\n// import {ParamEvent} from '../poly/ParamEvent';\n// import {ParamInitValuesTypeMap} from '../nodes/utils/params/ParamsController';\n\n// interface NumericParamVisitor extends TypedParamVisitor {\n// \tvisit_numeric_param: (param: TypedNumericParam<any>) => any;\n// }\n\nexport abstract class TypedNumericParam<T extends ParamType> extends TypedParam<T> {\n\t// private _raw_input: ParamInitValuesTypeMap[T] | undefined;\n\tget is_numeric() {\n\t\treturn true;\n\t}\n\tget is_default(): boolean {\n\t\treturn this._raw_input == this.default_value;\n\t}\n\n\t// accepts_visitor(visitor: NumericParamVisitor): any {\n\t// \treturn visitor.visit_numeric_param(this);\n\t// }\n\t// init_expression() {\n\t// \tif (this.is_value_expression(this._default_value)) {\n\t// \t\treturn this.set_expression(this._default_value)\n\t// \t}\n\t// }\n\n\tprotected process_raw_input() {\n\t\t// this.process_raw_input()\n\t\t// if (this.parent_param) {\n\t\t// \tthis.parent_param.set_raw_input_from_components();\n\t\t// }\n\n\t\tthis.states.error.clear();\n\n\t\tconst converted = this.convert(this._raw_input);\n\t\tif (converted != null) {\n\t\t\tif (this._expression_controller) {\n\t\t\t\tthis._expression_controller.set_expression(undefined, false);\n\t\t\t\tthis.emit_controller.emit(ParamEvent.EXPRESSION_UPDATED); // ensure expression is considered removed\n\t\t\t}\n\t\t\tif (converted != this._value) {\n\t\t\t\tthis._update_value(converted);\n\t\t\t\tthis.set_successors_dirty(this);\n\t\t\t}\n\t\t} else {\n\t\t\tif (lodash_isString(this._raw_input)) {\n\t\t\t\tthis._expression_controller = this._expression_controller || new ExpressionController(this);\n\t\t\t\tif (this._raw_input != this._expression_controller.expression) {\n\t\t\t\t\tthis._expression_controller.set_expression(this._raw_input);\n\t\t\t\t\tthis.emit_controller.emit(ParamEvent.EXPRESSION_UPDATED);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.states.error.set(`param input is invalid (${this.full_path()})`);\n\t\t\t}\n\t\t}\n\t}\n\tprotected async process_computation(): Promise<void> {\n\t\tif (this.expression_controller?.active && !this.expression_controller.requires_entities) {\n\t\t\tconst expression_result = await this.expression_controller.compute_expression();\n\t\t\tif (this.expression_controller.is_errored) {\n\t\t\t\tthis.states.error.set(\n\t\t\t\t\t`expression error: \"${this.expression_controller.expression}\" (${this.expression_controller.error_message})`\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst converted = this.convert(expression_result);\n\t\t\t\tif (converted != null) {\n\t\t\t\t\tthis._update_value(converted);\n\t\t\t\t} else {\n\t\t\t\t\tthis.states.error.set(\n\t\t\t\t\t\t`expression returns an invalid type (${expression_result}) (${this.expression_controller.expression})`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprivate _update_value(new_value: ParamValuesTypeMap[T]) {\n\t\tthis._value = new_value;\n\t\tif (this.parent_param) {\n\t\t\tthis.parent_param.set_value_from_components();\n\t\t}\n\t\tthis.options.execute_callback();\n\t\tthis.emit_controller.emit(ParamEvent.VALUE_UPDATED);\n\t\tthis.remove_dirty_state();\n\t}\n}\n","export class TypeAssert {\n\tstatic unreachable(x: never): never {\n\t\tthrow new Error(\"Didn't expect to get here\");\n\t}\n}\n","import {BaseCommand} from './_Base';\n// import {BaseNode} from 'src/Engine/Node/_Base'\n// import {BaseParamType} from 'src/engine/params/_Base';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamConstructorMap} from 'src/engine/params/types/ParamConstructorMap';\n// import {ParamValuesTypeMap} from 'src/engine/params/types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from 'src/engine/params/types/ParamInitValuesTypeMap';\n\nexport class ParamSetCommand<T extends ParamType> extends BaseCommand {\n\tconstructor(\n\t\tprivate _param: ParamConstructorMap[T],\n\t\tprivate _new_raw_input: ParamInitValuesTypeMap[T],\n\t\tprivate _old_raw_input?: ParamInitValuesTypeMap[T]\n\t) {\n\t\tsuper();\n\n\t\tif (this._old_raw_input === undefined) {\n\t\t\tthis._old_raw_input = this._param.raw_input as never;\n\t\t}\n\t}\n\n\tdo() {\n\t\tthis._param.set(this._new_raw_input as never);\n\t}\n\n\tundo() {\n\t\tthis._param.set(this._old_raw_input as never);\n\t}\n}\n","import {BaseMatNodeType} from '../_Base';\n\nexport class BaseController {\n\tconstructor(protected node: BaseMatNodeType) {}\n\tadd_params() {}\n\n\tupdate() {}\n\n\tget material() {\n\t\treturn this.node.material;\n\t}\n}\n","import {BaseController} from './_BaseController';\nimport {Material} from 'three/src/materials/Material';\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {TypedMatNode} from '../_Base';\nexport function SkinningParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tskinning = ParamConfig.BOOLEAN(0);\n\t};\n}\n\nclass SkinnedMaterial extends Material {\n\tskinning!: boolean;\n}\nclass SkinningParamsConfig extends SkinningParamConfig(NodeParamsConfig) {}\nclass SkinningMatNode extends TypedMatNode<SkinnedMaterial, SkinningParamsConfig> {\n\tcreate_material() {\n\t\treturn new SkinnedMaterial();\n\t}\n}\n\nexport class SkinningController extends BaseController {\n\t// add_params() {\n\t// \tthis.node.add_param(ParamType.BOOLEAN, 'skinning', 0);\n\t// }\n\n\tstatic update(node: SkinningMatNode) {\n\t\tnode.material.skinning = node.pv.skinning;\n\t}\n\n\t// update() {\n\t// \tthis.node.material.skinning = this.node.params.boolean('skinning');\n\t// }\n}\n","// import {BaseController} from './_BaseController';\nimport {Material} from 'three/src/materials/Material';\nimport {Texture} from 'three/src/textures/Texture';\nimport {FileCopNode} from 'src/engine/nodes/cop/File';\nimport {TypedMatNode} from '../_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {BaseTextureMapController, BooleanParamOptions, OperatorPathOptions} from './_BaseTextureController';\nexport function TextureMapParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tuse_map = ParamConfig.BOOLEAN(0, BooleanParamOptions(TextureMapController));\n\t\tmap = ParamConfig.OPERATOR_PATH(\n\t\t\tFileCopNode.DEFAULT_NODE_PATH.UV,\n\t\t\tOperatorPathOptions(TextureMapController, 'use_map')\n\t\t);\n\t};\n}\nclass TextureMapMaterial extends Material {\n\tmap!: Texture | null;\n}\nclass TextureMapParamsConfig extends TextureMapParamConfig(NodeParamsConfig) {}\nclass TextureMapMatNode extends TypedMatNode<TextureMapMaterial, TextureMapParamsConfig> {\n\ttexture_map_controller!: TextureMapController;\n\tcreate_material() {\n\t\treturn new TextureMapMaterial();\n\t}\n}\n\nexport class TextureMapController extends BaseTextureMapController {\n\tconstructor(protected node: TextureMapMatNode) {\n\t\tsuper(node);\n\t}\n\tinitialize_node() {\n\t\tthis.add_hooks(this.node.p.use_map, this.node.p.map);\n\t}\n\tasync update() {\n\t\tthis._update_texture(this.node.material, 'map', this.node.p.use_map, this.node.p.map);\n\t}\n\tstatic async update(node: TextureMapMatNode) {\n\t\tnode.texture_map_controller.update();\n\t}\n\n\t// static async update(node: TextureMapMatNode) {\n\t// \tconst material = node.material;\n\n\t// \tif (node.pv.use_map) {\n\t// \t\tconst found_node = node.p.map.found_node();\n\t// \t\tif (found_node) {\n\t// \t\t\tif (found_node.node_context() == NodeContext.COP) {\n\t// \t\t\t\tconst texture_node = found_node as BaseCopNodeType;\n\n\t// \t\t\t\t// if the texture has already been created, we don't have to wait for request_container\n\t// \t\t\t\tif (texture_node.texture) {\n\t// \t\t\t\t\ttexture_node.request_container();\n\t// \t\t\t\t} else {\n\t// \t\t\t\t\tawait texture_node.request_container();\n\t// \t\t\t\t}\n\n\t// \t\t\t\tif (texture_node.texture) {\n\t// \t\t\t\t\tif (!material.map || material.map.uuid != texture_node.texture.uuid) {\n\t// \t\t\t\t\t\tmaterial.map = texture_node.texture;\n\t// \t\t\t\t\t\tmaterial.needsUpdate = true;\n\t// \t\t\t\t\t}\n\t// \t\t\t\t\treturn;\n\t// \t\t\t\t}\n\t// \t\t\t} else {\n\t// \t\t\t\tnode.states.error.set(`found map node is not a COP node`);\n\t// \t\t\t}\n\t// \t\t} else {\n\t// \t\t\tnode.states.error.set(`could not find map node`);\n\t// \t\t}\n\t// \t}\n\t// \tif (material.map) {\n\t// \t\tmaterial.map = null;\n\t// \t\tmaterial.needsUpdate = true;\n\t// \t}\n\t// }\n}\n","// import {BaseController} from './_BaseController';\nimport {Material} from 'three/src/materials/Material';\nimport {Texture} from 'three/src/textures/Texture';\nimport {FileCopNode} from 'src/engine/nodes/cop/File';\nimport {TypedMatNode} from '../_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\n// import {NodeContext} from 'src/engine/poly/NodeContext';\n// import {BaseCopNodeType} from '../../cop/_Base';\nimport {BaseTextureMapController, BooleanParamOptions, OperatorPathOptions} from './_BaseTextureController';\nexport function TextureAlphaMapParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tuse_alpha_map = ParamConfig.BOOLEAN(0, BooleanParamOptions(TextureAlphaMapController));\n\t\talpha_map = ParamConfig.OPERATOR_PATH(\n\t\t\tFileCopNode.DEFAULT_NODE_PATH.UV,\n\t\t\tOperatorPathOptions(TextureAlphaMapController, 'use_alpha_map')\n\t\t);\n\t};\n}\nclass TextureAlphaMaterial extends Material {\n\talphaMap!: Texture | null;\n}\nclass TextureAlphaMapParamsConfig extends TextureAlphaMapParamConfig(NodeParamsConfig) {}\nclass TextureAlphaMapMatNode extends TypedMatNode<TextureAlphaMaterial, TextureAlphaMapParamsConfig> {\n\ttexture_alpha_map_controller!: TextureAlphaMapController;\n\tcreate_material() {\n\t\treturn new TextureAlphaMaterial();\n\t}\n}\n\nexport class TextureAlphaMapController extends BaseTextureMapController {\n\tconstructor(protected node: TextureAlphaMapMatNode) {\n\t\tsuper(node);\n\t}\n\tinitialize_node() {\n\t\tthis.add_hooks(this.node.p.use_alpha_map, this.node.p.alpha_map);\n\t}\n\tasync update() {\n\t\tthis._update_texture(this.node.material, 'alphaMap', this.node.p.use_alpha_map, this.node.p.alpha_map);\n\t}\n\tstatic async update(node: TextureAlphaMapMatNode) {\n\t\tnode.texture_alpha_map_controller.update();\n\t}\n\n\t// static async update(node: TextureAlphaMapMatNode) {\n\t// \tconst material = node.material;\n\n\t// \tif (node.pv.use_map) {\n\t// \t\tconst found_node = node.p.alpha_map.found_node();\n\t// \t\tif (found_node) {\n\t// \t\t\tif (found_node.node_context() == NodeContext.COP) {\n\t// \t\t\t\tconst texture_node = found_node as BaseCopNodeType;\n\n\t// \t\t\t\t// if the texture has already been created, we don't have to wait for request_container\n\t// \t\t\t\tif (texture_node.texture) {\n\t// \t\t\t\t\ttexture_node.request_container();\n\t// \t\t\t\t} else {\n\t// \t\t\t\t\tawait texture_node.request_container();\n\t// \t\t\t\t}\n\n\t// \t\t\t\tif (texture_node.texture) {\n\t// \t\t\t\t\tmaterial.alphaMap = texture_node.texture;\n\t// \t\t\t\t\treturn;\n\t// \t\t\t\t}\n\t// \t\t\t} else {\n\t// \t\t\t\tnode.states.error.set(`found map node is not a COP node`);\n\t// \t\t\t}\n\t// \t\t} else {\n\t// \t\t\tnode.states.error.set(`could not find map node`);\n\t// \t\t}\n\t// \t}\n\t// \tmaterial.alphaMap = null;\n\t// }\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\n\nimport {NodeJsonExporter} from './Node';\n// import {BaseNodeObjJsonExporter} from './node/Obj';\n// import {BaseNodeSopSubnetworkJsonExporter} from './node/Subnetwork';\n\nimport {ParamJsonExporter} from './Param';\nimport {ParamMultipleJsonExporter} from './param/Multiple';\nimport {ParamNumericJsonExporter} from './param/Numeric';\nimport {ParamOperatorPathJsonExporter} from './param/OperatorPath';\nimport {ParamStringJsonExporter} from './param/String';\nimport {ParamRampJsonExporter} from './param/Ramp';\n// import {TypedObjNode} from 'src/engine/nodes/obj/_Base';\nimport {TypedMultipleParam} from 'src/engine/params/_Multiple';\nimport {TypedNumericParam} from 'src/engine/params/_Numeric';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\nimport {StringParam} from 'src/engine/params/String';\nimport {RampParam} from 'src/engine/params/Ramp';\n\nexport class JsonExportDispatcher {\n\tstatic dispatch_node(node: BaseNodeType) {\n\t\t// if (node instanceof TypedObjNode) {\n\t\t// \treturn new BaseNodeObjJsonExporter(node);\n\t\t// }\n\t\treturn new NodeJsonExporter(node);\n\t}\n\n\tstatic dispatch_param(param: BaseParamType) {\n\t\tif (param instanceof TypedMultipleParam) {\n\t\t\treturn new ParamMultipleJsonExporter(param);\n\t\t}\n\t\tif (param instanceof TypedNumericParam) {\n\t\t\treturn new ParamNumericJsonExporter(param);\n\t\t}\n\t\tif (param instanceof OperatorPathParam) {\n\t\t\treturn new ParamOperatorPathJsonExporter(param);\n\t\t}\n\t\tif (param instanceof StringParam) {\n\t\t\treturn new ParamStringJsonExporter(param);\n\t\t}\n\t\tif (param instanceof RampParam) {\n\t\t\treturn new ParamRampJsonExporter(param);\n\t\t}\n\t\treturn new ParamJsonExporter(param);\n\t}\n}\n","import {PolyScene} from 'src/engine/scene/PolyScene';\n// import {JsonExporterVisitor} from './Visitor';\nimport {CoreString} from 'src/core/String';\nimport {NodeJsonExporterData, NodeJsonExporterUIData} from './Node';\nimport {JsonExportDispatcher} from './Dispatcher';\n\nexport interface SceneJsonExporterData {\n\tproperties?: {\n\t\tframe: number;\n\t\tframe_range: Number2;\n\t\tframe_range_locked: Boolean2;\n\t\tfps: number;\n\t\tmaster_camera_node_path: string | null;\n\t};\n\troot?: NodeJsonExporterData;\n\tui?: NodeJsonExporterUIData;\n}\n\nexport class SceneJsonExporter {\n\tprivate _data: SceneJsonExporterData = {};\n\tconstructor(private _scene: PolyScene) {}\n\n\tdata(): SceneJsonExporterData {\n\t\tthis._scene.nodes_controller.reset_node_context_signatures();\n\t\tconst root_exporter = JsonExportDispatcher.dispatch_node(this._scene.root);\n\t\tconst nodes_data = root_exporter.data();\n\t\tconst ui_data = root_exporter.ui_data();\n\n\t\tthis._data = {\n\t\t\t// __js_version: this._scene.js_version(),\n\t\t\tproperties: {\n\t\t\t\t// name: this._scene.name(), // this conflicts with saving the name from the admin page\n\t\t\t\tframe: this._scene.frame || 1,\n\t\t\t\tframe_range: this._scene.frame_range,\n\t\t\t\tframe_range_locked: this._scene.time_controller.frame_range_locked,\n\t\t\t\tfps: this._scene.time_controller.fps,\n\t\t\t\tmaster_camera_node_path: this._scene.cameras_controller.master_camera_node_path,\n\t\t\t},\n\t\t\troot: nodes_data,\n\t\t\tui: ui_data,\n\t\t};\n\n\t\treturn this._data;\n\t}\n\n\tstatic sanitize_string(word: string): string {\n\t\tword = word.replace(/'/g, \"'\"); // escapes ' (used to be with 2 /, but now only one to have Ian's Mediation saved and loaded correctly - but is actually 2 in Code Exporter)\n\t\tword = CoreString.escape_line_breaks(word);\n\t\treturn word;\n\t}\n}\n","import {TypedLightObjNode} from './_BaseLight';\nimport {Light} from 'three/src/lights/Light';\n// import {CoreTransform} from 'src/core/Transform';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {TransformController, TransformedParamConfig} from './utils/TransformController';\nimport {FlagsControllerD} from '../utils/FlagsController';\n\n// import {Transformed} from './Concerns/Transformed';\nclass TransformedObjParamConfig extends TransformedParamConfig(NodeParamsConfig) {}\n\nexport abstract class BaseLightTransformedObjNode<\n\tL extends Light,\n\tK extends TransformedObjParamConfig\n> extends TypedLightObjNode<L, K> {\n\tpublic readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\treadonly transform_controller: TransformController = new TransformController(this);\n\n\tinitialize_base_node() {\n\t\tsuper.initialize_base_node();\n\t\tthis.transform_controller.initialize_node();\n\t}\n\n\tcook() {\n\t\tthis.transform_controller.update();\n\t\tthis.update_light_params();\n\t\tthis.update_shadow_params();\n\t\tthis.cook_controller.end_cook();\n\t}\n}\n","import {Mesh} from 'three/src/objects/Mesh';\nimport {MeshBasicMaterial} from 'three/src/materials/MeshBasicMaterial';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {TypedObjNode} from '../../_Base';\nimport {Group} from 'three/src/objects/Group';\nimport {Light} from 'three/src/lights/Light';\nimport {FlagsControllerD} from 'src/engine/nodes/utils/FlagsController';\nexport function BaseLightHelperParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tshow_helper = ParamConfig.BOOLEAN(1);\n\t\thelper_size = ParamConfig.FLOAT(1, {visible_if: {show_helper: 1}});\n\t};\n}\nclass BaseLightHelperParamsConfig extends BaseLightHelperParamConfig(NodeParamsConfig) {}\nexport abstract class BaseLightHelperObjNode<L extends Light> extends TypedObjNode<Group, BaseLightHelperParamsConfig> {\n\tpublic readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\n\t// public readonly helper: BaseLightHelper<L> | undefined;\n\tabstract get light(): L;\n}\n\nexport abstract class BaseLightHelper<L extends Light, N extends BaseLightHelperObjNode<L>> {\n\tprotected _object = new Mesh();\n\tprotected _material = new MeshBasicMaterial({wireframe: true, fog: false});\n\tconstructor(protected node: N, private _name: string) {}\n\n\tbuild() {\n\t\tthis._object.name = this._name;\n\t\tthis.build_helper();\n\t}\n\tprotected abstract build_helper(): void;\n\tget object() {\n\t\treturn this._object;\n\t}\n\n\tabstract update(): void;\n}\n","import {Light} from 'three/src/lights/Light';\nimport {BaseLightHelper, BaseLightHelperObjNode} from './helpers/_BaseLightHelper';\n\n// interface Helper<L extends Light> extends BaseLightHelper<L> {\n// \tdispose: () => void;\n// \tupdate: () => void;\n// }\nexport interface HelperConstructor<L extends Light> {\n\tnew (node: BaseLightHelperObjNode<L>, name: string): BaseLightHelper<L, BaseLightHelperObjNode<L>>;\n}\n\nexport class HelperController<L extends Light> {\n\tprivate _helper: BaseLightHelper<L, BaseLightHelperObjNode<L>> | undefined;\n\tconstructor(\n\t\tprivate node: BaseLightHelperObjNode<L>,\n\t\tprivate _helper_constructor: HelperConstructor<L>,\n\t\tprivate _name: string\n\t) {}\n\n\tinitialize_node() {\n\t\tthis.node.flags.display.add_hook(() => {\n\t\t\tthis.update_helper_attachment();\n\t\t});\n\t}\n\n\tprivate update_helper_attachment() {\n\t\tif (this.node.flags.display.active) {\n\t\t\tconst object = this.helper?.object; // use this.helper to create if needed\n\t\t\tif (object) {\n\t\t\t\tthis.node.object.add(object);\n\t\t\t\tthis._helper?.update();\n\t\t\t}\n\t\t} else {\n\t\t\tconst object = this._helper?.object; // use this._helper to NOT create if not already existing\n\t\t\tif (object) {\n\t\t\t\tthis.node.object.remove(object);\n\t\t\t}\n\t\t}\n\t}\n\tget helper() {\n\t\tif (this.node.flags.display.active) {\n\t\t\treturn (this._helper = this._helper || this._create_helper());\n\t\t}\n\t}\n\tget visible() {\n\t\treturn this.node.flags.display.active && this.node.pv.show_helper;\n\t}\n\n\tprivate _create_helper(): BaseLightHelper<L, BaseLightHelperObjNode<L>> {\n\t\tconst helper = new this._helper_constructor(this.node, this._name);\n\t\thelper.build();\n\t\tthis.node.light.add(helper.object);\n\t\treturn helper;\n\t}\n\n\tupdate() {\n\t\tif (this.visible) {\n\t\t\tif (!this._helper) {\n\t\t\t\tthis._helper = this._create_helper();\n\t\t\t}\n\t\t\tif (this._helper) {\n\t\t\t\tthis._helper.object.visible = true;\n\t\t\t\tthis._helper.update();\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._helper) {\n\t\t\t\tthis._helper.object.visible = false;\n\t\t\t}\n\t\t}\n\t}\n}\n","import {TypedObjNode} from './_Base';\nimport {Group} from 'three/src/objects/Group';\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass BaseManagerObjParamsConfig extends NodeParamsConfig {}\nexport class BaseManagerObjNode extends TypedObjNode<Group, BaseManagerObjParamsConfig> {\n\t// public readonly add_to_hierarchy: boolean = false;\n\tprotected _attachable_to_hierarchy: boolean = false;\n\t// _init_manager(options = {}) {\n\t// \t// this._init_hierarchy_children_owner(options['children'] || {});\n\t// \t// this.flags.add_display({\n\t// \t// \thas_display_flag: false,\n\t// \t// \tmultiple_display_flags_allowed: true,\n\t// \t// });\n\t// \t// this.set_inputs_count_to_zero();\n\t// \t// this._init_outputs({has_outputs: false});\n\t// }\n\n\tcreate_object() {\n\t\treturn new Group();\n\t}\n\n\tcook() {\n\t\tthis.cook_controller.end_cook();\n\t}\n}\n","import {BaseObjNodeType} from 'src/engine/nodes/obj/_Base';\n// import {ParamType} from 'src/engine/poly/ParamType';\n\nconst PARAM_NAME = 'layer';\n\nimport {ParamConfig} from '../../utils/params/ParamsConfig';\nexport function LayerParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tlayer = ParamConfig.INTEGER(0, {\n\t\t\trange: [0, 31],\n\t\t\trange_locked: [true, true],\n\t\t});\n\t};\n}\n\nexport class LayersController {\n\tconstructor(private node: BaseObjNodeType) {}\n\n\t// add_params() {\n\t// \tthis.node.add_param(ParamType.INTEGER, PARAM_NAME, 0, {\n\t// \t\trange: [0, 31],\n\t// \t\trange_locked: [true, true],\n\t// \t});\n\t// }\n\n\tupdate() {\n\t\tconst object = this.node.object;\n\t\t// const affected_objects = [object];\n\t\t// if (object.cloned_cameras != null) {\n\t\t// \tlodash_each(object.cloned_cameras, cloned_camera=> {\n\t\t// \t\taffected_objects.push(cloned_camera);\n\t\t// \t});\n\t\t// }\n\n\t\t// affected_objects.forEach((affected_object)=> {\n\t\tobject.layers.set(0);\n\t\tobject.layers.enable(this.node.params.integer(PARAM_NAME));\n\t\t// });\n\t}\n}\n","import {WebGLRenderer} from 'three/src/renderers/WebGLRenderer';\n// import {WebGLRenderTarget} from 'three/src/renderers/WebGLRenderTarget';\nimport {ACESFilmicToneMapping, sRGBEncoding} from 'three/src/constants';\nimport {Vector2} from 'three/src/math/Vector2';\n\nimport lodash_range from 'lodash/range';\n// import {BaseParam} from 'src/engine/params/_Base';\nimport {BooleanParam} from 'src/engine/params/Boolean';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\nimport {BasePostProcessNodeType} from 'src/engine/nodes/post/_Base';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\nimport {EffectComposer} from 'modules/three/examples/jsm/postprocessing/EffectComposer';\nimport {RenderPass} from 'modules/three/examples/jsm/postprocessing/RenderPass';\nimport {Pass} from 'modules/three/examples/jsm/postprocessing/Pass';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {POLY} from 'src/engine/Poly';\n\ninterface DisposablePass extends Pass {\n\tdispose: () => void;\n}\n\nfunction boolean_param_options(index: number) {\n\treturn {\n\t\tvisible_if: {\n\t\t\tdo_post_process: 1,\n\t\t},\n\t};\n}\nfunction operator_path_param_options(index: number) {\n\treturn {\n\t\tnode_selection: {context: NodeContext.POST},\n\t\tvisible_if: {\n\t\t\tdo_post_process: 1,\n\t\t\t[`use_post_process_node${index}`]: 1,\n\t\t},\n\t};\n}\n\nimport {ParamConfig} from '../../../utils/params/ParamsConfig';\nexport function CameraPostProcessParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tpost_process = ParamConfig.FOLDER();\n\n\t\tdo_post_process = ParamConfig.BOOLEAN(0);\n\t\tuse_post_process_node0 = ParamConfig.BOOLEAN(0, boolean_param_options(0));\n\t\tpost_process_node0 = ParamConfig.OPERATOR_PATH('', operator_path_param_options(0));\n\t\tuse_post_process_node1 = ParamConfig.BOOLEAN(0, boolean_param_options(1));\n\t\tpost_process_node1 = ParamConfig.OPERATOR_PATH('', operator_path_param_options(1));\n\t\tuse_post_process_node2 = ParamConfig.BOOLEAN(0, boolean_param_options(2));\n\t\tpost_process_node2 = ParamConfig.OPERATOR_PATH('', operator_path_param_options(2));\n\t\tuse_post_process_node3 = ParamConfig.BOOLEAN(0, boolean_param_options(3));\n\t\tpost_process_node3 = ParamConfig.OPERATOR_PATH('', operator_path_param_options(3));\n\t};\n}\n\nexport class PostProcessController {\n\t// private _param_do_post_process: boolean;\n\t// private _param_do_sao: boolean;\n\tprivate _renderers_by_canvas_id: Dictionary<WebGLRenderer> = {};\n\tprivate _composers_by_canvas_id: Dictionary<EffectComposer> = {};\n\tprivate _resolution_by_canvas_id: Dictionary<Vector2> = {};\n\tprivate _composers_set_in_progress_by_canvas_id: Dictionary<boolean> = {};\n\tprivate _fetch_post_process_nodes_in_progress: boolean = false;\n\t// private _render_passes: any[] = []\n\tprivate _post_process_nodes: BasePostProcessNodeType[] = [];\n\n\tprivate _post_process_use_node_path_params: BooleanParam[] = [];\n\tprivate _post_process_node_path_params: OperatorPathParam[] = [];\n\n\tconstructor(private node: BaseCameraObjNodeType) {}\n\n\t// private _prev_t = 0;\n\trender(canvas: HTMLCanvasElement, size: Vector2, aspect: number) {\n\t\tconst renderer = this.renderer(canvas);\n\t\tif (renderer) {\n\t\t\tif (this.node.params.boolean('do_post_process')) {\n\t\t\t\tconst composer = this.composer(canvas);\n\t\t\t\tif (composer) {\n\t\t\t\t\tcomposer.setSize(size.x, size.y);\n\t\t\t\t\tcomposer.render();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.node.setup_for_aspect_ratio(aspect);\n\t\t\t\t// const cur_t = performance.now();\n\t\t\t\t// const delta = cur_t - this._prev_t;\n\t\t\t\t// this._prev_t = cur_t;\n\t\t\t\t// console.log(cur_t, delta);\n\t\t\t\trenderer.render(this.node.scene.display_scene, this.node.object);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate renderer(canvas: HTMLCanvasElement) {\n\t\treturn this._renderers_by_canvas_id[canvas.id];\n\t}\n\n\tcreate_renderer(canvas: HTMLCanvasElement, size: Vector2): WebGLRenderer {\n\t\tconst gl = POLY.renderers_controller.rendering_context(canvas);\n\n\t\tconst renderer = new WebGLRenderer({\n\t\t\tcanvas: canvas,\n\t\t\tantialias: true,\n\t\t\talpha: true,\n\t\t\tcontext: gl,\n\t\t});\n\n\t\trenderer.shadowMap.enabled = true;\n\t\trenderer.physicallyCorrectLights = true; // https://discourse.threejs.org/t/three-js-white-is-too-bright/11873/3\n\n\t\t// TODO: find a way to have those accessible via params\n\t\trenderer.toneMapping = ACESFilmicToneMapping;\n\t\trenderer.toneMappingExposure = 1;\n\t\trenderer.outputEncoding = sRGBEncoding;\n\n\t\t// https://github.com/mrdoob/js/issues/15493\n\t\t// This below is an attempt to fix env map not being loaded in firefox, but that doesn't work.\n\t\t// Since the threejs example (https://threejs.org/examples/?q=exr#webgl_materials_envmaps_exr) also only works in chrome, not in firefox, I assume this is a firefox+linux bug\n\t\t// console.log(renderer.extensions)\n\t\t// renderer.extensions.get( 'EXT_color_buffer_float' );\n\n\t\t// attempt to have particle systems work in firefox on mobile\n\t\t// (current solution is to have the node SOP/particlesSystemGPU force webgl2 to be used)\n\t\t// renderer.extensions.get( 'WEBGL_color_buffer_float' );\n\t\t// renderer.extensions.get( 'WEBGL_draw_buffers' );\n\n\t\tPOLY.renderers_controller.register_renderer(renderer);\n\t\tthis._renderers_by_canvas_id[canvas.id] = renderer;\n\t\tthis.set_renderer_size(canvas, size);\n\t\trenderer.setPixelRatio(window.devicePixelRatio);\n\n\t\treturn renderer;\n\t}\n\tdelete_renderer(canvas: HTMLCanvasElement) {\n\t\tconst renderer = this.renderer(canvas);\n\t\tif (renderer) {\n\t\t\tPOLY.renderers_controller.deregister_renderer(renderer);\n\t\t}\n\t}\n\tset_renderer_size(canvas: HTMLCanvasElement, size: Vector2) {\n\t\tthis._resolution_by_canvas_id[canvas.id] = this._resolution_by_canvas_id[canvas.id] || new Vector2();\n\t\tthis._resolution_by_canvas_id[canvas.id].copy(size);\n\n\t\tconst renderer = this.renderer(canvas);\n\t\tif (renderer) {\n\t\t\trenderer.setSize(size.x, size.y);\n\t\t}\n\t\tconst composer = this.composer(canvas);\n\t\tif (composer) {\n\t\t\tcomposer.setSize(size.x, size.y);\n\t\t}\n\t}\n\n\tprivate composer(canvas: HTMLCanvasElement): EffectComposer {\n\t\treturn (this._composers_by_canvas_id[canvas.id] =\n\t\t\tthis._composers_by_canvas_id[canvas.id] || this._create_composer(canvas));\n\t}\n\n\tprivate _create_composer(canvas: HTMLCanvasElement) {\n\t\tconst renderer = this.renderer(canvas);\n\t\tif (renderer) {\n\t\t\t// const parameters = {\n\t\t\t// \tminFilter: LinearFilter,\n\t\t\t// \tmagFilter: LinearFilter,\n\t\t\t// \tformat: RGBAFormat,\n\t\t\t// \tstencilBuffer: true\n\t\t\t// }\n\t\t\t// const renderTarget = new WebGLRenderTarget( window.innerWidth, window.innerHeight, parameters );\n\t\t\tconst composer = new EffectComposer(renderer); //, renderTarget );\n\t\t\t// to achieve better antialiasing\n\t\t\t// while using post:\n\t\t\t// composer.setPixelRatio( window.devicePixelRatio*2 )\n\t\t\tcomposer.setPixelRatio(window.devicePixelRatio * 2);\n\t\t\tthis.set_composer_passes(canvas.id, composer, renderer);\n\n\t\t\treturn composer;\n\t\t} /*else {\n\t\t\tconsole.warn(this._renderers_by_canvas_id)\n\t\t\tthrow \"failed to create composer, no renderer ready\"\n\t\t}*/\n\t}\n\n\tasync update_composer_passes() {\n\t\tif (this.node.params.boolean('do_post_process')) {\n\t\t\tthis._post_process_nodes = [];\n\t\t\tif (this._fetch_post_process_nodes_in_progress) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._fetch_post_process_nodes_in_progress = true;\n\n\t\t\tif (this.composer_passes_nodes_changed()) {\n\t\t\t\tthis._post_process_nodes = [];\n\n\t\t\t\tfor (let i of lodash_range(4)) {\n\t\t\t\t\tconst toggle_param = this._post_process_use_node_path_params[i];\n\t\t\t\t\t// const use_node = await toggle_param.eval_p()\n\t\t\t\t\tconst use_node = toggle_param.value;\n\t\t\t\t\tif (use_node) {\n\t\t\t\t\t\tconst param = this._post_process_node_path_params[i];\n\t\t\t\t\t\tconst post_process_node = param.found_node() as BasePostProcessNodeType;\n\t\t\t\t\t\tif (post_process_node) {\n\t\t\t\t\t\t\tawait post_process_node.request_container();\n\t\t\t\t\t\t\t// const render_pass = container.render_pass()\n\t\t\t\t\t\t\t// this._render_passes.push(render_pass)\n\t\t\t\t\t\t\tthis._post_process_nodes.push(post_process_node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.set_composers_passes();\n\t\t\t\t// this._previous_post_process_nodes_paths = this.composer_passes_nodes_paths()\n\t\t\t}\n\t\t\tthis._fetch_post_process_nodes_in_progress = false;\n\t\t} else {\n\t\t\tthis._post_process_nodes = [];\n\t\t}\n\t}\n\n\tprivate set_composers_passes() {\n\t\tconst ids = Object.keys(this._composers_by_canvas_id);\n\n\t\tfor (let id of ids) {\n\t\t\tconst composer = this._composers_by_canvas_id[id];\n\t\t\tconst renderer = this._renderers_by_canvas_id[id];\n\t\t\tif (composer) {\n\t\t\t\tthis.set_composer_passes(id, composer, renderer);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate set_composer_passes(id: string, composer: EffectComposer, renderer: WebGLRenderer) {\n\t\tconst set_in_progress = this._composers_set_in_progress_by_canvas_id[id];\n\t\tif (set_in_progress) {\n\t\t\treturn;\n\t\t}\n\t\tthis._composers_set_in_progress_by_canvas_id[id] = true;\n\n\t\tthis.clear_render_passes(composer);\n\n\t\tconst render_scene_pass = new RenderPass(this.node.scene.display_scene, this.node.object);\n\t\trender_scene_pass.clearAlpha = 0;\n\t\tcomposer.addPass(render_scene_pass);\n\n\t\tfor (let post_process_node of this._post_process_nodes) {\n\t\t\tpost_process_node.apply_to_composer(\n\t\t\t\tcomposer,\n\t\t\t\tthis.node.object,\n\t\t\t\tthis._resolution_by_canvas_id[id],\n\t\t\t\tthis.node\n\t\t\t);\n\t\t}\n\t\tdelete this._composers_set_in_progress_by_canvas_id[id];\n\t}\n\n\tprivate clear_render_passes(composer: EffectComposer) {\n\t\tlet render_pass: Pass | undefined;\n\t\twhile ((render_pass = composer.passes.pop())) {\n\t\t\tif (render_pass) {\n\t\t\t\tconst disposable_pass: DisposablePass = render_pass as DisposablePass;\n\t\t\t\tif (typeof disposable_pass.dispose === 'function') {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdisposable_pass.dispose();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.warn(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// this._render_passes = []\n\t\tcomposer.passes = [];\n\t}\n\n\tprivate composer_passes_nodes_changed(): boolean {\n\t\treturn true;\n\t\t// I have to evaluate the nodes anyway, in case they changed\n\t\t// unless I can create a method that can store if one of those nodes are the ones that\n\t\t// made this current node dirty\n\t}\n\n\tadd_params() {\n\t\t// this.node.within_param_folder('post_process', () => {\n\t\tthis.node.add_param(ParamType.BOOLEAN, 'do_post_process', 0);\n\n\t\tlodash_range(4).forEach((i) => {\n\t\t\tconst toggle_param = this.node.add_param(ParamType.BOOLEAN, `use_post_process_node${i + 1}`, 0, {\n\t\t\t\tvisible_if: {do_post_process: 1},\n\t\t\t});\n\n\t\t\tif (toggle_param) {\n\t\t\t\tconst visible_options = {\n\t\t\t\t\tdo_post_process: 1,\n\t\t\t\t\t[toggle_param.name]: 1,\n\t\t\t\t};\n\t\t\t\tconst node_path_options = {\n\t\t\t\t\tnode_selection: {context: NodeContext.POST},\n\t\t\t\t\tvisible_if: visible_options,\n\t\t\t\t};\n\t\t\t\tconst param = this.node.add_param(\n\t\t\t\t\tParamType.OPERATOR_PATH,\n\t\t\t\t\t`post_process_node${i + 1}`,\n\t\t\t\t\t'',\n\t\t\t\t\tnode_path_options\n\t\t\t\t);\n\t\t\t\tif (param) {\n\t\t\t\t\tthis._post_process_use_node_path_params.push(toggle_param);\n\t\t\t\t\tthis._post_process_node_path_params.push(param);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t// });\n\t}\n}\n","import {BaseParamType} from 'src/engine/params/_Base';\nimport {ComplexParamJsonExporterData} from '../export/Param';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nexport class ParamJsonImporter<T extends BaseParamType> {\n\tconstructor(protected _param: T) {}\n\n\tprocess_data(data: ComplexParamJsonExporterData<ParamType>) {\n\t\tconst raw_input = data['raw_input'];\n\t\t// const expression = data['expression'];\n\t\t// const components = data['components'];\n\t\t// if (expression !== undefined) {\n\t\t// \tthis._param.set(expression);\n\t\t// }\n\t\tif (raw_input !== undefined) {\n\t\t\tthis._param.set(raw_input);\n\t\t}\n\n\t\t// const referenced_asset = data['referenced_asset']\n\t\t// if(referenced_asset){\n\t\t// \tthis._param.mark_as_referencing_asset(referenced_asset)\n\t\t// }\n\n\t\tthis.add_main(data);\n\t}\n\n\tadd_main(data: ComplexParamJsonExporterData<ParamType>) {}\n}\n","// import lodash_each from 'lodash/each'\nimport lodash_isString from 'lodash/isString';\n// import lodash_isNumber from 'lodash/isNumber'\nimport {TypedParam} from './_Base';\n// import {TypedParamVisitor} from './_Base';\n// import {AsCodeString} from './concerns/visitors/String';\n// import {ExpressionController} from 'src/engine/expressions/ExpressionController'\nimport {ParsedTree} from 'src/engine/expressions/traversers/ParsedTree';\nimport {ParamType} from '../poly/ParamType';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ExpressionController} from './utils/ExpressionController';\nimport {ParamEvent} from '../poly/ParamEvent';\n\nexport class StringParam extends TypedParam<ParamType.STRING> {\n\tstatic type() {\n\t\treturn ParamType.STRING;\n\t}\n\tget default_value_serialized() {\n\t\treturn this.default_value;\n\t}\n\tprotected _clone_raw_input(raw_input: ParamInitValuesTypeMap[ParamType.STRING]) {\n\t\treturn `${raw_input}`;\n\t}\n\tget raw_input_serialized() {\n\t\treturn `${this._raw_input}`;\n\t}\n\tget value_serialized() {\n\t\treturn `${this.value}`;\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.STRING],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.STRING]\n\t) {\n\t\treturn raw_input1 == raw_input2;\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.STRING], val2: ParamValuesTypeMap[ParamType.STRING]) {\n\t\treturn val1 == val2;\n\t}\n\tget is_default(): boolean {\n\t\treturn this._raw_input == this.default_value;\n\t}\n\n\tconvert(raw_val: any): string {\n\t\tif (lodash_isString(raw_val)) {\n\t\t\treturn raw_val;\n\t\t}\n\t\treturn `${raw_val}`;\n\t}\n\n\tget raw_input() {\n\t\treturn this._raw_input;\n\t}\n\tprotected process_raw_input() {\n\t\tthis.states.error.clear();\n\n\t\tif (this._value_elements(this._raw_input).length >= 3) {\n\t\t\tthis._expression_controller = this._expression_controller || new ExpressionController(this);\n\t\t\tif (this._raw_input != this._expression_controller.expression) {\n\t\t\t\tthis._expression_controller.set_expression(this._raw_input);\n\t\t\t\tthis.set_dirty();\n\t\t\t\tthis.emit_controller.emit(ParamEvent.EXPRESSION_UPDATED);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._raw_input != this._value) {\n\t\t\t\tthis._value = this._raw_input;\n\t\t\t\tthis.remove_dirty_state();\n\t\t\t\tthis.set_successors_dirty(this);\n\t\t\t\tthis.emit_controller.emit(ParamEvent.VALUE_UPDATED);\n\t\t\t\tif (this._expression_controller) {\n\t\t\t\t\tthis._expression_controller.set_expression(undefined, false);\n\t\t\t\t\tthis.emit_controller.emit(ParamEvent.EXPRESSION_UPDATED); // ensure expression is considered removed\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprotected async process_computation(): Promise<void> {\n\t\tif (this.expression_controller?.active && !this.expression_controller.requires_entities) {\n\t\t\tconst expression_result = await this.expression_controller.compute_expression();\n\t\t\tif (this.expression_controller.is_errored) {\n\t\t\t\tthis.states.error.set(`expression error: ${this.expression_controller.error_message}`);\n\t\t\t} else {\n\t\t\t\tconst converted = this.convert(expression_result);\n\t\t\t\tif (converted) {\n\t\t\t\t\tthis._value = converted;\n\t\t\t\t\tthis.emit_controller.emit(ParamEvent.VALUE_UPDATED);\n\t\t\t\t} else {\n\t\t\t\t\tthis.states.error.set(`expression returns an invalid type (${expression_result})`);\n\t\t\t\t}\n\t\t\t\tthis.remove_dirty_state();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _value_elements(v: string): string[] {\n\t\treturn ParsedTree.string_value_elements(v);\n\t}\n}\n","import lodash_isArray from 'lodash/isArray';\n\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {Material} from 'three/src/materials/Material';\nimport {LineBasicMaterial} from 'three/src/materials/LineBasicMaterial';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\nimport {IUniform} from 'three/src/renderers/shaders/UniformsLib';\n\ninterface IUniforms {\n\t[uniform: string]: IUniform;\n}\nexport interface MaterialWithUniforms extends Material {\n\tuniforms: IUniforms;\n}\n\nenum CustomMaterialName {\n\tcustomDistanceMaterial = 'customDistanceMaterial',\n\tcustomDepthMaterial = 'customDepthMaterial',\n\tcustomDepthDOFMaterial = 'customDepthDOFMaterial',\n}\nexport interface ObjectWithCustomMaterials extends Mesh {\n\t// customDistanceMaterial?: Material;\n\t// customDepthMaterial?: Material;\n\tcustomDepthDOFMaterial?: Material;\n}\nexport interface ShaderMaterialWithCustomMaterials extends ShaderMaterial {\n\tcustom_materials: {\n\t\t[key in CustomMaterialName]?: ShaderMaterial;\n\t};\n}\nexport interface MaterialWithSkinning extends Material {\n\tskinning: boolean;\n\tmorphTargets: boolean;\n}\n\nexport class CoreMaterial {\n\tstatic node(scene: PolyScene, material: Material) {\n\t\treturn scene.node(material.name);\n\t}\n\n\tstatic clone(src_material: Material | Material[]) {\n\t\tif (lodash_isArray(src_material)) {\n\t\t\treturn src_material.map((material) => {\n\t\t\t\treturn this.clone_single(material);\n\t\t\t});\n\t\t} else {\n\t\t\treturn this.clone_single(src_material);\n\t\t}\n\t}\n\n\tstatic clone_single(src_material: Material) {\n\t\tconst material = src_material.clone();\n\t\t// linewidth doesn't seem cloned correctly for ShaderMaterial\n\t\t(material as LineBasicMaterial).linewidth = (src_material as LineBasicMaterial).linewidth;\n\n\t\treturn material;\n\t}\n\n\tstatic apply_custom_materials(object: Object3D, material: Material) {\n\t\tconst material_with_custom = material as ShaderMaterialWithCustomMaterials;\n\t\tif (material_with_custom.custom_materials) {\n\t\t\tfor (let name of Object.keys(material_with_custom.custom_materials)) {\n\t\t\t\tconst mat_name = name as CustomMaterialName;\n\t\t\t\t// http://blog.edankwan.com/post/three-js-advanced-tips-shadow\n\t\t\t\tconst custom_material = material_with_custom.custom_materials[mat_name];\n\t\t\t\tif (custom_material) {\n\t\t\t\t\t(object as ObjectWithCustomMaterials)[mat_name] = custom_material;\n\t\t\t\t\tcustom_material.needsUpdate = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// object.material = material.custom_materials.customDepthDOFMaterial\n\t\t\t// object.material = material.custom_materials.customDepthMaterial\n\t\t\t// object.material = material.custom_materials.customDistanceMaterial\n\t\t}\n\t}\n\tstatic assign_custom_uniforms(mat: Material, uniform_name: string, uniform_value: any) {\n\t\tconst material = mat as ShaderMaterialWithCustomMaterials;\n\t\tif (material.custom_materials) {\n\t\t\tfor (let name of Object.keys(material.custom_materials)) {\n\t\t\t\tconst mat_name = name as CustomMaterialName;\n\t\t\t\tconst custom_material = material.custom_materials[mat_name];\n\t\t\t\tif (custom_material) {\n\t\t\t\t\tcustom_material.uniforms[uniform_name].value = uniform_value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tstatic init_custom_material_uniforms(mat: Material, uniform_name: string, uniform_value: any) {\n\t\tconst material = mat as ShaderMaterialWithCustomMaterials;\n\t\tif (material.custom_materials) {\n\t\t\tfor (let name of Object.keys(material.custom_materials)) {\n\t\t\t\tconst mat_name = name as CustomMaterialName;\n\t\t\t\tconst custom_material = material.custom_materials[mat_name];\n\t\t\t\tif (custom_material) {\n\t\t\t\t\tcustom_material.uniforms[uniform_name] = custom_material.uniforms[uniform_name] || uniform_value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","const NO_USER_SELECT = 'disable-select';\nconst CURSOR_COL_RESIZE = 'cursor_col_resize';\n\nexport class CoreDom {\n\tstatic add_drag_classes() {\n\t\tdocument.body.classList.add(NO_USER_SELECT);\n\t}\n\tstatic remove_drag_classes() {\n\t\tdocument.body.classList.remove(NO_USER_SELECT);\n\t}\n\n\tstatic set_cursor_col_resize() {\n\t\tdocument.body.classList.add(CURSOR_COL_RESIZE);\n\t}\n\tstatic unset_cursor_col_resize() {\n\t\tdocument.body.classList.remove(CURSOR_COL_RESIZE);\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport lodash_isNaN from 'lodash/isNaN';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\ntype Callback = () => void;\n\nexport class NameController {\n\tprivate _graph_node: CoreGraphNode;\n\tprivate _on_set_name_hooks: Callback[] | undefined;\n\tprivate _on_set_full_path_hooks: Callback[] | undefined;\n\n\tconstructor(protected node: BaseNodeType) {\n\t\tthis._graph_node = new CoreGraphNode(node.scene, 'node_name_controller');\n\t\t// this._graph_node.set_scene(this.node.scene);\n\t}\n\tget graph_node() {\n\t\treturn this._graph_node;\n\t}\n\n\tstatic base_name(node: BaseNodeType) {\n\t\tlet base = node.type; //CoreString.class_name_to_type(this.self.type())\n\t\tconst last_char = base[base.length - 1];\n\t\tif (!lodash_isNaN(parseInt(last_char))) {\n\t\t\tbase += '_';\n\t\t}\n\t\treturn `${base}1`;\n\t}\n\n\trequest_name_to_parent(new_name: string) {\n\t\tconst parent = this.node.parent;\n\t\tif (parent && parent.children_allowed() && parent.children_controller) {\n\t\t\tparent.children_controller.set_child_name(this.node, new_name);\n\t\t} else {\n\t\t\tconsole.warn('request_name_to_parent failed, no parent found');\n\t\t}\n\t}\n\tset_name(new_name: string) {\n\t\tif (new_name != this.node.name) {\n\t\t\tthis.request_name_to_parent(new_name);\n\t\t}\n\t}\n\tupdate_name_from_parent(new_name: string) {\n\t\tthis.node._set_core_name(new_name);\n\t\tthis.post_set_name();\n\t\tthis.post_set_full_path();\n\t\tif (this.node.children_allowed()) {\n\t\t\tthis.node.children_controller?.children().forEach((child_node) => {\n\t\t\t\tchild_node.name_controller.post_set_full_path(); // TODO: typescript: replace post_set_full_path with execute_on_update_full_path_hooks or on_update_full_path\n\t\t\t});\n\t\t}\n\t\tthis._graph_node.set_successors_dirty();\n\t\tthis.node.emit(NodeEvent.NAME_UPDATED);\n\t}\n\n\tadd_post_set_name_hook(hook: Callback) {\n\t\tthis._on_set_name_hooks = this._on_set_name_hooks || [];\n\t\tthis._on_set_name_hooks.push(hook);\n\t}\n\tadd_post_set_full_path_hook(hook: Callback) {\n\t\tthis._on_set_full_path_hooks = this._on_set_full_path_hooks || [];\n\t\tthis._on_set_full_path_hooks.push(hook);\n\t}\n\n\tpost_set_name() {\n\t\tif (this._on_set_name_hooks) {\n\t\t\tfor (let hook of this._on_set_name_hooks) {\n\t\t\t\thook();\n\t\t\t}\n\t\t}\n\t}\n\tpost_set_full_path() {\n\t\tif (this._on_set_full_path_hooks) {\n\t\t\tfor (let hook of this._on_set_full_path_hooks) {\n\t\t\t\thook();\n\t\t\t}\n\t\t}\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {CoreWalker} from 'src/core/Walker';\n// import {NodeSimple} from 'src/core/Graph/NodeSimple'\n\n// import {NamedGraphNodeClass} from './graph/NamedGraphNode'\ntype NodeOrParam = BaseNodeType | BaseParamType;\n\nconst SEPARATOR = CoreWalker.SEPARATOR;\nexport class DecomposedPath {\n\tnamed_nodes: NodeOrParam[] = [];\n\tprivate graph_node_ids: string[] = [];\n\tprivate node_element_by_graph_node_id: Dictionary<string> = {};\n\n\tconstructor() {}\n\tadd_node(name: string, node: NodeOrParam) {\n\t\tif (name == node.name) {\n\t\t\tthis.named_nodes.push(node);\n\t\t}\n\n\t\tthis.graph_node_ids.push(node.graph_node_id);\n\t\tthis.node_element_by_graph_node_id[node.graph_node_id] = name;\n\t}\n\n\tupdate_from_name_change(node: NodeOrParam) {\n\t\tconst named_graph_node_ids = this.named_nodes.map((n) => n.graph_node_id);\n\n\t\tif (named_graph_node_ids.includes(node.graph_node_id)) {\n\t\t\tthis.node_element_by_graph_node_id[node.graph_node_id] = node.name;\n\t\t}\n\t}\n\n\tto_path(): string {\n\t\treturn this.graph_node_ids\n\t\t\t.map((graph_node_id) => {\n\t\t\t\treturn this.node_element_by_graph_node_id[graph_node_id];\n\t\t\t})\n\t\t\t.join(SEPARATOR);\n\t}\n}\n","const moduleKeywords = ['extended', 'included']\n\n// declare global {\n// \tinterface Window {\n// \t\tinclude_instance_methods: ((dest_class: any, src_class: any) => void);\n// \t}\n// }\nfunction include_instance_methods(dest_class: any, src_class: any) {\n\tObject.keys(src_class).forEach((key) => {\n\t\tif (!moduleKeywords.includes(key)) {\n\t\t\tdest_class.prototype[key] = src_class[key]\n\t\t}\n\t})\n\n\tif (src_class.included) {\n\t\tsrc_class.included.apply(dest_class)\n\t}\n}\n\nexport class CoreObject {\n\tconstructor() {}\n\n\tstatic include(obj: any) {\n\t\tinclude_instance_methods(obj, this)\n\t}\n\n\tstatic is_a(object: any, constructor: any) {\n\t\tlet current_proto = object\n\t\twhile (current_proto) {\n\t\t\tif (current_proto.constructor == constructor) {\n\t\t\t\treturn true\n\t\t\t} else {\n\t\t\t\tcurrent_proto = current_proto.__proto__\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\tis_a(constructor: any) {\n\t\treturn CoreObject.is_a(this, constructor)\n\t}\n\t// assign_unless (member, value){\n\t// \treturn this[member] || (this[member] = value);\n\t// }\n}\n","import {BaseParamType} from 'src/engine/params/_Base';\n// import {ParsedTree} from './ParsedTree'\n// import {LiteralConstructsController} from './LiteralConstructsController'\nimport jsep from 'jsep';\n// import {BaseMethod} from 'src/Engine/Expression/Method/_Base'\n// import {ReferenceSearchResult, MissingExpressionReference} from './MissingReference'\n// import {MissingReferencesController} from './MissingReferencesController'\nexport const VARIABLE_PREFIX = '$';\n\nexport abstract class BaseTraverser {\n\t// private _parsed_tree: ParsedTree\n\tpublic error_message: string | undefined;\n\n\tconstructor(public param: BaseParamType) {}\n\n\tprotected set_error(message: string) {\n\t\tthis.error_message = this.error_message || message;\n\t\t// throw this.error_message\n\t}\n\n\ttraverse_node(node: jsep.Expression): string | undefined {\n\t\tconst method_name = `traverse_${node.type}`;\n\t\tconst method = (this as any)[method_name];\n\t\tif (method) {\n\t\t\treturn (this as any)[method_name](node);\n\t\t} else {\n\t\t\tthis.set_error(`expression unknown node type: ${node.type}`);\n\t\t}\n\t}\n\n\tprotected abstract traverse_CallExpression(node: jsep.CallExpression): string | undefined; //{\n\n\t// const method_arguments = node.arguments.map((arg)=>{\n\t// \treturn this.traverse_node(arg)\n\t// })\n\t// const method_name = node.callee.name\n\n\t// // literal construct (if...)\n\t// const literal_contruct = this[`traverse_literal_construct_${node.type}`] //LITERAL_CONSTRUCT[method_name]\n\t// if(literal_contruct){\n\t// \treturn literal_contruct.bind(this)(method_arguments)\n\t// }\n\n\t// // direct expressions (Math.floor, Math.sin...)\n\t// const arguments_joined = `${method_arguments.join(ARGUMENTS_SEPARATOR)}`\n\t// const direct_function_name = DIRECT_EXPRESSION_FUNCTIONS[method_name]\n\t// if(direct_function_name){\n\t// \treturn `${direct_function_name}(${arguments_joined})`\n\t// }\n\n\t// // indirect methods (points_count, asset...)\n\t// const indirect_method = INDIRECT_EXPRESSION_METHODS[method_name]\n\t// if(indirect_method){\n\t// \tthis._create_method_and_dependencies(node, method_name, arguments_joined)\n\t// \treturn `await methods[${this.method_index}].process_arguments(${arguments_joined})`\n\t// }\n\n\t// this.set_error(`unknown method: ${method_name}`)\n\t//}\n\tprotected traverse_BinaryExpression(node: jsep.BinaryExpression): string {\n\t\treturn `${this.traverse_node(node.left)} ${node.operator} ${this.traverse_node(node.right)}`;\n\t}\n\tprotected traverse_LogicalExpression(node: jsep.LogicalExpression): string {\n\t\t// || or &&\n\t\treturn `${this.traverse_node(node.left)} ${node.operator} ${this.traverse_node(node.right)}`;\n\t}\n\tprotected traverse_MemberExpression(node: jsep.MemberExpression): string {\n\t\treturn `${this.traverse_node(node.object)}.${this.traverse_node(node.property)}`;\n\t}\n\tprotected traverse_ConditionalExpression(node: jsep.ConditionalExpression): string {\n\t\treturn `(${this.traverse_node(node.test)}) ? (${this.traverse_node(node.consequent)}) : (${this.traverse_node(\n\t\t\tnode.alternate\n\t\t)})`;\n\t}\n\n\t// currently only used for string expressions such as\n\t// pt_`@ptnum+1`\n\tprotected traverse_Compound(node: jsep.Compound): string {\n\t\tconst args = node.body;\n\t\tconsole.log(args);\n\t\tlet traversed_args = [];\n\t\tfor (let i = 0; i < args.length; i++) {\n\t\t\tconst arg_node = args[i];\n\t\t\tif (arg_node.type == 'Identifier') {\n\t\t\t\tif ((arg_node as jsep.Identifier).name[0] == VARIABLE_PREFIX) {\n\t\t\t\t\ttraversed_args.push('`${' + this.traverse_node(arg_node) + '}`');\n\t\t\t\t} else {\n\t\t\t\t\ttraversed_args.push(`'${(arg_node as jsep.Identifier).name}'`);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttraversed_args.push('`${' + this.traverse_node(arg_node) + '}`');\n\t\t\t}\n\t\t}\n\t\treturn traversed_args.join(' + ');\n\t\t// this may work for things like  [1,-2,3][$F%2]\n\t\t// but can be confusing for more operators like [1,-2,3][$F%2][2]\n\n\t\t// console.log(node)\n\t\t// return `(${this.traverse_node(node.test)}) ? (${this.traverse_node(node.consequent)}) : (${this.traverse_node(node.alternate)})`\n\t\t// this.set_error(\"unrecognised expression Compound\")\n\t\t// return \"\"\n\t}\n\tprotected abstract traverse_UnaryExpression(node: jsep.UnaryExpression): string; //{\n\n\t// if (node.operator === ATTRIBUTE_PREFIX) {\n\t// \tconst attrib_name = this.traverse_node(node.argument);\n\t// \treturn `param.entity_attrib_value(${QUOTE}${attrib_name}${QUOTE})`\n\t// } else {\n\t// \treturn `${node.operator}${this.traverse_node(node.argument)}`; // -5\n\t// }\n\t//}\n\n\tprotected traverse_Literal(node: jsep.Literal): string {\n\t\treturn `${node.raw}`; // 5 or 'string' (raw will include quotes)\n\t}\n\n\tprotected abstract traverse_Identifier(node: jsep.Identifier): string | undefined; //{\n\t// const identifier_first_char = node.name[0]\n\t// if(identifier_first_char == VARIABLE_PREFIX){\n\t// \tconst identifier_name_without_dollar_sign = node.name.substr(1)\n\n\t// \t// globals constants: Math.PI or Math.E\n\t// \tconst direct_constant_name = GLOBAL_CONSTANTS[identifier_name_without_dollar_sign]\n\t// \tif(direct_constant_name){\n\t// \t\treturn direct_constant_name\n\t// \t}\n\n\t// \t// scene or node globals: $F, $CH, $OS\n\t// \tconst method_name = `Identifier_${identifier_name_without_dollar_sign}_body`\n\t// \tconst method = this[method_name]\n\t// \tif(method){\n\t// \t\treturn this[method_name]()\n\t// \t}else{\n\t// \t\tthis.set_error(`identifier unknown: ${node.name}`);\n\t// \t}\n\n\t// } else {\n\t// \treturn node.name // @ptnum will call this method and return \"ptnum\"\n\t// }\n\t//}\n\n\t//\n\t//\n\t// Identifier methods (called from Identifier_body)\n\t//\n\t//\n\t// abstract Identifier_F_body(): string //{\n\t// this.dependencies.push(this.param.scene().context())\n\t// return `param.scene().frame()`\n\t//}\n\t// abstract Identifier_CH_body(): string //{\n\t// return `${QUOTE}${this.param.name()}${QUOTE}`\n\t//}\n\t// TODO:\n\t// '$CEX': '_eval_identifier_as_expression_centroid_x',\n\t// '$CEY': '_eval_identifier_as_expression_centroid_y',\n\t// '$CEZ': '_eval_identifier_as_expression_centroid_z',\n\t// '$CH': '_eval_identifier_as_param_name',\n\t// '$OS': '_eval_identifier_as_node_name',\n\n\t//\n\t//\n\t// Methods dependencies\n\t//\n\t//\n\t// protected _create_method_and_dependencies(node: jsep.CallExpression, method_name: string, arguments_joined: string) {\n\t// \tconst method_constructor = Method[method_name]\n\t// \tconst method = new method_constructor(this.param)\n\t// \tthis.method_index += 1\n\t// \tthis.methods[this.method_index] = method\n\n\t// \tconst dependency_arguments_function = new Function(`return [${arguments_joined}]`)\n\t// \tconst dependency_arguments = dependency_arguments_function()\n\n\t// \tconst reference_search_result = method.find_dependencies(dependency_arguments)\n\t// \treference_search_result.found_graph_nodes.forEach((graph_node)=>{\n\t// \t\tthis.dependencies.push(graph_node)\n\t// \t})\n\t// \treference_search_result.missing_paths.forEach((path)=>{\n\t// \t\tthis.jsep_nodes_by_missing_paths[path] = this.jsep_nodes_by_missing_paths[path] || []\n\t// \t\tthis.jsep_nodes_by_missing_paths[path].push(node)\n\t// \t})\n\t// }\n}\n","import {Camera} from 'three/src/cameras/Camera';\n\nimport {TypedCameraControlsEventNode, CameraControls} from './_BaseCameraControls';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\n\nimport {OrbitControls} from 'modules/three/examples/jsm/controls/OrbitControls';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass CameraOrbitEventParamsConfig extends NodeParamsConfig {\n\tallow_pan = ParamConfig.BOOLEAN(1);\n\tallow_rotate = ParamConfig.BOOLEAN(1);\n\tallow_zoom = ParamConfig.BOOLEAN(1);\n\ttdamping = ParamConfig.BOOLEAN(1);\n\tdamping = ParamConfig.FLOAT(0.1, {\n\t\tvisible_if: {tdamping: true},\n\t});\n\tscreen_space_panning = ParamConfig.BOOLEAN(1);\n\trotate_speed = ParamConfig.FLOAT(0.5);\n\tmin_distance = ParamConfig.FLOAT(1, {\n\t\trange: [0, 100],\n\t\trange_locked: [true, false],\n\t});\n\tmax_distance = ParamConfig.FLOAT(50, {\n\t\trange: [0, 100],\n\t\trange_locked: [true, false],\n\t});\n\tpolar_angle_range = ParamConfig.VECTOR2([0, '$PI']);\n}\nconst ParamsConfig = new CameraOrbitEventParamsConfig();\n\nexport class CameraOrbitControlsEventNode extends TypedCameraControlsEventNode<CameraOrbitEventParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'camera_orbit_controls';\n\t}\n\t// static required_three_imports() {\n\t// \treturn ['controls/OrbitControls'];\n\t// }\n\n\tasync create_controls_instance(camera: Camera, element: HTMLElement) {\n\t\t// const c = this.constructor as typeof CameraOrbitControlsEventNode;\n\t\t// const {OrbitControls} = await CoreScriptLoader.module(c.required_imports()[0]);\n\n\t\tconst controls = new OrbitControls(camera, element);\n\t\treturn controls;\n\t}\n\n\tsetup_controls(controls: OrbitControls) {\n\t\tcontrols.enablePan = this.pv.allow_pan;\n\t\tcontrols.enableRotate = this.pv.allow_rotate;\n\t\tcontrols.enableZoom = this.pv.allow_zoom;\n\n\t\tcontrols.enableDamping = this.pv.tdamping;\n\t\tcontrols.dampingFactor = this.pv.damping;\n\n\t\tcontrols.rotateSpeed = this.pv.rotate_speed;\n\n\t\tcontrols.screenSpacePanning = this.pv.screen_space_panning;\n\n\t\tcontrols.minDistance = this.pv.min_distance;\n\t\tcontrols.maxDistance = this.pv.max_distance;\n\n\t\tcontrols.minPolarAngle = this.pv.polar_angle_range.x;\n\t\tcontrols.maxPolarAngle = this.pv.polar_angle_range.y;\n\n\t\t// to prevent moving the camera when using the arrows to change frame\n\t\tcontrols.enableKeys = false;\n\t}\n\n\tset_from_camera_node(controls: CameraControls, camera_node: BaseCameraObjNodeType): void {\n\t\tconst target = camera_node.params.vector3('target');\n\t\tcontrols.target.copy(target);\n\t}\n}\n","import lodash_trim from 'lodash/trim';\n\nimport {TypedGlNode, BaseGlNodeType} from './_Base';\n// import {BaseNodeGlMathFunctionArg1} from './_BaseMathFunctionArg1';\nimport {ConnectionPointType} from '../utils/connections/ConnectionPointType';\nimport {BaseNamedConnectionPointType} from '../utils/connections/NamedConnectionPoint';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nconst INPUT_NAME = 'export';\nconst OUTPUT_NAME = 'val';\n\nimport {TypedNamedConnectionPoint} from '../utils/connections/NamedConnectionPoint';\nconst ConnectionPointTypesAvailableForAttribute = [\n\tConnectionPointType.FLOAT,\n\tConnectionPointType.VEC2,\n\tConnectionPointType.VEC3,\n\tConnectionPointType.VEC4,\n];\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ShadersCollectionController} from './code/utils/ShadersCollectionController';\nclass AttributeGlParamsConfig extends NodeParamsConfig {\n\tname = ParamConfig.STRING('');\n\ttype = ParamConfig.INTEGER(0, {\n\t\tmenu: {\n\t\t\tentries: ConnectionPointTypesAvailableForAttribute.map((name, i) => {\n\t\t\t\treturn {name: name, value: i};\n\t\t\t}),\n\t\t},\n\t});\n}\nconst ParamsConfig = new AttributeGlParamsConfig();\n\nexport class AttributeGlNode extends TypedGlNode<AttributeGlParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attribute';\n\t}\n\n\tprivate _update_signature_if_required_bound = this._update_signature_if_required.bind(this);\n\tinitialize_node() {\n\t\tthis.params.add_on_scene_load_hook('_update_signature_if_required', this._update_signature_if_required_bound);\n\t\tthis.add_post_dirty_hook('_update_signature_if_required', this._update_signature_if_required_bound);\n\t}\n\tcreate_params() {\n\t\tif (this.material_node?.assembler_controller.allow_attribute_exports()) {\n\t\t\tthis.add_param(ParamType.BOOLEAN, 'export_when_connected', 0);\n\t\t}\n\t}\n\tinputless_params_names(): string[] {\n\t\treturn ['type'];\n\t}\n\n\tget input_name() {\n\t\treturn INPUT_NAME;\n\t}\n\tget output_name() {\n\t\treturn OUTPUT_NAME;\n\t}\n\n\t// private create_inputs_from_params() {\n\t// \tif (this.material_node.allow_attribute_exports) {\n\t// \t\t// this.set_named_inputs([new TypedConnectionFloat(AttributeGlNode.input_name())]);\n\t// \t\tthis.io.inputs.set_named_input_connection_points([\n\t// \t\t\tnew TypedNamedConnectionPoint(INPUT_NAME, ConnectionPointTypes[this.pv.type]),\n\t// \t\t]);\n\t// \t\t// this._init_graph_node_inputs();\n\t// \t}\n\t// }\n\n\tset_lines(shaders_collection_controller: ShadersCollectionController) {\n\t\t// if (lines_controller.shader_name) {\n\t\tthis.material_node?.assembler_controller.assembler.set_node_lines_attribute(\n\t\t\tthis,\n\t\t\tshaders_collection_controller\n\t\t);\n\t\t// }\n\t}\n\n\t// update_output_type(constructor) {\n\t// \tconst named_output = new constructor(Attribute.output_name());\n\t// \tthis.set_named_outputs([named_output]);\n\t// }\n\t// update_input_type(constructor) {\n\t// \tconst named_input = new constructor(Attribute.input_name());\n\t// \tthis.set_named_inputs([named_input]);\n\t// \tthis._init_graph_node_inputs();\n\t// }\n\n\tget attribute_name(): string {\n\t\treturn lodash_trim(this.pv.name);\n\t}\n\tgl_type(): ConnectionPointType {\n\t\treturn this.io.outputs.named_output_connection_points[0].type;\n\t}\n\t//\n\t//\n\t// Utility methods for SOP/ParticlesSystemGPU and Assembler/Particles\n\t//\n\t//\n\tconnected_input_node(): BaseGlNodeType | null {\n\t\t// if (this.io.inputs.has_named_inputs) {\n\t\treturn this.io.inputs.named_input(INPUT_NAME);\n\t\t// }\n\t}\n\tconnected_input_connection_point(): BaseNamedConnectionPointType | undefined {\n\t\treturn this.io.inputs.named_input_connection_point(INPUT_NAME);\n\t}\n\t// connected_input(): NamedConnection {\n\t// \tconst connection_point = this.connected_input_connection_point();\n\t// \tif (connection_point) {\n\t// \t\treturn this.io.inputs.named_inputs().filter((ni) => ni.name() == Attribute.input_name())[0];\n\t// \t}\n\t// }\n\toutput_connection_point(): BaseNamedConnectionPointType | undefined {\n\t\t// if (this.io.inputs.has_named_inputs) {\n\t\treturn this.io.outputs.named_output_connection_points_by_name(this.input_name);\n\t\t// }\n\t}\n\t// connected_output(): NamedConnection {\n\t// \tconst output = this.named_output(0);\n\t// \tif (output) {\n\t// \t\treturn output; //this.named_inputs().filter(ni=>ni.name() == Attribute.input_name())[0]\n\t// \t}\n\t// }\n\tget is_importing(): boolean {\n\t\treturn this.io.outputs.used_output_names().length > 0; // TODO: typescript - ensure that we can check that the connected outputs are part of the nodes retrived by the node traverser\n\t}\n\tget is_exporting(): boolean {\n\t\tif (this.pv.export_when_connected) {\n\t\t\tconst input_node = this.io.inputs.named_input(INPUT_NAME);\n\t\t\treturn input_node != null;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//\n\t//\n\t// SIGNATURE\n\t//\n\t//\n\tprivate _update_signature_if_required(dirty_trigger?: CoreGraphNode) {\n\t\tif (!this.lifecycle.creation_completed || dirty_trigger == this.p.type) {\n\t\t\tthis.update_input_and_output_types();\n\t\t\tthis.remove_dirty_state();\n\t\t\tthis.make_output_nodes_dirty();\n\t\t}\n\t\tthis.material_node?.assembler_controller.set_compilation_required_and_dirty(this);\n\t}\n\tprivate update_input_and_output_types() {\n\t\tthis.io.outputs.set_named_output_connection_points([\n\t\t\tnew TypedNamedConnectionPoint(this.output_name, ConnectionPointTypesAvailableForAttribute[this.pv.type]),\n\t\t]);\n\t\tif (this.material_node?.assembler_controller.allow_attribute_exports()) {\n\t\t\tthis.io.inputs.set_named_input_connection_points([\n\t\t\t\tnew TypedNamedConnectionPoint(this.input_name, ConnectionPointTypesAvailableForAttribute[this.pv.type]),\n\t\t\t]);\n\t\t}\n\t}\n}\n","import {BaseController} from './_BaseController';\nimport {Material} from 'three/src/materials/Material';\nimport {Texture} from 'three/src/textures/Texture';\nimport {FileCopNode} from 'src/engine/nodes/cop/File';\nimport {BaseMatNodeType} from '../_Base';\n\nimport {ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {BaseCopNodeType} from '../../cop/_Base';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\nimport {BooleanParam} from 'src/engine/params/Boolean';\nimport {BaseNodeType} from '../../_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nexport function TextureMapParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tuse_map = ParamConfig.BOOLEAN(0);\n\t\tmap = ParamConfig.OPERATOR_PATH(FileCopNode.DEFAULT_NODE_PATH.UV, {visible_if: {use_map: 1}});\n\t};\n}\n// class TextureMapMaterial<T extends string> extends Material {\n// \t[T]!: Texture | null;\n// }\n// class TextureMapParamsConfig extends TextureMapParamConfig(NodeParamsConfig) {}\n// class TextureMapMatNode extends TypedMatNode<TextureMapMaterial, TextureMapParamsConfig> {\n// \tcreate_material() {\n// \t\treturn new TextureMapMaterial();\n// \t}\n// }\n\ntype FilterFlags<Base, Condition> = {\n\t[Key in keyof Base]: Base[Key] extends Condition ? Key : never;\n};\ntype AllowedNames<Base, Condition> = FilterFlags<Base, Condition>[keyof Base];\ntype SubType<Base, Condition> = Pick<Base, AllowedNames<Base, Condition>>;\n\n// type test = FilterFlags<MeshLambertMaterial, Texture|null>\n// type test2 = AllowedNames<MeshLambertMaterial, Texture|null>\n// type test3 = SubType<MeshLambertMaterial, Texture|null>\n\nexport function BooleanParamOptions(controller_class: typeof BaseTextureMapController) {\n\treturn {\n\t\tcook: false,\n\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\tcontroller_class.update(node as BaseMatNodeType);\n\t\t},\n\t};\n}\nexport function OperatorPathOptions(controller: typeof BaseTextureMapController, use_map_name: string) {\n\treturn {\n\t\tvisible_if: {[use_map_name]: 1},\n\t\tnode_selection: {context: NodeContext.COP},\n\t\tcook: false,\n\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\tcontroller.update(node as BaseMatNodeType);\n\t\t},\n\t};\n}\n\nexport class BaseTextureMapController extends BaseController {\n\t// add_params() {\n\t// \tthis.node.add_param(ParamType.BOOLEAN, 'skinning', 0);\n\t// }\n\tprotected add_hooks(use_map_param: BooleanParam, path_param: OperatorPathParam) {\n\t\tuse_map_param.add_post_dirty_hook('TextureController', () => {\n\t\t\tthis.update();\n\t\t});\n\t\tpath_param.add_post_dirty_hook('TextureController', () => {\n\t\t\tthis.update();\n\t\t});\n\t}\n\tstatic update(node: BaseNodeType) {}\n\n\tasync _update_texture<M extends Material>(\n\t\tmaterial: M,\n\t\tmat_attrib_name: keyof SubType<M, Texture | null>,\n\t\tuse_map_param: BooleanParam,\n\t\tpath_param: OperatorPathParam\n\t) {\n\t\t// if(!(mat_attrib_name in material)){\n\t\t// \treturn\n\t\t// }\n\t\tif (use_map_param.is_dirty) {\n\t\t\tuse_map_param.compute();\n\t\t}\n\t\tconst use_map: boolean = use_map_param.value;\n\n\t\tif (use_map) {\n\t\t\tif (path_param.is_dirty) {\n\t\t\t\tawait path_param.compute();\n\t\t\t}\n\n\t\t\tconst found_node = path_param.found_node();\n\t\t\tif (found_node) {\n\t\t\t\tif (found_node.node_context() == NodeContext.COP) {\n\t\t\t\t\tconst texture_node = found_node as BaseCopNodeType;\n\n\t\t\t\t\t// if the texture has already been created, we don't have to wait for request_container\n\t\t\t\t\t// if (texture_node.texture) {\n\t\t\t\t\t// \tconsole.log('no wait');\n\t\t\t\t\t// \ttexture_node.request_container();\n\t\t\t\t\t// } else {\n\t\t\t\t\t// \tconsole.log('wait');\n\t\t\t\t\tconst container = await texture_node.request_container();\n\t\t\t\t\tconst texture = container.texture();\n\t\t\t\t\t// }\n\n\t\t\t\t\tif (texture) {\n\t\t\t\t\t\tconst has_no_texture = material[mat_attrib_name] == null;\n\t\t\t\t\t\tlet texture_is_different = false;\n\t\t\t\t\t\tif (material[mat_attrib_name]) {\n\t\t\t\t\t\t\tconst current_texture: Texture = (<unknown>material[mat_attrib_name]) as Texture;\n\t\t\t\t\t\t\tif (current_texture.uuid != texture.uuid) {\n\t\t\t\t\t\t\t\ttexture_is_different = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (has_no_texture || texture_is_different) {\n\t\t\t\t\t\t\tmaterial[mat_attrib_name] = texture as any;\n\t\t\t\t\t\t\tmaterial.needsUpdate = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.node.states.error.set(`found node has no texture`);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.states.error.set(`found map node is not a COP node`);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.node.states.error.set(`could not find map node ${path_param.name} with path ${path_param.value}`);\n\t\t\t}\n\t\t}\n\t\tif (material[mat_attrib_name]) {\n\t\t\tmaterial[mat_attrib_name] = null as any;\n\t\t\tmaterial.needsUpdate = true;\n\t\t}\n\t}\n}\n","export enum LineType {\n\tFUNCTION_DECLARATION = 'function_declaration',\n\tDEFINE = 'define',\n\tBODY = 'body',\n}\n","import {TypedObjNode, ObjNodeRenderOrder} from './_Base';\nimport {Light} from 'three/src/lights/Light';\nimport {Color} from 'three/src/math/Color';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {FlagsControllerD} from '../utils/FlagsController';\nimport {Group} from 'three/src/objects/Group';\n\nexport abstract class TypedLightObjNode<L extends Light, K extends NodeParamsConfig> extends TypedObjNode<Group, K> {\n\tpublic readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\tpublic readonly render_order: number = ObjNodeRenderOrder.LIGHT;\n\tprotected _color_with_intensity = new Color(0x00000);\n\tprotected _light!: L;\n\tget light() {\n\t\treturn this._light;\n\t}\n\tprotected abstract create_light(): L;\n\tprotected _used_in_scene: boolean = true;\n\tinitialize_base_node() {\n\t\tsuper.initialize_base_node();\n\n\t\tthis._light = this.create_light();\n\t\tthis.object.add(this._light);\n\t\tthis.flags.display.add_hook(() => {\n\t\t\tthis.update_light_attachment();\n\t\t});\n\t\tthis.dirty_controller.add_post_dirty_hook(\n\t\t\t'_cook_main_without_inputs_when_dirty',\n\t\t\tthis._cook_main_without_inputs_when_dirty_bound\n\t\t);\n\t}\n\tprivate _cook_main_without_inputs_when_dirty_bound = this._cook_main_without_inputs_when_dirty.bind(this);\n\tprivate async _cook_main_without_inputs_when_dirty() {\n\t\t// if (this.used_in_scene) {\n\t\tawait this.cook_controller.cook_main_without_inputs();\n\t\t// }\n\t}\n\tprivate update_light_attachment() {\n\t\tif (this.flags.display.active) {\n\t\t\tthis.object.add(this.light);\n\t\t\tthis._cook_main_without_inputs_when_dirty();\n\t\t} else {\n\t\t\tthis.object.remove(this.light);\n\t\t}\n\t}\n\n\t// create_params() {\n\t// \t// this.create_light_params();\n\t// \t// this.create_shadow_params_main();\n\t// }\n\n\tcreate_shadow_params_main() {\n\t\tif (this._light.shadow != null) {\n\t\t\treturn this.create_shadow_params();\n\t\t}\n\t}\n\n\tprotected create_light_params(): void {}\n\tprotected update_light_params(): void {}\n\n\tprotected create_shadow_params() {\n\t\treturn;\n\t\t// this.add_param('toggle', 'cast_shadows', 1);\n\t\t// shadow_options = {visible_if: {cast_shadows: 1}}\n\t\t// this.add_param( 'vector2', 'shadow_res', [1024, 1024], shadow_options );\n\t\t// this.add_param( 'float', 'shadow_near', 0.1, shadow_options );\n\t\t// this.add_param( 'float', 'shadow_far', 100, shadow_options );\n\t\t// // this.add_param( 'float', 'shadow_far', 500 ) # same as param distance\n\t\t// this.add_param( 'float', 'shadow_bias', -0.0001, shadow_options );\n\t\t// this.add_param( 'float', 'shadow_blur', 1, shadow_options );\n\t}\n\n\t// as_code_set_up_custom: ->\n\t// \tlines = []\n\t// \tlines.push \"#{this.code_var_name()}.set_display_flag(#{this.display_flag_state()})\"\n\t// \tlines\n\n\tcook() {\n\t\tthis.update_light_params();\n\t\tthis.update_shadow_params();\n\t\tthis.cook_controller.end_cook();\n\t}\n\n\tupdate_shadow_params() {\n\t\t// let object;\n\t\t// return;\n\t\t// if (((object = this.object()) != null) && (object.shadow != null)) {\n\t\t// \tobject.castShadow = this._param_cast_shadow;\n\t\t// \tobject.shadow.mapSize.width = this._param_shadow_res.x;\n\t\t// \tobject.shadow.mapSize.height = this._param_shadow_res.y;\n\t\t// \tobject.shadow.camera.near = this._param_shadow_near;\n\t\t// \tobject.shadow.camera.far = this._param_shadow_far;\n\t\t// \treturn object.shadow.bias = this._param_shadow_bias;\n\t\t// }\n\t}\n\n\tget color_with_intensity() {\n\t\tconst color = this.params.color('color');\n\t\tconst intensity = this.params.float('intensity');\n\t\tthis._color_with_intensity.copy(color).multiplyScalar(intensity);\n\t\treturn this._color_with_intensity;\n\t}\n\tget active(): boolean {\n\t\treturn this.flags.display.active;\n\t}\n}\n\nexport type BaseLightObjNodeType = TypedLightObjNode<Light, NodeParamsConfig>;\n// export class BaseLightObjNodeClass extends TypedLightObjNode<Light, NodeParamsConfig> {}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {Color} from 'three/src/math/Color';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {AnimationClip} from 'three/src/animation/AnimationClip';\nimport {Material} from 'three/src/materials/Material';\nimport {SkinnedMesh} from 'three/src/objects/SkinnedMesh';\nimport {Bone} from 'three/src/objects/Bone';\n\n// import {CoreConstant} from './Constant'\nimport {CoreGeometry} from './Geometry';\nimport {GroupString} from './Group';\nimport {CoreAttribute} from './Attribute';\nimport {CoreConstant} from './Constant';\nimport {CorePoint} from './Point';\nimport {CoreMaterial, ShaderMaterialWithCustomMaterials} from './Material';\nimport {CoreString} from 'src/core/String';\n\nimport lodash_cloneDeep from 'lodash/cloneDeep';\nimport lodash_isString from 'lodash/isString';\nimport lodash_isArray from 'lodash/isArray';\nimport lodash_isNumber from 'lodash/isNumber';\nimport {CoreEntity} from './Entity';\nconst PTNUM = 'ptnum';\nconst NAME_ATTR = 'name';\nconst ATTRIBUTES = 'attributes';\n\ninterface Object3DWithAnimations extends Object3D {\n\tanimations: AnimationClip[];\n}\ninterface MaterialWithColor extends Material {\n\tcolor: Color;\n}\ninterface SkinnedMeshWithisSkinnedMesh extends SkinnedMesh {\n\treadonly isSkinnedMesh: boolean;\n}\n\nexport class CoreObject extends CoreEntity {\n\tconstructor(private _object: Object3D, index: number) {\n\t\tsuper(index);\n\t\tif (this._object.userData[ATTRIBUTES] == null) {\n\t\t\tthis._object.userData[ATTRIBUTES] = {};\n\t\t}\n\t}\n\n\t// set_index(i: number) {\n\t// \tthis._index = i;\n\t// }\n\n\tobject() {\n\t\treturn this._object;\n\t}\n\tgeometry() {\n\t\treturn (this._object as Mesh).geometry as BufferGeometry;\n\t}\n\tcore_geometry(): CoreGeometry {\n\t\tconst geo = this.geometry();\n\t\treturn new CoreGeometry(geo);\n\t\t// const geo = this.geometry()\n\t\t// if (geo) {\n\t\t// \treturn new CoreGeometry(geo)\n\t\t// } else {\n\t\t// \treturn null\n\t\t// }\n\t}\n\tpoints() {\n\t\treturn this.core_geometry().points();\n\t}\n\tpoints_from_group(group: GroupString): CorePoint[] {\n\t\tif (group) {\n\t\t\tconst indices = CoreString.indices(group);\n\t\t\tif (indices) {\n\t\t\t\tconst points = this.points();\n\t\t\t\treturn indices.map((i) => points[i]);\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t} else {\n\t\t\treturn this.points();\n\t\t}\n\t}\n\n\tcompute_vertex_normals() {\n\t\tthis.core_geometry().compute_vertex_normals();\n\t}\n\n\tadd_attribute(name: string, value: AttribValue) {\n\t\tlet data;\n\t\tif (!lodash_isNumber(value) && !lodash_isArray(value) && !lodash_isString(value)) {\n\t\t\tdata = (value as Vector3).toArray();\n\t\t} else {\n\t\t\tdata = value;\n\t\t}\n\t\tthis._object.userData[ATTRIBUTES][name] = data;\n\t}\n\tadd_numeric_attrib(name: string, value: NumericAttribValue) {\n\t\tthis.add_attribute(name, value);\n\t}\n\tset_attrib_value(name: string, value: AttribValue) {\n\t\tthis.add_attribute(name, value);\n\t}\n\tadd_numeric_vertex_attrib(name: string, size: number, default_value: NumericAttribValue) {\n\t\tif (default_value == null) {\n\t\t\tdefault_value = CoreAttribute.default_value(size);\n\t\t}\n\t\tthis.core_geometry().add_numeric_attrib(name, size, default_value);\n\t}\n\n\tattribute_names(): string[] {\n\t\t// TODO: to remove\n\t\treturn Object.keys(this._object.userData[ATTRIBUTES]);\n\t}\n\tattrib_names(): string[] {\n\t\treturn this.attribute_names();\n\t}\n\n\thas_attrib(name: string): boolean {\n\t\treturn this.attribute_names().includes(name);\n\t}\n\n\trename_attribute(old_name: string, new_name: string) {\n\t\tthis.add_attribute(new_name, this.attrib_value(old_name));\n\t\tthis.delete_attribute(old_name);\n\t}\n\n\tdelete_attribute(name: string) {\n\t\tdelete this._object.userData[ATTRIBUTES][name];\n\t}\n\n\tattrib_value(name: string): AttribValue {\n\t\tif (name === PTNUM) {\n\t\t\treturn this.index;\n\t\t} else {\n\t\t\tlet val = this._object.userData[ATTRIBUTES][name];\n\t\t\tif (val == null) {\n\t\t\t\tif (name == NAME_ATTR) {\n\t\t\t\t\tval = this._object.name;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn val;\n\t\t}\n\t}\n\tname(): string {\n\t\treturn this.attrib_value(NAME_ATTR) as string;\n\t}\n\thuman_type(): string {\n\t\treturn CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[this._object.constructor.name];\n\t}\n\n\tattrib_type(name: string) {\n\t\tconst val = this.attrib_value(name);\n\t\tif (lodash_isString(val)) {\n\t\t\treturn CoreConstant.ATTRIB_TYPE.STRING;\n\t\t} else {\n\t\t\treturn CoreConstant.ATTRIB_TYPE.NUMERIC;\n\t\t}\n\t}\n\n\tattrib_size(name: string) {\n\t\tconst val = this.attrib_value(name);\n\t\tif (val == null) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (lodash_isString(val) || lodash_isNumber(val)) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\tswitch (val.constructor) {\n\t\t\t\tcase Vector2:\n\t\t\t\t\treturn 2;\n\t\t\t\tcase Vector3:\n\t\t\t\t\treturn 3;\n\t\t\t\tdefault:\n\t\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tclone() {\n\t\treturn CoreObject.clone(this._object);\n\t}\n\n\tstatic clone(src_object: Object3D) {\n\t\tconst new_object = src_object.clone();\n\n\t\tvar sourceLookup = new Map<Object3D, Object3D>();\n\t\tvar cloneLookup = new Map<Object3D, Object3D>();\n\t\tCoreObject.parallelTraverse(src_object, new_object, function(sourceNode: Object3D, clonedNode: Object3D) {\n\t\t\tsourceLookup.set(clonedNode, sourceNode);\n\t\t\tcloneLookup.set(sourceNode, clonedNode);\n\t\t});\n\t\tnew_object.traverse(function(node) {\n\t\t\tconst src_node = sourceLookup.get(node) as SkinnedMesh;\n\t\t\tconst mesh_node = node as Mesh;\n\n\t\t\tif (mesh_node.geometry) {\n\t\t\t\tconst src_node_geometry = src_node.geometry as BufferGeometry;\n\t\t\t\tmesh_node.geometry = CoreGeometry.clone(src_node_geometry);\n\t\t\t\tconst mesh_node_geometry = mesh_node.geometry as BufferGeometry;\n\t\t\t\tif (mesh_node_geometry.userData) {\n\t\t\t\t\tmesh_node_geometry.userData = lodash_cloneDeep(src_node_geometry.userData);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (mesh_node.material) {\n\t\t\t\tmesh_node.material = src_node.material;\n\t\t\t\tCoreMaterial.apply_custom_materials(node, mesh_node.material as ShaderMaterialWithCustomMaterials);\n\n\t\t\t\t// prevents crashes for linesegments with shader material such as the line dashed instance\n\t\t\t\t// TODO: test\n\t\t\t\tconst material_with_color = mesh_node.material as MaterialWithColor;\n\t\t\t\tif (material_with_color.color == null) {\n\t\t\t\t\tmaterial_with_color.color = new Color(1, 1, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (src_object.userData) {\n\t\t\t\tnode.userData = lodash_cloneDeep(src_node.userData);\n\t\t\t}\n\n\t\t\tconst src_node_with_animations = (<unknown>src_node) as Object3DWithAnimations;\n\t\t\tif (src_node_with_animations.animations) {\n\t\t\t\t(node as Object3DWithAnimations).animations = src_node_with_animations.animations.map((animation) =>\n\t\t\t\t\tanimation.clone()\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst skinned_node = node as SkinnedMesh;\n\t\t\tif ((skinned_node as SkinnedMeshWithisSkinnedMesh).isSkinnedMesh) {\n\t\t\t\tvar clonedMesh = skinned_node;\n\t\t\t\tvar sourceMesh = src_node;\n\t\t\t\tvar sourceBones = sourceMesh.skeleton.bones;\n\n\t\t\t\tclonedMesh.skeleton = sourceMesh.skeleton.clone();\n\t\t\t\tclonedMesh.bindMatrix.copy(sourceMesh.bindMatrix);\n\n\t\t\t\tconst new_bones = sourceBones.map(function(bone) {\n\t\t\t\t\treturn cloneLookup.get(bone);\n\t\t\t\t}) as Bone[];\n\n\t\t\t\tclonedMesh.skeleton.bones = new_bones;\n\n\t\t\t\tclonedMesh.bind(clonedMesh.skeleton, clonedMesh.bindMatrix);\n\t\t\t}\n\t\t});\n\n\t\treturn new_object;\n\t}\n\n\tstatic parallelTraverse(a: Object3D, b: Object3D, callback: (a: Object3D, b: Object3D) => void) {\n\t\tcallback(a, b);\n\t\tfor (var i = 0; i < a.children.length; i++) {\n\t\t\tthis.parallelTraverse(a.children[i], b.children[i], callback);\n\t\t}\n\t}\n}\n","import {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {InterleavedBuffer} from 'three/src/core/InterleavedBuffer';\nimport {InterleavedBufferAttribute} from 'three/src/core/InterleavedBufferAttribute';\nimport {TriangleFanDrawMode} from 'three/src/constants';\nimport {TriangleStripDrawMode} from 'three/src/constants';\nimport {TrianglesDrawMode} from 'three/src/constants';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Vector3} from 'three/src/math/Vector3';\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\n\nvar BufferGeometryUtils = {\n\n\tcomputeTangents: function ( geometry ) {\n\n\t\tvar index = geometry.index;\n\t\tvar attributes = geometry.attributes;\n\n\t\t// based on http://www.terathon.com/code/tangent.html\n\t\t// (per vertex tangents)\n\n\t\tif ( index === null ||\n\t\t\t attributes.position === undefined ||\n\t\t\t attributes.normal === undefined ||\n\t\t\t attributes.uv === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar indices = index.array;\n\t\tvar positions = attributes.position.array;\n\t\tvar normals = attributes.normal.array;\n\t\tvar uvs = attributes.uv.array;\n\n\t\tvar nVertices = positions.length / 3;\n\n\t\tif ( attributes.tangent === undefined ) {\n\n\t\t\tgeometry.setAttribute( 'tangent', new BufferAttribute( new Float32Array( 4 * nVertices ), 4 ) );\n\n\t\t}\n\n\t\tvar tangents = attributes.tangent.array;\n\n\t\tvar tan1 = [], tan2 = [];\n\n\t\tfor ( var i = 0; i < nVertices; i ++ ) {\n\n\t\t\ttan1[ i ] = new Vector3();\n\t\t\ttan2[ i ] = new Vector3();\n\n\t\t}\n\n\t\tvar vA = new Vector3(),\n\t\t\tvB = new Vector3(),\n\t\t\tvC = new Vector3(),\n\n\t\t\tuvA = new Vector2(),\n\t\t\tuvB = new Vector2(),\n\t\t\tuvC = new Vector2(),\n\n\t\t\tsdir = new Vector3(),\n\t\t\ttdir = new Vector3();\n\n\t\tfunction handleTriangle( a, b, c ) {\n\n\t\t\tvA.fromArray( positions, a * 3 );\n\t\t\tvB.fromArray( positions, b * 3 );\n\t\t\tvC.fromArray( positions, c * 3 );\n\n\t\t\tuvA.fromArray( uvs, a * 2 );\n\t\t\tuvB.fromArray( uvs, b * 2 );\n\t\t\tuvC.fromArray( uvs, c * 2 );\n\n\t\t\tvB.sub( vA );\n\t\t\tvC.sub( vA );\n\n\t\t\tuvB.sub( uvA );\n\t\t\tuvC.sub( uvA );\n\n\t\t\tvar r = 1.0 / ( uvB.x * uvC.y - uvC.x * uvB.y );\n\n\t\t\t// silently ignore degenerate uv triangles having coincident or colinear vertices\n\n\t\t\tif ( ! isFinite( r ) ) return;\n\n\t\t\tsdir.copy( vB ).multiplyScalar( uvC.y ).addScaledVector( vC, - uvB.y ).multiplyScalar( r );\n\t\t\ttdir.copy( vC ).multiplyScalar( uvB.x ).addScaledVector( vB, - uvC.x ).multiplyScalar( r );\n\n\t\t\ttan1[ a ].add( sdir );\n\t\t\ttan1[ b ].add( sdir );\n\t\t\ttan1[ c ].add( sdir );\n\n\t\t\ttan2[ a ].add( tdir );\n\t\t\ttan2[ b ].add( tdir );\n\t\t\ttan2[ c ].add( tdir );\n\n\t\t}\n\n\t\tvar groups = geometry.groups;\n\n\t\tif ( groups.length === 0 ) {\n\n\t\t\tgroups = [ {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: indices.length\n\t\t\t} ];\n\n\t\t}\n\n\t\tfor ( var i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tvar group = groups[ i ];\n\n\t\t\tvar start = group.start;\n\t\t\tvar count = group.count;\n\n\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleTriangle(\n\t\t\t\t\tindices[ j + 0 ],\n\t\t\t\t\tindices[ j + 1 ],\n\t\t\t\t\tindices[ j + 2 ]\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar tmp = new Vector3(), tmp2 = new Vector3();\n\t\tvar n = new Vector3(), n2 = new Vector3();\n\t\tvar w, t, test;\n\n\t\tfunction handleVertex( v ) {\n\n\t\t\tn.fromArray( normals, v * 3 );\n\t\t\tn2.copy( n );\n\n\t\t\tt = tan1[ v ];\n\n\t\t\t// Gram-Schmidt orthogonalize\n\n\t\t\ttmp.copy( t );\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\n\n\t\t\t// Calculate handedness\n\n\t\t\ttmp2.crossVectors( n2, t );\n\t\t\ttest = tmp2.dot( tan2[ v ] );\n\t\t\tw = ( test < 0.0 ) ? - 1.0 : 1.0;\n\n\t\t\ttangents[ v * 4 ] = tmp.x;\n\t\t\ttangents[ v * 4 + 1 ] = tmp.y;\n\t\t\ttangents[ v * 4 + 2 ] = tmp.z;\n\t\t\ttangents[ v * 4 + 3 ] = w;\n\n\t\t}\n\n\t\tfor ( var i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tvar group = groups[ i ];\n\n\t\t\tvar start = group.start;\n\t\t\tvar count = group.count;\n\n\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleVertex( indices[ j + 0 ] );\n\t\t\t\thandleVertex( indices[ j + 1 ] );\n\t\t\t\thandleVertex( indices[ j + 2 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\t/**\n\t * @param  {Array<BufferGeometry>} geometries\n\t * @param  {Boolean} useGroups\n\t * @return {BufferGeometry}\n\t */\n\tmergeBufferGeometries: function ( geometries, useGroups ) {\n\n\t\tvar isIndexed = geometries[ 0 ].index !== null;\n\n\t\tvar attributesUsed = new Set( Object.keys( geometries[ 0 ].attributes ) );\n\t\tvar morphAttributesUsed = new Set( Object.keys( geometries[ 0 ].morphAttributes ) );\n\n\t\tvar attributes = {};\n\t\tvar morphAttributes = {};\n\n\t\tvar morphTargetsRelative = geometries[ 0 ].morphTargetsRelative;\n\n\t\tvar mergedGeometry = new BufferGeometry();\n\n\t\tvar offset = 0;\n\n\t\tfor ( var i = 0; i < geometries.length; ++ i ) {\n\n\t\t\tvar geometry = geometries[ i ];\n\n\t\t\t// ensure that all geometries are indexed, or none\n\n\t\t\tif ( isIndexed !== ( geometry.index !== null ) ) return null;\n\n\t\t\t// gather attributes, exit early if they're different\n\n\t\t\tfor ( var name in geometry.attributes ) {\n\n\t\t\t\tif ( ! attributesUsed.has( name ) ) return null;\n\n\t\t\t\tif ( attributes[ name ] === undefined ) attributes[ name ] = [];\n\n\t\t\t\tattributes[ name ].push( geometry.attributes[ name ] );\n\n\t\t\t}\n\n\t\t\t// gather morph attributes, exit early if they're different\n\n\t\t\tif ( morphTargetsRelative !== geometry.morphTargetsRelative ) return null;\n\n\t\t\tfor ( var name in geometry.morphAttributes ) {\n\n\t\t\t\tif ( ! morphAttributesUsed.has( name ) ) return null;\n\n\t\t\t\tif ( morphAttributes[ name ] === undefined ) morphAttributes[ name ] = [];\n\n\t\t\t\tmorphAttributes[ name ].push( geometry.morphAttributes[ name ] );\n\n\t\t\t}\n\n\t\t\t// gather .userData\n\n\t\t\tmergedGeometry.userData.mergedUserData = mergedGeometry.userData.mergedUserData || [];\n\t\t\tmergedGeometry.userData.mergedUserData.push( geometry.userData );\n\n\t\t\tif ( useGroups ) {\n\n\t\t\t\tvar count;\n\n\t\t\t\tif ( isIndexed ) {\n\n\t\t\t\t\tcount = geometry.index.count;\n\n\t\t\t\t} else if ( geometry.attributes.position !== undefined ) {\n\n\t\t\t\t\tcount = geometry.attributes.position.count;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t\tmergedGeometry.addGroup( offset, count, i );\n\n\t\t\t\toffset += count;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// merge indices\n\n\t\tif ( isIndexed ) {\n\n\t\t\tvar indexOffset = 0;\n\t\t\tvar mergedIndex = [];\n\n\t\t\tfor ( var i = 0; i < geometries.length; ++ i ) {\n\n\t\t\t\tvar index = geometries[ i ].index;\n\n\t\t\t\tfor ( var j = 0; j < index.count; ++ j ) {\n\n\t\t\t\t\tmergedIndex.push( index.getX( j ) + indexOffset );\n\n\t\t\t\t}\n\n\t\t\t\tindexOffset += geometries[ i ].attributes.position.count;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.setIndex( mergedIndex );\n\n\t\t}\n\n\t\t// merge attributes\n\n\t\tfor ( var name in attributes ) {\n\n\t\t\tvar mergedAttribute = this.mergeBufferAttributes( attributes[ name ] );\n\n\t\t\tif ( ! mergedAttribute ) return null;\n\n\t\t\tmergedGeometry.setAttribute( name, mergedAttribute );\n\n\t\t}\n\n\t\t// merge morph attributes\n\n\t\tfor ( var name in morphAttributes ) {\n\n\t\t\tvar numMorphTargets = morphAttributes[ name ][ 0 ].length;\n\n\t\t\tif ( numMorphTargets === 0 ) break;\n\n\t\t\tmergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n\t\t\tmergedGeometry.morphAttributes[ name ] = [];\n\n\t\t\tfor ( var i = 0; i < numMorphTargets; ++ i ) {\n\n\t\t\t\tvar morphAttributesToMerge = [];\n\n\t\t\t\tfor ( var j = 0; j < morphAttributes[ name ].length; ++ j ) {\n\n\t\t\t\t\tmorphAttributesToMerge.push( morphAttributes[ name ][ j ][ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tvar mergedMorphAttribute = this.mergeBufferAttributes( morphAttributesToMerge );\n\n\t\t\t\tif ( ! mergedMorphAttribute ) return null;\n\n\t\t\t\tmergedGeometry.morphAttributes[ name ].push( mergedMorphAttribute );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn mergedGeometry;\n\n\t},\n\n\t/**\n\t * @param {Array<BufferAttribute>} attributes\n\t * @return {BufferAttribute}\n\t */\n\tmergeBufferAttributes: function ( attributes ) {\n\n\t\tvar TypedArray;\n\t\tvar itemSize;\n\t\tvar normalized;\n\t\tvar arrayLength = 0;\n\n\t\tfor ( var i = 0; i < attributes.length; ++ i ) {\n\n\t\t\tvar attribute = attributes[ i ];\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) return null;\n\n\t\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\t\tif ( TypedArray !== attribute.array.constructor ) return null;\n\n\t\t\tif ( itemSize === undefined ) itemSize = attribute.itemSize;\n\t\t\tif ( itemSize !== attribute.itemSize ) return null;\n\n\t\t\tif ( normalized === undefined ) normalized = attribute.normalized;\n\t\t\tif ( normalized !== attribute.normalized ) return null;\n\n\t\t\tarrayLength += attribute.array.length;\n\n\t\t}\n\n\t\tvar array = new TypedArray( arrayLength );\n\t\tvar offset = 0;\n\n\t\tfor ( var i = 0; i < attributes.length; ++ i ) {\n\n\t\t\tarray.set( attributes[ i ].array, offset );\n\n\t\t\toffset += attributes[ i ].array.length;\n\n\t\t}\n\n\t\treturn new BufferAttribute( array, itemSize, normalized );\n\n\t},\n\n\t/**\n\t * @param {Array<BufferAttribute>} attributes\n\t * @return {Array<InterleavedBufferAttribute>}\n\t */\n\tinterleaveAttributes: function ( attributes ) {\n\n\t\t// Interleaves the provided attributes into an InterleavedBuffer and returns\n\t\t// a set of InterleavedBufferAttributes for each attribute\n\t\tvar TypedArray;\n\t\tvar arrayLength = 0;\n\t\tvar stride = 0;\n\n\t\t// calculate the the length and type of the interleavedBuffer\n\t\tfor ( var i = 0, l = attributes.length; i < l; ++ i ) {\n\n\t\t\tvar attribute = attributes[ i ];\n\n\t\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\t\tconsole.warn( 'AttributeBuffers of different types cannot be interleaved' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tarrayLength += attribute.array.length;\n\t\t\tstride += attribute.itemSize;\n\n\t\t}\n\n\t\t// Create the set of buffer attributes\n\t\tvar interleavedBuffer = new InterleavedBuffer( new TypedArray( arrayLength ), stride );\n\t\tvar offset = 0;\n\t\tvar res = [];\n\t\tvar getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\t\tvar setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\t\tfor ( var j = 0, l = attributes.length; j < l; j ++ ) {\n\n\t\t\tvar attribute = attributes[ j ];\n\t\t\tvar itemSize = attribute.itemSize;\n\t\t\tvar count = attribute.count;\n\t\t\tvar iba = new InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, attribute.normalized );\n\t\t\tres.push( iba );\n\n\t\t\toffset += itemSize;\n\n\t\t\t// Move the data for each attribute into the new interleavedBuffer\n\t\t\t// at the appropriate offset\n\t\t\tfor ( var c = 0; c < count; c ++ ) {\n\n\t\t\t\tfor ( var k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\tiba[ setters[ k ] ]( c, attribute[ getters[ k ] ]( c ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn res;\n\n\t},\n\n\t/**\n\t * @param {Array<BufferGeometry>} geometry\n\t * @return {number}\n\t */\n\testimateBytesUsed: function ( geometry ) {\n\n\t\t// Return the estimated memory used by this geometry in bytes\n\t\t// Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n\t\t// for InterleavedBufferAttributes.\n\t\tvar mem = 0;\n\t\tfor ( var name in geometry.attributes ) {\n\n\t\t\tvar attr = geometry.getAttribute( name );\n\t\t\tmem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n\n\t\t}\n\n\t\tvar indices = geometry.getIndex();\n\t\tmem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n\t\treturn mem;\n\n\t},\n\n\t/**\n\t * @param {BufferGeometry} geometry\n\t * @param {number} tolerance\n\t * @return {BufferGeometry>}\n\t */\n\tmergeVertices: function ( geometry, tolerance = 1e-4 ) {\n\n\t\ttolerance = Math.max( tolerance, Number.EPSILON );\n\n\t\t// Generate an index buffer if the geometry doesn't have one, or optimize it\n\t\t// if it's already available.\n\t\tvar hashToIndex = {};\n\t\tvar indices = geometry.getIndex();\n\t\tvar positions = geometry.getAttribute( 'position' );\n\t\tvar vertexCount = indices ? indices.count : positions.count;\n\n\t\t// next value for triangle indices\n\t\tvar nextIndex = 0;\n\n\t\t// attributes and new attribute arrays\n\t\tvar attributeNames = Object.keys( geometry.attributes );\n\t\tvar attrArrays = {};\n\t\tvar morphAttrsArrays = {};\n\t\tvar newIndices = [];\n\t\tvar getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\n\t\t// initialize the arrays\n\t\tfor ( var i = 0, l = attributeNames.length; i < l; i ++ ) {\n\n\t\t\tvar name = attributeNames[ i ];\n\n\t\t\tattrArrays[ name ] = [];\n\n\t\t\tvar morphAttr = geometry.morphAttributes[ name ];\n\t\t\tif ( morphAttr ) {\n\n\t\t\t\tmorphAttrsArrays[ name ] = new Array( morphAttr.length ).fill().map( () => [] );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// convert the error tolerance to an amount of decimal places to truncate to\n\t\tvar decimalShift = Math.log10( 1 / tolerance );\n\t\tvar shiftMultiplier = Math.pow( 10, decimalShift );\n\t\tfor ( var i = 0; i < vertexCount; i ++ ) {\n\n\t\t\tvar index = indices ? indices.getX( i ) : i;\n\n\t\t\t// Generate a hash for the vertex attributes at the current index 'i'\n\t\t\tvar hash = '';\n\t\t\tfor ( var j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\t\tvar name = attributeNames[ j ];\n\t\t\t\tvar attribute = geometry.getAttribute( name );\n\t\t\t\tvar itemSize = attribute.itemSize;\n\n\t\t\t\tfor ( var k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\t// double tilde truncates the decimal value\n\t\t\t\t\thash += `${ ~ ~ ( attribute[ getters[ k ] ]( index ) * shiftMultiplier ) },`;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Add another reference to the vertex if it's already\n\t\t\t// used by another index\n\t\t\tif ( hash in hashToIndex ) {\n\n\t\t\t\tnewIndices.push( hashToIndex[ hash ] );\n\n\t\t\t} else {\n\n\t\t\t\t// copy data to the new index in the attribute arrays\n\t\t\t\tfor ( var j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\t\t\tvar name = attributeNames[ j ];\n\t\t\t\t\tvar attribute = geometry.getAttribute( name );\n\t\t\t\t\tvar morphAttr = geometry.morphAttributes[ name ];\n\t\t\t\t\tvar itemSize = attribute.itemSize;\n\t\t\t\t\tvar newarray = attrArrays[ name ];\n\t\t\t\t\tvar newMorphArrays = morphAttrsArrays[ name ];\n\n\t\t\t\t\tfor ( var k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\t\tvar getterFunc = getters[ k ];\n\t\t\t\t\t\tnewarray.push( attribute[ getterFunc ]( index ) );\n\n\t\t\t\t\t\tif ( morphAttr ) {\n\n\t\t\t\t\t\t\tfor ( var m = 0, ml = morphAttr.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\t\t\tnewMorphArrays[ m ].push( morphAttr[ m ][ getterFunc ]( index ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\thashToIndex[ hash ] = nextIndex;\n\t\t\t\tnewIndices.push( nextIndex );\n\t\t\t\tnextIndex ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Generate typed arrays from new attribute arrays and update\n\t\t// the attributeBuffers\n\t\tconst result = geometry.clone();\n\t\tfor ( var i = 0, l = attributeNames.length; i < l; i ++ ) {\n\n\t\t\tvar name = attributeNames[ i ];\n\t\t\tvar oldAttribute = geometry.getAttribute( name );\n\n\t\t\tvar buffer = new oldAttribute.array.constructor( attrArrays[ name ] );\n\t\t\tvar attribute = new BufferAttribute( buffer, oldAttribute.itemSize, oldAttribute.normalized );\n\n\t\t\tresult.setAttribute( name, attribute );\n\n\t\t\t// Update the attribute arrays\n\t\t\tif ( name in morphAttrsArrays ) {\n\n\t\t\t\tfor ( var j = 0; j < morphAttrsArrays[ name ].length; j ++ ) {\n\n\t\t\t\t\tvar oldMorphAttribute = geometry.morphAttributes[ name ][ j ];\n\n\t\t\t\t\tvar buffer = new oldMorphAttribute.array.constructor( morphAttrsArrays[ name ][ j ] );\n\t\t\t\t\tvar morphAttribute = new BufferAttribute( buffer, oldMorphAttribute.itemSize, oldMorphAttribute.normalized );\n\t\t\t\t\tresult.morphAttributes[ name ][ j ] = morphAttribute;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// indices\n\n\t\tresult.setIndex( newIndices );\n\n\t\treturn result;\n\n\t},\n\n\t/**\n\t * @param {BufferGeometry} geometry\n\t * @param {number} drawMode\n\t * @return {BufferGeometry>}\n\t */\n\ttoTrianglesDrawMode: function ( geometry, drawMode ) {\n\n\t\tif ( drawMode === TrianglesDrawMode ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.' );\n\t\t\treturn geometry;\n\n\t\t}\n\n\t\tif ( drawMode === TriangleFanDrawMode ||drawMode === TriangleStripDrawMode ) {\n\n\t\t\tvar index = geometry.getIndex();\n\n\t\t\t// generate index if not present\n\n\t\t\tif ( index === null ) {\n\n\t\t\t\tvar indices = [];\n\n\t\t\t\tvar position = geometry.getAttribute( 'position' );\n\n\t\t\t\tif ( position !== undefined ) {\n\n\t\t\t\t\tfor ( var i = 0; i < position.count; i ++ ) {\n\n\t\t\t\t\t\tindices.push( i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tgeometry.setIndex( indices );\n\t\t\t\t\tindex = geometry.getIndex();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\t\t\treturn geometry;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tvar numberOfTriangles = index.count - 2;\n\t\t\tvar newIndices = [];\n\n\t\t\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t\t\t// gl.TRIANGLE_FAN\n\n\t\t\t\tfor ( var i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// gl.TRIANGLE_STRIP\n\n\t\t\t\tfor ( var i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t\t\t}\n\n\t\t\t// build final geometry\n\n\t\t\tvar newGeometry = geometry.clone();\n\t\t\tnewGeometry.setIndex( newIndices );\n\t\t\tnewGeometry.clearGroups();\n\n\t\t\treturn newGeometry;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode );\n\t\t\treturn geometry;\n\n\t\t}\n\n\t}\n\n};\n\nexport { BufferGeometryUtils };\n","// import lodash_flatten from 'lodash/flatten'\n// import lodash_map from 'lodash/map'\n\nimport {CoreGeometry} from '../Geometry';\nimport {CorePoint} from '../Point';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n\nexport class CoreGeometryUtilCurve {\n\tstatic accumulated_curve_point_indices(indices: number[]) {\n\t\tlet curve_point_indices: number[] = [];\n\t\tconst accumulated_curve_point_indices = [];\n\t\tlet last_index_added: number | null = null;\n\n\t\t// indices.forEach((index, i) => {\n\t\tlet index: number;\n\t\tfor (let i = 0; i < indices.length; i++) {\n\t\t\tif (i % 2 === 1) {\n\t\t\t\tindex = indices[i];\n\t\t\t\tconst previous_index = indices[i - 1];\n\n\t\t\t\t// if the last added index, from the previous segment\n\t\t\t\t// is the same as the start of the current segment (indices[i-1])\n\t\t\t\t// then this is part of the same curve\n\t\t\t\tif (last_index_added == null || previous_index === last_index_added) {\n\t\t\t\t\t// add the first point\n\t\t\t\t\tif (curve_point_indices.length === 0) {\n\t\t\t\t\t\tcurve_point_indices.push(previous_index);\n\t\t\t\t\t}\n\n\t\t\t\t\tcurve_point_indices.push(index);\n\t\t\t\t\tlast_index_added = index;\n\t\t\t\t} else {\n\t\t\t\t\t// otherwise we create a new curve\n\t\t\t\t\taccumulated_curve_point_indices.push(curve_point_indices);\n\t\t\t\t\t//current_points = lodash_map curve_point_indices, (index)->points[index]\n\t\t\t\t\t//curve_point_indices_groups.push(current_points)\n\t\t\t\t\t//this._create_curve_from_points(current_points)\n\n\t\t\t\t\t// and reset the array\n\t\t\t\t\tcurve_point_indices = [previous_index, index];\n\t\t\t\t\tlast_index_added = index;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// also create with the remaining ones\n\t\taccumulated_curve_point_indices.push(curve_point_indices);\n\n\t\treturn accumulated_curve_point_indices;\n\t}\n\n\tstatic create_line_segment_geometry(\n\t\tpoints: CorePoint[],\n\t\tindices: number[],\n\t\tattrib_names: string[],\n\t\tattrib_sizes_by_name: Dictionary<number>\n\t) {\n\t\t// let new_positions: number[] = []\n\t\tconst new_indices: number[] = [];\n\n\t\tconst new_attribute_values_by_name: Dictionary<number[]> = {};\n\t\tattrib_names.forEach((attrib_name) => {\n\t\t\tnew_attribute_values_by_name[attrib_name] = [];\n\t\t});\n\n\t\tindices.forEach((index, i) => {\n\t\t\tconst point = points[index];\n\t\t\t// const position = point.position();\n\t\t\t// new_positions.push(position.toArray());\n\t\t\tattrib_names.forEach((attrib_name) => {\n\t\t\t\tlet attrib_value = point.attrib_value(attrib_name);\n\t\t\t\tconst attrib_size = attrib_sizes_by_name[attrib_name];\n\t\t\t\tif (attrib_size > 1) {\n\t\t\t\t\tattrib_value = attrib_value.toArray();\n\t\t\t\t} else {\n\t\t\t\t\tattrib_value = [attrib_value];\n\t\t\t\t}\n\t\t\t\tattrib_value.forEach((v: number) => {\n\t\t\t\t\tnew_attribute_values_by_name[attrib_name].push(v);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tif (i > 0) {\n\t\t\t\tnew_indices.push(i - 1);\n\t\t\t\tnew_indices.push(i);\n\t\t\t}\n\t\t});\n\n\t\t// new_positions = lodash_flatten(new_positions)\n\t\tconst geometry = new BufferGeometry();\n\n\t\tattrib_names.forEach((attrib_name) => {\n\t\t\tconst attrib_size = attrib_sizes_by_name[attrib_name];\n\t\t\tconst values = new_attribute_values_by_name[attrib_name];\n\t\t\tgeometry.setAttribute(attrib_name, new Float32BufferAttribute(values, attrib_size));\n\t\t});\n\n\t\tgeometry.setIndex(new_indices);\n\t\treturn geometry;\n\t}\n\n\tstatic line_segment_to_geometries(geometry: BufferGeometry) {\n\t\tconst geometries: BufferGeometry[] = [];\n\t\tconst core_geometry = new CoreGeometry(geometry);\n\t\tconst attrib_names = core_geometry.attrib_names();\n\t\tconst points = core_geometry.points();\n\t\tconst indices = (geometry.getIndex()?.array as number[]) || [];\n\n\t\tconst accumulated_curve_point_indices = this.accumulated_curve_point_indices(indices);\n\t\tconsole.log(indices, accumulated_curve_point_indices);\n\n\t\tif (accumulated_curve_point_indices.length > 0) {\n\t\t\tconst attribute_sizes_by_name = core_geometry.attrib_sizes();\n\n\t\t\taccumulated_curve_point_indices.forEach((curve_point_indices, i) => {\n\t\t\t\tgeometry = this.create_line_segment_geometry(\n\t\t\t\t\tpoints,\n\t\t\t\t\tcurve_point_indices,\n\t\t\t\t\tattrib_names,\n\t\t\t\t\tattribute_sizes_by_name\n\t\t\t\t);\n\t\t\t\tgeometries.push(geometry);\n\t\t\t});\n\t\t}\n\n\t\treturn geometries;\n\t}\n}\n","import {Vector2} from 'three/src/math/Vector2';\nconst THREE = {Vector2};\n\nexport class EventHelper {\n\tconstructor(private element: HTMLElement) {}\n\n\tset_element(element: HTMLElement) {\n\t\tthis.element = element;\n\t}\n\n\tstatic element_position(event: MouseEvent | TouchEvent, element: HTMLElement, position: THREE.Vector2) {\n\t\tconst dim = element.getBoundingClientRect();\n\n\t\tif ((event as TouchEvent).changedTouches) {\n\t\t\tevent = event as TouchEvent;\n\t\t\tconst touch = event.changedTouches[0];\n\t\t\tposition.x = touch.pageX - dim.x;\n\t\t\tposition.y = touch.pageY - dim.y;\n\t\t} else {\n\t\t\tevent = event as MouseEvent;\n\t\t\tposition.x = event.pageX - dim.x;\n\t\t\tposition.y = event.pageY - dim.y;\n\t\t}\n\t}\n\tstatic element_position_old(event: MouseEvent, element: HTMLElement) {\n\t\tconst dim = element.getBoundingClientRect();\n\t\tconst x = event.pageX - dim.x;\n\t\tconst y = event.pageY - dim.y;\n\t\t// console.log(event, x, y)\n\t\treturn new THREE.Vector2(x, y);\n\t}\n\n\tstatic normalized_position(event: MouseEvent, element: HTMLElement, position: THREE.Vector2) {\n\t\tthis.element_position(event, element, position);\n\n\t\tconst dim = element.getBoundingClientRect();\n\n\t\t// const mouse = new THREE.Vector2();\n\t\tposition.x = ((position.x - window.scrollX) / dim.width) * 2 - 1;\n\t\tposition.y = -(((position.y - window.scrollY) / dim.height) * 2 - 1);\n\t\t// return mouse;\n\t}\n\tstatic normalized_position_0_1(event: MouseEvent, element: HTMLElement, position: THREE.Vector2) {\n\t\tthis.element_position(event, element, position);\n\n\t\tconst dim = element.getBoundingClientRect();\n\n\t\t// const mouse = new THREE.Vector2();\n\t\tposition.x = (position.x - window.scrollX) / dim.width;\n\t\tposition.y = (position.y - window.scrollY) / dim.height;\n\t\t// return mouse;\n\t}\n\n\telement_position(event: MouseEvent, position: THREE.Vector2) {\n\t\tEventHelper.element_position(event, this.element, position);\n\t}\n\telement_position_old(event: MouseEvent) {\n\t\treturn EventHelper.element_position_old(event, this.element);\n\t}\n\n\tnormalized_position(event: MouseEvent, position: THREE.Vector2) {\n\t\tEventHelper.normalized_position(event, this.element, position);\n\t}\n}\n","import {MouseButton} from 'src/editor/core/MouseButton';\n\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {EngineParamData} from 'src/editor/store/modules/Engine';\nexport function SetupGlobalSliderOwner(json_param: EngineParamData) {\n\tfunction open_numeric_slider(e: MouseEvent) {\n\t\tif (e.button == MouseButton.MIDDLE) {\n\t\t\tStoreController.editor.numeric_slider.open({\n\t\t\t\tparam_id: json_param.graph_node_id,\n\t\t\t\tposition: {x: e.clientX, y: e.clientY},\n\t\t\t});\n\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tfunction on_paste(e: Event) {\n\t\t// to prevent paste into field\n\t\tconst param_id = StoreController.editor.numeric_slider.param_id();\n\t\tif (param_id != null) {\n\t\t\treturn e.preventDefault();\n\t\t}\n\t}\n\n\treturn {\n\t\topen_numeric_slider,\n\t\ton_paste,\n\t};\n}\n","// import lodash_isArray from 'lodash/isArray'\n// import lodash_isString from 'lodash/isString'\n// import lodash_isBoolean from 'lodash/isBoolean';\nimport lodash_isNumber from 'lodash/isNumber';\nimport {TypedNumericParam} from './_Numeric';\nimport {ParamType} from '../poly/ParamType';\nimport {CoreString} from 'src/core/String';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\n\nexport class FloatParam extends TypedNumericParam<ParamType.FLOAT> {\n\tstatic type() {\n\t\treturn ParamType.FLOAT;\n\t}\n\tget default_value_serialized() {\n\t\treturn this.default_value;\n\t}\n\tget raw_input_serialized() {\n\t\treturn this._raw_input;\n\t}\n\tget value_serialized() {\n\t\treturn this.value;\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.FLOAT],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.FLOAT]\n\t) {\n\t\treturn raw_input1 == raw_input2;\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.FLOAT], val2: ParamValuesTypeMap[ParamType.FLOAT]) {\n\t\treturn val1 == val2;\n\t}\n\tstatic convert(raw_val: ParamInitValuesTypeMap[ParamType.FLOAT]): number | null {\n\t\tif (lodash_isNumber(raw_val)) {\n\t\t\treturn raw_val;\n\t\t} else {\n\t\t\tif (CoreString.is_number(raw_val)) {\n\t\t\t\tconst parsed = parseFloat(raw_val);\n\t\t\t\tif (lodash_isNumber(parsed)) {\n\t\t\t\t\treturn parsed;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n\tconvert(raw_val: ParamInitValuesTypeMap[ParamType.FLOAT]): number | null {\n\t\tconst result = FloatParam.convert(raw_val);\n\t\tif (result) {\n\t\t\treturn this.options.ensure_in_range(result);\n\t\t} else {\n\t\t\treturn result;\n\t\t}\n\t}\n\t// convert_value(v) {\n\t// \t// if(lodash_isNumber(v)){\n\t// \t// \t//\n\t// \t// }\n\t// \tif (lodash_isBoolean(v)) {\n\t// \t\tv = v ? 1 : 0\n\t// \t}\n\t// \tif (lodash_isString(v)) {\n\t// \t\tv = parseFloat(v)\n\t// \t}\n\t// \tif (lodash_isArray(v)) {\n\t// \t\tv = v[0]\n\t// \t}\n\t// \treturn this._ensure_in_range(v)\n\t// }\n\t// convert_default_value(v) {\n\t// \t// if(lodash_isNumber(v)){\n\t// \t// \t//\n\t// \t// }\n\t// \tif (lodash_isBoolean(v)) {\n\t// \t\tv = v ? 1 : 0\n\t// \t}\n\t// \t// if(lodash_isString(v)){\n\t// \t// \tv = parseFloat(v)\n\t// \t// }\n\t// \tif (lodash_isArray(v)) {\n\t// \t\tv = v[0]\n\t// \t}\n\t// \treturn v\n\t// }\n\n\t// is_value_expression(v) {\n\t// \t//console.log(\"is_value_expression\", this, v, !lodash_isNumber(v))\n\t// \t//!lodash_isNumber(v)\n\t// \treturn `${v}` !== `${parseFloat(v)}`\n\t// }\n}\n","// import {TypedParamVisitor} from './_Base';\nimport {TypedParam} from './_Base';\nimport {CoreWalker} from 'src/core/Walker';\n\n// import {AsCodeOperatorPath} from './concerns/visitors/OperatorPath';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {ParamType} from '../poly/ParamType';\n// import {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamEvent} from '../poly/ParamEvent';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n\nexport class OperatorPathParam extends TypedParam<ParamType.OPERATOR_PATH> {\n\tprivate _found_node: BaseNodeType | null = null;\n\n\tstatic type() {\n\t\treturn ParamType.OPERATOR_PATH;\n\t}\n\tget default_value_serialized() {\n\t\treturn this.default_value;\n\t}\n\tget raw_input_serialized() {\n\t\treturn `${this._raw_input}`;\n\t}\n\tget value_serialized() {\n\t\treturn `${this.value}`;\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.OPERATOR_PATH],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.OPERATOR_PATH]\n\t) {\n\t\treturn raw_input1 == raw_input2;\n\t}\n\tstatic are_values_equal(\n\t\tval1: ParamValuesTypeMap[ParamType.OPERATOR_PATH],\n\t\tval2: ParamValuesTypeMap[ParamType.OPERATOR_PATH]\n\t) {\n\t\treturn val1 == val2;\n\t}\n\tget is_default(): boolean {\n\t\treturn this._value == this.default_value;\n\t}\n\tprotected process_raw_input() {\n\t\tthis._value = this._raw_input;\n\t\tthis.set_dirty();\n\t\tthis.emit_controller.emit(ParamEvent.VALUE_UPDATED);\n\t}\n\n\tprotected async process_computation() {\n\t\tconst path = this._value;\n\t\tlet node = null;\n\t\tconst path_non_empty = path != null && path !== '';\n\n\t\tif (path_non_empty) {\n\t\t\tnode = CoreWalker.find_node(this.node, path);\n\t\t\t// not sure I want the param to be errored,\n\t\t\t// as it may block the node, even if the param is not necessary\n\t\t\t// if (!node) {\n\t\t\t// \tthis.states.error.set('node not found');\n\t\t\t// }\n\t\t}\n\n\t\tif (this._found_node !== node) {\n\t\t\tconst dependent_on_found_node = this.options.dependent_on_found_node();\n\n\t\t\tif (this._found_node) {\n\t\t\t\tif (dependent_on_found_node) {\n\t\t\t\t\tthis.remove_graph_input(this._found_node);\n\t\t\t\t} else {\n\t\t\t\t\t// this._found_node.remove_param_referree(this) // TODO: typescript\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._found_node = node;\n\t\t\tif (node) {\n\t\t\t\tconst expected_context = this.options.node_selection_context;\n\t\t\t\tconst node_context = node.parent?.children_controller?.context;\n\t\t\t\tif (expected_context == node_context || expected_context == null) {\n\t\t\t\t\tif (dependent_on_found_node) {\n\t\t\t\t\t\tthis.add_graph_input(node);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// this._found_node.add_param_referree(this) // TODO: typescript\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.states.error.set(\n\t\t\t\t\t\t`node context is ${expected_context} but the params expects a ${node_context}`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} // else {\n\t\t\t// \tif (path_non_empty) {\n\t\t\t// \t\tthis.states.error.set('node not found');\n\t\t\t// \t}\n\t\t\t// }\n\t\t\tthis.options.execute_callback();\n\t\t}\n\t\tthis.remove_dirty_state();\n\t}\n\n\tfound_node() {\n\t\treturn this._found_node;\n\t}\n}\n","import {GlobalsBaseController} from './_Base';\nimport {GlobalsGlNode} from '../../Globals';\nimport {AttributeGlNode} from '../../Attribute';\n// import {Definition} from '../../Definition/_Module';\n// import {DefinitionBaseConfig} from '../Config/DefinitionBaseConfig';\n// import {BaseGlNodeType} from '../../_Base';\nimport {VaryingGLDefinition, AttributeGLDefinition} from '../../utils/GLDefinition';\nimport {ConnectionPointType} from 'src/engine/nodes/utils/connections/ConnectionPointType';\n// import {TypeAssert} from 'src/engine/poly/Assert';\nimport {MapUtils} from 'src/core/MapUtils';\nimport {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\nimport {BaseGlNodeType} from '../../_Base';\nimport {ShadersCollectionController} from '../utils/ShadersCollectionController';\n\nconst VARIABLE_CONFIG_DEFAULT_BY_NAME: Dictionary<string> = {\n\tposition: 'vec3( position )',\n};\n\nexport class GlobalsGeometryHandler extends GlobalsBaseController {\n\tstatic PRE_DEFINED_ATTRIBUTES = [\n\t\t'position',\n\t\t'color',\n\t\t'normal',\n\t\t'uv',\n\t\t'uv2',\n\t\t'morphTarget0',\n\t\t'morphTarget1',\n\t\t'morphTarget2',\n\t\t'morphTarget3',\n\t\t'skinIndex',\n\t\t'skinWeight',\n\t];\n\n\tstatic IF_RULE = {\n\t\tuv:\n\t\t\t'defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )',\n\t};\n\n\thandle_globals_node(\n\t\tglobals_node: GlobalsGlNode,\n\t\toutput_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t\t// definitions_by_shader_name: Map<ShaderName, BaseGLDefinition[]>,\n\t\t// body_lines_by_shader_name: Map<ShaderName, string[]>,\n\t\t// body_lines: string[],\n\t\t// dependencies: ShaderName[],\n\t\t// shader_name: ShaderName\n\t): void {\n\t\tconst connection_point = globals_node.io.outputs.named_output_connection_points_by_name(output_name);\n\t\tif (!connection_point) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst var_name = globals_node.gl_var_name(output_name);\n\t\tconst gl_type = connection_point.type;\n\t\tconst definition = new VaryingGLDefinition(globals_node, gl_type, var_name);\n\n\t\t// MapUtils.push_on_array_at_entry(definitions_by_shader_name, shader_name, definition);\n\t\tshaders_collection_controller.add_definitions(globals_node, [definition]);\n\t\t// definitions_by_shader_name.get(shader_name)!.push(definition);\n\t\tconst assembler = globals_node.material_node?.assembler_controller.assembler;\n\t\tif (!assembler) {\n\t\t\treturn;\n\t\t}\n\t\tconst shader_config = assembler.shader_config(shaders_collection_controller.current_shader_name);\n\t\tif (!shader_config) {\n\t\t\treturn;\n\t\t}\n\t\tconst dependencies = shader_config.dependencies();\n\n\t\tconst body_line = `${var_name} = ${gl_type}(${output_name})`;\n\t\tfor (let dependency of dependencies) {\n\t\t\t// MapUtils.push_on_array_at_entry(definitions_by_shader_name, dependency, definition);\n\t\t\t// MapUtils.push_on_array_at_entry(body_lines_by_shader_name, dependency, body_line);\n\t\t\tshaders_collection_controller.add_definitions(globals_node, [definition], dependency);\n\t\t\tshaders_collection_controller.add_body_lines(globals_node, [body_line], dependency);\n\t\t}\n\t\tif (dependencies.length == 0) {\n\t\t\t// body_lines.push(body_line);\n\t\t\tshaders_collection_controller.add_body_lines(globals_node, [body_line]);\n\t\t}\n\t}\n\n\tstatic variable_config_default(variable_name: string): string | undefined {\n\t\treturn VARIABLE_CONFIG_DEFAULT_BY_NAME[variable_name];\n\t}\n\tvariable_config_default(variable_name: string): string | undefined {\n\t\treturn GlobalsGeometryHandler.variable_config_default(variable_name);\n\t}\n\t// variable_config_required_definitions(variable_name:string):DefinitionBaseConfig[]{\n\t// \treturn null\n\t// }\n\tread_attribute(\n\t\tnode: BaseGlNodeType,\n\t\tgl_type: ConnectionPointType,\n\t\tattrib_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {\n\t\treturn GlobalsGeometryHandler.read_attribute(node, gl_type, attrib_name, shaders_collection_controller);\n\t}\n\n\tstatic read_attribute(\n\t\tnode: BaseGlNodeType,\n\t\tgl_type: ConnectionPointType,\n\t\tattrib_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t): string | undefined {\n\t\tif (GlobalsGeometryHandler.PRE_DEFINED_ATTRIBUTES.indexOf(attrib_name) < 0) {\n\t\t\tshaders_collection_controller.add_definitions(\n\t\t\t\tnode,\n\t\t\t\t[new AttributeGLDefinition(node, gl_type, attrib_name)],\n\t\t\t\tShaderName.VERTEX\n\t\t\t);\n\t\t} else {\n\t\t\t// const if_rule = GlobalsGeometryHandler.IF_RULE[attrib_name]\n\t\t\t// if(if_rule){\n\t\t\t// \tconst definition = new Definition.Attribute(node, gl_type, attrib_name)\n\t\t\t// \tdefinition.set_if_rule(if_rule)\n\t\t\t// \tnode.add_definitions([definition])\n\t\t\t// }\n\t\t}\n\n\t\t// if (!shader_name) {\n\t\t// \tthrow 'no shader name';\n\t\t// }\n\t\tconst shader_name = shaders_collection_controller.current_shader_name;\n\t\tswitch (shader_name) {\n\t\t\tcase ShaderName.VERTEX: {\n\t\t\t\treturn attrib_name;\n\t\t\t}\n\t\t\tcase ShaderName.FRAGMENT: {\n\t\t\t\t// let's assume it can only be an attribute gl node\n\t\t\t\tif (!(node instanceof AttributeGlNode)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst var_name = 'varying_' + node.gl_var_name(node.output_name);\n\t\t\t\tconst varying_definition = new VaryingGLDefinition(node, gl_type, var_name);\n\n\t\t\t\tconst definitions_by_shader_name: Map<ShaderName, VaryingGLDefinition[]> = new Map();\n\t\t\t\t// definitions_by_shader_name.set(ShaderName.VERTEX, [])\n\t\t\t\tdefinitions_by_shader_name.set(ShaderName.FRAGMENT, []);\n\t\t\t\t// {\n\t\t\t\t// \t[ShaderName.VERTEX]: [],\n\t\t\t\t// \t[ShaderName.FRAGMENT]: [],\n\t\t\t\t// };\n\t\t\t\tconst body_lines_by_shader_name: Map<ShaderName, string[]> = new Map();\n\t\t\t\t// body_lines_by_shader_name.set(ShaderName.VERTEX, [])\n\t\t\t\tbody_lines_by_shader_name.set(ShaderName.FRAGMENT, []);\n\t\t\t\tMapUtils.push_on_array_at_entry(definitions_by_shader_name, shader_name, varying_definition);\n\n\t\t\t\tconst set_varying_body_line = `${var_name} = ${gl_type}(${attrib_name})`;\n\n\t\t\t\tconst shader_config = node.material_node?.assembler_controller.assembler.shader_config(shader_name);\n\t\t\t\tif (shader_config) {\n\t\t\t\t\tconst dependencies = shader_config.dependencies();\n\t\t\t\t\tfor (let dependency of dependencies) {\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(definitions_by_shader_name, dependency, varying_definition);\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(body_lines_by_shader_name, dependency, set_varying_body_line);\n\t\t\t\t\t}\n\t\t\t\t\tdefinitions_by_shader_name.forEach((definitions, shader_name) => {\n\t\t\t\t\t\tshaders_collection_controller.add_definitions(node, definitions, shader_name);\n\t\t\t\t\t});\n\t\t\t\t\tbody_lines_by_shader_name.forEach((body_lines, shader_name) => {\n\t\t\t\t\t\tshaders_collection_controller.add_body_lines(node, body_lines, shader_name);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn var_name;\n\t\t\t}\n\t\t}\n\t\t// TypeAssert.unreachable(shader_name);\n\n\t\t// const shader_name = node._shader_name // TODO: this is hack\n\t\t// const varying_definition = new Definition.Varying(node, gl_type, attrib_name)\n\t\t// const var_name = varying_definition.name()\n\t\t// definitions_by_shader_name[shader_name].push(varying_definition)\n\t\t// const shader_config = node.shader_config(shader_name)\n\t\t// const dependencies = shader_config.dependencies()\n\t\t// const body_line = `${var_name} = ${gl_type}(${attrib_name})`\n\t\t// for(let dependency of dependencies){\n\t\t// \tdefinitions_by_shader_name[dependency].push(varying_definition)\n\t\t// \tbody_lines_by_shader_name[dependency].push(body_line)\n\t\t// }\n\t\t// // if(dependencies.length == 0){\n\t\t// \t// body_lines.push(body_line)\n\t\t// \tnode.add_body_lines([body_line])\n\t\t// // }\n\t\t// for(let shader_name of Object.keys(definitions_by_shader_name)){\n\t\t// \tnode.add_definitions(definitions_by_shader_name[shader_name], shader_name)\n\t\t// }\n\t\t// for(let shader_name of Object.keys(body_lines_by_shader_name)){\n\t\t// \tnode.add_body_lines(body_lines_by_shader_name[shader_name], shader_name)\n\t\t// }\n\t\t// node.add_body_lines(body_lines)\n\t}\n\thandle_attribute_node(\n\t\tnode: AttributeGlNode,\n\t\tgl_type: ConnectionPointType,\n\t\tattrib_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {\n\t\treturn GlobalsGeometryHandler.read_attribute(node, gl_type, attrib_name, shaders_collection_controller);\n\t}\n}\n","import lodash_isArray from 'lodash/isArray';\nimport lodash_isString from 'lodash/isString';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {CodeExporterDispatcher} from './Dispatcher';\n// import {ParamOptions} from 'src/engine/params/utils/OptionsController';\n\nexport class ParamCodeExporter<T extends BaseParamType> {\n\t_lines: string[] = [];\n\tconstructor(protected _param: T) {}\n\n\tprocess(): string[] {\n\t\tthis._lines = [];\n\n\t\tlet default_value = this.default_value();\n\t\tif (lodash_isString(default_value)) {\n\t\t\tdefault_value = `'${default_value}'`;\n\t\t}\n\t\tif (lodash_isArray(default_value)) {\n\t\t\tdefault_value = `[${default_value}]`;\n\t\t}\n\n\t\tif (this._param.options.is_spare && !this._param.parent_param) {\n\t\t\tconst create_line = `${this.node_var_name()}.add_param('${this._param.type}', '${\n\t\t\t\tthis._param.name\n\t\t\t}', ${default_value}, ${JSON.stringify(this._param.options.current)})`;\n\t\t\tthis._lines.push(create_line);\n\t\t}\n\n\t\tif (!this._param.is_default) {\n\t\t\tthis.add_main();\n\t\t}\n\t\tthis.add_options();\n\n\t\treturn this._lines;\n\t}\n\n\t// as_code_default_value_string() {\n\t// \treturn `${this.default_value()}`;\n\t// }\n\t// as_code_create() {\n\t// \treturn `${this.node().code_var_name()}.add_spare_param( '${this.type()}', '${this.name()}', ${this.as_code_default_value_string()}, ${JSON.stringify(this.options())})`;\n\t// }\n\n\tdefault_value() {\n\t\treturn this._param.default_value;\n\t}\n\n\tnode_var_name() {\n\t\treturn CodeExporterDispatcher.dispatch_node(this._param.node).var_name();\n\t}\n\tprefix() {\n\t\treturn `${this.node_var_name()}.params.get('${this._param.name}')`;\n\t}\n\n\tprotected add_main() {\n\t\tthrow 'as_code_main abstract call';\n\t}\n\n\tadd_options() {\n\t\tif (this._param.options.has_options_overridden) {\n\t\t\tconst options_overridden = this._param.options.overridden_options;\n\t\t\tconst keys = this._param.options.overridden_option_names;\n\t\t\tfor (let option_name of keys) {\n\t\t\t\tconst option_value = options_overridden[option_name];\n\t\t\t\tconst line = this.prefix() + `.options.set('${option_name}', ${JSON.stringify(option_value)})`;\n\t\t\t\tthis._lines.push(line);\n\t\t\t}\n\t\t}\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {StoreController} from '../store/controllers/StoreController';\n\nexport class ClipboardHelper {\n\tprivate static _copied_node: BaseNodeType;\n\tprivate static _copied_param: BaseParamType;\n\tconstructor() {}\n\n\tstatic copy_node(node: BaseNodeType) {\n\t\tthis._copied_node = node;\n\t\tthis.copy(node.full_path());\n\t\tStoreController.editor.clipboard.set_node_id(node.graph_node_id);\n\t}\n\tstatic get copied_node() {\n\t\treturn this._copied_node;\n\t}\n\tstatic copy_param(param: BaseParamType) {\n\t\tthis._copied_param = param;\n\t\tthis.copy(param.full_path());\n\t\tStoreController.editor.clipboard.set_param_id(param.graph_node_id);\n\t}\n\tstatic get copied_param() {\n\t\treturn this._copied_param;\n\t}\n\n\tstatic copy(text: string) {\n\t\tconst input = document.createElement('textarea');\n\t\tdocument.body.appendChild(input);\n\t\tinput.value = text;\n\t\tinput.select();\n\t\tdocument.execCommand('copy');\n\t\tdocument.body.removeChild(input);\n\t}\n\n\t// copy(text: string) {\n\t// \tClipboardHelper.copy(text);\n\t// }\n}\n","import { render, staticRenderFns } from \"./Numeric.vue?vue&type=template&id=f4ad0432&lang=pug&\"\nimport script from \"./Numeric.vue?vue&type=script&lang=ts&\"\nexport * from \"./Numeric.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('f4ad0432')) {\n      api.createRecord('f4ad0432', component.options)\n    } else {\n      api.reload('f4ad0432', component.options)\n    }\n    module.hot.accept(\"./Numeric.vue?vue&type=template&id=f4ad0432&lang=pug&\", function () {\n      api.rerender('f4ad0432', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Numeric.vue\"\nexport default component.exports","// import {Scene} from 'three/src/scenes/Scene'\n// import {CoreGraph} from 'src/core/graph/CoreGraph'\n// import {CorePerformance} from 'src/core/performance/CorePerformance'\n// import {Cooker} from 'src/core/graph/Cooker'\n// import {EmitPayload} from 'src/core/graph/NodeScene'\n// import {BaseNode} from '../nodes/_Base'\n\n// import {CoreObject} from 'src/core/Object';\n// import {Debug} from './concerns/Debug';\n// import {Env} from './concerns/Env'\n// import {ExpressionRegister} from './concerns/ExpressionRegister';\n// import {Frame} from './concerns/Frame';\n// import {GraphMixin} from './concerns/Graph';\n// import {Js} from './concerns/Js';\n// import {Json} from './concerns/Json';\n// import {LifeCycle} from './concerns/LifeCycle';\n// import {Loading} from './concerns/Loading';\n// import {Name} from './concerns/Name';\n// import {Nodes} from './concerns/Nodes';\n// import {ObjectMixin} from './concerns/Object';\n// import {PickerNodes} from './concerns/PickerNodes';\n// import {PerformanceMixin} from './concerns/Performance';\n// import {Renderer} from './concerns/Renderer';\n// import {Store} from './concerns/Store';\n// import {Uniforms} from './concerns/Uniforms';\n\n// import {CubeCamerasController} from './utils/CubeCamerasController';\nimport {CamerasController} from './utils/CamerasController';\nimport {Cooker} from './utils/Cooker';\nimport {CoreGraph} from 'src/core/graph/CoreGraph';\nimport {CookController} from './utils/CookController';\nimport {EventsController} from './utils/EventsController';\nimport {LifeCycleController} from './utils/LifeCycleController';\nimport {LoadingController} from './utils/LoadingController';\nimport {MissingReferencesController} from 'src/engine/expressions/MissingReferencesController';\nimport {NodesController} from './utils/NodesController';\nimport {CorePerformance} from 'src/core/performance/CorePerformance';\nimport {TimeController} from './utils/TimeController';\nimport {PolySceneSerializer} from './utils/Serializer';\nimport {UniformsController} from './utils/UniformsController';\nimport {WebGLController} from './utils/WebGLController';\n\nimport {Scene} from 'three/src/scenes/Scene';\n\nexport class PolyScene {\n\tprotected _display_scene = new Scene();\n\tget display_scene() {\n\t\treturn this._display_scene;\n\t}\n\t_uuid!: string;\n\tset_uuid(uuid: string) {\n\t\treturn (this._uuid = uuid);\n\t}\n\tget uuid() {\n\t\treturn this._uuid;\n\t}\n\t_name: string | undefined;\n\tset_name(name: string) {\n\t\treturn (this._name = name);\n\t}\n\tget name() {\n\t\treturn this._name;\n\t}\n\n\tprotected _cameras_controller = new CamerasController(this);\n\tget cameras_controller() {\n\t\treturn this._cameras_controller;\n\t}\n\n\tprivate _cooker = new Cooker(this);\n\tget cooker() {\n\t\treturn this._cooker;\n\t}\n\n\t// private _cube_cameras_controller: CubeCamerasController;\n\t// get cube_cameras_controller() {\n\t// \treturn (this._cube_cameras_controller = this._cube_cameras_controller || new CubeCamerasController(this));\n\t// }\n\tpublic readonly cook_controller = new CookController();\n\tasync wait_for_cooks_completed() {\n\t\treturn this.cook_controller.wait_for_cooks_completed();\n\t}\n\n\tprivate _events_controller: EventsController | undefined;\n\tget events_controller() {\n\t\treturn (this._events_controller = this._events_controller || new EventsController(this));\n\t}\n\n\tprivate _graph = new CoreGraph();\n\tget graph() {\n\t\treturn this._graph;\n\t}\n\n\tprivate _lifecycle_controller: LifeCycleController | undefined;\n\tget lifecycle_controller() {\n\t\treturn (this._lifecycle_controller = this._lifecycle_controller || new LifeCycleController(this));\n\t}\n\tprivate _loading_controller: LoadingController | undefined;\n\tget loading_controller() {\n\t\treturn (this._loading_controller = this._loading_controller || new LoadingController(this));\n\t}\n\n\tprivate _missing_expression_references_controller: MissingReferencesController = new MissingReferencesController();\n\tget missing_expression_references_controller() {\n\t\treturn this._missing_expression_references_controller;\n\t}\n\n\tprotected _nodes_controller = new NodesController(this);\n\tget nodes_controller() {\n\t\treturn this._nodes_controller;\n\t}\n\n\tprotected _performance: CorePerformance | undefined;\n\tget performance() {\n\t\treturn (this._performance = this._performance || new CorePerformance());\n\t}\n\n\tprotected _time_controller = new TimeController(this);\n\tget time_controller() {\n\t\treturn this._time_controller;\n\t}\n\tset_frame(frame: number) {\n\t\tthis.time_controller.set_frame(frame);\n\t}\n\tget frame() {\n\t\treturn this.time_controller.frame;\n\t}\n\tget frame_range() {\n\t\treturn this.time_controller.frame_range;\n\t}\n\tplay() {\n\t\tthis.time_controller.play();\n\t}\n\tpause() {\n\t\tthis.time_controller.pause();\n\t}\n\n\tprivate _serializer: PolySceneSerializer | undefined;\n\tprivate get serializer() {\n\t\treturn (this._serializer = this._serializer || new PolySceneSerializer(this));\n\t}\n\tto_json() {\n\t\treturn this.serializer.to_json();\n\t}\n\n\tprivate _uniforms_controller: UniformsController | undefined;\n\tget uniforms_controller() {\n\t\treturn (this._uniforms_controller = this._uniforms_controller || new UniformsController(this));\n\t}\n\n\tprivate _webgl_controller: WebGLController | undefined;\n\tget webgl_controller() {\n\t\treturn (this._webgl_controller = this._webgl_controller || new WebGLController());\n\t}\n\n\tconstructor() {\n\t\t// this.mark_as_loaded()\n\t\tthis._graph.set_scene(this);\n\t\t// this.time_controller.init();\n\t\tthis.nodes_controller.init();\n\t}\n\n\t// cooker\n\tbatch_update(callback: () => void) {\n\t\tthis._cooker.block();\n\n\t\tcallback();\n\n\t\tthis._cooker.unblock();\n\t}\n\n\t// nodes\n\tnode(path: string) {\n\t\treturn this.nodes_controller.node(path);\n\t}\n\tget root() {\n\t\treturn this.nodes_controller.root;\n\t}\n}\n\n// export function ClassDecorator<T>(beanName: string): Function {\n// \treturn (classConstructor: any) => {\n// \t\tconsole.log('classConstructor')\n// \t\tconsole.log(classConstructor)\n// \t\t// const props = getOrCreateProps(classConstructor)\n// \t\t// props.beanName = beanName\n// \t}\n// }\n\n// export function Param(param_type: string, default_value: number): Function {\n// \treturn (\n// \t\ttarget: any,\n// \t\tpropertyKey: string,\n// \t\tdescriptor: PropertyDescriptor\n// \t) => {\n// \t\tconsole.log('Param')\n// \t\tconsole.log(target, propertyKey, descriptor)\n// \t\t// Object.assign(target, `_param_${propertyKey}`, 'ta')\n// \t\t// const props = getOrCreateProps(classConstructor)\n// \t\t// props.beanName = beanName\n// \t}\n// }\n// export function ParamFloat(default_value: number, options: object = {}): Function {\n// \treturn (target: any, propertyKey: string) => {\n// \t\tconsole.log('Param Float', default_value)\n// \t\tconst param_name = propertyKey.substring(7) // removes _param_\n// \t\tconsole.log('param_name', param_name)\n// \t\t// target.prepare_param_on_init('Float', param_name, default_value)\n// \t\t// console.log(target, propertyKey)\n// \t\t// Object.assign(target, `_param_${propertyKey}`, 'ta')\n// \t\t// const props = getOrCreateProps(classConstructor)\n// \t\t// props.beanName = beanName\n// \t}\n// }\n// export function ClassMethod(value: boolean): Function {\n// \treturn (\n// \t\ttarget: any,\n// \t\tpropertyKey: string,\n// \t\tdescriptor: PropertyDescriptor\n// \t) => {\n// \t\tconsole.log('ClassMethod')\n// \t\tconsole.log(target, propertyKey, descriptor)\n// \t\tObject.assign(target, `_param_${propertyKey}`, 'ta')\n// \t\t// const props = getOrCreateProps(classConstructor)\n// \t\t// props.beanName = beanName\n// \t}\n// }\n\n// // @ClassDecorator('bla')\n// export class PolyScene {\n// \t_display_scene: Scene = new Scene()\n// \t_graph: CoreGraph\n// \t_performance: CorePerformance\n// \t_cooker: Cooker\n\n// \t// @ParamFloat(3, {visible_if: {test: 2}}) _param_radius: number\n\n// \t// constructor() {\n// \t// \tconst co = new CoreObject()\n// \t// \tconsole.log('CoreObject', co)\n// \t// }\n// \tgraph() {\n// \t\treturn this._graph\n// \t}\n// \tperformance() {\n// \t\treturn this._performance\n// \t}\n// \tcooker() {\n// \t\treturn this._cooker\n// \t}\n// \tstore_commit(event_name: string, payload: EmitPayload) {}\n// \temit_allowed() {\n// \t\treturn true\n// \t}\n// \tnode(path: string): BaseNode {\n// \t\treturn null\n// \t}\n\n// \tdisplay_scene() {\n// \t\treturn this._display_scene\n// \t}\n\n// \tis_loading() {\n// \t\treturn true\n// \t}\n// \tloaded(): boolean {\n// \t\treturn true\n// \t}\n// \troot(): BaseNode {\n// \t\treturn null\n// \t}\n// \tcontext(): any {}\n\n// \tuuid() {\n// \t\treturn 'test-uuid'\n// \t}\n// }\n","import {BaseNodeType} from '../_Base';\nimport {NodeUIDataJson} from './UIData';\nimport {TypedNamedConnectionPointData} from './connections/NamedConnectionPoint';\nimport {ConnectionPointType} from './connections/ConnectionPointType';\n\nexport interface NodeSerializerData {\n\tname: string;\n\ttype: string;\n\tgraph_node_id: string;\n\tis_dirty: boolean;\n\tui_data_json: NodeUIDataJson;\n\terror_message: string | undefined;\n\tchildren: string[];\n\tinputs: Array<string | undefined>;\n\tinput_connection_output_indices: Array<number | undefined> | undefined;\n\tnamed_input_connections: TypedNamedConnectionPointData<ConnectionPointType>[];\n\tnamed_output_connections: TypedNamedConnectionPointData<ConnectionPointType>[];\n\tparam_ids: string[];\n\t// spare_params: Dictionary<string>;\n\toverride_clonable_state: boolean;\n\tinputs_clonable_state_with_override: boolean[];\n\tflags?: {\n\t\t//has_display: this.has_display_flag()\n\t\tdisplay?: boolean;\n\t\tbypass?: boolean;\n\t};\n\tselection?: string[];\n}\n\nexport class NodeSerializer {\n\tconstructor(private node: BaseNodeType) {}\n\n\t// serialize() {\n\t// \treturn this.to_json();\n\t// }\n\n\t// TODO: find a way to not re-create a json everytime\n\tto_json(include_param_components: boolean = false): NodeSerializerData {\n\t\t// const spare_params_json_by_name = {};\n\t\t// lodash_each(this.node.spare_param_names(), param_name=> {\n\t\t// \tconst param = this.node.spare_param(param_name);\n\t\t// \tspare_params_json_by_name[param_name] = param.graph_node_id;\n\t\t// });\n\n\t\tconst data = {\n\t\t\tname: this.node.name,\n\t\t\ttype: this.node.type,\n\t\t\tgraph_node_id: this.node.graph_node_id,\n\t\t\tis_dirty: this.node.is_dirty,\n\t\t\tui_data_json: this.node.ui_data.to_json(),\n\t\t\terror_message: this.node.states.error.message,\n\t\t\tchildren: this.children_ids(),\n\t\t\tinputs: this.input_ids(),\n\t\t\tinput_connection_output_indices: this.connection_input_indices(),\n\t\t\tnamed_input_connections: this.named_input_connections(),\n\t\t\tnamed_output_connections: this.named_output_connections(),\n\t\t\tparam_ids: this.to_json_params(include_param_components),\n\t\t\t// spare_params: this.to_json_spare_params(include_param_components),\n\t\t\toverride_clonable_state: this.node.io.inputs.override_clonable_state(),\n\t\t\tinputs_clonable_state_with_override: this.node.io.inputs.inputs_clonable_state_with_override(),\n\t\t\tflags: {\n\t\t\t\t//has_display: this.has_display_flag()\n\t\t\t\tdisplay: this.node.flags?.display?.active,\n\t\t\t\tbypass: this.node.flags?.bypass?.active,\n\t\t\t},\n\t\t\tselection: undefined as string[] | undefined,\n\t\t};\n\n\t\tif (this.node.children_allowed() && this.node.children_controller) {\n\t\t\tdata['selection'] = this.node.children_controller.selection.to_json();\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tchildren_ids(): string[] {\n\t\treturn this.node.children().map((node) => node.graph_node_id);\n\t}\n\n\tinput_ids(): (string | undefined)[] {\n\t\treturn this.node.io.inputs.inputs().map((node) => (node != null ? node.graph_node_id : undefined));\n\t}\n\n\tconnection_input_indices() {\n\t\treturn this.node.io.connections\n\t\t\t.input_connections()\n\t\t\t?.map((connection) => (connection != null ? connection.output_index : undefined));\n\t}\n\tnamed_input_connections() {\n\t\treturn this.node.io.inputs.named_input_connection_points.map((i) => i.to_json());\n\t}\n\tnamed_output_connections() {\n\t\treturn this.node.io.outputs.named_output_connection_points.map((o) => o.to_json());\n\t}\n\n\tto_json_params_from_names(param_names: string[], include_components: boolean = false) {\n\t\treturn param_names.map((param_name) => {\n\t\t\treturn this.node.params.get(param_name)!.graph_node_id;\n\t\t});\n\t\t// const params_json_by_name: Dictionary<string> = {};\n\t\t// for (let param_name of param_names) {\n\t\t// \tconst param = this.node.params.get(param_name);\n\t\t// \tif (param) {\n\t\t// \t\tparams_json_by_name[param_name] = param.graph_node_id;\n\n\t\t// \t\tif (include_components && param.is_multiple && param.components) {\n\t\t// \t\t\tfor (let component of param.components) {\n\t\t// \t\t\t\tparams_json_by_name[component.name] = component.graph_node_id;\n\t\t// \t\t\t}\n\t\t// \t\t}\n\t\t// \t}\n\t\t// }\n\t\t// return params_json_by_name;\n\t}\n\tto_json_params(include_components: boolean = false) {\n\t\treturn this.to_json_params_from_names(this.node.params.names, include_components);\n\t}\n\t// to_json_params_without_components(){\n\t// \treturn this.to_json_params(false)\n\t// }\n\t// to_json_params_with_components(){\n\t// \treturn this.to_json_params(true)\n\t// }\n\t// to_json_spare_params(include_components: boolean = false) {\n\t// \treturn this.to_json_params_from_names(this.node.params.spare_names, include_components);\n\t// }\n}\n","import {BooleanParam} from 'src/engine/params/Boolean';\nimport {ButtonParam} from 'src/engine/params/Button';\nimport {ColorParam} from 'src/engine/params/Color';\nimport {FloatParam} from 'src/engine/params/Float';\nimport {FolderParam} from '../Folder';\nimport {IntegerParam} from 'src/engine/params/Integer';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\nimport {RampParam} from 'src/engine/params/Ramp';\nimport {SeparatorParam} from 'src/engine/params/Separator';\nimport {StringParam} from 'src/engine/params/String';\nimport {Vector2Param} from 'src/engine/params/Vector2';\nimport {Vector3Param} from 'src/engine/params/Vector3';\nimport {Vector4Param} from 'src/engine/params/Vector4';\n\nimport {ParamType} from 'src/engine/poly/ParamType';\n\ntype ParamClassMapType = {[key in ParamType]: any};\nexport const ParamConstructorByType: ParamClassMapType = {\n\t[ParamType.BOOLEAN]: BooleanParam,\n\t[ParamType.BUTTON]: ButtonParam,\n\t[ParamType.COLOR]: ColorParam,\n\t[ParamType.FLOAT]: FloatParam,\n\t[ParamType.FOLDER]: FolderParam,\n\t[ParamType.INTEGER]: IntegerParam,\n\t[ParamType.OPERATOR_PATH]: OperatorPathParam,\n\t[ParamType.RAMP]: RampParam,\n\t[ParamType.SEPARATOR]: SeparatorParam,\n\t[ParamType.STRING]: StringParam,\n\t[ParamType.VECTOR2]: Vector2Param,\n\t[ParamType.VECTOR3]: Vector3Param,\n\t[ParamType.VECTOR4]: Vector4Param,\n};\n","import {BaseParamType} from '../_Base';\nimport {ExpressionManager} from 'src/engine/expressions/ExpressionManager';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {CoreEntity} from 'src/core/geometry/Entity';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamValuesTypeMap} from 'src/engine/params/types/ParamValuesTypeMap';\nimport {CoreObject} from 'src/core/geometry/Object';\n\n// type ParamTypeElem = ParamType;\ntype EntityCallback<T extends ParamType> = (\n\tentity: CoreEntity,\n\tvalue: ParamValuesTypeMap[T] | any /*TODO: typescript: any is used here mostly to compile*/\n) => void;\ntype PointEntityCallback<T extends ParamType> = (\n\tentity: CorePoint,\n\tvalue: ParamValuesTypeMap[T] | any /*TODO: typescript: any is used here mostly to compile*/\n) => void;\ntype ObjectEntityCallback<T extends ParamType> = (\n\tentity: CoreObject,\n\tvalue: ParamValuesTypeMap[T] | any /*TODO: typescript: any is used here mostly to compile*/\n) => void;\n\nexport class ExpressionController<T extends ParamType> {\n\tprotected _expression: string | undefined;\n\tprotected _entities: CoreEntity[] | undefined;\n\tprotected _entity_callback: EntityCallback<T> | undefined;\n\tprotected _manager: ExpressionManager | undefined;\n\tconstructor(protected param: BaseParamType) {}\n\n\tget active() {\n\t\treturn this._expression != null;\n\t}\n\tget expression() {\n\t\treturn this._expression;\n\t}\n\tget is_errored() {\n\t\tif (this._manager) {\n\t\t\treturn this._manager.is_errored;\n\t\t}\n\t\treturn false;\n\t}\n\tget error_message() {\n\t\tif (this._manager) {\n\t\t\treturn this._manager.error_message;\n\t\t}\n\t\treturn null;\n\t}\n\tget requires_entities() {\n\t\treturn this.param.options.is_expression_for_entities;\n\t}\n\tset_expression(expression: string | undefined, set_dirty: boolean = true) {\n\t\tif (this._expression != expression) {\n\t\t\tthis._expression = expression;\n\n\t\t\tif (this._expression) {\n\t\t\t\tthis._manager = this._manager || new ExpressionManager(this.param);\n\t\t\t\tthis._manager.parse_expression(this._expression);\n\t\t\t} else {\n\t\t\t\tif (this._manager) {\n\t\t\t\t\tthis._manager.reset();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (set_dirty) {\n\t\t\t\tthis.param.set_dirty();\n\t\t\t}\n\t\t}\n\t}\n\n\tupdate_from_method_dependency_name_change() {}\n\n\tasync compute_expression() {\n\t\tif (this._manager && this.active) {\n\t\t\treturn this._manager.compute_function();\n\t\t}\n\t}\n\tprivate async compute_expression_for_entities(entities: CoreEntity[], callback: EntityCallback<T>) {\n\t\tthis.set_entities(entities, callback);\n\t\ttry {\n\t\t\tawait this.compute_expression();\n\t\t} catch (e) {\n\t\t\tconsole.warn('expression evalution error');\n\t\t\tconsole.warn(e);\n\t\t\tthis.param.node.states.error.set(`expression evalution error: ${e}`);\n\t\t}\n\n\t\tthis.reset_entities();\n\t}\n\tcompute_expression_for_points(entities: CorePoint[], callback: PointEntityCallback<T>) {\n\t\treturn this.compute_expression_for_entities(entities, callback as EntityCallback<T>);\n\t}\n\tcompute_expression_for_objects(entities: CoreObject[], callback: ObjectEntityCallback<T>) {\n\t\treturn this.compute_expression_for_entities(entities, callback as EntityCallback<T>);\n\t}\n\tget entities() {\n\t\treturn this._entities;\n\t}\n\tget entity_callback() {\n\t\treturn this._entity_callback;\n\t}\n\tset_entities(entities: CoreEntity[], callback: EntityCallback<T>) {\n\t\tthis._entities = entities;\n\t\tthis._entity_callback = callback;\n\t}\n\treset_entities() {\n\t\tthis._entities = undefined;\n\t\tthis._entity_callback = undefined;\n\t}\n}\n","import lodash_isString from 'lodash/isString';\n\nimport jsep from 'jsep';\njsep.addUnaryOp('@');\n// self.jsep = jsep\nlet precedence = 10;\njsep.addBinaryOp('**', precedence);\n// precedence = 1\n// jsep.addBinaryOp('`', precedence)\n// const HOUDINI_QUOTE_CODE = 96; // houdini quote\n// const JSEP_COMPOUND = 'Compound'\nconst JSEP_IDENTIFIER = 'Identifier';\nconst JSEP_LITERAL = 'Literal';\n// const JSEP_BINARY_EXPRESSION = 'BynaryExpression'\nconst JSEP_CALL_EXPRESSION = 'CallExpression';\nconst STRING_EXPRESSION_SEPARATOR = '`';\n\nexport class ParsedTree {\n\tpublic node: jsep.Expression | undefined;\n\tpublic error_message: string | undefined;\n\n\tconstructor() {}\n\n\tparse_expression(string: string) {\n\t\ttry {\n\t\t\tthis.reset();\n\t\t\tthis.node = jsep(string);\n\t\t} catch (e) {\n\t\t\tconst message = `could not parse the expression '${string}' (error: ${e})`;\n\t\t\tthis.error_message = message;\n\t\t}\n\t}\n\tparse_expression_for_string_param(string: string) {\n\t\ttry {\n\t\t\tthis.reset();\n\n\t\t\tconst elements = ParsedTree.string_value_elements(string);\n\t\t\tconst nodes = [];\n\t\t\tfor (let i = 0; i < elements.length; i++) {\n\t\t\t\tconst element = elements[i];\n\t\t\t\tlet node;\n\t\t\t\tif (i % 2 == 1) {\n\t\t\t\t\tnode = jsep(element);\n\t\t\t\t} else {\n\t\t\t\t\tnode = {\n\t\t\t\t\t\ttype: JSEP_LITERAL,\n\t\t\t\t\t\tvalue: `'${element}'`,\n\t\t\t\t\t\traw: `'${element}'`,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tnodes.push(node);\n\t\t\t\t// nodes.push({\n\t\t\t\t// \ttype: JSEP_CALL_EXPRESSION,\n\t\t\t\t// \targuments: [node],\n\t\t\t\t// \tcallee: {\n\t\t\t\t// \t\ttype: JSEP_IDENTIFIER,\n\t\t\t\t// \t\tname: 'toString',\n\t\t\t\t// \t}\n\t\t\t\t// })\n\t\t\t}\n\t\t\t// let last_plus_node;\n\t\t\t// for(let i=0; i<(nodes.length-1); i++){\n\t\t\t// \tconst plus_node = {\n\t\t\t// \t\ttype: JSEP_BINARY_EXPRESSION,\n\t\t\t// \t\toperator: '+',\n\t\t\t// \t\tleft: last_plus_node || nodes[i],\n\t\t\t// \t\tright: nodes[i+1],\n\t\t\t// \t}\n\t\t\t// \tlast_plus_node = plus_node;\n\t\t\t// }\n\t\t\t// this.node = last_plus_node\n\t\t\tthis.node = (<unknown>{\n\t\t\t\ttype: JSEP_CALL_EXPRESSION,\n\t\t\t\targuments: nodes,\n\t\t\t\tcallee: {\n\t\t\t\t\ttype: JSEP_IDENTIFIER,\n\t\t\t\t\tname: 'str_concat',\n\t\t\t\t},\n\t\t\t}) as jsep.Compound;\n\t\t} catch (e) {\n\t\t\tconst message = `could not parse the expression '${string}' (error: ${e})`;\n\t\t\tthis.error_message = message;\n\t\t}\n\t}\n\n\tstatic string_value_elements(v: string): string[] {\n\t\tif (v != null) {\n\t\t\tif (lodash_isString(v)) {\n\t\t\t\treturn v.split(STRING_EXPRESSION_SEPARATOR);\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\t// static string_value_contains_expression(v:string): boolean{\n\t// \treturn ((this.string_value_elements(v).length - 1) % 2) === 0;\n\t// }\n\n\t// deep_parse_for_string_expressions(){\n\t// \t// for string expressions which have more than a single `<expr>` element\n\t// \t// pt_`@ptnum`\n\t// \t// `@ptnum`_pt\n\t// \t// pt_`@ptnum`_`1+1`\n\t// \tif(this.node.type == JSEP_COMPOUND){\n\t// \t\tconst args = this.node.body\n\t// \t\tlet arg;\n\t// \t\tfor(let i=0; i<args.length; i++){\n\t// \t\t\targ = args[i]\n\t// \t\t\tif(arg.type == JSEP_LITERAL){\n\t// \t\t\t\tconst arg_node = jsep(arg.value)\n\t// \t\t\t\targs[i] = arg_node\n\t// \t\t\t}\n\t// \t\t}\n\t// \t} else {\n\t// \t\t// for string expressions which havea single `<expr>` element\n\t// \t\t// `@ptnum`\n\t// \t\tif(this.node.type == JSEP_LITERAL){\n\t// \t\t\tconst raw = this.node.raw\n\t// \t\t\tconst first_char_code = raw.charCodeAt(0)\n\t// \t\t\tconst last_char_code = raw.charCodeAt(raw.length-1)\n\t// \t\t\tif(first_char_code == HOUDINI_QUOTE_CODE && last_char_code == HOUDINI_QUOTE_CODE){\n\t// \t\t\t\tthis.node = jsep(\"''+\"+this.node.value) // add the prefix ''+ to ensure we have a string as a result, and not a number\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// }\n\n\tprivate reset() {\n\t\tthis.node = undefined;\n\t\tthis.error_message = undefined;\n\t}\n}\n","// https://gist.github.com/gre/1650294\n\n// const ease_in = function(t:number, power:number){return Math.pow(t, power)}\n// const ease_on = function(t:number, power:number){return 1 - Math.abs(Math.pow(t-1, power))}\n// const ease_ion = function(t:number, power:number){return t<.5 ? ease_i(power)(t*2)/2 : ease_o(power)(t*2 - 1)/2+0.5}\n\nconst ease_i = function(power:number){return function(t:number){return Math.pow(t, power)}};\nconst ease_o = function(power:number){return function(t:number){return 1 - Math.abs(Math.pow(t-1, power))}};\nconst ease_io = function(power:number){return function(t:number){return t<.5 ? ease_i(power)(t*2)/2 : ease_o(power)(t*2 - 1)/2+0.5}}\n\nexport const Easing = {\n  linear: ease_io(1),\n\n  ease_i: function(t:number, power:number){ return ease_i(power)(t) },\n  ease_o: function(t:number, power:number){ return ease_o(power)(t) },\n  ease_io: function(t:number, power:number){ return ease_io(power)(t) },\n\n  ease_i2: ease_i(2),\n  ease_o2: ease_o(2),\n  ease_io2: ease_io(2),\n\n  ease_i3: ease_io(3),\n  ease_o3: ease_io(3),\n  ease_io3: ease_io(3),\n\n  ease_i4: ease_io(4),\n  ease_o4: ease_io(4),\n  ease_io4: ease_io(4),\n  // easeInQuart: EaseIn(4),\n  // easeOutQuart: EaseOut(4),\n  // easeInOutQuart: EaseInOut(4),\n  // easeInQuint: EaseIn(5),\n  // easeOutQuint: EaseOut(5),\n  // easeInOutQuint: EaseInOut(5)\n\n  ease_i_sin: function(t:number){ return 1 + Math.sin(Math.PI / 2 * t - Math.PI / 2); },\n  ease_o_sin: function(t:number){ return Math.sin(Math.PI / 2 * t); },\n  ease_io_sin: function(t:number){ return (1 + Math.sin(Math.PI * t - Math.PI / 2)) / 2; },\n\n  ease_i_elastic: function (t:number) { return (.04 - .04 / t) * Math.sin(25 * t) + 1 },\n  ease_o_elastic: function (t:number) { return .04 * t / (--t) * Math.sin(25 * t) },\n  ease_io_elastic: function (t:number) { return (t -= .5) < 0 ? (.02 + .01 / t) * Math.sin(50 * t) : (.02 - .01 / t) * Math.sin(50 * t) + 1 }\n}\n\n// export class Easing {\n//   // no easing, no acceleration\n//   static linear(t:number):number{ return t }\n//   // accelerating from zero velocity\n//   static easeinquad (t:number):number{ return t*t }\n//   // decelerating to zero velocity\n//   static easeoutquad (t:number):number{ return t*(2-t) }\n//   // acceleration until halfway, then deceleration\n//   static easeinoutquad (t:number):number{ return t<.5 ? 2*t*t : -1+(4-2*t)*t }\n//   // accelerating from zero velocity\n//   static easeincubic (t:number):number{ return t*t*t }\n//   // decelerating to zero velocity\n//   static easeoutcubic (t:number):number{ return (--t)*t*t+1 }\n//   // acceleration until halfway, then deceleration\n//   static easeinoutcubic (t:number):number{ return t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1 }\n//   // accelerating from zero velocity\n//   static easeinquart (t:number):number{ return t*t*t*t }\n//   // decelerating to zero velocity\n//   static easeoutquart (t:number):number{ return 1-(--t)*t*t*t }\n//   // acceleration until halfway, then deceleration\n//   static easeinoutquart (t:number):number{ return t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t }\n//   // accelerating from zero velocity\n//   static easeinquint (t:number):number{ return t*t*t*t*t }\n//   // decelerating to zero velocity\n//   static easeoutquint (t:number):number{ return 1+(--t)*t*t*t*t }\n//   // acceleration until halfway, then deceleration\n//   static easeinoutquint (t:number):number{ return t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t }\n// }","import {BaseNodeType} from 'src/engine/nodes/_Base';\n\ntype FlagHookCallback = () => void;\n\nexport class BaseFlag {\n\t// protected _available_states: [boolean, boolean] = [];\n\tprotected _state: boolean = true;\n\tprotected _hooks: FlagHookCallback[] | null = null;\n\tconstructor(protected node: BaseNodeType) {}\n\n\t// set_available_states(states: T[]) {}\n\tadd_hook(hook: FlagHookCallback) {\n\t\tthis._hooks = this._hooks || [];\n\t\tthis._hooks.push(hook);\n\t}\n\tprotected on_update() {}\n\tset(new_state: boolean) {\n\t\tif (this._state != new_state) {\n\t\t\tthis._state = new_state;\n\t\t\tthis.on_update();\n\t\t\tthis.run_hooks();\n\t\t}\n\t}\n\tget active() {\n\t\treturn this._state;\n\t}\n\ttoggle() {\n\t\tthis.set(!this._state);\n\t}\n\trun_hooks() {\n\t\tif (this._hooks) {\n\t\t\tfor (let hook of this._hooks) {\n\t\t\t\thook();\n\t\t\t}\n\t\t}\n\t}\n}\n","import {EventDispatcher} from 'three/src/core/EventDispatcher';\nimport {MOUSE} from 'three/src/constants';\nimport {Quaternion} from 'three/src/math/Quaternion';\nimport {Spherical} from 'three/src/math/Spherical';\nimport {TOUCH} from 'three/src/constants';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Vector3} from 'three/src/math/Vector3';\n/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n * @author ScieCode / http://github.com/sciecode\n */\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nvar OrbitControls = function ( object, domElement ) {\n\n\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\tthis.object = object;\n\tthis.domElement = domElement;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.05;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.panSpeed = 1.0;\n\tthis.screenSpacePanning = false; // if true, pan in screen-space\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// Set to false to disable use of the keys\n\tthis.enableKeys = true;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t// Touch fingers\n\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.saveState = function () {\n\n\t\tscope.target0.copy( scope.target );\n\t\tscope.position0.copy( scope.object.position );\n\t\tscope.zoom0 = scope.object.zoom;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\n\t\tvar lastPosition = new Vector3();\n\t\tvar lastQuaternion = new Quaternion();\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t} else {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t}\n\n\t\t\t// restrict theta to be between desired limits\n\t\t\tspherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t}\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.domElement.removeEventListener( 'keydown', onKeyDown, false );\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = {\n\t\tNONE: - 1,\n\t\tROTATE: 0,\n\t\tDOLLY: 1,\n\t\tPAN: 2,\n\t\tTOUCH_ROTATE: 3,\n\t\tTOUCH_PAN: 4,\n\t\tTOUCH_DOLLY_PAN: 5,\n\t\tTOUCH_DOLLY_ROTATE: 6\n\t};\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new Spherical();\n\tvar sphericalDelta = new Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new Vector2();\n\tvar rotateEnd = new Vector2();\n\tvar rotateDelta = new Vector2();\n\n\tvar panStart = new Vector2();\n\tvar panEnd = new Vector2();\n\tvar panDelta = new Vector2();\n\n\tvar dollyStart = new Vector2();\n\tvar dollyEnd = new Vector2();\n\tvar dollyDelta = new Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t} else {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t}\n\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement;\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\tvar needsUpdate = false;\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.update();\n\n\t\t}\n\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyStart.set( 0, distance );\n\n\t}\n\n\tfunction handleTouchStartDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchStartPan( event );\n\n\t}\n\n\tfunction handleTouchStartDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchStartRotate( event );\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateEnd.set( x, y );\n\n\t\t}\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanEnd.set( x, y );\n\n\t\t}\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t}\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\tdollyIn( dollyDelta.y );\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t}\n\n\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t}\n\n\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t}\n\n\tfunction handleTouchEnd( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\t// Prevent the browser from scrolling.\n\n\t\tevent.preventDefault();\n\n\t\t// Manually set the focus since calling preventDefault above\n\t\t// prevents the browser from setting it automatically.\n\n\t\tscope.domElement.focus ? scope.domElement.focus() : window.focus();\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0:\n\n\t\t\t\tswitch ( scope.mouseButtons.LEFT ) {\n\n\t\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\n\t\t\tcase 1:\n\n\t\t\t\tswitch ( scope.mouseButtons.MIDDLE ) {\n\n\t\t\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\t\t\tbreak;\n\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tswitch ( scope.mouseButtons.RIGHT ) {\n\n\t\t\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MOUSE.PAN:\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\n\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n\tscope.domElement.addEventListener( 'keydown', onKeyDown, false );\n\n\t// make sure element can receive keys.\n\n\tif ( scope.domElement.tabIndex === - 1 ) {\n\n\t\tscope.domElement.tabIndex = 0;\n\n\t}\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nOrbitControls.prototype = Object.create( EventDispatcher.prototype );\nOrbitControls.prototype.constructor = OrbitControls;\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nvar MapControls = function ( object, domElement ) {\n\n\tOrbitControls.call( this, object, domElement );\n\n\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\tthis.touches.ONE = TOUCH.PAN;\n\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n};\n\nMapControls.prototype = Object.create( EventDispatcher.prototype );\nMapControls.prototype.constructor = MapControls;\n\nexport { OrbitControls, MapControls };\n","import {TypedGlNode} from './_Base';\n// import {ParamType} from 'src/Engine/Param/_Module';\n// import {Connection} from './GlData';\n// import {Definition} from './Definition/_Module';\n// import {ShaderName} from './Assembler/Util/CodeBuilder';\n\n// list of globals\n// https://www.khronos.org/opengl/wiki/Built-in_Variable_(GLSL)\n// gl_PointCoord\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ShadersCollectionController} from './code/utils/ShadersCollectionController';\nclass GlobalsGlParamsConfig extends NodeParamsConfig {}\nconst ParamsConfig = new GlobalsGlParamsConfig();\n\nexport class GlobalsGlNode extends TypedGlNode<GlobalsGlParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'globals';\n\t}\n\n\tcreate_params() {\n\t\tthis.material_node?.assembler_controller.add_globals_params(this);\n\t}\n\n\tset_lines(shaders_collection_controller: ShadersCollectionController) {\n\t\t// if (lines_controller.shader_name) {\n\t\tthis.material_node?.assembler_controller?.assembler.set_node_lines_globals(this, shaders_collection_controller);\n\t\t// }\n\t\t// const vertex_definitions = []\n\t\t// const fragment_definitions = []\n\t\t// const definitions = []\n\t\t// // const vertex_body_lines = []\n\t\t// const fragment_body_lines = []\n\t\t// const body_lines = []\n\n\t\t// const shader_config = this.shader_config(this._shader_name)\n\t\t// const dependencies = shader_config.dependencies()\n\n\t\t// const definitions_by_shader_name = {}\n\t\t// definitions_by_shader_name[this._shader_name] = []\n\t\t// for(let dependency of dependencies){ definitions_by_shader_name[dependency] = [] }\n\n\t\t// const body_lines_by_shader_name = {}\n\t\t// body_lines_by_shader_name[this._shader_name] = []\n\t\t// for(let dependency of dependencies){ body_lines_by_shader_name[dependency] = [] }\n\n\t\t// let definition\n\t\t// let body_line\n\t\t// for(let output_name of this.used_output_names()){\n\t\t// \tconst var_name = this.gl_var_name(output_name)\n\n\t\t// \tswitch (output_name){\n\t\t// \t\tcase 'frame':\n\t\t// \t\t\tdefinition = new Definition.Uniform(this, 'float', output_name)\n\t\t// \t\t\t// vertex_definitions.push(definition)\n\t\t// \t\t\t// fragment_definitions.push(definition)\n\t\t// \t\t\tdefinitions_by_shader_name[this._shader_name].push(definition)\n\n\t\t// \t\t\tbody_line = `float ${var_name} = ${output_name}`\n\t\t// \t\t\tfor(let dependency of dependencies){\n\t\t// \t\t\t\tdefinitions_by_shader_name[dependency].push(definition)\n\t\t// \t\t\t\tbody_lines_by_shader_name[dependency].push(body_line)\n\t\t// \t\t\t}\n\n\t\t// \t\t\t// vertex_body_lines.push(`float ${var_name} = ${output_name}`)\n\t\t// \t\t\tbody_lines.push(body_line)\n\t\t// \t\t\tbreak;\n\t\t// \t\tcase 'gl_FragCoord':\n\t\t// \t\t\tif( this._shader_name == ShaderName.FRAGMENT ){\n\t\t// \t\t\t\tfragment_body_lines.push(`vec4 ${var_name} = gl_FragCoord`)\n\t\t// \t\t\t}\n\t\t// \t\t\tbreak;\n\t\t// \t\tcase 'gl_PointCoord':\n\t\t// \t\t\tif( this._shader_name == ShaderName.FRAGMENT ){\n\t\t// \t\t\t\tif(this.parent().is_point_material()){\n\t\t// \t\t\t\t\tfragment_body_lines.push(`vec2 ${var_name} = gl_PointCoord`)\n\t\t// \t\t\t\t}\n\t\t// \t\t\t}\n\t\t// \t\t\tbreak;\n\t\t// \t\tdefault:\n\t\t// \t\t\tconst named_output = this.named_output_by_name(output_name)\n\t\t// \t\t\tconst gl_type = named_output.gl_type()\n\t\t// \t\t\tdefinition = new Definition.Varying(this, gl_type, var_name)\n\t\t// \t\t\tdefinitions_by_shader_name[this._shader_name].push(definition)\n\n\t\t// \t\t\tbody_line = `${var_name} = vec3(${output_name})`\n\t\t// \t\t\tfor(let dependency of dependencies){\n\t\t// \t\t\t\tdefinitions_by_shader_name[dependency].push(definition)\n\t\t// \t\t\t\tbody_lines_by_shader_name[dependency].push(body_line)\n\t\t// \t\t\t}\n\t\t// \t\t\tif(dependencies.length == 0){\n\t\t// \t\t\t\tbody_lines.push(body_line)\n\t\t// \t\t\t}\n\t\t// \t}\n\t\t// }\n\t\t// // this.set_vertex_definitions(vertex_definitions)\n\t\t// // this.set_fragment_definitions(fragment_definitions)\n\t\t// for(let shader_name of Object.keys(definitions_by_shader_name)){\n\t\t// \tthis.set_definitions(definitions_by_shader_name[shader_name], shader_name)\n\t\t// }\n\t\t// for(let shader_name of Object.keys(body_lines_by_shader_name)){\n\t\t// \tthis.add_body_lines(body_lines_by_shader_name[shader_name], shader_name)\n\t\t// }\n\t\t// // this.add_definitions(definitions)\n\t\t// // this.set_vertex_body_lines(vertex_body_lines)\n\t\t// // this.set_fragment_body_lines(fragment_body_lines)\n\n\t\t// this.add_body_lines(body_lines)\n\t}\n}\n","import {TypedGLDefinition, GLDefinitionType} from './GLDefinition';\n\nexport class TypedGLDefinitionCollection<T extends GLDefinitionType> {\n\t_errored: boolean = false;\n\t_error_message: string | undefined;\n\n\tconstructor(private _definitions: TypedGLDefinition<T>[] = []) {}\n\n\tget errored() {\n\t\treturn this._errored;\n\t}\n\tget error_message() {\n\t\treturn this._error_message;\n\t}\n\n\tuniq(): TypedGLDefinition<T>[] {\n\t\tconst definitions_by_name: Map<string, TypedGLDefinition<T>> = new Map();\n\t\tconst names: string[] = [];\n\n\t\tfor (let definition of this._definitions) {\n\t\t\tif (!this._errored) {\n\t\t\t\tconst name = definition.name;\n\t\t\t\tconst existing = definitions_by_name.get(name);\n\t\t\t\tif (existing) {\n\t\t\t\t\tif (existing.data_type != definition.data_type) {\n\t\t\t\t\t\tthis._errored = true;\n\t\t\t\t\t\tthis._error_message = `attempt to create ${definition.name} with types ${definition.data_type}`;\n\t\t\t\t\t\tconsole.warn('emitting error message', this._error_message);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdefinitions_by_name.set(name, definition);\n\t\t\t\t\tnames.push(name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst uniq_definitions: TypedGLDefinition<T>[] = [];\n\t\tfor (let name of names) {\n\t\t\tconst definition = definitions_by_name.get(name);\n\t\t\tif (definition) {\n\t\t\t\tuniq_definitions.push(definition);\n\t\t\t}\n\t\t}\n\t\t// sorting may make dependencies be declared after the function calling them\n\t\t// const sorted_definitions = lodash_sortBy(uniq_definitions, (d)=>d.name())\n\t\treturn uniq_definitions;\n\t}\n}\n","import {ParamConfig} from '../configs/ParamConfig';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamInitValuesTypeMap} from 'src/engine/params/types/ParamInitValuesTypeMap';\n\nexport class ParamConfigsController {\n\tprivate _param_configs: ParamConfig<ParamType>[] = [];\n\n\treset() {\n\t\tthis._param_configs = [];\n\t}\n\n\tpush(param_config: ParamConfig<ParamType>) {\n\t\tthis._param_configs.push(param_config);\n\t}\n\tcreate_and_push<T extends ParamType>(\n\t\ttype: T,\n\t\tname: string,\n\t\tdefault_value: ParamInitValuesTypeMap[T],\n\t\tuniform_name: string\n\t) {\n\t\tconst param_config = new ParamConfig(type, name, default_value, uniform_name);\n\t\tthis._param_configs.push(param_config);\n\t}\n\n\tget list(): Readonly<ParamConfig<ParamType>[]> {\n\t\treturn this._param_configs;\n\t}\n}\n","import lodash_isNaN from 'lodash/isNaN';\nimport {Camera} from 'three/src/cameras/Camera';\n\nimport {CoreTransform} from 'src/core/Transform';\nimport {ObjNodeRenderOrder} from './_Base';\nimport {ControlsController} from './utils/cameras/ControlsController';\nimport {LayersController} from './utils/LayersController';\nimport {PostProcessController} from './utils/cameras/PostProcessController';\n\n// import {Dirtyable} from './Concerns/Dirtyable';\n// import {Layers} from './Concerns/Layers';\n// import {PostProcess} from './Concerns/PostProcess';\n// import {Transformed} from './Concerns/Transformed';\n// import {Background} from './Concerns/Background';\n// import {CoreTextureLoader} from 'src/Core/Loader/Texture'\n// import {CameraControls} from './Concerns/CameraControls';\n// import {File} from 'src/Engine/Node/Cop/File'\nimport {ThreejsViewer} from 'src/engine/viewers/Threejs';\nimport {BaseBackgroundController} from './utils/cameras/background/_BaseController';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\n\nexport interface OrthoOrPerspCamera extends Camera {\n\tnear: number;\n\tfar: number;\n\tupdateProjectionMatrix: () => void;\n\tgetFocalLength?: () => void;\n}\n\nconst EVENT_CHANGE = {type: 'change'};\n\nexport const BASE_CAMERA_DEFAULT = {\n\tnear: 1.0,\n\tfar: 100.0,\n};\n\nimport {FlagsControllerD} from '../utils/FlagsController';\nimport {CameraPostProcessParamConfig} from './utils/cameras/PostProcessController';\nimport {CameraBackgroundParamConfig} from './utils/cameras/background/_BaseController';\nimport {LayerParamConfig} from './utils/LayersController';\n\nimport {ParamConfig, NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {BaseNodeType} from '../_Base';\nimport {TransformedParamConfig, TransformController} from './utils/TransformController';\nimport {TypedObjNode} from './_Base';\n\nexport function CameraTransformParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tcamera = ParamConfig.FOLDER();\n\t\tcontrols = ParamConfig.OPERATOR_PATH('', {\n\t\t\tnode_selection: {\n\t\t\t\tcontext: NodeContext.EVENT,\n\t\t\t},\n\t\t});\n\t\t// add transform params\n\t\t// t = ParamConfig.VECTOR3([0, 0, 0]);\n\t\t// r = ParamConfig.VECTOR3([0, 0, 0]);\n\t\t// s = ParamConfig.VECTOR3([1, 1, 1]);\n\t\t// scale = ParamConfig.FLOAT(1);\n\t\ttarget = ParamConfig.VECTOR3([0, 0, 0], {cook: false});\n\t\tnear = ParamConfig.FLOAT(BASE_CAMERA_DEFAULT.near, {range: [0, 100]});\n\t\tfar = ParamConfig.FLOAT(BASE_CAMERA_DEFAULT.far, {range: [0, 100]});\n\t\t// aspect = ParamConfig.FLOAT(1);\n\t\t// lock_width = ParamConfig.BOOLEAN(1);\n\t\t// look_at = ParamConfig.OPERATOR_PATH('');\n\n\t\tset_master_camera = ParamConfig.BUTTON(null, {\n\t\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\t\tBaseCameraObjNodeClass.PARAM_CALLBACK_set_master_camera(node as BaseCameraObjNodeType);\n\t\t\t},\n\t\t});\n\t};\n}\n\nexport class BaseCameraObjParamsConfig extends CameraPostProcessParamConfig(\n\tCameraBackgroundParamConfig(TransformedParamConfig(LayerParamConfig(CameraTransformParamConfig(NodeParamsConfig))))\n) {}\n\nexport class TypedCameraObjNode<O extends OrthoOrPerspCamera, K extends BaseCameraObjParamsConfig> extends TypedObjNode<\n\tO,\n\tK\n> {\n\t// public readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\tpublic readonly render_order: number = ObjNodeRenderOrder.CAMERA;\n\tprotected _object!: O;\n\tprotected _aspect: number = -1;\n\tget object() {\n\t\treturn this._object;\n\t}\n\treadonly transform_controller: TransformController = new TransformController(this);\n\tpublic readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\n\tprotected _background_controller: BaseBackgroundController | undefined;\n\tget background_controller(): BaseBackgroundController {\n\t\treturn (this._background_controller =\n\t\t\tthis._background_controller || new this.background_controller_constructor(this));\n\t}\n\tprotected get background_controller_constructor() {\n\t\treturn BaseBackgroundController;\n\t}\n\tprotected _controls_controller: ControlsController | undefined;\n\tget controls_controller(): ControlsController {\n\t\treturn (this._controls_controller = this._controls_controller || new ControlsController(this));\n\t}\n\tprotected _layers_controller: LayersController | undefined;\n\tget layers_controller() {\n\t\treturn (this._layers_controller = this._layers_controller || new LayersController(this));\n\t}\n\tprotected _post_process_controller: PostProcessController | undefined;\n\tget post_process_controller(): PostProcessController {\n\t\treturn (this._post_process_controller = this._post_process_controller || new PostProcessController(this));\n\t}\n\n\t// protected _used_in_scene: boolean = true;\n\tinitialize_base_node() {\n\t\tsuper.initialize_base_node();\n\t\t// this.io.inputs.set_count(0, 1);\n\t\tthis.io.outputs.set_has_one_output();\n\t\t// this._init_dirtyable_hook();\n\n\t\t// this.flags.display.add_hook(() => {\n\t\t// \tthis.set_used_in_scene(this.flags.display.active || false);\n\t\t// });\n\t\tthis.transform_controller.initialize_node();\n\t}\n\n\t// create_common_params() {\n\t// \t// this.within_param_folder('transform', () => {\n\t// \t// \t// this.add_param(ParamType.OPERATOR_PATH, 'controls', '', {\n\t// \t// \t// \tnode_selection: {\n\t// \t// \t// \t\tcontext: NodeContext.EVENT,\n\t// \t// \t// \t},\n\t// \t// \t// });\n\t// \t// \t// CoreTransform.create_params(this); // removed since they are now added Persp Camera\n\t// \t// \t// this.add_param( ParamType.TOGGLE, 'is_updating', 0, {cook: false, hidden: true}); //, hidden: true} )\n\t// \t// \t// this.add_param(ParamType.VECTOR3, 'target', [0, 0, 0], {cook: false}); //, hidden: true} )\n\t// \t// });\n\t// \t// this.within_param_folder('render', () => {\n\t// \t// this.layers_controller.add_params();\n\t// \t// this.add_param(ParamType.FLOAT, 'near', BASE_CAMERA_DEFAULT.near, {range: [0, 100]});\n\t// \t// this.add_param(ParamType.FLOAT, 'far', BASE_CAMERA_DEFAULT.far, {range: [0, 100]});\n\t// \t// this.add_param(ParamType.BOOLEAN, 'lock_width', 1);\n\t// \t// });\n\t// \t// this.background_controller.add_params();\n\t// \t// this.post_process_controller.add_params();\n\t// }\n\n\t// create_player_camera_params() {\n\t// \tthis.add_param(ParamType.BUTTON, 'set_master_camera', null, {callback: this.set_as_master_camera.bind(this)});\n\t// }\n\t// is_updating():boolean{\n\t// \treturn this.param('is_updating').value()\n\t// }\n\n\t// as_code_set_up_custom: ->\n\t// \tlines = []\n\t// \tlines.push \"#{this.code_var_name()}.set_display_flag(#{this.display_flag_state()})\"\n\t// \tlines\n\n\tasync cook() {\n\t\tthis.transform_controller.update();\n\t\tthis.layers_controller.update();\n\t\tawait this.background_controller.update();\n\n\t\tif (this._object.near != this.pv.near || this._object.far != this.pv.far) {\n\t\t\tthis._object.near = this.pv.near;\n\t\t\tthis._object.far = this.pv.far;\n\t\t\tthis._object.updateProjectionMatrix();\n\t\t}\n\n\t\tawait this.post_process_controller.update_composer_passes();\n\t\tthis.update_camera();\n\t\tthis.controls_controller.update_controls();\n\n\t\t// TODO: ideally the update transform and update camera\n\t\t// can both return if the camera has changed\n\t\t// and we can run this here instead of inside the update_transform and update_camera\n\t\t// this._object.dispatchEvent( EVENT_CHANGE )\n\t\tthis._object.dispatchEvent(EVENT_CHANGE);\n\t\tthis.cook_controller.end_cook();\n\t}\n\n\ton_create() {}\n\t//\n\ton_delete() {}\n\t//\n\n\tcamera() {\n\t\treturn this._object;\n\t}\n\n\tupdate_camera() {}\n\n\t//\n\tstatic PARAM_CALLBACK_set_master_camera(node: BaseCameraObjNodeType) {\n\t\tnode.set_as_master_camera();\n\t}\n\tset_as_master_camera() {\n\t\tthis.scene.cameras_controller.set_master_camera_node_path(this.full_path());\n\t}\n\n\tsetup_for_aspect_ratio(aspect: number) {\n\t\tif (lodash_isNaN(aspect)) {\n\t\t\treturn;\n\t\t}\n\t\tif (aspect && this._aspect != aspect) {\n\t\t\tthis._aspect = aspect;\n\t\t\tthis._update_for_aspect_ratio();\n\t\t}\n\t}\n\tprotected _update_for_aspect_ratio(): void {}\n\n\tupdate_transform_params_from_object() {\n\t\t// CoreTransform.set_params_from_matrix(this._object.matrix, this, {scale: false})\n\t\tCoreTransform.set_params_from_object(this._object, this);\n\t}\n\tcreate_viewer(element: HTMLElement): ThreejsViewer {\n\t\treturn new ThreejsViewer(element, this.scene, this);\n\t}\n}\n// \tconsole.warn \"camera #{this.full_path()} has no controls assigned\"\n\n// controls_node: ->\n// \tif @_param_controls? && @_param_controls != ''\n// \t\tCore.Walker.find_node(this, @_param_controls)\n\nexport type BaseCameraObjNodeType = TypedCameraObjNode<OrthoOrPerspCamera, BaseCameraObjParamsConfig>;\nexport class BaseCameraObjNodeClass extends TypedCameraObjNode<OrthoOrPerspCamera, BaseCameraObjParamsConfig> {}\n","import lodash_uniq from 'lodash/uniq';\nimport lodash_compact from 'lodash/compact';\nimport lodash_isNaN from 'lodash/isNaN';\nimport lodash_trim from 'lodash/trim';\nimport lodash_flatten from 'lodash/flatten';\nimport lodash_sum from 'lodash/sum';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Points} from 'three/src/objects/Points';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {LineSegments} from 'three/src/objects/LineSegments';\nimport {Group} from 'three/src/objects/Group';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Box3} from 'three/src/math/Box3';\n// const THREE = {Box3, BufferGeometry, Group, LineSegments, Mesh, Object3D, Points, Vector3}\nimport {CoreObject} from './Object';\nimport {CoreGeometry} from './Geometry';\nimport {CoreAttribute} from './Attribute';\n// import {Core} from 'src/core/_Module'\nimport {CoreString} from 'src/core/String';\nimport {CoreConstant, AttribClass} from './Constant';\n\n// import './MonkeyPatch'\n\nexport type GroupString = string;\n\nexport interface Object3DWithGeometry extends Object3D {\n\tgeometry: BufferGeometry;\n}\n\nexport class CoreGroup {\n\t// _group: Group\n\t_timestamp: number | undefined;\n\t// _core_objects:\n\t_objects: Object3D[] | undefined;\n\t_core_objects: CoreObject[] | undefined;\n\n\t// _geometries: BufferGeometry[];\n\t_core_geometries: CoreGeometry[] | undefined;\n\n\t_bounding_box: Box3 | undefined;\n\n\tconstructor() {\n\t\t//_group: Group){\n\t\t// this._group = _group;\n\t\tthis.touch();\n\t}\n\n\t//\n\t//\n\t// TIMESTAMP\n\t//\n\t//\n\ttimestamp() {\n\t\treturn this._timestamp;\n\t}\n\ttouch() {\n\t\tthis._timestamp = performance.now();\n\t\tthis.reset();\n\t}\n\treset() {\n\t\tthis._bounding_box = undefined;\n\t\tthis._core_geometries = undefined;\n\t\tthis._core_objects = undefined;\n\t}\n\n\t//\n\t//\n\t// CLONE\n\t//\n\t//\n\tclone() {\n\t\tconst core_group = new CoreGroup();\n\t\tif (this._objects) {\n\t\t\tconst objects = [];\n\t\t\tfor (let object of this._objects) {\n\t\t\t\tobjects.push(CoreObject.clone(object));\n\t\t\t}\n\t\t\tcore_group.set_objects(objects);\n\t\t}\n\t\treturn core_group;\n\t}\n\t//\n\t//\n\t// OBJECTS\n\t//\n\t//\n\tset_objects(objects: Object3D[]) {\n\t\tthis._objects = objects;\n\t\tthis.touch();\n\t}\n\tobjects() {\n\t\treturn this._objects as Object3DWithGeometry[];\n\t}\n\tcore_objects() {\n\t\treturn (this._core_objects = this._core_objects || this._create_core_objects());\n\t}\n\tprivate _create_core_objects(): CoreObject[] {\n\t\tconst list: CoreObject[] = [];\n\t\tif (this._objects) {\n\t\t\tfor (let i = 0; i < this._objects.length; i++) {\n\t\t\t\tthis._objects[i].traverse((object) => {\n\t\t\t\t\tconst core_object = new CoreObject(object, i);\n\t\t\t\t\tlist.push(core_object);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\n\t// group() {\n\t// \treturn this._group;\n\t// }\n\t// uuid() {\n\t// \treturn this._group.uuid;\n\t// }\n\n\tgeometries(): BufferGeometry[] {\n\t\t// this._geometries = [];\n\t\t// for (let object of this._objects) {\n\t\t// \tobject.traverse((object) => this.__geometry_from_object.bind(this)(this._geometries, object));\n\t\t// \t// \tconst geometry = this.geometry_from_object(object)\n\t\t// \t// \tif (geometry != null) {\n\t\t// \t// \t\treturn list.push(new CoreGeometry(geometry));\n\t\t// \t// \t}\n\t\t// \t// });\n\t\t// }\n\t\t// return this._geometries;\n\t\tconst list: BufferGeometry[] = [];\n\t\tfor (let core_object of this.core_objects()) {\n\t\t\tconst geometry = (core_object.object() as Mesh).geometry as BufferGeometry;\n\t\t\tif (geometry) {\n\t\t\t\tlist.push(geometry);\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\tcore_geometries(): CoreGeometry[] {\n\t\treturn (this._core_geometries = this._core_geometries || this.create_core_geometries());\n\t}\n\tprivate create_core_geometries() {\n\t\tconst list: CoreGeometry[] = [];\n\t\tfor (let geometry of this.geometries()) {\n\t\t\tlist.push(new CoreGeometry(geometry));\n\t\t\t// object.traverse(object=> this.__core_geometry_from_object.bind(this)(this._core_geometries, object))\n\t\t\t// \tconst geometry = this.geometry_from_object(object)\n\t\t\t// \tif (geometry != null) {\n\t\t\t// \t\treturn list.push(new CoreGeometry(geometry));\n\t\t\t// \t}\n\t\t\t// });\n\t\t}\n\t\treturn list;\n\t}\n\t__geometry_from_object(list: BufferGeometry[], object: Mesh) {\n\t\tif (object.geometry) {\n\t\t\treturn list.push(object.geometry as BufferGeometry);\n\t\t}\n\t}\n\t// __core_geometry_from_object(list, object){\n\t// \tconst geometry = CoreGroup.geometry_from_object(object)\n\t// \tif (geometry != null) {\n\t// \t\treturn list.push(new CoreGeometry(geometry));\n\t// \t}\n\t// }\n\tstatic geometry_from_object(object: Object3D): BufferGeometry | null {\n\t\tif ((object as Mesh).isMesh || (object as LineSegments).isLine || (object as Points).isPoints) {\n\t\t\treturn (object as Mesh).geometry as BufferGeometry;\n\t\t}\n\t\treturn null;\n\t}\n\tfaces() {\n\t\treturn lodash_flatten(this.core_geometries().map((g) => g.faces()));\n\t}\n\tpoints() {\n\t\treturn lodash_flatten(this.core_geometries().map((g) => g.points()));\n\t}\n\tpoints_count() {\n\t\treturn lodash_sum(this.core_geometries().map((g) => g.points_count()));\n\t}\n\tpoints_from_group(group: GroupString) {\n\t\tif (group) {\n\t\t\tconst indices = CoreString.indices(group);\n\t\t\t// if (indices) {\n\t\t\tconst points = this.points();\n\t\t\treturn indices.map((i) => points[i]);\n\t\t\t// }\n\t\t} else {\n\t\t\treturn this.points();\n\t\t}\n\t}\n\n\tstatic from_objects(objects: Object3D[]): CoreGroup {\n\t\tconst core_group = new CoreGroup();\n\t\tcore_group.set_objects(objects);\n\t\treturn core_group;\n\t}\n\n\t// objects() {\n\t// \treturn this._objects = lodash_map(this._group.children, (object, i)=> {\n\t// \t\tconst object_wrapper = new CoreObject(object);\n\t// \t\tobject_wrapper.set_index(i);\n\t// \t\treturn object_wrapper;\n\t// \t});\n\t// }\n\tobjects_from_group(group_name: string): Object3D[] {\n\t\treturn this.core_objects_from_group(group_name).map((co) => co.object());\n\t}\n\tcore_objects_from_group(group_name: string): CoreObject[] {\n\t\tgroup_name = lodash_trim(group_name);\n\n\t\tif (group_name !== '') {\n\t\t\tconst index = parseInt(group_name);\n\t\t\tif (!lodash_isNaN(index)) {\n\t\t\t\treturn lodash_compact([this.core_objects()[index]]);\n\t\t\t} else {\n\t\t\t\treturn this.core_objects().filter((core_object) => {\n\t\t\t\t\treturn CoreString.match_mask(group_name, core_object.name());\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\treturn this.core_objects();\n\t\t}\n\t}\n\n\t// reset: ->\n\t// \t@_geometries = []\n\t// \t@_points = []\n\n\t// _find_geometries: ->\n\t// \tlist = []\n\t// \t@_group.traverse (object)=>\n\t// \t\tif (geometry = object.geometry)?\n\t// \t\t\tlist.push new Geometry(geometry)\n\t// \tlist\n\n\t// _find_points: ->\n\t// \tlodash_flatten( lodash_map(this.objects(), (g)->g.points()) )\n\n\t// bounding_box() {\n\t// \treturn new Box3().setFromObject(this._group);\n\t// }\n\tbounding_box(): Box3 {\n\t\treturn (this._bounding_box = this._bounding_box || this._compute_bounding_box());\n\t}\n\tcenter(): Vector3 {\n\t\tconst center = new Vector3();\n\t\tthis.bounding_box().getCenter(center);\n\t\treturn center;\n\t}\n\tsize(): Vector3 {\n\t\tconst size = new Vector3();\n\t\tthis.bounding_box().getSize(size);\n\t\treturn size;\n\t}\n\n\tprivate _compute_bounding_box() {\n\t\tconst bbox = new Box3();\n\t\tif (this._objects) {\n\t\t\tfor (let object of this._objects) {\n\t\t\t\tbbox.expandByObject(object);\n\t\t\t}\n\t\t}\n\t\treturn bbox;\n\t}\n\tcompute_vertex_normals() {\n\t\tfor (let object of this.core_objects()) {\n\t\t\tobject.compute_vertex_normals();\n\t\t}\n\t}\n\n\thas_attrib(name: string) {\n\t\tlet first_geometry;\n\t\tif ((first_geometry = this.core_geometries()[0]) != null) {\n\t\t\treturn first_geometry.has_attrib(name);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\tattrib_type(name: string) {\n\t\tconst first_geometry = this.core_geometries()[0];\n\t\tif (first_geometry != null) {\n\t\t\treturn first_geometry.attrib_type(name);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\trename_attrib(old_name: string, new_name: string, attrib_class: AttribClass) {\n\t\tswitch (attrib_class) {\n\t\t\tcase CoreConstant.ATTRIB_CLASS.VERTEX:\n\t\t\t\tif (this.has_attrib(old_name)) {\n\t\t\t\t\tif (this._objects) {\n\t\t\t\t\t\tfor (let object of this._objects) {\n\t\t\t\t\t\t\tobject.traverse((child) => {\n\t\t\t\t\t\t\t\tconst geometry = CoreGroup.geometry_from_object(child);\n\t\t\t\t\t\t\t\tif (geometry) {\n\t\t\t\t\t\t\t\t\tconst core_geometry = new CoreGeometry(geometry);\n\t\t\t\t\t\t\t\t\tcore_geometry.rename_attribute(old_name, new_name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase CoreConstant.ATTRIB_CLASS.OBJECT:\n\t\t\t\tif (this.has_attrib(old_name)) {\n\t\t\t\t\tif (this._objects) {\n\t\t\t\t\t\tfor (let object of this._objects) {\n\t\t\t\t\t\t\tobject.traverse((child) => {\n\t\t\t\t\t\t\t\tconst core_object = new CoreObject(child, 0);\n\t\t\t\t\t\t\t\tcore_object.rename_attribute(old_name, new_name);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tattrib_names() {\n\t\tlet first_geometry;\n\t\tif ((first_geometry = this.core_geometries()[0]) != null) {\n\t\t\treturn first_geometry.attrib_names();\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\tobject_attrib_names() {\n\t\tlet first_object;\n\t\tif ((first_object = this.core_objects()[0]) != null) {\n\t\t\treturn first_object.attrib_names();\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tattrib_names_matching_mask(masks_string: GroupString) {\n\t\tconst masks = CoreString.attrib_names(masks_string);\n\n\t\tconst matching_attrib_names = [];\n\t\tfor (let attrib_name of this.attrib_names()) {\n\t\t\tfor (let mask of masks) {\n\t\t\t\tif (CoreString.match_mask(attrib_name, mask)) {\n\t\t\t\t\tmatching_attrib_names.push(attrib_name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn lodash_uniq(matching_attrib_names);\n\t}\n\n\tattrib_sizes() {\n\t\tlet first_geometry;\n\t\tif ((first_geometry = this.core_geometries()[0]) != null) {\n\t\t\treturn first_geometry.attrib_sizes();\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t}\n\tattrib_size(attrib_name: string) {\n\t\tlet first_geometry;\n\t\tif ((first_geometry = this.core_geometries()[0]) != null) {\n\t\t\treturn first_geometry.attrib_size(attrib_name);\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tadd_numeric_vertex_attrib(name: string, size: number, default_value: NumericAttribValue) {\n\t\tif (default_value == null) {\n\t\t\tdefault_value = CoreAttribute.default_value(size);\n\t\t}\n\n\t\tfor (let core_geometry of this.core_geometries()) {\n\t\t\tcore_geometry.add_numeric_attrib(name, size, default_value);\n\t\t}\n\t}\n\n\tadd_numeric_object_attrib(name: string, size: number, default_value: NumericAttribValue) {\n\t\tif (default_value == null) {\n\t\t\tdefault_value = CoreAttribute.default_value(size);\n\t\t}\n\n\t\tfor (let core_object of this.core_objects()) {\n\t\t\tcore_object.add_numeric_attrib(name, default_value);\n\t\t}\n\t}\n\n\tstatic clone(src_group: Group) {\n\t\tconst new_group = new Group();\n\n\t\tsrc_group.children.forEach((src_object) => {\n\t\t\tconst new_object = CoreObject.clone(src_object);\n\t\t\tnew_group.add(new_object);\n\t\t});\n\n\t\treturn new_group;\n\t}\n}\n","import {Vector4} from 'three/src/math/Vector4';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n// const THREE = {BufferGeometry, Vector2, Vector3, Vector4}\nimport {CoreAttribute} from './Attribute';\nimport {CoreGeometry} from './Geometry';\nimport {CoreEntity} from './Entity';\n// import Geometry from './Geometry';\n\nconst ATTRIB_NAMES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n};\n\nenum ComponentName {\n\tx = 'x',\n\ty = 'y',\n\tz = 'z',\n\tw = 'w',\n\tr = 'r',\n\tg = 'g',\n\tb = 'b',\n}\nconst COMPONENT_INDICES = {\n\tx: 0,\n\ty: 1,\n\tz: 2,\n\tw: 3,\n\tr: 0,\n\tg: 1,\n\tb: 2,\n};\n\nconst PTNUM = 'ptnum';\nconst DOT = '.';\n\nexport class CorePoint extends CoreEntity {\n\t_geometry: BufferGeometry;\n\t_position: Vector3 | undefined;\n\t_normal: Vector3 | undefined;\n\n\tconstructor(private _core_geometry: CoreGeometry, index: number) {\n\t\tsuper(index);\n\t\tthis._geometry = this._core_geometry.geometry();\n\t}\n\n\tgeometry_wrapper() {\n\t\treturn this._core_geometry;\n\t}\n\tgeometry() {\n\t\treturn (this._geometry = this._geometry || this._core_geometry.geometry());\n\t}\n\n\t// add_attribute: (name, size, value)->\n\t// \t@_attributes[name] = new Attribute(size, value)\n\n\tattrib_size(name: string): number {\n\t\t//@_attributes[name].size()\n\t\tname = CoreAttribute.remap_name(name);\n\t\treturn this._geometry.getAttribute(name).itemSize;\n\t}\n\n\thas_attrib(name: string): boolean {\n\t\tconst remapped_name = CoreAttribute.remap_name(name);\n\t\treturn this._core_geometry.has_attrib(remapped_name);\n\t}\n\n\tattrib_value(name: string) {\n\t\t//, target){ // target could be used, but not entirely sure I am ready now\n\n\t\tif (name === PTNUM) {\n\t\t\treturn this.index;\n\t\t} else {\n\t\t\tlet component_name = null;\n\t\t\tlet component_index = null;\n\t\t\tif (name[name.length - 2] === DOT) {\n\t\t\t\tcomponent_name = name[name.length - 1] as ComponentName;\n\t\t\t\tcomponent_index = COMPONENT_INDICES[component_name];\n\t\t\t\tname = name.substring(0, name.length - 2);\n\t\t\t}\n\t\t\tconst remaped_name = CoreAttribute.remap_name(name);\n\n\t\t\t//if (attrib = @_attributes[name])?\n\t\t\tconst attrib = this._geometry.getAttribute(remaped_name);\n\t\t\tif (attrib) {\n\t\t\t\tconst {array} = attrib;\n\t\t\t\tif (this._core_geometry.is_attrib_indexed(remaped_name)) {\n\t\t\t\t\tconst value_index = this.attrib_value_index(remaped_name); //attrib.value()\n\t\t\t\t\treturn this._core_geometry.user_data_attrib(remaped_name)[value_index];\n\t\t\t\t} else {\n\t\t\t\t\tconst size = attrib.itemSize;\n\t\t\t\t\tconst start_index = this._index * size;\n\n\t\t\t\t\tif (component_index == null) {\n\t\t\t\t\t\tswitch (size) {\n\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\treturn array[start_index];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\treturn new Vector2(array[start_index + 0], array[start_index + 1]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\treturn new Vector3(\n\t\t\t\t\t\t\t\t\tarray[start_index + 0],\n\t\t\t\t\t\t\t\t\tarray[start_index + 1],\n\t\t\t\t\t\t\t\t\tarray[start_index + 2]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t// target.fromArray(array, start_index)\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\t\treturn new Vector4(\n\t\t\t\t\t\t\t\t\tarray[start_index + 0],\n\t\t\t\t\t\t\t\t\tarray[start_index + 1],\n\t\t\t\t\t\t\t\t\tarray[start_index + 2],\n\t\t\t\t\t\t\t\t\tarray[start_index + 3]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthrow `size not valid (${size})`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tswitch (size) {\n\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\treturn array[start_index];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\treturn array[start_index + component_index];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst message = `attrib ${name} not found. availables are: ${Object.keys(\n\t\t\t\t\tthis._geometry.attributes || {}\n\t\t\t\t).join(',')}`;\n\t\t\t\tconsole.warn(message);\n\t\t\t\tthrow message;\n\t\t\t}\n\t\t}\n\t}\n\n\tattrib_value_index(name: string) {\n\t\tif (this._core_geometry.is_attrib_indexed(name)) {\n\t\t\t//@_attributes[name].value()\n\t\t\treturn this._geometry.getAttribute(name).array[this._index];\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tposition(): Vector3 {\n\t\t//@_attributes['position'].value()\n\t\tconst {array} = this._geometry.getAttribute(ATTRIB_NAMES.POSITION);\n\t\tthis._position = this._position || new Vector3();\n\t\treturn this._position.fromArray(array, this._index * 3);\n\t}\n\tset_position(new_position: Vector3) {\n\t\tthis.set_attrib_value_vector3(ATTRIB_NAMES.POSITION, new_position);\n\t}\n\n\tnormal(): Vector3 {\n\t\tconst {array} = this._geometry.getAttribute(ATTRIB_NAMES.NORMAL);\n\t\tthis._normal = this._normal || new Vector3();\n\t\treturn this._normal.fromArray(array, this._index * 3);\n\t}\n\tset_normal(new_normal: Vector3) {\n\t\treturn this.set_attrib_value_vector3(ATTRIB_NAMES.NORMAL, new_normal);\n\t}\n\n\tset_attrib_value(name: string, value: NumericAttribValue | string) {\n\t\t// TODO: this fails if the value is null\n\t\tif (value == null) {\n\t\t\treturn;\n\t\t}\n\t\tif (name == null) {\n\t\t\tthrow 'Point.set_attrib_value requires a name';\n\t\t}\n\n\t\t// attrib = @_attributes[name]\n\t\t// attrib.set_value(value)\n\t\t//value = attrib.value()\n\t\t//value = this.attrib_value()\n\t\tconst attrib = this._geometry.getAttribute(name);\n\t\tconst array = attrib.array as number[];\n\t\tconst attrib_size = attrib.itemSize;\n\n\t\tswitch (attrib_size) {\n\t\t\tcase 1:\n\t\t\t\tarray[this._index] = value as number;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tconst v2 = value as Vector2Like;\n\t\t\t\tarray[this._index * 2 + 0] = v2.x;\n\t\t\t\tarray[this._index * 2 + 1] = v2.y;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tconst is_color = (value as ColorLike).r != null;\n\t\t\t\tif (is_color) {\n\t\t\t\t\tconst col = value as ColorLike;\n\t\t\t\t\tarray[this._index * 3 + 0] = col.r;\n\t\t\t\t\tarray[this._index * 3 + 1] = col.g;\n\t\t\t\t\tarray[this._index * 3 + 2] = col.b;\n\t\t\t\t} else {\n\t\t\t\t\tconst v3 = value as Vector3Like;\n\t\t\t\t\tarray[this._index * 3 + 0] = v3.x;\n\t\t\t\t\tarray[this._index * 3 + 1] = v3.y;\n\t\t\t\t\tarray[this._index * 3 + 2] = v3.z;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn(`Point.set_attrib_value does not yet allow attrib size ${attrib_size}`);\n\t\t\t\tthrow `attrib size ${attrib_size} not implemented`;\n\t\t}\n\t}\n\tset_attrib_value_vector3(name: string, value: Vector3) {\n\t\t// TODO: this fails if the value is null\n\t\tif (value == null) {\n\t\t\treturn;\n\t\t}\n\t\tif (name == null) {\n\t\t\tthrow 'Point.set_attrib_value requires a name';\n\t\t}\n\n\t\tconst attrib = this._geometry.getAttribute(name);\n\t\tconst array = attrib.array as number[];\n\t\tconst i = this._index * 3;\n\n\t\tarray[i] = value.x;\n\t\tarray[i + 1] = value.y;\n\t\tarray[i + 2] = value.z;\n\t}\n\n\tset_attrib_index(name: string, new_value_index: number) {\n\t\t// attrib = @_attributes[name]\n\t\t// attrib.set_value(new_value_index)\n\t\t//value = attrib.value()\n\t\tconst array = this._geometry.getAttribute(name).array as number[];\n\t\treturn (array[this._index] = new_value_index);\n\t}\n}\n","export class CoreEntity {\n\tconstructor(protected _index: number) {}\n\tget index() {\n\t\treturn this._index;\n\t}\n}\n","type IterateeMethod = (element: any, index?: number) => void;\ntype IterateeMethodArray = IterateeMethod; // TODO: check this, as the element may be an array\ntype IterateeMethodCount = (index: number) => void;\n\ninterface CoreIteratorOptions {\n\tmax_time_per_chunk?: number;\n\tcheck_every_interations?: number;\n}\n\nexport class CoreIterator {\n\t// array\n\tprivate _array: any[] | undefined;\n\tprivate _iteratee_method_array: IterateeMethodArray | undefined;\n\tprivate _bound_next_with_array: (() => void) | undefined;\n\tprivate _current_array_element: any;\n\tprivate _array_index: number = 0;\n\n\t// count\n\tprivate _count: number = 0;\n\tprivate _iteratee_method_count: IterateeMethodCount | undefined;\n\tprivate _bound_next_with_count: (() => void) | undefined;\n\tprivate _current_count_index: number = 0;\n\n\tprivate _max_time_per_chunk: number;\n\tprivate _check_every_interations: number;\n\n\tprivate _resolve: null | (() => void) = null;\n\n\tconstructor(options: CoreIteratorOptions = {}) {\n\t\tthis._max_time_per_chunk = options.max_time_per_chunk || 10;\n\t\tthis._check_every_interations = options.check_every_interations || 100;\n\t}\n\n\tasync start_with_count(count: number, iteratee_method: IterateeMethodCount) {\n\t\tthis._count = count;\n\t\tthis._current_count_index = 0;\n\t\tthis._iteratee_method_count = iteratee_method;\n\t\tthis._bound_next_with_count = this.next_with_count.bind(this);\n\n\t\tif (this._resolve) {\n\t\t\tthrow 'an iterator cannot be started twice';\n\t\t}\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis._resolve = resolve;\n\t\t\tthis.next_with_count();\n\t\t});\n\t}\n\tnext_with_count() {\n\t\tconst start_time = performance.now();\n\n\t\tif (this._iteratee_method_count && this._bound_next_with_count) {\n\t\t\twhile (this._current_count_index < this._count) {\n\t\t\t\tthis._iteratee_method_count(this._current_count_index);\n\n\t\t\t\tthis._current_count_index++;\n\n\t\t\t\tif (this._current_count_index % this._check_every_interations == 0) {\n\t\t\t\t\tif (performance.now() - start_time > this._max_time_per_chunk) {\n\t\t\t\t\t\tsetTimeout(this._bound_next_with_count, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._current_count_index >= this._count) {\n\t\t\tif (this._resolve) {\n\t\t\t\tthis._resolve();\n\t\t\t}\n\t\t}\n\t}\n\n\t//\n\t//\n\t// ARRAY\n\t//\n\t//\n\tasync start_with_array(array: any[], iteratee_method: IterateeMethod) {\n\t\tthis._array = array;\n\t\tthis._array_index = 0;\n\t\tthis._iteratee_method_array = iteratee_method;\n\t\tthis._bound_next_with_array = this.next_with_array.bind(this);\n\n\t\tif (this._resolve) {\n\t\t\tthrow 'an iterator cannot be started twice';\n\t\t}\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis._resolve = resolve;\n\t\t\tthis.next_with_array();\n\t\t});\n\t}\n\tnext_with_array() {\n\t\tconst start_time = performance.now();\n\n\t\tif (this._iteratee_method_array && this._bound_next_with_array && this._array) {\n\t\t\twhile ((this._current_array_element = this._array[this._array_index])) {\n\t\t\t\tthis._iteratee_method_array(this._current_array_element, this._array_index);\n\n\t\t\t\tthis._array_index++;\n\n\t\t\t\tif (this._array_index % this._check_every_interations == 0) {\n\t\t\t\t\tif (performance.now() - start_time > this._max_time_per_chunk) {\n\t\t\t\t\t\tsetTimeout(this._bound_next_with_array, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._current_array_element === undefined) {\n\t\t\tif (this._resolve) {\n\t\t\t\tthis._resolve();\n\t\t\t}\n\t\t}\n\t}\n}\n","import {CoreMath} from 'src/core/math/_Module'\nimport {Vector2} from 'three/src/math/Vector2'\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute'\nimport {BufferGeometry} from 'three/src/core/BufferGeometry'\n\nexport class CoreGeometryUtilCircle {\n\tstatic positions(\n\t\tradius: number,\n\t\tsegments_count: number,\n\t\tarc_angle: number = 360\n\t) {\n\t\tconst radian_per_segment =\n\t\t\tCoreMath.degrees_to_radians(arc_angle) / segments_count\n\n\t\tconst positions = []\n\t\tfor (let i = 0; i < segments_count; i++) {\n\t\t\tconst point_radian = radian_per_segment * i\n\t\t\tconst x = radius * Math.cos(point_radian)\n\t\t\tconst y = radius * Math.sin(point_radian)\n\n\t\t\tpositions.push(new Vector2(x, y))\n\t\t}\n\n\t\treturn positions\n\t}\n\n\tstatic create(\n\t\tradius: number,\n\t\tsegments_count: number,\n\t\tarc_angle: number = 360\n\t) {\n\t\tconst positions_2d = this.positions(radius, segments_count, arc_angle)\n\n\t\tconst positions = []\n\t\tconst indices = []\n\t\tlet position_2d\n\t\tfor (let i = 0; i < positions_2d.length; i++) {\n\t\t\tposition_2d = positions_2d[i]\n\n\t\t\tpositions.push(position_2d.x)\n\t\t\tpositions.push(position_2d.y)\n\t\t\tpositions.push(0)\n\n\t\t\tif (i > 0) {\n\t\t\t\tindices.push(i - 1)\n\t\t\t\tindices.push(i)\n\t\t\t}\n\t\t}\n\n\t\t// also add the last segment\n\t\tindices.push(segments_count - 1)\n\t\tindices.push(0)\n\n\t\tconst geometry = new BufferGeometry()\n\t\tgeometry.setAttribute(\n\t\t\t'position',\n\t\t\tnew Float32BufferAttribute(positions, 3)\n\t\t)\n\t\tgeometry.setIndex(indices)\n\n\t\treturn geometry\n\t}\n}\n","// import {Core} from 'src/core/_Module';\nimport lodash_isArray from 'lodash/isArray';\nimport lodash_isObject from 'lodash/isObject';\nimport lodash_isString from 'lodash/isString';\nimport lodash_flatten from 'lodash/flatten';\nimport {Points} from 'three/src/objects/Points';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nconst THREE = {BufferGeometry, Float32BufferAttribute, Points};\n\n// import UrlLoader from '../UrlLoader';\nimport axios from 'axios';\nimport {CoreString} from 'src/core/String';\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {CoreConstant} from 'src/core/geometry/Constant';\nimport {CoreAttributeData} from 'src/core/geometry/AttributeData';\nimport {CoreAttribute} from 'src/core/geometry/Attribute';\n// import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {Object3D} from 'three/src/core/Object3D';\n\nconst DEEP_ATTRIB_SEPARATOR = ':';\n\nexport interface JsonDataLoaderOptions {\n\tdata_keys_prefix?: string;\n\tskip_entries?: string;\n\tdo_convert?: boolean;\n\tconvert_to_numeric?: string;\n}\n\nexport class JsonDataLoader {\n\t_json: any[] | undefined;\n\t_attribute_datas_by_name: Dictionary<CoreAttributeData> = {};\n\tprivate _options: JsonDataLoaderOptions = {};\n\n\tconstructor(options: JsonDataLoaderOptions = {}) {\n\t\tthis._options.data_keys_prefix = options.data_keys_prefix;\n\t\tthis._options.skip_entries = options.skip_entries;\n\t\tthis._options.do_convert = options.do_convert || false;\n\t\tthis._options.convert_to_numeric = options.convert_to_numeric;\n\t}\n\t//\n\n\tload(\n\t\turl: string,\n\t\tsuccess_callback: (object: Object3D) => void,\n\t\tprogress_callback: (() => void) | undefined,\n\t\terror_callback: (error: ErrorEvent) => void | undefined\n\t) {\n\t\t// const url_loader = new UrlLoader();\n\t\t// const start_time = performance.now();\n\t\t// const config = {\n\t\t// \tcrossdomain: true\n\t\t// }\n\t\taxios\n\t\t\t.get(url)\n\t\t\t.then((response) => {\n\t\t\t\t// const end_time = performance.now();\n\n\t\t\t\tthis._json = response.data;\n\t\t\t\tif (this._options.data_keys_prefix != null && this._options.data_keys_prefix != '') {\n\t\t\t\t\tthis._json = this.get_prefixed_json(this._json, this._options.data_keys_prefix.split('.'));\n\t\t\t\t}\n\t\t\t\tconst object = this.create_object();\n\t\t\t\tsuccess_callback(object);\n\t\t\t})\n\t\t\t.catch((error: ErrorEvent) => {\n\t\t\t\tconsole.log('error', error);\n\t\t\t\terror_callback(error);\n\t\t\t});\n\t}\n\n\tget_prefixed_json(json: any, prefixes: string[]): any[] {\n\t\tif (prefixes.length == 0) {\n\t\t\treturn json;\n\t\t} else {\n\t\t\tconst first_prefix = prefixes.shift();\n\t\t\tif (first_prefix) {\n\t\t\t\treturn this.get_prefixed_json(json[first_prefix], prefixes);\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tset_json(json: any) {\n\t\treturn (this._json = json);\n\t}\n\n\tcreate_object() {\n\t\tconst geometry = new THREE.BufferGeometry();\n\t\tconst core_geo = new CoreGeometry(geometry);\n\n\t\tif (this._json != null) {\n\t\t\tconst points_count = this._json.length;\n\t\t\tcore_geo.init_position_attribute(points_count);\n\n\t\t\tthis._find_attributes();\n\t\t\t// for(let attrib_name of Object.keys(this._attribute_names)){\n\t\t\t// \tconst attrib_data = this._attribute_datas_by_name[attrib_name];\n\t\t\t// \treturn core_geo.add_attribute(attrib_name, attrib_data);\n\t\t\t// }\n\n\t\t\tconst convert_to_numeric_masks = CoreString.attrib_names(this._options.convert_to_numeric || '');\n\n\t\t\t// set values\n\t\t\tfor (let attrib_name of Object.keys(this._attribute_datas_by_name)) {\n\t\t\t\tlet attrib_values = lodash_flatten(this._attribute_values_for_name(attrib_name));\n\n\t\t\t\tconst data = this._attribute_datas_by_name[attrib_name];\n\t\t\t\tconst size = data.size();\n\n\t\t\t\tif (data.type() === CoreConstant.ATTRIB_TYPE.STRING) {\n\t\t\t\t\t// const index_data = CoreAttribute.array_to_indexed_arrays(\n\t\t\t\t\t// \tattrib_values as string[]\n\t\t\t\t\t// )\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis._options.do_convert &&\n\t\t\t\t\t\tCoreString.matches_one_mask(attrib_name, convert_to_numeric_masks)\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst numerical_attrib_values: number[] = attrib_values.map((v) => {\n\t\t\t\t\t\t\tif (lodash_isString(v)) {\n\t\t\t\t\t\t\t\treturn parseFloat(v) || 0;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn v;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tgeometry.setAttribute(\n\t\t\t\t\t\t\tattrib_name,\n\t\t\t\t\t\t\tnew THREE.Float32BufferAttribute(numerical_attrib_values, size)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst index_data = CoreAttribute.array_to_indexed_arrays(attrib_values as string[]);\n\t\t\t\t\t\tcore_geo.set_indexed_attribute(attrib_name, index_data['values'], index_data['indices']);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst numerical_attrib_values = attrib_values as number[];\n\t\t\t\t\tgeometry.setAttribute(attrib_name, new THREE.Float32BufferAttribute(numerical_attrib_values, size));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn new THREE.Points(geometry, CoreConstant.MATERIALS[THREE.Points.name]);\n\t}\n\n\tprivate _find_attributes() {\n\t\tlet first_pt;\n\n\t\tconst masks = CoreString.attrib_names(this._options.skip_entries || '');\n\n\t\tif (this._json) {\n\t\t\tif ((first_pt = this._json[0]) != null) {\n\t\t\t\tfor (let attrib_name of Object.keys(first_pt)) {\n\t\t\t\t\tconst attrib_value = first_pt[attrib_name];\n\n\t\t\t\t\tif (this._value_has_subentries(attrib_value)) {\n\t\t\t\t\t\tfor (let key of Object.keys(attrib_value)) {\n\t\t\t\t\t\t\tconst deep_attrib_name = [attrib_name, key].join(DEEP_ATTRIB_SEPARATOR);\n\t\t\t\t\t\t\tconst deep_attrib_value = attrib_value[attrib_name];\n\n\t\t\t\t\t\t\tif (!CoreString.matches_one_mask(deep_attrib_name, masks)) {\n\t\t\t\t\t\t\t\tthis._attribute_datas_by_name[deep_attrib_name] = CoreAttributeData.from_value(\n\t\t\t\t\t\t\t\t\tdeep_attrib_value\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!CoreString.matches_one_mask(attrib_name, masks)) {\n\t\t\t\t\t\t\tthis._attribute_datas_by_name[attrib_name] = CoreAttributeData.from_value(attrib_value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _attribute_values_for_name(attrib_name: string): StringOrNumber[] {\n\t\tif (this._json) {\n\t\t\treturn this._json.map((json_element: Dictionary<any>) => {\n\t\t\t\tconst prefix = attrib_name.split(DEEP_ATTRIB_SEPARATOR)[0];\n\t\t\t\tconst value = json_element[prefix];\n\t\t\t\tif (this._value_has_subentries(value)) {\n\t\t\t\t\tconst deep_attrib_name = attrib_name.substring(prefix.length + 1);\n\t\t\t\t\treturn value[deep_attrib_name] || 0;\n\t\t\t\t} else {\n\t\t\t\t\treturn value || 0;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\n\t_value_has_subentries(value: any): boolean {\n\t\treturn lodash_isObject(value) && !lodash_isArray(value);\n\t}\n}\n","import {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {FileLoader} from 'three/src/loaders/FileLoader';\nimport {Loader} from 'three/src/loaders/Loader';\n/**\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\n\nvar DRACOLoader = function ( manager ) {\n\n\tLoader.call( this, manager );\n\n\tthis.decoderPath = '';\n\tthis.decoderConfig = {};\n\tthis.decoderBinary = null;\n\tthis.decoderPending = null;\n\n\tthis.workerLimit = 4;\n\tthis.workerPool = [];\n\tthis.workerNextTaskID = 1;\n\tthis.workerSourceURL = '';\n\n\tthis.defaultAttributeIDs = {\n\t\tposition: 'POSITION',\n\t\tnormal: 'NORMAL',\n\t\tcolor: 'COLOR',\n\t\tuv: 'TEX_COORD'\n\t};\n\tthis.defaultAttributeTypes = {\n\t\tposition: 'Float32Array',\n\t\tnormal: 'Float32Array',\n\t\tcolor: 'Float32Array',\n\t\tuv: 'Float32Array'\n\t};\n\n};\n\nDRACOLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: DRACOLoader,\n\n\tsetDecoderPath: function ( path ) {\n\n\t\tthis.decoderPath = path;\n\n\t\treturn this;\n\n\t},\n\n\tsetDecoderConfig: function ( config ) {\n\n\t\tthis.decoderConfig = config;\n\n\t\treturn this;\n\n\t},\n\n\tsetWorkerLimit: function ( workerLimit ) {\n\n\t\tthis.workerLimit = workerLimit;\n\n\t\treturn this;\n\n\t},\n\n\t/** @deprecated */\n\tsetVerbosity: function () {\n\n\t\tconsole.warn( 'THREE.DRACOLoader: The .setVerbosity() method has been removed.' );\n\n\t},\n\n\t/** @deprecated */\n\tsetDrawMode: function () {\n\n\t\tconsole.warn( 'THREE.DRACOLoader: The .setDrawMode() method has been removed.' );\n\n\t},\n\n\t/** @deprecated */\n\tsetSkipDequantization: function () {\n\n\t\tconsole.warn( 'THREE.DRACOLoader: The .setSkipDequantization() method has been removed.' );\n\n\t},\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.crossOrigin === 'use-credentials' ) {\n\n\t\t\tloader.setWithCredentials( true );\n\n\t\t}\n\n\t\tloader.load( url, ( buffer ) => {\n\n\t\t\tvar taskConfig = {\n\t\t\t\tattributeIDs: this.defaultAttributeIDs,\n\t\t\t\tattributeTypes: this.defaultAttributeTypes,\n\t\t\t\tuseUniqueIDs: false\n\t\t\t};\n\n\t\t\tthis.decodeGeometry( buffer, taskConfig )\n\t\t\t\t.then( onLoad )\n\t\t\t\t.catch( onError );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\t/** @deprecated Kept for backward-compatibility with previous DRACOLoader versions. */\n\tdecodeDracoFile: function ( buffer, callback, attributeIDs, attributeTypes ) {\n\n\t\tvar taskConfig = {\n\t\t\tattributeIDs: attributeIDs || this.defaultAttributeIDs,\n\t\t\tattributeTypes: attributeTypes || this.defaultAttributeTypes,\n\t\t\tuseUniqueIDs: !! attributeIDs\n\t\t};\n\n\t\tthis.decodeGeometry( buffer, taskConfig ).then( callback );\n\n\t},\n\n\tdecodeGeometry: function ( buffer, taskConfig ) {\n\n\t\t// TODO: For backward-compatibility, support 'attributeTypes' objects containing\n\t\t// references (rather than names) to typed array constructors. These must be\n\t\t// serialized before sending them to the worker.\n\t\tfor ( var attribute in taskConfig.attributeTypes ) {\n\n\t\t\tvar type = taskConfig.attributeTypes[ attribute ];\n\n\t\t\tif ( type.BYTES_PER_ELEMENT !== undefined ) {\n\n\t\t\t\ttaskConfig.attributeTypes[ attribute ] = type.name;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tvar taskKey = JSON.stringify( taskConfig );\n\n\t\t// Check for an existing task using this buffer. A transferred buffer cannot be transferred\n\t\t// again from this thread.\n\t\tif ( DRACOLoader.taskCache.has( buffer ) ) {\n\n\t\t\tvar cachedTask = DRACOLoader.taskCache.get( buffer );\n\n\t\t\tif ( cachedTask.key === taskKey ) {\n\n\t\t\t\treturn cachedTask.promise;\n\n\t\t\t} else if ( buffer.byteLength === 0 ) {\n\n\t\t\t\t// Technically, it would be possible to wait for the previous task to complete,\n\t\t\t\t// transfer the buffer back, and decode again with the second configuration. That\n\t\t\t\t// is complex, and I don't know of any reason to decode a Draco buffer twice in\n\t\t\t\t// different ways, so this is left unimplemented.\n\t\t\t\tthrow new Error(\n\n\t\t\t\t\t'THREE.DRACOLoader: Unable to re-decode a buffer with different ' +\n\t\t\t\t\t'settings. Buffer has already been transferred.'\n\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tvar worker;\n\t\tvar taskID = this.workerNextTaskID ++;\n\t\tvar taskCost = buffer.byteLength;\n\n\t\t// Obtain a worker and assign a task, and construct a geometry instance\n\t\t// when the task completes.\n\t\tvar geometryPending = this._getWorker( taskID, taskCost )\n\t\t\t.then( ( _worker ) => {\n\n\t\t\t\tworker = _worker;\n\n\t\t\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\t\t\tworker._callbacks[ taskID ] = { resolve, reject };\n\n\t\t\t\t\tworker.postMessage( { type: 'decode', id: taskID, taskConfig, buffer }, [ buffer ] );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t} );\n\n\t\t\t} )\n\t\t\t.then( ( message ) => this._createGeometry( message.geometry ) );\n\n\t\t// Remove task from the task list.\n\t\tgeometryPending\n\t\t\t.finally( () => {\n\n\t\t\t\tif ( worker && taskID ) {\n\n\t\t\t\t\tthis._releaseTask( worker, taskID );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t// Cache the task result.\n\t\tDRACOLoader.taskCache.set( buffer, {\n\n\t\t\tkey: taskKey,\n\t\t\tpromise: geometryPending\n\n\t\t} );\n\n\t\treturn geometryPending;\n\n\t},\n\n\t_createGeometry: function ( geometryData ) {\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tif ( geometryData.index ) {\n\n\t\t\tgeometry.setIndex( new BufferAttribute( geometryData.index.array, 1 ) );\n\n\t\t}\n\n\t\tfor ( var i = 0; i < geometryData.attributes.length; i ++ ) {\n\n\t\t\tvar attribute = geometryData.attributes[ i ];\n\t\t\tvar name = attribute.name;\n\t\t\tvar array = attribute.array;\n\t\t\tvar itemSize = attribute.itemSize;\n\n\t\t\tgeometry.setAttribute( name, new BufferAttribute( array, itemSize ) );\n\n\t\t}\n\n\t\treturn geometry;\n\n\t},\n\n\t_loadLibrary: function ( url, responseType ) {\n\n\t\tvar loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.decoderPath );\n\t\tloader.setResponseType( responseType );\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tloader.load( url, resolve, undefined, reject );\n\n\t\t} );\n\n\t},\n\n\tpreload: function () {\n\n\t\tthis._initDecoder();\n\n\t\treturn this;\n\n\t},\n\n\t_initDecoder: function () {\n\n\t\tif ( this.decoderPending ) return this.decoderPending;\n\n\t\tvar useJS = typeof WebAssembly !== 'object' || this.decoderConfig.type === 'js';\n\t\tvar librariesPending = [];\n\n\t\tif ( useJS ) {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.js', 'text' ) );\n\n\t\t} else {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_wasm_wrapper.js', 'text' ) );\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.wasm', 'arraybuffer' ) );\n\n\t\t}\n\n\t\tthis.decoderPending = Promise.all( librariesPending )\n\t\t\t.then( ( libraries ) => {\n\n\t\t\t\tvar jsContent = libraries[ 0 ];\n\n\t\t\t\tif ( ! useJS ) {\n\n\t\t\t\t\tthis.decoderConfig.wasmBinary = libraries[ 1 ];\n\n\t\t\t\t}\n\n\t\t\t\tvar fn = DRACOLoader.DRACOWorker.toString();\n\n\t\t\t\tvar body = [\n\t\t\t\t\t'/* draco decoder */',\n\t\t\t\t\tjsContent,\n\t\t\t\t\t'',\n\t\t\t\t\t'/* worker */',\n\t\t\t\t\tfn.substring( fn.indexOf( '{' ) + 1, fn.lastIndexOf( '}' ) )\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tthis.workerSourceURL = URL.createObjectURL( new Blob( [ body ] ) );\n\n\t\t\t} );\n\n\t\treturn this.decoderPending;\n\n\t},\n\n\t_getWorker: function ( taskID, taskCost ) {\n\n\t\treturn this._initDecoder().then( () => {\n\n\t\t\tif ( this.workerPool.length < this.workerLimit ) {\n\n\t\t\t\tvar worker = new Worker( this.workerSourceURL );\n\n\t\t\t\tworker._callbacks = {};\n\t\t\t\tworker._taskCosts = {};\n\t\t\t\tworker._taskLoad = 0;\n\n\t\t\t\tworker.postMessage( { type: 'init', decoderConfig: this.decoderConfig } );\n\n\t\t\t\tworker.onmessage = function ( e ) {\n\n\t\t\t\t\tvar message = e.data;\n\n\t\t\t\t\tswitch ( message.type ) {\n\n\t\t\t\t\t\tcase 'decode':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].resolve( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].reject( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.DRACOLoader: Unexpected message, \"' + message.type + '\"' );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tthis.workerPool.push( worker );\n\n\t\t\t} else {\n\n\t\t\t\tthis.workerPool.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a._taskLoad > b._taskLoad ? - 1 : 1;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tvar worker = this.workerPool[ this.workerPool.length - 1 ];\n\t\t\tworker._taskCosts[ taskID ] = taskCost;\n\t\t\tworker._taskLoad += taskCost;\n\t\t\treturn worker;\n\n\t\t} );\n\n\t},\n\n\t_releaseTask: function ( worker, taskID ) {\n\n\t\tworker._taskLoad -= worker._taskCosts[ taskID ];\n\t\tdelete worker._callbacks[ taskID ];\n\t\tdelete worker._taskCosts[ taskID ];\n\n\t},\n\n\tdebug: function () {\n\n\t\tconsole.log( 'Task load: ', this.workerPool.map( ( worker ) => worker._taskLoad ) );\n\n\t},\n\n\tdispose: function () {\n\n\t\tfor ( var i = 0; i < this.workerPool.length; ++ i ) {\n\n\t\t\tthis.workerPool[ i ].terminate();\n\n\t\t}\n\n\t\tthis.workerPool.length = 0;\n\n\t\treturn this;\n\n\t}\n\n} );\n\n/* WEB WORKER */\n\nDRACOLoader.DRACOWorker = function () {\n\n\tvar decoderConfig;\n\tvar decoderPending;\n\n\tonmessage = function ( e ) {\n\n\t\tvar message = e.data;\n\n\t\tswitch ( message.type ) {\n\n\t\t\tcase 'init':\n\t\t\t\tdecoderConfig = message.decoderConfig;\n\t\t\t\tdecoderPending = new Promise( function ( resolve/*, reject*/ ) {\n\n\t\t\t\t\tdecoderConfig.onModuleLoaded = function ( draco ) {\n\n\t\t\t\t\t\t// Module is Promise-like. Wrap before resolving to avoid loop.\n\t\t\t\t\t\tresolve( { draco: draco } );\n\n\t\t\t\t\t};\n\n\t\t\t\t\tDracoDecoderModule( decoderConfig );\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t\tcase 'decode':\n\t\t\t\tvar buffer = message.buffer;\n\t\t\t\tvar taskConfig = message.taskConfig;\n\t\t\t\tdecoderPending.then( ( module ) => {\n\n\t\t\t\t\tvar draco = module.draco;\n\t\t\t\t\tvar decoder = new draco.Decoder();\n\t\t\t\t\tvar decoderBuffer = new draco.DecoderBuffer();\n\t\t\t\t\tdecoderBuffer.Init( new Int8Array( buffer ), buffer.byteLength );\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tvar geometry = decodeGeometry( draco, decoder, decoderBuffer, taskConfig );\n\n\t\t\t\t\t\tvar buffers = geometry.attributes.map( ( attr ) => attr.array.buffer );\n\n\t\t\t\t\t\tif ( geometry.index ) buffers.push( geometry.index.array.buffer );\n\n\t\t\t\t\t\tself.postMessage( { type: 'decode', id: message.id, geometry }, buffers );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tconsole.error( error );\n\n\t\t\t\t\t\tself.postMessage( { type: 'error', id: message.id, error: error.message } );\n\n\t\t\t\t\t} finally {\n\n\t\t\t\t\t\tdraco.destroy( decoderBuffer );\n\t\t\t\t\t\tdraco.destroy( decoder );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t};\n\n\tfunction decodeGeometry( draco, decoder, decoderBuffer, taskConfig ) {\n\n\t\tvar attributeIDs = taskConfig.attributeIDs;\n\t\tvar attributeTypes = taskConfig.attributeTypes;\n\n\t\tvar dracoGeometry;\n\t\tvar decodingStatus;\n\n\t\tvar geometryType = decoder.GetEncodedGeometryType( decoderBuffer );\n\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tdracoGeometry = new draco.Mesh();\n\t\t\tdecodingStatus = decoder.DecodeBufferToMesh( decoderBuffer, dracoGeometry );\n\n\t\t} else if ( geometryType === draco.POINT_CLOUD ) {\n\n\t\t\tdracoGeometry = new draco.PointCloud();\n\t\t\tdecodingStatus = decoder.DecodeBufferToPointCloud( decoderBuffer, dracoGeometry );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Unexpected geometry type.' );\n\n\t\t}\n\n\t\tif ( ! decodingStatus.ok() || dracoGeometry.ptr === 0 ) {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Decoding failed: ' + decodingStatus.error_msg() );\n\n\t\t}\n\n\t\tvar geometry = { index: null, attributes: [] };\n\n\t\t// Gather all vertex attributes.\n\t\tfor ( var attributeName in attributeIDs ) {\n\n\t\t\tvar attributeType = self[ attributeTypes[ attributeName ] ];\n\n\t\t\tvar attribute;\n\t\t\tvar attributeID;\n\n\t\t\t// A Draco file may be created with default vertex attributes, whose attribute IDs\n\t\t\t// are mapped 1:1 from their semantic name (POSITION, NORMAL, ...). Alternatively,\n\t\t\t// a Draco file may contain a custom set of attributes, identified by known unique\n\t\t\t// IDs. glTF files always do the latter, and `.drc` files typically do the former.\n\t\t\tif ( taskConfig.useUniqueIDs ) {\n\n\t\t\t\tattributeID = attributeIDs[ attributeName ];\n\t\t\t\tattribute = decoder.GetAttributeByUniqueId( dracoGeometry, attributeID );\n\n\t\t\t} else {\n\n\t\t\t\tattributeID = decoder.GetAttributeId( dracoGeometry, draco[ attributeIDs[ attributeName ] ] );\n\n\t\t\t\tif ( attributeID === - 1 ) continue;\n\n\t\t\t\tattribute = decoder.GetAttribute( dracoGeometry, attributeID );\n\n\t\t\t}\n\n\t\t\tgeometry.attributes.push( decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) );\n\n\t\t}\n\n\t\t// Add index.\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\t// Generate mesh faces.\n\t\t\tvar numFaces = dracoGeometry.num_faces();\n\t\t\tvar numIndices = numFaces * 3;\n\t\t\tvar index = new Uint32Array( numIndices );\n\t\t\tvar indexArray = new draco.DracoInt32Array();\n\n\t\t\tfor ( var i = 0; i < numFaces; ++ i ) {\n\n\t\t\t\tdecoder.GetFaceFromMesh( dracoGeometry, i, indexArray );\n\n\t\t\t\tfor ( var j = 0; j < 3; ++ j ) {\n\n\t\t\t\t\tindex[ i * 3 + j ] = indexArray.GetValue( j );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgeometry.index = { array: index, itemSize: 1 };\n\n\t\t\tdraco.destroy( indexArray );\n\n\t\t}\n\n\t\tdraco.destroy( dracoGeometry );\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) {\n\n\t\tvar numComponents = attribute.num_components();\n\t\tvar numPoints = dracoGeometry.num_points();\n\t\tvar numValues = numPoints * numComponents;\n\t\tvar dracoArray;\n\n\t\tvar array;\n\n\t\tswitch ( attributeType ) {\n\n\t\t\tcase Float32Array:\n\t\t\t\tdracoArray = new draco.DracoFloat32Array();\n\t\t\t\tdecoder.GetAttributeFloatForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Float32Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Int8Array:\n\t\t\t\tdracoArray = new draco.DracoInt8Array();\n\t\t\t\tdecoder.GetAttributeInt8ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Int8Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Int16Array:\n\t\t\t\tdracoArray = new draco.DracoInt16Array();\n\t\t\t\tdecoder.GetAttributeInt16ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Int16Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Int32Array:\n\t\t\t\tdracoArray = new draco.DracoInt32Array();\n\t\t\t\tdecoder.GetAttributeInt32ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Int32Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Uint8Array:\n\t\t\t\tdracoArray = new draco.DracoUInt8Array();\n\t\t\t\tdecoder.GetAttributeUInt8ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Uint8Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Uint16Array:\n\t\t\t\tdracoArray = new draco.DracoUInt16Array();\n\t\t\t\tdecoder.GetAttributeUInt16ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Uint16Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Uint32Array:\n\t\t\t\tdracoArray = new draco.DracoUInt32Array();\n\t\t\t\tdecoder.GetAttributeUInt32ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Uint32Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.DRACOLoader: Unexpected attribute type.' );\n\n\t\t}\n\n\t\tfor ( var i = 0; i < numValues; i ++ ) {\n\n\t\t\tarray[ i ] = dracoArray.GetValue( i );\n\n\t\t}\n\n\t\tdraco.destroy( dracoArray );\n\n\t\treturn {\n\t\t\tname: attributeName,\n\t\t\tarray: array,\n\t\t\titemSize: numComponents\n\t\t};\n\n\t}\n\n};\n\nDRACOLoader.taskCache = new WeakMap();\n\n/** Deprecated static methods */\n\n/** @deprecated */\nDRACOLoader.setDecoderPath = function () {\n\n\tconsole.warn( 'THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.' );\n\n};\n\n/** @deprecated */\nDRACOLoader.setDecoderConfig = function () {\n\n\tconsole.warn( 'THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.' );\n\n};\n\n/** @deprecated */\nDRACOLoader.releaseDecoderModule = function () {\n\n\tconsole.warn( 'THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.' );\n\n};\n\n/** @deprecated */\nDRACOLoader.getDecoderModule = function () {\n\n\tconsole.warn( 'THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.' );\n\n};\n\nexport { DRACOLoader };\n","import {Float32BufferAttribute} from 'three/src/core/BufferAttribute'\nimport {BufferGeometry} from 'three/src/core/BufferGeometry'\nimport {CoreGeometry} from '../Geometry'\n// import lodash_range from 'lodash/range'\nimport lodash_flatten from 'lodash/flatten'\nimport lodash_intersection from 'lodash/intersection'\nimport lodash_concat from 'lodash/concat'\n\nexport class CoreGeometryOperationSkin {\n\tconstructor(\n\t\tprivate geometry: BufferGeometry,\n\t\tprivate geometry1: BufferGeometry,\n\t\tprivate geometry0: BufferGeometry\n\t) {}\n\n\tprocess() {\n\t\tconst geometry_wrapper0 = new CoreGeometry(this.geometry0)\n\t\tconst geometry_wrapper1 = new CoreGeometry(this.geometry1)\n\t\tconst segments0 = geometry_wrapper0.segments()\n\t\tconst segments1 = geometry_wrapper1.segments()\n\n\t\tif (segments0.length === 0 || segments1.length === 0) {\n\t\t\treturn\n\t\t}\n\t\t// find smallest geo to iterate on its array\n\t\tconst geometries_by_segments_count =\n\t\t\tsegments0.length < segments1.length\n\t\t\t\t? [geometry_wrapper0, geometry_wrapper1]\n\t\t\t\t: [geometry_wrapper1, geometry_wrapper0]\n\n\t\tconst smallest_geometry = geometries_by_segments_count[0]\n\t\tconst largest_geometry = geometries_by_segments_count[1]\n\n\t\tconst smallest_segments = smallest_geometry.segments()\n\t\tconst largest_segments = largest_geometry.segments()\n\n\t\tconst smallest_points = smallest_geometry.points()\n\t\tconst largest_points = largest_geometry.points()\n\t\tconst smallest_points_count = smallest_points.length\n\t\t// const largest_points_count = largest_points.length;\n\t\tconst all_points = lodash_concat(smallest_points, largest_points)\n\n\t\t// const half_faces_count = smallest_segments.length;\n\t\tconst points_indices: number[] = []\n\t\tsmallest_segments.forEach((segment, i) => {\n\t\t\tconst matched_segment = largest_segments[i]\n\t\t\t// face 1\n\t\t\tpoints_indices.push(segment[0])\n\t\t\tpoints_indices.push(segment[1])\n\t\t\tpoints_indices.push(matched_segment[0] + smallest_points_count)\n\t\t\t// face 2\n\t\t\tpoints_indices.push(segment[1])\n\t\t\tpoints_indices.push(matched_segment[1] + smallest_points_count)\n\t\t\tpoints_indices.push(matched_segment[0] + smallest_points_count)\n\t\t})\n\n\t\tconst attributes_in_common = lodash_intersection(\n\t\t\tsmallest_geometry.attrib_names(),\n\t\t\tlargest_geometry.attrib_names()\n\t\t)\n\t\t// const points = all_points //points_indices.map(index=> all_points[index]);\n\t\tattributes_in_common.forEach((attrib_name) => {\n\t\t\tconst attrib_size = smallest_geometry.attrib_size(attrib_name)\n\t\t\tlet attrib_values = all_points.map((point) =>\n\t\t\t\tpoint.attrib_value(attrib_name)\n\t\t\t)\n\t\t\tif (attrib_size > 1) {\n\t\t\t\tattrib_values = lodash_flatten(\n\t\t\t\t\tattrib_values.map((v) => v.toArray())\n\t\t\t\t)\n\t\t\t}\n\t\t\tthis.geometry.setAttribute(\n\t\t\t\tattrib_name,\n\t\t\t\tnew Float32BufferAttribute(attrib_values, attrib_size)\n\t\t\t)\n\t\t})\n\n\t\t// const new_indices = lodash_range(points.length);\n\t\tthis.geometry.setIndex(points_indices)\n\t\tthis.geometry.computeVertexNormals()\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\n\nimport {NodeJsonImporter} from './Node';\n// import {BaseNodeObjJsonImporter} from './node/Obj';\n// import {BaseNodeSopSubnetworkJsonImporter} from './node/Subnetwork';\n\nimport {ParamJsonImporter} from './Param';\nimport {ParamMultipleJsonImporter} from './param/Multiple';\nimport {ParamStringJsonImporter} from './param/String';\nimport {ParamRampJsonImporter} from './param/Ramp';\n// import {TypedObjNode} from 'src/engine/nodes/obj/_Base';\nimport {TypedMultipleParam} from 'src/engine/params/_Multiple';\nimport {StringParam} from 'src/engine/params/String';\nimport {RampParam} from 'src/engine/params/Ramp';\n\nexport class JsonImportDispatcher {\n\tstatic dispatch_node(node: BaseNodeType) {\n\t\t// if (node instanceof TypedObjNode) {\n\t\t// \treturn new BaseNodeObjJsonImporter(node);\n\t\t// }\n\t\treturn new NodeJsonImporter(node);\n\t}\n\n\tstatic dispatch_param(param: BaseParamType) {\n\t\tif (param instanceof TypedMultipleParam) {\n\t\t\treturn new ParamMultipleJsonImporter(param);\n\t\t}\n\t\tif (param instanceof StringParam) {\n\t\t\treturn new ParamStringJsonImporter(param);\n\t\t}\n\t\tif (param instanceof RampParam) {\n\t\t\treturn new ParamRampJsonImporter(param);\n\t\t}\n\t\treturn new ParamJsonImporter(param);\n\t}\n}\n\n// export class CodeImporterVisitor {\n// \tstatic node(node: BaseNode): NodeCodeImporter {\n// \t\treturn new NodeCodeImporter(node);\n// \t}\n// \tstatic node_obj(node: BaseNode) {\n// \t\treturn new BaseNodeObjCodeImporter(node);\n// \t}\n// \tstatic node_sop_subnetwork(node: BaseNode) {\n// \t\treturn new BaseNodeSopSubnetworkCodeImporter(node);\n// \t}\n\n// \tstatic visit_param(param: BaseParam) {\n// \t\treturn new ParamCodeImporter(param);\n// \t}\n// \tstatic param_multiple(param: BaseParam) {\n// \t\treturn new ParamMultipleCodeImporter(param);\n// \t}\n// \tstatic param_numeric(param: BaseParam) {\n// \t\treturn new ParamNumericCodeImporter(param);\n// \t}\n// \tstatic param_operator_path(param: BaseParam) {\n// \t\treturn new ParamOperatorPathCodeImporter(param);\n// \t}\n// \tstatic param_string(param: BaseParam) {\n// \t\treturn new ParamStringCodeImporter(param);\n// \t}\n// \tstatic param_ramp(param: BaseParam) {\n// \t\treturn new ParamRampCodeImporter(param);\n// \t}\n// }\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\n\nimport {NodeCodeExporter} from './Node';\n// import {BaseNodeObjCodeExporter} from './node/Obj';\n// import {BaseNodeSopSubnetworkCodeExporter} from './node/Subnetwork';\n\nimport {ParamCodeExporter} from './Param';\nimport {ParamMultipleCodeExporter} from './param/Multiple';\nimport {ParamNumericCodeExporter} from './param/Numeric';\nimport {ParamOperatorPathCodeExporter} from './param/OperatorPath';\nimport {ParamStringCodeExporter} from './param/String';\nimport {ParamRampCodeExporter} from './param/Ramp';\nimport {TypedMultipleParam} from 'src/engine/params/_Multiple';\nimport {TypedNumericParam} from 'src/engine/params/_Numeric';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\nimport {StringParam} from 'src/engine/params/String';\nimport {RampParam} from 'src/engine/params/Ramp';\n\nexport class CodeExporterDispatcher {\n\tstatic dispatch_node(node: BaseNodeType) {\n\t\treturn new NodeCodeExporter(node);\n\t}\n\n\t// static node(node: BaseNode): NodeCodeExporter {\n\t// \treturn new NodeCodeExporter(node);\n\t// }\n\t// static node_obj(node: BaseNode) {\n\t// \treturn new BaseNodeObjCodeExporter(node);\n\t// }\n\t// static node_sop_subnetwork(node: BaseNode) {\n\t// \treturn new BaseNodeSopSubnetworkCodeExporter(node);\n\t// }\n\tstatic dispatch_param(param: BaseParamType): ParamCodeExporter<BaseParamType> {\n\t\tif (param instanceof TypedMultipleParam) {\n\t\t\treturn new ParamMultipleCodeExporter(param);\n\t\t}\n\t\tif (param instanceof TypedNumericParam) {\n\t\t\treturn new ParamNumericCodeExporter(param);\n\t\t}\n\t\tif (param instanceof OperatorPathParam) {\n\t\t\treturn new ParamOperatorPathCodeExporter(param);\n\t\t}\n\t\tif (param instanceof StringParam) {\n\t\t\treturn new ParamStringCodeExporter(param);\n\t\t}\n\t\tif (param instanceof RampParam) {\n\t\t\treturn new ParamRampCodeExporter(param);\n\t\t}\n\t\treturn new ParamCodeExporter(param);\n\t}\n}\n// \tstatic visit_param(param: BaseParamType) {\n// \t\treturn new ParamCodeExporter(param);\n// \t}\n// \tstatic param_multiple(param: BaseParam) {\n// \t\treturn new ParamMultipleCodeExporter(param);\n// \t}\n// \tstatic param_numeric(param: BaseParam) {\n// \t\treturn new ParamNumericCodeExporter(param);\n// \t}\n// \tstatic param_operator_path(param: BaseParam) {\n// \t\treturn new ParamOperatorPathCodeExporter(param);\n// \t}\n// \tstatic param_string(param: BaseParam) {\n// \t\treturn new ParamStringCodeExporter(param);\n// \t}\n// \tstatic param_ramp(param: BaseParam) {\n// \t\treturn new ParamRampCodeExporter(param);\n// \t}\n// }\n","import lodash_isNumber from 'lodash/isNumber';\n// import lodash_isBoolean from 'lodash/isBoolean'\n\nimport {TypedNumericParam} from './_Numeric';\nimport {ParamType} from '../poly/ParamType';\nimport {CoreString} from 'src/core/String';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\n\nexport class IntegerParam extends TypedNumericParam<ParamType.INTEGER> {\n\tstatic type() {\n\t\treturn ParamType.INTEGER;\n\t}\n\tget default_value_serialized() {\n\t\treturn this.default_value;\n\t}\n\tget raw_input_serialized() {\n\t\treturn this.raw_input;\n\t}\n\tget value_serialized() {\n\t\treturn this.value;\n\t}\n\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.INTEGER],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.INTEGER]\n\t) {\n\t\treturn raw_input1 == raw_input2;\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.INTEGER], val2: ParamValuesTypeMap[ParamType.INTEGER]) {\n\t\treturn val1 == val2;\n\t}\n\t// convert_value(v: ParamInputValue): number {\n\t// \tconst converted_val = lodash_isBoolean(v)\n\t// \t\t? v\n\t// \t\t\t? 1\n\t// \t\t\t: 0\n\t// \t\t: lodash_isNumber(v)\n\t// \t\t? Math.round(v)\n\t// \t\t: Math.round(parseFloat(v))\n\n\t// \treturn this._ensure_in_range(converted_val)\n\t// }\n\n\t// is_value_expression(v: number | string) {\n\t// \t//!lodash_isNumber(v)\n\t// \t// I was using parseInt before\n\t// \t// but that means that doing param.set(2.9) would set it to 2\n\t// \treturn `${v}` !== `${Math.round(parseFloat(v))}`\n\t// }\n\tstatic convert(raw_val: ParamInitValuesTypeMap[ParamType.INTEGER]): number | null {\n\t\tif (lodash_isNumber(raw_val)) {\n\t\t\treturn Math.round(raw_val);\n\t\t} else {\n\t\t\tif (CoreString.is_number(raw_val)) {\n\t\t\t\tconst parsed = parseInt(raw_val);\n\t\t\t\tif (lodash_isNumber(parsed)) {\n\t\t\t\t\treturn parsed;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n\tconvert(raw_val: ParamInitValuesTypeMap[ParamType.INTEGER]): number | null {\n\t\tconst result = IntegerParam.convert(raw_val);\n\t\tif (result) {\n\t\t\treturn this.options.ensure_in_range(result);\n\t\t} else {\n\t\t\treturn result;\n\t\t}\n\t}\n}\n","import {_Math} from 'three/src/math/Math';\n\nexport interface RampPointJson {\n\tposition: number;\n\tvalue: number;\n}\nexport interface RampValueJson {\n\tpoints: RampPointJson[];\n\tinterpolation: string;\n}\n\nexport class RampPoint {\n\tconstructor(private _position: number = 0, private _value: number = 0) {}\n\n\tto_json(): RampPointJson {\n\t\treturn {\n\t\t\tposition: this._position,\n\t\t\tvalue: this._value,\n\t\t};\n\t}\n\tget position() {\n\t\treturn this._position;\n\t}\n\tget value() {\n\t\treturn this._value;\n\t}\n\tcopy(point: RampPoint) {\n\t\tthis._position = point.position;\n\t\tthis._value = point.value;\n\t}\n\tclone() {\n\t\tconst point = new RampPoint();\n\t\tpoint.copy(this);\n\t\treturn point;\n\t}\n\tis_equal(other_point: RampPoint) {\n\t\treturn this._position == other_point.position && this._value == other_point.value;\n\t}\n\tis_equal_json(json: RampPointJson) {\n\t\treturn this._position == json.position && this._value == json.value;\n\t}\n\tfrom_json(json: RampPointJson) {\n\t\tthis._position = json.position;\n\t\tthis._value = json.value;\n\t}\n\tstatic are_equal_json(json1: RampPointJson, json2: RampPointJson) {\n\t\treturn json1.position == json2.position && json1.value == json2.value;\n\t}\n\tstatic from_json(json: RampPointJson) {\n\t\treturn new RampPoint(json.position, json.value);\n\t}\n}\n\nexport enum RampInterpolation {\n\tLINEAR = 'linear',\n}\nexport class RampValue {\n\tprivate _uuid: string;\n\n\tconstructor(private _interpolation: string = RampInterpolation.LINEAR, private _points: RampPoint[] = []) {\n\t\tthis._uuid = _Math.generateUUID();\n\t}\n\n\tget uuid() {\n\t\treturn this._uuid;\n\t}\n\tget interpolation() {\n\t\treturn this._interpolation;\n\t}\n\tget points() {\n\t\treturn this._points;\n\t}\n\tstatic from_json(json: RampValueJson): RampValue {\n\t\tconst points = [];\n\t\tfor (let json_point of json.points) {\n\t\t\tpoints.push(RampPoint.from_json(json_point));\n\t\t}\n\t\treturn new RampValue(json.interpolation, points);\n\t}\n\tto_json(): RampValueJson {\n\t\treturn {\n\t\t\tinterpolation: this._interpolation,\n\t\t\tpoints: this._points.map((p) => p.to_json()),\n\t\t};\n\t}\n\tclone(): RampValue {\n\t\tconst ramp = new RampValue();\n\t\tramp.copy(this);\n\t\treturn ramp;\n\t}\n\tcopy(ramp: RampValue) {\n\t\tthis._interpolation = ramp.interpolation;\n\t\tlet index = 0;\n\t\tfor (let point of ramp.points) {\n\t\t\tconst current_point = this._points[index];\n\t\t\tif (current_point) {\n\t\t\t\tcurrent_point.copy(point);\n\t\t\t} else {\n\t\t\t\tthis._points.push(point.clone());\n\t\t\t}\n\t\t\tindex += 1;\n\t\t}\n\t}\n\n\tis_equal(other_ramp_value: RampValue): boolean {\n\t\tif (this._interpolation != other_ramp_value.interpolation) {\n\t\t\treturn false;\n\t\t}\n\t\tconst other_points = other_ramp_value.points;\n\t\tif (this._points.length != other_points.length) {\n\t\t\treturn false;\n\t\t}\n\t\tlet index = 0;\n\t\tfor (let point of this._points) {\n\t\t\tconst other_point = other_points[index];\n\t\t\tif (!point.is_equal(other_point)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tindex += 1;\n\t\t}\n\n\t\treturn true;\n\t}\n\tis_equal_json(json: RampValueJson) {\n\t\tif (this._interpolation != json.interpolation) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this._points.length != json.points.length) {\n\t\t\treturn false;\n\t\t}\n\t\tlet index = 0;\n\t\tfor (let point of this._points) {\n\t\t\tconst other_point = json.points[index];\n\t\t\tif (!point.is_equal_json(other_point)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tindex += 1;\n\t\t}\n\t\treturn true;\n\t}\n\tstatic are_json_equal(json1: RampValueJson, json2: RampValueJson) {\n\t\tif (json1.interpolation != json2.interpolation) {\n\t\t\treturn false;\n\t\t}\n\t\tif (json1.points.length != json2.points.length) {\n\t\t\treturn false;\n\t\t}\n\t\tlet index = 0;\n\t\tfor (let point1 of json1.points) {\n\t\t\tconst point2 = json2.points[index];\n\t\t\tif (!RampPoint.are_equal_json(point1, point2)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tindex += 1;\n\t\t}\n\t\treturn true;\n\t}\n\tfrom_json(json: RampValueJson) {\n\t\tthis._interpolation = json.interpolation;\n\n\t\tlet index = 0;\n\t\tfor (let json_point of json.points) {\n\t\t\tconst current_point = this._points[index];\n\t\t\tif (current_point) {\n\t\t\t\tcurrent_point.from_json(json_point);\n\t\t\t} else {\n\t\t\t\tthis._points.push(RampPoint.from_json(json_point));\n\t\t\t}\n\t\t\tindex += 1;\n\t\t}\n\t}\n}\n","export enum SceneEvent {\n\tFRAME_RANGE_UPDATED = 'scene_frame_range_updated',\n\tFRAME_UPDATED = 'scene_frame_updated',\n\tPLAY_STATE_UPDATED = 'scene_play_state_updated',\n}\n","import {UniformsUtils} from 'three/src/renderers/shaders/UniformsUtils';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\n// import {ShaderChunk} from 'three/src/renderers/shaders/ShaderChunk';\n// import {Shader} from 'three/src/renderers/shaders/ShaderLib'\n// import {MeshStandardMaterial} from 'three/src/materials/MeshStandardMaterial';\n// import {MeshPhysicalMaterial} from 'three/src/materials/MeshPhysicalMaterial';\n// import {Material} from 'three/src/materials/Material';\nimport {Vector2} from 'three/src/math/Vector2';\n\n// import {Connection} from 'src/Engine/Node/Gl/GlData';\nimport {LineType} from '../utils/LineType';\n// import {Output} from 'src/Engine/Node/Gl/Output'\n\nimport {ShaderConfig} from '../configs/ShaderConfig';\nimport {VariableConfig} from '../configs/VariableConfig';\nimport {ThreeToGl} from 'src/core/ThreeToGl';\n// const BODY_SPLIT_LINE = 'void main() {'\n// export const BODY_SEPARATOR_LINES = lodash_range(3).map(i=>'\t')\nimport {CodeBuilder} from '../utils/CodeBuilder';\n// import {BaseNode} from 'src/Engine/Node/_Base';\nimport {BaseGlNodeType} from '../../_Base';\nimport {GlobalsGeometryHandler} from '../globals/Geometry';\nimport {TypedAssembler} from '../../../utils/shaders/BaseAssembler';\nimport {ShaderName} from '../../../utils/shaders/ShaderName';\n// import {IUniformsWithFrame, IUniformsWithResolution} from 'src/engine/scene/utils/UniformsController';\nimport {OutputGlNode} from '../../Output';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {TypedNamedConnectionPoint} from '../../../utils/connections/NamedConnectionPoint';\nimport {ConnectionPointType} from '../../../utils/connections/ConnectionPointType';\nimport {GlobalsGlNode} from '../../Globals';\nimport {IUniform} from 'three/src/renderers/shaders/UniformsLib';\nimport {AttributeGlNode} from '../../Attribute';\nimport {AssemblerControllerNode} from '../Controller';\nimport {GlobalsBaseController} from '../globals/_Base';\nimport {CustomMaterialName} from './_BaseRender';\nimport {ShadersCollectionController} from '../utils/ShadersCollectionController';\n\ntype StringArrayByShaderName = Map<ShaderName, string[]>;\n\nexport interface IUniforms {\n\t[uniform: string]: IUniform;\n}\ninterface ITemplateShader {\n\tvertexShader?: string;\n\tfragmentShader?: string;\n\tuniforms?: IUniforms;\n}\n\nconst INSERT_DEFINE_AFTER_MAP: Map<ShaderName, string> = new Map([\n\t[ShaderName.VERTEX, '#include <common>'],\n\t[ShaderName.FRAGMENT, '#include <common>'],\n]);\nconst INSERT_BODY_AFTER_MAP: Map<ShaderName, string> = new Map([\n\t[ShaderName.VERTEX, '#include <color_vertex>'],\n\t[ShaderName.FRAGMENT, 'vec4 diffuseColor = vec4( diffuse, opacity );'],\n]);\nconst LINES_TO_REMOVE_MAP: Map<ShaderName, string[]> = new Map([\n\t[ShaderName.VERTEX, ['#include <begin_vertex>', '#include <beginnormal_vertex>']],\n\t[ShaderName.FRAGMENT, []],\n]);\n\nconst SPACED_LINES = 3;\n\nexport class BaseGlShaderAssembler extends TypedAssembler<BaseGlNodeType> {\n\tprotected _shaders_by_name: Map<ShaderName, string> = new Map();\n\tprotected _lines: StringArrayByShaderName = new Map();\n\tprotected _code_builder: CodeBuilder | undefined;\n\tprivate _param_config_owner: CodeBuilder | undefined;\n\tprotected _root_nodes: BaseGlNodeType[] = [];\n\tprotected _leaf_nodes: BaseGlNodeType[] = [];\n\tprotected _material: ShaderMaterial | undefined;\n\n\tprivate _shader_configs: ShaderConfig[] | undefined;\n\tprivate _variable_configs: VariableConfig[] | undefined;\n\n\tprivate _frame_dependent: boolean = false;\n\tprivate _resolution_dependent: boolean = false;\n\n\tconstructor(protected _gl_parent_node: AssemblerControllerNode) {\n\t\tsuper();\n\t}\n\n\tasync compile() {}\n\n\t// private get material() {\n\t// \treturn (this._material = this._material || this._create_material());\n\t// }\n\t// async get_material(/*master_assembler?: BaseGlShaderAssembler*/) {\n\t// \tthis._material = this._material || this._create_material();\n\n\t// \tawait this._update_material(/*master_assembler*/);\n\t// \treturn this._material;\n\t// }\n\tprotected _template_shader_for_shader_name(shader_name: ShaderName): string | undefined {\n\t\tswitch (shader_name) {\n\t\t\tcase ShaderName.VERTEX:\n\t\t\t\treturn this._template_shader?.vertexShader;\n\t\t\tcase ShaderName.FRAGMENT:\n\t\t\t\treturn this._template_shader?.fragmentShader;\n\t\t}\n\t}\n\n\tget globals_handler(): GlobalsBaseController | undefined {\n\t\treturn this._gl_parent_node.assembler_controller.globals_handler;\n\t}\n\tcompile_allowed(): boolean {\n\t\treturn this._gl_parent_node.assembler_controller.globals_handler != null;\n\t}\n\tshaders_by_name() {\n\t\treturn this._shaders_by_name;\n\t}\n\n\tprotected _create_material(): ShaderMaterial | undefined {\n\t\treturn undefined;\n\t}\n\tprotected _build_lines() {\n\t\tfor (let shader_name of this.shader_names) {\n\t\t\tconst template = this._template_shader_for_shader_name(shader_name);\n\t\t\tif (template) {\n\t\t\t\tthis._replace_template(template, shader_name);\n\t\t\t}\n\t\t}\n\t}\n\n\t// protected _build_lines_for_shader_name(shader_name: ShaderName){\n\t// \tconst template = this._template_shader()\n\t// \tthis._replace_template(template[`${shader_name}Shader`], shader_name)\n\t// }\n\n\tset_root_nodes(root_nodes: BaseGlNodeType[]) {\n\t\tthis._root_nodes = root_nodes;\n\t}\n\tprotected get _template_shader(): ITemplateShader | undefined {\n\t\treturn undefined;\n\t} //Shader - could not find the import?\n\t// abstract _color_declaration(): string\n\t// private async _update_material(/*master_assembler?: BaseGlShaderAssembler*/) {\n\t// \tif (!this.material || !this._material) {\n\t// \t\treturn;\n\t// \t}\n\t// \tconst template_shader = this._template_shader;\n\t// \tif (!template_shader) {\n\t// \t\treturn;\n\t// \t}\n\t// \tthis._lines = new Map();\n\t// \tfor (let shader_name of this.shader_names) {\n\t// \t\tconst template = this._template_shader_for_shader_name(shader_name);\n\t// \t\tif (template) {\n\t// \t\t\tthis._lines.set(shader_name, template.split('\\n'));\n\t// \t\t}\n\t// \t}\n\t// \tif (this._root_nodes.length > 0) {\n\t// \t\t// this._output_node.set_color_declaration(this._color_declaration())\n\t// \t\t// if(!master_assembler){\n\t// \t\t// this._output_node.set_assembler(this)\n\t// \t\tawait this.build_code_from_nodes(this._root_nodes);\n\t// \t\t// }\n\n\t// \t\t(this._material as any).extensions = {derivatives: true};\n\t// \t\t// this._material?.derivatives = true;\n\t// \t\tthis._build_lines();\n\t// \t\t// this._lines[ShaderName.FRAGMENT].unshift('#extension GL_OES_standard_derivatives : enable')\n\t// \t}\n\n\t// \t// TODO: typescript - not sure that is still useful\n\t// \t// for (let param_config of this.param_configs()) {\n\t// \t// \tparam_config.material = this._material;\n\t// \t// }\n\n\t// \t// instead of replacing fully the uniforms,\n\t// \t// I simply add to them the new ones or replace the existing ones\n\t// \t// otherwise this would break the particles_system_gpu\n\t// \t// which would not reset correctly when going back to first frame.\n\t// \t// Not entirely sure why, but this seems to be due to the texture uniforms\n\t// \t// which are removed and then readded. This seems to mess up somewhere with how\n\t// \t// the material updates itself...\n\t// \t// this._material.uniforms = this.build_uniforms(template_shader)\n\t// \tconst new_uniforms = this.build_uniforms(template_shader.uniforms);\n\t// \tthis.material.uniforms = this.material.uniforms || {};\n\t// \tfor (let uniform_name of Object.keys(new_uniforms)) {\n\t// \t\tthis.material.uniforms[uniform_name] = new_uniforms[uniform_name];\n\t// \t}\n\n\t// \tfor (let shader_name of this.shader_names) {\n\t// \t\tconst lines = this._lines.get(shader_name);\n\t// \t\tif (lines) {\n\t// \t\t\tconst shader = lines.join('\\n');\n\t// \t\t\tswitch (shader_name) {\n\t// \t\t\t\tcase ShaderName.VERTEX: {\n\t// \t\t\t\t\tthis._material.vertexShader = shader;\n\t// \t\t\t\t\tbreak;\n\t// \t\t\t\t}\n\t// \t\t\t\tcase ShaderName.FRAGMENT: {\n\t// \t\t\t\t\tthis._material.fragmentShader = shader;\n\t// \t\t\t\t\tbreak;\n\t// \t\t\t\t}\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\n\t// \tconst scene = this._gl_parent_node.scene;\n\t// \t// const id = this._gl_parent_node.graph_node_id()\n\t// \tif (this.frame_dependent()) {\n\t// \t\t// make sure not to use this._gl_parent_node.graph_node_id() as the id,\n\t// \t\t// as we need several materials:\n\t// \t\t// - the visible one\n\t// \t\t// - the multiple shadow ones\n\t// \t\t// - and possibly a depth one\n\t// \t\tscene.uniforms_controller.add_frame_dependent_uniform_owner(\n\t// \t\t\tthis._material.uuid,\n\t// \t\t\tthis._material.uniforms as IUniformsWithFrame\n\t// \t\t);\n\t// \t} else {\n\t// \t\tscene.uniforms_controller.remove_frame_dependent_uniform_owner(this._material.uuid);\n\t// \t}\n\n\t// \tif (this.resolution_dependent()) {\n\t// \t\tscene.uniforms_controller.add_resolution_dependent_uniform_owner(\n\t// \t\t\tthis._material.uuid,\n\t// \t\t\tthis._material.uniforms as IUniformsWithResolution\n\t// \t\t);\n\t// \t} else {\n\t// \t\tscene.uniforms_controller.remove_resolution_dependent_uniform_owner(this._material.uuid);\n\t// \t}\n\t// }\n\n\tprotected build_uniforms(template_uniforms?: IUniforms) {\n\t\tconst new_uniforms = template_uniforms ? UniformsUtils.clone(template_uniforms) : {};\n\t\tfor (let param_config of this.param_configs()) {\n\t\t\tnew_uniforms[param_config.uniform_name] = param_config.uniform;\n\t\t}\n\n\t\tif (this.frame_dependent()) {\n\t\t\tnew_uniforms['frame'] = {\n\t\t\t\t// type: '1f',\n\t\t\t\tvalue: this._gl_parent_node.scene.frame,\n\t\t\t};\n\t\t}\n\t\tif (this.resolution_dependent()) {\n\t\t\tnew_uniforms['resolution'] = {\n\t\t\t\tvalue: new Vector2(1000, 1000),\n\t\t\t};\n\t\t}\n\n\t\treturn new_uniforms;\n\t}\n\n\t//\n\t//\n\t// ROOT NODES AND SHADER NAMES\n\t//\n\t//\n\troot_nodes_by_shader_name(shader_name: ShaderName): BaseGlNodeType[] {\n\t\t// return this._root_nodes\n\t\tconst list = [];\n\t\tfor (let node of this._root_nodes) {\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'output': {\n\t\t\t\t\tlist.push(node);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'attribute': {\n\t\t\t\t\t// TODO: typescript - gl - why is there a texture allocation controller in the base assembler?\n\t\t\t\t\t// const attrib_name = (node as AttributeGlNode).attribute_name;\n\t\t\t\t\t// const variable = this._texture_allocations_controller.variable(attrib_name);\n\t\t\t\t\t// if (variable) {\n\t\t\t\t\t// \tconst allocation_shader_name = variable.allocation().shader_name();\n\t\t\t\t\t// \tif (allocation_shader_name == shader_name) {\n\t\t\t\t\t// \t\tlist.push(node);\n\t\t\t\t\t// \t}\n\t\t\t\t\t// }\n\t\t\t\t\t// break;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\tleaf_nodes_by_shader_name(shader_name: ShaderName): BaseGlNodeType[] {\n\t\tconst list = [];\n\t\tfor (let node of this._leaf_nodes) {\n\t\t\tswitch (node.type) {\n\t\t\t\tcase GlobalsGlNode.type(): {\n\t\t\t\t\tlist.push(node);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase AttributeGlNode.type(): {\n\t\t\t\t\t// TODO: typescript - gl - why is there a texture allocation controller in the base assembler? AND especially since there is no way to assign it?\n\t\t\t\t\t// const attrib_name: string = (node as AttributeGlNode).attribute_name;\n\t\t\t\t\t// const variable = this._texture_allocations_controller.variable(attrib_name);\n\t\t\t\t\t// if (variable) {\n\t\t\t\t\t// \tconst allocation_shader_name = variable.allocation().shader_name();\n\t\t\t\t\t// \tif (allocation_shader_name == shader_name) {\n\t\t\t\t\t// \t\tlist.push(node);\n\t\t\t\t\t// \t}\n\t\t\t\t\t// }\n\t\t\t\t\t// break;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\tset_node_lines_globals(globals_node: GlobalsGlNode, shaders_collection_controller: ShadersCollectionController) {}\n\tset_node_lines_output(output_node: OutputGlNode, shaders_collection_controller: ShadersCollectionController) {}\n\tset_node_lines_attribute(\n\t\tattribute_node: AttributeGlNode,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {}\n\n\t//\n\t//\n\t// CHILDREN NODES PARAMS\n\t//\n\t//\n\tget code_builder() {\n\t\treturn (this._code_builder = this._code_builder || new CodeBuilder(this, this._gl_parent_node));\n\t}\n\tasync build_code_from_nodes(root_nodes: BaseGlNodeType[]) {\n\t\tawait this.code_builder.build_from_nodes(root_nodes);\n\t}\n\tallow_new_param_configs() {\n\t\tthis.code_builder.allow_new_param_configs();\n\t}\n\tdisallow_new_param_configs() {\n\t\tthis.code_builder.disallow_new_param_configs();\n\t}\n\tbuilder_param_configs() {\n\t\treturn this.code_builder.param_configs();\n\t}\n\tbuilder_lines(shader_name: ShaderName, line_type: LineType) {\n\t\treturn this.code_builder.lines(shader_name, line_type);\n\t}\n\tall_builder_lines() {\n\t\treturn this.code_builder.all_lines();\n\t}\n\tparam_configs() {\n\t\tconst code_builder = this._param_config_owner || this.code_builder;\n\t\treturn code_builder.param_configs();\n\t}\n\tset_param_configs_owner(param_config_owner: CodeBuilder) {\n\t\tthis._param_config_owner = param_config_owner;\n\t\tif (this._param_config_owner) {\n\t\t\tthis.code_builder.disallow_new_param_configs();\n\t\t} else {\n\t\t\tthis.code_builder.allow_new_param_configs();\n\t\t}\n\t}\n\n\t//\n\t//\n\t// CHILDREN NODES PARAMS\n\t//\n\t//\n\tstatic add_output_params(output_child: OutputGlNode) {\n\t\toutput_child.params.add_param(ParamType.VECTOR3, 'position', [0, 0, 0], {hidden: true});\n\t\toutput_child.params.add_param(ParamType.VECTOR3, 'normal', [0, 0, 0], {hidden: true});\n\t\toutput_child.params.add_param(ParamType.COLOR, 'color', [1, 1, 1], {hidden: true});\n\t\toutput_child.params.add_param(ParamType.FLOAT, 'alpha', 1, {hidden: true});\n\t\toutput_child.params.add_param(ParamType.VECTOR2, 'uv', [0, 0], {hidden: true});\n\t}\n\tadd_output_params(output_child: OutputGlNode) {\n\t\tBaseGlShaderAssembler.add_output_params(output_child);\n\t}\n\tstatic create_globals_node_output_connections() {\n\t\treturn [\n\t\t\tnew TypedNamedConnectionPoint('position', ConnectionPointType.VEC3),\n\t\t\tnew TypedNamedConnectionPoint('normal', ConnectionPointType.VEC3),\n\t\t\tnew TypedNamedConnectionPoint('color', ConnectionPointType.VEC3),\n\t\t\tnew TypedNamedConnectionPoint('uv', ConnectionPointType.VEC2),\n\t\t\tnew TypedNamedConnectionPoint('gl_FragCoord', ConnectionPointType.VEC4),\n\t\t\tnew TypedNamedConnectionPoint('resolution', ConnectionPointType.VEC2),\n\t\t\t// new Connection.Vec2('gl_PointCoord'),\n\t\t\t// new TypedConnectionVec2('uv'),\n\t\t\tnew TypedNamedConnectionPoint('frame', ConnectionPointType.FLOAT),\n\t\t];\n\t}\n\tcreate_globals_node_output_connections() {\n\t\treturn BaseGlShaderAssembler.create_globals_node_output_connections();\n\t}\n\tadd_globals_params(globals_node: GlobalsGlNode) {\n\t\tglobals_node.io.outputs.set_named_output_connection_points(this.create_globals_node_output_connections());\n\t}\n\tallow_attribute_exports() {\n\t\treturn false;\n\t}\n\n\t//\n\t//\n\t// CONFIGS\n\t//\n\t//\n\treset_configs() {\n\t\tthis._reset_shader_configs();\n\t\tthis._reset_variable_configs();\n\t\tthis._reset_frame_dependency();\n\t\tthis._reset_resolution_dependency();\n\t}\n\tget shader_configs() {\n\t\treturn (this._shader_configs = this._shader_configs || this.create_shader_configs());\n\t}\n\tset_shader_configs(shader_configs: ShaderConfig[]) {\n\t\tthis._shader_configs = shader_configs;\n\t}\n\tget shader_names(): ShaderName[] {\n\t\treturn this.shader_configs?.map((sc) => sc.name()) || [];\n\t}\n\tprotected _reset_shader_configs() {\n\t\tthis._shader_configs = undefined;\n\t\t// this.shader_configs; // TODO: typescript - why do I need to re-initialize here?\n\t}\n\tcreate_shader_configs(): ShaderConfig[] {\n\t\treturn [\n\t\t\tnew ShaderConfig(ShaderName.VERTEX, ['position', 'normal', 'uv'], []),\n\t\t\tnew ShaderConfig(ShaderName.FRAGMENT, ['color', 'alpha'], [ShaderName.VERTEX]),\n\t\t];\n\t}\n\tshader_config(name: string): ShaderConfig | undefined {\n\t\treturn this.shader_configs?.filter((sc) => {\n\t\t\treturn sc.name() == name;\n\t\t})[0];\n\t}\n\tvariable_configs() {\n\t\treturn (this._variable_configs = this._variable_configs || this.create_variable_configs());\n\t}\n\tset_variable_configs(variable_configs: VariableConfig[]) {\n\t\tthis._variable_configs = variable_configs;\n\t}\n\tvariable_config(name: string) {\n\t\treturn this.variable_configs().filter((vc) => {\n\t\t\treturn vc.name() == name;\n\t\t})[0];\n\t}\n\tstatic create_variable_configs() {\n\t\treturn [\n\t\t\tnew VariableConfig('position', {\n\t\t\t\tdefault_from_attribute: true,\n\t\t\t\t// default: this.globals_handler().variable_config_default('position'),\n\t\t\t\t// required_definitions: this.globals_handler().variable_config_required_definitions('position'),\n\t\t\t\tprefix: 'vec3 transformed = ',\n\t\t\t}),\n\t\t\tnew VariableConfig('normal', {\n\t\t\t\tdefault_from_attribute: true,\n\t\t\t\tprefix: 'vec3 objectNormal = ',\n\t\t\t\t// post_lines: ['#ifdef USE_TANGENT', 'vec3 objectTangent = vec3( tangent.xyz );', '#endif'],\n\t\t\t}),\n\t\t\tnew VariableConfig('color', {\n\t\t\t\tprefix: 'diffuseColor.xyz = ',\n\t\t\t}),\n\t\t\tnew VariableConfig('alpha', {\n\t\t\t\tprefix: 'diffuseColor.a = ',\n\t\t\t}),\n\t\t\tnew VariableConfig('uv', {\n\t\t\t\t// default_from_attribute: true,\n\t\t\t\tprefix: 'vUv = ',\n\t\t\t\tif: GlobalsGeometryHandler.IF_RULE.uv,\n\t\t\t}),\n\t\t];\n\t}\n\tcreate_variable_configs(): VariableConfig[] {\n\t\treturn BaseGlShaderAssembler.create_variable_configs();\n\t}\n\tprotected _reset_variable_configs() {\n\t\tthis._variable_configs = undefined;\n\t\tthis.variable_configs();\n\t}\n\tinput_names_for_shader_name(root_node: BaseGlNodeType, shader_name: ShaderName) {\n\t\treturn this.shader_config(shader_name)?.input_names() || [];\n\t}\n\n\t// frame dependency\n\tprotected _reset_frame_dependency() {\n\t\tthis._frame_dependent = false;\n\t}\n\tset_frame_dependent() {\n\t\tthis._frame_dependent = true;\n\t}\n\tframe_dependent(): boolean {\n\t\treturn this._frame_dependent;\n\t}\n\t// resolution dependency\n\tprotected _reset_resolution_dependency() {\n\t\tthis._resolution_dependent = false;\n\t}\n\tset_resolution_dependent() {\n\t\tthis._resolution_dependent = true;\n\t}\n\tresolution_dependent(): boolean {\n\t\treturn this._resolution_dependent;\n\t}\n\n\t//\n\t//\n\t// TEMPLATE HOOKS\n\t//\n\t//\n\tprotected insert_define_after(shader_name: ShaderName): string | undefined {\n\t\treturn INSERT_DEFINE_AFTER_MAP.get(shader_name);\n\t}\n\tprotected insert_body_after(shader_name: ShaderName): string | undefined {\n\t\treturn INSERT_BODY_AFTER_MAP.get(shader_name);\n\t}\n\tprotected lines_to_remove(shader_name: ShaderName): string[] | undefined {\n\t\treturn LINES_TO_REMOVE_MAP.get(shader_name);\n\t}\n\n\t//\n\t//\n\t// TEMPLATE CODE REPLACEMENT\n\t//\n\t//\n\n\tprivate _replace_template(template: string, shader_name: ShaderName) {\n\t\tconst function_declaration = this.builder_lines(shader_name, LineType.FUNCTION_DECLARATION);\n\t\tconst define = this.builder_lines(shader_name, LineType.DEFINE);\n\t\t// let all_define = function_declaration.concat(define);\n\t\tconst body = this.builder_lines(shader_name, LineType.BODY);\n\n\t\tlet template_lines = template.split('\\n');\n\t\tconst scene = this._gl_parent_node.scene;\n\t\tconst new_lines = [\n\t\t\t`#define FPS ${ThreeToGl.float(scene.time_controller.fps)}`,\n\t\t\t`#define TIME_INCREMENT (1.0/${ThreeToGl.float(scene.time_controller.fps)})`,\n\t\t\t`#define FRAME_RANGE_START ${ThreeToGl.float(scene.time_controller.frame_range[0])}`,\n\t\t\t`#define FRAME_RANGE_END ${ThreeToGl.float(scene.time_controller.frame_range[1])}`,\n\t\t];\n\n\t\tconst line_before_define = this.insert_define_after(shader_name);\n\t\tconst line_before_body = this.insert_body_after(shader_name);\n\t\tconst lines_to_remove = this.lines_to_remove(shader_name);\n\t\tlet line_before_define_found = false;\n\t\tlet line_before_body_found = false;\n\n\t\tfor (let template_line of template_lines) {\n\t\t\tif (line_before_define_found == true) {\n\t\t\t\tif (function_declaration) {\n\t\t\t\t\tthis._insert_lines(new_lines, function_declaration);\n\t\t\t\t}\n\t\t\t\tif (define) {\n\t\t\t\t\tthis._insert_lines(new_lines, define);\n\t\t\t\t}\n\t\t\t\tline_before_define_found = false;\n\t\t\t}\n\t\t\tif (line_before_body_found == true) {\n\t\t\t\t// this._insert_default_body_declarations(new_lines, shader_name)\n\t\t\t\tif (body) {\n\t\t\t\t\tthis._insert_lines(new_lines, body);\n\t\t\t\t}\n\t\t\t\tline_before_body_found = false;\n\t\t\t}\n\n\t\t\tlet line_remove_required = false;\n\t\t\tif (lines_to_remove) {\n\t\t\t\tfor (let line_to_remove of lines_to_remove) {\n\t\t\t\t\tif (template_line.indexOf(line_to_remove) >= 0) {\n\t\t\t\t\t\tline_remove_required = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!line_remove_required) {\n\t\t\t\tnew_lines.push(template_line);\n\t\t\t} else {\n\t\t\t\tnew_lines.push('// removed:');\n\t\t\t\tnew_lines.push(`//${template_line}`);\n\t\t\t}\n\n\t\t\tif (line_before_define && template_line.indexOf(line_before_define) >= 0) {\n\t\t\t\tline_before_define_found = true;\n\t\t\t}\n\t\t\tif (line_before_body && template_line.indexOf(line_before_body) >= 0) {\n\t\t\t\tline_before_body_found = true;\n\t\t\t}\n\n\t\t\t// if(template_line.indexOf('// INSERT DEFINE') >= 0){\n\t\t\t// } else {\n\t\t\t// \tif(template_line.indexOf('// INSERT BODY') >= 0){\n\t\t\t// \t\tif(body.length > 0){\n\t\t\t// \t\t\tlodash_times(3, ()=>new_lines.push('\t'))\n\t\t\t// \t\t\tbody.forEach(body_line=>{\n\t\t\t// \t\t\t\tnew_lines.push(body_line)\n\t\t\t// \t\t\t})\n\t\t\t// \t\t\tlodash_times(3, ()=>new_lines.push('\t'))\n\t\t\t// \t\t}\n\t\t\t// \t} else {\n\t\t\t// \t\tif(template_line.indexOf('// TO REMOVE') < 0){\n\t\t\t// \t\t\tnew_lines.push(template_line)\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// }\n\t\t}\n\t\tthis._lines.set(shader_name, new_lines);\n\t}\n\n\t// protected _insert_default_body_declarations(new_lines, shader_name){\n\t// \tnew_lines.push('float POLY_roughness = 1.0;')\n\t// }\n\n\tprivate _insert_lines(new_lines: string[], lines_to_add: string[]) {\n\t\tif (lines_to_add.length > 0) {\n\t\t\tfor (let i = 0; i < SPACED_LINES; i++) {\n\t\t\t\tnew_lines.push('');\n\t\t\t}\n\n\t\t\tfor (let line_to_add of lines_to_add) {\n\t\t\t\tnew_lines.push(line_to_add);\n\t\t\t\t// console.log('push', line_to_add);\n\t\t\t}\n\t\t\tfor (let i = 0; i < SPACED_LINES; i++) {\n\t\t\t\tnew_lines.push('');\n\t\t\t}\n\t\t}\n\t}\n\n\tasync get_custom_materials(): Promise<Map<CustomMaterialName, ShaderMaterial>> {\n\t\treturn new Map<CustomMaterialName, ShaderMaterial>();\n\t}\n\n\t// protected expand_shader(shader_string: string) {\n\t// \tfunction parseIncludes(string: string) {\n\t// \t\tvar pattern = /^[ \\t]*#include +<([\\w\\d./]+)>/gm;\n\t// \t\tfunction replace(match: string, include: string) {\n\t// \t\t\tvar replace = ShaderChunk[include];\n\n\t// \t\t\tif (replace === undefined) {\n\t// \t\t\t\tthrow new Error('Can not resolve #include <' + include + '>');\n\t// \t\t\t}\n\n\t// \t\t\treturn parseIncludes(replace);\n\t// \t\t}\n\n\t// \t\treturn string.replace(pattern, replace);\n\t// \t}\n\t// \treturn parseIncludes(shader_string);\n\t// }\n\n\t//\n\t//\n\t// GLTF EXPORT\n\t//\n\t//\n\t// static convert_material_to_gltf_supported(material: ShaderMaterial): Material{\n\t// \tconst gltf_constructor = this.is_physical() ? MeshPhysicalMaterial : MeshStandardMaterial\n\t// \tconst options = {}\n\t// \tthis._match_uniform('color', options, material, 'diffuse')\n\t// \tthis._match_uniform('map', options, material)\n\t// \tthis._match_uniform('envMap', options, material)\n\t// \tthis._match_uniform('envMapIntensity', options, material)\n\t// \tthis._match_uniform('metalness', options, material)\n\t// \tthis._match_uniform('roughness', options, material)\n\t// \tconst gltf_material = new gltf_constructor(options)\n\t// \treturn gltf_material\n\t// }\n\t// static _match_uniform(name: string, options: object, material: ShaderMaterial, uniform_name?: string) {\n\t// \tuniform_name = uniform_name || name;\n\t// \toptions[name] = material.uniforms[uniform_name].value;\n\t// }\n}\n","import lodash_compact from 'lodash/compact';\nimport lodash_uniq from 'lodash/uniq';\n// import {BaseGlNodeType} from '../../gl/_Base';\n// import {OutputGlNode} from '../gl/Output';\nimport {CoreGraph} from 'src/core/graph/CoreGraph';\nimport {BaseNodeType, TypedNode} from '../../_Base';\nimport {TypedAssembler} from './BaseAssembler';\nimport {MapUtils} from 'src/core/MapUtils';\nimport {ShaderName} from './ShaderName';\n\ntype NumberByString = Map<string, number>;\ntype BooleanByString = Map<string, boolean>;\ntype BooleanByStringByShaderName = Map<ShaderName, BooleanByString>;\ntype StringArrayByString = Map<string, string[]>;\n\n// interface BaseNodeGlArrayByString {\n// \t[propName: string]: BaseNodeGl[]\n// }\n// interface StringArrayByString {\n// \t[propName: string]: string[]\n// }\n\n// import {LineType, LINE_TYPES} from './CodeBuilder'\n\n// const VERTEX_INPUT_NAMES = [\n// \t'position',\n// \t'normal',\n// \t'gl_PointSize'\n// ]\n// const FRAGMENT_INPUT_NAMES = [\n// \t'color',\n// \t'alpha'\n// ]\n\nexport class TypedNodeTraverser<T extends TypedNode<any, T, any>> {\n\tprivate _leaves_graph_id: BooleanByStringByShaderName = new Map();\n\tprivate _graph_ids_by_shader_name: BooleanByStringByShaderName = new Map();\n\tprivate _outputs_by_graph_id: StringArrayByString = new Map();\n\tprivate _depth_by_graph_id: NumberByString = new Map();\n\tprivate _graph_id_by_depth: Map<number, string[]> = new Map();\n\tprivate _graph: CoreGraph;\n\tprivate _shader_name!: ShaderName;\n\n\tconstructor(private _assembler: TypedAssembler<T>, private _gl_parent_node: BaseNodeType) {\n\t\tthis._graph = this._gl_parent_node.scene.graph;\n\t}\n\n\tprivate reset() {\n\t\tthis._leaves_graph_id.clear();\n\t\tthis._outputs_by_graph_id.clear();\n\t\tthis._depth_by_graph_id.clear();\n\t\tthis._graph_id_by_depth.clear();\n\n\t\tthis.shader_names().forEach((shader_name) => {\n\t\t\tthis._graph_ids_by_shader_name.set(shader_name, new Map());\n\t\t});\n\t}\n\n\tshader_names() {\n\t\treturn this._assembler.shader_names;\n\t}\n\tinput_names_for_shader_name(root_node: T, shader_name: ShaderName) {\n\t\treturn this._assembler.input_names_for_shader_name(root_node, shader_name);\n\t}\n\n\ttraverse(root_nodes: T[]) {\n\t\tthis.reset();\n\n\t\tfor (let shader_name of this.shader_names()) {\n\t\t\tthis._leaves_graph_id.set(shader_name, new Map());\n\t\t}\n\n\t\tfor (let shader_name of this.shader_names()) {\n\t\t\tthis._shader_name = shader_name;\n\t\t\tfor (let root_node of root_nodes) {\n\t\t\t\tthis.find_leaves_from_root_node(root_node);\n\t\t\t\tthis.set_nodes_depth();\n\t\t\t}\n\t\t}\n\n\t\t// graph_ids.forEach((graph_id) => {\n\t\tthis._depth_by_graph_id.forEach((depth: number, graph_id: string) => {\n\t\t\tif (depth != null) {\n\t\t\t\t// this._graph_id_by_depth.set(depth, this._graph_id_by_depth.get(depth) || []);\n\t\t\t\t// this._graph_id_by_depth.get(depth)?.push(graph_id);\n\t\t\t\tMapUtils.push_on_array_at_entry(this._graph_id_by_depth, depth, graph_id);\n\t\t\t}\n\t\t});\n\t}\n\n\tleaves_from_nodes(nodes: T[]) {\n\t\tthis._shader_name = ShaderName.LEAVES_FROM_NODES_SHADER;\n\t\tthis._graph_ids_by_shader_name.set(this._shader_name, new Map());\n\t\tthis._leaves_graph_id.set(this._shader_name, new Map());\n\t\tfor (let node of nodes) {\n\t\t\tthis.find_leaves(node);\n\t\t}\n\n\t\tconst node_ids: string[] = [];\n\t\tthis._leaves_graph_id.get(this._shader_name)?.forEach((value: boolean, key: string) => {\n\t\t\tnode_ids.push(key);\n\t\t});\n\t\treturn this._graph.nodes_from_ids(node_ids) as T[];\n\t}\n\n\tnodes_for_shader_name(shader_name: ShaderName) {\n\t\tconst depths: number[] = [];\n\t\tthis._graph_id_by_depth.forEach((value: string[], key: number) => {\n\t\t\tdepths.push(key);\n\t\t});\n\t\tdepths.sort((a, b) => a - b);\n\t\tconst nodes: T[] = [];\n\t\tdepths.forEach((depth) => {\n\t\t\tconst graph_ids_for_depth = this._graph_id_by_depth.get(depth);\n\t\t\tif (graph_ids_for_depth) {\n\t\t\t\tgraph_ids_for_depth.forEach((graph_id: string) => {\n\t\t\t\t\tconst is_present = this._graph_ids_by_shader_name.get(shader_name)?.get(graph_id);\n\t\t\t\t\tif (is_present) {\n\t\t\t\t\t\tconst node = this._graph.node_from_id(graph_id) as T;\n\t\t\t\t\t\tnodes.push(node);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn nodes;\n\t}\n\tsorted_nodes() {\n\t\tconst depths: number[] = [];\n\t\tthis._graph_id_by_depth.forEach((ids: string[], depth: number) => {\n\t\t\tdepths.push(depth);\n\t\t});\n\t\tdepths.sort((a, b) => a - b);\n\t\tconst nodes: T[] = [];\n\t\tdepths.forEach((depth) => {\n\t\t\tconst graph_ids_for_depth = this._graph_id_by_depth.get(depth);\n\t\t\tif (graph_ids_for_depth) {\n\t\t\t\tfor (let graph_id of graph_ids_for_depth) {\n\t\t\t\t\tconst node = this._graph.node_from_id(graph_id) as T;\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tnodes.push(node);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn nodes;\n\t}\n\tprivate find_leaves_from_root_node(root_node: T) {\n\t\t// if(this._shader_name == ShaderName.VERTEX){\n\t\t// this._leaves_graph_id[this._shader_name] = {}\n\t\tthis._graph_ids_by_shader_name.get(this._shader_name)?.set(root_node.graph_node_id, true);\n\n\t\tconst input_names = this.input_names_for_shader_name(root_node, this._shader_name);\n\t\tif (input_names) {\n\t\t\tfor (let input_name of input_names) {\n\t\t\t\t// if (root_node.type == 'output') {\n\t\t\t\tconst input = root_node.io.inputs.named_input(input_name);\n\t\t\t\tif (input) {\n\t\t\t\t\tMapUtils.push_on_array_at_entry(\n\t\t\t\t\t\tthis._outputs_by_graph_id,\n\t\t\t\t\t\tinput.graph_node_id,\n\t\t\t\t\t\troot_node.graph_node_id\n\t\t\t\t\t);\n\t\t\t\t\tthis.find_leaves(input);\n\t\t\t\t}\n\t\t\t\t// TODO: typescript - GL - check that I dont need to consider the Attrib as a special case\n\t\t\t\t// } else {\n\t\t\t\t// \t// if attribute\n\t\t\t\t// \tconst input = root_node.io.inputs.connected_named_input();\n\t\t\t\t// \tif (input) {\n\t\t\t\t// \t\tthis.find_leaves(input);\n\t\t\t\t// \t}\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\t\t// const position_input = this._output.named_input('position')\n\t\t// const normal_input = this._output.named_input('normal')\n\t\t// const instancePosition_input = this._output.named_input('instancePosition')\n\t\t// if(position_input){ this.find_leaves(position_input) }\n\t\t// if(normal_input){ this.find_leaves(normal_input) }\n\t\t// if(instancePosition_input){ this.find_leaves(instancePosition_input) }\n\t\t// }\n\t\t// if(this._shader_name == ShaderName.FRAGMENT){\n\t\t// \tthis._leaves_graph_id[this._shader_name] = {}\n\t\t// \tFRAGMENT_INPUT_NAMES.forEach(name=>{\n\t\t// \t\tconst input = this._output.named_input(name)\n\t\t// \t\tif(input){\n\t\t// \t\t\tthis.find_leaves(input)\n\t\t// \t\t}\n\t\t// \t})\n\t\t// \t// const color_input = this._output.named_input('color')\n\t\t// \t// const alpha_input = this._output.named_input('alpha')\n\t\t// \t// if(color_input){ this.find_leaves(color_input) }\n\t\t// \t// if(alpha_input){ this.find_leaves(alpha_input) }\n\t\t// }\n\n\t\tthis._outputs_by_graph_id.forEach((outputs: string[], graph_id: string) => {\n\t\t\tthis._outputs_by_graph_id.set(graph_id, lodash_uniq(outputs));\n\t\t});\n\t}\n\n\tprivate find_leaves(node: T) {\n\t\tthis._graph_ids_by_shader_name.get(this._shader_name)?.set(node.graph_node_id, true);\n\n\t\tconst inputs = lodash_compact(node.io.inputs.inputs());\n\t\tconst input_graph_ids = lodash_uniq(inputs.map((n) => n.graph_node_id));\n\t\tconst unique_inputs = input_graph_ids.map((graph_id) => this._graph.node_from_id(graph_id)) as T[];\n\t\tif (unique_inputs.length > 0) {\n\t\t\t// const promises = unique_inputs.forEach((input)=>{\n\t\t\tfor (let input of unique_inputs) {\n\t\t\t\tMapUtils.push_on_array_at_entry(this._outputs_by_graph_id, input.graph_node_id, node.graph_node_id);\n\n\t\t\t\tthis.find_leaves(input);\n\t\t\t}\n\t\t} else {\n\t\t\tthis._leaves_graph_id.get(this._shader_name)!.set(node.graph_node_id, true);\n\t\t}\n\t}\n\n\tprivate set_nodes_depth() {\n\t\tthis._leaves_graph_id.forEach((booleans_by_graph_id, shader_name) => {\n\t\t\tbooleans_by_graph_id.forEach((boolean, graph_id) => {\n\t\t\t\tthis.set_node_depth(graph_id);\n\t\t\t});\n\t\t});\n\t\t// const leave_ids = Object.keys(this._leaves_graph_id[this._shader_name]);\n\t\t// leave_ids.forEach((graph_id) => {\n\t\t// \tthis.set_node_depth(graph_id);\n\t\t// });\n\t}\n\n\tprivate set_node_depth(graph_id: string, depth: number = 0) {\n\t\tconst current_depth = this._depth_by_graph_id.get(graph_id);\n\t\tif (current_depth != null) {\n\t\t\tthis._depth_by_graph_id.set(graph_id, Math.max(current_depth, depth));\n\t\t} else {\n\t\t\tthis._depth_by_graph_id.set(graph_id, depth);\n\t\t}\n\n\t\t// const node = this._graph.node_from_id(graph_id);\n\n\t\tconst output_ids = this._outputs_by_graph_id.get(graph_id);\n\t\tif (output_ids) {\n\t\t\toutput_ids.forEach((output_id) => {\n\t\t\t\tthis.set_node_depth(output_id, depth + 1);\n\t\t\t});\n\t\t}\n\t}\n}\n","import {GlobalsGlNode} from '../../Globals';\nimport {ConnectionPointType} from 'src/engine/nodes/utils/connections/ConnectionPointType';\nimport {BaseGlNodeType} from '../../_Base';\nimport {ShadersCollectionController} from '../utils/ShadersCollectionController';\n\nexport abstract class GlobalsBaseController {\n\tprivate static __next_id: number = 0;\n\tprivate _id: number;\n\n\tconstructor() {\n\t\tthis._id = GlobalsBaseController.__next_id++;\n\t}\n\tid() {\n\t\treturn this._id;\n\t}\n\n\thandle_globals_node(\n\t\tglobals_node: GlobalsGlNode,\n\t\toutput_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t\t// definitions_by_shader_name: Map<ShaderName, BaseGLDefinition[]>,\n\t\t// body_lines_by_shader_name: Map<ShaderName, string[]>,\n\t\t// body_lines: string[],\n\t\t// dependencies: ShaderName[],\n\t\t// shader_name: ShaderName\n\t): void {}\n\n\tabstract read_attribute(\n\t\tnode: BaseGlNodeType,\n\t\tgl_type: ConnectionPointType,\n\t\tattrib_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t): string | undefined;\n}\n","import {AssemblerControllerNode} from '../Controller';\n\nexport class GlNodeFinder {\n\tstatic find_output_nodes(node: AssemblerControllerNode) {\n\t\tconst nodes = node.nodes_by_type('output');\n\t\treturn nodes;\n\t\t// if (nodes.length > 1) {\n\t\t// \tnode.states.error.set('only one output node allowed');\n\t\t// }\n\t\t// return nodes[0];\n\t}\n\tstatic find_attribute_export_nodes(node: AssemblerControllerNode) {\n\t\tconst nodes = node.nodes_by_type('attribute');\n\t\treturn nodes.filter((node) => {\n\t\t\t// do not use attributes that are used as an input, as export\n\t\t\t// return (node.used_output_names().length == 0) &&\n\t\t\treturn node.is_exporting;\n\t\t});\n\t}\n}\n","import lodash_merge from 'lodash/merge';\nimport lodash_intersection from 'lodash/intersection';\nimport lodash_difference from 'lodash/difference';\n// import {VertexColors} from 'three/src/constants';\nimport {Vector2} from 'three/src/math/Vector2';\n// import {UniformsUtils} from 'three/src/renderers/shaders/UniformsUtils';\n// import {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\n// import {ShaderLib} from 'three/src/renderers/shaders/ShaderLib';\n// import {FrontSide} from 'three/src/constants';\n// const THREE = {FrontSide, ShaderLib, ShaderMaterial, UniformsUtils, Vector2, VertexColors};\nimport {BaseNodeType, TypedNode} from 'src/engine/nodes/_Base';\n// import {ParamType} from 'src/Engine/Param/_Module'\n\nimport {BaseGlShaderAssembler} from './assemblers/_Base';\nimport {GlobalsBaseController} from './globals/_Base';\n\n// import {JsonImportDispatcher} from 'src/engine/io/json/import/Dispatcher';\nimport {JsonExportDispatcher} from 'src/engine/io/json/export/Dispatcher';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\nimport {ShaderName} from '../../utils/shaders/ShaderName';\nimport {OutputGlNode} from '../Output';\nimport {GlobalsGlNode} from '../Globals';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {ParamJsonExporterData} from 'src/engine/io/json/export/Param';\nimport {GlNodeChildrenMap} from 'src/engine/poly/registers/Gl';\nimport {BaseGlNodeType} from '../_Base';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\n// interface BaseShaderAssemblerConstructor {\n// \tnew (): BaseGlShaderAssembler;\n// }\n// interface GlobalsBaseControllerConstructor {\n// \tnew (): GlobalsBaseController;\n// }\n\n// export function AssemblerOwner<TBase extends Constructor>(Base: TBase) {\n// \treturn class Mixin extends Base {\n// \t\tprotected self: BaseNode = (<unknown>this) as BaseNode;\n// \t\tchildren_context() {\n// \t\t\treturn NodeContext.GL;\n// \t\t}\n\nexport class AssemblerControllerNode extends TypedNode<any, BaseNodeType, any> {\n\tcreate_node<K extends keyof GlNodeChildrenMap>(type: K): GlNodeChildrenMap[K] {\n\t\treturn super.create_node(type) as GlNodeChildrenMap[K];\n\t}\n\tchildren() {\n\t\treturn super.children() as BaseGlNodeType[];\n\t}\n\tnodes_by_type<K extends keyof GlNodeChildrenMap>(type: K): GlNodeChildrenMap[K][] {\n\t\treturn super.nodes_by_type(type) as GlNodeChildrenMap[K][];\n\t}\n\n\tassembler_controller!: GlAssemblerController<BaseGlShaderAssembler>;\n\t// set_compilation_required_and_dirty() {\n\t// \tthis.assembler_controller.set_compilation_required_and_dirty();\n\t// }\n}\n\ntype BaseGlShaderAssemblerConstructor<A extends BaseGlShaderAssembler> = new (...args: any[]) => A;\nexport class GlAssemblerController<A extends BaseGlShaderAssembler> {\n\tprotected _assembler!: A;\n\tprivate _globals_handler: GlobalsBaseController | undefined; // = new GlobalsGeometryHandler(this);\n\tprivate _compile_required: boolean = true;\n\t// private _requester: BaseNodeSop;\n\t// private _recompiled: boolean = false;\n\tprivate _shaders_by_name: Map<ShaderName, string> = new Map();\n\n\tprivate _deleted_params_data: Map<string, ParamJsonExporterData<ParamType>> = new Map();\n\tprivate _new_params: BaseParamType[] = [];\n\n\tconstructor(private node: AssemblerControllerNode, assembler_class: BaseGlShaderAssemblerConstructor<A>) {\n\t\tthis.node.lifecycle.add_create_hook(this.on_create);\n\n\t\t// if (assembler_class) {\n\t\tthis._assembler = new assembler_class(this.node);\n\t\t// }\n\t\t// this._shadow_depth_assembler = new ShaderAssemblerDepth()\n\t\t// this._shadow_distance_assembler = new ShaderAssemblerDistance()\n\n\t\t// this.self._init_hierarchy_children_owner();\n\n\t\t// let has_display_flag = false;\n\t\t// if (options['has_display_flag']) {\n\t\t// \thas_display_flag = options['has_display_flag'];\n\t\t// }\n\n\t\t// this.self._init_display_flag({\n\t\t// \thas_display_flag: has_display_flag,\n\t\t// \tmultiple_display_flags_allowed: false,\n\t\t// \taffects_hierarchy: true,\n\t\t// });\n\n\t\t// this ensures that material re evaluate their uniforms\n\t\t// without having the SOP/Material recook\n\t\t// which can be a killer in an animation\n\t\t// But this should be tweaked so that it can recook all params of a node\n\t\t// this.self.add_post_dirty_hook(this.eval_params_and_assign_uniform_values.bind(this))\n\t\t// - UPDATE: this seems to work at the moment. The only issue is that\n\t\t// the particle system now updates 2x when recreating the shaders\n\t\t// but that's fixed with update_on_dirty\n\t\t// - UPDATE 2: now that the params have been refactored, let's try without this\n\t\t// if (options['update_on_dirty'] != false) {\n\t\t// \tthis.self.add_post_dirty_hook(this.cook_main_if_scene_loaded.bind(this));\n\t\t// }\n\t}\n\tset_assembler_globals_handler(globals_handler: GlobalsBaseController) {\n\t\tconst current_id = this._globals_handler ? this._globals_handler.id() : null;\n\t\tconst new_id = globals_handler ? globals_handler.id() : null;\n\n\t\tif (current_id != new_id) {\n\t\t\tthis._globals_handler = globals_handler;\n\t\t\tthis.set_compilation_required_and_dirty();\n\t\t\tthis._assembler.reset_configs();\n\t\t}\n\t}\n\tget assembler() {\n\t\treturn this._assembler;\n\t}\n\tget shaders_by_name() {\n\t\treturn this._shaders_by_name;\n\t}\n\tget globals_handler() {\n\t\treturn this._globals_handler;\n\t}\n\n\t// gltf_supported_material() {\n\t// \treturn this._assembler.constructor.convert_material_to_gltf_supported(this._material);\n\t// }\n\n\tadd_output_params(output_child: OutputGlNode) {\n\t\tthis._assembler.add_output_params(output_child);\n\t}\n\tadd_globals_params(globals_node: GlobalsGlNode) {\n\t\tthis._assembler.add_globals_params(globals_node);\n\t}\n\tallow_attribute_exports() {\n\t\treturn this._assembler.allow_attribute_exports();\n\t}\n\n\ton_create() {\n\t\tconst globals = this.node.create_node('globals');\n\t\tconst output = this.node.create_node('output');\n\n\t\tglobals.ui_data.set_position(new Vector2(-200, 0));\n\t\toutput.ui_data.set_position(new Vector2(200, 0));\n\t}\n\n\t// async compile_if_required() {\n\t// \t// this._recompiled = false;\n\t// \tif (this.compile_required()) {\n\t// \t\t// && !this._param_locked){\n\t// \t\tconst new_material = await this.run_assembler();\n\t// \t\tif (new_material) {\n\t// \t\t\tawait this.node.params.eval_params(this._new_params);\n\t// \t\t\tthis._material = new_material;\n\t// \t\t\t// this._recompiled = true;\n\t// \t\t} else {\n\t// \t\t\tconsole.error(`${this.node.full_path()} failed to generate a material`);\n\t// \t\t}\n\t// \t}\n\t// \tawait this.assign_uniform_values();\n\t// }\n\tset_compilation_required() {\n\t\tthis._compile_required = true;\n\t}\n\tset_compilation_required_and_dirty(trigger_node?: BaseGlNodeType) {\n\t\t// it may be useful to send the trigger node here\n\t\t// but in the end, the material needs to recook fully\n\t\t// in order to properly assign the uniforms\n\t\t// (unless there is a way to re-assign the same value to a uniform that is not meant to be updated)\n\t\tthis.set_compilation_required();\n\t\tthis.node.set_dirty(trigger_node);\n\t}\n\tcompile_required(): boolean {\n\t\treturn this._compile_required;\n\t}\n\n\t// set_root_nodes(nodes: BaseGlNodeType[]) {\n\t// \tthis.assembler.set_root_nodes(nodes);\n\t// }\n\t// set_node_lines_globals(globals_node: GlobalsGlNode, shader_name: ShaderName) {\n\t// \tthis.assembler.set_node_lines_globals(globals_node, shader_name);\n\t// }\n\t// set_node_lines_output(output_node: OutputGlNode, shader_name: ShaderName) {\n\t// \tthis.assembler.set_node_lines_output(output_node, shader_name);\n\t// }\n\t// set_node_lines_attribute(attribute_node: AttributeGlNode, shader_name: ShaderName) {\n\t// \tthis.assembler.set_node_lines_attribute(attribute_node, shader_name);\n\t// }\n\n\tasync post_compile() {\n\t\tif (!this._compile_required) {\n\t\t\treturn;\n\t\t}\n\t\t// this.assembler.compile_for_node(this._gl);\n\t\tthis.create_spare_parameters();\n\t\tthis._compile_required = false;\n\t}\n\n\t// private async run_assembler() {\n\t// \tconst output_node = this.find_output_node();\n\t// \tif (output_node) {\n\t// \t\tthis._assembler.set_root_nodes([output_node]);\n\t// \t}\n\t// \tthis.assembler.compile();\n\t// \tconst material = await this._assembler.get_material();\n\t// \tif (material) {\n\t// \t\tthis._shaders_by_name.set(ShaderName.VERTEX, material.vertexShader);\n\t// \t\tthis._shaders_by_name.set(ShaderName.FRAGMENT, material.fragmentShader);\n\n\t// \t\t// assign custom materials\n\t// \t\tconst custom_materials = await this._assembler.get_custom_materials();\n\t// \t\tconst material_with_custom_materials = material as ShaderMaterialWithCustomMaterials;\n\t// \t\tmaterial_with_custom_materials.custom_materials = {};\n\t// \t\tcustom_materials.forEach((custom_material, shader_name) => {\n\t// \t\t\tmaterial_with_custom_materials.custom_materials[shader_name] = custom_material;\n\t// \t\t});\n\n\t// \t\tmaterial.needsUpdate = true;\n\t// \t}\n\n\t// \tthis.create_spare_parameters();\n\n\t// \tthis._compile_required = false;\n\t// \treturn material;\n\t// }\n\n\t// find_output_node() {\n\t// \tconst nodes = this.node.nodes_by_type('output');\n\t// \tif (nodes.length > 1) {\n\t// \t\tthis.node.states.error.set('only one output node allowed');\n\t// \t}\n\t// \treturn nodes[0];\n\t// }\n\t// find_attribute_export_nodes() {\n\t// \tconst nodes = this.node.nodes_by_type('attribute');\n\t// \treturn nodes.filter((node) => {\n\t// \t\t// do not use attributes that are used as an input, as export\n\t// \t\t// return (node.used_output_names().length == 0) &&\n\t// \t\treturn node.is_exporting;\n\t// \t});\n\t// }\n\t// add_output_body_line(output_node, shader_name: ShaderName, input_name: string){\n\t// \tconst input = output_node.named_input(input_name)\n\t// \tconst var_input = output_node.variable_for_input(input_name)\n\t// \tconst variable_config = this.variable_config(input_name)\n\t// \tconst default_value = variable_config.default()\n\t// \tconst prefix = variable_config.prefix()\n\t// \tconst suffix = variable_config.suffix()\n\t// \tconst new_var = input ? ThreeToGl.vector3(var_input) : default_value\n\t// \tif(new_var){\n\t// \t\toutput_node.add_body_lines([`${prefix}${new_var}${suffix}`], shader_name)\n\t// \t}\n\t// }\n\t// set_output_node_lines(output_node){\n\t// \tfor(let shader_name of this.shader_names()){\n\t// \t\tconst body_lines = []\n\t// \t\tconst input_names = this.shader_config(shader_name).input_names()\n\t// \t\toutput_node.set_body_lines([], shader_name)\n\t// \t\tif(input_names){\n\t// \t\t\tfor(let input_name of input_names){\n\t// \t\t\t\tthis.add_output_body_line(output_node, shader_name, input_name)\n\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\n\t// \t// const vertex_body_lines = []\n\t// \t// const fragment_body_lines = []\n\n\t// \t// const named_input_position = this.named_input('position')\n\t// \t// const named_input_point_size = this.named_input('gl_PointSize')\n\t// \t// const named_input_normal = this.named_input('normal')\n\n\t// \t// const var_position = this.variable_for_input('position')\n\t// \t// const var_normal = this.variable_for_input('normal')\n\t// \t// const color = this.variable_for_input('color')\n\t// \t// const alpha = this.variable_for_input('alpha')\n\t// \t// const var_point_size = this.variable_for_input('gl_PointSize')\n\n\t// \t// fragment_body_lines.push( `${this._color_declaration} = ${ThreeToGl.vector3_float(color, alpha)}` )\n\t// \t// this.set_fragment_body_lines(fragment_body_lines)\n\n\t// \t// const new_position_var = named_input_position ? ThreeToGl.vector3(var_position) : 'vec3( position )'\n\t// \t// vertex_body_lines.push( `vec3 transformed = ${new_position_var}` )\n\n\t// \t// if(this.parent().is_point_material()){\n\t// \t// \tconst new_point_size_var = named_input_point_size ? ThreeToGl.float(var_point_size) : '1.0'\n\t// \t// \tvertex_body_lines.push( `float size2 = size * ${new_point_size_var}` )\n\t// \t// }\n\n\t// \t// if(named_input_normal){\n\t// \t// \tconst new_normal_var = ThreeToGl.vector3(var_normal)\n\t// \t// \tvertex_body_lines.push(`objectNormal = ${new_normal_var}`)\n\t// \t// }\n\n\t// \t// this.set_vertex_body_lines(vertex_body_lines)\n\t// \t// this.set_fragment_body_lines(fragment_body_lines)\n\t// }\n\t// private async eval_params_and_assign_uniform_values() {\n\t// \tif (!this.self.scene().loaded()) {\n\t// \t\treturn;\n\t// \t}\n\n\t// \tif (this._assembler) {\n\t// \t\tawait this.self.eval_all_params();\n\t// \t\tawait this.assign_uniform_values();\n\t// \t}\n\t// }\n\t// private async cook_main_if_scene_loaded() {\n\t// \tif (!this.self.scene().loaded()) {\n\t// \t\treturn;\n\t// \t}\n\t// \tif (this.self.params_referree().length > 0) {\n\t// \t\tawait this.self.cook_main();\n\t// \t}\n\t// \t// this.cook_main_without_inputs()\n\t// }\n\tasync assign_uniform_values() {\n\t\tif (this._assembler) {\n\t\t\tfor (let param_config of this._assembler.param_configs()) {\n\t\t\t\tawait param_config.set_uniform_value(this.node);\n\t\t\t}\n\t\t}\n\t}\n\n\t// process_uniforms(renderer, display_scene, camera, geometry, material, group) {\n\t// \tconst scene_frame = this.scene().frame()\n\n\t// \tconst material_frame = material.uniforms.frame\n\t// \tif(material_frame){ // check needed in case this method is given a post process material\n\t// \t\tmaterial.uniforms.frame.value = scene_frame\n\t// \t}\n\n\t// \tconst custom_materials = material.custom_materials\n\t// \tif(custom_materials){\n\t// \t\tfor(let custom_material_name of Object.keys(custom_materials)){\n\t// \t\t\tconst custom_material = custom_materials[custom_material_name]\n\t// \t\t\tcustom_material.uniforms.frame.value = scene_frame\n\t// \t\t}\n\t// \t}\n\t// }\n\n\t// create_material(){\n\t// \tconst template_shader = THREE.ShaderLib.basic\n\n\t// \tconst uniforms = THREE.UniformsUtils.clone( template_shader.uniforms )\n\t// \t// uniforms['frame'] = {\n\t// \t// \ttype: '1f',\n\t// \t// \tvalue: 1\n\t// \t// }\n\n\t// \tconst material = new THREE.ShaderMaterial({\n\t// \t\t// vertexColors: THREE.VertexColors,\n\t// \t\t// side: THREE.FrontSide,\n\t// \t\t// transparent: true,\n\t// \t\t// fog: true,\n\t// \t\t// lights: false,\n\t// \t\tuniforms: uniforms,\n\t// \t\tvertexShader: template_shader.vertexShader,\n\t// \t\tfragmentShader: template_shader.fragmentShader\n\t// \t})\n\t// \tthrow \"wtf\"\n\t// \treturn material\n\t// }\n\tcreate_spare_parameters() {\n\t\tconst current_spare_param_names: string[] = this.node.params.spare_names;\n\t\tconst param_configs = this._assembler.param_configs();\n\t\tconst assembler_param_names = param_configs.map((c) => c.name);\n\t\t// TODO: also remove the params that change type\n\t\tconst spare_param_names_to_add = lodash_difference(assembler_param_names, current_spare_param_names);\n\t\tconst spare_param_names_to_remove = lodash_difference(current_spare_param_names, assembler_param_names);\n\t\tthis._new_params = [];\n\n\t\t// check that param_names_to_add does not include any currently existing param names (that are not spare)\n\t\tconst current_param_names = this.node.params.names;\n\t\tconst spare_params_with_same_name_as_params = lodash_intersection(\n\t\t\tspare_param_names_to_add,\n\t\t\tcurrent_param_names\n\t\t);\n\t\tif (spare_params_with_same_name_as_params.length > 0) {\n\t\t\tconst error_message = `${this.node.full_path()} attempts to create spare params called '${spare_params_with_same_name_as_params.join(\n\t\t\t\t', '\n\t\t\t)}' with same name as params`;\n\t\t\tconsole.warn(error_message);\n\t\t\tthis.node.states.error.set(error_message);\n\t\t}\n\n\t\tspare_param_names_to_remove.forEach((param_name) => {\n\t\t\t// store the param data, in case it gets recreated later\n\t\t\t// this allows expressions to be kept in memory\n\t\t\tconst param = this.node.params.get(param_name);\n\t\t\tif (param) {\n\t\t\t\tconst param_exporter = JsonExportDispatcher.dispatch_param(param);\n\t\t\t\tif (param_exporter.required) {\n\t\t\t\t\tconst params_data = param_exporter.data();\n\t\t\t\t\tthis._deleted_params_data.set(param.name, params_data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.node.params.delete_param(param_name);\n\t\t});\n\n\t\t// this.within_param_folder('spare_params', () => {\n\t\tfor (let param_config of param_configs) {\n\t\t\tif (spare_param_names_to_add.indexOf(param_config.name) >= 0) {\n\t\t\t\t// TODO: shouldn't it be cook: false ??\n\t\t\t\t// as there is no need to cook the node if I'm only changing the uniform\n\t\t\t\t// unless maybe for textures?\n\t\t\t\t// but if cook is false, there is no reason for it to be updated\n\t\t\t\tconst options = lodash_merge(param_config.param_options, {spare: true, cook: true});\n\n\t\t\t\tconst param = this.node.add_param(\n\t\t\t\t\tparam_config.type,\n\t\t\t\t\tparam_config.name,\n\t\t\t\t\tparam_config.default_value,\n\t\t\t\t\toptions\n\t\t\t\t);\n\t\t\t\tif (param) {\n\t\t\t\t\t// restore saved state, like expressions\n\t\t\t\t\tconst param_data = this._deleted_params_data.get(param.name);\n\t\t\t\t\tif (param_data) {\n\t\t\t\t\t\t// TODO: typescript\n\t\t\t\t\t\t// JsonImportDispatcher.dispatch_param(param).process_data(param_data);\n\t\t\t\t\t\t// looks like there are still some cases where the expression are not recreated\n\t\t\t\t\t\t// so commenting this out now\n\t\t\t\t\t\t// delete this._deleted_params_data[param.name()]\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._new_params.push(param);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (spare_param_names_to_add.length > 0 || spare_param_names_to_remove.length > 0) {\n\t\t\tthis.node.params.post_create_spare_params();\n\t\t\tthis.node.emit(NodeEvent.PARAMS_UPDATED);\n\t\t}\n\t}\n}\n","import {ObjectLoader} from 'three/src/loaders/ObjectLoader';\nimport {TypedSopNode} from './_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {BaseNodeType} from '../_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nclass CacheSopParamsConfig extends NodeParamsConfig {\n\tcache = ParamConfig.STRING('', {hidden: true});\n\treset = ParamConfig.BUTTON(null, {\n\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\tCacheSopNode.PARAM_CALLBACK_reset(node as CacheSopNode, param);\n\t\t},\n\t});\n}\nconst ParamsConfig = new CacheSopParamsConfig();\n\nexport class CacheSopNode extends TypedSopNode<CacheSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'cache';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to cache'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(0, 1);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst is_cache_empty = this.pv.cache == '' || this.pv.cache == null;\n\t\tconst core_group = input_contents[0];\n\t\tif (is_cache_empty && core_group) {\n\t\t\tconst json = [];\n\t\t\tfor (let object of core_group.objects()) {\n\t\t\t\tjson.push(object.toJSON());\n\t\t\t}\n\t\t\tthis.set_core_group(core_group);\n\t\t\tthis.p.cache.set(JSON.stringify(json));\n\t\t} else {\n\t\t\tif (this.pv.cache) {\n\t\t\t\tconst obj_loader = new ObjectLoader();\n\t\t\t\tconst jsons = JSON.parse(this.pv.cache);\n\t\t\t\tconst all_objects = [];\n\t\t\t\tfor (let json of jsons) {\n\t\t\t\t\tconst parent = obj_loader.parse(json);\n\t\t\t\t\t// for(let child of parent.children){\n\t\t\t\t\tall_objects.push(parent);\n\t\t\t\t\t// }\n\t\t\t\t}\n\t\t\t\tthis.set_objects(all_objects);\n\t\t\t} else {\n\t\t\t\tthis.set_objects([]);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic PARAM_CALLBACK_reset(node: CacheSopNode, param: BaseParamType) {\n\t\tnode.param_callback_PARAM_CALLBACK_reset();\n\t}\n\tasync param_callback_PARAM_CALLBACK_reset() {\n\t\tthis.p.cache.set('');\n\t\tthis.request_container();\n\t}\n}\n","import { render, staticRenderFns } from \"./DropDownMenu.vue?vue&type=template&id=da2d5a00&lang=pug&\"\nimport script from \"./DropDownMenu.vue?vue&type=script&lang=ts&\"\nexport * from \"./DropDownMenu.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./DropDownMenu.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('da2d5a00')) {\n      api.createRecord('da2d5a00', component.options)\n    } else {\n      api.reload('da2d5a00', component.options)\n    }\n    module.hot.accept(\"./DropDownMenu.vue?vue&type=template&id=da2d5a00&lang=pug&\", function () {\n      api.rerender('da2d5a00', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/DropDownMenu.vue\"\nexport default component.exports","import { render, staticRenderFns } from \"./Modal.vue?vue&type=template&id=80ac54ae&lang=pug&\"\nimport script from \"./Modal.vue?vue&type=script&lang=ts&\"\nexport * from \"./Modal.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Modal.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('80ac54ae')) {\n      api.createRecord('80ac54ae', component.options)\n    } else {\n      api.reload('80ac54ae', component.options)\n    }\n    module.hot.accept(\"./Modal.vue?vue&type=template&id=80ac54ae&lang=pug&\", function () {\n      api.rerender('80ac54ae', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/dialogs/Modal.vue\"\nexport default component.exports","import {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {EngineParamData} from 'src/editor/store/modules/Engine';\n\nimport {computed} from '@vue/composition-api';\nexport function SetupMultipleParamCommon(json_param: EngineParamData) {\n\tconst json_components = computed(() => {\n\t\treturn json_param.components?.map((id) => StoreController.engine.json_param(id)) || [];\n\t});\n\n\tconst cell_class_object = computed(() => {\n\t\tconst columns_count_per_components = 12 / json_components.value.length;\n\t\tconst class_name = `small-${columns_count_per_components}`;\n\t\treturn {\n\t\t\t[class_name]: true,\n\t\t};\n\t});\n\n\treturn {\n\t\tjson_components,\n\t\tcell_class_object,\n\t};\n}\n","import mod from \"-!../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// third party libs\n// import lodash_trim from 'lodash/trim'\n\n// internal libs\n// import KeyEventsDispatcher from './Helper/KeyEventsDispatcher'\n// import {SceneJsonExporter} from 'src/Engine/IO/Json/Export/Scene'\n\n// helper\n// import {WindowCloserController} from './Helper/WindowCloserController'\n\n// mixins\n// import EventsDispatcher from './Mixin/EventsDispatcher';\n// import HistoryMixin from './Mixin/History';\n// import NodeOwner from './Mixin/NodeOwner';\n\n// components\nimport TopBar from './top/Top.vue';\nimport DialogAlert from '../widgets/dialogs/Alert.vue';\nimport DialogConfirm from '../widgets/dialogs/Confirm.vue';\nimport DialogPrompt from '../widgets/dialogs/Prompt.vue';\nimport MultiplePanel from '../panels/multiple/Multiple.vue';\nimport NavigationBar from './top/Navigation.vue';\nimport PlayBar from './widgets/PlayBar.vue';\n// import FooterBar from './Bar/Footer'\n// import ParamNodeSelector from './Widget/ParamNodeSelector'\nimport PanelNodeSelector from './widgets/PanelNodeSelector.vue';\nimport NumericSlider from '../../components/widgets/NumericSlider.vue';\nimport NodeContextMenu from '../../components/widgets/context_menus/NodeContextMenu.vue';\nimport ParamContextMenu from '../../components/widgets/context_menus/ParamContextMenu.vue';\n// import UploadMenu from './Widget/UploadMenu'\nimport Retractable from './widgets/Retractable.vue';\n// import LocalAssetUploadProgressDisplay from './Widget/LocalAssetUploadProgressDisplay'\n\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {KeyEventsDispatcher} from 'src/editor/helpers/KeyEventsDispatcher';\n\nimport Vue from 'vue';\nVue.component('MultiplePanel', MultiplePanel);\nimport DropDownMenu from 'src/editor/components/widgets/DropDownMenu.vue';\nVue.component('DropDownMenu', DropDownMenu);\nimport NodeTree from 'src/editor/components/widgets/NodeTree.vue';\nVue.component('NodeTree', NodeTree);\n\nimport {defineComponent, ref, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'editor',\n\t// mixins: [EventsDispatcher, HistoryMixin, NodeOwner],\n\tcomponents: {\n\t\tDialogAlert,\n\t\tDialogConfirm,\n\t\tDialogPrompt,\n\t\tNavigationBar,\n\t\t// FooterBar,\n\t\t// LocalAssetUploadProgressDisplay,\n\t\tMultiplePanel,\n\t\tNodeContextMenu,\n\t\tParamContextMenu,\n\t\t// ParamNodeSelector,\n\t\tPanelNodeSelector,\n\t\tPlayBar,\n\t\tRetractable,\n\t\tNumericSlider,\n\t\tTopBar,\n\t\t// UploadMenu,\n\t},\n\n\tprops: {\n\t\tscene_update_allowed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tusername: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\t// init_properties:\n\t\t// \ttype: Object\n\t\t// \tdefault: -> {}\n\t\t// scene_update_allowed:\n\t\t// \ttype: Boolean\n\t\t// \tdefault: false\n\t\t// username:\n\t\t// \ttype: String\n\t\t// \tdefault: null\n\t},\n\n\tsetup() {\n\t\tconst multiple_panel = ref<HTMLElement>(null);\n\n\t\tKeyEventsDispatcher.activate();\n\n\t\tconst full_screen_activated = computed(() => {\n\t\t\tconst fullscreen_panel_id = StoreController.editor.panel.fullscreen_panel_id();\n\t\t\treturn fullscreen_panel_id != null;\n\t\t});\n\n\t\treturn {\n\t\t\tmultiple_panel,\n\t\t\tfull_screen_activated,\n\t\t};\n\t},\n\n\t// created: () => {\n\t// \t// this._init_history()\n\t// \t// @_key_events_dispatcher = new KeyEventsDispatcher(this)\n\t// \t// window.key_events_dispatcher = @_key_events_dispatcher\n\t// \t// if this.scene_update_allowed\n\t// \t// \tnew WindowCloserController(this)\n\t// \t// this.from_json(@init_properties)\n\t// },\n\n\t// methods: {\n\t// \t// open_node: (node)=>{\n\t// \t// \treturn this.$store.commit('editor/current_node', node);\n\t// \t// },\n\t// \t// to_json:()=>{\n\t// \t// \tconst current_node_id = this.$store.getters['editor/current_node_id'];\n\t// \t// \tconst obj =\n\t// \t// \t\t{multiple_panel: this.$refs.multiple_panel.to_json()};\n\t// \t// \tif (current_node_id != null) {\n\t// \t// \t\tconst current_node = this.$store.scene.graph().node_from_id(current_node_id);\n\t// \t// \t\tobj['current_node'] = current_node.full_path();\n\t// \t// \t}\n\t// \t// \treturn obj;\n\t// \t// },\n\t// \t// from_json: (json)=>{\n\t// \t// \tlet current_node_full_path;\n\t// \t// \tif ((current_node_full_path = json['current_node']) != null) {\n\t// \t// \t\tlet node;\n\t// \t// \t\tif ((node = this.$store.scene.node(current_node_full_path)) != null) {\n\t// \t// \t\t\treturn this.open_node(node);\n\t// \t// \t\t}\n\t// \t// \t}\n\t// \t// },\n\t// \t// save_scene: async ()=>{\n\t// \t// \tif (!this.scene_update_allowed) {\n\t// \t// \t\treturn window.POLY_alert(\"You do not have permission to save this scene\");\n\t// \t// \t} else {\n\t// \t// \t\tthis.$store.commit('editor/status_bar/loading', 'Saving...');\n\t// \t// \t\tconst { scene } = this.$store;\n\t// \t// \t\tlet scene_name = scene.name();\n\t// \t// \t\t// scene_name = 'test'\n\t// \t// \t\tif (scene_name != null) {\n\t// \t// \t\t\treturn this.save_scene_with_name(scene_name);\n\t// \t// \t\t} else {\n\t// \t// \t\t\tscene_name = await window.POLY_prompt(this, 'Scene Title', 'new scene');\n\t// \t// \t\t\tif ((scene_name != null) && (lodash_trim(scene_name).length > 0)) {\n\t// \t// \t\t\t\treturn this.save_scene_with_name(scene_name);\n\t// \t// \t\t\t}\n\t// \t// \t\t}\n\t// \t// \t}\n\t// \t// },\n\t// \t// save_scene_with_name: (scene_name:string)=>{\n\t// \t// \tconst form = document.querySelectorAll('form')[0];\n\t// \t// \tif (form != null) {\n\t// \t// \t\tconst name_input = document.getElementById('scene_name');\n\t// \t// \t\tconst code_input = document.getElementById('scene_code');\n\t// \t// \t\tconst code_editor_input = document.getElementById('scene_code_editor');\n\t// \t// \t\tconst node_context_signatures_input = document.getElementById('scene_node_context_signatures');\n\t// \t// \t\tconst js_version_input = document.getElementById('scene_js_version');\n\t// \t// \t\tconst submit_button = form.querySelectorAll('input[type=submit]')[0];\n\t// \t// \t\tname_input.value = scene_name;\n\t// \t// \t\tconst scene_exporter = new SceneJsonExporter(scene);\n\t// \t// \t\tconst json_data = scene_exporter.data();\n\t// \t// \t\tcode_input.value = JSON.stringify(json_data, null, 1);\n\t// \t// \t\tcode_editor_input.value = JSON.stringify( this.to_json(), null, 1 );\n\t// \t// \t\tnode_context_signatures_input.value = scene.node_context_signatures().join(';');\n\t// \t// \t\tjs_version_input.value = POLY.js_version();\n\t// \t// \t\tthis.$store.history.mark_scene_as_saved();\n\t// \t// \t\treturn submit_button.click();\n\t// \t// \t}\n\t// \t// },\n\t// \t// go_down: ()=>{\n\t// \t// \tlet node;\n\t// \t// \tconst selection = this.node.selection();\n\t// \t// \tif ((node = selection.nodes()[0]) != null) {\n\t// \t// \t\treturn this.open_node(node);\n\t// \t// \t}\n\t// \t// },\n\t// \t// go_up: ()=>{\n\t// \t// \tlet parent;\n\t// \t// \tif ((parent = this.node.parent()) != null) {\n\t// \t// \t\treturn this.open_node(parent);\n\t// \t// \t}\n\t// \t// },\n\t// \t// dispatch_event: (node, properties)=>{\n\t// \t// \tconst event = this.create_event(node, properties);\n\t// \t// \tconst viewers = this.$refs.multiple_panel.viewers();\n\t// \t// \treturn lodash_each(viewers, viewer=> viewer.process_event(event));\n\t// \t// },\n\t// \t// panel_with_id: (panel_id)=>{\n\t// \t// \treturn this.$refs.multiple_panel.panel_with_id(panel_id);\n\t// \t// }\n\t// },\n});\n","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Top.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Top.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport DropDownMenu from 'src/editor/components/widgets/DropDownMenu.vue';\nimport {DropDownMenuEntry} from '../../types/props';\n// import {SceneJsonExporter} from 'src/engine/io/json/export/Scene';\n\nenum FileEntryId {\n\t// NEW = 'new',\n\tSAVE = 'save',\n\t// SETTINGS = 'settings',\n\t// PLAY = 'play',\n\t// DASHBOARD = 'dashboard',\n}\nenum EditEntryId {\n\tUNDO = 'undo',\n\tREDO = 'redo',\n}\nenum DesktopEntryId {\n\tUPLOAD = 'upload_assets',\n\tABOUT = 'about',\n}\n\nimport {defineComponent, computed} from '@vue/composition-api';\nimport {HistoryStack} from '../../../history/Stack';\nimport {StoreController} from '../../../store/controllers/StoreController';\nexport default defineComponent({\n\tname: 'top_menu',\n\tcomponents: {DropDownMenu},\n\tprops: {\n\t\tscene_update_allowed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tusername: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tsetup(props) {\n\t\tconst display_desktop_entries = computed(() => {\n\t\t\treturn false; //POLY.desktop_controller().active();\n\t\t});\n\n\t\tconst file_menu_entries = computed(() => {\n\t\t\tconst entries: DropDownMenuEntry[] = [\n\t\t\t\t// {id: FileEntryId.NEW},\n\t\t\t\t{id: FileEntryId.SAVE, disabled: !props.scene_update_allowed},\n\t\t\t\t// {id: FileEntryId.SETTINGS, disabled: !props.scene_update_allowed},\n\t\t\t\t// {id: 'embed', disabled: !props.scene_update_allowed},\n\t\t\t\t// {id: FileEntryId.PLAY, disabled: !props.scene_update_allowed},\n\t\t\t\t// {id: FileEntryId.DASHBOARD},\n\t\t\t];\n\n\t\t\treturn entries;\n\t\t});\n\n\t\tconst edit_menu_entries = computed(() => {\n\t\t\t// I could add a disable state depending on the history stack\n\t\t\t// but not sure that it is reactive yet\n\t\t\tconst entries: DropDownMenuEntry[] = [{id: EditEntryId.UNDO}, {id: EditEntryId.REDO}];\n\n\t\t\treturn entries;\n\t\t});\n\n\t\tconst desktop_menu_entries = computed(() => {\n\t\t\tconst entries = [\n\t\t\t\t{id: DesktopEntryId.UPLOAD, label: 'Upload Assets'},\n\t\t\t\t{id: DesktopEntryId.ABOUT, label: 'About Desktop'},\n\t\t\t];\n\n\t\t\treturn entries;\n\t\t});\n\n\t\t// functions\n\t\tfunction on_file_menu_entry_select(entry: FileEntryId) {\n\t\t\tswitch (entry) {\n\t\t\t\t// case FileEntryId.NEW:\n\t\t\t\t// \treturn redirect_to_new_scene();\n\t\t\t\tcase FileEntryId.SAVE:\n\t\t\t\t\treturn _save();\n\t\t\t\t// case FileEntryId.SETTINGS:\n\t\t\t\t// \treturn redirect_to_settings();\n\t\t\t\t// case 'embed':\n\t\t\t\t// \treturn redirect_to_embed();\n\t\t\t\t// case FileEntryId.PLAY:\n\t\t\t\t// \treturn redirect_to_play();\n\t\t\t\t// case FileEntryId.DASHBOARD:\n\t\t\t\t// \treturn redirect_to_dashboard();\n\t\t\t}\n\t\t}\n\n\t\tfunction on_edit_menu_entry_select(entry: EditEntryId) {\n\t\t\tswitch (entry) {\n\t\t\t\tcase EditEntryId.UNDO:\n\t\t\t\t\treturn undo();\n\t\t\t\tcase EditEntryId.REDO:\n\t\t\t\t\treturn redo();\n\t\t\t}\n\t\t}\n\n\t\tfunction on_desktop_menu_entry_select(entry: DesktopEntryId) {\n\t\t\tswitch (entry) {\n\t\t\t\tcase DesktopEntryId.UPLOAD:\n\t\t\t\t\treturn upload_desktop_assets();\n\t\t\t\tcase DesktopEntryId.ABOUT:\n\t\t\t\t\treturn open_desktop_about_dialog();\n\t\t\t}\n\t\t}\n\n\t\tasync function _save() {\n\t\t\t// importing SceneJsonExporter dynamically, otherwise it seems that classes\n\t\t\t// are not loaded in the right order, creating an exception when opening the editor\n\t\t\tStoreController.save_scene();\n\t\t}\n\t\tfunction undo() {\n\t\t\treturn HistoryStack.instance().undo();\n\t\t}\n\t\tfunction redo() {\n\t\t\treturn HistoryStack.instance().redo();\n\t\t}\n\n\t\tfunction upload_desktop_assets() {\n\t\t\t// return POLY.desktop_controller().upload_assets($store.scene, () => {\n\t\t\t// \treturn save();\n\t\t\t// });\n\t\t}\n\n\t\tfunction open_desktop_about_dialog() {\n\t\t\t// const version = POLY.desktop_controller().version();\n\t\t\t// return window.POLY_alert(this, `Polygonjs Desktop App (version ${version})`, {title: 'About'});\n\t\t}\n\n\t\t// function redirect_to_new_scene() {\n\t\t// \treturn redirect_to('scenes/new');\n\t\t// }\n\t\t// function redirect_to_settings() {\n\t\t// \treturn redirect_to_scene_path('settings');\n\t\t// }\n\t\t// function redirect_to_embed() {\n\t\t// \treturn redirect_to_scene_path('embed');\n\t\t// }\n\t\t// function redirect_to_play() {\n\t\t// \treturn redirect_to_profile_scene_path('');\n\t\t// }\n\t\t// function redirect_to_dashboard() {\n\t\t// \treturn redirect_to('dashboard');\n\t\t// }\n\n\t\t// function redirect_to_scene_path(path) {\n\t\t// \treturn redirect_to(`scenes/${window.scene.uuid()}/${path}`);\n\t\t// }\n\t\t// function redirect_to_profile_scene_path(path) {\n\t\t// \treturn redirect_to(`${username}/${window.scene.name()}/${path}`);\n\t\t// }\n\t\t// function redirect_to(path) {\n\t\t// \tconst url = POLY.root_url() + path;\n\t\t// \t// window.location = url\n\t\t// \tconst link = document.createElement('a');\n\t\t// \tlink.href = url;\n\n\t\t// \tif (!POLY.desktop_controller().active()) {\n\t\t// \t\tlink.setAttribute('target', '_blank');\n\t\t// \t}\n\n\t\t// \t// link needs to be added to the DOM for this to work in firefox\n\t\t// \tdocument.body.appendChild(link);\n\t\t// \tlink.click();\n\t\t// \treturn document.body.removeChild(link);\n\t\t// }\n\n\t\treturn {\n\t\t\tdisplay_desktop_entries,\n\t\t\tfile_menu_entries,\n\t\t\tedit_menu_entries,\n\t\t\tdesktop_menu_entries,\n\t\t\t//functions\n\t\t\ton_file_menu_entry_select,\n\t\t\ton_edit_menu_entry_select,\n\t\t\ton_desktop_menu_entry_select,\n\t\t};\n\t},\n});\n","import mod from \"-!../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDownMenu.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDownMenu.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport lodash_sortBy from 'lodash/sortBy';\n\nimport {CoreString} from 'src/core/String';\n\nimport {DropDownMenuEntry} from 'src/editor/components/types/props';\n\ninterface DropDownMenuProps {\n\tlevel: number;\n\ton_hover: boolean;\n\tlabel: string;\n\tdisplay_label: boolean;\n\tlabel_padding: Number2;\n\talways_visible: boolean;\n\tentries: DropDownMenuEntry[];\n\tsort_entries: boolean;\n\tright_aligned: boolean;\n\tevent_id_prefix: string | undefined;\n\temphasis: string;\n\tinit_position_top: number;\n}\n\nimport {defineComponent, ref, onMounted, computed, onBeforeMount, SetupContext} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'dropdown-menu',\n\tprops: {\n\t\tlevel: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\ton_hover: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tlabel: {\n\t\t\ttype: String,\n\t\t\tdefault: 'Menu',\n\t\t},\n\t\tdisplay_label: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tlabel_padding: {\n\t\t\ttype: Array,\n\t\t\tdefault() {\n\t\t\t\treturn [5, 10];\n\t\t\t},\n\t\t},\n\t\talways_visible: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tentries: {\n\t\t\ttype: Array,\n\t\t\tdefault() {\n\t\t\t\treturn [\n\t\t\t\t\t'entry 1',\n\t\t\t\t\t// {'entry 2': ['a', 'b']}\n\t\t\t\t\t'entry 3',\n\t\t\t\t];\n\t\t\t},\n\t\t},\n\t\tsort_entries: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tright_aligned: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tevent_id_prefix: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\temphasis: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tinit_position_top: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\n\tsetup(props: DropDownMenuProps, context: SetupContext) {\n\t\tconst displayed = ref(false);\n\t\tconst position_top_offset = ref(0);\n\t\tconst content_max_height = ref<number>(1000);\n\t\tconst scroll_bars_required = ref(false);\n\t\tconst hovered_entry_index = ref(-1);\n\t\t// const hovered_timestamp = ref(-1);\n\n\t\tconst dropdown_menu_content = ref<HTMLElement>(null);\n\t\tconst entry_element = ref<HTMLElement[]>(null);\n\n\t\tonBeforeMount(() => {\n\t\t\t// TODO: typescript check this\n\t\t\t// this.$options.components.DropDownMenu = require('./DropDownMenu').default;\n\t\t});\n\t\tonMounted(() => {\n\t\t\tcompute_max_height();\n\t\t});\n\n\t\tconst content_top_position = computed(() => {\n\t\t\treturn props.init_position_top + position_top_offset.value;\n\t\t});\n\t\t// TODO: typescript check this\n\t\t// watch(()=>{\n\t\t// \tdisplayed(new_displayed) {\n\t\t// \t\tif (new_displayed) {\n\t\t// \t\t\tthis.compute_max_height();\n\t\t// \t\t}\n\t\t// \t},\n\t\t// \tsorted_entries: {\n\t\t// \t\thandler(new_sorted_entries) {\n\t\t// \t\t\tthis.compute_max_height();\n\t\t// \t\t},\n\t\t// \t\tdeep: true,\n\t\t// \t},\n\t\t// })\n\n\t\tconst hovered_entry_has_children = computed(() => entry_has_children.value[hovered_entry_index.value]);\n\t\tconst sub_dropdown_style_object = computed(() => {\n\t\t\tconst entry_parent = dropdown_menu_content.value;\n\t\t\tif (entry_parent && entry_element.value) {\n\t\t\t\t// const current_entry_element = entry_element.value[hovered_entry_index.value];\n\t\t\t\t// const entry_parent_top = entry_parent.getBoundingClientRect().top;\n\t\t\t\t// const entry_element_top = current_entry_element.getBoundingClientRect().top;\n\t\t\t\tconst width = entry_parent.offsetWidth;\n\t\t\t\treturn {\n\t\t\t\t\t// top: `${entry_element_top - entry_parent_top}px`,\n\t\t\t\t\tleft: `${width}px`,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {};\n\t\t\t}\n\t\t});\n\t\tconst sub_dropdown_init_position_top = computed(() => {\n\t\t\tconst entry_parent = dropdown_menu_content.value;\n\t\t\tif (entry_parent && entry_element.value) {\n\t\t\t\tconst current_entry_element = entry_element.value[hovered_entry_index.value];\n\t\t\t\tconst entry_parent_top = entry_parent.getBoundingClientRect().top;\n\t\t\t\tconst entry_element_top = current_entry_element.getBoundingClientRect().top;\n\t\t\t\treturn entry_element_top - entry_parent_top + position_top_offset.value;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\t\tconst hovered_entry_children = computed(() => {\n\t\t\treturn entry_children.value[hovered_entry_index.value];\n\t\t});\n\t\tconst hovered_entry_id = computed(() => {\n\t\t\treturn entry_ids.value[hovered_entry_index.value];\n\t\t});\n\n\t\tconst has_emphasis = computed(() => {\n\t\t\treturn props.emphasis != null && props.emphasis.length >= 0;\n\t\t});\n\t\tconst sorted_entries = computed(() => {\n\t\t\tif (props.sort_entries) {\n\t\t\t\tconst entries_by_name: Dictionary<DropDownMenuEntry> = {};\n\t\t\t\tprops.entries.forEach((entry) => {\n\t\t\t\t\tentries_by_name[entry['id']] = entry;\n\t\t\t\t});\n\n\t\t\t\tconst names = lodash_sortBy(Object.keys(entries_by_name));\n\t\t\t\treturn names.map((name) => entries_by_name[name]);\n\t\t\t} else {\n\t\t\t\treturn props.entries;\n\t\t\t}\n\t\t});\n\n\t\tconst entry_ids = computed(() => {\n\t\t\treturn sorted_entries.value.map((entry) => entry['id']);\n\t\t});\n\n\t\tconst entry_labels = computed(() => {\n\t\t\treturn sorted_entries.value.map((entry) => {\n\t\t\t\tconst label = entry['label'];\n\t\t\t\treturn label || CoreString.titleize(entry['id']);\n\t\t\t});\n\t\t});\n\t\tconst emphasis_indices = computed(() => {\n\t\t\treturn entry_labels.value.map((entry_label) => {\n\t\t\t\treturn entry_label.indexOf(props.emphasis);\n\t\t\t});\n\t\t});\n\n\t\tconst entry_labels_pre_emphasis = computed(() => {\n\t\t\treturn entry_labels.value.map((entry_label, i) => {\n\t\t\t\tconst index = emphasis_indices.value[i];\n\t\t\t\tif (index === 0) {\n\t\t\t\t\treturn '';\n\t\t\t\t} else if (index > 0) {\n\t\t\t\t\treturn entry_label.slice(0, +(index - 1) + 1 || undefined);\n\t\t\t\t} else {\n\t\t\t\t\treturn entry_label;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tconst entry_labels_post_emphasis = computed(() => {\n\t\t\treturn entry_labels.value.map((entry_label, i) => {\n\t\t\t\tconst index = emphasis_indices.value[i];\n\t\t\t\tif (index >= entry_label.length - props.emphasis.length) {\n\t\t\t\t\treturn '';\n\t\t\t\t} else {\n\t\t\t\t\treturn entry_label.slice(index + props.emphasis.length);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tconst entry_disabled_states = computed(() => {\n\t\t\treturn sorted_entries.value.map((entry) => entry['disabled'] === true);\n\t\t});\n\t\tconst entry_class_objects = computed(() => {\n\t\t\treturn sorted_entries.value.map((entry, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tdisabled: entry_disabled_states.value[i],\n\t\t\t\t\tactive: !entry_disabled_states.value[i],\n\t\t\t\t};\n\t\t\t});\n\t\t});\n\n\t\tconst entry_has_children = computed(() => {\n\t\t\treturn sorted_entries.value.map((entry) => {\n\t\t\t\treturn entry['children'] != null;\n\t\t\t});\n\t\t});\n\n\t\tconst entry_children = computed(() => {\n\t\t\treturn sorted_entries.value.map(\n\t\t\t\t(entry) =>\n\t\t\t\t\t// lodash_values(entry)[0]\n\t\t\t\t\tentry['children']\n\t\t\t);\n\t\t});\n\n\t\t// entry_class_objects: ->\n\t\t// \tlodash_map this.entries, (entry, i)=>\n\t\t// \t\thas_sub_entry: this.entry_has_sub_entries[i]\n\n\t\tconst dropdown_menu_class_object = computed(() => {\n\t\t\treturn {\n\t\t\t\ton_hover: props.on_hover,\n\t\t\t\tdisplayed: displayed.value,\n\t\t\t};\n\t\t});\n\t\tconst menu_label_style_object = computed(() => {\n\t\t\tif (props.display_label) {\n\t\t\t\treturn {\n\t\t\t\t\tpadding: props.label_padding.map((pad) => `${pad}px`).join(' '),\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tconst pixel_class_object = computed(() => {\n\t\t\tconst is_root = props.level === 0;\n\n\t\t\treturn {\n\t\t\t\tbottom_left: is_root,\n\t\t\t\ttop_right: !is_root,\n\t\t\t\talways_visible: props.always_visible || displayed.value,\n\t\t\t\tright_aligned: props.right_aligned,\n\t\t\t};\n\t\t});\n\n\t\tconst content_class_object = computed(() => {\n\t\t\treturn {right_aligned: props.right_aligned};\n\t\t});\n\t\tconst content_style_object = computed(() => {\n\t\t\tif (scroll_bars_required.value) {\n\t\t\t\treturn {\n\t\t\t\t\ttop: `${Math.floor(content_top_position.value)}px`,\n\t\t\t\t\tmaxHeight: `${Math.floor(content_max_height.value)}px`,\n\t\t\t\t\toverflowY: 'scroll',\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\ttop: `${Math.floor(content_top_position.value)}px`,\n\t\t\t\t\tmaxHeight: null,\n\t\t\t\t\toverflowY: null,\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tconst dropdown_menu_label_object = computed(() => {\n\t\t\tif (props.display_label) {\n\t\t\t\treturn {\n\t\t\t\t\tdropdown_menu_label: true,\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\t// functions\n\t\tfunction compute_max_height() {\n\t\t\t// content_max_height.value = document.body.offsetHeight;\n\t\t\tscroll_bars_required.value = false;\n\n\t\t\t// TODO: typescript check this\n\t\t\t// this.$nextTick(() => {\n\t\t\tif (!dropdown_menu_content.value) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst rect = dropdown_menu_content.value.getBoundingClientRect();\n\t\t\tconst top = rect.top;\n\t\t\tconst element_height = rect.height;\n\t\t\tconst window_height = window.innerHeight;\n\t\t\t// const available_height = window_height - top;\n\t\t\t// const max_top = window_height - available_height;\n\n\t\t\t// if the element is taller than the window\n\t\t\tif (element_height > window_height) {\n\t\t\t\t// 10px margin to be sure its content stops befor the bottom of the window\n\t\t\t\t// content_top_position.value = Math.min(element_height - available_height, max_top);\n\t\t\t\tcontent_max_height.value = window_height; //(window_height - top) - 10\n\t\t\t\tposition_top_offset.value = -top;\n\t\t\t\tscroll_bars_required.value = true;\n\t\t\t} else {\n\t\t\t\tconst visible_height = window_height - top;\n\t\t\t\tconst hidden_height = element_height - visible_height;\n\n\t\t\t\t// if the element has part of it under the bottom of the window\n\t\t\t\tif (hidden_height > 0) {\n\t\t\t\t\tposition_top_offset.value = -hidden_height;\n\t\t\t\t\t// if the element is fully visible, no offset needed\n\t\t\t\t} else {\n\t\t\t\t\tposition_top_offset.value = 0;\n\t\t\t\t}\n\t\t\t\tcontent_max_height.value = element_height;\n\t\t\t\tscroll_bars_required.value = false;\n\t\t\t}\n\t\t\t// });\n\t\t}\n\n\t\tfunction set_hovered_entry_index(index: number) {\n\t\t\thovered_entry_index.value = index;\n\t\t\t// hovered_timestamp.value = performance.now();\n\t\t}\n\t\tfunction unset_hovered_entry() {\n\t\t\t// this.hovered_entry_index = -1\n\t\t}\n\n\t\tfunction select(entry: DropDownMenuEntry) {\n\t\t\tconst is_disabled = entry['disabled'] || false;\n\t\t\tif (!is_disabled) {\n\t\t\t\tdisplayed.value = false;\n\t\t\t\tconst id = entry['id'];\n\t\t\t\tlet emitted = id;\n\t\t\t\tif (props.event_id_prefix) {\n\t\t\t\t\temitted = `${props.event_id_prefix}/${id}`;\n\t\t\t\t}\n\t\t\t\tcontext.emit('select', emitted); // emits the string of id, optionally prefixed by props.event_id_prefix\n\t\t\t}\n\t\t}\n\n\t\tfunction on_entry_select(entry: DropDownMenuEntry) {\n\t\t\tdisplayed.value = false;\n\t\t\tcontext.emit('select', entry); // emits the entry object\n\t\t}\n\n\t\tfunction toggle_display() {\n\t\t\tdisplayed.value = !displayed.value;\n\t\t}\n\n\t\treturn {\n\t\t\tdisplayed,\n\t\t\tcontent_top_position,\n\t\t\tcontent_max_height,\n\t\t\t// scroll_bars_required,\n\t\t\thovered_entry_index,\n\t\t\tdropdown_menu_content,\n\t\t\tentry_element,\n\t\t\thovered_entry_has_children,\n\t\t\tsub_dropdown_style_object,\n\t\t\tsub_dropdown_init_position_top,\n\t\t\thovered_entry_children,\n\t\t\thovered_entry_id,\n\t\t\t// hovered_timestamp,\n\t\t\thas_emphasis,\n\t\t\tsorted_entries,\n\t\t\tentry_ids,\n\t\t\tentry_labels,\n\t\t\temphasis_indices,\n\t\t\tentry_labels_pre_emphasis,\n\t\t\tentry_labels_post_emphasis,\n\t\t\tentry_disabled_states,\n\t\t\tentry_class_objects,\n\t\t\tentry_has_children,\n\t\t\tentry_children,\n\t\t\tdropdown_menu_class_object,\n\t\t\tmenu_label_style_object,\n\t\t\tpixel_class_object,\n\t\t\tcontent_class_object,\n\t\t\tcontent_style_object,\n\t\t\tdropdown_menu_label_object,\n\t\t\tposition_top_offset,\n\n\t\t\t// functions\n\t\t\tset_hovered_entry_index,\n\t\t\tunset_hovered_entry,\n\t\t\tselect,\n\t\t\ton_entry_select,\n\t\t\ttoggle_display,\n\t\t\tcompute_max_height,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDownMenu.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"170fd493\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDownMenu.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDownMenu.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Top.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"432e560a\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Top.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Top.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Alert.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Alert.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Modal from './Modal.vue';\nimport {StoreController} from '../../../store/controllers/StoreController';\n\nimport {defineComponent, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'dialog-alert',\n\tcomponents: {Modal},\n\n\tsetup() {\n\t\tconst display = computed(() => StoreController.editor.dialog_alert.display());\n\t\tconst message = computed(() => StoreController.editor.dialog_alert.message());\n\t\tconst title = computed(() => StoreController.editor.dialog_alert.title());\n\n\t\tfunction close() {\n\t\t\tStoreController.editor.dialog_alert.hide();\n\t\t}\n\n\t\treturn {\n\t\t\tdisplay,\n\t\t\tmessage,\n\t\t\ttitle,\n\t\t\tclose,\n\t\t};\n\t},\n});\n","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {CoreDom} from 'src/core/Dom';\nimport {Vector2} from 'three/src/math/Vector2';\n\ninterface ModalProps {\n\ttitle: string;\n\tsize: Vector2Like;\n\tresizable: boolean;\n}\n\nimport {defineComponent, ref, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'modal',\n\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: 'No title',\n\t\t},\n\t\tsize: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn {\n\t\t\t\t\tx: 400,\n\t\t\t\t\ty: 200,\n\t\t\t\t};\n\t\t\t},\n\t\t},\n\t\tresizable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\tsetup(props: ModalProps) {\n\t\tconst pos = ref({x: 100, y: 100});\n\t\tconst resized_size = ref({x: props.size.x, y: props.size.y});\n\n\t\tconst style_object = computed(() => {\n\t\t\treturn {\n\t\t\t\ttop: `${pos.value.y}px`,\n\t\t\t\tleft: `${pos.value.x}px`,\n\t\t\t\twidth: `${resized_size.value.x}px`,\n\t\t\t\theight: `${resized_size.value.y}px`,\n\t\t\t};\n\t\t});\n\n\t\t//\n\t\t//\n\t\t// MOVE\n\t\t//\n\t\t//\n\t\tconst start_mouse_pos = new Vector2();\n\t\tconst start_pos = new Vector2();\n\t\tconst current_mouse_pos = new Vector2();\n\t\tconst delta = new Vector2();\n\t\tfunction on_move_start(e: MouseEvent) {\n\t\t\tstart_mouse_pos.x = e.pageX;\n\t\t\tstart_mouse_pos.y = e.pageY;\n\n\t\t\tstart_pos.x = pos.value.x;\n\t\t\tstart_pos.y = pos.value.y;\n\n\t\t\tCoreDom.add_drag_classes();\n\t\t\tdocument.addEventListener('mousemove', on_move_drag);\n\t\t\tdocument.addEventListener('mouseup', on_move_end);\n\t\t}\n\n\t\tfunction on_move_drag(e: MouseEvent) {\n\t\t\tcurrent_mouse_pos.x = e.pageX;\n\t\t\tcurrent_mouse_pos.y = e.pageY;\n\t\t\tdelta.x = current_mouse_pos.x - start_mouse_pos.x;\n\t\t\tdelta.y = current_mouse_pos.y - start_mouse_pos.y;\n\n\t\t\tpos.value.x = start_pos.x + delta.x;\n\t\t\tpos.value.y = start_pos.y + delta.y;\n\t\t}\n\n\t\tfunction on_move_end(e: MouseEvent) {\n\t\t\tdocument.removeEventListener('mousemove', on_move_drag);\n\t\t\tdocument.removeEventListener('mouseup', on_move_end);\n\t\t\tCoreDom.remove_drag_classes();\n\t\t}\n\n\t\t//\n\t\t//\n\t\t// RESIZE\n\t\t//\n\t\t//\n\t\tconst start_size = new Vector2();\n\t\tfunction on_resize_start(e: MouseEvent) {\n\t\t\tstart_mouse_pos.x = e.pageX;\n\t\t\tstart_mouse_pos.y = e.pageY;\n\n\t\t\tstart_size.x = resized_size.value.x;\n\t\t\tstart_size.y = resized_size.value.y;\n\n\t\t\t// this._mouse_move_event_method = this.on_resize_drag.bind(this);\n\t\t\t// this._mouse_up_event_method = this.on_resize_end.bind(this);\n\t\t\tCoreDom.add_drag_classes();\n\t\t\tdocument.addEventListener('mousemove', on_resize_drag);\n\t\t\tdocument.addEventListener('mouseup', on_resize_end);\n\t\t}\n\n\t\tfunction on_resize_drag(e: MouseEvent) {\n\t\t\tcurrent_mouse_pos.x = e.pageX;\n\t\t\tcurrent_mouse_pos.y = e.pageY;\n\n\t\t\tdelta.x = current_mouse_pos.x - start_mouse_pos.x;\n\t\t\tdelta.y = current_mouse_pos.y - start_mouse_pos.y;\n\n\t\t\tresized_size.value.x = start_size.x + delta.x;\n\t\t\tresized_size.value.y = start_size.y + delta.y;\n\t\t}\n\n\t\tfunction on_resize_end(e: MouseEvent) {\n\t\t\tdocument.removeEventListener('mousemove', on_resize_drag);\n\t\t\tdocument.removeEventListener('mouseup', on_resize_end);\n\t\t\tCoreDom.remove_drag_classes();\n\t\t}\n\n\t\t// function to_json() {\n\t\t// \treturn {\n\t\t// \t\tpos: {\n\t\t// \t\t\tx: this.pos.x,\n\t\t// \t\t\ty: this.pos.y\n\t\t// \t\t},\n\t\t// \t\tsize: {\n\t\t// \t\t\tx: this.size.x,\n\t\t// \t\t\ty: this.size.y\n\t\t// \t\t}\n\t\t// \t};\n\t\t// }\n\t\t// function from_json(json){\n\t\t// \tif (json['pos'] != null) {\n\t\t// \t\tthis.pos.x = json['pos'].x;\n\t\t// \t\tthis.pos.y = json['pos'].y;\n\t\t// \t}\n\t\t// \tif (json['size'] != null) {\n\t\t// \t\tthis.size.x = json['size'].x;\n\t\t// \t\treturn this.size.y = json['size'].y;\n\t\t// \t}\n\t\t// }\n\n\t\treturn {\n\t\t\tpos,\n\t\t\tstyle_object,\n\t\t\ton_move_drag,\n\t\t\ton_move_end,\n\t\t\ton_move_start,\n\t\t\ton_resize_drag,\n\t\t\ton_resize_end,\n\t\t\ton_resize_start,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"fa645422\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Alert.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"24d18166\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Alert.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Alert.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Modal from './Modal.vue';\nimport {StoreController} from '../../../store/controllers/StoreController';\n\nimport {defineComponent, computed, watch, ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'dialog-confirm',\n\tcomponents: {Modal},\n\n\tsetup() {\n\t\tconst cancel_button = ref<HTMLButtonElement | null>(null);\n\n\t\tconst display = computed(() => StoreController.editor.dialog_confirm.display());\n\t\tconst question = computed(() => StoreController.editor.dialog_confirm.question());\n\t\tconst accept_label = computed(() => StoreController.editor.dialog_confirm.accept_label());\n\n\t\twatch(display, (new_display) => {\n\t\t\tif (new_display) {\n\t\t\t\tfocus_and_select();\n\t\t\t}\n\t\t});\n\n\t\tfunction focus_and_select() {\n\t\t\tif (cancel_button.value) {\n\t\t\t\tcancel_button.value.focus();\n\t\t\t}\n\t\t}\n\n\t\tfunction accept() {\n\t\t\tconst on_accept = StoreController.editor.dialog_confirm.on_accept();\n\t\t\tif (on_accept) {\n\t\t\t\ton_accept();\n\t\t\t}\n\n\t\t\tclose();\n\t\t}\n\n\t\tfunction close() {\n\t\t\tStoreController.editor.dialog_confirm.hide();\n\t\t}\n\n\t\treturn {\n\t\t\tcancel_button,\n\t\t\tdisplay,\n\t\t\tquestion,\n\t\t\taccept_label,\n\t\t\taccept,\n\t\t\tclose,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"78225756\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Prompt.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Prompt.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Modal from './Modal.vue';\nimport {StoreController} from '../../../store/controllers/StoreController';\n\nimport {defineComponent, ref, computed, watch} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'dialog-prompt',\n\tcomponents: {Modal},\n\n\tsetup() {\n\t\tconst main_input = ref<HTMLInputElement | null>(null);\n\n\t\tconst display = computed(() => StoreController.editor.dialog_prompt.display());\n\t\tconst title = computed(() => StoreController.editor.dialog_prompt.title());\n\t\tconst default_value = computed(() => StoreController.editor.dialog_prompt.default_value());\n\t\tconst confirm_label = computed(() => StoreController.editor.dialog_prompt.confirm_label());\n\n\t\twatch(display, (new_display) => {\n\t\t\tif (new_display) {\n\t\t\t\tfocus_and_select();\n\t\t\t}\n\t\t});\n\n\t\tfunction focus_and_select() {\n\t\t\tmain_input.value?.focus();\n\t\t\tmain_input.value?.select();\n\t\t}\n\n\t\tfunction on_keypress(e: KeyboardEvent) {\n\t\t\tif (e.code === 'Enter' || e.code === 'NumpadEnter') {\n\t\t\t\tsave();\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\tfunction save() {\n\t\t\tif (main_input.value) {\n\t\t\t\tconst name = main_input.value.value;\n\n\t\t\t\tconst on_save = StoreController.editor.dialog_prompt.on_save();\n\t\t\t\tif (on_save) {\n\t\t\t\t\ton_save(name);\n\t\t\t\t}\n\n\t\t\t\tclose();\n\t\t\t}\n\t\t}\n\n\t\tfunction close() {\n\t\t\tStoreController.editor.dialog_prompt.hide();\n\t\t}\n\n\t\treturn {\n\t\t\tmain_input,\n\t\t\tdisplay,\n\t\t\ttitle,\n\t\t\tdefault_value,\n\t\t\tconfirm_label,\n\t\t\ton_keypress,\n\t\t\tsave,\n\t\t\tclose,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Prompt.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"2c20850f\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Prompt.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Prompt.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Multiple.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Multiple.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupMultiplePanelJson} from './mixins/Json';\nimport {SetupMultiplePanelPanels} from './mixins/Panels';\nimport {SetupMultiplePanelSplit} from './mixins/Split';\n\nimport {MultiplePanelProps, MultiplePanelSplitMode} from 'src/editor/components/types/props';\n\n// components\n// import Asset from '../../Asset/Asset';\nimport Network from '../network/Network.vue';\nimport Params from '../params/Params.vue';\n// import ParamEdit from '../../ParamEdit/ParamEdit';\nimport Viewer from '../viewer/Viewer.vue';\nimport {PanelInitProperties} from '../../types/props';\n// import CustomNodeEditor from '../../CustomNodeEditor/CustomNodeEditor';\n\n// const AsyncPerformance = () => ({\n// \t// The component to load (should be a Promise)\n// \tcomponent: import('../../Performance/Performance'),\n// \t// A component to use while the async component is loading\n// \t// loading: LoadingComponent,\n// \t// A component to use if the load fails\n// \t// error: ErrorComponent,\n// \t// Delay before showing the loading component. Default: 200ms.\n// \t// delay: 200,\n// \t// The error component will be displayed if a timeout is\n// \t// provided and exceeded. Default: Infinity.\n// \t// timeout: 3000\n// });\n\nimport Spreadsheet from '../spreadsheet/Spreadsheet.vue';\n// import {\n// \tAsyncComponentFactory,\n// \tAsyncComponentPromise,\n// \tComponent,\n// \tDefaultData,\n// \tDefaultMethods,\n// } from 'vue/types/options.d';\n// // const Spreadsheet = () => import('../spreadsheet/Spreadsheet.vue');\n// const Spreadsheet: AsyncComponentFactory = () => ({\n// \t// The component to load (should be a Promise)\n// \tcomponent: (<unknown>import('../spreadsheet/Spreadsheet.vue')) as AsyncComponentPromise<\n// \t\tComponent<DefaultData<never>, DefaultMethods<never>>\n// \t>,\n// \t// A component to use while the async component is loading\n// \t// loading: LoadingComponent,\n// \t// A component to use if the load fails\n// \t// error: ErrorComponent,\n// \t// Delay before showing the loading component. Default: 200ms.\n// \t// delay: 200,\n// \t// The error component will be displayed if a timeout is\n// \t// provided and exceeded. Default: Infinity.\n// \t// timeout: 3000\n// });\n\nimport {PanelType} from './mixins/Panels';\nconst DEFAULT_PANELS = [PanelType.VIEWER, PanelType.PARAMS, PanelType.NETWORK];\n\nconst DEFAULT_LAYOUT: PanelInitProperties = {\n\tsplit_mode: MultiplePanelSplitMode.HORIZONTAL,\n\tsub_panels_init_properties: [\n\t\t{\n\t\t\tsplit_mode: MultiplePanelSplitMode.VERTICAL,\n\t\t\tsub_panels_init_properties: [\n\t\t\t\t{\n\t\t\t\t\tpanel_types: DEFAULT_PANELS,\n\t\t\t\t\tcurrent_panel_index: DEFAULT_PANELS.indexOf(PanelType.VIEWER),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpanel_types: DEFAULT_PANELS,\n\t\t\t\t\tcurrent_panel_index: DEFAULT_PANELS.indexOf(PanelType.PARAMS),\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tpanel_types: DEFAULT_PANELS,\n\t\t\tcurrent_panel_index: DEFAULT_PANELS.indexOf(PanelType.NETWORK),\n\t\t},\n\t],\n};\n\nimport {defineComponent, SetupContext, ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'MultiplePanel',\n\tcomponents: {\n\t\t// Asset,\n\t\tNetwork,\n\t\tParams,\n\t\t// ParamEdit,\n\t\tViewer,\n\t\tSpreadsheet,\n\t\t// CustomNodeEditor,\n\t\t// Performance: AsyncPerformance,\n\t},\n\tprops: {\n\t\tinit_properties: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn DEFAULT_LAYOUT;\n\t\t\t},\n\t\t},\n\t\tpanel_id: {\n\t\t\ttype: String,\n\t\t\tdefault: 'multi-root',\n\t\t},\n\t\tlevel: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tscene_update_allowed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(props: MultiplePanelProps, context: SetupContext) {\n\t\tconst tab_menu_label_padding = ref([0, 5]);\n\n\t\tconst element = ref<HTMLElement>(null);\n\t\tconst split_panel1 = ref<HTMLElement>(null);\n\t\tconst split_panel2 = ref<HTMLElement>(null);\n\t\tconst current_panel = ref<HTMLElement>(null);\n\n\t\tconst PanelsMixin = SetupMultiplePanelPanels(props, split_panel1, split_panel2);\n\n\t\tfunction init_properties_for_split_panels() {\n\t\t\treturn {\n\t\t\t\tpanel_types: PanelsMixin.panel_types.value,\n\t\t\t\tcurrent_panel_index: PanelsMixin.current_panel_index.value,\n\t\t\t\t// TODO: typescript check this\n\t\t\t\t// panel: current_panel.to_json(), //\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\telement,\n\t\t\tsplit_panel1,\n\t\t\tsplit_panel2,\n\t\t\tcurrent_panel,\n\t\t\ttab_menu_label_padding,\n\t\t\t...PanelsMixin,\n\t\t\t...SetupMultiplePanelJson(props, PanelsMixin),\n\t\t\t...SetupMultiplePanelSplit(props, context, element, PanelsMixin, init_properties_for_split_panels),\n\t\t};\n\t},\n});\n\n// # methods:\n// # \tviewers: ->\n// # \t\tif @is_split\n// # \t\t\tlodash_flatten [\n// # \t\t\t\tthis.$refs.split_panel0.viewers()\n// # \t\t\t\tthis.$refs.split_panel1.viewers()\n// # \t\t\t]\n// # \t\telse\n// # \t\t\tif @current_panel_type == 'Viewer'\n// # \t\t\t\treturn [this.$refs.current_panel]\n// # \t\t\telse\n// # \t\t\t\t[]\n\n// # \tpanel_with_id: (panel_id)->\n// # \t\tif panel_id.length == 0 && !@is_split\n// # \t\t\tthis.$refs.current_panel\n// # \t\telse\n// # \t\t\tif @is_split\n// # \t\t\t\tpanel = switch panel_id[0]\n// # \t\t\t\t\twhen 0 then this.$refs.split_panel0\n// # \t\t\t\t\twhen 1 then this.$refs.split_panel1\n\n// # \t\t\t\tpanel_id.shift()\n// # \t\t\t\tpanel.panel_with_id( panel_id )\n","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Network.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Network.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupCamera} from './mixins/Camera';\n// import {Clipboard} from './Mixins/Clipboard';\nimport {SetupEventKey} from './mixins/EventKey';\nimport {SetupEventMouse} from './mixins/EventMouse';\nimport {SetupJson} from './mixins/Json';\nimport {SetupNodeAnimation} from './mixins/NodeAnimation';\nimport {SetupNodeConnection} from './mixins/NodeConnection';\nimport {SetupNodeCreation} from './mixins/NodeCreation';\nimport {SetupNodeEvent} from './mixins/NodeEvent';\nimport {SetupNodeNavigation} from './mixins/NodeNavigation';\n// import NodeOwner from '../../Mixin/NodeOwner';\nimport {SetupNodeSelection} from './mixins/NodeSelection';\nimport {SetupTabMenu} from './mixins/TabMenuOwner';\n\n// components\nimport TabMenu from './components/TabMenu.vue';\n\nimport Node from './components/Node.vue';\nimport InterractiveConnection from './components/InterractiveConnection.vue';\n\nimport {NodeCreationHelper, NodeCreationData} from './helpers/NodeCreation';\nimport {CameraData, CameraAnimationHelper} from './helpers/CameraAnimation';\nimport {ClipBoardHelper} from './helpers/ClipBoard';\nimport {NodeAnimationHelper} from './helpers/NodeAnimation';\nimport {ConnectionHelper, ConnectionData} from './helpers/Connection';\nimport {NodeSelectionHelper, NodeSelectionData} from './helpers/NodeSelection';\nimport {StoreController} from '../../../store/controllers/StoreController';\n\nimport {defineComponent, Ref, ref, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'network-panel',\n\tcomponents: {TabMenu, Node, InterractiveConnection},\n\n\tsetup(props) {\n\t\tconst canvas = ref<HTMLCanvasElement>(null);\n\t\tconst nodes_container = ref<HTMLElement>(null);\n\n\t\tconst json_node = computed(() => {\n\t\t\treturn StoreController.editor.current_json_node();\n\t\t});\n\t\tconst json_children = computed(() => {\n\t\t\tconst id = StoreController.editor.current_node_graph_id();\n\t\t\tif (id) {\n\t\t\t\treturn StoreController.engine.json_children(id);\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t});\n\n\t\tconst node_creation_data = ref<NodeCreationData>({active: false, position: {x: 0, y: 0}});\n\t\tconst camera_data = ref<CameraData>({\n\t\t\tposition: {x: 0, y: 0},\n\t\t\tzoom: 0.5,\n\t\t});\n\t\tconst camera_history: Dictionary<CameraData> = {};\n\t\tconst connection_data = ref<ConnectionData>({\n\t\t\tnode_src_id: null,\n\t\t\tnode_dest_id: null,\n\t\t\toutput_index: 0,\n\t\t\tinput_index: 0,\n\t\t\tmouse_start: {x: 0, y: 0},\n\t\t\tmouse_progress: {x: 0, y: 0},\n\t\t\tactive: false,\n\t\t});\n\t\tconst node_selection_data = ref<NodeSelectionData>({\n\t\t\tstart: {x: 0, y: 0},\n\t\t\tend: {x: 0, y: 0},\n\t\t\tactive: false,\n\t\t});\n\n\t\tconst cam_animation_helper: CameraAnimationHelper = new CameraAnimationHelper(camera_data.value);\n\t\tconst clipboard_helper = new ClipBoardHelper();\n\t\tconst node_creation_helper = new NodeCreationHelper(node_creation_data.value, camera_data.value);\n\t\tconst node_animation_helper = new NodeAnimationHelper(camera_data.value);\n\t\tconst connection_helper = new ConnectionHelper(connection_data.value, camera_data.value);\n\t\tconst node_selection_helper = new NodeSelectionHelper(node_selection_data.value, camera_data.value);\n\t\tconst helpers = {\n\t\t\tnode_animation_helper,\n\t\t\tconnection_helper,\n\t\t\tnode_selection_helper,\n\t\t\tcam_animation_helper,\n\t\t\tnode_creation_helper,\n\t\t};\n\n\t\tconst camera_options = SetupCamera(canvas, camera_data, camera_history, cam_animation_helper);\n\t\tconst tab_menu_options = SetupTabMenu(canvas, node_creation_helper);\n\t\tconst event_key_options = SetupEventKey(clipboard_helper, cam_animation_helper, tab_menu_options);\n\t\tconst options = {\n\t\t\tcamera_options,\n\t\t\ttab_menu_options,\n\t\t\tevent_key_options,\n\t\t};\n\t\tconst event_mouse_options = SetupEventMouse(helpers, options);\n\n\t\tconst action_in_progress: Readonly<Ref<boolean>> = computed(() => {\n\t\t\treturn node_selection_data.value.active || connection_data.value.active;\n\t\t});\n\t\t// TODO typescript: ensure all EventHelper are set, or have only 1\n\n\t\treturn {\n\t\t\tcanvas,\n\t\t\tnodes_container,\n\t\t\tconnection_data,\n\t\t\tjson_node,\n\t\t\tjson_children,\n\t\t\taction_in_progress,\n\t\t\t...camera_options,\n\t\t\t...event_key_options,\n\t\t\t...event_mouse_options,\n\t\t\t...SetupJson(camera_data.value, camera_history),\n\t\t\t...SetupNodeAnimation(node_animation_helper, nodes_container),\n\t\t\t...SetupNodeConnection(connection_data.value, connection_helper, nodes_container),\n\t\t\t...SetupNodeCreation(nodes_container, node_creation_helper),\n\t\t\t...SetupNodeEvent(helpers),\n\t\t\t...SetupNodeNavigation(),\n\t\t\t...SetupNodeSelection(node_selection_data.value, node_selection_helper, nodes_container),\n\t\t\t...tab_menu_options,\n\t\t};\n\t},\n\t// mixins: [\n\t// \tCamera,\n\t// \tClipboard,\n\t// \tEventKey,\n\t// \tEventMouse,\n\t// \tJson,\n\t// \tNodeAnimation,\n\t// \tNodeConnection,\n\t// \tNodeCreation,\n\t// \tNodeEvent,\n\t// \tNodeNavigation,\n\t// \tNodeOwner,\n\t// \tNodeSelection,\n\t// \tTabMenuOwner,\n\t// ],\n\t// components: {InterractiveConnection, Node},\n\n\t// computed: {\n\t// \taction_in_progress(): boolean {\n\t// \t\treturn this.selection.active || this.connection.active;\n\t// \t},\n\t// },\n});\n","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TabMenu.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TabMenu.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport lodash_includes from 'lodash/includes';\nimport lodash_values from 'lodash/values';\nimport lodash_flatten from 'lodash/flatten';\n\n// TODO: if I open the tab menu, but move the cursor away from it\n// it will not receive key events\n\n// internal libs\n\n// mixins\n// import NodeOwner from 'src/Editor/Component/Mixin/NodeOwner';\n\n// components\nimport {DropDownMenuEntry} from 'src/editor/components/types/props';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {POLY} from 'src/engine/Poly';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {KeyEventsDispatcher} from 'src/editor/helpers/KeyEventsDispatcher';\n\nimport {defineComponent, ref, onMounted, onBeforeUnmount, computed, SetupContext} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'tab-menu',\n\t// mixins: [NodeOwner],\n\n\tsetup(props, context: SetupContext) {\n\t\tconst filter = ref('');\n\n\t\tonMounted(() => {\n\t\t\tregister_key_processor();\n\t\t});\n\t\tonBeforeUnmount(() => {\n\t\t\tderegister_key_processor();\n\t\t});\n\n\t\tconst current_node_graph_id = computed(() => StoreController.editor.current_node_graph_id());\n\n\t\t// computed\n\t\tconst menu_entries = computed(() => {\n\t\t\tif (!current_node_graph_id.value) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tlet entries = compute_menu_entries();\n\n\t\t\tif (entries.length === 0) {\n\t\t\t\ttrim_filter();\n\t\t\t\tentries = compute_menu_entries();\n\t\t\t}\n\n\t\t\treturn entries;\n\t\t});\n\n\t\tconst filter_empty = computed(() => {\n\t\t\treturn filter.value == null || filter.value === '';\n\t\t});\n\n\t\t// functions\n\t\tfunction register_key_processor() {\n\t\t\t// window.key_events_dispatcher.register_processor(this)\n\t\t\tKeyEventsDispatcher.instance().deactivate();\n\t\t\tdocument.addEventListener('keypress', _on_keypress);\n\t\t\tdocument.addEventListener('keydown', _on_keydown);\n\t\t\tdocument.addEventListener('keyup', _on_keyup);\n\t\t}\n\t\tfunction deregister_key_processor() {\n\t\t\t// window.key_events_dispatcher.deregister_processor(this)\n\t\t\tdocument.removeEventListener('keypress', _on_keypress);\n\t\t\tdocument.removeEventListener('keydown', _on_keydown);\n\t\t\tdocument.removeEventListener('keyup', _on_keyup);\n\t\t\tKeyEventsDispatcher.instance().activate();\n\t\t}\n\n\t\tfunction _on_keypress(event: KeyboardEvent) {\n\t\t\tadd_to_filter(event.key);\n\t\t\treturn true;\n\t\t}\n\n\t\tfunction _on_keydown(event: KeyboardEvent) {\n\t\t\tlet key_processed = true;\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'Tab':\n\t\t\t\t\tclose();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tkey_processed = false;\n\t\t\t}\n\t\t\treturn key_processed;\n\t\t}\n\n\t\tfunction _on_keyup(event: KeyboardEvent) {\n\t\t\tlet key_processed = true;\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'Backspace':\n\t\t\t\t\ttrim_filter();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Escape':\n\t\t\t\t\tclose();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tkey_processed = false;\n\t\t\t}\n\t\t\treturn key_processed;\n\t\t}\n\n\t\tfunction add_to_filter(letter: string) {\n\t\t\tfilter.value += letter;\n\t\t}\n\t\tfunction trim_filter() {\n\t\t\tfilter.value = filter.value.slice(0, filter.value.length - 1);\n\t\t}\n\t\tfunction close() {\n\t\t\tcontext.emit('close');\n\t\t}\n\n\t\tfunction on_select(entry_id: string) {\n\t\t\tcontext.emit('select', entry_id);\n\t\t\tclose();\n\t\t}\n\n\t\tfunction tab_menu_entries(context: NodeContext, parent_node_type: string) {\n\t\t\tconst nodes_by_category: Dictionary<string[]> = {};\n\t\t\tPOLY.nodes_register\n\t\t\t\t.registered_nodes_for_context_and_parent_type(context, parent_node_type)\n\t\t\t\t.forEach((node) => {\n\t\t\t\t\tconst category = POLY.nodes_register.registered_category(context, node.type());\n\t\t\t\t\tnodes_by_category[category] = nodes_by_category[category] || [];\n\t\t\t\t\tnodes_by_category[category].push(node.type());\n\t\t\t\t});\n\t\t\treturn nodes_by_category;\n\t\t}\n\t\tfunction compute_menu_entries(): DropDownMenuEntry[] {\n\t\t\t// const available_children_classes = this.node.available_children_classes();\n\t\t\tconst node = StoreController.editor.current_node();\n\t\t\tif (!node.children_allowed() || !node.children_controller) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst registered_entries = tab_menu_entries(node.children_controller.context, node.type);\n\n\t\t\tif (filter_empty.value) {\n\t\t\t\tconst all_entries: DropDownMenuEntry[] = [];\n\t\t\t\tObject.keys(registered_entries).forEach(function(category) {\n\t\t\t\t\tconst children = registered_entries[category]\n\t\t\t\t\t\t.sort()\n\t\t\t\t\t\t.map((sub_entry) => ({id: sub_entry, label: sub_entry}));\n\t\t\t\t\tall_entries.push({id: category, label: category, children});\n\t\t\t\t});\n\t\t\t\treturn all_entries;\n\t\t\t} else {\n\t\t\t\tconst filter_lowercase = filter.value.toLowerCase();\n\t\t\t\tconst all_types = lodash_flatten(lodash_values(registered_entries));\n\t\t\t\tconst filtered_types = all_types.filter((type) => {\n\t\t\t\t\treturn lodash_includes(type, filter_lowercase);\n\t\t\t\t});\n\t\t\t\treturn filtered_types.map((entry) => ({id: entry, label: entry}));\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tmenu_entries,\n\t\t\tfilter,\n\t\t\ton_select,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TabMenu.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"e219d55e\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TabMenu.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TabMenu.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Node.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Node.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// internal lib\nimport {Constants} from '../helpers/Constants';\n\n// mixins\nimport {SetupCapture} from './nodes/mixins/Capture';\nimport {SetupChildrenOwner} from './nodes/mixins/ChildrenOwner';\nimport {SetupCommentable} from './nodes/mixins/Commentable';\nimport {SetupContextMenu} from './nodes/mixins/ContextMenu';\nimport {SetupBypassFlag} from './nodes/mixins/BypassFlag';\nimport {SetupDisplayFlag} from './nodes/mixins/DisplayFlag';\nimport {SetupErrored} from './nodes/mixins/Errored';\nimport {SetupEventMouse} from './nodes/mixins/EventMouse';\n// import {SetupEventKey} from './nodes/mixins/EventKey'\nimport {SetupIcon} from './nodes/mixins/Icon';\nimport {SetupInfos} from './nodes/mixins/Infos';\nimport {SetupInputs} from './nodes/mixins/Inputs';\nimport {SetupNamed} from './nodes/mixins/Named';\nimport {SetupOutputs} from './nodes/mixins/Outputs';\nimport {SetupPosition} from './nodes/mixins/Position';\nimport {SetupSelection} from './nodes/mixins/Selection';\n\n// components\nimport Connection from './Connection.vue';\nimport NodeInfo from './NodeInfo.vue';\n\ninterface NodeProps {\n\tjson_node: EngineNodeData;\n\tjson_parent: EngineNodeData;\n\taction_in_progress: boolean;\n}\n\nimport {defineComponent, computed, SetupContext} from '@vue/composition-api';\nimport {EngineNodeData} from '../../../../store/modules/Engine';\nimport {StoreController} from '../../../../store/controllers/StoreController';\nexport default defineComponent({\n\tname: 'network_node',\n\tcomponents: {Connection, NodeInfo},\n\tprops: {\n\t\tjson_node: {\n\t\t\ttype: Object,\n\t\t},\n\t\tjson_parent: {\n\t\t\ttype: Object,\n\t\t},\n\t\taction_in_progress: Boolean,\n\t},\n\n\tsetup(props: NodeProps, context: SetupContext) {\n\t\tconst node = StoreController.engine.node(props.json_node.graph_node_id);\n\n\t\tconst graph_node_id = computed(() => props.json_node.graph_node_id);\n\t\tconst layout_vertical = computed(() => {\n\t\t\treturn node?.ui_data.is_layout_vertical() || false;\n\t\t});\n\t\tconst style_object = computed(() => {\n\t\t\t// const pointer_events = this.selection_in_progress ? 'none' : 'auto';\n\t\t\treturn {\n\t\t\t\tleft: `${props.json_node.ui_data_json.x}px`,\n\t\t\t\ttop: `${props.json_node.ui_data_json.y}px`,\n\t\t\t\t// pointerEvents: pointer_events,\n\t\t\t};\n\t\t});\n\t\tconst body_size = computed(() => {\n\t\t\treturn {\n\t\t\t\tx: node?.ui_data.width() || 100,\n\t\t\t\ty: Constants.NODE_UNIT,\n\t\t\t};\n\t\t});\n\n\t\tconst bypass_options = SetupBypassFlag(props.json_node, body_size);\n\t\tconst position_options = SetupPosition(props.json_node);\n\t\tconst selection_options = SetupSelection(props.json_node, props.json_parent);\n\t\tconst capture_options = SetupCapture(props.json_node, context);\n\t\tconst infos_options = SetupInfos();\n\n\t\tconst class_object = computed(() => {\n\t\t\treturn {\n\t\t\t\tselected: selection_options.is_selected.value,\n\t\t\t\tis_being_moved: position_options.is_being_moved.value,\n\t\t\t\tbypassed: bypass_options.is_bypassed.value,\n\t\t\t\tlayout_horizontal: !layout_vertical.value,\n\t\t\t};\n\t\t});\n\n\t\tconst node_body_style_object = computed(() => {\n\t\t\treturn {\n\t\t\t\tleft: `${-0.5 * (node?.ui_data.width() || 0)}px`,\n\t\t\t\ttop: `${-0.5 * Constants.NODE_HEIGHT}px`,\n\t\t\t\twidth: `${body_size.value.x}px`,\n\t\t\t\theight: `${body_size.value.y}px`,\n\t\t\t\t// backgroundColor: Color.to_css(this.ui_data.color()),\n\t\t\t\tborderRadius: 3, //`${this.ui_data.border_radius()}px`\n\t\t\t};\n\t\t});\n\n\t\treturn {\n\t\t\tlayout_vertical,\n\t\t\tstyle_object,\n\t\t\tclass_object,\n\t\t\tnode_body_style_object,\n\t\t\tgraph_node_id,\n\t\t\t// mixins\n\t\t\t...bypass_options,\n\t\t\t...SetupChildrenOwner(props.json_node, body_size, layout_vertical),\n\t\t\t...SetupContextMenu(props.json_node),\n\t\t\t...SetupCommentable(props.json_node, body_size, layout_vertical),\n\t\t\t...SetupContextMenu(props.json_node),\n\t\t\t...SetupDisplayFlag(props.json_node, body_size),\n\t\t\t...SetupErrored(props.json_node, body_size),\n\t\t\t...SetupEventMouse(props.json_node, context, capture_options, infos_options),\n\t\t\t...SetupIcon(props.json_node),\n\t\t\t...infos_options,\n\t\t\t...SetupInputs(props.json_node, body_size, layout_vertical),\n\t\t\t...SetupNamed(props.json_node, body_size, layout_vertical),\n\t\t\t...SetupOutputs(props.json_node, body_size, layout_vertical),\n\t\t\t...position_options,\n\t\t\t...selection_options,\n\t\t};\n\t},\n});\n","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Connection.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Connection.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# third party lib\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Box2} from 'three/src/math/Box2';\n\nimport {Constants} from '../helpers/Constants';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\ninterface ConnectionProps {\n\tsrc_json_node: EngineNodeData;\n\tdest_json_node: EngineNodeData;\n\tinput_index: number;\n\toutput_index: number;\n}\n\nimport {StoreController} from '../../../../store/controllers/StoreController';\nimport {EngineNodeData} from '../../../../store/modules/Engine';\nimport {defineComponent, computed, Ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'network_node_connection',\n\n\tprops: {\n\t\tsrc_json_node: {},\n\t\tdest_json_node: {},\n\t\tinput_index: Number,\n\t\toutput_index: Number,\n\t},\n\n\tsetup(props: ConnectionProps) {\n\t\tconst src_node = StoreController.engine.node(props.src_json_node.graph_node_id)!;\n\t\tconst dest_node = StoreController.engine.node(props.dest_json_node.graph_node_id)!;\n\n\t\tconst is_src_not_cloned: Readonly<Ref<boolean>> = computed(() => {\n\t\t\treturn !props.dest_json_node.inputs_clonable_state_with_override[props.input_index];\n\t\t});\n\t\tconst layout_vertical: Readonly<Ref<boolean>> = computed(() => {\n\t\t\treturn src_node.ui_data.is_layout_vertical();\n\t\t});\n\t\tconst src_node_pos_v = new Vector2();\n\t\tconst dest_node_pos_v = new Vector2();\n\t\tconst src_node_pos = computed(() => {\n\t\t\tsrc_node_pos_v.set(props.src_json_node.ui_data_json.x, props.src_json_node.ui_data_json.y);\n\t\t\treturn src_node_pos_v;\n\t\t});\n\t\tconst dest_node_pos = computed(() => {\n\t\t\tdest_node_pos_v.set(props.dest_json_node.ui_data_json.x, props.dest_json_node.ui_data_json.y);\n\t\t\treturn dest_node_pos_v;\n\t\t});\n\t\t// const src_node_box_in_place = computed(() => node_box_in_place(src_node));\n\t\t// const dest_node_box_in_place = computed(() => node_box_in_place(dest_node));\n\t\tconst src_node_height = computed(() => node_height(src_node));\n\t\tconst dest_node_height = computed(() => node_height(dest_node));\n\t\t// src_node_width(){ return node_width(src_node) },\n\t\t// dest_node_width(){ return node_width(dest_node) },\n\t\tconst src_node_box = computed(() => node_box(props.src_json_node));\n\t\tconst dest_node_box = computed(() => node_box(props.dest_json_node));\n\t\tconst dest_node_inputs_count = computed(() => dest_node.io.inputs.max_inputs_count);\n\t\tconst dest_node_width = computed(() => dest_node.ui_data.width());\n\n\t\tconst src_node_box_clone = new Box2();\n\t\tconst svg_bounds = computed(() => {\n\t\t\tsrc_node_box_clone.copy(src_node_box.value);\n\t\t\tsrc_node_box_clone.union(dest_node_box.value);\n\t\t\treturn src_node_box_clone;\n\t\t});\n\n\t\tconst src_node_pos_clone = new Vector2();\n\t\tconst src_node_delta = new Vector2();\n\t\tconst src_position = computed(() => {\n\t\t\tif (props.src_json_node) {\n\t\t\t\tsrc_node_pos_clone.copy(src_node_pos.value).sub(svg_bounds.value.min);\n\t\t\t\tsrc_node_delta.copy(src_node_pos_clone);\n\n\t\t\t\tif (layout_vertical.value) {\n\t\t\t\t\tconst connection_pos = new Vector2(\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0.5 * src_node_height.value +\n\t\t\t\t\t\t\tConstants.CONNECTION_VERTICAL_MARGIN -\n\t\t\t\t\t\t\t2 * Constants.CONNECTION_VERTICAL_MARGIN\n\t\t\t\t\t);\n\t\t\t\t\treturn src_node_delta.add(connection_pos);\n\t\t\t\t} else {\n\t\t\t\t\tconst connection_pos = new Vector2(\n\t\t\t\t\t\t0.5 * dest_node_width.value + Constants.CONNECTION_VERTICAL_MARGIN,\n\t\t\t\t\t\t-0.5 * Constants.NODE_HEIGHT +\n\t\t\t\t\t\t\tConstants.CONNECTION_VERTICAL_START +\n\t\t\t\t\t\t\tprops.output_index * Constants.CONNECTION_VERTICAL_SPACING\n\t\t\t\t\t);\n\t\t\t\t\treturn src_node_delta.add(connection_pos);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconst dest_node_pos_clone = new Vector2();\n\t\tconst dest_node_delta = new Vector2();\n\t\tconst dest_position = computed(() => {\n\t\t\tif (props.dest_json_node) {\n\t\t\t\tdest_node_pos_clone.copy(dest_node_pos.value).sub(svg_bounds.value.min);\n\t\t\t\tdest_node_delta.copy(dest_node_pos_clone);\n\t\t\t\tif (layout_vertical.value) {\n\t\t\t\t\tlet connection_x = 0;\n\t\t\t\t\tif (dest_node_inputs_count.value > 0) {\n\t\t\t\t\t\tconst interval_size = dest_node_width.value / (dest_node_inputs_count.value + 1);\n\t\t\t\t\t\tconnection_x = -0.5 * dest_node_width.value + (props.input_index + 1) * interval_size;\n\t\t\t\t\t}\n\t\t\t\t\tconst connection_pos = new Vector2(\n\t\t\t\t\t\tconnection_x,\n\t\t\t\t\t\t-0.5 * dest_node_height.value + Constants.CONNECTION_VERTICAL_MARGIN\n\t\t\t\t\t);\n\t\t\t\t\treturn dest_node_delta.add(connection_pos);\n\t\t\t\t} else {\n\t\t\t\t\tconst connection_pos = new Vector2(\n\t\t\t\t\t\t-0.5 * dest_node_width.value - Constants.CONNECTION_VERTICAL_MARGIN,\n\t\t\t\t\t\t-0.5 * Constants.NODE_HEIGHT +\n\t\t\t\t\t\t\tConstants.CONNECTION_VERTICAL_START +\n\t\t\t\t\t\t\tprops.input_index * Constants.CONNECTION_VERTICAL_SPACING\n\t\t\t\t\t);\n\t\t\t\t\treturn dest_node_delta.add(connection_pos);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t// delta(){\n\t\t// \treturn {\n\t\t// \t\tx: (src_position.x - dest_position.x),\n\t\t// \t\ty: (src_position.y - dest_position.y)\n\t\t// \t}\n\t\t// },\n\t\t// size(){\n\t\t// \treturn {\n\t\t// \t\tx: Math.abs(delta.x),\n\t\t// \t\ty: Math.abs(delta.y)\n\t\t// \t}\n\t\t// },\n\t\t// svg_src_point(){\n\t\t// \treturn {\n\t\t// \t\tx: 0.5*Constants.NODE_UNIT + (delta.x < 0 ? delta.x : 0),\n\t\t// \t\ty: -6+(delta.y < 0 ? delta.y : 0),\n\t\t// \t}\n\t\t// },\n\t\t// line_src_point(){\n\t\t// \treturn {\n\t\t// \t\tx: PADDING+(delta.x < 0 ? 0 : size.x),\n\t\t// \t\ty: PADDING+(delta.y < 0 ? 0 : size.y),\n\t\t// \t}\n\t\t// },\n\t\tconst svg_bound_min = new Vector2();\n\t\tconst svg_style_object = computed(() => {\n\t\t\tconst size = new Vector2();\n\t\t\tsvg_bounds.value.getSize(size);\n\t\t\tsvg_bound_min.copy(svg_bounds.value.min);\n\t\t\tsvg_bound_min.x -= props.dest_json_node.ui_data_json.x;\n\t\t\tsvg_bound_min.y -= props.dest_json_node.ui_data_json.y;\n\t\t\treturn {\n\t\t\t\tleft: `${svg_bound_min.x}px`,\n\t\t\t\ttop: `${svg_bound_min.y}px`,\n\t\t\t\twidth: `${size.x}px`,\n\t\t\t\theight: `${size.y}px`,\n\t\t\t};\n\t\t});\n\t\tconst line_class_object = computed(() => {\n\t\t\tconst obj: Dictionary<boolean> = {};\n\t\t\tif (dest_node.io.inputs.has_named_inputs) {\n\t\t\t\tconst named_input_connection = props.src_json_node.named_output_connections[props.output_index];\n\t\t\t\tconst named_output_connection = props.dest_json_node.named_input_connections[props.input_index];\n\t\t\t\tif (named_input_connection.type != named_output_connection.type) {\n\t\t\t\t\treturn {mismatched_types: true};\n\t\t\t\t} else {\n\t\t\t\t\tobj[named_input_connection.type] = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (is_src_not_cloned) {\n\t\t\t\tobj['is_src_not_cloned'] = true;\n\t\t\t}\n\n\t\t\treturn obj;\n\t\t});\n\n\t\t// functions\n\t\tfunction node_from_json(json: EngineNodeData): BaseNodeType {\n\t\t\treturn StoreController.engine.node(json.graph_node_id)!;\n\t\t}\n\t\tfunction node_box_in_place(node: BaseNodeType): Box2 {\n\t\t\tconst ui_data = node.ui_data;\n\t\t\tconst width = ui_data.width();\n\t\t\tlet connections_height = 0;\n\t\t\tif (!layout_vertical.value) {\n\t\t\t\tconst max_outputs_count = Math.max(\n\t\t\t\t\tnode.io.inputs.named_input_connection_points.length,\n\t\t\t\t\tnode.io.outputs.named_output_connection_points.length\n\t\t\t\t);\n\t\t\t\tconnections_height =\n\t\t\t\t\tConstants.CONNECTION_VERTICAL_START + max_outputs_count * Constants.CONNECTION_VERTICAL_SPACING;\n\t\t\t}\n\t\t\tconst node_height = Math.max(Constants.NODE_HEIGHT, connections_height);\n\t\t\tconst delta = new Vector2(\n\t\t\t\t0.5 * width + 2 * Constants.CONNECTION_VERTICAL_MARGIN,\n\t\t\t\t0.5 * node_height + 2 * Constants.CONNECTION_VERTICAL_MARGIN\n\t\t\t);\n\t\t\treturn new Box2(delta.clone().multiplyScalar(-1), delta);\n\t\t}\n\t\tfunction node_height(node: BaseNodeType): number {\n\t\t\tconst box = node_box_in_place(node);\n\t\t\tconst size = new Vector2();\n\t\t\tbox.getSize(size);\n\t\t\treturn size.y;\n\t\t}\n\t\t// function node_width(node: BaseNodeType): number {\n\t\t// \tconst box = node_box_in_place(node);\n\t\t// \tconst size = new Vector2();\n\t\t// \tbox.getSize(size);\n\t\t// \treturn size.x;\n\t\t// }\n\t\tconst node_box_v = new Vector2();\n\t\tfunction node_box(json_node: EngineNodeData): Box2 {\n\t\t\tconst node = node_from_json(json_node);\n\t\t\tnode_box_v.x = json_node.ui_data_json.x;\n\t\t\tnode_box_v.y = json_node.ui_data_json.y;\n\t\t\treturn node_box_in_place(node).translate(node_box_v);\n\t\t}\n\n\t\treturn {\n\t\t\tsvg_style_object,\n\t\t\tline_class_object,\n\t\t\tsrc_position,\n\t\t\tdest_position,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Connection.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5c7c8dcb\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Connection.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Connection.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeInfo.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeInfo.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// libs\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\n// node\nimport {CacheSopNode} from 'src/engine/nodes/sop/Cache';\nimport {ParticlesSystemGpuSopNode} from 'src/engine/nodes/sop/ParticlesSystemGpu';\n\n// components\nimport NodeInfoSop from './nodes/node_infos/Sop.vue';\nimport NodeInfoMat from './nodes/node_infos/Mat.vue';\nimport NodeInfoGl from './nodes/node_infos/Gl.vue';\nimport NodeInfoCop from './nodes/node_infos/Cop.vue';\nimport NodeInfoSopCache from './nodes/node_infos/SopCache.vue';\nimport NodeInfoSopParticlesSystemGPU from './nodes/node_infos/SopParticlesSystemGPU.vue';\n\nconst COMPONENTS_BY_NODE_CONTEXT: Map<NodeContext, any> = new Map();\nCOMPONENTS_BY_NODE_CONTEXT.set(NodeContext.SOP, NodeInfoSop);\nCOMPONENTS_BY_NODE_CONTEXT.set(NodeContext.MAT, NodeInfoMat);\nCOMPONENTS_BY_NODE_CONTEXT.set(NodeContext.GL, NodeInfoGl);\nCOMPONENTS_BY_NODE_CONTEXT.set(NodeContext.COP, NodeInfoCop);\n\nconst COMPONENTS_BY_NODE_CONTEXT_AND_TYPE: Map<NodeContext, Map<string, any>> = new Map([\n\t[\n\t\tNodeContext.SOP,\n\t\tnew Map<string, any>([\n\t\t\t[CacheSopNode.type(), NodeInfoSopCache],\n\t\t\t[ParticlesSystemGpuSopNode.type(), NodeInfoSopParticlesSystemGPU],\n\t\t]),\n\t],\n]);\n\n// COMPONENTS_BY_NODE_CONTEXT_AND_TYPE[NodeContext.MAT] = {}\n// COMPONENTS_BY_NODE_CONTEXT_AND_TYPE[NodeContext.MAT][ShaderBuilder.type()] = NodeInfoMatShaderBuilder\nimport {StoreController} from '../../../../store/controllers/StoreController';\nimport {NodeSetNameCommand} from '../../../../history/commands/NodeSetName';\n\nimport {defineComponent, ref, computed, onMounted} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'network_node_info',\n\tcomponents: {NodeInfoSop},\n\tprops: {\n\t\tgraph_node_id: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tsetup(props) {\n\t\tconst node = StoreController.engine.node(props.graph_node_id);\n\n\t\tconst time_dependent = ref(false);\n\t\tconst error_message = ref<string | undefined>(undefined);\n\t\tconst scene_predecessor_paths = ref<string[]>([]);\n\t\tconst scene_successor_paths = ref<string[]>([]);\n\t\tconst node_by_path: Map<string, BaseNodeType> = new Map();\n\n\t\tconst node_name = computed(() => node?.name);\n\n\t\tonMounted(() => {\n\t\t\tcompute_node();\n\t\t});\n\n\t\tconst time_dependency_label = computed(() => {\n\t\t\treturn 'time dependent: ' + (time_dependent.value ? 'YES' : 'NO');\n\t\t});\n\t\tconst time_dependency_class_object = computed(() => {\n\t\t\treturn {time_dependent: time_dependent.value};\n\t\t});\n\t\tconst current_node_info_type = computed(() => {\n\t\t\tif (node) {\n\t\t\t\tlet component;\n\t\t\t\tlet components_for_context = COMPONENTS_BY_NODE_CONTEXT_AND_TYPE.get(node.node_context());\n\t\t\t\tif (components_for_context) {\n\t\t\t\t\tcomponent = components_for_context.get(node.type);\n\t\t\t\t}\n\t\t\t\tif (!component) {\n\t\t\t\t\tcomponent = COMPONENTS_BY_NODE_CONTEXT.get(node.node_context());\n\t\t\t\t}\n\t\t\t\treturn component;\n\t\t\t}\n\t\t});\n\n\t\tasync function compute_node() {\n\t\t\tif (!node) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// if (node.cook) {\n\t\t\t// gl nodes don't have that\n\t\t\tawait node.request_container();\n\t\t\t// }\n\n\t\t\ttime_dependent.value = node.states.time_dependent.active;\n\t\t\terror_message.value = node.states.error.message;\n\n\t\t\tconst scene_predecessors = node.dependencies_controller.scene_predecessors();\n\t\t\tconst scene_successors = node.dependencies_controller.scene_successors();\n\t\t\tnode_by_path.clear();\n\t\t\tscene_predecessor_paths.value = get_full_or_direct_paths(scene_predecessors);\n\t\t\tscene_successor_paths.value = get_full_or_direct_paths(scene_successors);\n\t\t}\n\t\tfunction get_full_or_direct_paths(nodes: BaseNodeType[]): string[] {\n\t\t\tif (!props.graph_node_id) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tconst current_node = StoreController.engine.node(props.graph_node_id) as BaseNodeType;\n\t\t\treturn nodes\n\t\t\t\t.map((node) => {\n\t\t\t\t\tconst has_same_parent = node.parent?.graph_node_id == current_node.parent?.graph_node_id;\n\t\t\t\t\tconst relative_path = './' + node.name;\n\t\t\t\t\tconst absolute_path = node.full_path();\n\t\t\t\t\tconst path = has_same_parent ? relative_path : absolute_path;\n\n\t\t\t\t\tnode_by_path.set(path, node);\n\t\t\t\t\treturn path;\n\t\t\t\t})\n\t\t\t\t.sort();\n\t\t}\n\t\tfunction go_to_node_path(node_path: string) {\n\t\t\tconst node = node_by_path.get(node_path);\n\t\t\tif (node) {\n\t\t\t\tStoreController.editor.set_current_node(node);\n\t\t\t}\n\t\t}\n\t\tasync function on_name_click() {\n\t\t\tconst current_node = StoreController.engine.node(props.graph_node_id) as BaseNodeType;\n\t\t\tif (!current_node) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst new_name: string = await StoreController.editor.dialog_prompt.show({\n\t\t\t\ttitle: 'Rename Node:',\n\t\t\t\tdefault_value: current_node.name,\n\t\t\t\tconfirm_label: 'Update Name',\n\t\t\t});\n\t\t\tif (new_name != null && new_name.length > 0) {\n\t\t\t\tconst cmd = new NodeSetNameCommand(current_node, new_name);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tnode_name,\n\t\t\ttime_dependent,\n\t\t\terror_message,\n\t\t\tscene_predecessor_paths,\n\t\t\tscene_successor_paths,\n\t\t\tnode_by_path,\n\t\t\ttime_dependency_label,\n\t\t\ttime_dependency_class_object,\n\t\t\tcurrent_node_info_type,\n\n\t\t\t// functions\n\t\t\tgo_to_node_path,\n\t\t\ton_name_click,\n\t\t};\n\t},\n});\n","import mod from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sop.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sop.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// import {Object3D} from 'three/src/core/Object3D';\n\n// third party lib\n// import lodash_flatten from 'lodash/flatten';\n// import lodash_uniq from 'lodash/uniq';\n// import PrintTree from 'print-tree'\n\nimport {CoreConstant} from 'src/core/geometry/Constant';\nimport {BaseSopNodeType} from 'src/engine/nodes/sop/_Base';\nimport {StoreController} from '../../../../../../store/controllers/StoreController';\nimport {CoreGroup} from '../../../../../../../core/geometry/Group';\n\nimport {defineComponent, ref, onMounted, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'network_node_info_sop',\n\tprops: {\n\t\tgraph_node_id: null,\n\t},\n\n\tsetup(props) {\n\t\tconst node = StoreController.engine.node(props.graph_node_id)! as BaseSopNodeType;\n\n\t\tconst objects_count = ref(0);\n\t\tconst objects_visible_count = ref(0);\n\t\tconst objects_count_by_type = ref<Dictionary<number>>({});\n\t\tconst objects_names_by_type = ref<Dictionary<string[]>>({});\n\t\t// const objects_names = ref<string[]>([]);\n\t\tconst vertex_attribute_sizes_by_name = ref<Dictionary<number>>({});\n\t\tconst vertex_attribute_types_by_name = ref<Dictionary<number>>({});\n\t\tconst points_count = ref(0);\n\t\tconst center = ref<Number3>([0, 0, 0]);\n\t\tconst size = ref<Number3>([0, 0, 0]);\n\t\tconst min = ref<Number3>([0, 0, 0]);\n\t\tconst max = ref<Number3>([0, 0, 0]);\n\n\t\tconst table_props = computed(() => {\n\t\t\treturn {\n\t\t\t\tcenter: center.value,\n\t\t\t\tsize: size.value,\n\t\t\t\tmin: min.value,\n\t\t\t\tmax: max.value,\n\t\t\t};\n\t\t});\n\t\tconst table_prop_names = computed(() => {\n\t\t\treturn ['center', 'size', 'min', 'max'];\n\t\t});\n\t\tconst objects_count_visible_class_object = computed(() => {\n\t\t\treturn {\n\t\t\t\thighlighted: objects_count.value != objects_visible_count.value,\n\t\t\t};\n\t\t});\n\t\tconst object_types = computed(() => {\n\t\t\treturn Object.keys(objects_count_by_type.value).sort();\n\t\t});\n\t\tconst vertex_attribute_names = computed(() => {\n\t\t\treturn Object.keys(vertex_attribute_sizes_by_name.value).sort();\n\t\t});\n\t\tconst vertex_class_objects_by_name = computed(() => {\n\t\t\tconst h: Dictionary<Dictionary<boolean>> = {};\n\t\t\tfor (let name of Object.keys(vertex_attribute_sizes_by_name.value)) {\n\t\t\t\tconst type = vertex_attribute_types_by_name.value[name];\n\t\t\t\tconst is_string = type == CoreConstant.ATTRIB_TYPE.STRING;\n\t\t\t\tlet class_name = is_string ? 'string' : 'numeric';\n\t\t\t\tconst class_object: Dictionary<boolean> = {};\n\t\t\t\tclass_object[class_name] = true;\n\t\t\t\th[name] = class_object;\n\t\t\t}\n\t\t\treturn h;\n\t\t});\n\t\tconst vertex_human_labels_by_name = computed(() => {\n\t\t\tconst h: Dictionary<string> = {};\n\t\t\tfor (let name of Object.keys(vertex_attribute_sizes_by_name.value)) {\n\t\t\t\tconst type = vertex_attribute_types_by_name.value[name];\n\t\t\t\tconst is_string = type == CoreConstant.ATTRIB_TYPE.STRING;\n\t\t\t\tlet label = is_string ? 'string' : `${vertex_attribute_sizes_by_name.value[name]}f`;\n\t\t\t\th[name] = label;\n\t\t\t}\n\n\t\t\treturn h;\n\t\t});\n\n\t\tonMounted(() => {\n\t\t\tcompute_node();\n\t\t});\n\n\t\tasync function compute_node() {\n\t\t\tconst container = await node.request_container();\n\n\t\t\tconst core_group = container.core_content(); //.group({clone: false})\n\t\t\tif (!core_group) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t_print_tree(core_group);\n\n\t\t\tconsole.log(core_group.objects());\n\n\t\t\tobjects_count.value = container.objects_count();\n\t\t\tobjects_visible_count.value = container.objects_visible_count();\n\t\t\tobjects_count_by_type.value = container.objects_count_by_type();\n\t\t\tobjects_names_by_type.value = container.objects_names_by_type();\n\t\t\t// const object_names: string[] = [];\n\t\t\t// for (let type of Object.keys(objects_names_by_type.value)) {\n\t\t\t// \tobject_names.value.push(objects_names_by_type.value[type]);\n\t\t\t// }\n\t\t\t// Vue.set(this, 'objects_names', lodash_uniq(lodash_flatten(object_names)));\n\n\t\t\tpoints_count.value = container.points_count();\n\n\t\t\tvertex_attribute_sizes_by_name.value = container.vertex_attribute_sizes_by_name();\n\t\t\tvertex_attribute_types_by_name.value = container.vertex_attribute_types_by_name();\n\n\t\t\tcenter.value = container.center().toArray() as Number3;\n\t\t\tsize.value = container.size().toArray() as Number3;\n\t\t\tconst bbox = container.bounding_box();\n\t\t\tmin.value = bbox.min.toArray() as Number3;\n\t\t\tmax.value = bbox.max.toArray() as Number3;\n\t\t}\n\n\t\tfunction _print_tree(group: CoreGroup) {\n\t\t\t// const get_human_type = (node: Object3D) => {\n\t\t\t// \tconst human_type = CoreConstant.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[node.constructor.name];\n\t\t\t// \tif (human_type == null) {\n\t\t\t// \t\tconsole.warn('no known constructor name is CoreConstant');\n\t\t\t// \t\tconsole.warn(node.constructor.name);\n\t\t\t// \t}\n\t\t\t// \tconst elements = [];\n\t\t\t// \telements.push(human_type);\n\t\t\t// \telements.push(node.name);\n\t\t\t// \t// const has_animation = node.animations != null;\n\t\t\t// \t// if (has_animation) {\n\t\t\t// \t// \telements.push('has animation');\n\t\t\t// \t// }\n\t\t\t// \treturn elements.join(' - ');\n\t\t\t// };\n\t\t\t// const get_children = (node: any) => {\n\t\t\t// \treturn node.children;\n\t\t\t// };\n\t\t\t// group.objects().forEach((child) => {\n\t\t\t// \tPrintTree(child, get_human_type, get_children);\n\t\t\t// });\n\t\t}\n\n\t\treturn {\n\t\t\ttable_props,\n\t\t\ttable_prop_names,\n\t\t\tpoints_count,\n\t\t\tobjects_count,\n\t\t\tobjects_count_visible_class_object,\n\t\t\tobject_types,\n\t\t\tobjects_count_by_type,\n\t\t\tobjects_visible_count,\n\t\t\tvertex_attribute_names,\n\t\t\tvertex_class_objects_by_name,\n\t\t\tvertex_human_labels_by_name,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sop.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"85a04f04\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sop.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sop.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mat.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mat.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {ClipboardHelper} from 'src/editor/helpers/Clipboard';\n\nimport {defineComponent, ref, Ref, onMounted, computed} from '@vue/composition-api';\nimport {StoreController} from '../../../../../../store/controllers/StoreController';\nimport {AssemblerControllerNode} from '../../../../../../../engine/nodes/gl/code/Controller';\nimport {ShaderName} from '../../../../../../../engine/nodes/utils/shaders/ShaderName';\nexport default defineComponent({\n\tname: 'network_node_info_sop_particles_system_gpu',\n\tprops: {\n\t\tgraph_node_id: null,\n\t},\n\n\tsetup(props) {\n\t\tconst node = StoreController.engine.node(props.graph_node_id)! as AssemblerControllerNode;\n\n\t\tconst shaders_by_name = ref<Dictionary<string>>({});\n\t\tconst shader_names: Readonly<Ref<readonly string[]>> = computed(() => {\n\t\t\treturn Object.keys(shaders_by_name.value);\n\t\t});\n\n\t\tonMounted(() => {\n\t\t\tset_shaders_by_name();\n\t\t});\n\n\t\tasync function set_shaders_by_name() {\n\t\t\tif (node.assembler_controller) {\n\t\t\t\tawait node.request_container();\n\t\t\t\tconst assembler_shaders_by_name: Map<ShaderName, string> = node.assembler_controller.shaders_by_name;\n\n\t\t\t\tassembler_shaders_by_name.forEach((shader, shader_name) => {\n\t\t\t\t\tshaders_by_name.value[shader_name] = shader;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tfunction copy_shader(shader_name: string, escaped = false) {\n\t\t\tlet text = shaders_by_name.value[shader_name];\n\t\t\tif (escaped) {\n\t\t\t\ttext = text.replace(/(\\t)/gm, ' ');\n\t\t\t\ttext = text.replace(/(\\r\\n|\\n|\\r)/gm, '\\\\n');\n\t\t\t\ttext = text.replace(/\"/gm, '');\n\t\t\t}\n\n\t\t\tClipboardHelper.copy(text);\n\t\t\t// this.$store.commit('editor/status_bar/notice', `Copied ${shader_name} shader to clipboard`)\n\t\t}\n\n\t\treturn {\n\t\t\tshader_names,\n\t\t\tcopy_shader,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mat.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"66d2b9fe\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mat.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mat.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Gl.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Gl.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {BaseGlNodeType} from 'src/engine/nodes/gl/_Base';\nimport {StoreController} from '../../../../../../store/controllers/StoreController';\n\nimport {ClipboardHelper} from 'src/editor/helpers/Clipboard';\n\nimport {AssemblerControllerNode} from '../../../../../../../engine/nodes/gl/code/Controller';\nimport {ShaderName} from '../../../../../../../engine/nodes/utils/shaders/ShaderName';\nimport {defineComponent, ref, Ref, onMounted, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'network_node_info_sop_particles_system_gpu',\n\tprops: {\n\t\tgraph_node_id: null,\n\t},\n\n\tsetup(props) {\n\t\tconst node = StoreController.engine.node(props.graph_node_id)! as BaseGlNodeType;\n\n\t\tconst shaders_by_name = ref<Dictionary<string>>({});\n\t\tconst shader_names: Readonly<Ref<readonly string[]>> = computed(() => {\n\t\t\treturn Object.keys(shaders_by_name.value);\n\t\t});\n\n\t\tonMounted(() => {\n\t\t\tset_shaders_by_name();\n\t\t});\n\n\t\tasync function set_shaders_by_name() {\n\t\t\tconst assembler_node: AssemblerControllerNode | undefined = node.material_node;\n\t\t\tif (assembler_node) {\n\t\t\t\tawait assembler_node.request_container();\n\t\t\t\tconst assembler_shaders_by_name: Map<ShaderName, string> =\n\t\t\t\t\tassembler_node.assembler_controller.shaders_by_name;\n\n\t\t\t\tassembler_shaders_by_name.forEach((shader, shader_name) => {\n\t\t\t\t\tshaders_by_name.value[shader_name] = shader;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tfunction copy_shader(shader_name: string) {\n\t\t\tClipboardHelper.copy(shaders_by_name.value[shader_name]);\n\t\t\t// this.$store.commit('editor/status_bar/notice', `Copied ${shader_name} shader to clipboard`);\n\t\t}\n\n\t\treturn {\n\t\t\tshaders_by_name,\n\t\t\tshader_names,\n\t\t\tcopy_shader,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Gl.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"061b6198\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Gl.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Gl.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cop.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cop.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue';\nimport {BaseCopNodeType} from 'src/engine/nodes/cop/_Base';\nimport {StoreController} from '../../../../../../store/controllers/StoreController';\nimport {Texture} from 'three/src/textures/Texture';\nimport {DataTexture} from 'three/src/textures/DataTexture';\n\ninterface CopInfoProps {\n\tgraph_node_id: string;\n}\n\nimport {defineComponent, ref, onMounted} from '@vue/composition-api';\nimport {CoreMath} from '../../../../../../../core/math/_Module';\nexport default defineComponent({\n\tname: 'network_node_info_cop',\n\tprops: {\n\t\tgraph_node_id: {\n\t\t\ttype: String,\n\t\t},\n\t},\n\n\tsetup(props: CopInfoProps) {\n\t\tconst node = StoreController.engine.node(props.graph_node_id)! as BaseCopNodeType;\n\t\tconst resolution = ref<Number2>([0, 0]);\n\t\tconst canvas = ref<HTMLCanvasElement | null>(null);\n\n\t\tonMounted(() => {\n\t\t\tcompute_node();\n\t\t});\n\n\t\tasync function compute_node() {\n\t\t\tconst container = await node.request_container();\n\n\t\t\tconst texture = container.core_content();\n\t\t\tconsole.log('texture', texture, container.resolution());\n\n\t\t\tconst res = container.resolution();\n\t\t\tVue.set(resolution.value, 0, res[0]);\n\t\t\tVue.set(resolution.value, 1, res[1]);\n\n\t\t\tdraw_texture_on_canvas(texture);\n\t\t}\n\n\t\tfunction draw_texture_on_canvas(texture: Texture) {\n\t\t\tif (canvas.value) {\n\t\t\t\tif (texture instanceof DataTexture) {\n\t\t\t\t\tdraw_data_texture(canvas.value, texture);\n\t\t\t\t} else {\n\t\t\t\t\tdraw_texture(canvas.value, texture);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction draw_data_texture(canvas: HTMLCanvasElement, texture: DataTexture) {\n\t\t\tconst image_data = texture.image;\n\t\t\tcanvas.width = image_data.width;\n\t\t\tcanvas.height = image_data.height;\n\t\t\tconst context = canvas.getContext('2d') as CanvasRenderingContext2D;\n\t\t\tconst image_data_ctx = context.createImageData(image_data.width, image_data.height);\n\n\t\t\tlet mult = 1;\n\t\t\tif (image_data.data instanceof Float32Array) {\n\t\t\t\tmult = 255;\n\t\t\t}\n\n\t\t\timage_data_ctx.data.values;\n\t\t\tfor (let i = 0; i < image_data_ctx.data.length; i++) {\n\t\t\t\tconst new_val = CoreMath.clamp(image_data.data[i] * mult, 0, 255);\n\t\t\t\timage_data_ctx.data[i] = new_val;\n\t\t\t}\n\t\t\tcontext.putImageData(image_data_ctx, 0, 0);\n\t\t}\n\n\t\tfunction draw_texture(canvas: HTMLCanvasElement, texture: Texture) {\n\t\t\tconst image_data = texture.image;\n\t\t\tcanvas.width = image_data.width;\n\t\t\tcanvas.height = image_data.height;\n\t\t\tconst context = canvas.getContext('2d') as CanvasRenderingContext2D;\n\t\t\tcontext.drawImage(image_data, 0, 0);\n\t\t}\n\n\t\treturn {\n\t\t\tresolution,\n\t\t\tcanvas,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cop.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"77ce767e\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cop.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cop.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopCache.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopCache.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {CacheSopNode} from 'src/engine/nodes/sop/Cache';\nimport {ClipboardHelper} from 'src/editor/helpers/Clipboard';\nimport {StoreController} from '../../../../../../store/controllers/StoreController';\n\nimport {defineComponent} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'network_node_info_sop_cache',\n\tprops: {\n\t\tgraph_node_id: null,\n\t},\n\n\tsetup(props) {\n\t\tconst node = StoreController.engine.node(props.graph_node_id)! as CacheSopNode;\n\n\t\tfunction copy_cache() {\n\t\t\tconst value: string = node.pv.cache;\n\t\t\tClipboardHelper.copy(value);\n\t\t\t// this.$store.commit('editor/status_bar/notice', `Copied cache to clipboard`)\n\t\t}\n\n\t\treturn {copy_cache};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopCache.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5cfb502c\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopCache.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopCache.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopParticlesSystemGPU.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopParticlesSystemGPU.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {ParticlesSystemGpuSopNode} from 'src/engine/nodes/sop/ParticlesSystemGpu';\nimport {ClipboardHelper} from 'src/editor/helpers/Clipboard';\n\nimport {StoreController} from '../../../../../../store/controllers/StoreController';\nimport {defineComponent, computed, ref, Ref, onMounted} from '@vue/composition-api';\nimport {ShaderName} from '../../../../../../../engine/nodes/utils/shaders/ShaderName';\nexport default defineComponent({\n\tname: 'network_node_info_sop_particles_system_gpu',\n\tprops: {\n\t\tgraph_node_id: null,\n\t},\n\n\tsetup(props) {\n\t\tconst node = StoreController.engine.node(props.graph_node_id)! as ParticlesSystemGpuSopNode;\n\n\t\tconst shaders_by_name = ref<Dictionary<string>>({});\n\t\tconst shader_names: Readonly<Ref<readonly string[]>> = computed(() => {\n\t\t\treturn Object.keys(shaders_by_name.value);\n\t\t});\n\n\t\tonMounted(() => {\n\t\t\tset_shaders_by_name();\n\t\t});\n\n\t\tasync function set_shaders_by_name() {\n\t\t\tawait node.request_container();\n\n\t\t\tconst assembler_shaders_by_name: Map<ShaderName, string> = node.assembler_controller.shaders_by_name;\n\n\t\t\tassembler_shaders_by_name.forEach((shader, shader_name) => {\n\t\t\t\tshaders_by_name.value[shader_name] = shader;\n\t\t\t});\n\t\t}\n\t\tfunction copy_shader(shader_name: string) {\n\t\t\tClipboardHelper.copy(shaders_by_name.value[shader_name]);\n\t\t\t// this.$store.commit('editor/status_bar/notice', `Copied ${shader_name} shader to clipboard`);\n\t\t}\n\n\t\treturn {\n\t\t\tshader_names,\n\t\t\tcopy_shader,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopParticlesSystemGPU.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"2756da7e\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopParticlesSystemGPU.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopParticlesSystemGPU.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeInfo.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"11f982cb\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeInfo.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeInfo.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Node.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"3f87938b\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Node.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Node.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterractiveConnection.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterractiveConnection.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Box2} from 'three/src/math/Box2';\n\nconst PADDING = 10;\nconst DEFAULT_POINT_BOX_HALF_SIZE = new Vector2(PADDING, PADDING);\nconst DEFAULT_POINT_BOX = new Box2(DEFAULT_POINT_BOX_HALF_SIZE.clone().multiplyScalar(-1), DEFAULT_POINT_BOX_HALF_SIZE);\n\nimport {defineComponent, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'network_node_interractive_connection',\n\n\tprops: {\n\t\tmouse_start: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {\n\t\t\t\treturn {x: 0, y: 0};\n\t\t\t},\n\t\t},\n\t\tmouse_progress: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {\n\t\t\t\treturn {x: 0, y: 0};\n\t\t\t},\n\t\t},\n\t},\n\n\tsetup(props) {\n\t\tconst src_pos_vec = new Vector2();\n\t\tconst dest_pos_vec = new Vector2();\n\t\tconst src_box_box = DEFAULT_POINT_BOX.clone();\n\t\tconst dest_box_box = DEFAULT_POINT_BOX.clone();\n\t\tconst svg_bounds_box = new Box2();\n\t\tconst src_position_vec = new Vector2();\n\t\tconst dest_position_vec = new Vector2();\n\t\tconst size = new Vector2();\n\n\t\tconst src_pos = computed(() => {\n\t\t\tsrc_pos_vec.x = props.mouse_start.x;\n\t\t\tsrc_pos_vec.y = props.mouse_start.y;\n\t\t\treturn src_pos_vec;\n\t\t});\n\t\tconst dest_pos = computed(() => {\n\t\t\tdest_pos_vec.x = props.mouse_progress.x;\n\t\t\tdest_pos_vec.y = props.mouse_progress.y;\n\t\t\treturn dest_pos_vec;\n\t\t});\n\t\tconst src_box = computed(() => {\n\t\t\tsrc_box_box.copy(DEFAULT_POINT_BOX);\n\t\t\tsrc_box_box.translate(src_pos.value);\n\t\t\treturn src_box_box;\n\t\t});\n\t\tconst dest_box = computed(() => {\n\t\t\tdest_box_box.copy(DEFAULT_POINT_BOX);\n\t\t\tdest_box_box.translate(dest_pos.value);\n\t\t\treturn dest_box_box;\n\t\t});\n\t\tconst svg_bounds = computed(() => {\n\t\t\tsvg_bounds_box.copy(src_box.value);\n\t\t\tsvg_bounds_box.union(dest_box.value);\n\t\t\treturn svg_bounds_box;\n\t\t});\n\t\tconst src_position = computed(() => {\n\t\t\tsrc_position_vec.copy(src_pos.value);\n\t\t\tsrc_position_vec.sub(svg_bounds.value.min);\n\t\t\treturn src_position_vec; //.add(DEFAULT_POINT_BOX_HALF_SIZE)\n\t\t});\n\t\tconst dest_position = computed(() => {\n\t\t\tdest_position_vec.copy(dest_pos.value);\n\t\t\tdest_position_vec.sub(src_pos.value);\n\t\t\tdest_position_vec.add(src_position.value);\n\t\t\treturn dest_position_vec;\n\t\t\t// const delta = this.dest_pos.clone().sub(this.src_pos);\n\t\t\t// return delta.add(this.src_position);\n\t\t});\n\t\tconst svg_style_object = computed(() => {\n\t\t\tsvg_bounds.value.getSize(size);\n\t\t\tconst min = svg_bounds.value.min; //.clone();\n\t\t\t// min.sub(this.dest_json_node.ui_data)\n\t\t\treturn {\n\t\t\t\tleft: `${min.x}px`,\n\t\t\t\ttop: `${min.y}px`,\n\t\t\t\twidth: `${size.x}px`,\n\t\t\t\theight: `${size.y}px`,\n\t\t\t};\n\t\t});\n\t\treturn {\n\t\t\tsrc_pos,\n\t\t\tdest_pos,\n\t\t\tsrc_box,\n\t\t\tdest_box,\n\t\t\tsvg_bounds,\n\t\t\tsrc_position,\n\t\t\tdest_position,\n\t\t\tsvg_style_object,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterractiveConnection.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7d4ff9cb\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterractiveConnection.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterractiveConnection.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Network.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6bd6a8f6\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Network.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Network.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Params.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Params.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// import lodash_values from 'lodash/values';\n\n// mixins\nimport {SetupFolders} from './mixins/Folders';\n// import {Json} from './mixins/Json';\n// import {ParamDescription} from './mixins/ParamDescription';\n// import {Presets} from './mixins/Presets';\n// import Menu from './Mixin/Menu'\n// import ParamsEmit from './Mixin/ParamsEmit'\n\nimport DropDownMenu from 'src/editor/components/widgets/DropDownMenu.vue';\n\n// components\nimport ParamFieldContainer from './components/Param.vue';\nimport {NodeSetNameCommand} from '../../../history/commands/NodeSetName';\nimport {StoreController} from '../../../store/controllers/StoreController';\nimport {SetupSelectedNode} from '../../mixins/SelectedNode';\n\nimport {defineComponent, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'param-panel',\n\t// mixins: [Folders, Json, NodeOwner, ParamDescription, Presets, Selection],\n\tcomponents: {ParamFieldContainer, DropDownMenu},\n\n\tprops: {\n\t\tdisplay_toolbar: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\t// display_spare_params_only: {\n\t\t// \ttype: Boolean,\n\t\t// \tdefault: false,\n\t\t// },\n\t},\n\t// watch:\n\t// \tfirst_selected_node: ->\n\t// \t\tthis.emit_node_params()\n\n\tsetup(props) {\n\t\tconst selection_options = SetupSelectedNode();\n\n\t\t// const first_selected_node_id = computed(() => {\n\t\t// \treturn selection_options.first_selected_node_id.value;\n\t\t// });\n\n\t\t// watch(first_selected_node_id, (new_id: string | null) => {\n\t\t// \tif (new_id) {\n\t\t// \t\tStoreController.engine.add_node_params_to_store(new_id);\n\t\t// \t}\n\t\t// });\n\n\t\tconst display_node_doc_help = computed(() => {\n\t\t\treturn false; //first_selected_json_node != null && !this.selected_node.constructor.is_custom_node();\n\t\t});\n\t\tconst node_doc_url = computed(() => {\n\t\t\treturn '';\n\t\t\t// if (this.display_node_doc_help) {\n\t\t\t// \tconst selected_node = this.graph.node_from_id(this.selected_json_node.graph_node_id);\n\t\t\t// \tconst context = selected_node.node_context().toLowerCase();\n\t\t\t// \tconst type = selected_node.type();\n\t\t\t// \treturn `https://doc.polygonjs.com/nodes/${context}/${type}.html`;\n\t\t\t// }\n\t\t});\n\n\t\t// functions\n\t\tasync function on_name_click() {\n\t\t\tconst node = selection_options.first_selected_node();\n\t\t\tif (!node) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst new_name: string = await StoreController.editor.dialog_prompt.show({\n\t\t\t\ttitle: 'Rename Node:',\n\t\t\t\tdefault_value: node.name,\n\t\t\t\tconfirm_label: 'Update Name',\n\t\t\t});\n\n\t\t\tif (new_name !== null && new_name.length > 0) {\n\t\t\t\tconst cmd = new NodeSetNameCommand(node, new_name);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tdisplay_node_doc_help,\n\t\t\tnode_doc_url,\n\t\t\ton_name_click,\n\t\t\t...selection_options,\n\t\t\t...SetupFolders(selection_options),\n\t\t};\n\t},\n});\n","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Param.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Param.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport lodash_isString from 'lodash/isString';\n\n// mixins\nimport {SetupGlobalSliderOwner} from './fields/mixins/GlobalSliderOwner';\n// import Emit from './Mixin/Emit';\nimport {SetupContextMenu} from './mixins/ContextMenu';\n\n// components\nimport BooleanField from './fields/Boolean.vue';\nimport ButtonField from './fields/Button.vue';\nimport ColorField from './fields/Color.vue';\nimport FloatField from './fields/Float.vue';\nimport FolderField from './fields/Folder.vue';\nimport IntegerField from './fields/Integer.vue';\nimport NumericField from './fields/Numeric.vue';\nimport OperatorPathField from './fields/OperatorPath.vue';\nimport RadioField from './fields/Radio.vue';\nimport SeparatorField from './fields/Separator.vue';\nimport StringField from './fields/String.vue';\nimport Vector2Field from './fields/Vector2.vue';\nimport Vector3Field from './fields/Vector3.vue';\nimport Vector4Field from './fields/Vector4.vue';\nimport RampField from './fields/Ramp.vue';\n\ninterface DescriptionMenuEntries {\n\tdescription: string;\n\tmenu_entries: Dictionary<string>;\n}\n\ninterface ParamsProps {\n\tjson_param: EngineParamData;\n\tdescription?: string | DescriptionMenuEntries;\n\ttabindex: number;\n}\nimport {EngineParamData} from '../../../../store/modules/Engine';\nimport {StoreController} from '../../../../store/controllers/StoreController';\nimport {ParamType} from '../../../../../engine/poly/ParamType';\n\nimport {defineComponent, computed, onMounted, ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'param-field-container',\n\t// mixins: [Emit, GlobalSliderOwner, ContextMenu],\n\tcomponents: {\n\t\tBooleanField,\n\t\tButtonField,\n\t\tColorField,\n\t\tFloatField,\n\t\tFolderField,\n\t\tIntegerField,\n\t\tNumericField,\n\t\tOperatorPathField,\n\t\tRadioField,\n\t\tSeparatorField,\n\t\tStringField,\n\t\tVector2Field,\n\t\tVector3Field,\n\t\tVector4Field,\n\t\tRampField,\n\t},\n\n\tprops: {\n\t\tjson_param: {},\n\t\tdescription: {},\n\t\ttabindex: {\n\t\t\tdefault: -1,\n\t\t\ttype: Number,\n\t\t},\n\t},\n\n\tsetup(props: ParamsProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)!;\n\n\t\tconst displays_expression_result = ref(false);\n\n\t\tonMounted(() => {\n\t\t\tparam.options.set_ui_data_dependency();\n\t\t\tparam.options.update_visibility();\n\t\t});\n\n\t\t// const graph_node_id = computed(()=>{\n\t\t// \treturn props.json_param.graph_node_id;\n\t\t// })\n\t\tconst name = computed(() => {\n\t\t\treturn props.json_param.name;\n\t\t});\n\t\tconst type = computed(() => {\n\t\t\treturn props.json_param.type;\n\t\t});\n\t\t// const value = computed(()=>{\n\t\t// \treturn props.json_param.value;\n\t\t// })\n\t\tconst human_description = computed(() => {\n\t\t\tif (props.description) {\n\t\t\t\tif (lodash_isString(props.description)) {\n\t\t\t\t\treturn props.description;\n\t\t\t\t} else {\n\t\t\t\t\tconst description_menu_entries = props.description['menu_entries'];\n\t\t\t\t\tlet suffix = '';\n\t\t\t\t\tconst entries_description: string[] = [];\n\t\t\t\t\tparam.options.menu_entries.forEach((param_menu_entry) => {\n\t\t\t\t\t\tconst entry_name = param_menu_entry['name'];\n\t\t\t\t\t\tconst description_entry = description_menu_entries[entry_name];\n\t\t\t\t\t\tentries_description.push(`- ${entry_name}:\\n${description_entry}`);\n\t\t\t\t\t});\n\t\t\t\t\tsuffix = `\\n\\n${entries_description.join('\\n\\n')}`;\n\t\t\t\t\treturn props.description['description'] + suffix;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst label_tooltip = computed(() => {\n\t\t\tif (human_description.value) {\n\t\t\t\treturn `${name.value} (${type.value}: ${human_description.value})`;\n\t\t\t} else {\n\t\t\t\treturn `${name.value} (${type.value})`;\n\t\t\t}\n\t\t});\n\n\t\tconst field_component_type = computed(() => {\n\t\t\tlet converted_type = type.value;\n\t\t\tswitch (type.value) {\n\t\t\t\tcase ParamType.INTEGER:\n\t\t\t\t\tif (param.options.has_menu_radio) {\n\t\t\t\t\t\tconverted_type = 'radio';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconverted_type = type.value;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn `${converted_type.replace('_', '-')}-field`;\n\t\t});\n\n\t\tconst param_visible = computed(() => {\n\t\t\treturn props.json_param.is_visible;\n\t\t});\n\n\t\tconst display_label = computed(() => {\n\t\t\treturn !param.options.is_label_hidden;\n\t\t});\n\n\t\t// \twatch: {\n\t\t// \tgraph_node_id() {\n\t\t// \t\treturn param.update_visibility();\n\t\t// \t},\n\t\t// },\n\t\t// methods\n\t\tfunction toggle_expression_mode() {\n\t\t\tif (param.has_expression()) {\n\t\t\t\tdisplays_expression_result.value = !displays_expression_result.value;\n\t\t\t} else {\n\t\t\t\tdisplays_expression_result.value = false;\n\t\t\t}\n\t\t}\n\n\t\tconst slider_options = SetupGlobalSliderOwner(props.json_param);\n\t\tfunction open_numeric_slider_if_numeric_or_color(e: MouseEvent) {\n\t\t\tif (param.is_numeric || param.type === ParamType.COLOR) {\n\t\t\t\tslider_options.open_numeric_slider(e);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tname,\n\t\t\tlabel_tooltip,\n\t\t\tfield_component_type,\n\t\t\tparam_visible,\n\t\t\tdisplay_label,\n\t\t\tdisplays_expression_result,\n\t\t\t// functions\n\t\t\ttoggle_expression_mode,\n\t\t\topen_numeric_slider_if_numeric_or_color,\n\t\t\t...slider_options,\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Boolean.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Boolean.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {BooleanParam} from '../../../../../../engine/params/Boolean';\n\n// components\nimport Numeric from './Numeric.vue';\nimport {ParamSetCommand} from '../../../../../history/commands/ParamSet';\n\nimport {defineComponent, computed, onMounted} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'boolean-field',\n\t//mixins: [Field, ContextMenu, TabIndexMixin],\n\tprops: SetupFieldCommonProps,\n\tcomponents: {Numeric},\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as BooleanParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\t// const param_result = ref(false)\n\n\t\tonMounted(() => {\n\t\t\tif (param.is_dirty) {\n\t\t\t\tparam.compute();\n\t\t\t}\n\t\t});\n\n\t\tconst checkbox_id = computed(() => {\n\t\t\treturn `checkbox_${props.json_param.graph_node_id}`;\n\t\t});\n\t\t// const checked_color = computed(()=>{\n\t\t// \treturn this.param.color() || '#1779ba';\n\t\t// })\n\t\t// const default_color = computed(()=>{\n\t\t// \treturn '#cacaca';\n\t\t// })\n\t\tconst checked = computed(() => {\n\t\t\treturn props.json_param.value;\n\t\t});\n\t\t// const style_object = computed(()=>{\n\t\t// \tlet style;\n\t\t// \treturn (style = {\n\t\t// \t\tbackgroundColor: this.checked_color,\n\t\t// \t\topacity: this.checked ? 1 : 0.3,\n\t\t// \t});\n\t\t// })\n\n\t\t// watch(value, (new_value)=>{\n\t\t// \tthis.param_result = this.param.value\n\t\t// })\n\t\t// watch(expression,(new_value)=>{\n\t\t// \teval_param()\n\t\t// })\n\n\t\t// functions\n\t\tfunction on_checkbox_update(e: Event) {\n\t\t\tconst target = e.target as HTMLInputElement;\n\t\t\tif (target) {\n\t\t\t\tlet new_value = target.checked;\n\t\t\t\t// new_value = new_value ? 1 : 0;\n\t\t\t\tconst cmd = new ParamSetCommand(param, new_value);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t}\n\n\t\tfunction toggle_param() {\n\t\t\tlet new_value = !param.value;\n\t\t\t// new_value = new_value ? 1 : 0;\n\t\t\tconst cmd = new ParamSetCommand(param, new_value);\n\t\t\tcmd.push();\n\t\t\t// return new History.Command.ParamSet(this.param, {value: new_value}).push(this);\n\t\t}\n\n\t\t// function eval_param() {\n\t\t// \tparam.compute()\n\t\t// \t// return this.param.eval().then((value) => {\n\t\t// \t// \treturn (this.param_result = this.param.value_to_boolean(value));\n\t\t// \t// });\n\t\t// }\n\n\t\treturn {\n\t\t\tcheckbox_id,\n\t\t\tchecked,\n\t\t\t// param_result,\n\t\t\t// functions\n\t\t\ton_checkbox_update,\n\t\t\ttoggle_param,\n\t\t\t// mixins\n\t\t\t...setup_field_common,\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Numeric.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Numeric.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupGlobalSliderOwner} from './mixins/GlobalSliderOwner';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\n\nimport {StoreController} from '../../../../../store/controllers/StoreController';\n\nimport {defineComponent} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'numeric-field',\n\tprops: SetupFieldCommonProps,\n\t// mixins: [Field, GlobalSliderOwner, ContextMenu, TabIndexMixin],\n\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)!;\n\n\t\treturn {\n\t\t\t...SetupFieldCommon(props),\n\t\t\t...SetupGlobalSliderOwner(props.json_param),\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Boolean.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"208fd4fa\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Boolean.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Boolean.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\n// import {TabIndexMixin} from './mixin/TabIndex';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {ButtonParam} from '../../../../../../engine/params/Button';\n\nimport {defineComponent} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'button-field',\n\t// mixins: [Field, TabIndexMixin],\n\tprops: SetupFieldCommonProps,\n\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as ButtonParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\t// const color = computed(() => {\n\t\t// \treturn param.options.color;\n\t\t// });\n\t\t// const style_object = computed(() => {\n\t\t// \treturn {backgroundColor: color.value};\n\t\t// });\n\n\t\tfunction on_click(e: MouseEvent) {\n\t\t\tparam.press_button();\n\t\t}\n\n\t\treturn {\n\t\t\t// style_object,\n\t\t\t// color,\n\t\t\ton_click,\n\t\t\t...setup_field_common,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"114eb89e\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Color.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Color.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {Color} from 'three/src/math/Color';\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupMultipleParamCommon} from './mixins/MultipleParamCommon';\n\n// components\nimport Numeric from './Numeric.vue';\nimport {ColorParam} from '../../../../../../engine/params/Color';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\n\nimport {defineComponent, computed, onMounted, ref, watch} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'color-field',\n\tprops: SetupFieldCommonProps,\n\tcomponents: {Numeric},\n\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as ColorParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\t\tconst init_color_style = param.value.getStyle();\n\t\tconst input_color = ref(init_color_style);\n\n\t\tonMounted(() => {\n\t\t\tupdate_input_color_from_param();\n\t\t});\n\n\t\tconst color_input_name = computed(() => {\n\t\t\treturn `color_input_${param.full_path()}`;\n\t\t});\n\t\tconst color_value = computed(() => {\n\t\t\treturn props.json_param.value as Number3;\n\t\t});\n\n\t\t// update color html input element element from color\n\t\tconst input_color_w = new Color();\n\t\twatch(color_value, async (new_color, old_color) => {\n\t\t\tinput_color_w.fromArray(new_color);\n\t\t\tconst new_style = input_color_w.getHexString();\n\t\t\tinput_color.value = `#${new_style}`;\n\t\t});\n\n\t\t// update color from color html input element\n\t\tconst input_color_c = new Color();\n\t\twatch(input_color, (new_color) => {\n\t\t\tif (!param.has_expression()) {\n\t\t\t\tinput_color_c.setStyle(new_color);\n\t\t\t\t// const color = new Color(new_color);\n\t\t\t\tif (!param.is_raw_input_equal(input_color_c)) {\n\t\t\t\t\tparam.set(input_color_c);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tasync function update_input_color_from_param() {\n\t\t\tif (param.is_dirty) {\n\t\t\t\tparam.compute();\n\t\t\t}\n\t\t\tconst value = param.value;\n\t\t\tinput_color.value = `#${value.getHexString()}`;\n\t\t}\n\n\t\treturn {\n\t\t\tinput_color,\n\t\t\tcolor_input_name,\n\t\t\t...SetupMultipleParamCommon(props.json_param),\n\t\t\t...setup_field_common,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Color.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5ae19139\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Color.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Color.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Float.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Float.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupGlobalSliderOwner} from './mixins/GlobalSliderOwner';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {SetupNumericSlider} from './mixins/NumericSlider';\n\nimport {FloatParam} from '../../../../../../engine/params/Float';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\n\nimport {defineComponent, computed, ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'float-field',\n\tprops: SetupFieldCommonProps,\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as FloatParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\tconst text_input_focused = ref(false);\n\n\t\tconst param_range = computed(() => {\n\t\t\treturn param.options.range;\n\t\t});\n\t\tconst slider_step = computed(() => {\n\t\t\treturn param.options.step || 0.01;\n\t\t});\n\n\t\tconst display_slider = computed(() => {\n\t\t\treturn !text_input_focused.value;\n\t\t});\n\n\t\t// functions\n\t\tfunction on_focus() {\n\t\t\tif (param.has_expression()) {\n\t\t\t\ttext_input_focused.value = true;\n\t\t\t}\n\t\t}\n\t\tfunction on_blur(e: Event) {\n\t\t\tconsole.log('float on_blur');\n\t\t\ttext_input_focused.value = false;\n\t\t\tsetup_field_common.on_update_value(e);\n\t\t}\n\n\t\treturn {\n\t\t\tparam_range,\n\t\t\tslider_step,\n\t\t\tdisplay_slider,\n\t\t\t// functions\n\t\t\ton_focus,\n\t\t\ton_blur,\n\t\t\t// mixins\n\t\t\t...setup_field_common,\n\t\t\t...SetupNumericSlider(props.json_param, param),\n\t\t\t...SetupGlobalSliderOwner(props.json_param),\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Float.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"015d8daa\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Float.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Float.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Folder.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Folder.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\nimport {defineComponent} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'folder-field',\n\tsetup() {\n\t\treturn {};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Folder.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"be22519e\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Folder.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Folder.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Integer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Integer.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupGlobalSliderOwner} from './mixins/GlobalSliderOwner';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {SetupNumericSlider} from './mixins/NumericSlider';\n\nimport {IntegerParam} from '../../../../../../engine/params/Integer';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\n\nimport {defineComponent, computed, ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'integer-field',\n\tprops: SetupFieldCommonProps,\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as IntegerParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\tconst text_input_focused = ref(false);\n\n\t\tconst param_range = computed(() => {\n\t\t\treturn param.options.range;\n\t\t});\n\t\tconst slider_step = computed(() => {\n\t\t\treturn 1;\n\t\t});\n\n\t\tconst display_slider = computed(() => {\n\t\t\treturn !text_input_focused.value;\n\t\t});\n\n\t\t// functions\n\t\tfunction on_focus() {\n\t\t\tif (param.has_expression()) {\n\t\t\t\ttext_input_focused.value = true;\n\t\t\t}\n\t\t}\n\t\tfunction on_blur(e: Event) {\n\t\t\ttext_input_focused.value = false;\n\t\t\tsetup_field_common.on_update_value(e);\n\t\t}\n\n\t\treturn {\n\t\t\tparam_range,\n\t\t\tslider_step,\n\t\t\tdisplay_slider,\n\t\t\t// functions\n\t\t\ton_focus,\n\t\t\ton_blur,\n\t\t\t// mixins\n\t\t\t...setup_field_common,\n\t\t\t...SetupNumericSlider(props.json_param, param),\n\t\t\t...SetupGlobalSliderOwner(props.json_param),\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Integer.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"f01ac3a2\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Integer.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Integer.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OperatorPath.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OperatorPath.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\n\nimport {OperatorPathParam} from '../../../../../../engine/params/OperatorPath';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {ParamSetCommand} from '../../../../../history/commands/ParamSet';\n\nimport {defineComponent} from '@vue/composition-api';\nimport {CoreWalker} from '../../../../../../core/Walker';\nexport default defineComponent({\n\tname: 'operator-path-field',\n\tprops: SetupFieldCommonProps,\n\t// mixins: [Field, ContextMenu, TabIndexMixin],\n\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as OperatorPathParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\tfunction on_update_value(e: Event) {\n\t\t\tconst target = e.target as HTMLInputElement;\n\t\t\tif (target) {\n\t\t\t\tconst cmd = new ParamSetCommand(param, target.value);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t}\n\n\t\tfunction go_to_node() {\n\t\t\tif (param.is_dirty) {\n\t\t\t\tparam.compute();\n\t\t\t}\n\t\t\tconst node = param.found_node();\n\t\t\tif (node) {\n\t\t\t\tif (node.parent) {\n\t\t\t\t\tStoreController.editor.set_current_node(node.parent);\n\n\t\t\t\t\tif (node.parent.children_allowed() && node.parent.children_controller) {\n\t\t\t\t\t\tnode.parent.children_controller.selection.set([node]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t__attempt_finding_parent();\n\t\t\t}\n\t\t}\n\t\tfunction __attempt_finding_parent(level = 1) {\n\t\t\tconst path = param.value;\n\t\t\tconst elements = path.split('/');\n\t\t\tif (elements.length == 1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (let i = 0; i < level; i++) {\n\t\t\t\telements.pop();\n\t\t\t}\n\t\t\tconst parent_path = elements.join('/');\n\t\t\tconst parent_node = CoreWalker.find_node(param.node, parent_path);\n\t\t\tif (parent_node) {\n\t\t\t\tStoreController.editor.set_current_node(parent_node);\n\t\t\t} else {\n\t\t\t\t__attempt_finding_parent(level + 1);\n\t\t\t}\n\t\t}\n\n\t\tfunction open_node_selector() {\n\t\t\tStoreController.editor.panel_node_selector.open({\n\t\t\t\tparam_id: param.graph_node_id,\n\t\t\t});\n\t\t\t// return this.$store.commit('editor/param_node_selector/open', {param_id: this.param.graph_node_id()});\n\t\t}\n\n\t\treturn {\n\t\t\ton_update_value,\n\t\t\tgo_to_node,\n\t\t\topen_node_selector,\n\t\t\t// mixins,\n\t\t\t...setup_field_common,\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OperatorPath.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"ad1a6bde\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OperatorPath.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OperatorPath.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Radio.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Radio.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {ParamSetCommand} from '../../../../../history/commands/ParamSet';\n\nimport {defineComponent, computed, ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'radio-field',\n\tprops: SetupFieldCommonProps,\n\t// mixins: [Field, TabIndexMixin],\n\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)!;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\tconst select = ref<HTMLSelectElement | null>(null);\n\n\t\tconst entries = computed(() => {\n\t\t\treturn param.options.menu_entries;\n\t\t});\n\t\tconst selected_states = computed(() => {\n\t\t\treturn entries.value.map((entry) => {\n\t\t\t\treturn entry.value === param.value;\n\t\t\t});\n\t\t});\n\n\t\tfunction set_from_select() {\n\t\t\tif (select.value) {\n\t\t\t\tconst value = select.value.value;\n\t\t\t\tconst cmd = new ParamSetCommand(param as any, value);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tselect,\n\t\t\tentries,\n\t\t\tselected_states,\n\t\t\tset_from_select,\n\t\t\t...setup_field_common,\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n// set_from_radio: (index)->\n// \tentry = this.entries[index]\n// \tvalue = entry['value']\n// \t(new History.Command.ParamSet(this.param, {value: value})).push(this)\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Radio.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"65b7eb2e\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Radio.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Radio.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Separator.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Separator.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\n// import { SeparatorParam } from '../../../../../../engine/params/Separator';\n\nimport {defineComponent} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'separator-field',\n\tprops: SetupFieldCommonProps,\n\t// mixins: [Field]\n\tsetup(props: ISetupFieldCommonProps) {\n\t\t// StoreController.engine.param(props.json_param.graph_node_id)! as SeparatorParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\treturn {\n\t\t\t...setup_field_common,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Separator.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"494aa73d\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Separator.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Separator.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./String.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./String.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {StringParam} from '../../../../../../engine/params/String';\nimport {ParamSetCommand} from '../../../../../history/commands/ParamSet';\n\nimport {defineComponent, computed} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'string-field',\n\tprops: SetupFieldCommonProps,\n\t// mixins: [Field, ContextMenu, TabIndexMixin, TabIndexMixin],\n\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as StringParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\tconst is_multiline = computed(() => {\n\t\t\treturn param.options.is_multiline;\n\t\t});\n\t\tconst is_single_line = computed(() => {\n\t\t\treturn !is_multiline.value;\n\t\t});\n\t\t// input_tag_name: ->\n\t\t// \tif @is_multiline\n\t\t// \t\t'textarea'\n\t\t// \telse\n\t\t// \t\t'input'\n\n\t\tconst rows = computed(() => {\n\t\t\treturn 5;\n\t\t});\n\n\t\tconst display_browse_button = computed(() => {\n\t\t\treturn false; //POLY.desktop_controller().active();\n\t\t});\n\n\t\t// functions\n\t\tfunction on_update_value(e: Event) {\n\t\t\tconst target = e.target as HTMLInputElement;\n\t\t\tif (target) {\n\t\t\t\tconst new_value = target.value;\n\t\t\t\tconst cmd = new ParamSetCommand(param, new_value);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t}\n\n\t\tfunction browse_file() {\n\t\t\t// const file_type = this.param.desktop_browse_file_type();\n\t\t\t// const allowed_extensions = POLY.upload_allowed_extensions_by_file_type()[file_type];\n\t\t\t// const file_path = POLY.desktop_controller().browse_local_files(file_type, allowed_extensions);\n\t\t\t// if (file_path) {\n\t\t\t// \tconst value = `\\`local(\"${file_path}\")\\``;\n\t\t\t// \treturn new History.Command.ParamSet(this.param, {value}).push(this);\n\t\t\t// }\n\t\t}\n\n\t\treturn {\n\t\t\tis_multiline,\n\t\t\tis_single_line,\n\t\t\trows,\n\t\t\tdisplay_browse_button,\n\t\t\t// functions\n\t\t\ton_update_value,\n\t\t\tbrowse_file,\n\t\t\t// mixins\n\t\t\t...setup_field_common,\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./String.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"f3d41ade\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./String.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./String.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector2.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector2.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupMultipleParamCommon} from './mixins/MultipleParamCommon';\nimport {SetupGlobalSliderOwner} from './mixins/GlobalSliderOwner';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {Vector2Param} from '../../../../../../engine/params/Vector2';\n\n// components\nimport Numeric from './Numeric.vue';\n\nimport {defineComponent} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'vector2-field',\n\t// mixins: [Field, TabIndexMixin],\n\tprops: SetupFieldCommonProps,\n\tcomponents: {Numeric},\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as Vector2Param;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\treturn {\n\t\t\t// mixins\n\t\t\t...setup_field_common,\n\t\t\t...SetupMultipleParamCommon(props.json_param),\n\t\t\t...SetupGlobalSliderOwner(props.json_param),\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector2.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7cafbc11\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector2.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector2.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector3.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector3.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupMultipleParamCommon} from './mixins/MultipleParamCommon';\nimport {SetupGlobalSliderOwner} from './mixins/GlobalSliderOwner';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {Vector3Param} from '../../../../../../engine/params/Vector3';\n\n// components\nimport Numeric from './Numeric.vue';\n\nimport {defineComponent} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'vector3-field',\n\t// mixins: [Field, TabIndexMixin],\n\tprops: SetupFieldCommonProps,\n\tcomponents: {Numeric},\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as Vector3Param;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\treturn {\n\t\t\t// mixins\n\t\t\t...setup_field_common,\n\t\t\t...SetupMultipleParamCommon(props.json_param),\n\t\t\t...SetupGlobalSliderOwner(props.json_param),\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector3.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"4ba571d3\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector3.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector3.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector4.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector4.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupMultipleParamCommon} from './mixins/MultipleParamCommon';\nimport {SetupGlobalSliderOwner} from './mixins/GlobalSliderOwner';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {Vector4Param} from '../../../../../../engine/params/Vector4';\n\n// components\nimport Numeric from './Numeric.vue';\n\nimport {defineComponent} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'vector4-field',\n\t// mixins: [Field, TabIndexMixin],\n\tprops: SetupFieldCommonProps,\n\tcomponents: {Numeric},\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as Vector4Param;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\treturn {\n\t\t\t// mixins\n\t\t\t...setup_field_common,\n\t\t\t...SetupMultipleParamCommon(props.json_param),\n\t\t\t...SetupGlobalSliderOwner(props.json_param),\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector4.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"1a9b2795\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector4.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector4.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ramp.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ramp.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport lodash_sortBy from 'lodash/sortBy';\nimport {Vector2} from 'three/src/math/Vector2';\n\n// internal lib\nimport {CoreDom} from 'src/core/Dom';\nimport {EventHelper} from 'src/core/EventHelper';\nimport {RampValue, RampPointJson} from 'src/engine/params/ramp/RampValue';\nimport {RampParam} from 'src/engine/params/Ramp';\n\n// mixins\nimport {SetupFieldCommon, ISetupFieldCommonProps, SetupFieldCommonProps} from './mixins/FieldCommon';\nimport {SetupContextMenu} from '../mixins/ContextMenu';\nimport {StoreController} from '../../../../../store/controllers/StoreController';\nimport {CoreMath} from '../../../../../../core/math/_Module';\nimport {ParamSetCommand} from '../../../../../history/commands/ParamSet';\n\nimport {defineComponent, computed, ref, onMounted, watch} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'ramp-field',\n\tprops: SetupFieldCommonProps,\n\t// mixins: [Field, GlobalSliderOwner, ContextMenu, TabIndexMixin],\n\tsetup(props: ISetupFieldCommonProps) {\n\t\tconst param = StoreController.engine.param(props.json_param.graph_node_id)! as RampParam;\n\t\tconst setup_field_common = SetupFieldCommon(props);\n\n\t\tconst ramp_points = ref<RampPointJson[]>([]);\n\t\tconst curve_points = ref<Vector2Like[]>([]);\n\t\tconst interpolation = ref('');\n\t\tconst dragged_point_index = ref(-1);\n\t\tconst point_about_to_be_removed = ref(false);\n\t\tconst svg = ref<HTMLElement | null>(null);\n\n\t\tconst _start_normalized_mouse_pos = new Vector2();\n\t\tonMounted(() => {\n\t\t\tfor (let point of param.value.points) {\n\t\t\t\tramp_points.value.push(point.to_json());\n\t\t\t}\n\t\t});\n\n\t\tconst control_point_positions_percent = computed(() => {\n\t\t\treturn ramp_points.value.map((p) => {\n\t\t\t\treturn `${100 * p.position}%`;\n\t\t\t});\n\t\t});\n\t\tconst control_point_values_percent = computed(() => {\n\t\t\treturn ramp_points.value.map((p) => {\n\t\t\t\treturn `${100 * (1 - p.value)}%`;\n\t\t\t});\n\t\t});\n\n\t\tconst curve_point_positions_percent = computed(() => {\n\t\t\treturn curve_points.value.map((p) => {\n\t\t\t\treturn `${100 * p.x}%`;\n\t\t\t});\n\t\t});\n\t\tconst curve_point_values_percent = computed(() => {\n\t\t\treturn curve_points.value.map((p) => {\n\t\t\t\treturn `${100 * (1 - p.y)}%`;\n\t\t\t});\n\t\t});\n\t\tconst control_point_class_objects = computed(() => {\n\t\t\treturn ramp_points.value.map((p, i) => {\n\t\t\t\tif (dragged_point_index.value === i) {\n\t\t\t\t\treturn {dragged: true};\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tconst interpolated_curve_class_object = computed(() => {\n\t\t\treturn {point_about_to_be_removed: point_about_to_be_removed.value};\n\t\t});\n\n\t\twatch(ramp_points, () => {\n\t\t\tupdate_curve();\n\t\t});\n\n\t\t// functions\n\t\tfunction update_curve() {\n\t\t\tconst sorted_points = lodash_sortBy(ramp_points.value, (ramp_point) => ramp_point.position);\n\t\t\tconst positions = new Float32Array(sorted_points.length);\n\t\t\tconst values = new Float32Array(sorted_points.length);\n\t\t\tsorted_points.forEach(function(sorted_point, i) {\n\t\t\t\tpositions[i] = sorted_point.position;\n\t\t\t\tvalues[i] = sorted_point.value;\n\t\t\t});\n\n\t\t\tconst interpolant = RampParam.create_interpolant(positions, values);\n\t\t\tif (!svg.value || !svg.value.parentElement) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst results_count = svg.value.parentElement.offsetWidth * 0.5;\n\t\t\tfor (let i = 0; i < results_count; i++) {\n\t\t\t\tconst i_n = i / results_count;\n\t\t\t\tconst result = interpolant.evaluate(i_n);\n\t\t\t\tcurve_points.value.push({\n\t\t\t\t\tx: i_n,\n\t\t\t\t\ty: result[0],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction add_point(e: MouseEvent) {\n\t\t\tif (!svg.value) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tEventHelper.normalized_position_0_1(e, svg.value, _start_normalized_mouse_pos);\n\t\t\tconst new_position = _start_normalized_mouse_pos.x;\n\t\t\tlet new_point_index = ramp_points.value.length - 1;\n\n\t\t\tramp_points.value.forEach((ramp_point, i) => {\n\t\t\t\tif (ramp_point.position < new_position) {\n\t\t\t\t\tnew_point_index = i;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst new_json_point = {\n\t\t\t\tposition: _start_normalized_mouse_pos.x,\n\t\t\t\tvalue: 1 - _start_normalized_mouse_pos.y, // not sure why 1+\n\t\t\t};\n\t\t\tramp_points.value.splice(new_point_index + 1, 0, new_json_point);\n\n\t\t\tcreate_history_command();\n\t\t}\n\n\t\t// are_points_ordered: ->\n\t\t// \tprev_pos = -1\n\t\t// \tresult = true\n\t\t// \tramp_points.forEach (ramp_point, i)=>\n\t\t// \t\tif ramp_point.position <= prev_pos\n\t\t// \t\t\tresult = false\n\t\t// \t\tprev_pos = ramp_point.position\n\n\t\t// \tresult\n\n\t\t// reorder_points_if_required: ->\n\t\t// \tconsole.log(\"reorder_points_if_required\", reorder_points_if_required)\n\t\t// \tif !are_points_ordered()\n\t\t// \t\tvalues_by_position = {}\n\t\t// \t\tramp_points.forEach (ramp_point)->\n\t\t// \t\t\tvalues_by_position[ramp_point.position] = values_by_position[ramp_point.position] || []\n\t\t// \t\t\tvalues_by_position[ramp_point.position].push(ramp_point.value)\n\t\t// \t\tpositions = Object.keys(values_by_position).map (p) ->\n\t\t// \t\t\tparseFloat(p)\n\t\t// \t\tpositions = positions.sort()\n\t\t// \t\tconsole.log(positions)\n\n\t\t// \t\tnew_ramp_points = []\n\t\t// \t\tpositions.forEach (position)->\n\t\t// \t\t\tvalues = values_by_position[position]\n\t\t// \t\t\tvalues.forEach (value)->\n\t\t// \t\t\t\tnew_ramp_points.push\n\t\t// \t\t\t\t\tposition: position\n\t\t// \t\t\t\t\tvalue: value\n\n\t\t// \t\tconsole.log new_ramp_points.map (p)->\n\t\t// \t\t\tp.value\n\t\t// \t\tVue.set(this, 'ramp_points', new_ramp_points)\n\n\t\tconst _start_point_value: RampPointJson = {position: 0, value: 0};\n\t\tfunction on_point_move_start(e: MouseEvent, index: number) {\n\t\t\tif (!svg.value) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdragged_point_index.value = index;\n\t\t\tEventHelper.normalized_position_0_1(e, svg.value, _start_normalized_mouse_pos);\n\n\t\t\tconst point = ramp_points.value[dragged_point_index.value];\n\t\t\tif (point) {\n\t\t\t\t_start_point_value.position = point.position;\n\t\t\t\t_start_point_value.value = point.value;\n\n\t\t\t\tCoreDom.add_drag_classes();\n\t\t\t\tdocument.addEventListener('mousemove', on_pointmove_drag);\n\t\t\t\tdocument.addEventListener('mouseup', on_pointmove_end);\n\t\t\t}\n\t\t}\n\t\tconst normalized_pos = new Vector2();\n\t\tfunction on_pointmove_drag(e: MouseEvent) {\n\t\t\tif (!svg.value) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tEventHelper.normalized_position_0_1(e, svg.value, normalized_pos);\n\n\t\t\tpoint_about_to_be_removed.value = pos_far_enough_to_remove_point(normalized_pos);\n\n\t\t\tconst delta = {\n\t\t\t\tx: normalized_pos.x - _start_normalized_mouse_pos.x,\n\t\t\t\ty: normalized_pos.y - _start_normalized_mouse_pos.y,\n\t\t\t};\n\n\t\t\tconst point = ramp_points.value[dragged_point_index.value];\n\t\t\tif (point) {\n\t\t\t\tpoint.position = CoreMath.clamp(_start_point_value.position + delta.x, 0, 1);\n\t\t\t\tpoint.value = CoreMath.clamp(_start_point_value.value - delta.y, 0, 1);\n\t\t\t}\n\n\t\t\t// reorder_points_if_required()\n\t\t\tupdate_curve();\n\t\t}\n\n\t\tconst on_pointmove_end_normalized_pos = new Vector2();\n\t\tfunction on_pointmove_end(e: MouseEvent) {\n\t\t\tif (!svg.value) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tEventHelper.normalized_position_0_1(e, svg.value, on_pointmove_end_normalized_pos);\n\n\t\t\t// remove point if dragged outside\n\t\t\tif (pos_far_enough_to_remove_point(on_pointmove_end_normalized_pos)) {\n\t\t\t\tramp_points.value.splice(dragged_point_index.value, 1);\n\t\t\t}\n\n\t\t\tdragged_point_index.value = -1;\n\t\t\tpoint_about_to_be_removed.value = false;\n\t\t\tdocument.removeEventListener('mousemove', on_pointmove_drag);\n\t\t\tdocument.removeEventListener('mouseup', on_pointmove_end);\n\t\t\tCoreDom.remove_drag_classes();\n\t\t\tcreate_history_command();\n\t\t}\n\n\t\tfunction pos_far_enough_to_remove_point(normalized_pos: Vector2Like) {\n\t\t\tconst margin = 0.5;\n\t\t\treturn (\n\t\t\t\tnormalized_pos.x < -margin ||\n\t\t\t\tnormalized_pos.x > 1 + margin ||\n\t\t\t\tnormalized_pos.y < -margin ||\n\t\t\t\tnormalized_pos.y > 1 + margin\n\t\t\t);\n\t\t}\n\n\t\tfunction create_history_command() {\n\t\t\tconst value = RampValue.from_json({\n\t\t\t\tinterpolation: interpolation.value,\n\t\t\t\tpoints: ramp_points.value,\n\t\t\t});\n\t\t\tconst cmd = new ParamSetCommand(param, value);\n\t\t\tcmd.push();\n\t\t}\n\n\t\treturn {\n\t\t\tsvg,\n\t\t\tcontrol_point_positions_percent,\n\t\t\tcontrol_point_values_percent,\n\t\t\tcurve_point_positions_percent,\n\t\t\tcurve_point_values_percent,\n\t\t\tcontrol_point_class_objects,\n\t\t\tinterpolated_curve_class_object,\n\t\t\t// functions\n\t\t\tadd_point,\n\t\t\ton_point_move_start,\n\t\t\t// mixins\n\t\t\t...setup_field_common,\n\t\t\t...SetupContextMenu(props.json_param, param),\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ramp.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"525b4ff1\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ramp.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ramp.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Param.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"277e293f\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Param.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Param.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Params.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"cfce9058\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Params.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Params.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// import CameraMenu from './Mixin/CameraMenu';\n// import Display from './Mixin/Display';\n// import EventDisplay from './Mixin/EventDisplay';\n// import {JsonMixin} from './Mixin/Json';\n// import NodeOwner from 'src/Editor/Component/Mixin/NodeOwner';\n// import Panel from './Mixin/Panel';\n// import {ViewerCapture} from './Mixin/ViewerCapture';\n\nimport ThreejsViewer from './components/Threejs.vue';\n// const AsyncThreejsViewer = () => ({\n// \tcomponent: import('./components/Threejs.vue'),\n// });\n\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\n\nimport {defineComponent, ref, computed} from '@vue/composition-api';\nimport {EngineNodeData} from '../../../store/modules/Engine';\nimport {DropDownMenuEntry} from '../../types/props';\nexport default defineComponent({\n\tname: 'viewer-panel',\n\tcomponents: {\n\t\tThreejsViewer,\n\t},\n\tprops: {\n\t\tpanel_id: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tsetup(props) {\n\t\tconst current_camera_node_graph_id = ref<string | null>(\n\t\t\tStoreController.scene.cameras_controller.master_camera_node?.graph_node_id\n\t\t);\n\t\tconst current_camera_node = computed(() => {\n\t\t\tif (current_camera_node_graph_id.value) {\n\t\t\t\treturn StoreController.scene.graph.node_from_id(\n\t\t\t\t\tcurrent_camera_node_graph_id.value\n\t\t\t\t) as BaseCameraObjNodeType;\n\t\t\t}\n\t\t});\n\n\t\tconst camera_menu_label = computed(() => {\n\t\t\treturn current_camera_node.value?.name || 'no camera';\n\t\t});\n\t\tconst camera_menu_entries = computed(() => {\n\t\t\tconst root_json_children: EngineNodeData[] = StoreController.scene.root\n\t\t\t\t.children()\n\t\t\t\t.map((c) => StoreController.engine.json_node(c.graph_node_id)!)\n\t\t\t\t.filter((data) => data != null);\n\t\t\tconst camera_types = ['perspective_camera', 'orthographic_camera'];\n\t\t\tconst camera_json_nodes = root_json_children.filter((data) => data && camera_types.includes(data.type));\n\t\t\tconst entries: DropDownMenuEntry[] = camera_json_nodes.map((data) => {\n\t\t\t\tconst entry: DropDownMenuEntry = {\n\t\t\t\t\tid: data.graph_node_id,\n\t\t\t\t\tlabel: data.name,\n\t\t\t\t};\n\t\t\t\treturn entry;\n\t\t\t});\n\t\t\treturn entries;\n\t\t});\n\n\t\tfunction on_select_camera_menu_entry_select(entry_id: string) {\n\t\t\tcurrent_camera_node_graph_id.value = entry_id;\n\t\t}\n\t\tfunction on_capture_render_completed() {}\n\n\t\tfunction toggle_fullscreen() {\n\t\t\tif (StoreController.editor.panel.fullscreen_panel_id()) {\n\t\t\t\tStoreController.editor.panel.set_fullscreen_panel_id(null);\n\t\t\t} else {\n\t\t\t\tStoreController.editor.panel.set_fullscreen_panel_id(props.panel_id);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcamera_menu_label,\n\t\t\tcamera_menu_entries,\n\t\t\ton_select_camera_menu_entry_select,\n\t\t\tcurrent_camera_node_graph_id,\n\t\t\ton_capture_render_completed,\n\t\t\ttoggle_fullscreen,\n\t\t};\n\t},\n\n\t// mixins: [\n\t// \tCameraMenu,\n\t// \tDisplay,\n\t// \tEventDisplay,\n\t// \tJsonMixin,\n\t// \tNodeOwner,\n\t// \tPanel,\n\t// \tViewerCapture,\n\t// ],\n\t// components: {\n\t// \tThreejsViewer: AsyncThreejsViewer,\n\t// },\n\n\t// props: {\n\t// \tpanel_id: {\n\t// \t\ttype: Array,\n\t// \t\tdefault: () => {\n\t// \t\t\treturn [];\n\t// \t\t},\n\t// \t},\n\t// \tscene_update_allowed: {\n\t// \t\ttype: Boolean,\n\t// \t\tdefault: false,\n\t// \t},\n\t// },\n\n\t// mounted() {\n\t// \tPOLY.register_viewer(this);\n\t// },\n\t// destroyed() {\n\t// \tPOLY.deregister_viewer(this);\n\t// },\n\n\t// computed: {\n\t// \tplayer_mode() {\n\t// \t\treturn POLY.player_mode();\n\t// \t},\n\t// },\n});\n","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Threejs.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Threejs.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// import {CameraCommon} from '../Mixin/CameraCommon';\n// import {Camera} from './Mixin/Camera';\n// import NodeOwner from 'src/Editor/Component/Mixin/NodeOwner';\n// import {Picker} from '../Mixin/Picker';\n// import {Player} from '../Mixin/Player';\n// import {ViewerComponentCapture} from './Mixin/ViewerComponentCapture';\n// import {WindowResize} from './Mixin/WindowResize';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\nimport {ThreejsViewer} from 'src/engine/viewers/Threejs';\n\nimport {defineComponent, onMounted, onBeforeUnmount, computed, ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'viewer-threejs',\n\t// mixins: [\n\t// \tCamera,\n\t// \tCameraCommon,\n\t// \tNodeOwner,\n\t// \tPicker,\n\t// \tPlayer,\n\t// \tViewerComponentCapture,\n\t// \tWindowResize\n\t// ],\n\tprops: {\n\t\tcurrent_camera_node_graph_id: {\n\t\t\ttype: String,\n\t\t},\n\t},\n\n\tsetup(props) {\n\t\t// const do_render = ref(true)\n\t\tconst viewer = ref<HTMLElement>(null);\n\n\t\tconst current_camera_node = computed(() => {\n\t\t\tif (props.current_camera_node_graph_id) {\n\t\t\t\treturn StoreController.scene.graph.node_from_id(\n\t\t\t\t\tprops.current_camera_node_graph_id\n\t\t\t\t) as BaseCameraObjNodeType;\n\t\t\t}\n\t\t});\n\n\t\tlet camera_viewer: ThreejsViewer | undefined;\n\t\tonMounted(() => {\n\t\t\tif (viewer.value) {\n\t\t\t\tcamera_viewer = current_camera_node.value?.create_viewer(viewer.value);\n\t\t\t}\n\t\t});\n\t\tonBeforeUnmount(() => {\n\t\t\tcamera_viewer?.dispose();\n\t\t});\n\n\t\t// const display_scene = computed(()=>{\n\n\t\t// })\n\n\t\t// functions\n\t\t// function on_resize(){\n\t\t// \tcamera_viewer?.on_resize();\n\t\t// }\n\t\t// function canvas_for_capture() {\n\t\t// \treturn camera_viewer?.canvas();\n\t\t// }\n\n\t\treturn {\n\t\t\tviewer,\n\t\t};\n\t},\n\n\t// computed: {\n\t// \tdisplay_scene() {\n\t// \t\treturn this._display_scene != null ? this._display_scene : (this._display_scene = this.$store.scene.display_scene());\n\t// \t}\n\t// },\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Threejs.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"09518a1a\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Threejs.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Threejs.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"3e103248\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Spreadsheet.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Spreadsheet.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport '@ag-grid-community/all-modules/dist/styles/ag-grid.css';\nimport '@ag-grid-community/all-modules/dist/styles/ag-theme-balham.css';\nimport Vue from 'vue';\n\n// internal libs\nimport {CoreConstant} from 'src/core/geometry/Constant';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\n// components\nimport {AllCommunityModules} from '@ag-grid-community/all-modules';\nimport {AgGridVue} from '@ag-grid-community/vue';\nimport {CoreGraphNode} from '../../../../core/graph/CoreGraphNode';\nimport {StoreController} from '../../../store/controllers/StoreController';\nimport {NodeContext} from '../../../../engine/poly/NodeContext';\nimport {BaseSopNodeType} from '../../../../engine/nodes/sop/_Base';\nimport {SetupSelectedNode} from '../../mixins/SelectedNode';\n\n// not sure where to import ag-grid types from yet\n// so mocking them for now\ninterface HeaderName {\n\theaderName: string;\n\tfield?: string;\n\tpinned?: 'left';\n\ttype?: 'indexColumn' | 'numericColumn' | '';\n\tchildren?: HeaderName[];\n}\n\nimport {\n\tdefineComponent,\n\tref,\n\tcomputed,\n\tonBeforeMount,\n\tSetupContext,\n\tonBeforeUnmount,\n\tonMounted,\n\twatch,\n} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'spreadsheet-panel',\n\t// @ts-ignore\n\tcomponents: {\n\t\tAgGridVue: AgGridVue as any,\n\t},\n\n\tsetup(props, context: SetupContext) {\n\t\tconst loading = ref(true);\n\t\tconst attrib_names = ref<string[]>([]);\n\t\tconst attrib_class_vertex = ref(true);\n\t\tconst attrib_selected_states_by_name = ref<Dictionary<boolean>>({});\n\t\tconst header_names = ref<HeaderName[]>([]);\n\t\tconst table_data = ref<Dictionary<number>[]>([]);\n\t\tmodules: AllCommunityModules;\n\n\t\t// find first_selected_node\n\t\tconst {first_selected_node_id, first_selected_node} = SetupSelectedNode();\n\t\tfunction first_selected_sop_node() {\n\t\t\tconst node = first_selected_node();\n\t\t\tif (node && node.node_context() == NodeContext.SOP) {\n\t\t\t\treturn node as BaseSopNodeType;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tonBeforeMount(() => {\n\t\t\tcontext.emit('created');\n\t\t});\n\n\t\tconst graph_node = new CoreGraphNode(StoreController.scene, 'Spreadsheet_Panel');\n\t\tgraph_node.add_post_dirty_hook('load_geometry', () => {\n\t\t\tload_geometry();\n\t\t});\n\t\tonMounted(() => {\n\t\t\tconnect_graph_node_if_node_is_sop();\n\t\t});\n\t\tfunction connect_graph_node_if_node_is_sop() {\n\t\t\tconst first_selected_node = first_selected_sop_node();\n\t\t\tif (first_selected_node) {\n\t\t\t\tgraph_node.add_graph_input(first_selected_node);\n\t\t\t\tload_geometry();\n\t\t\t}\n\t\t}\n\t\tonBeforeUnmount(() => {\n\t\t\tgraph_node.graph_disconnect_predecessors();\n\t\t});\n\n\t\t// computed\n\t\tconst class_object_object_button = computed(() => {\n\t\t\treturn {active: attrib_class_vertex.value == false};\n\t\t});\n\n\t\tconst defaultColDef = computed(() => {\n\t\t\treturn {\n\t\t\t\teditable: true,\n\t\t\t\twidth: 100,\n\t\t\t\tsortable: true,\n\t\t\t\tresizable: true,\n\t\t\t};\n\t\t});\n\t\tconst columnTypes = computed(() => {\n\t\t\treturn {\n\t\t\t\tindexColumn: {\n\t\t\t\t\teditable: false,\n\t\t\t\t\twidth: 30,\n\t\t\t\t},\n\t\t\t};\n\t\t});\n\n\t\tconst attrib_selected_states = computed(() => {\n\t\t\tconst states: Dictionary<boolean> = {};\n\n\t\t\tfor (let attrib_name of attrib_names.value) {\n\t\t\t\tstates[attrib_name] = attrib_selected_states_by_name.value[attrib_name];\n\t\t\t\tif (states[attrib_name] == null) {\n\t\t\t\t\tstates[attrib_name] = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn states;\n\t\t});\n\n\t\tconst columnDefs = computed(() => {\n\t\t\treturn header_names.value.filter((header_name) => {\n\t\t\t\tconst attrib_name = header_name.headerName;\n\t\t\t\treturn attrib_name === '' || attrib_selected_states.value[attrib_name];\n\t\t\t});\n\t\t});\n\n\t\t// watch\n\t\twatch(first_selected_node_id, (new_id, old_id) => {\n\t\t\tgraph_node.graph_disconnect_predecessors();\n\t\t\tconnect_graph_node_if_node_is_sop();\n\t\t});\n\n\t\twatch(attrib_class_vertex, () => {\n\t\t\tload_geometry();\n\t\t});\n\n\t\t// functions\n\t\t// function from_json(json:object){}\n\t\t// function to_json(){return {}}\n\t\tfunction getRowClass(params: any) {\n\t\t\tif (params.node.rowIndex % 2 === 0) {\n\t\t\t\treturn 'row-odd';\n\t\t\t}\n\t\t}\n\n\t\tfunction set_attrib_class_vertex(new_val: boolean) {\n\t\t\tattrib_class_vertex.value = new_val;\n\t\t}\n\n\t\tfunction toggle_attrib_selection(attrib_name: string) {\n\t\t\tif (attrib_selected_states_by_name.value[attrib_name] == null) {\n\t\t\t\tVue.set(attrib_selected_states_by_name, attrib_name, false);\n\t\t\t} else {\n\t\t\t\tconst inverted_selection = !attrib_selected_states_by_name.value[attrib_name];\n\t\t\t\tVue.set(attrib_selected_states_by_name, attrib_name, inverted_selection);\n\t\t\t}\n\t\t}\n\t\tfunction select_all_attributes() {\n\t\t\tfor (let attrib_name of attrib_names.value) {\n\t\t\t\tVue.set(attrib_selected_states_by_name, attrib_name, true);\n\t\t\t}\n\t\t}\n\t\tfunction select_no_attributes() {\n\t\t\tfor (let attrib_name of attrib_names.value) {\n\t\t\t\tVue.set(attrib_selected_states_by_name, attrib_name, false);\n\t\t\t}\n\t\t}\n\n\t\tasync function load_geometry() {\n\t\t\tconst first_selected_node = first_selected_sop_node();\n\t\t\tif (first_selected_node) {\n\t\t\t\tloading.value = true;\n\t\t\t\tconst container = await first_selected_node.request_container();\n\t\t\t\tif (container.core_content != null) {\n\t\t\t\t\tconst core_group = container.core_content();\n\n\t\t\t\t\tif (core_group) {\n\t\t\t\t\t\tbuild(core_group);\n\t\t\t\t\t}\n\n\t\t\t\t\t// the add dependency is at the end for now, as when looking at a node like Point SOP\n\t\t\t\t\t// with expressions, it gets recooked every time the param position gets dirty,\n\t\t\t\t\t// and therefore for every point. I need a way to avoid that\n\t\t\t\t\t// graph_node.add_graph_input(first_selected_node);\n\n\t\t\t\t\tloading.value = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction build(core_group: CoreGroup) {\n\t\t\tif (attrib_class_vertex) {\n\t\t\t\treturn build_for_points(core_group);\n\t\t\t} else {\n\t\t\t\treturn build_for_objects();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\t//\n\t\t// OBJECTS\n\t\t//\n\t\t//\n\t\tfunction build_for_objects() {\n\t\t\t_build_headers_for_objects();\n\t\t\t_build_table_data_for_objects();\n\t\t}\n\n\t\tfunction _build_headers_for_objects() {\n\t\t\t//\n\t\t\theader_names.value = [];\n\t\t}\n\n\t\tfunction _build_table_data_for_objects() {\n\t\t\t//\n\t\t\treturn table_data;\n\t\t}\n\n\t\t//\n\t\t//\n\t\t// POINTS\n\t\t//\n\t\t//\n\t\tfunction build_for_points(core_group: CoreGroup) {\n\t\t\t_build_headers_for_points(core_group);\n\t\t\t_build_table_data_for_points(core_group);\n\t\t}\n\n\t\tfunction _build_headers_for_points(core_group: CoreGroup) {\n\t\t\t// const points = core_group.points();\n\t\t\tattrib_names.value = core_group.attrib_names();\n\t\t\tconst attrib_sizes = core_group.attrib_sizes();\n\t\t\tconst position_name = 'position';\n\n\t\t\t// header\n\t\t\theader_names.value = [];\n\t\t\theader_names.value.push({\n\t\t\t\theaderName: '',\n\t\t\t\tfield: 'index',\n\t\t\t\tpinned: 'left',\n\t\t\t\ttype: 'indexColumn',\n\t\t\t});\n\t\t\theader_names.value.push({\n\t\t\t\theaderName: position_name,\n\t\t\t\tchildren: [\n\t\t\t\t\t{headerName: 'x', field: 'P_x', type: 'numericColumn'},\n\t\t\t\t\t{headerName: 'y', field: 'P_y', type: 'numericColumn'},\n\t\t\t\t\t{headerName: 'z', field: 'P_z', type: 'numericColumn'},\n\t\t\t\t],\n\t\t\t});\n\t\t\t// header_names.push({headerName: 'P[x]', field: 'P_x', type: 'numericColumn'})\n\t\t\t// header_names.push({headerName: 'P[y]', field: 'P_y', type: 'numericColumn'})\n\t\t\t// header_names.push({headerName: 'P[z]', field: 'P_z', type: 'numericColumn'})\n\n\t\t\tattrib_names.value.sort();\n\t\t\tfor (let i = 0; i < attrib_names.value.length; i++) {\n\t\t\t\tconst attrib_name = attrib_names.value[i];\n\t\t\t\tconst attrib_type = core_group.attrib_type(attrib_name);\n\t\t\t\tconst column_type = attrib_type === CoreConstant.ATTRIB_TYPE.NUMERIC ? 'numericColumn' : '';\n\n\t\t\t\tif (attrib_name !== position_name) {\n\t\t\t\t\tconst attrib_size = attrib_sizes[attrib_name];\n\t\t\t\t\tswitch (attrib_size) {\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\theader_names.value.push({\n\t\t\t\t\t\t\t\theaderName: attrib_name,\n\t\t\t\t\t\t\t\tfield: `${attrib_name}_x`,\n\t\t\t\t\t\t\t\ttype: column_type,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\theader_names.value.push({\n\t\t\t\t\t\t\t\theaderName: attrib_name,\n\t\t\t\t\t\t\t\tchildren: ['x', 'y'].map((c) => ({\n\t\t\t\t\t\t\t\t\theaderName: c,\n\t\t\t\t\t\t\t\t\tfield: `${attrib_name}_${c}`,\n\t\t\t\t\t\t\t\t\ttype: column_type,\n\t\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\theader_names.value.push({\n\t\t\t\t\t\t\t\theaderName: attrib_name,\n\t\t\t\t\t\t\t\tchildren: ['x', 'y', 'z'].map((c) => ({\n\t\t\t\t\t\t\t\t\theaderName: c,\n\t\t\t\t\t\t\t\t\tfield: `${attrib_name}_${c}`,\n\t\t\t\t\t\t\t\t\ttype: column_type,\n\t\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\theader_names.value.push({\n\t\t\t\t\t\t\t\theaderName: attrib_name,\n\t\t\t\t\t\t\t\tchildren: ['x', 'y', 'z', 'w'].map((c) => ({\n\t\t\t\t\t\t\t\t\theaderName: c,\n\t\t\t\t\t\t\t\t\tfield: `${attrib_name}_${c}`,\n\t\t\t\t\t\t\t\t\ttype: column_type,\n\t\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction _build_table_data_for_points(core_group: CoreGroup) {\n\t\t\tconst points = core_group.points();\n\t\t\tconst geo_attrib_names = core_group.attrib_names();\n\t\t\tconst attrib_sizes = core_group.attrib_sizes();\n\t\t\tconst position_name = 'position';\n\n\t\t\t// table data\n\t\t\ttable_data.value = points.map((point, i) => {\n\t\t\t\tconst position = point.position();\n\t\t\t\tconst point_attribute_values: Dictionary<number> = {\n\t\t\t\t\tindex: i,\n\t\t\t\t\tP_x: position.x,\n\t\t\t\t\tP_y: position.y,\n\t\t\t\t\tP_z: position.z,\n\t\t\t\t};\n\n\t\t\t\tgeo_attrib_names.forEach((attrib_name, i) => {\n\t\t\t\t\tif (attrib_name !== position_name) {\n\t\t\t\t\t\tconst attrib_size = attrib_sizes[attrib_name];\n\t\t\t\t\t\tconst value = point.attrib_value(attrib_name);\n\t\t\t\t\t\tswitch (attrib_size) {\n\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_x`] = value;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_x`] = value.x;\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_y`] = value.y;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_x`] = value.x;\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_y`] = value.y;\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_z`] = value.z;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_x`] = value.x;\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_y`] = value.y;\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_z`] = value.z;\n\t\t\t\t\t\t\t\tpoint_attribute_values[`${attrib_name}_w`] = value.w;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn point_attribute_values;\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tmodules: AllCommunityModules,\n\t\t\tloading,\n\t\t\tattrib_names,\n\t\t\tattrib_class_vertex,\n\t\t\tattrib_selected_states_by_name,\n\t\t\theader_names,\n\t\t\ttable_data,\n\t\t\t//computed\n\t\t\tclass_object_object_button,\n\t\t\tdefaultColDef,\n\t\t\tcolumnTypes,\n\t\t\tattrib_selected_states,\n\t\t\tcolumnDefs,\n\t\t\t// functions\n\t\t\tgetRowClass,\n\t\t\tset_attrib_class_vertex,\n\t\t\ttoggle_attrib_selection,\n\t\t\tselect_all_attributes,\n\t\t\tselect_no_attributes,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Spreadsheet.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"559306d4\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Spreadsheet.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Spreadsheet.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Multiple.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5ed89e0a\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Multiple.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Multiple.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nimport {defineComponent, ref, watch, computed, onMounted} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'navigation-bar',\n\t// mixins: [NodeOwner],\n\n\tsetup() {\n\t\tconst history = ref<string[]>([]);\n\t\tconst index = ref(0);\n\n\t\tonMounted(() => {\n\t\t\tpush_to_history(current_path.value);\n\t\t});\n\n\t\t// computed\n\t\tconst node = computed(() => StoreController.editor.current_node());\n\t\tconst current_path = computed(() => (node.value ? node.value.full_path() : ''));\n\t\tconst path_elements = computed(() => {\n\t\t\tconst elements = current_path.value.split('/');\n\t\t\telements.shift();\n\t\t\treturn elements;\n\t\t});\n\t\tconst go_backward_allowed = computed(() => {\n\t\t\treturn index.value > 0 && history.value.length > 0;\n\t\t});\n\t\tconst go_forward_allowed = computed(() => {\n\t\t\treturn index.value < history.value.length - 1;\n\t\t});\n\t\tconst go_backward_class_object = computed(() => {\n\t\t\treturn {disabled: !go_backward_allowed.value};\n\t\t});\n\t\tconst go_forward_class_object = computed(() => {\n\t\t\treturn {disabled: !go_forward_allowed.value};\n\t\t});\n\n\t\t// watch\n\t\twatch(() => {\n\t\t\tconst old_path = current_path.value;\n\t\t\tif (current_path.value != history.value[index.value]) {\n\t\t\t\thistory.value.splice(index.value + 1, history.value.length);\n\t\t\t\tpush_to_history(old_path);\n\t\t\t}\n\t\t});\n\n\t\t// methods\n\t\tfunction push_to_history(path: string) {\n\t\t\thistory.value.push(path);\n\t\t\tindex.value = history.value.length - 1;\n\t\t}\n\n\t\tfunction go_to_path_elements_index(i: number) {\n\t\t\tconst path = path_elements.value.slice(0, i + 1).join('/');\n\t\t\tgo_to_path(path);\n\t\t}\n\n\t\tfunction go_backward() {\n\t\t\tindex.value -= 1;\n\t\t\tconst path = history.value[index.value];\n\t\t\tif (path) {\n\t\t\t\tgo_to_path(path);\n\t\t\t}\n\t\t}\n\n\t\tfunction go_forward() {\n\t\t\tindex.value += 1;\n\t\t\tconst path = history.value[index.value];\n\t\t\tif (path) {\n\t\t\t\tgo_to_path(path);\n\t\t\t}\n\t\t}\n\n\t\tfunction go_to_path(path: string) {\n\t\t\tconst node = StoreController.scene.node(path);\n\t\t\tif (node) {\n\t\t\t\tgo_to_node(node);\n\t\t\t}\n\t\t}\n\t\tfunction go_to_node(node: BaseNodeType) {\n\t\t\tStoreController.editor.set_current_node(node);\n\t\t}\n\n\t\treturn {\n\t\t\tpath_elements,\n\t\t\tgo_to_path_elements_index,\n\t\t\tgo_backward_allowed,\n\t\t\tgo_forward_allowed,\n\t\t\tgo_backward_class_object,\n\t\t\tgo_forward_class_object,\n\t\t\tgo_backward,\n\t\t\tgo_forward,\n\t\t\tgo_to_path,\n\t\t\tgo_to_node,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"44df8b49\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlayBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlayBar.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {CoreDom} from 'src/core/Dom';\n\nimport {defineComponent, ref, computed} from '@vue/composition-api';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nexport default defineComponent({\n\tname: 'play_bar',\n\n\t// data: ->\n\t// \tmouse_dragging: false\n\n\tsetup() {\n\t\tconst scrubber = ref<HTMLElement>(null);\n\n\t\tconst scrubber_width = computed(() => {\n\t\t\treturn scrubber.value ? scrubber.value.offsetWidth : 0;\n\t\t});\n\t\tconst frame = computed({\n\t\t\tget: () => StoreController.engine.frame(),\n\t\t\tset: (val) => StoreController.scene.set_frame(val),\n\t\t});\n\t\tconst frame_range = computed(() => StoreController.engine.frame_range());\n\t\tconst frame_range_locked = computed(() => StoreController.engine.frame_range_locked());\n\n\t\tconst frame_range_start = computed({\n\t\t\tget: () => frame_range.value[0],\n\t\t\tset: (val) => StoreController.scene.time_controller.set_frame_range(val, frame_range.value[1]),\n\t\t});\n\t\tconst frame_range_end = computed({\n\t\t\tget: () => frame_range.value[1],\n\t\t\tset: (val) => StoreController.scene.time_controller.set_frame_range(frame_range.value[0], val),\n\t\t});\n\n\t\tconst frame_range_start_locked = computed({\n\t\t\tget: () => frame_range_locked.value[0],\n\t\t\tset: (val) =>\n\t\t\t\tStoreController.scene.time_controller.set_frame_range_locked(val, frame_range_locked.value[1]),\n\t\t});\n\t\tconst frame_range_end_locked = computed({\n\t\t\tget: () => frame_range_locked.value[1],\n\t\t\tset: (val) =>\n\t\t\t\tStoreController.scene.time_controller.set_frame_range_locked(frame_range_locked.value[0], val),\n\t\t});\n\t\tconst frames_count = computed(() => frame_range.value[1] - frame_range.value[0] + 1);\n\n\t\tconst frame_indicator_style_object = computed(() => {\n\t\t\tconst ratio = (frame.value - frame_range.value[0]) / (frames_count.value + 1);\n\t\t\tconst percent = 100 * ratio;\n\t\t\treturn {\n\t\t\t\tleft: `${percent}%`,\n\t\t\t};\n\t\t});\n\n\t\tconst playing = computed(() => StoreController.engine.playing_state());\n\n\t\t// functions\n\t\tfunction toggle_play_pause() {\n\t\t\tStoreController.scene.time_controller.toggle_play_pause();\n\t\t}\n\t\tfunction decrement_frame(e: MouseEvent) {\n\t\t\tif (e.ctrlKey) {\n\t\t\t\tStoreController.scene.set_frame(frame_range.value[0]);\n\t\t\t} else {\n\t\t\t\tStoreController.scene.time_controller.decrement_frame();\n\t\t\t}\n\t\t}\n\t\tfunction increment_frame(e: MouseEvent) {\n\t\t\tif (e.ctrlKey) {\n\t\t\t\tStoreController.scene.set_frame(frame_range.value[1]);\n\t\t\t} else {\n\t\t\t\tStoreController.scene.time_controller.increment_frame();\n\t\t\t}\n\t\t}\n\n\t\tfunction scrubber_set_frame(e: MouseEvent) {\n\t\t\tconst ratio = e.clientX / scrubber_width.value;\n\t\t\tlet frame = ratio * frames_count.value + frame_range.value[0];\n\t\t\tframe = Math.floor(frame);\n\t\t\tStoreController.scene.set_frame(frame);\n\t\t}\n\t\tfunction on_mouse_down() {\n\t\t\t// this.mouse_dragging = true\n\t\t\tCoreDom.add_drag_classes();\n\t\t\tdocument.addEventListener('mousemove', on_mouse_move);\n\t\t\tdocument.addEventListener('mouseup', on_mouse_up);\n\t\t}\n\t\tfunction on_mouse_up() {\n\t\t\t// this.mouse_dragging = false\n\t\t\tdocument.removeEventListener('mousemove', on_mouse_move);\n\t\t\tdocument.removeEventListener('mouseup', on_mouse_up);\n\t\t\tCoreDom.remove_drag_classes();\n\t\t}\n\t\t// on_mouse_leave: ->\n\t\t// \t# this.mouse_dragging = false\n\t\tfunction on_mouse_move(e: MouseEvent) {\n\t\t\t// if this.mouse_dragging\n\t\t\tscrubber_set_frame(e);\n\t\t}\n\n\t\treturn {\n\t\t\tscrubber,\n\t\t\tscrubber_width,\n\t\t\tframe,\n\t\t\tframe_range,\n\t\t\tframe_range_locked,\n\t\t\tframe_range_start,\n\t\t\tframe_range_end,\n\t\t\tframe_range_start_locked,\n\t\t\tframe_range_end_locked,\n\t\t\tframes_count,\n\t\t\tframe_indicator_style_object,\n\t\t\tplaying,\n\n\t\t\t// functions\n\t\t\ttoggle_play_pause,\n\t\t\tdecrement_frame,\n\t\t\tincrement_frame,\n\t\t\ton_mouse_down,\n\t\t\tscrubber_set_frame,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlayBar.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5df98095\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlayBar.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlayBar.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PanelNodeSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PanelNodeSelector.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// components\nimport Modal from '../../widgets/dialogs/Modal.vue';\nimport NodeTree from '../../widgets/NodeTree.vue';\n\nimport {StoreController} from '../../../store/controllers/StoreController';\nimport {ParamSetCommand} from '../../../history/commands/ParamSet';\nimport {NodeContext} from '../../../../engine/poly/NodeContext';\n\nimport {defineComponent, Ref, ref, watch, computed} from '@vue/composition-api';\nimport {OperatorPathParam} from '../../../../engine/params/OperatorPath';\nexport default defineComponent({\n\tname: 'panel-node-selector',\n\tcomponents: {Modal, NodeTree},\n\n\tsetup() {\n\t\tconst selected_graph_node_id = ref<string | null>(null);\n\t\tconst root_id = StoreController.engine.scene.root.graph_node_id;\n\n\t\t// const panel_id = computed(()=>{\n\t\t// \treturn this.$store.getters['editor/panel_node_selector/panel_id'];\n\t\t// })\n\t\tconst param_id = computed(() => {\n\t\t\treturn StoreController.editor.panel_node_selector.param_id();\n\t\t});\n\t\tconst node_context: Readonly<Ref<NodeContext | undefined>> = computed(() => {\n\t\t\tif (param_id.value) {\n\t\t\t\tconst param = StoreController.engine.param(param_id.value);\n\t\t\t\tif (param) {\n\t\t\t\t\treturn param.options.node_selection_context;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst display = computed(() => {\n\t\t\treturn param_id.value != null;\n\t\t});\n\n\t\tconst accept_button_class_object = computed(() => {\n\t\t\treturn {disabled: selected_graph_node_id.value == null};\n\t\t});\n\n\t\twatch(display, () => {\n\t\t\tselected_graph_node_id.value = null;\n\t\t});\n\n\t\t// functions\n\t\tfunction on_select(graph_node_id: string) {\n\t\t\tselected_graph_node_id.value = graph_node_id;\n\t\t}\n\n\t\tfunction accept_selected() {\n\t\t\tif (selected_graph_node_id.value) {\n\t\t\t\tconst selected_node = StoreController.engine.node(selected_graph_node_id.value);\n\t\t\t\tconst param_id = StoreController.editor.panel_node_selector.param_id();\n\t\t\t\tif (param_id) {\n\t\t\t\t\tconst param = StoreController.engine.param(param_id) as OperatorPathParam;\n\t\t\t\t\tif (selected_node && param) {\n\t\t\t\t\t\tconst cmd = new ParamSetCommand(param, selected_node.full_path());\n\t\t\t\t\t\tcmd.push();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// const editor = this.$root.$children[0];\n\t\t\t\t// const viewer = editor.panel_with_id(lodash_clone(this.panel_id));\n\t\t\t\t// viewer.set_event_node(selected_node);\n\n\t\t\t\tclose();\n\t\t\t}\n\t\t}\n\n\t\tfunction close() {\n\t\t\tStoreController.editor.panel_node_selector.close();\n\t\t}\n\n\t\t// to_json() {\n\t\t// \treturn this.refs.modal.to_json();\n\t\t// }\n\n\t\treturn {\n\t\t\troot_id,\n\t\t\tnode_context,\n\t\t\tselected_graph_node_id,\n\t\t\tparam_id,\n\t\t\tdisplay,\n\t\t\taccept_button_class_object,\n\t\t\t// functions\n\t\t\ton_select,\n\t\t\taccept_selected,\n\t\t\tclose,\n\t\t};\n\t},\n});\n","import mod from \"-!../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeTree.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeTree.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport lodash_sortBy from 'lodash/sortBy';\n\ninterface NodeTreeProps {\n\tgraph_node_id: string;\n\tnode_context: NodeContext | null;\n\tselected_graph_node_id: string;\n\tinit_expanded?: boolean;\n}\nimport {NodeContext} from '../../../engine/poly/NodeContext';\nimport {StoreController} from '../../store/controllers/StoreController';\nimport {BaseNodeType} from '../../../engine/nodes/_Base';\n\nimport {defineComponent, ref, computed, SetupContext} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'node-tree',\n\n\tprops: {\n\t\tgraph_node_id: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tnode_context: {\n\t\t\ttype: String,\n\t\t\tdefault() {\n\t\t\t\treturn null;\n\t\t\t},\n\t\t},\n\t\tselected_graph_node_id: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tinit_expanded: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tsetup(props: NodeTreeProps, context: SetupContext) {\n\t\tconst expanded = ref(props.init_expanded || false);\n\t\tconst node = StoreController.engine.node(props.graph_node_id) as BaseNodeType;\n\n\t\tconst selected = computed(() => {\n\t\t\treturn node.graph_node_id == props.selected_graph_node_id;\n\t\t});\n\t\tconst class_object = computed(() => {\n\t\t\treturn {selected: selected.value};\n\t\t});\n\t\tconst expand_label = computed(() => {\n\t\t\tif (expanded.value) {\n\t\t\t\treturn '-';\n\t\t\t} else {\n\t\t\t\treturn '+';\n\t\t\t}\n\t\t});\n\t\tconst expand_button_class_object = computed(() => {\n\t\t\treturn {opacity: expandable.value ? 1 : 0};\n\t\t});\n\n\t\tconst node_name = computed(() => {\n\t\t\tconst parent = node.parent;\n\t\t\tif (parent) {\n\t\t\t\treturn node.name;\n\t\t\t} else {\n\t\t\t\treturn '/';\n\t\t\t}\n\t\t});\n\n\t\tconst children = computed(() => {\n\t\t\tlet list = lodash_sortBy(node.children(), (child) => child.name);\n\t\t\tconst selectable_children: BaseNodeType[] = [];\n\t\t\tif (props.node_context) {\n\t\t\t\tfor (let child of list) {\n\t\t\t\t\tconst has_children_with_context =\n\t\t\t\t\t\tchild.children_allowed() &&\n\t\t\t\t\t\tchild.children_controller &&\n\t\t\t\t\t\tchild.children_controller.has_children_and_grandchildren_with_context(props.node_context);\n\t\t\t\t\tconst is_context = child.node_context() == props.node_context;\n\t\t\t\t\tif (has_children_with_context || is_context) {\n\t\t\t\t\t\tselectable_children.push(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (let child of list) {\n\t\t\t\t\tselectable_children.push(child);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn selectable_children;\n\t\t});\n\n\t\tconst expandable = computed(() => {\n\t\t\treturn node.children_allowed() && node.children().length > 0;\n\t\t});\n\n\t\t// functions\n\t\tfunction toggle_expanded() {\n\t\t\texpanded.value = !expanded.value;\n\t\t}\n\n\t\tfunction on_click() {\n\t\t\tcontext.emit('select', props.graph_node_id);\n\t\t}\n\t\tfunction on_child_select(node_id: string) {\n\t\t\tcontext.emit('select', node_id);\n\t\t}\n\n\t\treturn {\n\t\t\texpanded,\n\t\t\tselected,\n\t\t\tclass_object,\n\t\t\texpand_label,\n\t\t\texpand_button_class_object,\n\t\t\tnode_name,\n\t\t\tchildren,\n\t\t\texpandable,\n\t\t\ttoggle_expanded,\n\t\t\ton_click,\n\t\t\ton_child_select,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeTree.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"27975dda\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeTree.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeTree.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PanelNodeSelector.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"44ce95d5\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PanelNodeSelector.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PanelNodeSelector.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumericSlider.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumericSlider.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// third party lib\nimport lodash_isNumber from 'lodash/isNumber';\nimport lodash_concat from 'lodash/concat';\n\n// internal lib\nimport {CoreDom} from 'src/core/Dom';\nimport {StoreController} from '../../store/controllers/StoreController';\nimport {ParamType} from '../../../engine/poly/ParamType';\nimport {BaseParamType} from '../../../engine/params/_Base';\n\nconst INTEGER_INCREMENTS = [100, 10, 1];\nconst FLOAT_INCREMENTS = [0.1, 0.01, 0.001, 0.0001];\nconst DIVIDER = 20;\n\nimport {ParamSetCommand} from '../../history/commands/ParamSet';\nimport {NumericParamValue} from '../../../engine/params/types/NumericParamValue';\nimport {Color} from 'three/src/math/Color';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Vector4} from 'three/src/math/Vector4';\n\nimport {defineComponent, ref, computed, watch} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'numeric-slider',\n\n\tsetup() {\n\t\tconst new_value = ref<NumericParamValue | null>(null);\n\t\tconst init_value = ref<NumericParamValue | null>(null);\n\t\tconst current_increment_index = ref<number>(0);\n\t\tconst start_x = ref<number | null>(null);\n\t\tconst has_modified_param = ref(false);\n\n\t\tconst param_id = computed(() => {\n\t\t\treturn StoreController.editor.numeric_slider.param_id();\n\t\t});\n\t\tconst json_param = computed(() => {\n\t\t\tif (param_id.value) {\n\t\t\t\treturn StoreController.engine.json_param(param_id.value);\n\t\t\t}\n\t\t});\n\t\tconst main_style_object = computed(() => {\n\t\t\tconst position = StoreController.editor.numeric_slider.position();\n\t\t\treturn {\n\t\t\t\tleft: `${position.x}px`,\n\t\t\t\ttop: `${position.y}px`,\n\t\t\t};\n\t\t});\n\n\t\tconst display = computed(() => {\n\t\t\treturn param_id.value != null;\n\t\t});\n\t\tconst starters_container_class_object = computed(() => {\n\t\t\tif (is_param_integer.value == true) {\n\t\t\t\treturn {\n\t\t\t\t\tinteger: true,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {};\n\t\t\t}\n\t\t});\n\t\tlet param: BaseParamType | undefined = undefined;\n\t\twatch(param_id, () => {\n\t\t\tif (param_id.value) {\n\t\t\t\tparam = StoreController.scene.graph.node_from_id(param_id.value) as BaseParamType;\n\t\t\t} else {\n\t\t\t\tparam = undefined;\n\t\t\t}\n\t\t});\n\t\tconst is_param_integer = computed(() => {\n\t\t\tif (json_param.value) {\n\t\t\t\treturn json_param.value['type'] == ParamType.INTEGER;\n\t\t\t}\n\t\t});\n\t\tconst increments = computed(() => {\n\t\t\tif (is_param_integer.value) {\n\t\t\t\treturn INTEGER_INCREMENTS;\n\t\t\t} else {\n\t\t\t\treturn lodash_concat(INTEGER_INCREMENTS, FLOAT_INCREMENTS);\n\t\t\t}\n\t\t});\n\t\tconst increment_starter_class_objects = computed(() => {\n\t\t\treturn increments.value.map((increment, i) => {\n\t\t\t\tif (i == current_increment_index.value) {\n\t\t\t\t\treturn {active: true};\n\t\t\t\t} else {\n\t\t\t\t\treturn {inactive: true};\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tconst increment_starter_class_actives = computed(() => {\n\t\t\treturn increments.value.map((increment, i) => {\n\t\t\t\treturn i == current_increment_index.value;\n\t\t\t});\n\t\t});\n\t\tconst current_increment = computed(() => {\n\t\t\treturn increments.value[current_increment_index.value];\n\t\t});\n\t\tconst displayed_value = computed(() => {\n\t\t\tif (new_value.value != null) {\n\t\t\t\tif (lodash_isNumber(new_value.value)) {\n\t\t\t\t\treturn new_value.value;\n\t\t\t\t} else {\n\t\t\t\t\tconst val = new_value.value;\n\t\t\t\t\tif (\n\t\t\t\t\t\tval instanceof Color ||\n\t\t\t\t\t\tval instanceof Vector2 ||\n\t\t\t\t\t\tval instanceof Vector3 ||\n\t\t\t\t\t\tval instanceof Vector4\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn val.toArray().join('/');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\twatch(display, async (new_display_value) => {\n\t\t\tif (new_display_value) {\n\t\t\t\tif (param) {\n\t\t\t\t\tawait param.compute();\n\t\t\t\t\tconst val = param.value;\n\t\t\t\t\tstart_x.value = null;\n\t\t\t\t\t// not sure I need to test for isString, but just in case\n\t\t\t\t\t// removing string test, as it creates typings error\n\t\t\t\t\tif (lodash_isNumber(val) /*|| lodash_isString(val)*/) {\n\t\t\t\t\t\tinit_value.value = val;\n\t\t\t\t\t\t// if (init_value.value == null) {\n\t\t\t\t\t\t// \tinit_value.value = 0;\n\t\t\t\t\t\t// }\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tval instanceof Color ||\n\t\t\t\t\t\t\tval instanceof Vector2 ||\n\t\t\t\t\t\t\tval instanceof Vector3 ||\n\t\t\t\t\t\t\tval instanceof Vector4\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tinit_value.value = val.clone();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// this.value = val\n\t\t\t\t\tset_events();\n\t\t\t\t} else {\n\t\t\t\t\tunset_events();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tunset_events();\n\t\t\t}\n\t\t});\n\n\t\t// function _is_value_multiple_numeric(val: ParamValue): boolean {\n\t\t// \t// const is_color = val instanceof Color;\n\t\t// \t// const is_vector2 = val instanceof Vector2;\n\t\t// \t// const is_vector3 = val instanceof Vector3;\n\t\t// \t// const is_vector4 = val instanceof Vector4;\n\n\t\t// \t// if(val instanceof Color){\n\t\t// \t// \tval.clone()\n\t\t// \t// }\n\t\t// \treturn (val instanceof Color)\n\t\t// }\n\n\t\t// functions\n\t\tfunction set_events() {\n\t\t\tdocument.addEventListener('mousemove', _on_mouse_move);\n\t\t\tdocument.addEventListener('mouseup', _on_mouse_up);\n\n\t\t\tCoreDom.add_drag_classes();\n\t\t\tCoreDom.set_cursor_col_resize();\n\t\t}\n\t\tfunction unset_events() {\n\t\t\tdocument.removeEventListener('mousemove', _on_mouse_move);\n\t\t\tdocument.removeEventListener('mouseup', _on_mouse_up);\n\n\t\t\tCoreDom.remove_drag_classes();\n\t\t\tCoreDom.unset_cursor_col_resize();\n\t\t}\n\t\tfunction set_current_increment_index(i: number) {\n\t\t\tcurrent_increment_index.value = i;\n\t\t}\n\t\tfunction _on_mouse_move(e: MouseEvent) {\n\t\t\tif (start_x.value == null) {\n\t\t\t\tstart_x.value = e.clientX;\n\t\t\t}\n\t\t\tconst pos_delta = e.clientX - start_x.value;\n\t\t\tconst scaled_pos_delta = pos_delta / DIVIDER;\n\t\t\tconst rounded_scaled_pos_delta = pos_delta > 0 ? Math.floor(scaled_pos_delta) : Math.ceil(scaled_pos_delta);\n\n\t\t\tif (Math.abs(rounded_scaled_pos_delta) >= 1 || has_modified_param.value == true) {\n\t\t\t\tlet value_delta = rounded_scaled_pos_delta * current_increment.value;\n\n\t\t\t\t// try and round to avoid 0.000000000001 type of values\n\t\t\t\tif (current_increment.value < 1) {\n\t\t\t\t\tconst increment_inverse = Math.floor(1 / current_increment.value);\n\t\t\t\t\tvalue_delta = Math.floor(value_delta * increment_inverse) / increment_inverse;\n\t\t\t\t}\n\t\t\t\tif (lodash_isNumber(init_value.value)) {\n\t\t\t\t\tnew_value.value = init_value.value + value_delta;\n\t\t\t\t} else {\n\t\t\t\t\tconst val = init_value.value;\n\t\t\t\t\tif (\n\t\t\t\t\t\tval instanceof Color ||\n\t\t\t\t\t\tval instanceof Vector2 ||\n\t\t\t\t\t\tval instanceof Vector3 ||\n\t\t\t\t\t\tval instanceof Vector4\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst new_vector = val.clone().addScalar(value_delta);\n\t\t\t\t\t\tnew_value.value = new_vector; //.toArray();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (param) {\n\t\t\t\t\tparam.set(new_value.value);\n\t\t\t\t}\n\t\t\t\thas_modified_param.value = true;\n\t\t\t}\n\t\t}\n\t\tfunction _on_mouse_up() {\n\t\t\t_close();\n\t\t}\n\t\tfunction _close() {\n\t\t\tif (param) {\n\t\t\t\tconst cmd = new ParamSetCommand(param as any, new_value.value, init_value.value);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t\t// close with a delay so that the on_paste in the field can prevent unwanted paste\n\t\t\tsetTimeout(() => {\n\t\t\t\tStoreController.editor.numeric_slider.close();\n\t\t\t}, 25);\n\t\t}\n\n\t\treturn {\n\t\t\tdisplay,\n\t\t\tmain_style_object,\n\t\t\tstarters_container_class_object,\n\t\t\tincrement_starter_class_objects,\n\t\t\tcurrent_increment_index,\n\t\t\tincrement_starter_class_actives,\n\t\t\tdisplayed_value,\n\t\t\tincrements,\n\t\t\t// functions\n\t\t\tset_current_increment_index,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumericSlider.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"96658186\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumericSlider.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumericSlider.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeContextMenu.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeContextMenu.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {ClipboardHelper} from 'src/editor/helpers/Clipboard';\n\n// components\nimport DropDownMenu from 'src/editor/components/widgets/DropDownMenu.vue';\n\nimport {NodeSetCommentCommand} from 'src/editor/history/commands/NodeSetComment';\nimport {NodeSetOverrideClonableStateCommand} from 'src/editor/history/commands/NodeSetOverrideClonableState';\nimport {StoreController} from '../../../store/controllers/StoreController';\nimport {DropDownMenuEntry} from '../../types/props';\n\nenum NodeContextMenuEntryId {\n\tEDIT_COMMENT = 'edit_comment',\n\tCOPY_FULL_PATH = 'copy_full_path',\n\tTOGGLE_CLONE_INPUTS = 'toggle_clone_inputs',\n}\n\nimport {defineComponent, computed, Ref, watch} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'node-context-menu',\n\tcomponents: {DropDownMenu},\n\n\tsetup() {\n\t\tconst graph_node_id = computed(() => StoreController.editor.context_menu.node_id()!);\n\t\tlet node = StoreController.engine.node(graph_node_id.value)!;\n\t\twatch(graph_node_id, () => {\n\t\t\tnode = StoreController.engine.node(graph_node_id.value)!;\n\t\t});\n\n\t\tconst position = computed(() => StoreController.editor.context_menu.position());\n\t\tconst json_node = computed(() => {\n\t\t\treturn StoreController.engine.json_node(graph_node_id.value)!;\n\t\t});\n\t\tconst active = computed(() => {\n\t\t\treturn graph_node_id.value != null;\n\t\t});\n\t\tconst menu_entries: Readonly<Ref<readonly DropDownMenuEntry[]>> = computed(() => {\n\t\t\tconst entries: DropDownMenuEntry[] = [\n\t\t\t\t{id: NodeContextMenuEntryId.EDIT_COMMENT},\n\t\t\t\t{id: NodeContextMenuEntryId.COPY_FULL_PATH},\n\t\t\t\t// {id: 'enter'},\n\t\t\t\t// {id: 'delete'},\n\t\t\t\t// {id: 'select_inputs'},\n\t\t\t];\n\n\t\t\tif (node && node.io.inputs.override_clonable_state_allowed()) {\n\t\t\t\tconst label = json_node.value.override_clonable_state ? 'set clone inputs ON' : 'set clone inputs OFF';\n\t\t\t\tentries.push({id: NodeContextMenuEntryId.TOGGLE_CLONE_INPUTS, label: label});\n\t\t\t}\n\t\t\treturn entries;\n\t\t});\n\t\tconst style_object = computed(() => {\n\t\t\treturn {\n\t\t\t\ttop: `${Math.floor(position.value.y)}px`,\n\t\t\t\tleft: `${Math.floor(position.value.x)}px`,\n\t\t\t};\n\t\t});\n\n\t\t// functions\n\t\tfunction on_select(entry: string) {\n\t\t\tswitch (entry) {\n\t\t\t\t// case 'copy': copy(); break;\n\t\t\t\tcase NodeContextMenuEntryId.EDIT_COMMENT:\n\t\t\t\t\tedit_comment();\n\t\t\t\t\tbreak;\n\t\t\t\tcase NodeContextMenuEntryId.COPY_FULL_PATH:\n\t\t\t\t\tcopy_full_path();\n\t\t\t\t\tbreak;\n\t\t\t\tcase NodeContextMenuEntryId.TOGGLE_CLONE_INPUTS:\n\t\t\t\t\ttoggle_clone_inputs();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t_close();\n\t\t}\n\t\tasync function edit_comment() {\n\t\t\t// we need to keep a reference to the node,\n\t\t\t// as the component will be gone when the comment is being typed\n\t\t\tconst node_tmp = node;\n\t\t\tconst current_comment = node_tmp.ui_data.comment;\n\t\t\tconst has_comment: boolean = current_comment != null && current_comment != '';\n\t\t\tconst title = has_comment ? 'Change comment' : 'Add comment';\n\t\t\tconst new_comment = await StoreController.editor.dialog_prompt.show({\n\t\t\t\ttitle: title,\n\t\t\t\tdefault_value: current_comment || '',\n\t\t\t\tconfirm_label: 'Save',\n\t\t\t});\n\t\t\t// window.POLY_prompt(this, 'Edit Comment:', node_tmp.ui_data.comment, {\n\t\t\t// \tconfirm_label: 'Update Comment',\n\t\t\t// });\n\t\t\tconst cmd = new NodeSetCommentCommand(node_tmp, new_comment);\n\t\t\tcmd.push();\n\t\t}\n\t\tfunction copy_full_path() {\n\t\t\tconst path = node.full_path();\n\t\t\tClipboardHelper.copy(path);\n\t\t\t// $store.commit('editor/status_bar/notice', `Copied ${path} to clipboard`);\n\t\t}\n\t\tfunction toggle_clone_inputs() {\n\t\t\tconst current_state = node.io.inputs.override_clonable_state();\n\t\t\tconst new_state = !current_state;\n\t\t\tconst cmd = new NodeSetOverrideClonableStateCommand(node, new_state);\n\t\t\tcmd.push();\n\t\t}\n\t\tfunction _close() {\n\t\t\tsetTimeout(() => {\n\t\t\t\tStoreController.editor.context_menu.set_node_id(null);\n\t\t\t}, 10);\n\t\t}\n\n\t\treturn {\n\t\t\tactive,\n\t\t\tmenu_entries,\n\t\t\tstyle_object,\n\t\t\ton_select,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeContextMenu.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"e8588d34\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeContextMenu.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeContextMenu.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamContextMenu.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamContextMenu.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {BaseParamType} from 'src/engine/params/_Base';\n\nimport {CoreWalker} from 'src/core/Walker';\n\n// components\nimport {StoreController} from '../../../store/controllers/StoreController';\n// import {ParamType} from '../../../../engine/poly/ParamType';\nimport {DropDownMenuEntry} from '../../types/props';\nimport {ParamSetCommand} from '../../../history/commands/ParamSet';\n\nenum ParamContextMenuEntryId {\n\tCOPY = 'copy',\n\tPASTE = 'paste',\n\tREVERT_TO_DEFAULT = 'revert_to_default',\n}\n\nenum PasteParamContextMenuEntryId {\n\t// ASSET_PATH = 'asset_path',\n\tVALUE = 'value',\n\tAS_RELATIVE = 'as_relative',\n\tAS_ABSOLUTE = 'as_absolute',\n}\n\nimport {defineComponent, computed, watch} from '@vue/composition-api';\nimport {ClipboardHelper} from '../../../helpers/Clipboard';\nexport default defineComponent({\n\tname: 'param-context-menu',\n\n\tsetup() {\n\t\tconst position = computed(() => {\n\t\t\treturn StoreController.editor.context_menu.position();\n\t\t});\n\t\tconst graph_node_id = computed(() => {\n\t\t\treturn StoreController.editor.context_menu.param_id();\n\t\t});\n\n\t\t// let param\n\t\t// const param = computed(() => {\n\t\t// \tif (graph_node_id.value) {\n\t\t// \t\treturn StoreController.scene.graph.node_from_id(graph_node_id.value) as BaseParamType;\n\t\t// \t}\n\t\t// });\n\t\t// const upload_name_to_paste = computed(() => {\n\t\t// \treturn StoreController.editor.context_menu.upload_name();\n\t\t// });\n\t\tconst param_to_paste = computed(() => {\n\t\t\t// const copied_param = ClipboardHelper.copied_param;\n\t\t\tconst copied_param_graph_node_id = StoreController.editor.clipboard.param_id();\n\t\t\tif (copied_param_graph_node_id) {\n\t\t\t\treturn StoreController.scene.graph.node_from_id(copied_param_graph_node_id) as BaseParamType;\n\t\t\t}\n\t\t});\n\t\tconst active = computed(() => {\n\t\t\treturn graph_node_id.value != null;\n\t\t});\n\t\tlet param: BaseParamType | null = null;\n\t\twatch(active, (new_active) => {\n\t\t\tif (new_active && graph_node_id.value) {\n\t\t\t\tparam = StoreController.scene.graph.node_from_id(graph_node_id.value) as BaseParamType;\n\t\t\t} else {\n\t\t\t\tparam = null;\n\t\t\t}\n\t\t});\n\n\t\tconst menu_entries = computed(() => {\n\t\t\tconst paste_entries: DropDownMenuEntry[] = [];\n\t\t\t// console.log('param', param);\n\t\t\t// if (param && param.type == ParamType.STRING) {\n\t\t\t// \tconst asset_disabled = StoreController.editor.clipboard.upload_name() == null;\n\t\t\t// \tpaste_entries.push({\n\t\t\t// \t\tid: PasteParamContextMenuEntryId.ASSET_PATH,\n\t\t\t// \t\tlabel: 'Asset Path',\n\t\t\t// \t\tdisabled: asset_disabled,\n\t\t\t// \t});\n\t\t\t// }\n\n\t\t\tconst param_disabled = param_to_paste.value == null;\n\t\t\tpaste_entries.push({id: PasteParamContextMenuEntryId.VALUE, label: 'Values', disabled: param_disabled});\n\t\t\tpaste_entries.push({\n\t\t\t\tid: PasteParamContextMenuEntryId.AS_RELATIVE,\n\t\t\t\tlabel: 'As Relative',\n\t\t\t\tdisabled: param_disabled,\n\t\t\t});\n\t\t\tpaste_entries.push({\n\t\t\t\tid: PasteParamContextMenuEntryId.AS_ABSOLUTE,\n\t\t\t\tlabel: 'As Absolute',\n\t\t\t\tdisabled: param_disabled,\n\t\t\t});\n\t\t\treturn [\n\t\t\t\t{id: ParamContextMenuEntryId.COPY},\n\t\t\t\t{id: ParamContextMenuEntryId.PASTE, children: paste_entries},\n\t\t\t\t{id: 'revert_to_default'},\n\t\t\t];\n\t\t});\n\t\tconst style_object = computed(() => {\n\t\t\treturn {\n\t\t\t\ttop: `${Math.floor(position.value.y)}px`,\n\t\t\t\tleft: `${Math.floor(position.value.x)}px`,\n\t\t\t};\n\t\t});\n\n\t\t// functions\n\t\tfunction on_select(entry: string) {\n\t\t\tswitch (entry) {\n\t\t\t\tcase ParamContextMenuEntryId.COPY:\n\t\t\t\t\t_copy();\n\t\t\t\t\tbreak;\n\t\t\t\t// case `${ParamContextMenuEntryId.PASTE}/${PasteParamContextMenuEntryId.ASSET_PATH}`:\n\t\t\t\t// \t_paste_upload_expression();\n\t\t\t\t// \tbreak;\n\t\t\t\tcase `${ParamContextMenuEntryId.PASTE}/${PasteParamContextMenuEntryId.VALUE}`:\n\t\t\t\t\t_paste_values();\n\t\t\t\t\tbreak;\n\t\t\t\tcase `${ParamContextMenuEntryId.PASTE}/${PasteParamContextMenuEntryId.AS_RELATIVE}`:\n\t\t\t\t\t_paste_relative_reference();\n\t\t\t\t\tbreak;\n\t\t\t\tcase `${ParamContextMenuEntryId.PASTE}/${PasteParamContextMenuEntryId.AS_ABSOLUTE}`:\n\t\t\t\t\t_paste_absolute_reference();\n\t\t\t\t\tbreak;\n\t\t\t\tcase ParamContextMenuEntryId.REVERT_TO_DEFAULT:\n\t\t\t\t\t_revert_to_default();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t_close();\n\t\t}\n\t\tfunction _copy() {\n\t\t\tif (param) {\n\t\t\t\tClipboardHelper.copy_param(param);\n\t\t\t\t// StoreController.editor.clipboard.set_param_id(param.graph_node_id);\n\t\t\t}\n\t\t}\n\t\t// function _paste_upload_expression() {\n\t\t// \tif (param) {\n\t\t// \t\tconst expression = `\\`asset(\"${upload_name_to_paste.value}\")\\``;\n\t\t// \t\t_set_param_value(expression, param); // we do set as value for string\n\t\t// \t}\n\t\t// }\n\t\tasync function _paste_values() {\n\t\t\tif (param_to_paste.value && param) {\n\t\t\t\tawait param_to_paste.value.compute();\n\t\t\t\tconst new_value = param_to_paste.value.value;\n\t\t\t\t_set_param(new_value, param);\n\t\t\t}\n\t\t}\n\t\tfunction _paste_relative_reference() {\n\t\t\tif (param_to_paste.value && param) {\n\t\t\t\tlet expression: string | undefined = undefined;\n\t\t\t\tif (param_to_paste.value.is_multiple && param_to_paste.value.components) {\n\t\t\t\t\tif (param.is_multiple) {\n\t\t\t\t\t\t// expression = param_to_paste.value.components().map((c, i) => {\n\t\t\t\t\t\t// \treturn `ch(\"${CoreWalker.relative_path(\n\t\t\t\t\t\t// \t\tthis.param.components()[i],\n\t\t\t\t\t\t// \t\tthis.param_to_paste.components()[i]\n\t\t\t\t\t\t// \t)}\")`;\n\t\t\t\t\t\t// });\n\t\t\t\t\t} else {\n\t\t\t\t\t\texpression = `ch(\"${CoreWalker.relative_path(param, param_to_paste.value.components[0])}\")`;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst relative_path = CoreWalker.relative_path(param, param_to_paste.value);\n\t\t\t\t\texpression = `ch(\"${relative_path}\")`;\n\t\t\t\t}\n\t\t\t\tif (param && expression) {\n\t\t\t\t\t_set_param(expression, param);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction _paste_absolute_reference() {\n\t\t\tif (param_to_paste.value && param) {\n\t\t\t\tlet expression: string | undefined = undefined;\n\t\t\t\tif (param_to_paste.value.is_multiple && param_to_paste.value.components != null) {\n\t\t\t\t\tif (param.is_multiple) {\n\t\t\t\t\t\t// expression = param_to_paste.value.components.map((c, i) => {\n\t\t\t\t\t\t// \treturn `ch(\"${this.param_to_paste.components()[i].full_path()}\")`;\n\t\t\t\t\t\t// });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst first_component: BaseParamType = param_to_paste.value.components[0];\n\t\t\t\t\t\tif (first_component) {\n\t\t\t\t\t\t\texpression = `ch(\"${first_component.full_path()}\")`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\texpression = `ch(\"${param_to_paste.value.full_path()}\")`;\n\t\t\t\t}\n\t\t\t\tif (expression && param) {\n\t\t\t\t\t_set_param(expression, param);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction _revert_to_default() {\n\t\t\tif (param) {\n\t\t\t\tconst default_value = param.default_value;\n\t\t\t\t_set_param(default_value, param as BaseParamType);\n\t\t\t}\n\t\t}\n\t\tfunction _set_param(raw_input: any, param: BaseParamType) {\n\t\t\tif (param_to_paste.value && param) {\n\t\t\t\tconst params_are_multiple = param_to_paste.value.is_multiple && param.is_multiple;\n\t\t\t\tconst params_are_single = !param_to_paste.value.is_multiple && !param.is_multiple;\n\t\t\t\t// if both params are multiple or both are single, we can paste the raw_input as is\n\t\t\t\tif (params_are_multiple || params_are_single) {\n\t\t\t\t\t// no change to raw_input\n\t\t\t\t} else {\n\t\t\t\t\t// if one param is multiple and one is single, we need to modify what we paste first\n\t\t\t\t\tif (param_to_paste.value.is_multiple && !param.is_multiple) {\n\t\t\t\t\t\traw_input = raw_input.toArray()[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst raw_input_as_array = [];\n\t\t\t\t\t\tif (param.components) {\n\t\t\t\t\t\t\tfor (let i = 0; i < param.components.length; i++) {\n\t\t\t\t\t\t\t\traw_input_as_array.push(raw_input);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\traw_input = raw_input_as_array;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst cmd = new ParamSetCommand(param as any, raw_input as any);\n\t\t\tcmd.push();\n\n\t\t\t// const target_param:BaseParamType = param || this.param;\n\t\t\t// this._set_param({value: value}, param);\n\t\t}\n\t\t// function _set_param_expression(expression: string, param: BaseParamType) {\n\t\t// \tconst cmd = new ParamSetCommand(param as any, expression as any);\n\t\t// \tcmd.push();\n\t\t// \t// this._set_param({expression: expression});\n\t\t// }\n\t\t// function _set_param(options, param: BaseParam) {\n\t\t// \tparam = param || this.param;\n\t\t// \tconst cmd = new History.Command.ParamSet(param, options);\n\t\t// \tcmd.push(this);\n\t\t// }\n\t\tfunction _close() {\n\t\t\tsetTimeout(() => {\n\t\t\t\tStoreController.editor.context_menu.set_param_id(null);\n\t\t\t}, 10);\n\n\t\t\t// this.$store.commit('editor/menu/param_id', null);\n\t\t}\n\n\t\treturn {\n\t\t\tactive,\n\t\t\ton_select,\n\t\t\tmenu_entries,\n\t\t\tstyle_object,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamContextMenu.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"d05a00d4\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamContextMenu.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamContextMenu.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import mod from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Retractable.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/ts-loader/index.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Retractable.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {defineComponent, ref} from '@vue/composition-api';\nexport default defineComponent({\n\tname: 'retractable',\n\n\tsetup() {\n\t\tconst retracted = ref(false);\n\t\tfunction toggle() {\n\t\t\tretracted.value = !retracted.value;\n\t\t}\n\n\t\treturn {\n\t\t\tretracted,\n\t\t\ttoggle,\n\t\t};\n\t},\n});\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Retractable.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"44f9fc15\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Retractable.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Retractable.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=sass&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"d90fb24e\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=sass&\", function() {\n     var newContent = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=sass&\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */var mod={}, l=void 0,aa=mod;function r(c,d){var a=c.split(\".\"),b=aa;!(a[0]in b)&&b.execScript&&b.execScript(\"var \"+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&d!==l?b[e]=d:b=b[e]?b[e]:b[e]={}};var t=\"undefined\"!==typeof Uint8Array&&\"undefined\"!==typeof Uint16Array&&\"undefined\"!==typeof Uint32Array&&\"undefined\"!==typeof DataView;function v(c){var d=c.length,a=0,b=Number.POSITIVE_INFINITY,e,f,g,h,k,m,n,p,s,x;for(p=0;p<d;++p)c[p]>a&&(a=c[p]),c[p]<b&&(b=c[p]);e=1<<a;f=new (t?Uint32Array:Array)(e);g=1;h=0;for(k=2;g<=a;){for(p=0;p<d;++p)if(c[p]===g){m=0;n=h;for(s=0;s<g;++s)m=m<<1|n&1,n>>=1;x=g<<16|p;for(s=m;s<e;s+=k)f[s]=x;++h}++g;h<<=1;k<<=1}return[f,a,b]};function w(c,d){this.g=[];this.h=32768;this.d=this.f=this.a=this.l=0;this.input=t?new Uint8Array(c):c;this.m=!1;this.i=y;this.r=!1;if(d||!(d={}))d.index&&(this.a=d.index),d.bufferSize&&(this.h=d.bufferSize),d.bufferType&&(this.i=d.bufferType),d.resize&&(this.r=d.resize);switch(this.i){case A:this.b=32768;this.c=new (t?Uint8Array:Array)(32768+this.h+258);break;case y:this.b=0;this.c=new (t?Uint8Array:Array)(this.h);this.e=this.z;this.n=this.v;this.j=this.w;break;default:throw Error(\"invalid inflate mode\");\n}}var A=0,y=1,B={t:A,s:y};\nw.prototype.k=function(){for(;!this.m;){var c=C(this,3);c&1&&(this.m=!0);c>>>=1;switch(c){case 0:var d=this.input,a=this.a,b=this.c,e=this.b,f=d.length,g=l,h=l,k=b.length,m=l;this.d=this.f=0;if(a+1>=f)throw Error(\"invalid uncompressed block header: LEN\");g=d[a++]|d[a++]<<8;if(a+1>=f)throw Error(\"invalid uncompressed block header: NLEN\");h=d[a++]|d[a++]<<8;if(g===~h)throw Error(\"invalid uncompressed block header: length verify\");if(a+g>d.length)throw Error(\"input buffer is broken\");switch(this.i){case A:for(;e+\ng>b.length;){m=k-e;g-=m;if(t)b.set(d.subarray(a,a+m),e),e+=m,a+=m;else for(;m--;)b[e++]=d[a++];this.b=e;b=this.e();e=this.b}break;case y:for(;e+g>b.length;)b=this.e({p:2});break;default:throw Error(\"invalid inflate mode\");}if(t)b.set(d.subarray(a,a+g),e),e+=g,a+=g;else for(;g--;)b[e++]=d[a++];this.a=a;this.b=e;this.c=b;break;case 1:this.j(ba,ca);break;case 2:for(var n=C(this,5)+257,p=C(this,5)+1,s=C(this,4)+4,x=new (t?Uint8Array:Array)(D.length),S=l,T=l,U=l,u=l,M=l,F=l,z=l,q=l,V=l,q=0;q<s;++q)x[D[q]]=\nC(this,3);if(!t){q=s;for(s=x.length;q<s;++q)x[D[q]]=0}S=v(x);u=new (t?Uint8Array:Array)(n+p);q=0;for(V=n+p;q<V;)switch(M=E(this,S),M){case 16:for(z=3+C(this,2);z--;)u[q++]=F;break;case 17:for(z=3+C(this,3);z--;)u[q++]=0;F=0;break;case 18:for(z=11+C(this,7);z--;)u[q++]=0;F=0;break;default:F=u[q++]=M}T=t?v(u.subarray(0,n)):v(u.slice(0,n));U=t?v(u.subarray(n)):v(u.slice(n));this.j(T,U);break;default:throw Error(\"unknown BTYPE: \"+c);}}return this.n()};\nvar G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=t?new Uint16Array(G):G,H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],I=t?new Uint16Array(H):H,J=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],K=t?new Uint8Array(J):J,L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],da=t?new Uint16Array(L):L,ea=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,\n13,13],N=t?new Uint8Array(ea):ea,O=new (t?Uint8Array:Array)(288),P,fa;P=0;for(fa=O.length;P<fa;++P)O[P]=143>=P?8:255>=P?9:279>=P?7:8;var ba=v(O),Q=new (t?Uint8Array:Array)(30),R,ga;R=0;for(ga=Q.length;R<ga;++R)Q[R]=5;var ca=v(Q);function C(c,d){for(var a=c.f,b=c.d,e=c.input,f=c.a,g=e.length,h;b<d;){if(f>=g)throw Error(\"input buffer is broken\");a|=e[f++]<<b;b+=8}h=a&(1<<d)-1;c.f=a>>>d;c.d=b-d;c.a=f;return h}\nfunction E(c,d){for(var a=c.f,b=c.d,e=c.input,f=c.a,g=e.length,h=d[0],k=d[1],m,n;b<k&&!(f>=g);)a|=e[f++]<<b,b+=8;m=h[a&(1<<k)-1];n=m>>>16;if(n>b)throw Error(\"invalid code length: \"+n);c.f=a>>n;c.d=b-n;c.a=f;return m&65535}\nw.prototype.j=function(c,d){var a=this.c,b=this.b;this.o=c;for(var e=a.length-258,f,g,h,k;256!==(f=E(this,c));)if(256>f)b>=e&&(this.b=b,a=this.e(),b=this.b),a[b++]=f;else{g=f-257;k=I[g];0<K[g]&&(k+=C(this,K[g]));f=E(this,d);h=da[f];0<N[f]&&(h+=C(this,N[f]));b>=e&&(this.b=b,a=this.e(),b=this.b);for(;k--;)a[b]=a[b++-h]}for(;8<=this.d;)this.d-=8,this.a--;this.b=b};\nw.prototype.w=function(c,d){var a=this.c,b=this.b;this.o=c;for(var e=a.length,f,g,h,k;256!==(f=E(this,c));)if(256>f)b>=e&&(a=this.e(),e=a.length),a[b++]=f;else{g=f-257;k=I[g];0<K[g]&&(k+=C(this,K[g]));f=E(this,d);h=da[f];0<N[f]&&(h+=C(this,N[f]));b+k>e&&(a=this.e(),e=a.length);for(;k--;)a[b]=a[b++-h]}for(;8<=this.d;)this.d-=8,this.a--;this.b=b};\nw.prototype.e=function(){var c=new (t?Uint8Array:Array)(this.b-32768),d=this.b-32768,a,b,e=this.c;if(t)c.set(e.subarray(32768,c.length));else{a=0;for(b=c.length;a<b;++a)c[a]=e[a+32768]}this.g.push(c);this.l+=c.length;if(t)e.set(e.subarray(d,d+32768));else for(a=0;32768>a;++a)e[a]=e[d+a];this.b=32768;return e};\nw.prototype.z=function(c){var d,a=this.input.length/this.a+1|0,b,e,f,g=this.input,h=this.c;c&&(\"number\"===typeof c.p&&(a=c.p),\"number\"===typeof c.u&&(a+=c.u));2>a?(b=(g.length-this.a)/this.o[2],f=258*(b/2)|0,e=f<h.length?h.length+f:h.length<<1):e=h.length*a;t?(d=new Uint8Array(e),d.set(h)):d=h;return this.c=d};\nw.prototype.n=function(){var c=0,d=this.c,a=this.g,b,e=new (t?Uint8Array:Array)(this.l+(this.b-32768)),f,g,h,k;if(0===a.length)return t?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);f=0;for(g=a.length;f<g;++f){b=a[f];h=0;for(k=b.length;h<k;++h)e[c++]=b[h]}f=32768;for(g=this.b;f<g;++f)e[c++]=d[f];this.g=[];return this.buffer=e};\nw.prototype.v=function(){var c,d=this.b;t?this.r?(c=new Uint8Array(d),c.set(this.c.subarray(0,d))):c=this.c.subarray(0,d):(this.c.length>d&&(this.c.length=d),c=this.c);return this.buffer=c};function W(c,d){var a,b;this.input=c;this.a=0;if(d||!(d={}))d.index&&(this.a=d.index),d.verify&&(this.A=d.verify);a=c[this.a++];b=c[this.a++];switch(a&15){case ha:this.method=ha;break;default:throw Error(\"unsupported compression method\");}if(0!==((a<<8)+b)%31)throw Error(\"invalid fcheck flag:\"+((a<<8)+b)%31);if(b&32)throw Error(\"fdict flag is not supported\");this.q=new w(c,{index:this.a,bufferSize:d.bufferSize,bufferType:d.bufferType,resize:d.resize})}\nW.prototype.k=function(){var c=this.input,d,a;d=this.q.k();this.a=this.q.a;if(this.A){a=(c[this.a++]<<24|c[this.a++]<<16|c[this.a++]<<8|c[this.a++])>>>0;var b=d;if(\"string\"===typeof b){var e=b.split(\"\"),f,g;f=0;for(g=e.length;f<g;f++)e[f]=(e[f].charCodeAt(0)&255)>>>0;b=e}for(var h=1,k=0,m=b.length,n,p=0;0<m;){n=1024<m?1024:m;m-=n;do h+=b[p++],k+=h;while(--n);h%=65521;k%=65521}if(a!==(k<<16|h)>>>0)throw Error(\"invalid adler-32 checksum\");}return d};var ha=8;r(\"Zlib.Inflate\",W);r(\"Zlib.Inflate.prototype.decompress\",W.prototype.k);var X={ADAPTIVE:B.s,BLOCK:B.t},Y,Z,$,ia;if(Object.keys)Y=Object.keys(X);else for(Z in Y=[],$=0,X)Y[$++]=Z;$=0;for(ia=Y.length;$<ia;++$)Z=Y[$],r(\"Zlib.Inflate.BufferType.\"+Z,X[Z]);\nvar Zlib=mod.Zlib;\nexport { Zlib }","import {PolyScene} from '../PolyScene';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\n\nexport class CamerasController {\n\tconstructor(private scene: PolyScene) {}\n\n\t_master_camera_node_path: string | null = null;\n\n\tset_master_camera_node_path(camera_node_path: string) {\n\t\tthis._master_camera_node_path = camera_node_path;\n\t}\n\tget master_camera_node_path() {\n\t\treturn this._master_camera_node_path;\n\t}\n\tget master_camera_node(): BaseCameraObjNodeType | null {\n\t\tif (this.master_camera_node_path) {\n\t\t\tconst camera_node = this.scene.node(this.master_camera_node_path) as BaseCameraObjNodeType | null;\n\t\t\treturn camera_node;\n\t\t} else {\n\t\t\tconsole.warn('master camera node not found');\n\t\t\treturn this._find_any_camera();\n\t\t}\n\t}\n\n\tprivate _find_any_camera(): BaseCameraObjNodeType | null {\n\t\tconst root = this.scene.root;\n\t\treturn root.nodes_by_type('perspective_camera')[0] || root.nodes_by_type('orthographic_camera')[0];\n\t}\n}\n","// import {CoreGraphNode} from './CoreGraphNode';\n// import { CoreGraphNodeScene } from './CoreGraphNodeScene';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {PolyScene} from '../PolyScene';\n\n// interface CookerQueue {\n// \t[propName: string]: CoreGraphNodeSceneNamed;\n// }\n\nexport class Cooker {\n\tprivate _queue: Map<string, CoreGraphNode | undefined> = new Map<string, CoreGraphNode | undefined>();\n\tprivate _block_level: number = 0;\n\tprivate _process_item_bound = this._process_item.bind(this);\n\n\tconstructor(private _scene: PolyScene) {\n\t\tthis._block_level = 0;\n\t}\n\n\tblock() {\n\t\tthis._block_level += 1;\n\t}\n\tunblock() {\n\t\tthis._block_level -= 1;\n\t\tif (this._block_level < 0) {\n\t\t\tthis._block_level = 0;\n\t\t}\n\n\t\tthis.process_queue();\n\t}\n\t// unblock_later: ->\n\t// \tsetTimeout( this.unblock.bind(this), 0 )\n\tget blocked() {\n\t\treturn this._block_level > 0;\n\t}\n\n\tenqueue(node: CoreGraphNode, original_trigger_graph_node?: CoreGraphNode) {\n\t\tthis._queue.set(node.graph_node_id, original_trigger_graph_node);\n\t}\n\n\tprocess_queue() {\n\t\tif (this.blocked) {\n\t\t\treturn;\n\t\t}\n\t\t// let node: CoreGraphNode;\n\t\t// console.warn('FLUSH', Object.keys(this._queue).length);\n\n\t\tthis._queue.forEach(this._process_item_bound);\n\t\t// for (let id of Object.keys(this._queue)) {\n\t\t// \tnode = this._queue[id];\n\t\t// \tif (node) {\n\t\t// \t\tdelete this._queue[id];\n\t\t// \t\tnode.dirty_controller.run_post_dirty_hooks();\n\t\t// \t}\n\t\t// }\n\t}\n\tprivate _process_item(original_trigger_graph_node: CoreGraphNode | undefined, id: string) {\n\t\tconst node = this._scene.graph.node_from_id(id);\n\t\tif (node) {\n\t\t\tthis._queue.delete(id);\n\t\t\tnode.dirty_controller.run_post_dirty_hooks(original_trigger_graph_node);\n\t\t}\n\t}\n}\n","import {Graph, alg} from '@dagrejs/graphlib';\n// import lodash_uniq from 'lodash/uniq';\n// import lodash_flatten from 'lodash/flatten';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\n// import {NodeSimple} from './NodeSimple'\n// import {GraphNode} from './concerns/GraphNode'\n// import {SceneNodeDirtyable} from './SceneNodeDirtyable';\n\n// class DummyClass {}\n// class GraphNodeDummy extends Dirtyable(DummyClass) {}\n\n// TODO: typescript, using ids with a specific type (https://basarat.gitbook.io/typescript/main-1/nominaltyping)\n// export interface CoreGraphNodeId extends String {\n// \t// _CoreGraphNodeIdBrand: string;\n// }\nexport type CoreGraphNodeId = string;\nimport {CoreGraphNode} from './CoreGraphNode';\n\nexport class CoreGraph {\n\t_graph: Graph;\n\t_next_id: number = 0;\n\t_scene: PolyScene | undefined;\n\n\tconstructor() {\n\t\tthis._graph = new Graph({\n\t\t\tdirected: true,\n\t\t\tcompound: false,\n\t\t\tmultigraph: true,\n\t\t});\n\t}\n\n\tgraph() {\n\t\treturn this._graph;\n\t}\n\tset_scene(scene: PolyScene) {\n\t\tthis._scene = scene;\n\t}\n\tscene() {\n\t\treturn this._scene;\n\t}\n\n\tnext_id(): CoreGraphNodeId {\n\t\treturn (<unknown>`${(this._next_id += 1)}`) as CoreGraphNodeId;\n\t}\n\n\tsetNode(node: CoreGraphNode) {\n\t\tthis._graph.setNode(node.graph_node_id, node);\n\t}\n\n\tremoveNode(node: CoreGraphNode) {\n\t\tthis._graph.removeNode(node.graph_node_id);\n\t}\n\n\tnodes_from_ids(ids: string[]) {\n\t\tconst nodes: CoreGraphNode[] = [];\n\t\tfor (let id of ids) {\n\t\t\tconst node = this.node_from_id(id);\n\t\t\tif (node) {\n\t\t\t\tnodes.push(node);\n\t\t\t}\n\t\t}\n\t\treturn nodes;\n\t\t// if (ids) {\n\t\t// \tlet node: any;\n\t\t// \treturn ids.map((id) => {\n\t\t// \t\tif ((node = this.node_from_id(id)) != null) {\n\t\t// \t\t\treturn node;\n\t\t// \t\t} else {\n\t\t// \t\t\treturn console.warn(`could not find node with id ${id}`);\n\t\t// \t\t}\n\t\t// \t});\n\t\t// } else {\n\t\t// \treturn [];\n\t\t// }\n\t}\n\t// TODO: typescript: this should return CoreGraphNodeId|null\n\tnode_from_id(id: string): CoreGraphNode {\n\t\treturn this._graph.node(id);\n\t}\n\n\tconnect(src: CoreGraphNode, dest: CoreGraphNode): boolean {\n\t\tconst src_id = src.graph_node_id;\n\t\tconst dest_id = dest.graph_node_id;\n\n\t\tif (this._graph.hasNode(src_id) && this._graph.hasNode(dest_id)) {\n\t\t\tthis._graph.setEdge(src_id, dest_id);\n\n\t\t\t// const scene_auto_updating = this.scene().auto_updating();\n\t\t\tconst scene_loading = this._scene ? this._scene.loading_controller.is_loading : true;\n\t\t\tconst check_if_graph_has_cycle = !scene_loading;\n\t\t\tlet graph_has_cycle = false;\n\t\t\tif (check_if_graph_has_cycle) {\n\t\t\t\tgraph_has_cycle = !alg.isAcyclic(this._graph);\n\t\t\t}\n\n\t\t\tif (graph_has_cycle) {\n\t\t\t\tthis._graph.removeEdge(src_id, dest_id);\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tsrc.dirty_controller.clear_successors_cache_with_predecessors();\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(`attempt to connect non existing node ${src_id} or ${dest_id}`);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tdisconnect(src: CoreGraphNode, dest: CoreGraphNode) {\n\t\tif (src && dest) {\n\t\t\tconst src_id_s = src.graph_node_id;\n\t\t\tconst dest_id_s = dest.graph_node_id;\n\t\t\tthis._graph.removeEdge(src_id_s, dest_id_s);\n\n\t\t\tsrc.dirty_controller.clear_successors_cache_with_predecessors();\n\t\t}\n\t}\n\tdisconnect_predecessors(node: CoreGraphNode) {\n\t\tconst predecessors = this.predecessors(node);\n\t\tfor (let predecessor of predecessors) {\n\t\t\tthis.disconnect(predecessor, node);\n\t\t}\n\t}\n\tdisconnect_successors(node: CoreGraphNode) {\n\t\tconst successors = this.successors(node);\n\t\tfor (let successor of successors) {\n\t\t\tthis.disconnect(node, successor);\n\t\t}\n\t}\n\t// disconnect_predecessors(node){\n\t// \tconst node_id = node.graph_node_id;\n\t// \tconst predecessor_ids = this._graph.predecessors(node_id);\n\t// \tif( predecessor_ids ){\n\t// \t\tfor(let predecessor_id of predecessor_ids){\n\t// \t\t\tthis._graph.removeEdge(predecessor_id, node_id);\n\t// \t\t}\n\t// \t}\n\t// }\n\t// disconnect_successors(node){\n\t// \tconst node_id = node.graph_node_id;\n\t// \tconst successor_ids = this._graph.successors(node_id);\n\t// \tif (successor_ids) {\n\t// \t\tfor(let successor_id of successor_ids){\n\t// \t\t\tthis._graph.removeEdge(node_id, successor_id);\n\t// \t\t}\n\t// \t}\n\t// }\n\n\tpredecessor_ids(id: CoreGraphNodeId) {\n\t\treturn this._graph.predecessors(id) || [];\n\t}\n\tpredecessors(node: CoreGraphNode) {\n\t\tconst ids = this.predecessor_ids(node.graph_node_id);\n\t\treturn this.nodes_from_ids(ids);\n\t}\n\tsuccessor_ids(id: string): CoreGraphNodeId[] {\n\t\treturn this._graph.successors(id) || [];\n\t}\n\tsuccessors(node: CoreGraphNode): CoreGraphNode[] {\n\t\tconst ids = this.successor_ids(node.graph_node_id) || [];\n\t\treturn this.nodes_from_ids(ids);\n\t}\n\n\tprivate all_next_ids(node: CoreGraphNode, method: 'successor_ids' | 'predecessor_ids'): CoreGraphNodeId[] {\n\t\tconst ids: CoreGraphNodeId[] = [];\n\t\tlet next_ids = this[method](node.graph_node_id);\n\n\t\twhile (next_ids.length > 0) {\n\t\t\tconst next_next_ids = [];\n\t\t\tfor (let next_id of next_ids) {\n\t\t\t\tfor (let next_next_id of this[method](next_id)) {\n\t\t\t\t\tnext_next_ids.push(next_next_id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (let id of next_ids) {\n\t\t\t\tids.push(id);\n\t\t\t}\n\t\t\tfor (let id of next_next_ids) {\n\t\t\t\tnext_ids.push(id);\n\t\t\t}\n\t\t\tnext_ids = next_next_ids;\n\t\t}\n\t\treturn ids;\n\t}\n\tall_predecessor_ids(node: CoreGraphNode): CoreGraphNodeId[] {\n\t\treturn this.all_next_ids(node, 'predecessor_ids');\n\t}\n\tall_successor_ids(node: CoreGraphNode): CoreGraphNodeId[] {\n\t\treturn this.all_next_ids(node, 'successor_ids');\n\t}\n\tall_predecessors(node: CoreGraphNode): CoreGraphNode[] {\n\t\tconst ids = this.all_predecessor_ids(node);\n\t\treturn this.nodes_from_ids(ids);\n\t}\n\tall_successors(node: CoreGraphNode): CoreGraphNode[] {\n\t\tconst ids = this.all_successor_ids(node);\n\t\treturn this.nodes_from_ids(ids);\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\n\ntype Callback = (value: void) => void;\n\nexport class CookController {\n\tprivate _cooking_nodes_by_id: Map<string, BaseNodeType> = new Map();\n\tprivate _resolves: Callback[] = [];\n\tconstructor() {}\n\n\tadd_node(node: BaseNodeType) {\n\t\tthis._cooking_nodes_by_id.set(node.graph_node_id, node);\n\t}\n\tremove_node(node: BaseNodeType) {\n\t\tthis._cooking_nodes_by_id.delete(node.graph_node_id);\n\n\t\tif (this._cooking_nodes_by_id.size == 0) {\n\t\t\tthis.flush();\n\t\t}\n\t}\n\n\tprivate flush() {\n\t\tlet callback: Callback | undefined;\n\t\twhile ((callback = this._resolves.pop())) {\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tasync wait_for_cooks_completed(): Promise<void> {\n\t\tif (this._cooking_nodes_by_id.size == 0) {\n\t\t\treturn;\n\t\t} else {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis._resolves.push(resolve);\n\t\t\t});\n\t\t}\n\t}\n}\n","import {PolyScene} from '../PolyScene';\n\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport 'src/engine/Poly';\nimport {POLY} from 'src/engine/Poly';\nimport {SceneEvent} from 'src/engine/poly/SceneEvent';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\nimport {ParamEvent} from 'src/engine/poly/ParamEvent';\n\n// type Callback = (emitter: CoreGraphNodeScene) => void; // TODO: typescript: maybe arg should be an event instead of the emitter\ninterface EventsListener {\n\tprocess_events: (emitter: CoreGraphNode, event_name: SceneEvent | NodeEvent | ParamEvent, data?: any) => void;\n}\n\nexport class EventsController {\n\tconstructor(private scene: PolyScene) {}\n\n\tprivate _events_listener: EventsListener | undefined;\n\n\tset_listener(events_listener: EventsListener) {\n\t\tthis._events_listener = events_listener;\n\t\t// this._store.scene = this;\n\t}\n\tget events_listener() {\n\t\treturn this._events_listener;\n\t}\n\tdispatch(emitter: CoreGraphNode, event_name: SceneEvent | NodeEvent | ParamEvent, data?: any) {\n\t\tthis._events_listener?.process_events(emitter, event_name, data);\n\t}\n\tget emit_allowed(): boolean {\n\t\treturn (\n\t\t\tthis.scene.loading_controller.loaded &&\n\t\t\tthis._events_listener != null &&\n\t\t\tthis.scene.loading_controller.auto_updating &&\n\t\t\t!POLY.player_mode() // TODO: typecript: maybe I should still be able to emit events in player mode? - check how the Event Sop works\n\t\t);\n\t}\n\t// store_commit(event_name: string, payload: any = this) {\n\t// \tif (this._store) {\n\t// \t\tthis._store.commit(`engine/${event_name}`, payload);\n\t// \t}\n\t// }\n}\n","import {WebGLRenderer} from 'three/src/renderers/WebGLRenderer';\nimport {Texture} from 'three/src/textures/Texture';\n// import {NearestFilter, LinearEncoding, HalfFloatType} from 'three/src/constants'\n// import EquirectangularToCubeGenerator from 'src/core/Utils/EquirectangularToCubeGenerator';\n// import PMREMGenerator from 'src/core/Utils/PMREMGenerator';\n// import PMREMCubeUVPacker from 'src/core/Utils/PMREMCubeUVPacker';\n\ninterface RendererByString {\n\t[propName: string]: WebGLRenderer;\n}\ninterface TextureByString {\n\t[propName: string]: Texture;\n}\n\ninterface POLYWebGLRenderer extends WebGLRenderer {\n\t_polygon_id: number;\n}\n\nconst CONTEXT_OPTIONS = {\n\tantialias: true,\n};\n\ntype Callback = (value: WebGLRenderer) => void;\n\nexport class RenderersController {\n\t_next_renderer_id: number = 0;\n\t_next_env_map_id: number = 0;\n\t_renderers: RendererByString = {};\n\t_env_maps: TextureByString = {};\n\tprivate _require_webgl2: boolean = false;\n\tprivate _resolves: Callback[] = [];\n\n\tconstructor() {}\n\n\tset_require_webgl2() {\n\t\tif (!this._require_webgl2) {\n\t\t\tthis._require_webgl2 = true;\n\t\t}\n\t}\n\trendering_context(canvas: HTMLCanvasElement): WebGLRenderingContext {\n\t\tlet gl: WebGLRenderingContext | null = null;\n\t\tif (this._require_webgl2) {\n\t\t\tgl = this._rendering_context_webgl(canvas, true);\n\t\t}\n\t\tif (!gl) {\n\t\t\tgl = this._rendering_context_webgl(canvas, false);\n\t\t}\n\n\t\t// gl.getExtension('OES_standard_derivatives') // for derivative normals, but it cannot work at the moment (see node Gl/DerivativeNormals)\n\t\t// to test data texture\n\t\t// gl.getExtension('OES_texture_float')\n\t\t// gl.getExtension('OES_texture_float_linear')\n\n\t\treturn gl;\n\t}\n\tprivate _rendering_context_webgl(canvas: HTMLCanvasElement, webgl2: boolean): WebGLRenderingContext {\n\t\tlet context_name = webgl2 ? 'webgl2' : 'webgl';\n\t\tlet gl = canvas.getContext(context_name, CONTEXT_OPTIONS);\n\t\tif (!gl) {\n\t\t\tcontext_name = webgl2 ? 'experimental-webgl2' : 'experimental-webgl';\n\t\t\tgl = canvas.getContext(context_name, CONTEXT_OPTIONS);\n\t\t}\n\t\treturn gl as WebGLRenderingContext;\n\t}\n\t// private _rendering_context_webgl(\n\t// \tcanvas: HTMLCanvasElement\n\t// ): WebGLRenderingContext {\n\t// \tlet gl = canvas.getContext('webgl', CONTEXT_OPTIONS)\n\t// \tif (!gl) {\n\t// \t\tgl = canvas.getContext('experimental-webgl', CONTEXT_OPTIONS)\n\t// \t}\n\t// \treturn gl as WebGLRenderingContext\n\t// }\n\n\tregister_renderer(renderer: WebGLRenderer) {\n\t\tif ((renderer as POLYWebGLRenderer)._polygon_id) {\n\t\t\tthrow new Error('render already registered');\n\t\t}\n\t\t(renderer as POLYWebGLRenderer)._polygon_id = this._next_renderer_id += 1;\n\n\t\t// there is a bug where 2 renderers are created from the beginning\n\t\t// because the from_json of the viewer_component is called after\n\t\t// the camera being set for the first time\n\t\t// console.log(\"register renderer\", renderer, renderer._polygon_id)\n\n\t\t// this is being tested in PostProcess\n\t\t// const canvas = renderer.domElement\n\t\t// const gl = canvas.getContext( 'webgl' ) || canvas.getContext( 'experimental-webgl' )\n\t\t// const extension_exist = gl.getExtension('OES_standard_derivatives')\n\t\t// if(!extension_exist){\n\t\t// \tconsole.warn(\"renderers controller: gl extension not available\")\n\t\t// }\n\n\t\tthis._renderers[(renderer as POLYWebGLRenderer)._polygon_id] = renderer;\n\n\t\tif (Object.keys(this._renderers).length == 1) {\n\t\t\tthis.flush_callbacks_with_renderer(renderer);\n\t\t}\n\t}\n\tderegister_renderer(renderer: WebGLRenderer) {\n\t\tdelete this._renderers[(renderer as POLYWebGLRenderer)._polygon_id];\n\t\trenderer.dispose();\n\t}\n\tprivate first_renderer(): WebGLRenderer | null {\n\t\tconst first_id = Object.keys(this._renderers)[0];\n\t\tif (first_id) {\n\t\t\treturn this._renderers[first_id];\n\t\t}\n\t\treturn null;\n\t}\n\trenderers(): WebGLRenderer[] {\n\t\treturn Object.values(this._renderers);\n\t}\n\n\tprivate flush_callbacks_with_renderer(renderer: WebGLRenderer) {\n\t\tlet callback: Callback | undefined;\n\t\twhile ((callback = this._resolves.pop())) {\n\t\t\tcallback(renderer);\n\t\t}\n\t}\n\n\tasync wait_for_renderer(): Promise<WebGLRenderer> {\n\t\tconst renderer = this.first_renderer();\n\t\tif (renderer) {\n\t\t\treturn renderer;\n\t\t} else {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis._resolves.push(resolve);\n\t\t\t});\n\t\t}\n\t}\n\n\t// async register_env_map(env_map: Texture){\n\t// \tconsole.log(\"register_env_map\", env_map)\n\t// \tif(env_map._polygon_id){\n\t// \t\tthrow new Error('cube_map already registered')\n\t// \t}\n\t// \tconst texture = await this.prepare_env_map(env_map)\n\t// \ttexture._polygon_id = (this._next_env_map_id += 1)\n\t// \tthis._env_maps[texture._polygon_id] = texture\n\t// \treturn texture\n\t// }\n\t// deregister_env_map(env_map: Texture){\n\t// \tconsole.log(\"deregister_env_map\", env_map)\n\t// \tdelete this._env_maps[env_map._polygon_id]\n\t// \tenv_map.dispose()\n\t// }\n\n\t// private async prepare_env_map(texture: Texture): Texture{\n\t// \ttexture.minFilter = NearestFilter;\n\t// \ttexture.magFilter = NearestFilter;\n\t// \ttexture.encoding = LinearEncoding;\n\n\t// \tawait CoreScriptLoader.load_three('loaders/EXRLoader')\n\t// \tawait CoreScriptLoader.load_three('loaders/EquirectangularToCubeGenerator')\n\t// \tconst EquirectangularToCubeGenerator_name = 'EquirectangularToCubeGenerator'\n\t// \tconst PMREMGenerator_name = 'PMREMGenerator'\n\t// \tconst PMREMCubeUVPacker_name = 'PMREMCubeUVPacker'\n\n\t// \tconst cubemapGenerator = new THREE[EquirectangularToCubeGenerator_name]( texture, { resolution: 512, type: HalfFloatType } );\n\n\t// \tconst renderer = this.first_renderer()\n\t// \tif(renderer){\n\t// \t\tconst cubeMapTexture = cubemapGenerator.update( renderer );\n\n\t// \t\tconst pmremGenerator = new THREE[PMREMGenerator_name]( cubeMapTexture );\n\t// \t\tpmremGenerator.update( renderer );\n\n\t// \t\tconst pmremCubeUVPacker = new THREE[PMREMCubeUVPacker_name]( pmremGenerator.cubeLods );\n\t// \t\tpmremCubeUVPacker.update( renderer );\n\n\t// \t\trenderer.gammaInput = false;\n\t// \t\trenderer.gammaOutput = true;\n\n\t// \t\tconst exrCubeRenderTarget = pmremCubeUVPacker.CubeUVRenderTarget;\n\n\t// \t\ttexture.dispose();\n\t// \t\tcubemapGenerator.dispose();\n\t// \t\tpmremGenerator.dispose();\n\t// \t\tpmremCubeUVPacker.dispose();\n\n\t// \t\treturn exrCubeRenderTarget.texture;\n\t// \t}\n\t// }\n}\n","import {BaseNodeClass} from 'src/engine/nodes/_Base';\nimport {NodeContext} from './NodeContext';\n\nexport interface RegisterOptions {\n\tonly?: string[];\n}\n\n// export interface BaseNodeConstructor {\n// \tnew (): BaseNode;\n// }\n\nexport type BaseNodeConstructor = typeof BaseNodeClass;\ntype NodeConstructorByType = Dictionary<BaseNodeConstructor>;\ntype NodeConstructorByTypeByContext = Dictionary<NodeConstructorByType>;\ntype TabMenuByTypeByContext = Dictionary<Dictionary<string>>;\ntype RegisterOptionsByTypeByContext = Dictionary<Dictionary<RegisterOptions>>;\n\nexport class NodesRegister {\n\tprivate _node_register: NodeConstructorByTypeByContext = {};\n\tprivate _node_register_categories: TabMenuByTypeByContext = {};\n\tprivate _node_register_options: RegisterOptionsByTypeByContext = {};\n\n\tregister_node(node: BaseNodeConstructor, tab_menu_category?: string, options?: RegisterOptions) {\n\t\tconst context = node.node_context();\n\t\tconst node_type = node.type();\n\t\tthis._node_register[context] = this._node_register[context] || {};\n\n\t\tconst already_registered_node = this._node_register[context][node_type];\n\t\tif (already_registered_node) {\n\t\t\tthrow new Error(`node ${context}/${node_type} already registered`);\n\t\t}\n\t\tthis._node_register[context][node_type] = node;\n\n\t\tif (tab_menu_category) {\n\t\t\tthis._node_register_categories[context] = this._node_register_categories[context] || {};\n\t\t\tthis._node_register_categories[context][node_type] = tab_menu_category;\n\t\t}\n\t\tthis._node_register_options[context] = this._node_register_options[context] || {};\n\t\tif (options) {\n\t\t\tthis._node_register_options[context][node_type] = options;\n\t\t}\n\t}\n\tderegister_node(context: string, node_type: string) {\n\t\tdelete this._node_register[context][node_type];\n\t\tdelete this._node_register_categories[context][node_type];\n\t\tdelete this._node_register_options[context][node_type];\n\t}\n\tregistered_nodes_for_context_and_parent_type(context: NodeContext, parent_node_type: string) {\n\t\tconst map = this._node_register[context];\n\t\tif (map) {\n\t\t\tconst nodes_for_context = Object.values(this._node_register[context]);\n\t\t\treturn nodes_for_context.filter((node) => {\n\t\t\t\tconst options = this._node_register_options[context][node.type()];\n\t\t\t\treturn !options || options['only']?.includes(parent_node_type);\n\t\t\t});\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\tregistered_nodes(context: NodeContext, parent_node_type: string): Dictionary<BaseNodeConstructor> {\n\t\tconst nodes_by_type: Dictionary<BaseNodeConstructor> = {};\n\t\tconst nodes = this.registered_nodes_for_context_and_parent_type(context, parent_node_type);\n\t\tfor (let node of nodes) {\n\t\t\tconst type = node.type();\n\t\t\tnodes_by_type[type] = node;\n\t\t}\n\t\treturn nodes_by_type;\n\t}\n\tregistered_category(context: NodeContext, type: string) {\n\t\treturn this._node_register_categories[context][type];\n\t}\n}\n","import {PolyScene} from '../PolyScene';\n\nexport class LifeCycleController {\n\tconstructor(private scene: PolyScene) {}\n\n\tprivate _lifecycle_on_create_allowed: boolean = true;\n\n\ton_create_hook_allowed(): boolean {\n\t\treturn this.scene.loading_controller.loaded && this._lifecycle_on_create_allowed;\n\t}\n\n\ton_create_prevent(callback: () => void) {\n\t\tthis._lifecycle_on_create_allowed = false;\n\t\tcallback();\n\t\tthis._lifecycle_on_create_allowed = true;\n\t}\n}\n","import {PolyScene} from '../PolyScene';\n\nexport class LoadingController {\n\tconstructor(private scene: PolyScene) {}\n\n\t_loading_state: boolean = true;\n\t_auto_updating: boolean = true;\n\t_first_object_loaded: boolean = false;\n\n\tmark_as_loading() {\n\t\tthis._set_loading_state(true);\n\t}\n\tasync mark_as_loaded() {\n\t\tawait this._set_loading_state(false);\n\t\t// POLY.notify_scene_loaded(this.scene);\n\t\t// this.cooker().block()\n\t\t// this.root().set_children_dirty_without_propagation()\n\t\t// this.cooker().unblock()\n\t}\n\tprivate async _set_loading_state(state: boolean) {\n\t\tthis._loading_state = state;\n\t\tawait this.set_auto_update(!this._loading_state);\n\t}\n\tget is_loading() {\n\t\treturn this._loading_state;\n\t}\n\tget loaded() {\n\t\treturn !this._loading_state;\n\t}\n\tget auto_updating() {\n\t\treturn this._auto_updating;\n\t} // _init_auto_update: ->\n\t// \tthis.set_auto_update(true)\n\tasync set_auto_update(new_state: boolean) {\n\t\tif (this._auto_updating !== new_state) {\n\t\t\tthis._auto_updating = new_state;\n\t\t\tif (this._auto_updating) {\n\t\t\t\t// if this.env_is_development()\n\t\t\t\t// \tthis.performance().start()\n\n\t\t\t\tconst root = this.scene.root;\n\t\t\t\tif (root) {\n\t\t\t\t\tawait root.process_queue();\n\t\t\t\t\t// const c = async () => {\n\t\t\t\t\t// \tawait root.process_queue();\n\t\t\t\t\t// };\n\t\t\t\t\t// setTimeout(c, 50);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// if (callback != null) { callback(); }\n\t\t\t}\n\t\t} else {\n\t\t\t// if (callback != null) { callback(); }\n\t\t}\n\t}\n\n\ton_first_object_loaded() {\n\t\tif (!this._first_object_loaded) {\n\t\t\tthis._first_object_loaded = true;\n\n\t\t\tconst loader = document.getElementById('scene_loading_container');\n\t\t\tif (loader) {\n\t\t\t\tloader.parentElement?.removeChild(loader);\n\t\t\t}\n\t\t}\n\t}\n\n\t// on_all_objects_loaded() {\n\t// \t// POLY.viewer_loaders_manager().dipose_loaders()\n\t// }\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {MissingExpressionReference, MissingExpressionReferenceByIdByFullPath} from './MissingReference';\nimport jsep from 'jsep';\n\nexport class MissingReferencesController {\n\tprivate references: MissingExpressionReferenceByIdByFullPath = {};\n\tprivate next_id: number = 0;\n\tprivate next_id_s: string = '0';\n\n\tregister(param: BaseParamType, jsep_node: jsep.Expression, full_path: string): MissingExpressionReference {\n\t\tconst id = this.next_id_s;\n\t\tconst missing_expression_reference = new MissingExpressionReference(param, jsep_node, full_path, id);\n\t\tthis.references[full_path] = this.references[full_path] || {};\n\t\tthis.references[full_path][id] = missing_expression_reference;\n\n\t\tthis.next_id += 1;\n\t\tthis.next_id_s = `${this.next_id}`;\n\n\t\treturn missing_expression_reference;\n\t}\n\tunregister(ref: MissingExpressionReference) {\n\t\tif (this.references[ref.full_path]) {\n\t\t\tdelete this.references[ref.full_path][ref.id];\n\t\t}\n\t}\n\n\t// call this from node.create and node.rename\n\tcheck_for_references(node: BaseNodeType) {\n\t\tconst full_path = node.full_path();\n\t\tconst refs = this.references[full_path];\n\t\tif (refs) {\n\t\t\tconst ref_ids = Object.keys(refs);\n\t\t\tref_ids.forEach((ref_id) => {\n\t\t\t\tconst ref = refs[ref_id];\n\t\t\t\tref.resolve_with_node(node);\n\t\t\t});\n\t\t\tdelete this.references[full_path];\n\t\t}\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport jsep from 'jsep';\n\nexport class MissingExpressionReference {\n\tconstructor(\n\t\tprivate param: BaseParamType,\n\t\tprivate jsep_node: jsep.Expression,\n\t\tpublic full_path: string,\n\t\tpublic id: string\n\t) {\n\t\tconsole.log(this.jsep_node, this.param); // TODO: typescript, to not have the missing ref\n\t}\n\n\tresolve_with_node(node: BaseNodeType) {\n\t\tconsole.warn('this should not work! REFACTOR asap');\n\t\t// this.param.parse_expression_and_update_dependencies()\n\t}\n}\n\nexport class ReferenceSearchResult {\n\tpublic found_graph_nodes: CoreGraphNode[] = [];\n\tpublic missing_paths: string[] = [];\n\n\tconstructor() {}\n\tset_found_graph_nodes(graph_nodes: CoreGraphNode[]) {\n\t\tthis.found_graph_nodes = graph_nodes;\n\t}\n\tset_missing_paths(paths: string[]) {\n\t\tthis.missing_paths = paths;\n\t}\n}\n\nexport interface MissingExpressionReferenceById {\n\t[propName: string]: MissingExpressionReference;\n}\nexport interface MissingExpressionReferenceByIdByFullPath {\n\t[propName: string]: MissingExpressionReferenceById;\n}\n","import {PolyScene} from '../PolyScene';\n\nimport {Object3D} from 'three/src/core/Object3D';\nimport lodash_concat from 'lodash/concat';\nimport lodash_flatten from 'lodash/flatten';\nimport lodash_compact from 'lodash/compact';\nimport {ObjectsManagerNode} from 'src/engine/nodes/manager/ObjectsManager';\nimport {CoreString} from 'src/core/String';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseObjNodeType} from 'src/engine/nodes/obj/_Base';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\n\nexport class NodesController {\n\tconstructor(private scene: PolyScene) {}\n\n\t_root!: ObjectsManagerNode;\n\t_node_context_signatures: Dictionary<boolean> = {};\n\t_instanciated_nodes_by_context_and_type: Dictionary<Dictionary<Dictionary<BaseNodeType>>> = {};\n\n\tinit() {\n\t\tthis._root = new ObjectsManagerNode(this.scene);\n\t\tthis._root.initialize_base_and_node();\n\t\t// this._root.set_scene(this.scene);\n\t\tthis._root.init_display_scene();\n\t}\n\n\tget root() {\n\t\treturn this._root;\n\t}\n\tobjects_from_mask(mask: string): Object3D[] {\n\t\tconst masks = mask.split(' ');\n\t\t// let geos = this.root().nodes_by_type('geo') as BaseNodeObj[];\n\t\tlet nodes = this.root.children() as BaseObjNodeType[];\n\t\tnodes = nodes.filter((node) => CoreString.matches_one_mask(node.name, masks));\n\t\tconst objects = nodes.map((geo) => geo.object);\n\t\treturn lodash_compact(objects);\n\t}\n\tclear() {\n\t\tconst children = this.root.children();\n\t\tfor (let child of children) {\n\t\t\tthis.root.children_controller?.remove_node(child);\n\t\t}\n\t\t// return children.forEach(child=> {\n\t\t// \treturn this.root().remove_node(child);\n\t\t// });\n\t}\n\n\tnode(path: string) {\n\t\tif (path === '/') {\n\t\t\treturn this.root;\n\t\t} else {\n\t\t\treturn this.root.node(path);\n\t\t}\n\t}\n\tall_nodes() {\n\t\tlet nodes: BaseNodeType[] = [this.root];\n\t\tlet current_parents: BaseNodeType[] = [this.root];\n\t\tlet cmptr = 0;\n\t\twhile (current_parents.length > 0 && cmptr < 10) {\n\t\t\tconst children = lodash_flatten(\n\t\t\t\tcurrent_parents.map((current_parent) => {\n\t\t\t\t\tif (current_parent.children_allowed()) {\n\t\t\t\t\t\treturn current_parent.children();\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t\tnodes = lodash_concat(nodes, children);\n\t\t\tcurrent_parents = children;\n\t\t\tcmptr += 1;\n\t\t}\n\t\treturn lodash_flatten(nodes);\n\t}\n\n\treset_node_context_signatures() {\n\t\tthis._node_context_signatures = {};\n\t}\n\tregister_node_context_signature(node: BaseNodeType) {\n\t\tif (node.children_allowed() && node.children_controller) {\n\t\t\tthis._node_context_signatures[node.children_controller.node_context_signature()] = true;\n\t\t}\n\t}\n\tnode_context_signatures() {\n\t\treturn Object.keys(this._node_context_signatures)\n\t\t\t.sort()\n\t\t\t.map((s) => s.toLowerCase());\n\t}\n\n\tadd_to_instanciated_node(node: BaseNodeType) {\n\t\tconst context = node.node_context();\n\t\tconst node_type = node.type;\n\t\tthis._instanciated_nodes_by_context_and_type[context] =\n\t\t\tthis._instanciated_nodes_by_context_and_type[context] || {};\n\t\tthis._instanciated_nodes_by_context_and_type[context][node_type] =\n\t\t\tthis._instanciated_nodes_by_context_and_type[context][node_type] || {};\n\t\tthis._instanciated_nodes_by_context_and_type[context][node_type][node.graph_node_id] = node;\n\t}\n\n\tremove_from_instanciated_node(node: BaseNodeType) {\n\t\tconst context = node.node_context();\n\t\tconst node_type = node.type;\n\t\tdelete this._instanciated_nodes_by_context_and_type[context][node_type][node.graph_node_id];\n\t}\n\n\tinstanciated_nodes(context: NodeContext, node_type: string) {\n\t\tconst nodes = [];\n\t\tif (this._instanciated_nodes_by_context_and_type[context]) {\n\t\t\tconst nodes_by_ids = this._instanciated_nodes_by_context_and_type[context][node_type];\n\t\t\tif (nodes_by_ids) {\n\t\t\t\tfor (let id of Object.keys(nodes_by_ids)) {\n\t\t\t\t\tnodes.push(nodes_by_ids[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn nodes;\n\t}\n}\n","import {Group} from 'three/src/objects/Group';\n// import lodash_isEqual from 'lodash/isEqual';\n// import lodash_map from 'lodash/map';\n\nimport {TypedBaseManagerNode} from './_Base';\n// import {CoreObject} from 'src/core/Object';\n// import {BaseNode} from '../_Base';\nimport {BaseObjNodeType} from '../obj/_Base';\n\n// import {BaseManagerObjNode} from 'src/engine/nodes/obj/_BaseManager';\n// import {BaseCameraObjNodeClass} from 'src/engine/nodes/obj/_BaseCamera';\n// import {BaseLightObjNodeClass} from 'src/engine/nodes/obj/_BaseLight';\n\n// obj nodes\n// import {EventsObjNode} from 'src/engine/nodes/obj/Events';\n// import {MaterialsObjNode} from 'src/engine/nodes/obj/Materials';\n// import {FogObjNode} from 'src/engine/nodes/obj/Fog';\nimport {GeoObjNode} from 'src/engine/nodes/obj/Geo';\n\nimport 'src/engine/Poly';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\n// import {PolyScene} from 'src/engine/scene/PolyScene';\n// TODO:\n// ensure removing a node removes its content from the scene (spotlight?)\n\nimport {ObjNodeChildrenMap} from 'src/engine/poly/registers/Obj';\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {BaseNodeType} from '../_Base';\nimport {POLY} from 'src/engine/Poly';\nclass ObjectsManagerParamsConfig extends NodeParamsConfig {}\nconst ParamsConfig = new ObjectsManagerParamsConfig();\n\nexport class ObjectsManagerNode extends TypedBaseManagerNode<ObjectsManagerParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'obj';\n\t}\n\t// children_context() {\n\t// \treturn NodeContext.OBJ;\n\t// }\n\n\tprivate _object: Group = new Group();\n\tprivate _queued_nodes_by_id: Dictionary<BaseObjNodeType> = {};\n\tprivate _queued_nodes_by_path: Dictionary<BaseObjNodeType> = {};\n\tprivate _expected_geo_nodes: Dictionary<GeoObjNode> = {};\n\t// private _loaded_geo_node_by_id: Dictionary<boolean> = {};\n\tprivate _process_queue_start: number = -1;\n\n\tprotected _children_controller_context = NodeContext.OBJ;\n\tinitialize_node() {\n\t\tthis.children_controller?.init();\n\n\t\t// this.flags.add_display();\n\n\t\tthis.lifecycle.add_on_child_add_hook(this._on_child_add.bind(this));\n\t\tthis.lifecycle.add_on_child_remove_hook(this._on_child_remove.bind(this));\n\t\t// this.flags.add_bypass({has_bypass_flag: false});\n\n\t\t// this.set_min_inputs_count(0);\n\t\t// this.set_max_inputs_count(0);\n\t}\n\t//@_object_uuid_by_node_graph_id = {}\n\n\tinit_display_scene() {\n\t\tthis._object.name = '_WORLD_';\n\t\tthis._scene.display_scene.add(this._object);\n\t}\n\n\t// TODO: is this method still used?\n\t// available_children_classes() {\n\t// \treturn POLY.Engine.Node.Obj;\n\t// }\n\n\tobject() {\n\t\treturn this._object;\n\t}\n\tcreate_node<K extends keyof ObjNodeChildrenMap>(type: K): ObjNodeChildrenMap[K] {\n\t\treturn super.create_node(type) as ObjNodeChildrenMap[K];\n\t}\n\tchildren() {\n\t\treturn super.children() as BaseObjNodeType[];\n\t}\n\tnodes_by_type<K extends keyof ObjNodeChildrenMap>(type: K): ObjNodeChildrenMap[K][] {\n\t\treturn super.nodes_by_type(type) as ObjNodeChildrenMap[K][];\n\t}\n\n\tmultiple_display_flags_allowed() {\n\t\treturn true;\n\t}\n\n\tadd_to_queue(node: BaseObjNodeType) {\n\t\tconst id = node.graph_node_id;\n\t\tif (this._queued_nodes_by_id[id] == null) {\n\t\t\treturn (this._queued_nodes_by_id[id] = node);\n\t\t}\n\t}\n\n\tasync process_queue() {\n\t\tthis._queued_nodes_by_path = {};\n\t\tconst ids = Object.keys(this._queued_nodes_by_id);\n\t\tfor (let id of ids) {\n\t\t\tconst node = this._queued_nodes_by_id[id];\n\t\t\tdelete this._queued_nodes_by_id[id];\n\n\t\t\tconst full_path = `_____${node.render_order}__${node.full_path()}`;\n\t\t\t// we want to process managers, cameras, then lights, then everything else\n\t\t\t// so we add a prefix for those\n\t\t\t// if (this._is_node_manager(node)) {\n\t\t\t// \tfull_path = `/_____005_${full_path}`;\n\t\t\t// } else if (this._is_node_fog(node)) {\n\t\t\t// \tfull_path = `/_____002_${full_path}`;\n\t\t\t// } else if (this._is_node_camera(node)) {\n\t\t\t// \tfull_path = `/_____003_${full_path}`;\n\t\t\t// } else if (this._is_node_light(node)) {\n\t\t\t// \tfull_path = `/_____004_${full_path}`;\n\t\t\t// }\n\n\t\t\tthis._queued_nodes_by_path[full_path] = node;\n\t\t}\n\n\t\tconst promises = Object.keys(this._queued_nodes_by_path)\n\t\t\t.sort()\n\t\t\t.map((path_id) => {\n\t\t\t\tconst node = this._queued_nodes_by_path[path_id];\n\t\t\t\treturn this.update_object(node);\n\t\t\t});\n\n\t\tthis._expected_geo_nodes = this._expected_geo_nodes || (await this.expected_loading_geo_nodes_by_id());\n\n\t\tthis._process_queue_start = performance.now();\n\t\tPromise.all(promises).then(() => {\n\t\t\tPOLY.log(`SCENE LOADED '${this.scene.name}' in ${performance.now() - this._process_queue_start}`);\n\t\t\t// this.scene().performance().print()\n\n\t\t\t// do the update here if there are no objects to load\n\t\t\t// otherwise an empty scene will have a loader that never gets removed\n\t\t\t// if (Object.keys(this._expected_geo_nodes).length == 0) {\n\t\t\t// \tthis.update_on_all_objects_loaded();\n\t\t\t// }\n\t\t});\n\t}\n\n\tupdate_object(node: BaseObjNodeType) {\n\t\tif (!this.scene.loading_controller.auto_updating) {\n\t\t\tthis.add_to_queue(node);\n\t\t} else {\n\t\t\t// if (node.object) {\n\t\t\tthis.add_to_scene(node);\n\t\t\t// } else {\n\t\t\t// \t//if POLY.env != 'test'\n\t\t\t// \t// console.warn(`no object from ${node.full_path()} (error:${node.error_message()}) (${POLY.env})`);\n\t\t\t// }\n\t\t}\n\t}\n\n\t// _is_node_fog(node: BaseObjNodeType) {\n\t// \treturn CoreObject.is_a(node, FogObjNode);\n\t// }\n\t// _is_node_camera(node: BaseObjNodeType) {\n\t// \treturn CoreObject.is_a(node, BaseCameraObjNodeClass);\n\t// }\n\n\t// _is_node_event(node: BaseObjNodeType) {\n\t// \treturn CoreObject.is_a(node, EventsObjNode);\n\t// }\n\t// _is_node_mat(node: BaseObjNodeType) {\n\t// \treturn CoreObject.is_a(node, MaterialsObjNode);\n\t// }\n\n\t//\n\t//\n\t// OBJ PARENTING\n\t//\n\t//\n\n\t// TODO:\n\t// a OBJ node should be able to submit its group for transform\n\t// apart from the geometry. This would allow parenting to function\n\t// regardless if the underlying geo is valid or not\n\tget_parent_for_node(node: BaseObjNodeType) {\n\t\t// if (this._is_node_event(node) || this._is_node_mat(node)) {\n\t\t// \treturn null;\n\t\tif (node.attachable_to_hierarchy) {\n\t\t\t// if (this._is_node_camera(node)) {\n\t\t\t// \treturn this.scene.display_scene;\n\t\t\t// } else {\n\t\t\tconst node_input = node.io.inputs.input(0);\n\t\t\tif (node_input) {\n\t\t\t\t//node_input.request_container (container)=>\n\t\t\t\t//\tcallback(container.object() || @_object)\n\t\t\t\treturn node_input.children_group;\n\t\t\t} else {\n\t\t\t\treturn this._object;\n\t\t\t}\n\t\t\t// }\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tadd_to_scene(node: BaseObjNodeType): void {\n\t\t// if (this._is_node_fog(node)) {\n\t\t// console.log(\"fog\")\n\t\t// # TODO: ensure fog is removed if we set display or bypass flag\n\t\t// # TODO: ensure we get a warning if more than 1 fog\n\t\t// # TODO: why does it get added twice when its parameters are changed?\n\t\t// node.get_fog (fog)=>\n\t\t// \t@_scene.display_scene().fog = fog\n\t\t// #console.log(\"added fog\", node.object())\n\t\tif (node.attachable_to_hierarchy) {\n\t\t\tconst parent_object = this.get_parent_for_node(node);\n\t\t\tif (parent_object) {\n\t\t\t\t// await node.params.eval_all().then((params_eval_key) => {\n\t\t\t\t// \tnode.request_container();\n\t\t\t\t// });\n\n\t\t\t\tif (node.used_in_scene) {\n\t\t\t\t\t// parent_object.add(node.object);\n\t\t\t\t\tnode.add_object_to_parent(parent_object);\n\t\t\t\t\t// await node.cook_controller.cook_main_without_inputs();\n\t\t\t\t} else {\n\t\t\t\t\tnode.remove_object_from_parent();\n\t\t\t\t\t// parent_object.remove(node.object);\n\t\t\t\t}\n\n\t\t\t\t// node.request_display_node();\n\t\t\t} else {\n\t\t\t\t// node.request_container().then(() => {\n\t\t\t\t// \t// force events and mat to cook and remove the dirty state\n\t\t\t\t// \t// ensure that pickers are cooked\n\t\t\t\t// \t// TODO: although there has been cases with two picker and\n\t\t\t\t// \t// one referencing the other with an expression, and that\n\t\t\t\t// \t// expression be evaluated before the second was created\n\t\t\t\t// \t// which led to an error. This should not happen\n\t\t\t\t// \tnode.children_controller.traverse_children((child) => child.set_dirty());\n\t\t\t\t// });\n\t\t\t}\n\t\t}\n\t}\n\n\tremove_from_scene(node: BaseObjNodeType) {\n\t\tnode.remove_object_from_parent();\n\t}\n\tare_children_cooking(): boolean {\n\t\tconst children = this.children();\n\t\tfor (let child of children) {\n\t\t\tif (child.is_display_node_cooking()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tasync expected_loading_geo_nodes_by_id() {\n\t\tconst geo_nodes = this.nodes_by_type('geo');\n\t\tconst node_by_id: Dictionary<GeoObjNode> = {};\n\t\tfor (let geo_node of geo_nodes) {\n\t\t\tconst is_displayed = await geo_node.is_displayed();\n\t\t\tif (is_displayed) {\n\t\t\t\tnode_by_id[geo_node.graph_node_id] = geo_node;\n\t\t\t}\n\t\t}\n\t\treturn node_by_id;\n\t}\n\n\t// async notify_geo_loaded(geo_node: GeoObjNode) {\n\t// \tthis._loaded_geo_node_by_id = this._loaded_geo_node_by_id || {};\n\t// \tthis._loaded_geo_node_by_id[geo_node.graph_node_id] = true;\n\n\t// \tthis._expected_geo_nodes = this._expected_geo_nodes || (await this.expected_loading_geo_nodes_by_id());\n\n\t// \tif (this.scene) {\n\t// \t\tthis.scene.loading_controller.on_first_object_loaded();\n\n\t// \t\tif (lodash_isEqual(Object.keys(this._loaded_geo_node_by_id), Object.keys(this._expected_geo_nodes))) {\n\t// \t\t\tthis.update_on_all_objects_loaded();\n\t// \t\t}\n\t// \t}\n\t// }\n\n\t// update_on_all_objects_loaded() {\n\t// \tthis.scene.loading_controller.on_all_objects_loaded();\n\t// \t// this.scene.cube_cameras_controller.on_all_objects_loaded(); // TODO: typescript\n\t// }\n\n\tadd_to_parent_transform(node: BaseObjNodeType) {\n\t\tthis.update_object(node);\n\t}\n\t// return if !this.scene().loaded()\n\n\t// transformed_node.request_container (input_container)->\n\t// \tobject = input_container.object()\n\n\t// \ttransformed_node.request_input_container 0, (parent_input_container)->\n\t// \t\tparent = parent_input_container.object()\n\t// \t\tparent.add(object)\n\n\tremove_from_parent_transform(node: BaseObjNodeType) {\n\t\tthis.update_object(node);\n\t}\n\t// return if !this.scene().loaded()\n\n\t// transformed_node.request_container (input_container)=>\n\t// \tobject = input_container.object()\n\n\t// \tthis.get_parent_for_node transformed_node, (parent_object)=>\n\t// \t\tparent_object.add(object)\n\n\tprivate _on_child_add(node?: BaseNodeType) {\n\t\tif (node) {\n\t\t\tthis.update_object(node as BaseObjNodeType);\n\t\t}\n\t}\n\tprivate _on_child_remove(node?: BaseNodeType) {\n\t\tif (node) {\n\t\t\tthis.remove_from_scene(node as BaseObjNodeType);\n\t\t}\n\t}\n}\n","import {TypedNode} from '../_Base';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {TypedContainerController} from '../utils/ContainerController';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {ManagerContainer} from 'src/engine/containers/Manager';\n\nexport class TypedBaseManagerNode<K extends NodeParamsConfig> extends TypedNode<'MANAGER', BaseManagerNodeType, K> {\n\tcontainer_controller: TypedContainerController<ManagerContainer> = new TypedContainerController<ManagerContainer>(\n\t\tthis,\n\t\tManagerContainer\n\t);\n\n\tstatic node_context(): NodeContext {\n\t\treturn NodeContext.MANAGER;\n\t}\n}\n\nexport type BaseManagerNodeType = TypedBaseManagerNode<any>;\nexport class BaseManagerNodeClass extends TypedBaseManagerNode<any> {}\n","// import lodash_filter from 'lodash/filter';\n// import lodash_uniq from 'lodash/uniq';\n// import lodash_flatten from 'lodash/flatten';\n// import {Cooker} from './Cooker';\nimport {CoreGraphNode} from './CoreGraphNode';\n\n// not sure how I can have caller: DirtyableMixin if DirtyableMixin is not yet defined\nexport type PostDirtyHook = (caller?: CoreGraphNode) => void;\n\n// type Constructor<T = {}> = new (...args: any[]) => T;\nexport class DirtyController {\n\t_dirty_count: number = 0;\n\t_dirty: boolean = true;\n\t_dirty_timestamp: number | undefined;\n\t_cached_successors: CoreGraphNode[] | undefined;\n\t_forbidden_trigger_nodes: string[] | undefined;\n\n\t// hooks\n\t_post_dirty_hooks: PostDirtyHook[] | undefined;\n\t_post_dirty_hook_names: string[] | undefined;\n\n\tconstructor(private node: CoreGraphNode) {}\n\n\t// _init_dirtyable(): void {\n\t// \tthis._dirty_count = 0;\n\t// \tthis._dirty = true;\n\t// }\n\tget is_dirty(): boolean {\n\t\treturn this._dirty === true;\n\t}\n\tget dirty_timestamp() {\n\t\treturn this._dirty_timestamp;\n\t}\n\tget dirty_count(): number {\n\t\treturn this._dirty_count;\n\t}\n\tadd_post_dirty_hook(name: string, method: PostDirtyHook) {\n\t\tthis._post_dirty_hook_names = this._post_dirty_hook_names || [];\n\t\tthis._post_dirty_hooks = this._post_dirty_hooks || [];\n\n\t\tif (!this._post_dirty_hook_names.includes(name)) {\n\t\t\tthis._post_dirty_hook_names.push(name);\n\t\t\tthis._post_dirty_hooks.push(method);\n\t\t} else {\n\t\t\tconsole.warn(`hook with name ${name} already exists`, this._post_dirty_hook_names);\n\t\t}\n\t}\n\thas_hook(name: string): boolean {\n\t\tif (this._post_dirty_hook_names) {\n\t\t\treturn this._post_dirty_hook_names.includes(name);\n\t\t}\n\t\treturn false;\n\t}\n\t// using a dirty block doesn't quite work, as I would need to be able\n\t// to fetch the graph for all successors that haven't been blocked\n\t// block_dirty_propagation: ->\n\t// \t@_dirty_propagation_allowed = false\n\t// unblock_dirty_propagation: ->\n\t// \t@_dirty_propagation_allowed = true\n\tremove_dirty_state(): void {\n\t\tthis._dirty = false;\n\t}\n\tset_forbidden_trigger_nodes(nodes: CoreGraphNode[]) {\n\t\tthis._forbidden_trigger_nodes = nodes.map((n) => n.graph_node_id);\n\t}\n\t//@_clean_for_frame = this.context().frame()\n\t//this.post_remove_dirty_state(message)\n\n\tset_dirty(original_trigger_graph_node?: CoreGraphNode | null, propagate?: boolean): void {\n\t\tif (propagate == null) {\n\t\t\tpropagate = true;\n\t\t}\n\n\t\tif (\n\t\t\toriginal_trigger_graph_node &&\n\t\t\tthis._forbidden_trigger_nodes &&\n\t\t\tthis._forbidden_trigger_nodes.includes(original_trigger_graph_node.graph_node_id)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (original_trigger_graph_node == null) {\n\t\t\toriginal_trigger_graph_node = this.node;\n\t\t}\n\n\t\t//return if this.set_dirty_allowed? && !this.set_dirty_allowed(original_trigger_graph_node)\n\n\t\t// if (this.scene && this.scene() != null && this.scene().loaded()){\n\t\t// \tlet id = null\n\t\t// \tif (this.full_path){id = this.full_path()} else {id = this}\n\t\t// \tconsole.log(\"set dirty\", id)\n\t\t// }\n\n\t\t// TODO: why can't I not propagate if the node is already dirty?\n\t\t// one possible reason is that node might be cooking, and this would not update the dirty_timestamp correctly?\n\t\t//return if this.is_dirty()\n\t\t// if(!this.scene().is_loading()){\n\t\t// \tconsole.log(\"set dirty\", (this.full_path ? this.full_path() : this))\n\t\t// }\n\n\t\tthis._dirty = true;\n\t\tthis._dirty_timestamp = performance.now();\n\t\tthis._dirty_count += 1;\n\n\t\tthis.run_post_dirty_hooks(original_trigger_graph_node);\n\t\t// this.post_set_dirty(original_trigger_graph_node);\n\n\t\tif (propagate === true) {\n\t\t\t//&& @_dirty #&& window.scene.auto_updating()\n\t\t\tthis.set_successors_dirty(original_trigger_graph_node);\n\t\t}\n\t}\n\n\trun_post_dirty_hooks(original_trigger_graph_node?: CoreGraphNode) {\n\t\tif (this._post_dirty_hooks) {\n\t\t\tconst cooker = this.node.scene.cooker;\n\t\t\tif (cooker.blocked) {\n\t\t\t\tcooker.enqueue(this.node, original_trigger_graph_node);\n\t\t\t} else {\n\t\t\t\tfor (let hook of this._post_dirty_hooks) {\n\t\t\t\t\thook(original_trigger_graph_node);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// cooker(): Cooker {\n\t// \tthrow 'Dirtyable.cooker requires implementation';\n\t// }\n\tset_successors_dirty(original_trigger_graph_node?: CoreGraphNode): void {\n\t\t// const cooker = this.node.scene.cooker;\n\t\t// cooker.block();\n\n\t\tconst propagate = false;\n\t\tthis._cached_successors = this._cached_successors || this.node.graph_all_successors(); //this._dirtyable_all_successors(original_trigger_graph_node);\n\t\t// successors = successors.filter(n=>!n.is_dirty())\n\t\tfor (let successor of this._cached_successors) {\n\t\t\tsuccessor.dirty_controller.set_dirty(original_trigger_graph_node, propagate);\n\t\t\t// console.log(successor);\n\t\t}\n\n\t\t// cooker.unblock();\n\t}\n\n\t// _dirtyable_all_successors(original_trigger_graph_node: CoreGraphNode): CoreGraphNode[] {\n\t// \treturn this.graph_all_predecessors()\n\t// \t// const successors = [];\n\t// \t// let newly_added_successors = this._dirtyable_direct_successors(original_trigger_graph_node);\n\t// \t// successors.push(newly_added_successors);\n\n\t// \t// while (newly_added_successors.length > 0) {\n\t// \t// \tnewly_added_successors = lodash_flatten(\n\t// \t// \t\tnewly_added_successors.map((newly_added_successor) => {\n\t// \t// \t\t\treturn newly_added_successor._dirtyable_direct_successors(original_trigger_graph_node);\n\t// \t// \t\t})\n\t// \t// \t);\n\t// \t// \tsuccessors.push(newly_added_successors);\n\t// \t// }\n\n\t// \t// return lodash_uniq(lodash_flatten(successors));\n\t// }\n\n\tclear_successors_cache() {\n\t\tthis._cached_successors = undefined;\n\t}\n\tclear_successors_cache_with_predecessors() {\n\t\tthis.clear_successors_cache();\n\t\tfor (let predecessor of this.node.graph_all_predecessors()) {\n\t\t\tpredecessor.dirty_controller.clear_successors_cache();\n\t\t}\n\t}\n\t// graph_all_predecessors(): CoreGraphNode[] {\n\t// \treturn this.node.graph_all_predecessors()\n\t// \t// console.log('dirtyable graph_all_predecessors should be overwritten');\n\t// \t// return [];\n\t// }\n\n\t// dirty_successors(): Array<CoreGraphNode> {\n\t// \tthrow 'Dirtyable.dirty_successors requires implementation';\n\t// }\n\t// set_dirty_allowed(original_trigger_graph_node: CoreGraphNode): boolean {\n\t// \tthrow 'Dirtyable.set_dirty_allowed requires implementation';\n\t// }\n\t// _dirtyable_direct_successors(original_trigger_graph_node: CoreGraphNode): Array<CoreGraphNode> {\n\t// \treturn this.dirty_successors().filter((successor) => {\n\t// \t\treturn successor.set_dirty_allowed == null || successor.set_dirty_allowed(original_trigger_graph_node);\n\t// \t});\n\t// }\n\n\t// set_graph_successors_dirty_via_graph: (original_trigger_graph_node)->\n\t// \tcooker = this.scene().cooker()\n\t// \tcooker.block()\n\n\t// \tmake_successors_dirty = false\n\t// \tlodash_each lodash_flatten(this.graph_all_successors()), (successor)=>\n\t// \t\tsuccessor.set_dirty(original_trigger_graph_node, this, false)\n\n\t// \tcooker.unblock()\n\n\t// post_set_dirty(original_trigger_graph_node?: Dirtyable, direct_trigger_graph_node?: Dirtyable): void{}\n}\n","import {Vector2} from 'three/src/math/Vector2';\nimport {Color} from 'three/src/math/Color';\nimport {BaseNodeType} from '../_Base';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\nexport interface NodeUIDataJson {\n\tx: number;\n\ty: number;\n\tcomment?: string;\n}\n\nexport class UIData {\n\tprivate _position: Vector2 = new Vector2();\n\tprivate _width: number = 50;\n\tprivate _border_radius: number = 3;\n\tprivate _color: Color = new Color(0.75, 0.75, 0.75);\n\t// private _icon: string | null = null;\n\tprivate _layout_vertical: boolean = true;\n\tprivate _comment: string | undefined;\n\tprivate _json: NodeUIDataJson = {\n\t\tx: 0,\n\t\ty: 0,\n\t};\n\n\tconstructor(private node: BaseNodeType, x: number = 0, y: number = 0) {\n\t\tthis._position.x = x;\n\t\tthis._position.y = y;\n\t}\n\n\tset_border_radius(radius: number) {\n\t\tthis._border_radius = radius;\n\t}\n\tborder_radius() {\n\t\treturn this._border_radius;\n\t}\n\tset_width(width: number) {\n\t\tthis._width = width;\n\t}\n\twidth() {\n\t\treturn this._width;\n\t}\n\tset_comment(comment: string | undefined) {\n\t\tthis._comment = comment;\n\t\tthis.node.emit(NodeEvent.UI_DATA_COMMENT_UPDATED);\n\t}\n\tget comment(): string | undefined {\n\t\treturn this._comment;\n\t}\n\tset_color(color: Color) {\n\t\tthis._color = color;\n\t}\n\tcolor() {\n\t\treturn this._color;\n\t}\n\t// set_icon(icon: string) {\n\t// \tthis._icon = icon;\n\t// }\n\t// icon() {\n\t// \treturn this._icon;\n\t// }\n\tset_layout_horizontal() {\n\t\tthis._layout_vertical = false;\n\t}\n\tis_layout_vertical() {\n\t\treturn this._layout_vertical;\n\t}\n\n\tcopy(ui_data: UIData) {\n\t\tthis._position.copy(ui_data.position);\n\t\tthis._color.copy(ui_data.color());\n\t}\n\n\tget position() {\n\t\treturn this._position;\n\t}\n\n\tset_position(new_position: Vector2 | number, y: number = 0) {\n\t\tif (new_position instanceof Vector2) {\n\t\t\tthis._position.copy(new_position);\n\t\t} else {\n\t\t\tconst x = new_position;\n\t\t\tthis._position.set(x, y);\n\t\t}\n\t\tthis.node.emit(NodeEvent.UI_DATA_POSITION_UPDATED);\n\t}\n\n\ttranslate(offset: Vector2, snap: boolean = false) {\n\t\tthis._position.add(offset);\n\n\t\tif (snap) {\n\t\t\tthis._position.x = Math.round(this._position.x);\n\t\t\tthis._position.y = Math.round(this._position.y);\n\t\t}\n\n\t\tthis.node.emit(NodeEvent.UI_DATA_POSITION_UPDATED);\n\t}\n\t// arguments_to_vector(x: number,y: number){\n\t// \tif (arguments.length === 2) {\n\t// \t\tthis._position.x = arguments[0];\n\t// \t\tthis._position.y = arguments[1];\n\t// \t} else {\n\t// \t\tthis._position.x = new_position.x;\n\t// \t\tthis._position.y = new_position.y;\n\t// \t}\n\t// }\n\tto_json(): NodeUIDataJson {\n\t\tthis._json.x = this._position.x;\n\t\tthis._json.y = this._position.y;\n\t\tthis._json.comment = this._comment;\n\t\treturn this._json;\n\t}\n}\n","import {BaseNodeType} from '../_Base';\n\nimport {TimeDependentState} from './states/TimeDependent';\nimport {ErrorState} from './states/Error';\n\nexport class StatesController {\n\ttime_dependent = new TimeDependentState(this.node);\n\terror = new ErrorState(this.node);\n\tconstructor(protected node: BaseNodeType) {}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\n// import lodash_includes from 'lodash/includes';\n// import lodash_values from 'lodash/values';\n\nexport class TimeDependentState {\n\tconstructor(protected node: BaseNodeType) {}\n\n\tget active() {\n\t\treturn this.are_params_time_dependent() || this.are_inputs_time_dependent();\n\t}\n\n\tare_params_time_dependent(): boolean {\n\t\tconst param_names = this.node.params.names;\n\t\tfor (let param_name of param_names) {\n\t\t\tconst param = this.node.params.get(param_name);\n\t\t\tif (param && param.states.time_dependent.active) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tare_inputs_time_dependent(): boolean {\n\t\tconst inputs = this.node.io.inputs.inputs();\n\t\tfor (let input of inputs) {\n\t\t\tif (input && input.states.time_dependent.active) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tforce_time_dependent() {\n\t\tconst predecessor_ids = this.node.graph_predecessors().map((n) => n.graph_node_id);\n\t\tconst frame_node = this.node.scene.time_controller.graph_node; // context();\n\t\tif (!predecessor_ids.includes(frame_node.graph_node_id)) {\n\t\t\tthis.node.add_graph_input(frame_node);\n\t\t}\n\t}\n\tunforce_time_dependent() {\n\t\tconst frame_node = this.node.scene.time_controller.graph_node;\n\t\tthis.node.remove_graph_input(frame_node);\n\t}\n}\n\n// import {BaseNode} from '../_Base';\n\n// export function TimeDependent<TBase extends Constructor>(Base: TBase) {\n// \treturn class Mixin extends Base {\n// \t\tprotected self: BaseNode = (<unknown>this) as BaseNode;\n\n// \t\tis_time_dependent(): boolean {\n// \t\t\treturn this.are_params_time_dependent() || this.are_inputs_time_dependent();\n// \t\t}\n\n// \t\tare_params_time_dependent(): boolean {\n// \t\t\tlet params_time_dependent = false;\n// \t\t\tlodash_values(this.self.params()).forEach((param) => {\n// \t\t\t\tif (param.is_time_dependent()) {\n// \t\t\t\t\tparams_time_dependent = true;\n// \t\t\t\t}\n// \t\t\t});\n// \t\t\treturn params_time_dependent;\n// \t\t}\n\n// \t\tare_inputs_time_dependent(): boolean {\n// \t\t\tlet inputs_time_dependent = false;\n// \t\t\tthis.self.inputs().forEach((node) => {\n// \t\t\t\tif (node != null && node.is_time_dependent()) {\n// \t\t\t\t\tinputs_time_dependent = true;\n// \t\t\t\t}\n// \t\t\t});\n// \t\t\treturn inputs_time_dependent;\n// \t\t}\n\n// \t\tprotected _force_time_dependent() {\n// \t\t\tconst predecessor_ids = this.graph_predecessors().map((n) => n.graph_node_id);\n// \t\t\tconst scene_context = this.scene().context();\n// \t\t\tif (!lodash_includes(predecessor_ids, scene_context.graph_node_id)) {\n// \t\t\t\tthis.self.add_graph_input(scene_context);\n// \t\t\t}\n// \t\t}\n// \t\tprotected _unforce_time_dependent() {\n// \t\t\tconst scene_context = this.scene().context();\n// \t\t\tthis.self.remove_graph_input(scene_context);\n// \t\t}\n// \t};\n// }\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n// import lodash_includes from 'lodash/includes';\n// import lodash_values from 'lodash/values';\n\nexport class ErrorState {\n\tprivate _message: string | undefined;\n\tconstructor(protected node: BaseNodeType) {}\n\n\tset(message: string | undefined) {\n\t\tif (this._message != message) {\n\t\t\tconsole.warn('error', message);\n\t\t\tthis._message = message;\n\t\t\tthis.on_update();\n\t\t}\n\t}\n\tget message() {\n\t\treturn this._message;\n\t}\n\tclear() {\n\t\tthis.set(undefined);\n\t}\n\tget active(): boolean {\n\t\treturn this._message != null;\n\t}\n\n\tprotected on_update() {\n\t\tif (this._message != null) {\n\t\t\t// console.warn(\"new error\", message, this.self.full_path())\n\t\t\tthis.node.set_container(null, `from error '${this._message}'`);\n\t\t}\n\n\t\tthis.node.emit(NodeEvent.ERROR_UPDATED);\n\t}\n}\n\n// export function Errored<TBase extends Constructor>(Base: TBase) {\n// \treturn class Mixin extends Base {\n// \t\tprotected self: BaseNode = (<unknown>this) as BaseNode;\n\n// \t\t_error_message: string = null;\n\n// \t\t// _init_error() {\n// \t\t// \treturn this._error_message = null;\n// \t\t// }\n\n// \t\tset_error(message: string) {\n// \t\t\tconst old_error_message = this._error_message;\n\n// \t\t\tif (message != null) {\n// \t\t\t\tif (this._error_message == null) {\n// \t\t\t\t\tthis._error_message = message;\n// \t\t\t\t}\n// \t\t\t} else {\n// \t\t\t\tthis._error_message = null;\n// \t\t\t}\n\n// \t\t\t// if end_cook is specified here when there's no message, this messes up with events, cook_time\n// \t\t\tif (message != null) {\n// \t\t\t\t// console.warn(\"new error\", message, this.self.full_path())\n// \t\t\t\tthis.self.set_container(null, `from error '${this._error_message}'`);\n// \t\t\t}\n\n// \t\t\tif (this._error_message !== old_error_message) {\n// \t\t\t\tthis.self.emit('node_error_updated');\n// \t\t\t}\n// \t\t}\n\n// \t\tclear_error() {\n// \t\t\tthis.set_error(null);\n// \t\t}\n// \t\tis_errored(): boolean {\n// \t\t\treturn this._error_message != null;\n// \t\t}\n// \t\terror_message(): string {\n// \t\t\treturn this._error_message;\n// \t\t}\n// \t};\n// }\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {NameController} from '../NameController';\n\ntype Callback = () => void;\nimport {CoreWalker} from 'src/core/Walker';\n\nexport class HierarchyParentController {\n\tprivate _parent: BaseNodeType | null = null;\n\tprivate _on_set_parent_hooks: Callback[] | undefined;\n\n\tconstructor(protected node: BaseNodeType) {}\n\n\tget parent() {\n\t\treturn this._parent;\n\t}\n\n\tset_parent(parent: BaseNodeType | null) {\n\t\tif (parent != this.node.parent_controller.parent) {\n\t\t\tthis._parent = parent;\n\t\t\tif (this._parent) {\n\t\t\t\t// this.node.set_scene(this._parent.scene);\n\t\t\t\tthis.node.name_controller.request_name_to_parent(NameController.base_name(this.node));\n\t\t\t}\n\t\t\t// this.on_set_parent();\n\t\t}\n\t}\n\tis_selected(): boolean {\n\t\treturn this.parent?.children_controller?.selection?.contains(this.node) || false;\n\t}\n\tfull_path(): string {\n\t\tconst separator = CoreWalker.SEPARATOR;\n\t\tif (this._parent != null) {\n\t\t\tconst parent_full_path = this._parent.full_path();\n\t\t\tif (parent_full_path === separator) {\n\t\t\t\treturn parent_full_path + this.node.name;\n\t\t\t} else {\n\t\t\t\treturn parent_full_path + separator + this.node.name;\n\t\t\t}\n\t\t} else {\n\t\t\treturn separator;\n\t\t}\n\t}\n\n\ton_set_parent() {\n\t\tif (this._on_set_parent_hooks) {\n\t\t\tfor (let hook of this._on_set_parent_hooks) {\n\t\t\t\thook();\n\t\t\t}\n\t\t}\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\n// import {BaseParam} from 'src/engine/params/_Base'\nimport {DecomposedPath} from './DecomposedPath';\n\n// type NodeOrParam = BaseNode | BaseParam\n\nconst SEPARATOR = '/';\n\nexport class CoreWalkerEmbed {\n\tstatic separator() {\n\t\treturn SEPARATOR;\n\t}\n\n\tstatic find_node(node_src: BaseNodeType, path: string, decomposed_path?: DecomposedPath): BaseNodeType | null {\n\t\tif (!node_src) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst elements: string[] = path.split(SEPARATOR).filter((e) => e.length > 0);\n\t\tconst first_element = elements[0];\n\n\t\tlet next_node: BaseNodeType | null = null;\n\t\tif (path[0] === '/') {\n\t\t\tconst path_from_root = path.substr(1);\n\t\t\tnext_node = this.find_node(node_src.root, path_from_root, decomposed_path);\n\t\t} else {\n\t\t\tswitch (first_element) {\n\t\t\t\tcase '..':\n\t\t\t\t\tnext_node = node_src.parent;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '.':\n\t\t\t\t\tnext_node = node_src;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t// TODO: What does .node means?? in which case is this not a node? (it is for nodes which cannot have children - but I'd like to unify the api)\n\t\t\t\t\t// console.error(\"rethink this method Walker.find_node\")\n\t\t\t\t\t// if (node_src.node != null) {\n\t\t\t\t\tnext_node = node_src.node(first_element);\n\n\t\t\t\t// if (next_node == null) { this.find_node_warning(node_src, first_element); }\n\t\t\t\t// return next_node;\n\t\t\t\t// break\n\t\t\t\t// }\n\t\t\t}\n\t\t\tif (next_node && decomposed_path) {\n\t\t\t\tdecomposed_path.add_node(first_element, next_node);\n\t\t\t}\n\n\t\t\tif (next_node != null && elements.length > 1) {\n\t\t\t\tconst remainder = elements.slice(1).join(SEPARATOR);\n\t\t\t\tnext_node = this.find_node(next_node, remainder, decomposed_path);\n\t\t\t}\n\t\t\treturn next_node;\n\t\t}\n\n\t\treturn next_node;\n\t}\n}\n","import {CoreString} from 'src/core/String';\nimport {CoreWalker} from 'src/core/Walker';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n\nimport lodash_includes from 'lodash/includes';\nimport lodash_keys from 'lodash/keys';\nimport lodash_sortBy from 'lodash/sortBy';\nimport lodash_values from 'lodash/values';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {NameController} from '../NameController';\nimport CoreSelection from 'src/core/NodeSelection';\n\nimport {POLY} from 'src/engine/Poly';\n// import {NameController} from '../NameController';\n\n// interface HierarchyOptions {\n// \tcontext: NodeContext\n// \tdependent?: boolean;\n// }\nconst NODE_SIMPLE_NAME = 'children';\n\nexport class HierarchyChildrenController {\n\t// private _context: NodeContext | undefined;\n\t// private _children_allowed: boolean = false;\n\tprivate _children: Dictionary<BaseNodeType> = {};\n\tprivate _children_by_type: Dictionary<string[]> = {};\n\tprivate _children_and_grandchildren_by_context: Dictionary<string[]> = {};\n\n\tprivate _is_dependent_on_children: boolean = false;\n\tprivate _children_node: CoreGraphNode | undefined;\n\n\tprivate _selection: CoreSelection | undefined;\n\tget selection(): CoreSelection {\n\t\treturn (this._selection = this._selection || new CoreSelection(this.node));\n\t}\n\tconstructor(protected node: BaseNodeType, private _context: NodeContext) {}\n\n\tinit(dependent: boolean = false) {\n\t\t// const context = this.node.children_context();\n\t\t// if (context) {\n\t\t// this._available_children_classes = options['children'] || {};\n\t\t// this._available_children_classes = window.POLY.registered_nodes(context, this.self.type())\n\n\t\t// this._children_allowed = true;\n\t\tthis._children = {};\n\n\t\t// const is_dependent = options['dependent'];\n\t\tif (dependent) {\n\t\t\tthis._is_dependent_on_children = dependent;\n\t\t\tif (this._is_dependent_on_children) {\n\t\t\t\tthis._children_node = new CoreGraphNode(this.node.scene, NODE_SIMPLE_NAME);\n\t\t\t\t// this._children_node.set_scene(this.node.scene);\n\t\t\t\tthis.node.add_graph_input(this._children_node);\n\t\t\t}\n\t\t}\n\t\t// }\n\t}\n\tget context() {\n\t\treturn this._context;\n\t}\n\n\t// TODO: when copy pasting a node called bla_11, the next one will be renamed bla_110 instead of 12\n\tset_child_name(node: BaseNodeType, new_name: string): void {\n\t\t//return if node.name() == new_name\n\t\tlet current_child_with_name;\n\t\tnew_name = new_name.replace(/[^A-Za-z0-9]/g, '_');\n\t\tnew_name = new_name.replace(/^[0-9]/, '_'); // replace first char if not a letter\n\n\t\tif ((current_child_with_name = this._children[new_name]) != null) {\n\t\t\t// only return if found node is same as argument node, and if new_name is same as current_name\n\t\t\tif (node.name === new_name && current_child_with_name.graph_node_id === node.graph_node_id) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// increment new_name\n\t\t\tnew_name = CoreString.increment(new_name);\n\n\t\t\treturn this.set_child_name(node, new_name);\n\t\t} else {\n\t\t\t// let current_child;\n\t\t\tconst current_name = node.name;\n\n\t\t\t// delete old entry if node was in _children with old name\n\t\t\tconst current_child = this._children[current_name];\n\t\t\tif (current_child) {\n\t\t\t\tdelete this._children[current_name];\n\t\t\t}\n\n\t\t\t// add to new name\n\t\t\tthis._children[new_name] = node;\n\t\t\tnode.name_controller.update_name_from_parent(new_name);\n\t\t\tthis._add_to_nodes_by_type(node);\n\t\t\tthis.node.scene.nodes_controller.add_to_instanciated_node(node);\n\t\t}\n\t}\n\n\tnode_context_signature() {\n\t\treturn `${this.node.node_context()}/${this.node.type}`;\n\t}\n\n\tavailable_children_classes() {\n\t\tif (this._context) {\n\t\t\treturn POLY.registered_nodes(this._context, this.node.type);\n\t\t} else {\n\t\t\tconsole.warn('children controller not initialized for node', this.node.type, this.node);\n\t\t\treturn {};\n\t\t}\n\t}\n\t// children_allowed(): boolean {\n\t// \t// return (this.self.available_children_classes != null) &&\n\t// \t// (Object.keys(this.self.available_children_classes()).length > 0);\n\t// \tconst available_classes = this.available_children_classes();\n\t// \treturn available_classes && Object.keys(available_classes).length > 0;\n\t// }\n\n\tcreate_node(node_type: string): BaseNodeType {\n\t\tif (this.available_children_classes() == null) {\n\t\t\tthrow `no children available for ${this.node.full_path()}.`;\n\t\t} else {\n\t\t\tconst node_class = this.available_children_classes()[node_type];\n\n\t\t\tif (node_class == null) {\n\t\t\t\tconst message = `node type ${node_type} not found for ${this.node.full_path()} (${Object.keys(\n\t\t\t\t\tthis.available_children_classes()\n\t\t\t\t).join(', ')}, ${this._context}, ${this.node.type})`;\n\t\t\t\tconsole.error(message);\n\t\t\t\tthrow message;\n\t\t\t} else {\n\t\t\t\tconst child_node = new node_class(this.node.scene, `child_node_${node_type}`);\n\t\t\t\tchild_node.initialize_base_and_node();\n\t\t\t\t// child_node.set_scene(this.node.scene);\n\t\t\t\tthis.add_node(child_node);\n\t\t\t\treturn child_node;\n\t\t\t}\n\t\t}\n\t}\n\n\tadd_node(child_node: BaseNodeType) {\n\t\t// if (!this._children_allowed) {\n\t\t// \tthrow `node ${this.node.full_path()} cannot have children`;\n\t\t// }\n\n\t\tchild_node.set_parent(this.node);\n\t\tchild_node.params.init();\n\t\tchild_node.parent_controller.on_set_parent();\n\t\tchild_node.name_controller.post_set_full_path();\n\t\tif (child_node.children_allowed() && child_node.children_controller) {\n\t\t\tfor (let child of child_node.children_controller.children()) {\n\t\t\t\tchild.name_controller.post_set_full_path();\n\t\t\t}\n\t\t}\n\t\tthis.node.emit(NodeEvent.CREATED, {child_node_json: child_node.to_json()});\n\t\tif (this.node.scene.lifecycle_controller.on_create_hook_allowed()) {\n\t\t\tchild_node.lifecycle.on_create();\n\t\t}\n\t\tthis.set_child_name(child_node, NameController.base_name(child_node));\n\t\tthis.node.lifecycle.on_child_add(child_node);\n\t\t// this.post_add_node(child_node);\n\n\t\tif (this._is_dependent_on_children && this._children_node) {\n\t\t\tthis._children_node.add_graph_input(child_node);\n\t\t}\n\t\tif (child_node.require_webgl2()) {\n\t\t\tthis.node.scene.webgl_controller.set_require_webgl2();\n\t\t}\n\n\t\treturn child_node;\n\t}\n\t// that's redondant with the lifecycle on_child_add and on_child_remove\n\t// post_add_node(node: BaseNode) {}\n\t// post_remove_node(node: BaseNode) {}\n\n\tremove_node(child_node: BaseNodeType): void {\n\t\tif (child_node.parent != this.node) {\n\t\t\treturn console.warn(`node ${child_node.name} not under parent ${this.node.full_path()}`);\n\t\t} else {\n\t\t\t// set other dependencies dirty\n\t\t\tchild_node.set_successors_dirty(this.node);\n\n\t\t\tif (this._is_dependent_on_children && this._children_node) {\n\t\t\t\tthis._children_node.remove_graph_input(child_node);\n\t\t\t}\n\n\t\t\tif (this.selection.contains(child_node)) {\n\t\t\t\tthis.selection.remove([child_node]);\n\t\t\t}\n\n\t\t\tconst first_connection = child_node.io.connections.first_input_connection();\n\t\t\tchild_node.io.connections.input_connections()?.forEach((input_connection) => {\n\t\t\t\tif (input_connection) {\n\t\t\t\t\tinput_connection.disconnect({set_input: true});\n\t\t\t\t}\n\t\t\t});\n\t\t\tchild_node.io.connections.output_connections()?.forEach((output_connection) => {\n\t\t\t\tif (output_connection) {\n\t\t\t\t\toutput_connection.disconnect({set_input: true});\n\t\t\t\t\tif (first_connection) {\n\t\t\t\t\t\tconst old_src = first_connection.node_src;\n\t\t\t\t\t\tconst old_output_index = output_connection.output_index;\n\t\t\t\t\t\tconst old_dest = output_connection.node_dest;\n\t\t\t\t\t\tconst old_input_index = output_connection.input_index;\n\t\t\t\t\t\told_dest.io.inputs.set_input(old_input_index, old_src, old_output_index);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// disconnect successors\n\t\t\tchild_node.graph_disconnect_successors();\n\n\t\t\t// remove from children\n\t\t\tchild_node.set_parent(null);\n\t\t\tdelete this._children[child_node.name];\n\t\t\tthis._remove_from_nodes_by_type(child_node);\n\t\t\tthis.node.scene.nodes_controller.remove_from_instanciated_node(child_node);\n\n\t\t\tthis.node.lifecycle.on_child_remove(child_node);\n\t\t\tchild_node.lifecycle.on_delete();\n\t\t\tchild_node.emit(NodeEvent.DELETED, {parent_id: this.node.graph_node_id});\n\t\t}\n\t}\n\n\tfind_node(path: string): BaseNodeType | null {\n\t\t// if (!this._children_allowed) {\n\t\t// \treturn null;\n\t\t// }\n\t\tif (path == null) {\n\t\t\treturn null;\n\t\t}\n\t\tif (path === CoreWalker.CURRENT || path === CoreWalker.CURRENT_WITH_SLASH) {\n\t\t\treturn this.node;\n\t\t}\n\t\tif (path === CoreWalker.PARENT || path === CoreWalker.PARENT_WITH_SLASH) {\n\t\t\treturn this.node.parent;\n\t\t}\n\n\t\tconst separator = CoreWalker.separator();\n\t\tif (path[0] === separator) {\n\t\t\tpath = path.substring(1, path.length);\n\t\t}\n\n\t\tconst elements = path.split(separator);\n\t\tif (elements.length === 1) {\n\t\t\tconst name = elements[0];\n\t\t\treturn this._children[name];\n\t\t} else {\n\t\t\treturn CoreWalker.find_node(this.node, path);\n\t\t}\n\t}\n\n\t_add_to_nodes_by_type(node: BaseNodeType) {\n\t\tconst node_id = node.graph_node_id;\n\t\tconst type = node.type;\n\t\tthis._children_by_type[type] = this._children_by_type[type] || [];\n\t\tif (!lodash_includes(this._children_by_type[type], node_id)) {\n\t\t\tthis._children_by_type[type].push(node_id);\n\t\t}\n\t\tthis.add_to_children_and_grandchildren_by_context(node);\n\t}\n\t_remove_from_nodes_by_type(node: BaseNodeType) {\n\t\tconst node_id = node.graph_node_id;\n\t\tconst type = node.type;\n\t\tif (this._children_by_type[type]) {\n\t\t\tconst index = this._children_by_type[type].indexOf(node_id);\n\t\t\tif (index >= 0) {\n\t\t\t\tthis._children_by_type[type].splice(index, 1);\n\t\t\t\tif (this._children_by_type[type].length == 0) {\n\t\t\t\t\tdelete this._children_by_type[type];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.remove_from_children_and_grandchildren_by_context(node);\n\t}\n\tadd_to_children_and_grandchildren_by_context(node: BaseNodeType) {\n\t\tconst node_id = node.graph_node_id;\n\t\tconst type = node.node_context();\n\t\tthis._children_and_grandchildren_by_context[type] = this._children_and_grandchildren_by_context[type] || [];\n\t\tif (!lodash_includes(this._children_and_grandchildren_by_context[type], node_id)) {\n\t\t\tthis._children_and_grandchildren_by_context[type].push(node_id);\n\t\t}\n\t\tif (this.node.parent && this.node.parent.children_allowed()) {\n\t\t\tthis.node.parent.children_controller?.add_to_children_and_grandchildren_by_context(node);\n\t\t}\n\t}\n\tremove_from_children_and_grandchildren_by_context(node: BaseNodeType) {\n\t\tconst node_id = node.graph_node_id;\n\t\tconst type = node.node_context();\n\t\tif (this._children_and_grandchildren_by_context[type]) {\n\t\t\tconst index = this._children_and_grandchildren_by_context[type].indexOf(node_id);\n\t\t\tif (index >= 0) {\n\t\t\t\tthis._children_and_grandchildren_by_context[type].splice(index, 1);\n\t\t\t\tif (this._children_and_grandchildren_by_context[type].length == 0) {\n\t\t\t\t\tdelete this._children_and_grandchildren_by_context[type];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.node.parent && this.node.parent.children_allowed()) {\n\t\t\tthis.node.parent.children_controller?.remove_from_children_and_grandchildren_by_context(node);\n\t\t}\n\t}\n\n\tnodes_by_type(type: string): BaseNodeType[] {\n\t\tconst node_ids = this._children_by_type[type] || [];\n\t\tconst graph = this.node.scene.graph;\n\t\tconst nodes: BaseNodeType[] = [];\n\t\tnode_ids.forEach((node_id) => {\n\t\t\tconst node = graph.node_from_id(node_id) as BaseNodeType;\n\t\t\tif (node) {\n\t\t\t\tnodes.push(node);\n\t\t\t}\n\t\t});\n\t\treturn nodes;\n\t}\n\t// children_and_grandchildren_by_context(context: NodeContext): BaseNode[]{\n\t// \tconst node_ids = this._children_and_grandchildren_by_context[context] || []\n\t// \tconst graph = this.self.scene().graph()\n\t// \treturn node_ids.map(node_id=>graph.node_from_id(node_id))\n\t// }\n\thas_children_and_grandchildren_with_context(context: NodeContext) {\n\t\treturn this._children_and_grandchildren_by_context[context] != null;\n\t}\n\t//lodash_filter this.children(), (child)=>\n\t//\tchild.type() == type\n\n\tchildren(): BaseNodeType[] {\n\t\treturn lodash_values(this._children);\n\t}\n\tchildren_names() {\n\t\treturn lodash_sortBy(lodash_keys(this._children));\n\t}\n\t// children_map: ->\n\t// \t@_children\n\n\ttraverse_children(callback: (arg0: BaseNodeType) => void) {\n\t\tfor (let child of this.children()) {\n\t\t\tcallback(child);\n\n\t\t\tchild.children_controller?.traverse_children(callback);\n\t\t}\n\t}\n}\n","// import UIData from './UIData';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport lodash_difference from 'lodash/difference';\nimport lodash_union from 'lodash/union';\n// import lodash_isArray from 'lodash/isArray'\nimport lodash_isEqual from 'lodash/isEqual';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\nexport default class NodeSelection {\n\t_node_ids: string[] = [];\n\tconstructor(private _node: BaseNodeType) {\n\t\t// super();\n\t\t// this._node_ids = [];\n\t}\n\n\tnode() {\n\t\treturn this._node;\n\t}\n\n\tnodes(): BaseNodeType[] {\n\t\treturn this._node.scene.graph.nodes_from_ids(this._node_ids) as BaseNodeType[];\n\t}\n\n\tcontains(node: BaseNodeType): boolean {\n\t\treturn this._node_ids.includes(node.graph_node_id);\n\t}\n\tequals(nodes: BaseNodeType[]): boolean {\n\t\tconst node_ids = nodes.map((node) => node.graph_node_id).sort();\n\t\treturn lodash_isEqual(node_ids, this._node_ids);\n\t}\n\n\tclear() {\n\t\tthis._node_ids = [];\n\t\tthis.send_update_event();\n\t}\n\tset(nodes: BaseNodeType[]) {\n\t\t// this.remove(this.nodes());\n\t\tthis._node_ids = [];\n\t\tthis.add(nodes);\n\t}\n\n\tadd(nodes_to_add: BaseNodeType[]) {\n\t\t// if (!lodash_isArray(nodes_to_add)) { nodes_to_add = [nodes_to_add]; }\n\n\t\tconst node_ids_to_add = nodes_to_add.map((node) => node.graph_node_id);\n\t\tthis._node_ids = lodash_union(this._node_ids, node_ids_to_add);\n\n\t\tthis.send_update_event();\n\t}\n\n\tremove(nodes_to_remove: BaseNodeType[]) {\n\t\t// if (!lodash_isArray(nodes_to_remove)) { nodes_to_remove = [nodes_to_remove]; }\n\n\t\tconst node_ids_to_remove = nodes_to_remove.map((node) => node.graph_node_id);\n\t\tthis._node_ids = lodash_difference(this._node_ids, node_ids_to_remove);\n\n\t\tthis.send_update_event();\n\t}\n\n\tprivate send_update_event() {\n\t\tthis._node.emit(NodeEvent.SELECTION_UPDATED);\n\t}\n\n\tprivate _json: string[] = [];\n\tto_json() {\n\t\tthis._json = this._json || [];\n\t\tthis._json = this._node_ids.map((id) => id);\n\t\treturn this._json;\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\n\ntype Callback = () => void;\ntype CallbackWithChildNode = (child_node: BaseNodeType) => void;\n\nexport class LifeCycleController {\n\tprotected _creation_completed = false;\n\tprotected _on_child_add_hooks: CallbackWithChildNode[] = [];\n\tprivate _on_child_remove_hooks: CallbackWithChildNode[] = [];\n\tprivate _on_create_hooks: Callback[] = [];\n\tprivate _on_delete_hooks: Callback[] = [];\n\tconstructor(protected node: BaseNodeType) {}\n\n\tset_creation_completed() {\n\t\tthis._creation_completed = true;\n\t}\n\tget creation_completed() {\n\t\treturn this.node.scene.loading_controller.loaded && this._creation_completed;\n\t}\n\t//\n\t//\n\t// ON CHILD ADD\n\t//\n\t//\n\tadd_on_child_add_hook(callback: CallbackWithChildNode) {\n\t\tthis._on_child_add_hooks.push(callback);\n\t}\n\ton_child_add(node: BaseNodeType) {\n\t\tthis.execute_hooks_with_child_node(this._on_child_add_hooks, node);\n\t}\n\n\t//\n\t//\n\t// ON CHILD REMOVE\n\t//\n\t//\n\tadd_on_child_remove_hook(callback: CallbackWithChildNode) {\n\t\tthis._on_child_remove_hooks.push(callback);\n\t}\n\ton_child_remove(node: BaseNodeType) {\n\t\tthis.execute_hooks_with_child_node(this._on_child_remove_hooks, node);\n\t}\n\n\t//\n\t//\n\t// ON CREATE\n\t//\n\t//\n\tadd_create_hook(callback: Callback) {\n\t\tthis._on_create_hooks.push(callback);\n\t}\n\ton_create() {\n\t\tthis.execute_hooks(this._on_create_hooks);\n\t}\n\n\t//\n\t//\n\t// ON DELETE\n\t//\n\t//\n\tadd_delete_hook(callback: Callback) {\n\t\tthis._on_delete_hooks.push(callback);\n\t}\n\ton_delete() {\n\t\tthis.execute_hooks(this._on_delete_hooks);\n\t}\n\n\t//\n\t//\n\t// UTILS\n\t//\n\t//\n\tprotected execute_hooks(hooks: Callback[]) {\n\t\tfor (let hook of hooks) {\n\t\t\thook();\n\t\t}\n\t}\n\tprotected execute_hooks_with_child_node(hooks: CallbackWithChildNode[], child_node: BaseNodeType) {\n\t\tfor (let hook of hooks) {\n\t\t\thook(child_node);\n\t\t}\n\t}\n}\n\n// export function LifeCycle<TBase extends Constructor>(Base: TBase) {\n// \treturn class Mixin extends Base {\n// \t\tprotected self: BaseNode = (<unknown>this) as BaseNode;\n// \t\ton_child_add(node: BaseNode) {}\n// \t\t//console.log(\"A #{this.full_path()} lifecycle on_add_child\", node)\n// \t\ton_child_remove(node: BaseNode) {}\n// \t\t//console.log(\"A #{this.full_path()} lifecycle on_child_remove\", node)\n\n// \t\ton_create() {}\n// \t\t//\n// \t\ton_delete() {}\n// \t};\n// }\n","import {BaseNodeType} from '../_Base';\nimport {BaseContainer} from 'src/engine/containers/_Base';\nimport {POLY} from 'src/engine/Poly';\n\nexport class CookController {\n\t_cooking: boolean = false;\n\t_cooks_count: number = 0;\n\t_max_cook_time: number = -1;\n\t_cooking_dirty_timestamp: number | undefined;\n\t_cook_time_with_inputs: number = 0;\n\t_cook_time_with_inputs_start: number | undefined;\n\t_cook_time_start: number | undefined;\n\t_cook_time: number = 0;\n\t_cook_time_params_start: number | undefined;\n\t_cook_time_params: number = 0;\n\t_last_eval_key: string | undefined;\n\n\t_inputs_evaluation_required: boolean = true; //currently only for switch SOP\n\n\tconstructor(private node: BaseNodeType) {}\n\n\tdisallow_inputs_evaluation() {\n\t\tthis._inputs_evaluation_required = false;\n\t}\n\n\tget is_cooking(): boolean {\n\t\treturn this._cooking === true;\n\t}\n\tget cooks_count(): number {\n\t\treturn this._cooks_count;\n\t}\n\tget cook_time(): number {\n\t\treturn this._cook_time;\n\t}\n\t// post_set_dirty: (original_trigger_graph_node, direct_trigger_graph_node)->\n\t//this.emit 'node_dirty_updated'\n\t// this.node_post_set_dirty()\n\t// post_remove_dirty_state: (message)->\n\t// \tif !message?\n\t// \t\tthrow \"remove dirty state without message\"\n\n\t// node_post_set_dirty: ->\n\t// \t#\n\tprivate _init_cooking_state() {\n\t\tthis._cooking = true;\n\t\tthis._cooking_dirty_timestamp = this.node.dirty_controller.dirty_timestamp;\n\t}\n\tprivate _init_cooking_start_time(perf_active?: boolean) {\n\t\tif (perf_active == null) {\n\t\t\tperf_active = this.node.scene.performance.started;\n\t\t}\n\t\tif (perf_active) {\n\t\t\tthis._cook_time_start = performance.now();\n\t\t}\n\t}\n\n\tprivate async _start_cook_if_no_errors(input_contents: any[]) {\n\t\tif (this.node.states.error.active) {\n\t\t\tthis.end_cook();\n\t\t} else {\n\t\t\t// this.self.cook(input_containers);\n\t\t\ttry {\n\t\t\t\tawait this.node.cook(input_contents);\n\t\t\t} catch (e) {\n\t\t\t\tthis.node.states.error.set(`node internal error: '${e}'.`);\n\t\t\t\tconsole.error(this.node.full_path(), e);\n\t\t\t\tthis.end_cook();\n\t\t\t}\n\t\t}\n\t}\n\n\tasync cook_main() {\n\t\tif (this.is_cooking) {\n\t\t\treturn;\n\t\t}\n\t\tthis._init_cooking_state();\n\t\tconst perf_active = this.node.scene.performance.started;\n\t\tif (perf_active) {\n\t\t\tthis._cook_time_with_inputs_start = performance.now();\n\t\t}\n\t\tthis.node.states.error.clear();\n\n\t\t//this._block_params_dirty_propagation()\n\t\tconst input_containers = await this.evaluate_inputs_and_params();\n\n\t\tthis._init_cooking_start_time(perf_active);\n\n\t\tconst input_contents = [];\n\t\tif (input_containers) {\n\t\t\tlet input_container;\n\t\t\tfor (let i = 0; i < input_containers.length; i++) {\n\t\t\t\tinput_container = input_containers[i];\n\t\t\t\tif (input_container) {\n\t\t\t\t\tif (this.node.io.inputs.input_clonable_state_with_override(i)) {\n\t\t\t\t\t\tinput_contents.push(input_container.core_content_cloned());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinput_contents.push(input_container.core_content());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tawait this._start_cook_if_no_errors(input_contents);\n\t}\n\tasync cook_main_without_inputs() {\n\t\tthis.node.scene.cook_controller.add_node(this.node);\n\t\tif (this.is_cooking) {\n\t\t\t// TODO:\n\t\t\t// this seems to happen because when we flush the cooker queue,\n\t\t\t// some graph nodes will trigger more updates, which will then make dependent nodes\n\t\t\t// dirty again\n\t\t\tconsole.warn('cook_main_without_inputs already cooking', this.node.full_path());\n\t\t\treturn;\n\t\t}\n\t\tthis._init_cooking_state();\n\t\tthis._init_cooking_start_time();\n\t\tthis.node.states.error.clear();\n\n\t\tawait this.node.params.eval_all();\n\t\tawait this._start_cook_if_no_errors([]);\n\t}\n\t// catch e\n\t// \tthis.set_error(\"failed to cook: #{e}\")\n\n\tend_cook(message?: string | null) {\n\t\tthis._increment_cooks_count();\n\n\t\tconst dirty_timestamp = this.node.dirty_controller.dirty_timestamp;\n\t\tif (dirty_timestamp == null || dirty_timestamp === this._cooking_dirty_timestamp) {\n\t\t\tthis.node.remove_dirty_state();\n\t\t\tthis._terminate_cook_process();\n\t\t} else {\n\t\t\tPOLY.log('COOK AGAIN', dirty_timestamp, this._cooking_dirty_timestamp, this.node.full_path());\n\t\t\tthis._cooking = false;\n\t\t\tthis.cook_main();\n\t\t}\n\t}\n\n\t_terminate_cook_process() {\n\t\tif (this.is_cooking) {\n\t\t\t//this._unblock_params_dirty_propagation()\n\t\t\tthis._cooking = false;\n\n\t\t\t// this._cook_eval_key = `${this.graph_node_id}/${performance.now()}@${this.context().frame()}`;\n\n\t\t\tthis._record_cook_time();\n\t\t\t//console.log(\"END COOK: #{this.full_path()} #{this.cook_time()} (with inputs:#{this.cook_time_with_inputs()}) (cook count: #{@_cooks_count}): #{message}\")\n\t\t\t//this.notify_requesters()\n\t\t\tsetTimeout(this.node.container_controller.notify_requesters.bind(this.node.container_controller), 0);\n\t\t}\n\t}\n\tprivate _increment_cooks_count() {\n\t\tif (this.is_cooking) {\n\t\t\tif (this._cook_time_start != null) {\n\t\t\t\tthis._cooks_count += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\t// cook_eval_key() {\n\t// \tif (!this.is_dirty()) {\n\t// \t\treturn this._cook_eval_key;\n\t// \t} else {\n\t// \t\treturn performance.now();\n\t// \t}\n\t// }\n\n\t_record_cook_time() {\n\t\tif (this.node.scene.performance.started) {\n\t\t\tconst cook_time_end = performance.now();\n\n\t\t\tif (this._cook_time_with_inputs_start != null) {\n\t\t\t\tthis._cook_time_with_inputs = cook_time_end - this._cook_time_with_inputs_start;\n\t\t\t\tthis._cook_time_with_inputs_start = undefined;\n\t\t\t}\n\n\t\t\tif (this._cook_time_params_start != null && this._cook_time_start != null) {\n\t\t\t\tthis._cook_time_params = this._cook_time_start - this._cook_time_params_start;\n\t\t\t}\n\n\t\t\tif (this._cook_time_start != null) {\n\t\t\t\tthis._cook_time = cook_time_end - this._cook_time_start;\n\t\t\t\tthis._cook_time_start = undefined;\n\t\t\t}\n\n\t\t\tthis._max_cook_time = Math.max(this._max_cook_time, this._cook_time);\n\t\t}\n\n\t\tif (this.node.scene.performance.started) {\n\t\t\tthis.node.scene.performance.record_node_cook_data(this.node);\n\t\t}\n\t}\n\n\t// allow_eval_key_check() {\n\t// \treturn false;\n\t// }\n\n\tasync evaluate_inputs_and_params() {\n\t\t//t0 = performance.now()\n\n\t\tlet input_containers: (BaseContainer | null)[] = [];\n\t\tif (this._inputs_evaluation_required) {\n\t\t\tinput_containers = await this.node.io.inputs.eval_required_inputs_p();\n\t\t}\n\t\t// const inputs_eval_key = input_containers.map( c => c.eval_key()).join('-');\n\n\t\tif (this.node.scene.performance.started) {\n\t\t\tthis._cook_time_params_start = performance.now();\n\t\t}\n\n\t\t/*const params_eval_key = */ await this.node.params.eval_all();\n\t\t// const full_eval_key = [inputs_eval_key, params_eval_key].join('+');\n\t\t// if (this.allow_eval_key_check() && (this._last_eval_key != null) && (this._last_eval_key === full_eval_key)) {\n\t\t// \tthis._terminate_cook_process('no need to cook');\n\t\t// } else {\n\t\t// \tthis._last_eval_key = full_eval_key;\n\t\t// }\n\t\treturn input_containers;\n\t}\n\n\t//this._time_with_precision(@_cook_time)\n\tget cook_time_with_inputs() {\n\t\treturn this._cook_time_with_inputs;\n\t}\n\t//this._time_with_precision(@_cook_time_with_inputs)\n\tget cook_time_params() {\n\t\treturn this._cook_time_params;\n\t}\n\t_time_with_precision(time: number) {\n\t\tconst precision = 1000;\n\t\treturn Math.round(time * precision) / precision;\n\t}\n}\n","import lodash_groupBy from 'lodash/groupBy';\nimport {BaseNodeType, BaseNodeClass} from '../_Base';\n\nimport {BaseParamType, BaseParamClass} from 'src/engine/params/_Base';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n\nenum METHODS {\n\tSUCCESSORS = 'graph_successors',\n\tPREDECESSORS = 'graph_predecessors',\n}\n\n// finally, guard ALL the types!\nfunction typeGuard<T extends PrimitiveOrConstructor>(o: any, className: T): o is GuardedType<T> {\n\tconst localPrimitiveOrConstructor: PrimitiveOrConstructor = className;\n\tif (typeof localPrimitiveOrConstructor === 'string') {\n\t\treturn typeof o === localPrimitiveOrConstructor;\n\t}\n\treturn o instanceof localPrimitiveOrConstructor;\n}\n\nexport class DependenciesController {\n\tprivate _params_referrees_by_graph_node_id: Dictionary<BaseParamType> | undefined;\n\n\tconstructor(protected node: BaseNodeType) {}\n\n\t// debug_dependencies() {\n\t// \tconst nodes = this.scene_successors();\n\t// \tconsole.log('--------------------');\n\t// \tnodes.forEach((n) => {\n\t// \t\tconsole.log(n.full_path());\n\t// \t});\n\t// }\n\n\tscene_successors() {\n\t\treturn this._find_scene_node_scene_nodes(METHODS.SUCCESSORS);\n\t}\n\n\tscene_predecessors() {\n\t\treturn this._find_scene_node_scene_nodes(METHODS.PREDECESSORS);\n\t}\n\tprivate _find_scene_node_scene_nodes(method: METHODS): BaseNodeType[] {\n\t\tconst params = this.node.params.all;\n\t\tconst graph_nodes: CoreGraphNode[] = [];\n\t\tfor (let param of params) {\n\t\t\tgraph_nodes.push(param);\n\t\t}\n\t\tgraph_nodes.push(this.node);\n\t\tconst start_nodes = graph_nodes;\n\t\tlet base_nodes: BaseNodeType[] = [];\n\t\tfor (let start_node of start_nodes) {\n\t\t\tthis._find_base_nodes_from_node(start_node, method, base_nodes);\n\t\t}\n\n\t\tif (method == METHODS.SUCCESSORS) {\n\t\t\tfor (let node of this.param_nodes_referree()) {\n\t\t\t\tbase_nodes.push(node);\n\t\t\t}\n\t\t}\n\n\t\t// ensure uniq and not current node\n\t\tbase_nodes = base_nodes.filter((scene_node) => {\n\t\t\treturn scene_node.graph_node_id != this.node.graph_node_id;\n\t\t});\n\t\tconst base_nodes_by_graph_node_id = lodash_groupBy(base_nodes, (n) => n.graph_node_id);\n\t\tconst uniq_base_nodes: BaseNodeType[] = [];\n\t\tObject.keys(base_nodes_by_graph_node_id).forEach((graph_node_id) => {\n\t\t\tuniq_base_nodes.push(base_nodes_by_graph_node_id[graph_node_id][0]);\n\t\t});\n\t\treturn uniq_base_nodes;\n\t}\n\n\tprivate _find_base_nodes_from_node(node: CoreGraphNode, method: METHODS, base_nodes: BaseNodeType[]) {\n\t\tconst next_nodes = node[method]();\n\t\tfor (let next_node of next_nodes) {\n\t\t\tif (next_node instanceof BaseParamClass) {\n\t\t\t\tbase_nodes.push(next_node.node);\n\t\t\t} else {\n\t\t\t\tif (typeGuard(next_node, BaseNodeClass)) {\n\t\t\t\t\tbase_nodes.push(next_node);\n\t\t\t\t} else {\n\t\t\t\t\tthis._find_base_nodes_from_node(next_node, method, base_nodes);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn base_nodes;\n\t}\n\n\t//\n\t//\n\t// REFERRED BY\n\t// which is used for operator path referring nodes without creating a graph edge\n\t//\n\t//\n\tadd_param_referree(param: BaseParamType) {\n\t\tthis._params_referrees_by_graph_node_id = this._params_referrees_by_graph_node_id || {};\n\t\tthis._params_referrees_by_graph_node_id[param.graph_node_id] = param;\n\t}\n\tremove_param_referree(param: BaseParamType) {\n\t\tif (this._params_referrees_by_graph_node_id) {\n\t\t\tdelete this._params_referrees_by_graph_node_id[param.graph_node_id];\n\t\t}\n\t}\n\tparams_referree(): BaseParamType[] {\n\t\tconst list = [];\n\t\tif (this._params_referrees_by_graph_node_id) {\n\t\t\tfor (let graph_node_id of Object.keys(this._params_referrees_by_graph_node_id)) {\n\t\t\t\tlist.push(this._params_referrees_by_graph_node_id[graph_node_id]);\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\tparam_nodes_referree(): BaseNodeType[] {\n\t\tconst node_by_graph_node_id: Dictionary<BaseNodeType> = {};\n\t\tlet node;\n\t\tfor (let param of this.params_referree()) {\n\t\t\tnode = param.node;\n\t\t\tnode_by_graph_node_id[node.graph_node_id] = node;\n\t\t}\n\t\tconst list = [];\n\t\tfor (let graph_node_id of Object.keys(node_by_graph_node_id)) {\n\t\t\tlist.push(node_by_graph_node_id[graph_node_id]);\n\t\t}\n\t\treturn list;\n\t}\n}\n","import {BaseParamType} from '../_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport lodash_compact from 'lodash/compact';\nimport lodash_cloneDeep from 'lodash/cloneDeep';\nimport lodash_isEqual from 'lodash/isEqual';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamEvent} from 'src/engine/poly/ParamEvent';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n\nconst ALWAYS_REFERENCE_ASSET_OPTION = 'always_reference_asset';\nconst CALLBACK_OPTION = 'callback';\nconst CALLBACK_STRING_OPTION = 'callback_string';\n// const COLOR_OPTION = 'color';\nconst COOK_OPTION = 'cook';\nconst DESKTOP_BROWSE_OPTION = 'desktop_browse';\nconst FILE_TYPE_OPTION = 'file_type';\n// const EXPRESSION_ONLY_OPTION = 'expression_only';\nconst EXPRESSION = 'expression';\nconst FOR_ENTITIES = 'for_entities';\nconst LEVEL = 'level';\nconst MENU = 'menu';\nconst ENTRIES = 'entries';\n// const TYPE = 'type';\n// const RADIO = 'radio';\nconst MULTILINE_OPTION = 'multiline';\nconst NODE_SELECTION = 'node_selection';\nconst NODE_SELECTION_CONTEXT = 'context';\nconst DEPENDENT_ON_FOUND_NODE = 'dependent_on_found_node';\nconst RANGE_OPTION = 'range';\nconst RANGE_LOCKED_OPTION = 'range_locked';\nconst STEP_OPTION = 'step';\nconst SPARE_OPTION = 'spare';\nconst TEXTURE_OPTION = 'texture';\nconst ENV_OPTION = 'env';\nconst HIDDEN_OPTION = 'hidden';\nconst LABEL_OPTION = 'label';\nconst FIELD_OPTION = 'field';\nconst VISIBLE_IF_OPTION = 'visible_if';\n\nexport interface ParamOptionsMenuEntry {\n\tname: string;\n\tvalue: number;\n}\n\ninterface BaseParamOptions {\n\t// cook\n\tcook?: boolean;\n\t// spare\n\tspare?: boolean;\n\t// visible\n\thidden?: boolean;\n\tlabel?: boolean;\n\tfield?: boolean;\n\tvisible_if?: Dictionary<number | boolean>;\n}\ninterface MenuParamOptions {\n\tmenu?: {\n\t\t// type: 'radio';\n\t\tentries: ParamOptionsMenuEntry[];\n\t};\n}\ninterface ExpressionParamOptions {\n\texpression?: {\n\t\tfor_entities?: boolean;\n\t};\n}\n\ninterface NumberParamOptions extends BaseParamOptions {\n\trange?: Number2;\n\trange_locked?: Boolean2;\n\tstep?: number;\n}\ninterface AssetParamOptions {\n\talways_reference_asset?: boolean;\n}\ninterface DesktopParamOptions {\n\tdesktop_browse?: Dictionary<string>;\n}\ninterface CallbackParamOptions {\n\tcallback?: (node: BaseNodeType, param: BaseParamType) => any;\n\tcallback_string?: string;\n}\n\n// actual param options\nexport interface BooleanParamOptions\n\textends BaseParamOptions,\n\t\tMenuParamOptions,\n\t\tExpressionParamOptions,\n\t\tCallbackParamOptions {}\nexport interface ButtonParamOptions extends BaseParamOptions, CallbackParamOptions {}\nexport interface ColorParamOptions extends BaseParamOptions, ExpressionParamOptions {}\nexport interface FloatParamOptions\n\textends NumberParamOptions,\n\t\tMenuParamOptions,\n\t\tExpressionParamOptions,\n\t\tCallbackParamOptions {}\nexport interface FolderParamOptions extends BaseParamOptions {\n\tlevel?: number;\n}\nexport interface IntegerParamOptions extends NumberParamOptions, MenuParamOptions, CallbackParamOptions {}\nexport interface OperatorPathParamOptions extends BaseParamOptions, DesktopParamOptions, CallbackParamOptions {\n\tnode_selection?: {\n\t\tcontext?: NodeContext;\n\t};\n\tdependent_on_found_node?: boolean;\n}\nexport interface RampParamOptions extends BaseParamOptions {}\nexport interface SeparatorParamOptions extends BaseParamOptions {}\nexport interface StringParamOptions\n\textends BaseParamOptions,\n\t\tAssetParamOptions,\n\t\tDesktopParamOptions,\n\t\tExpressionParamOptions {\n\tmultiline?: boolean;\n}\nexport interface Vector2ParamOptions extends BaseParamOptions, ExpressionParamOptions {}\nexport interface Vector3ParamOptions extends BaseParamOptions, ExpressionParamOptions {}\nexport interface Vector4ParamOptions extends BaseParamOptions, ExpressionParamOptions {}\n\nexport interface ParamOptions\n\textends NumberParamOptions,\n\t\tFolderParamOptions,\n\t\tExpressionParamOptions,\n\t\tButtonParamOptions,\n\t\tDesktopParamOptions,\n\t\tMenuParamOptions,\n\t\tStringParamOptions,\n\t\tOperatorPathParamOptions {\n\t// asset refererences\n\t// always_reference_asset?: boolean;\n\t// callback\n\t// callback?: (node: BaseNodeType, param: BaseParamType) => any;\n\t// callback_string?: string;\n\t// color\n\t// color?: [number, number, number] | string;\n\t// cook\n\t// cook?: boolean;\n\t// desktop\n\t// desktop_browse?: Dictionary<string>;\n\t// expression\n\t// expression_only?: boolean;\n\t// expression?: {\n\t// \tfor_entities?: boolean;\n\t// };\n\t// folder\n\t// level?:number\n\t// menu\n\t// menu?: {\n\t// \t// type: 'radio';\n\t// \tentries: ParamOptionsMenuEntry[];\n\t// };\n\t// multiline\n\t// multiline?: boolean;\n\t// node selection\n\t// node_selection?: {\n\t// \tcontext?: NodeContext;\n\t// };\n\t// dependent_on_found_node?: boolean;\n\t// spare\n\t// spare?: boolean;\n\t// texture\n\ttexture?: {\n\t\tenv?: boolean;\n\t};\n\t// visible\n\t// hidden?: boolean;\n\t// label?: boolean;\n\t// field?: boolean;\n\t// visible_if?: Dictionary<number | boolean>;\n}\n\nexport class OptionsController {\n\tprivate _programatic_visible_state: boolean = true;\n\tprivate _options!: ParamOptions;\n\tprivate _default_options!: ParamOptions;\n\tconstructor(private _param: BaseParamType) {\n\t\t// this._options = lodash_cloneDeep(this._default_options);\n\t}\n\n\tset(options: ParamOptions) {\n\t\tthis._default_options = options;\n\t\tthis._options = lodash_cloneDeep(this._default_options);\n\t}\n\tcopy(options_controller: OptionsController) {\n\t\tthis._default_options = lodash_cloneDeep(options_controller.default);\n\t\tthis._options = lodash_cloneDeep(options_controller.current);\n\t}\n\tset_option(name: keyof ParamOptions, value: any) {\n\t\treturn Object.assign(this._options, name, value);\n\t}\n\tget param() {\n\t\treturn this._param;\n\t}\n\tget node(): BaseNodeType {\n\t\treturn this._param.node;\n\t}\n\tget default() {\n\t\treturn this._default_options;\n\t}\n\tget current() {\n\t\treturn this._options;\n\t}\n\n\t// utils\n\tget has_options_overridden(): boolean {\n\t\treturn !lodash_isEqual(this._options, this._default_options);\n\t}\n\tget overridden_options(): ParamOptions {\n\t\tconst overriden: ParamOptions = {};\n\t\tconst option_names = Object.keys(this._options) as Array<keyof ParamOptions>;\n\t\tfor (let option_name of option_names) {\n\t\t\tif (!lodash_isEqual(this._options[option_name], this._default_options[option_name])) {\n\t\t\t\tObject.assign(overriden, option_name, lodash_cloneDeep(this._options[option_name]));\n\t\t\t}\n\t\t}\n\t\treturn overriden;\n\t}\n\tget overridden_option_names(): Array<keyof ParamOptions> {\n\t\treturn Object.keys(this.overridden_options) as Array<keyof ParamOptions>;\n\t}\n\n\t// referenced assets\n\tget always_reference_asset(): boolean {\n\t\treturn this._options[ALWAYS_REFERENCE_ASSET_OPTION] || false;\n\t}\n\n\t// callback\n\thas_callback() {\n\t\treturn this._options[CALLBACK_OPTION] != null || this._options[CALLBACK_STRING_OPTION] != null;\n\t}\n\n\texecute_callback() {\n\t\t// we only allow execution when scene is loaded\n\t\t// to avoid errors such as an operator_path param\n\t\t// executing its callback before the node it points to is created\n\t\tif (!(this.node && this.node.scene.loading_controller.loaded)) {\n\t\t\treturn;\n\t\t}\n\t\tconst callback = this.get_callback();\n\t\tif (callback != null) {\n\t\t\tif (this.node && !this.node.cook_controller.is_cooking) {\n\t\t\t\tcallback(this.node, this.param);\n\t\t\t}\n\t\t}\n\t}\n\tprivate get_callback() {\n\t\tif (this.has_callback()) {\n\t\t\treturn (this._options[CALLBACK_OPTION] =\n\t\t\t\tthis._options[CALLBACK_OPTION] || this.create_callback_from_string());\n\t\t}\n\t}\n\tprivate create_callback_from_string() {\n\t\tconst callback_string = this._options[CALLBACK_STRING_OPTION];\n\t\tif (callback_string) {\n\t\t\tconst callback_function = new Function('node', 'scene', 'window', 'location', callback_string);\n\t\t\treturn () => {\n\t\t\t\tcallback_function(this.node, this.node.scene, null, null);\n\t\t\t};\n\t\t}\n\t}\n\n\t// color\n\t// color() {\n\t// \treturn this._options[COLOR_OPTION];\n\t// }\n\n\t// cook\n\tmakes_node_dirty_when_dirty() {\n\t\tlet cook_options;\n\n\t\t// false as the dirty state will go through the parent param\n\t\tif (this.param.parent_param != null) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet value = true;\n\t\tif ((cook_options = this._options[COOK_OPTION]) != null) {\n\t\t\tvalue = cook_options;\n\t\t}\n\t\treturn value;\n\t}\n\n\t// desktop\n\tget desktop_browse_option() {\n\t\treturn this._options[DESKTOP_BROWSE_OPTION];\n\t}\n\tget desktop_browse_allowed(): boolean {\n\t\treturn this.desktop_browse_option != null;\n\t}\n\tdesktop_browse_file_type(): string | null {\n\t\tif (this.desktop_browse_option) {\n\t\t\treturn this.desktop_browse_option[FILE_TYPE_OPTION];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t// expression\n\t// get displays_expression_only() {\n\t// \treturn this._options[EXPRESSION_ONLY_OPTION] === true;\n\t// }\n\tget is_expression_for_entities(): boolean {\n\t\tconst expr_option = this._options[EXPRESSION];\n\t\tif (expr_option) {\n\t\t\treturn expr_option[FOR_ENTITIES] || false;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// folder\n\tget level() {\n\t\treturn this._options[LEVEL] || 0;\n\t}\n\n\t// menu\n\tget has_menu() {\n\t\treturn this.menu_options != null;\n\t}\n\n\tprivate get menu_options() {\n\t\treturn this._options[MENU];\n\t}\n\t// private get menu_type() {\n\t// \tif(this.menu_options){\n\t// \t\treturn this.menu_options[TYPE];\n\t// \t}\n\t// }\n\n\tget menu_entries() {\n\t\tif (this.menu_options) {\n\t\t\treturn this.menu_options[ENTRIES];\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tget has_menu_radio() {\n\t\treturn this.has_menu; //&& this.menu_options[TYPE] === RADIO;\n\t}\n\n\t// multiline\n\tget is_multiline(): boolean {\n\t\treturn this._options[MULTILINE_OPTION] === true;\n\t}\n\n\t// node selection\n\tget node_selection_options() {\n\t\treturn this._options[NODE_SELECTION];\n\t}\n\tget node_selection_context() {\n\t\tif (this.node_selection_options) {\n\t\t\treturn this.node_selection_options[NODE_SELECTION_CONTEXT];\n\t\t}\n\t}\n\n\tdependent_on_found_node() {\n\t\tif (DEPENDENT_ON_FOUND_NODE in this._options) {\n\t\t\treturn this._options[DEPENDENT_ON_FOUND_NODE];\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t// range\n\tget range(): Number2 {\n\t\t// cannot force range easily, as values are not necessarily from 0 to N\n\t\t// if(this.self.has_menu() && this.self.menu_entries()){\n\t\t// \treturn [0, this.self.menu_entries().length-1 ]\n\t\t// } else {\n\t\treturn this._options[RANGE_OPTION] || [0, 1];\n\t\t// }\n\t}\n\tget step(): number {\n\t\treturn this._options[STEP_OPTION] || 0.01;\n\t}\n\n\tprivate range_locked(): Boolean2 {\n\t\t// if(this.self.has_menu() && this.self.menu_entries()){\n\t\t// \treturn [true, true]\n\t\t// } else {\n\t\treturn this._options[RANGE_LOCKED_OPTION] || [false, false];\n\t\t// }\n\t}\n\n\tensure_in_range(value: number): number {\n\t\tconst range = this.range;\n\n\t\tif (value >= range[0] && value <= range[1]) {\n\t\t\treturn value;\n\t\t} else {\n\t\t\tif (value < range[0]) {\n\t\t\t\treturn this.range_locked()[0] === true ? range[0] : value;\n\t\t\t} else {\n\t\t\t\treturn this.range_locked()[1] === true ? range[1] : value;\n\t\t\t}\n\t\t}\n\t}\n\n\t// spare\n\tget is_spare(): boolean {\n\t\treturn this._options[SPARE_OPTION] || false;\n\t}\n\n\t// texture\n\tget texture_options() {\n\t\treturn this._options[TEXTURE_OPTION];\n\t}\n\ttexture_as_env(): boolean {\n\t\tconst texture_options = this.texture_options;\n\t\tif (texture_options != null) {\n\t\t\treturn texture_options[ENV_OPTION] === true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// visible\n\tget is_hidden(): boolean {\n\t\treturn this._options[HIDDEN_OPTION] === true || this._programatic_visible_state === false;\n\t}\n\tget is_visible(): boolean {\n\t\treturn !this.is_hidden;\n\t}\n\tset_visible_state(state: boolean) {\n\t\tthis._options[HIDDEN_OPTION] = !state;\n\t\tthis.param.emit(ParamEvent.VISIBLE_UPDATED);\n\t}\n\n\tget is_label_hidden(): boolean {\n\t\tconst type = this.param.type;\n\t\treturn (\n\t\t\tthis._options[LABEL_OPTION] === false ||\n\t\t\ttype === ParamType.BUTTON ||\n\t\t\ttype === ParamType.SEPARATOR ||\n\t\t\t(type === ParamType.BOOLEAN && this.is_field_hidden())\n\t\t);\n\t}\n\tis_field_hidden(): boolean {\n\t\treturn this._options[FIELD_OPTION] === false;\n\t}\n\n\t// programatic visibility\n\tui_data_depends_on_other_params(): boolean {\n\t\treturn VISIBLE_IF_OPTION in this._options;\n\t}\n\tvisibility_predecessors() {\n\t\tconst predecessor_names = Object.keys(this._options[VISIBLE_IF_OPTION] || {});\n\t\tconst node = this.param.node;\n\t\treturn lodash_compact(\n\t\t\tpredecessor_names.map((name) => {\n\t\t\t\tconst param = node.params.get(name);\n\t\t\t\tif (param) {\n\t\t\t\t\treturn param;\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t`param ${name} not found as visibility condition for ${this.param.name} in node ${this.param.node.type}`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\tprivate _update_visibility_and_remove_dirty_bound = this.update_visibility_and_remove_dirty.bind(this);\n\tprivate _visibility_graph_node: CoreGraphNode | undefined;\n\tprivate _ui_data_dependency_set: boolean = false;\n\tset_ui_data_dependency() {\n\t\tif (this._ui_data_dependency_set) {\n\t\t\treturn;\n\t\t}\n\t\tthis._ui_data_dependency_set = true;\n\t\tconst predecessors = this.visibility_predecessors();\n\t\tif (predecessors.length > 0) {\n\t\t\tthis._visibility_graph_node = new CoreGraphNode(this.param.scene, 'param_visibility');\n\t\t\tfor (let predecessor of predecessors) {\n\t\t\t\tthis._visibility_graph_node.add_graph_input(predecessor);\n\t\t\t}\n\t\t\tthis._visibility_graph_node.add_post_dirty_hook(\n\t\t\t\t'_update_visibility_and_remove_dirty',\n\t\t\t\tthis._update_visibility_and_remove_dirty_bound\n\t\t\t);\n\t\t}\n\t}\n\tprivate update_visibility_and_remove_dirty() {\n\t\tthis.update_visibility();\n\t\tthis.param.remove_dirty_state();\n\t}\n\n\tasync update_visibility() {\n\t\tconst options = this._options[VISIBLE_IF_OPTION];\n\t\tif (options) {\n\t\t\tconst params = this.visibility_predecessors();\n\t\t\tconst promises = params.map((p) => p.compute());\n\t\t\tthis._programatic_visible_state = true;\n\t\t\tawait Promise.all(promises);\n\t\t\tfor (let param of params) {\n\t\t\t\tconst expected_val = options[param.name];\n\t\t\t\tconst val = param.value;\n\t\t\t\tif (expected_val != val) {\n\t\t\t\t\tthis._programatic_visible_state = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.param.emit(ParamEvent.VISIBLE_UPDATED);\n\t\t}\n\t}\n}\n","import {BaseParamType} from '../_Base';\nimport {ParamEvent} from 'src/engine/poly/ParamEvent';\n\nexport class EmitController {\n\t_blocked_emit: boolean = false;\n\t_blocked_parent_emit: boolean = false;\n\t_count_by_event_name: Dictionary<number> = {};\n\tconstructor(protected param: BaseParamType) {}\n\n\tget emit_allowed(): boolean {\n\t\tif (this._blocked_emit === true) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.param.scene.loading_controller.is_loading) {\n\t\t\treturn false;\n\t\t}\n\t\t// TODO: should I also prevent nodes from updating\n\t\t// when they are being called in a loop such as from the Copy SOP?\n\t\t//node = this.node()\n\t\t//node? && !node.is_cooking() && this.scene().emit_allowed() # this prevents a camera from updating its param for instance\n\t\t// although maybe I should send a dirty to the store, and then that store queries the param?\n\t\treturn this.param.scene.events_controller.emit_allowed;\n\t}\n\n\tblock_emit() {\n\t\tthis._blocked_emit = true;\n\t\tif (this.param.is_multiple && this.param.components) {\n\t\t\tthis.param.components.forEach((c) => c.emit_controller.block_emit());\n\t\t}\n\t\treturn true;\n\t}\n\tunblock_emit() {\n\t\tthis._blocked_emit = false;\n\t\tif (this.param.is_multiple && this.param.components) {\n\t\t\tthis.param.components.forEach((c) => c.emit_controller.unblock_emit());\n\t\t}\n\t\treturn true;\n\t}\n\tblock_parent_emit() {\n\t\tthis._blocked_parent_emit = true;\n\t\treturn true;\n\t}\n\tunblock_parent_emit() {\n\t\tthis._blocked_parent_emit = false;\n\t\treturn true;\n\t}\n\n\tincrement_count(event_name: ParamEvent) {\n\t\tthis._count_by_event_name[event_name] = this._count_by_event_name[event_name] || 0;\n\t\tthis._count_by_event_name[event_name] += 1;\n\t}\n\tevents_count(event_name: ParamEvent): number {\n\t\treturn this._count_by_event_name[event_name] || 0;\n\t}\n\n\temit(event: ParamEvent) {\n\t\tif (this.emit_allowed) {\n\t\t\tthis.param.emit(event);\n\n\t\t\tif (this.param.parent_param != null && this._blocked_parent_emit !== true) {\n\t\t\t\tthis.param.parent_param.emit(event);\n\t\t\t}\n\t\t}\n\t}\n\t// emit_param_updated() {\n\t// \tconsole.log('emit_param_updated', this.param.name, this.emit_allowed);\n\t// \tif (this.emit_allowed) {\n\t// \t\tthis.param.emit(ParamEvent.UPDATED);\n\n\t// \t\tif (this.param.parent_param != null && this._blocked_parent_emit !== true) {\n\t// \t\t\tthis.param.parent_param.emit(ParamEvent.UPDATED);\n\t// \t\t}\n\t// \t}\n\t// \t//else\n\t// \t//\tthis.emit('param_updated')\n\n\t// \t// return null\n\t// }\n}\n","import {BaseParamType} from '../_Base';\nimport {ParamValueSerializedTypeMap} from '../types/ParamValueSerializedTypeMap';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamInitValueSerializedTypeMap} from '../types/ParamInitValueSerializedTypeMap';\n\nexport interface ParamSerializerData {\n\tname: string;\n\ttype: string;\n\traw_input: ParamInitValueSerializedTypeMap[ParamType];\n\tvalue: ParamValueSerializedTypeMap[ParamType];\n\texpression?: string;\n\tgraph_node_id: string;\n\t// is_dirty: boolean;\n\terror_message?: string;\n\tis_visible: boolean;\n\tfolder_name?: string;\n\tcomponents?: string[];\n}\n\nexport class ParamSerializer {\n\tconstructor(protected param: BaseParamType) {}\n\n\tto_json(): ParamSerializerData {\n\t\tconst data: ParamSerializerData = {\n\t\t\tname: this.param.name,\n\t\t\ttype: this.param.type,\n\t\t\traw_input: this.raw_input(),\n\t\t\tvalue: this.value(),\n\t\t\texpression: this.expression(),\n\t\t\tgraph_node_id: this.param.graph_node_id,\n\t\t\t// is_dirty: this.param.is_dirty,\n\t\t\terror_message: this.error_message(),\n\t\t\tis_visible: this.is_visible(),\n\t\t\t// folder_name: this.param.ui_data.folder_name,\n\t\t\tcomponents: undefined,\n\t\t};\n\n\t\tif (this.param.is_multiple && this.param.components) {\n\t\t\tdata['components'] = this.param.components.map((component) => component.graph_node_id);\n\t\t}\n\n\t\treturn data;\n\t}\n\n\traw_input() {\n\t\treturn this.param.raw_input_serialized;\n\t}\n\tvalue() {\n\t\treturn this.param.value_serialized;\n\t}\n\texpression() {\n\t\treturn this.param.has_expression() ? this.param.expression_controller?.expression : undefined;\n\t}\n\terror_message() {\n\t\treturn this.param.states.error.message;\n\t}\n\tis_visible() {\n\t\treturn this.param.options.is_visible;\n\t}\n}\n","import {BaseParamType} from '../_Base';\n\nimport {TimeDependentState} from './states/TimeDependent';\nimport {ErrorState} from './states/Error';\n\nexport class StatesController {\n\ttime_dependent = new TimeDependentState(this.param);\n\terror = new ErrorState(this.param);\n\tconstructor(protected param: BaseParamType) {}\n}\n","import {BaseParamType} from 'src/engine/params/_Base';\n\nexport class TimeDependentState {\n\tconstructor(protected param: BaseParamType) {}\n\n\tget active(): boolean {\n\t\tconst frame_graph_node_id = this.param.scene.time_controller.graph_node.graph_node_id;\n\n\t\treturn this.param.graph_predecessor_ids().includes(frame_graph_node_id);\n\t}\n}\n","import {BaseParamType} from 'src/engine/params/_Base';\nimport {ParamEvent} from 'src/engine/poly/ParamEvent';\n// import lodash_includes from 'lodash/includes';\n// import lodash_values from 'lodash/values';\n\nexport class ErrorState {\n\tprivate _message: string | undefined;\n\tconstructor(private param: BaseParamType) {}\n\n\tset(message: string | undefined) {\n\t\tif (this._message != message) {\n\t\t\tthis._message = message;\n\t\t\tthis.param.emit_controller.emit(ParamEvent.ERROR_UPDATED);\n\t\t}\n\t}\n\tget message() {\n\t\treturn this._message;\n\t}\n\tclear() {\n\t\tthis.set(undefined);\n\t}\n\tget active(): boolean {\n\t\treturn this._message != null;\n\t}\n}\n","// import {Color} from 'three/src/math/Color';\n// import {Vector2} from 'three/src/math/Vector2';\n// import {Vector3} from 'three/src/math/Vector3';\n// import {Vector4} from 'three/src/math/Vector4';\n\n// import lodash_each from 'lodash/each';\n// import lodash_values from 'lodash/values';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {ParamOptions} from 'src/engine/params/utils/OptionsController';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n\n// import {TypedParam} from 'src/engine/params/_Base';\nimport {FloatParam} from 'src/engine/params/Float';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\n\n// import {Vector2} from 'three/src/math/Vector2';\n// import {Vector3} from 'three/src/math/Vector3';\n// import {Color} from 'three/src/math/Color';\n// import {RampValue} from 'src/engine/params/ramp/RampValue';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamEvent} from 'src/engine/poly/ParamEvent';\n// import {RampValue} from 'src/engine/params/ramp/RampValue';\n// import {Vector4} from 'three/src/math/Vector4';\nimport {NodeParamsConfig} from './ParamsConfig';\n\nimport {ParamConstructorMap} from '../../../params/types/ParamConstructorMap';\nimport {ParamConstructorByType} from '../../../params/types/ParamConstructorByType';\nimport {ParamInitValuesTypeMap} from '../../../params/types/ParamInitValuesTypeMap';\nimport {ParamValuesTypeMap} from '../../../params/types/ParamValuesTypeMap';\n\n// export type ParamInitValue =\n// \t| StringOrNumber\n// \t| StringOrNumber2\n// \t| StringOrNumber3\n// \t| StringOrNumber4\n// \t| boolean\n// \t| string\n// \t| null\n// \t| Color\n// \t| Vector2\n// \t| Vector3\n// \t| Vector4\n// \t| RampValue\n// \t| RampValueJson;\n\n// export type ParamValueSerialized =\n// \t| StringOrNumber\n// \t| StringOrNumber2\n// \t| StringOrNumber3\n// \t| StringOrNumber4\n// \t| boolean\n// \t| string\n// \t| null\n// \t| RampValueJson;\n\n// export type ParamValue = boolean | Color | number | string | RampValue | Vector2 | Vector3 | Vector4 | null;\n// export type MultipleNumericParamValue = Vector2 | Vector3 | Vector4 | Color;\n// export type NumericParamValue = MultipleNumericParamValue | number;\n\nconst NODE_SIMPLE_NAME = 'params';\n\nexport type OnSceneLoadHook = () => void;\ntype PostCreateParamsHook = () => void;\n\nexport class ParamsController {\n\tprivate _param_create_mode: boolean = false;\n\tprivate _params_by_name: Dictionary<BaseParamType> = {};\n\t// caches\n\tprivate _params_list: BaseParamType[] = [];\n\tprivate _param_names: string[] = [];\n\tprivate _non_spare_params: BaseParamType[] = [];\n\tprivate _spare_params: BaseParamType[] = [];\n\tprivate _non_spare_param_names: string[] = [];\n\tprivate _spare_param_names: string[] = [];\n\n\tprivate _params_node: CoreGraphNode | undefined;\n\t// private _params_eval_key: string;\n\tprivate _params_added_since_last_params_eval: boolean = false;\n\t// private _current_param_folder_name: string | undefined;\n\n\t// hooks\n\tprivate _post_create_params_hook: PostCreateParamsHook | undefined;\n\tprivate _on_scene_load_hooks: OnSceneLoadHook[] | undefined;\n\tprivate _on_scene_load_hook_names: string[] | undefined;\n\n\tconstructor(protected node: BaseNodeType) {}\n\n\tprivate init_dependency_node() {\n\t\tif (!this._params_node) {\n\t\t\t// TODO: consider not having a params_node for nodes which have no parameters\n\t\t\tthis._params_node = new CoreGraphNode(this.node.scene, NODE_SIMPLE_NAME);\n\t\t\t// this._params_node.set_scene(this.node.scene);\n\t\t\tthis.node.add_graph_input(this._params_node);\n\t\t}\n\t}\n\n\tinit() {\n\t\tthis.init_dependency_node();\n\t\t// this.reset_params()\n\t\tthis._param_create_mode = true;\n\n\t\tthis.init_from_params_config();\n\t\tthis.node.create_params();\n\t\tthis._post_create_params();\n\t}\n\tprivate _post_create_params() {\n\t\tthis._update_caches();\n\t\t// this._create_params_ui_data_dependencies();\n\t\tthis.init_param_accessors();\n\t\tthis._param_create_mode = false;\n\n\t\tthis.run_post_create_params_hook();\n\n\t\t// This was to debug a weird bug where I was adding nodes to the list\n\t\t// of params, from the DependenciesController\n\t\t// this._params_list.push = (...items: BaseParamType[]) => {\n\t\t// \tif (items[0] && !items[0].compute) {\n\t\t// \t\tconsole.warn('adding params', items);\n\t\t// \t}\n\t\t// \tfor (let i of items) {\n\t\t// \t\tthis._params_list[this._params_list.length] = i;\n\t\t// \t}\n\t\t// \treturn 0;\n\t\t// };\n\t}\n\tpost_create_spare_params() {\n\t\tthis._update_caches();\n\t\tthis.init_param_accessors();\n\t}\n\n\tprivate init_from_params_config() {\n\t\tconst params_config = this.node.params_config as NodeParamsConfig;\n\t\tif (params_config) {\n\t\t\tfor (let name of Object.keys(params_config)) {\n\t\t\t\tconst config = params_config[name];\n\t\t\t\tthis.add_param(config.type, name, config.init_value, config.options);\n\t\t\t}\n\t\t}\n\t}\n\tprivate init_param_accessors() {\n\t\tlet current_names_in_accessor = Object.getOwnPropertyNames(this.node.pv);\n\t\tthis._remove_unneeded_accessors(current_names_in_accessor);\n\t\t// update var after having removed accessors\n\t\tcurrent_names_in_accessor = Object.getOwnPropertyNames(this.node.pv);\n\n\t\tfor (let param of this.all) {\n\t\t\tconst is_spare: boolean = param.options.is_spare;\n\n\t\t\tconst param_not_yet_in_accessors = !current_names_in_accessor.includes(param.name);\n\n\t\t\tif (param_not_yet_in_accessors || is_spare) {\n\t\t\t\tObject.defineProperty(this.node.pv, param.name, {\n\t\t\t\t\tget: () => {\n\t\t\t\t\t\treturn param.value;\n\t\t\t\t\t},\n\t\t\t\t\t// only spare parameters can be removed\n\t\t\t\t\tconfigurable: is_spare,\n\t\t\t\t});\n\t\t\t\tObject.defineProperty(this.node.p, param.name, {\n\t\t\t\t\tget: () => {\n\t\t\t\t\t\treturn param;\n\t\t\t\t\t},\n\t\t\t\t\tconfigurable: is_spare,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\tprivate _remove_unneeded_accessors(current_names_in_accessor: string[]) {\n\t\tconst current_param_names = this._param_names;\n\t\tconst names_to_remove = [];\n\t\tfor (let current_name_in_accessor of current_names_in_accessor) {\n\t\t\tif (!current_param_names.includes(current_name_in_accessor)) {\n\t\t\t\tnames_to_remove.push(current_name_in_accessor);\n\t\t\t}\n\t\t}\n\n\t\tfor (let name_to_remove of names_to_remove) {\n\t\t\tObject.defineProperty(this.node.pv, name_to_remove, {\n\t\t\t\tget: () => {\n\t\t\t\t\treturn undefined;\n\t\t\t\t},\n\t\t\t\tconfigurable: true,\n\t\t\t});\n\t\t\tObject.defineProperty(this.node.p, name_to_remove, {\n\t\t\t\tget: () => {\n\t\t\t\t\treturn undefined;\n\t\t\t\t},\n\t\t\t\tconfigurable: true,\n\t\t\t});\n\t\t}\n\t}\n\n\tget params_node() {\n\t\treturn this._params_node;\n\t}\n\tget all() {\n\t\treturn this._params_list;\n\t}\n\tget non_spare() {\n\t\treturn this._non_spare_params;\n\t}\n\tget spare() {\n\t\treturn this._spare_params;\n\t}\n\tget names(): string[] {\n\t\treturn this._param_names;\n\t}\n\tget non_spare_names(): string[] {\n\t\treturn this._non_spare_param_names;\n\t}\n\tget spare_names(): string[] {\n\t\treturn this._spare_param_names;\n\t}\n\t// get params_by_name() {\n\t// \treturn this._params_by_name;\n\t// }\n\t// get all_params() {\n\t// \t// return lodash_concat(lodash_values(this._params), lodash_values(this._spare_params));\n\t// \treturn lodash_values(this._params);\n\t// }\n\n\tprivate set_with_type<T extends ParamType>(name: string, value: ParamInitValuesTypeMap[T], type: T) {\n\t\tconst param = this.param_with_type(name, type);\n\t\tif (param) {\n\t\t\tparam.set(value as never);\n\t\t} else {\n\t\t\tconsole.warn(`param ${name} not found with type ${type}`);\n\t\t}\n\t}\n\tset_float(name: string, value: ParamInitValuesTypeMap[ParamType.FLOAT]) {\n\t\tthis.set_with_type(name, value, ParamType.FLOAT);\n\t}\n\tset_vector3(name: string, value: ParamInitValuesTypeMap[ParamType.VECTOR3]) {\n\t\tthis.set_with_type(name, value, ParamType.VECTOR3);\n\t}\n\n\thas_param(name: string) {\n\t\treturn this._params_by_name[name] != null;\n\t}\n\thas(name: string) {\n\t\treturn this.has_param(name);\n\t}\n\tget(name: string) {\n\t\treturn this.param(name);\n\t}\n\tparam_with_type<T extends ParamType>(name: string, type: T): ParamConstructorMap[T] | undefined {\n\t\tconst param = this.param(name);\n\t\tif (param && param.type == type) {\n\t\t\treturn param as ParamConstructorMap[T];\n\t\t}\n\t}\n\tget_float(name: string): FloatParam {\n\t\treturn this.param_with_type(name, ParamType.FLOAT) as FloatParam;\n\t}\n\tget_operator_path(name: string): OperatorPathParam {\n\t\treturn this.param_with_type(name, ParamType.OPERATOR_PATH) as OperatorPathParam;\n\t}\n\tvalue(name: string) {\n\t\treturn this.param(name)?.value;\n\t}\n\tvalue_with_type<T extends ParamType>(name: string, type: T): ParamValuesTypeMap[T] {\n\t\treturn this.param_with_type(name, type)?.value as ParamValuesTypeMap[T];\n\t\t// const param = this.param(name);\n\t\t// if (param && param.type() == type) {\n\t\t// \treturn param.value();\n\t\t// }\n\t}\n\tboolean(name: string) {\n\t\treturn this.value_with_type(name, ParamType.BOOLEAN);\n\t}\n\tfloat(name: string) {\n\t\treturn this.value_with_type(name, ParamType.FLOAT);\n\t}\n\tinteger(name: string) {\n\t\treturn this.value_with_type(name, ParamType.INTEGER);\n\t}\n\tstring(name: string) {\n\t\treturn this.value_with_type(name, ParamType.STRING);\n\t}\n\tvector2(name: string) {\n\t\treturn this.value_with_type(name, ParamType.VECTOR2);\n\t}\n\tvector3(name: string) {\n\t\treturn this.value_with_type(name, ParamType.VECTOR3);\n\t}\n\tcolor(name: string) {\n\t\treturn this.value_with_type(name, ParamType.COLOR);\n\t}\n\n\tparam(name: string) {\n\t\tconst p = this._params_by_name[name];\n\t\tif (p != null) {\n\t\t\treturn p;\n\t\t} else {\n\t\t\tconsole.warn(\n\t\t\t\t`tried to access param '${name}' in node ${this.node.full_path()}, but existing params are: ${\n\t\t\t\t\tthis.names\n\t\t\t\t}`\n\t\t\t);\n\t\t\treturn null;\n\t\t}\n\t}\n\t// param_cache_name(param_name: string) {\n\t// \treturn `_param_${param_name}`;\n\t// }\n\n\tdelete_params(param_names: string[]) {\n\t\tfor (let param_name of param_names) {\n\t\t\tthis.delete_param(param_name);\n\t\t}\n\t\tthis._update_caches();\n\t}\n\tdelete_param(param_name: string) {\n\t\tconst param = this._params_by_name[param_name];\n\t\tif (param) {\n\t\t\tif (this._params_node) {\n\t\t\t\tthis._params_node.remove_graph_input(this._params_by_name[param_name]);\n\t\t\t}\n\t\t\tparam.set_node(null);\n\t\t\tdelete this._params_by_name[param_name];\n\t\t\tif (param.is_multiple && param.components) {\n\t\t\t\tfor (let component of param.components) {\n\t\t\t\t\tconst child_name = component.name;\n\t\t\t\t\tdelete this._params_by_name[child_name];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// const name_index = this._param_names.indexOf(param_name)\n\t\t\t// if(name_index >= 0){\n\t\t\t// \tthis._param_names.splice(name_index, 1)\n\t\t\t// }\n\t\t\tparam.emit(ParamEvent.DELETED);\n\t\t} else {\n\t\t\tthrow new Error(`param '${param_name}' does not exist on node ${this.node.full_path()}`);\n\t\t}\n\t}\n\n\tadd_param<T extends ParamType>(\n\t\ttype: T,\n\t\tname: string,\n\t\tinit_value: ParamInitValuesTypeMap[T],\n\t\toptions: ParamOptions = {}\n\t): ParamConstructorMap[T] | undefined {\n\t\tconst is_spare = options['spare'] || false;\n\t\tif (this._param_create_mode === false && !is_spare) {\n\t\t\tconsole.warn(\n\t\t\t\t`node ${this.node.full_path()} (${\n\t\t\t\t\tthis.node.type\n\t\t\t\t}) param '${name}' cannot be created outside of create_params`\n\t\t\t);\n\t\t}\n\t\tif (this.node.scene == null) {\n\t\t\tconsole.warn(`node ${this.node.full_path()} (${this.node.type}) has no scene assigned`);\n\t\t}\n\n\t\tconst constructor = ParamConstructorByType[type];\n\t\tif (constructor != null) {\n\t\t\tconst existing_param = this._params_by_name[name];\n\t\t\tif (existing_param) {\n\t\t\t\tif (is_spare) {\n\t\t\t\t\t// delete the old one, otherwise the gl nodes when saved will attempt to set the value\n\t\t\t\t\t// of a param with the potentially wrong type\n\t\t\t\t\tif (existing_param.type != type) {\n\t\t\t\t\t\tthis.delete_param(existing_param.name);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// check that the param is spare, so that the ones generated by gl nodes are not generating an exception\n\t\t\t\t\tconsole.warn(`a param named ${name} already exists`, this.node);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst param: ParamConstructorMap[T] = new constructor(this.node.scene);\n\t\t\tparam.options.set(options);\n\n\t\t\t// param.set_scene(this.node.scene);\n\t\t\tparam.set_name(name);\n\t\t\tparam.set_init_value(init_value as never);\n\t\t\tparam.init_components();\n\t\t\tparam.set_node(this.node);\n\t\t\t// param.initialize();\n\t\t\t// param.ui_data.set_folder_name(this.current_param_folder_name());\n\n\t\t\tthis._params_by_name[param.name] = param as BaseParamType;\n\t\t\t// this._params_list.push(param);\n\t\t\t// this._param_names[param.name()] = true; //.push(param.name());\n\n\t\t\t// we add the components, so that we can access them with expressions like ch('ty')\n\t\t\tif (param.is_multiple && param.components) {\n\t\t\t\tfor (let component of param.components) {\n\t\t\t\t\tthis._params_by_name[component.name] = component as BaseParamType;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._params_added_since_last_params_eval = true;\n\n\t\t\treturn param;\n\t\t}\n\t}\n\n\tprivate _update_caches() {\n\t\t// _params_list: BaseParam[] = [];\n\t\tthis._params_list = Object.values(this._params_by_name);\n\t\t// _param_names: string[] = [];\n\t\tthis._param_names = Object.keys(this._params_by_name);\n\t\t// _non_spare_params: BaseParam[] = [];\n\t\tthis._non_spare_params = Object.values(this._params_by_name).filter((p) => !p.options.is_spare);\n\t\t// _spare_params: BaseParam[] = [];\n\t\tthis._spare_params = Object.values(this._params_by_name).filter((p) => p.options.is_spare);\n\t\t// _non_spare_param_names: string[] = [];\n\t\tthis._non_spare_param_names = Object.values(this._params_by_name)\n\t\t\t.filter((p) => !p.options.is_spare)\n\t\t\t.map((p) => p.name);\n\t\t// _spare_param_names: string[] = [];\n\t\tthis._spare_param_names = Object.values(this._params_by_name)\n\t\t\t.filter((p) => p.options.is_spare)\n\t\t\t.map((p) => p.name);\n\t\t// delete this._param_names[param_name];\n\n\t\t// // delete from this._params_list\n\t\t// let index = -1;\n\t\t// for (let i = 0; i < this._params_list.length; i++) {\n\t\t// \tif (this._params_list[i].name() == param_name) {\n\t\t// \t\tindex = i;\n\t\t// \t}\n\t\t// }\n\t\t// if (index > -1) {\n\t\t// \tthis._params_list.splice(index, 1);\n\t\t// }\n\t}\n\n\tasync _eval_param(param: BaseParamType) {\n\t\t// return new Promise((resolve, reject)=> {\n\t\t// const param_cache_name = this.param_cache_name(param.name());\n\t\t// const cached_value = this[param_cache_name] || null;\n\t\tif (/*cached_value == null ||*/ param.is_dirty /* || param.is_errored()*/) {\n\t\t\t/*const param_value =*/ await param.compute(); //.then(param_value=>{\n\t\t\t// this[param_cache_name] = param_value;\n\t\t\tif (param.states.error.active) {\n\t\t\t\tthis.node.states.error.set(`param '${param.name}' error: ${param.states.error.message}`);\n\t\t\t}\n\t\t\t// return param_value;\n\t\t} else {\n\t\t\t// return param.value;\n\t\t}\n\t\t// });\n\t}\n\n\tasync eval_params(params: BaseParamType[]) {\n\t\t// let param: BaseParam;\n\t\tconst promises = [];\n\t\tfor (let i = 0; i < params.length; i++) {\n\t\t\tif (params[i].is_dirty) {\n\t\t\t\tpromises.push(this._eval_param(params[i]));\n\t\t\t}\n\t\t}\n\t\t/*const param_values =*/ await Promise.all(promises);\n\n\t\t// const param_eval_keys = [];\n\t\t// let param_value;\n\t\t// for (let i = 0; i < params.length; i++) {\n\t\t// \tparam = params[i];\n\t\t// \tparam_value = param_values[i];\n\t\t// \tconst param_eval_key = param.eval_key(param_value);\n\t\t// \tparam_eval_keys.push(param_eval_key);\n\t\t// }\n\t\tif (this.node.states.error.active) {\n\t\t\tthis.node.set_container(null);\n\t\t}\n\t\t// return param_eval_keys.join('-');\n\t\t// const promises = lodash_map(params, (param, index)=> {\n\t\t// \treturn this.self._eval_param(param).then(param_value => {\n\t\t// \t\tconst param_eval_key = param.eval_key(param_value);\n\t\t// \t\treturn param_eval_keys.push(param_eval_key);\n\t\t// \t})\n\t\t// })\n\n\t\t// return new Promise((resolve, reject)=> {\n\t\t// \treturn Promise.all(promises).then(() => {\n\t\t// \t\tif (this.self.is_errored()) {\n\t\t// \t\t\tthis.self.set_container(null);\n\t\t// \t\t}\n\t\t// \t\t// this._params_node.remove_dirty_state()\n\t\t// \t\treturn resolve(param_eval_keys.join('-'));\n\t\t// \t})\n\t\t// })\n\t}\n\n\t// invalidates_param_results() {\n\t// \t// this.params().forEach((param)=>{ param.invalidates_result() });\n\t// \tlodash_each(this.params(), (param) => param.invalidates_result());\n\t// \t// for(let i=0; i<this._params_list.length; i++){\n\t// \t// \tthis._params_list[i].invalidates_result()\n\t// \t// }\n\t// }\n\n\tasync eval_all() {\n\t\tif (this._params_node) {\n\t\t\tif (this._params_node.is_dirty || this._params_added_since_last_params_eval) {\n\t\t\t\t// const param_names = lodash_values(this.param_names())\n\t\t\t\t// const params = param_names.map(param_name=> this.param(param_name))\n\t\t\t\t//params = lodash_filter params, (param)->!param.has_parent_param()\n\t\t\t\t// if (params.length > 0) {\n\t\t\t\tawait this.eval_params(this._params_list);\n\n\t\t\t\t// this._build_params_eval_key()\n\t\t\t\tthis._params_node.remove_dirty_state();\n\t\t\t\t// }\n\t\t\t\tthis._params_added_since_last_params_eval = false;\n\t\t\t}\n\t\t}\n\t\t// return this._params_eval_key\n\t}\n\n\t//\n\t//\n\t// HOOKS\n\t//\n\t//\n\tset_post_create_params_hook(hook: PostCreateParamsHook) {\n\t\tthis._post_create_params_hook = hook;\n\t}\n\trun_post_create_params_hook() {\n\t\tif (this._post_create_params_hook) {\n\t\t\tthis._post_create_params_hook();\n\t\t}\n\t}\n\tadd_on_scene_load_hook(name: string, method: OnSceneLoadHook) {\n\t\tthis._on_scene_load_hook_names = this._on_scene_load_hook_names || [];\n\t\tthis._on_scene_load_hooks = this._on_scene_load_hooks || [];\n\n\t\tif (!this._on_scene_load_hook_names.includes(name)) {\n\t\t\tthis._on_scene_load_hook_names.push(name);\n\t\t\tthis._on_scene_load_hooks.push(method);\n\t\t} else {\n\t\t\tconsole.warn(`hook with name ${name} already exists`, this._on_scene_load_hook_names);\n\t\t}\n\t}\n\trun_on_scene_load_hooks() {\n\t\tif (this._on_scene_load_hooks) {\n\t\t\tfor (let hook of this._on_scene_load_hooks) {\n\t\t\t\thook();\n\t\t\t}\n\t\t}\n\t}\n\n\t// private _create_params_ui_data_dependencies() {\n\t// \tconst dependent_params = this._params_list.filter((p) => p.options.ui_data_depends_on_other_params());\n\n\t// \tdependent_params.forEach((p) => {\n\t// \t\tp.options.set_ui_data_dependency();\n\t// \t});\n\t// }\n\n\t// within_param_folder(folder_name: string, callback: () => void) {\n\t// \tconst previous_folder_name = this._current_param_folder_name;\n\t// \tthis._current_param_folder_name = folder_name;\n\t// \tcallback();\n\t// \tthis._current_param_folder_name = previous_folder_name;\n\t// }\n\t// current_param_folder_name(): string | undefined {\n\t// \treturn this._current_param_folder_name;\n\t// }\n}\n","import lodash_isNumber from 'lodash/isNumber';\nimport lodash_isBoolean from 'lodash/isBoolean';\n// import lodash_includes from 'lodash/includes'\nimport lodash_isString from 'lodash/isString';\nimport {TypedNumericParam} from './_Numeric';\nimport {ParamType} from '../poly/ParamType';\nimport {CoreString} from 'src/core/String';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n\nexport class BooleanParam extends TypedNumericParam<ParamType.BOOLEAN> {\n\tstatic type() {\n\t\treturn ParamType.BOOLEAN;\n\t}\n\t// TODO: be careful as this does not allow serialization of expressions as default value\n\tget default_value_serialized() {\n\t\tif (lodash_isString(this.default_value)) {\n\t\t\treturn this.default_value;\n\t\t} else {\n\t\t\treturn this.convert(this.default_value) || false;\n\t\t}\n\t}\n\tget raw_input_serialized() {\n\t\treturn this._raw_input;\n\t}\n\tget value_serialized() {\n\t\treturn this.value;\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.BOOLEAN],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.BOOLEAN]\n\t) {\n\t\treturn raw_input1 == raw_input2;\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.BOOLEAN], val2: ParamValuesTypeMap[ParamType.BOOLEAN]) {\n\t\treturn val1 == val2;\n\t}\n\tconvert(raw_val: ParamInitValuesTypeMap[ParamType.BOOLEAN]): boolean | null {\n\t\tif (lodash_isBoolean(raw_val)) {\n\t\t\treturn raw_val;\n\t\t} else {\n\t\t\tif (lodash_isNumber(raw_val)) {\n\t\t\t\treturn raw_val >= 1;\n\t\t\t} else {\n\t\t\t\tif (lodash_isString(raw_val)) {\n\t\t\t\t\tif (CoreString.is_boolean(raw_val)) {\n\t\t\t\t\t\treturn CoreString.to_boolean(raw_val);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (CoreString.is_number(raw_val)) {\n\t\t\t\t\t\t\tconst parsed = parseFloat(raw_val);\n\t\t\t\t\t\t\treturn parsed >= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\t// convert_value(v: ParamInputValue): boolean {\n\t// \treturn this.value_to_boolean(v)\n\t// }\n\t// convert_default_value(v: ParamInputValue): number {\n\t// \tif (lodash_isString(v)) {\n\t// \t\treturn v\n\t// \t} else {\n\t// \t\treturn this.value_to_boolean(v) // ? 1 : 0\n\t// \t}\n\t// }\n\t// is_value_expression(v: ParamInputValue): boolean {\n\t// \treturn !lodash_includes([true, false, 0, 1, '0', '1'], v)\n\t// }\n\n\t// value_to_boolean(v: ParamInputValue): boolean {\n\t// \tif (lodash_isBoolean(v)) {\n\t// \t\treturn v\n\t// \t} else {\n\t// \t\tif (lodash_isNumber(v)) {\n\t// \t\t\treturn v > 0\n\t// \t\t} else {\n\t// \t\t\treturn parseInt(v) > 0\n\t// \t\t}\n\t// \t}\n\t// }\n\n\t// eval(callback) {\n\t// \treturn this.eval_raw((val) => {\n\t// \t\tconst boolean_result = this.value_to_boolean(val)\n\t// \t\treturn callback(boolean_result)\n\t// \t})\n\t// }\n}\n","import {BaseParamType} from 'src/engine/params/_Base';\nimport {ParsedTree} from './traversers/ParsedTree';\n// import {MissingExpressionReference} from './MissingReference'\n// import {MissingReferencesController} from './MissingReferencesController'\n// import CoreWalker from 'src/core/Walker'\n\nimport {FunctionGenerator} from './traversers/FunctionGenerator';\nimport {ExpressionStringGenerator} from './traversers/ExpressionStringGenerator';\nimport {DependenciesController} from './DependenciesController';\nimport {ParamType} from '../poly/ParamType';\n\nexport class ExpressionManager {\n\tpublic parse_completed: boolean = false;\n\tprivate parse_started: boolean = false;\n\tprivate function_generator: FunctionGenerator;\n\tprivate expression_string_generator: ExpressionStringGenerator | undefined;\n\tpublic dependencies_controller: DependenciesController;\n\tprivate _error_message: string | undefined;\n\tprivate parsed_tree: ParsedTree = new ParsedTree();\n\n\tconstructor(\n\t\tpublic param: BaseParamType // public element_index: number=0\n\t) {\n\t\tthis.function_generator = new FunctionGenerator(this.param);\n\t\tthis.dependencies_controller = new DependenciesController(this.param);\n\t}\n\n\tparse_expression(expression: string) {\n\t\tif (this.parse_started) {\n\t\t\tthrow new Error(`parse in progress for param ${this.param.full_path()}`);\n\t\t}\n\t\tthis.parse_started = true;\n\t\tthis.parse_completed = false;\n\t\tthis.parsed_tree = this.parsed_tree || new ParsedTree();\n\n\t\tthis.reset();\n\t\tif (this.param.type == ParamType.STRING) {\n\t\t\tthis.parsed_tree.parse_expression_for_string_param(expression);\n\t\t} else {\n\t\t\tthis.parsed_tree.parse_expression(expression);\n\t\t}\n\t\tthis.function_generator.parse_tree(this.parsed_tree);\n\n\t\tif (this.function_generator.error_message == null) {\n\t\t\tthis.dependencies_controller.update(this.function_generator);\n\t\t\tif (this.dependencies_controller.error_message) {\n\t\t\t\tthis.param.states.error.set(this.dependencies_controller.error_message);\n\t\t\t} else {\n\t\t\t\tthis.parse_completed = true;\n\t\t\t\tthis.parse_started = false;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.set_error(this.function_generator.error_message);\n\t\t}\n\t}\n\tcompute_function(): Promise<any> {\n\t\t// this.parse_and_update_dependencies_if_not_done(expression);\n\t\tif (this.compute_allowed()) {\n\t\t\ttry {\n\t\t\t\treturn this.function_generator.eval_function();\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn('compute_function');\n\t\t\t\tconsole.warn(e);\n\t\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t\t}\n\t\t} else {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tresolve(null);\n\t\t\t});\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.parse_completed = false;\n\t\tthis.parse_started = false;\n\t\tthis._error_message = undefined;\n\t\t// if(force){ // || this.element_index <= 1){\n\t\tthis.dependencies_controller.reset();\n\t\t// }\n\t\tthis.function_generator.reset();\n\t}\n\n\tprotected set_error(message: string) {\n\t\tthis._error_message = this._error_message || message;\n\t}\n\tget is_errored() {\n\t\treturn this._error_message != null;\n\t}\n\tget error_message() {\n\t\treturn this._error_message;\n\t}\n\n\tprivate compute_allowed(): boolean {\n\t\treturn this._error_message == null && this.function_generator.eval_allowed();\n\t}\n\n\t// private parse_and_update_dependencies(expression: string) {\n\t// \tif (this.param.has_expression()) {\n\t// \t\tthis.parse_expression(expression);\n\n\t// \t\tif (this.error_message != null) {\n\t// \t\t\tthis.param.states.error.set(`expression error: \"${expression}\" (${this.error_message})`);\n\t// \t\t}\n\t// \t\t// this.parse_completed = true\n\t// \t}\n\t// }\n\t// private parse_and_update_dependencies_if_not_done(expression: string) {\n\t// \tif (!this.parse_completed) {\n\t// \t\tthis.parse_and_update_dependencies(expression);\n\t// \t}\n\t// }\n\n\tupdate_from_method_dependency_name_change() {\n\t\tthis.expression_string_generator =\n\t\t\tthis.expression_string_generator || new ExpressionStringGenerator(this.param);\n\n\t\tconst new_expression_string = this.expression_string_generator.parse_tree(this.parsed_tree);\n\t\tthis.param.expression_controller?.set_expression(new_expression_string);\n\n\t\t// this.reset()\n\t\tif (new_expression_string) {\n\t\t\tthis.parse_expression(new_expression_string);\n\t\t}\n\t}\n}\n","import {BaseParamType} from 'src/engine/params/_Base';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {ParsedTree} from './ParsedTree';\nimport {LiteralConstructsController, LiteralConstructMethod} from '../LiteralConstructsController';\nimport {BaseMethod} from 'src/engine/expressions/methods/_Base';\nimport {MethodModule} from 'src/engine/expressions/methods/_Module';\nimport {CoreAttribute} from 'src/core/geometry/Attribute';\n// import {JsepsByString} from '../DependenciesController'\n// import {JsepDependency} from '../JsepDependency'\nimport jsep from 'jsep';\n\n// import {Vector3} from 'three/src/math/Vector3'\ntype LiteralConstructDictionary = Dictionary<LiteralConstructMethod>;\ntype AnyDictionary = Dictionary<any>;\n\n// import {ExpressionStringGenerator} from './ExpressionStringGenerator'\n// import CoreWalker from 'src/core/Walker'\n\nconst NATIVE_MATH_METHODS = [\n\t'abs',\n\t'acos',\n\t'asin',\n\t'atan',\n\t'ceil',\n\t'cos',\n\t'exp',\n\t'floor',\n\t'max',\n\t'min',\n\t'pow',\n\t'round',\n\t'sign',\n\t'sin',\n\t'sqrt',\n\t'tan',\n];\nconst NATIVE_MATH_METHODS_RENAMED: AnyDictionary = {\n\tmath_random: 'random',\n};\nconst CORE_MATH_METHODS = ['fit', 'fit01', 'fract', 'deg2rad', 'rad2deg', 'rand', 'clamp'];\nimport {Easing} from 'src/core/math/Easing';\nconst EASING_METHODS = Object.keys(Easing);\n\nconst CORE_STRING_METHODS = ['precision'];\nconst NATIVE_MATH_CONSTANTS = ['PI', 'E'];\n\nconst DIRECT_EXPRESSION_FUNCTIONS: AnyDictionary = {};\nNATIVE_MATH_METHODS.forEach((name) => {\n\tDIRECT_EXPRESSION_FUNCTIONS[name] = `Math.${name}`;\n});\nObject.keys(NATIVE_MATH_METHODS_RENAMED).forEach((name) => {\n\tconst remaped = NATIVE_MATH_METHODS_RENAMED[name];\n\tDIRECT_EXPRESSION_FUNCTIONS[name] = `Math.${remaped}`;\n});\nCORE_MATH_METHODS.forEach((name) => {\n\tDIRECT_EXPRESSION_FUNCTIONS[name] = `POLY.Core.Math.${name}`;\n});\nEASING_METHODS.forEach((name) => {\n\tDIRECT_EXPRESSION_FUNCTIONS[name] = `POLY.Core.Math.Easing.${name}`;\n});\nCORE_STRING_METHODS.forEach((name) => {\n\tDIRECT_EXPRESSION_FUNCTIONS[name] = `POLY.Core.String.${name}`;\n});\n\nconst LITERAL_CONSTRUCT: LiteralConstructDictionary = {\n\tif: LiteralConstructsController.if,\n};\n\nconst GLOBAL_CONSTANTS: Dictionary<string> = {};\nNATIVE_MATH_CONSTANTS.forEach((name) => {\n\tGLOBAL_CONSTANTS[name] = `Math.${name}`;\n});\n\nconst INDIRECT_EXPRESSION_METHODS: AnyDictionary = MethodModule;\n\n// const NODE_TYPE_METHODS = {\n// \tCallExpression: 'setup_graph_call_expression',\n// \tMemberExpression: 'setup_graph_member_expression',\n// \tBinaryExpression: 'setup_graph_binary_expression',\n// \tUnaryExpression: 'setup_graph_unary_expression',\n// \tLogicalExpression: 'setup_graph_logical_expression',\n// \tLiteral: 'setup_graph_literal',\n// \tIdentifier: 'setup_graph_identifier'\n// };\n//\n\n// const IDENTIFIER_METHODS = {\n// \t'$F': '_setup_graph_identifier_as_global_frame'\n// }\nconst QUOTE = \"'\";\nconst ARGUMENTS_SEPARATOR = ', ';\nconst ATTRIBUTE_PREFIX = '@';\nimport {VARIABLE_PREFIX} from './_Base';\n\nconst PROPERTY_OFFSETS: AnyDictionary = {\n\tx: 0,\n\ty: 1,\n\tz: 2,\n\tw: 3,\n\tr: 0,\n\tg: 1,\n\tb: 2,\n};\n\n// export interface MethodsByName {\n// \t[propName: string]: BaseMethod;\n// }\n\nimport {BaseTraverser} from './_Base';\nimport {MethodDependency} from '../MethodDependency';\nimport {AttributeRequirementsController} from '../AttributeRequirementsController';\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncFunction\nconst AsyncFunction = Object.getPrototypeOf(async function() {}).constructor;\n\nexport class FunctionGenerator extends BaseTraverser {\n\tprivate function: Function | undefined;\n\t// private function_pre_entities_loop_lines: string[] = [];\n\tprivate _attribute_requirements_controller = new AttributeRequirementsController();\n\t// private function_pre_body:string\n\tprivate function_main_string: string | undefined;\n\terror_message: string | undefined;\n\tprivate methods: BaseMethod[] = [];\n\tprivate method_index: number = 0;\n\n\tpublic method_dependencies: MethodDependency[] = [];\n\tpublic immutable_dependencies: CoreGraphNode[] = [];\n\t// public jsep_dependencies: JsepDependency[] = []\n\t// public jsep_nodes_by_missing_paths: JsepsByString = {}\n\n\t// private string_generator: ExpressionStringGenerator = new ExpressionStringGenerator()\n\n\tconstructor(public param: BaseParamType) {\n\t\tsuper(param);\n\t}\n\n\tpublic parse_tree(parsed_tree: ParsedTree) {\n\t\tthis.reset();\n\n\t\tif (parsed_tree.error_message == null) {\n\t\t\ttry {\n\t\t\t\t// this.function_pre_entities_loop_lines = [];\n\t\t\t\tthis._attribute_requirements_controller.reset();\n\t\t\t\t// this.function_pre_body = ''\n\t\t\t\tif (parsed_tree.node) {\n\t\t\t\t\tconst function_main_string = this.traverse_node(parsed_tree.node);\n\t\t\t\t\tif (function_main_string && this.error_message == null) {\n\t\t\t\t\t\tthis.function_main_string = function_main_string;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn('no parsed_tree.node');\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn(`error in expression for param ${this.param.full_path()}`);\n\t\t\t\tconsole.warn(e);\n\t\t\t}\n\n\t\t\tif (this.function_main_string) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.function = new AsyncFunction(\n\t\t\t\t\t\t'param',\n\t\t\t\t\t\t'methods',\n\t\t\t\t\t\t`\n\t\t\t\t\ttry {\n\t\t\t\t\t\t${this.function_body()}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tparam.states.error.set(e.message || e);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}`\n\t\t\t\t\t);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t\tthis.set_error('cannot generate function');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.set_error('cannot generate function body');\n\t\t\t}\n\t\t} else {\n\t\t\tthis.set_error('cannot parse expression');\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.error_message = undefined;\n\t\tthis.function_main_string = undefined;\n\t\tthis.methods = [];\n\t\tthis.method_index = 0;\n\t\tthis.function = undefined;\n\t\tthis.method_dependencies = [];\n\t\tthis.immutable_dependencies = [];\n\t}\n\n\tfunction_body() {\n\t\tif (this.param.options.is_expression_for_entities) {\n\t\t\treturn `\n\t\t\tconst entities = param.expression_controller.entities;\n\t\t\tif(entities){\n\t\t\t\treturn new Promise( async (resolve, reject)=>{\n\t\t\t\t\tlet entity;\n\t\t\t\t\tconst entity_callback = param.expression_controller.entity_callback;\n\t\t\t\t\t${this._attribute_requirements_controller.assign_attributes_lines()}\n\t\t\t\t\tif( ${this._attribute_requirements_controller.attribute_presence_check_line()} ){\n\t\t\t\t\t\t${this._attribute_requirements_controller.assign_arrays_lines()}\n\t\t\t\t\t\tfor(let index=0; index < entities.length; index++){\n\t\t\t\t\t\t\tentity = entities[index];\n\t\t\t\t\t\t\tresult = ${this.function_main_string};\n\t\t\t\t\t\t\tentity_callback(entity, result);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve()\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(new Error('attribute not found'))\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn []`;\n\t\t} else {\n\t\t\treturn `\n\t\t\treturn new Promise( async (resolve, reject)=>{\n\t\t\t\tresolve(${this.function_main_string})\n\t\t\t})\n\t\t\t`;\n\t\t}\n\t}\n\n\teval_allowed(): boolean {\n\t\treturn this.function != null;\n\t}\n\teval_function() {\n\t\t// this.param.entity_attrib_values = this.param.entity_attrib_values || {}\n\t\t// this.param.entity_attrib_values.position =\n\t\t// \tthis.param.entity_attrib_values.position || new THREE.Vector3()\n\t\tif (this.function) {\n\t\t\tconst result = this.function(this.param, this.methods);\n\t\t\treturn result;\n\t\t}\n\t}\n\n\t//\n\t//\n\t// TRAVERSE METHODS\n\t//\n\t//\n\tprotected traverse_CallExpression(node: jsep.CallExpression): string | undefined {\n\t\tconst method_arguments = node.arguments.map((arg) => {\n\t\t\treturn this.traverse_node(arg);\n\t\t});\n\t\tconst callee = node.callee as jsep.Identifier;\n\t\tconst method_name = callee.name;\n\t\tif (method_name) {\n\t\t\t// literal construct (if...)\n\t\t\tconst literal_contruct = LITERAL_CONSTRUCT[method_name];\n\t\t\tif (literal_contruct) {\n\t\t\t\treturn literal_contruct(method_arguments);\n\t\t\t}\n\n\t\t\t// direct expressions (Math.floor, Math.sin...)\n\t\t\tconst arguments_joined = `${method_arguments.join(ARGUMENTS_SEPARATOR)}`;\n\t\t\tconst direct_function_name = DIRECT_EXPRESSION_FUNCTIONS[method_name];\n\t\t\tif (direct_function_name) {\n\t\t\t\treturn `${direct_function_name}(${arguments_joined})`;\n\t\t\t}\n\n\t\t\t// indirect methods (points_count, asset...)\n\t\t\tconst indirect_method = INDIRECT_EXPRESSION_METHODS[method_name];\n\t\t\tif (indirect_method) {\n\t\t\t\tconst path_node = node.arguments[0];\n\t\t\t\t// const path_argument = this.string_generator.traverse_node(path_node)\n\t\t\t\tconst function_string = `return ${method_arguments[0]}`;\n\t\t\t\tlet path_argument_function;\n\t\t\t\tlet path_argument = [];\n\t\t\t\ttry {\n\t\t\t\t\tpath_argument_function = new Function(function_string);\n\t\t\t\t\tpath_argument = path_argument_function();\n\t\t\t\t} catch {\n\t\t\t\t\t// path_argument_function = new AsyncFunction(function_string)\n\t\t\t\t\t// it looks like if the input contains an await,\n\t\t\t\t\t// it is because it has been generated by another indirect function.\n\t\t\t\t\t// This means that the dependencies have been generated already\n\t\t\t\t\t// so we may not need to do it now\n\t\t\t\t}\n\n\t\t\t\tthis._create_method_and_dependencies(method_name, path_argument, path_node);\n\t\t\t\treturn `(await methods[${this.method_index}].process_arguments([${arguments_joined}]))`;\n\t\t\t}\n\t\t}\n\n\t\tthis.set_error(`unknown method: ${method_name}`);\n\t}\n\tprotected traverse_BinaryExpression(node: jsep.BinaryExpression): string {\n\t\t// if(node.right.type == 'Identifier'){\n\t\t// \tthis.set_error(`cannot have identifier after ${node.operator}`)\n\t\t// \treturn \"\"\n\t\t// }\n\t\treturn `(${this.traverse_node(node.left)} ${node.operator} ${this.traverse_node(node.right)})`;\n\t}\n\tprotected traverse_LogicalExpression(node: jsep.LogicalExpression): string {\n\t\t// || or &&\n\t\t// if(node.right.type == 'Identifier'){\n\t\t// \tthis.set_error(`cannot have identifier after ${node.operator}`)\n\t\t// \treturn \"\"\n\t\t// }\n\t\treturn `(${this.traverse_node(node.left)} ${node.operator} ${this.traverse_node(node.right)})`;\n\t}\n\tprotected traverse_MemberExpression(node: jsep.MemberExpression): string {\n\t\treturn `${this.traverse_node(node.object)}.${this.traverse_node(node.property)}`;\n\t}\n\tprotected traverse_UnaryExpression(node: jsep.UnaryExpression): string {\n\t\tif (node.operator === ATTRIBUTE_PREFIX) {\n\t\t\tlet argument = node.argument;\n\t\t\tlet attribute_name;\n\t\t\tlet property;\n\t\t\tswitch (argument.type) {\n\t\t\t\tcase 'Identifier': {\n\t\t\t\t\tconst argument_identifier = (<unknown>argument) as jsep.Identifier;\n\t\t\t\t\tattribute_name = argument_identifier.name;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'MemberExpression': {\n\t\t\t\t\tconst argument_member_expression = (<unknown>argument) as jsep.MemberExpression;\n\t\t\t\t\tconst attrib_node = argument_member_expression.object as jsep.Identifier;\n\t\t\t\t\tconst property_node = argument_member_expression.property as jsep.Identifier;\n\t\t\t\t\tattribute_name = attrib_node.name;\n\t\t\t\t\tproperty = property_node.name;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// this.function_pre_body += `\n\t\t\t// param.entity_attrib_value(${QUOTE}${attrib_node.name}${QUOTE}, param.entity_attrib_values.position);\n\t\t\t// `\n\t\t\tif (attribute_name) {\n\t\t\t\tattribute_name = CoreAttribute.remap_name(attribute_name);\n\t\t\t\tif (attribute_name == 'ptnum') {\n\t\t\t\t\treturn '((entity != null) ? entity.index : 0)';\n\t\t\t\t} else {\n\t\t\t\t\tconst var_attribute_size = this._attribute_requirements_controller.var_attribute_size(\n\t\t\t\t\t\tattribute_name\n\t\t\t\t\t);\n\t\t\t\t\tconst var_array = this._attribute_requirements_controller.var_array(attribute_name);\n\t\t\t\t\tthis._attribute_requirements_controller.add(attribute_name);\n\t\t\t\t\tif (property) {\n\t\t\t\t\t\tconst property_offset = PROPERTY_OFFSETS[property];\n\t\t\t\t\t\treturn `${var_array}[entity.index*${var_attribute_size}+${property_offset}]`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn `${var_array}[entity.index*${var_attribute_size}]`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.warn('attribute not found');\n\t\t\t\treturn '';\n\t\t\t}\n\t\t} else {\n\t\t\treturn `${node.operator}${this.traverse_node(node.argument)}`; // -5\n\t\t}\n\t}\n\n\tprotected traverse_Literal(node: jsep.Literal): string {\n\t\treturn `${node.raw}`; // 5 or 'string' (raw will include quotes)\n\t}\n\n\tprotected traverse_Identifier(node: jsep.Identifier): string | undefined {\n\t\tconst identifier_first_char = node.name[0];\n\t\tif (identifier_first_char == VARIABLE_PREFIX) {\n\t\t\tconst identifier_name_without_dollar_sign = node.name.substr(1);\n\n\t\t\t// globals constants: Math.PI or Math.E\n\t\t\tconst direct_constant_name = GLOBAL_CONSTANTS[identifier_name_without_dollar_sign];\n\t\t\tif (direct_constant_name) {\n\t\t\t\treturn direct_constant_name;\n\t\t\t}\n\n\t\t\t// scene or node globals: $F, $FPS, $T, $CH, $OS\n\t\t\tconst method_name = `traverse_Identifier_${identifier_name_without_dollar_sign}`;\n\t\t\tconst method = (this as any)[method_name];\n\t\t\tif (method) {\n\t\t\t\treturn (this as any)[method_name]();\n\t\t\t} else {\n\t\t\t\tthis.set_error(`identifier unknown: ${node.name}`);\n\t\t\t}\n\t\t} else {\n\t\t\treturn node.name; // @ptnum will call this method and return \"ptnum\"\n\t\t}\n\t}\n\n\t//\n\t//\n\t// Identifier methods (called from Identifier_body)\n\t//\n\t//\n\tprotected traverse_Identifier_F(): string {\n\t\tthis.immutable_dependencies.push(this.param.scene.time_controller.graph_node);\n\t\treturn `param.scene.time_controller.frame`;\n\t}\n\tprotected traverse_Identifier_FPS(): string {\n\t\tthis.immutable_dependencies.push(this.param.scene.time_controller.graph_node);\n\t\treturn `param.scene.time_controller.fps`;\n\t}\n\tprotected traverse_Identifier_T(): string {\n\t\tthis.immutable_dependencies.push(this.param.scene.time_controller.graph_node);\n\t\treturn `param.scene.time_controller.time`;\n\t}\n\tprotected traverse_Identifier_CH(): string {\n\t\treturn `${QUOTE}${this.param.name}${QUOTE}`;\n\t}\n\tprotected traverse_Identifier_CEX(): string {\n\t\treturn this._method_centroid('x');\n\t}\n\tprotected traverse_Identifier_CEY(): string {\n\t\treturn this._method_centroid('y');\n\t}\n\tprotected traverse_Identifier_CEZ(): string {\n\t\treturn this._method_centroid('z');\n\t}\n\t// TODO:\n\t// '$OS': '_eval_identifier_as_node_name',\n\t// '$BBX': '_eval_identifier_as_bounding_box_relative',\n\n\tprivate _method_centroid(component: string): string {\n\t\tconst method_arguments = [0, `${QUOTE}${component}${QUOTE}`];\n\t\tconst arguments_joined = method_arguments.join(ARGUMENTS_SEPARATOR);\n\t\tthis._create_method_and_dependencies('centroid', 0);\n\t\treturn `(await methods[${this.method_index}].process_arguments([${arguments_joined}]))`;\n\t}\n\n\t//\n\t//\n\t// Methods dependencies\n\t//\n\t//\n\tprivate _create_method_and_dependencies(\n\t\tmethod_name: string,\n\t\tpath_argument: number | string,\n\t\tpath_node?: jsep.Expression\n\t) {\n\t\tconst method_constructor = INDIRECT_EXPRESSION_METHODS[method_name];\n\t\tconst method = new method_constructor(this.param) as BaseMethod;\n\t\tthis.method_index += 1;\n\t\tthis.methods[this.method_index] = method;\n\n\t\tconst method_dependency = method.find_dependency(path_argument);\n\t\tif (method_dependency) {\n\t\t\tif (path_node) {\n\t\t\t\tmethod_dependency.set_jsep_node(path_node);\n\t\t\t}\n\t\t\tthis.method_dependencies.push(method_dependency);\n\t\t}\n\t\t// method_dependencies.resolved_graph_nodes.forEach((graph_node)=>{\n\t\t// \tif(path_node){\n\t\t// \t\tconst jsep_dependency = new JsepDependency(graph_node, path_node)\n\t\t// \t\tthis.jsep_dependencies.push(jsep_dependency)\n\t\t// \t} else {\n\t\t// \t\tthis.immutable_dependencies.push(graph_node)\n\t\t// \t}\n\n\t\t// })\n\n\t\t// if(path_node){\n\t\t// \treference_search_result.missing_paths.forEach((path)=>{\n\t\t// \t\tthis.jsep_nodes_by_missing_paths[path] = this.jsep_nodes_by_missing_paths[path] || []\n\t\t// \t\tthis.jsep_nodes_by_missing_paths[path].push(path_node)\n\t\t// \t})\n\t\t// }\n\t}\n}\n","export type LiteralConstructMethod = (args: any[]) => string\n\nexport class LiteralConstructsController {\n\tstatic if(args: any[]): string {\n\t\tconst condition = args[0]\n\t\tconst val_true = args[1]\n\t\tconst val_false = args[2]\n\t\treturn `(${condition}) ? (${val_true}) : (${val_false})`\n\t}\n}\n","// TODO: create an expression object that knows how many args it can accept, their type\n// and can throw an error and give it to the param, and then to the node\n// TODO: the expression should know how to update the node dependencies\n\n// import abs from './abs'\n// import {Asset} from './asset'\nimport {Bbox} from './bbox';\n// import ceil from './ceil'\nimport {Centroid} from './centroid';\nimport {Ch} from './ch';\nimport {Copy} from './copy';\nimport {CopRes} from './cop_res';\n// import clamp from './clamp'\n// import {Easein} from './easein'\n// import {Easeinout} from './easeinout'\n// import floor from './floor'\n// import humanize from './humanize'\nimport {Local} from './local';\n// import if_ from './if'\n// import max from './max'\n// import min from './min'\nimport {Opdigits} from './opdigits';\n// import object from './object'\n// import objects_count from './objects_count'\n// import objects_visible_count from './objects_visible_count'\nimport {Point} from './point';\nimport {PointsCount} from './points_count';\n// import {Precision} from './precision'\n// import rand from './rand'\n// import round from './round'\n// import sign from './sign'\nimport {StrCharsCount} from './str_chars_count';\nimport {StrConcat} from './str_concat';\nimport {StrIndex} from './str_index';\nimport {StrSub} from './str_sub';\n\nexport const MethodModule = {\n\t// 'asset': Asset,\n\tbbox: Bbox,\n\tch: Ch,\n\tcentroid: Centroid,\n\tcop_res: CopRes,\n\tlocal: Local,\n\topdigits: Opdigits,\n\tpoint: Point,\n\tpoints_count: PointsCount,\n\t// 'precision': Precision,\n\tcopy: Copy,\n\tstr_chars_count: StrCharsCount,\n\tstr_concat: StrConcat,\n\tstr_index: StrIndex,\n\tstr_sub: StrSub,\n};\n\n// import cos from './cos'\n// import sin from './sin'\n","import {BaseMethod} from './_Base';\nimport {MethodDependency} from '../MethodDependency';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {GeometryContainer} from 'src/engine/containers/Geometry';\n\n// import Walker from 'src/core/Walker';\n\ninterface BoxComponents {\n\tmin: Vector3;\n\tmax: Vector3;\n\tsize: Vector3;\n\tcenter: Vector3;\n}\n\nconst VECTOR_NAMES: Array<keyof BoxComponents> = ['min', 'max', 'size', 'center'];\nconst COMPONENT_NAMES = ['x', 'y', 'z'];\n\nexport class Bbox extends BaseMethod {\n\t// bbox(0).min.x\n\t// bbox('../REF_bbox').min.x\n\tstatic required_arguments() {\n\t\treturn [\n\t\t\t['string', 'path to node'],\n\t\t\t['string', 'vector name, min, max, size or center'],\n\t\t\t['string', 'component_name, x,y or z'],\n\t\t];\n\t}\n\n\tfind_dependency(index_or_path: number | string): MethodDependency | null {\n\t\treturn this.create_dependency_from_index_or_path(index_or_path);\n\t}\n\n\tprocess_arguments(args: any[]): Promise<any> {\n\t\tlet value = 0;\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tif (args.length == 3) {\n\t\t\t\tconst index_or_path = args[0];\n\t\t\t\tconst vector_name = args[1];\n\t\t\t\tconst component_name = args[2];\n\n\t\t\t\tlet container: GeometryContainer | null = null;\n\t\t\t\ttry {\n\t\t\t\t\tcontainer = (await this.get_referenced_node_container(index_or_path)) as GeometryContainer;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treject(e);\n\t\t\t\t}\n\t\t\t\tif (container) {\n\t\t\t\t\tvalue = this._get_value_from_container(container, vector_name, component_name);\n\t\t\t\t\tresolve(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(0);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _get_value_from_container(\n\t\tcontainer: GeometryContainer,\n\t\tvector_name: keyof BoxComponents,\n\t\tcomponent_name: keyof Vector3Like\n\t) {\n\t\tif (VECTOR_NAMES.indexOf(vector_name) >= 0) {\n\t\t\tconst bbox = container.bounding_box();\n\n\t\t\tlet vector = new Vector3();\n\t\t\tswitch (vector_name) {\n\t\t\t\tcase 'size':\n\t\t\t\t\tbbox.getSize(vector);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'center':\n\t\t\t\t\tbbox.getCenter(vector);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvector = bbox[vector_name];\n\t\t\t}\n\n\t\t\tif (COMPONENT_NAMES.indexOf(component_name) >= 0) {\n\t\t\t\t//(value = vector[component_name])?\n\t\t\t\treturn vector[component_name];\n\t\t\t} else {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n}\n","import lodash_isNumber from 'lodash/isNumber';\n// import BaseNode from 'src/engine/nodes/_Base'\nimport {DecomposedPath} from 'src/core/DecomposedPath';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {CoreObject} from 'src/core/Object';\nimport {BaseNodeType, BaseNodeClass, TypedNode} from 'src/engine/nodes/_Base';\nimport jsep from 'jsep';\n\ntype NodeOrParam = BaseNodeType | BaseParamType;\n\nexport class MethodDependency extends CoreGraphNode {\n\tpublic jsep_node: jsep.Expression | undefined;\n\tpublic resolved_graph_node: CoreGraphNode | undefined;\n\tpublic unresolved_path: string | undefined;\n\tprivate _update_from_name_change_bound = this._update_from_name_change.bind(this);\n\n\tconstructor(\n\t\tpublic param: BaseParamType,\n\t\tpublic path_argument: number | string,\n\t\tpublic decomposed_path?: DecomposedPath\n\t) {\n\t\tsuper(param.scene, 'MethodDependency');\n\n\t\t// this.set_scene(this.param.scene);\n\n\t\tthis.add_post_dirty_hook('_update_from_name_change', this._update_from_name_change_bound);\n\t}\n\t_update_from_name_change(trigger?: CoreGraphNode) {\n\t\tif (CoreObject.is_a(trigger, TypedNode) && this.decomposed_path) {\n\t\t\tconst node = trigger as BaseNodeType;\n\t\t\tthis.decomposed_path.update_from_name_change(node);\n\t\t\tconst new_path = this.decomposed_path.to_path();\n\n\t\t\tconst literal = this.jsep_node as jsep.Literal;\n\t\t\tif (literal) {\n\t\t\t\tliteral.value = `${literal.value}`.replace(`${this.path_argument}`, new_path);\n\t\t\t\tliteral.raw = literal.raw.replace(`${this.path_argument}`, new_path);\n\t\t\t}\n\t\t\tif (this.param.expression_controller) {\n\t\t\t\tthis.param.expression_controller.update_from_method_dependency_name_change();\n\t\t\t}\n\t\t}\n\t}\n\treset() {\n\t\tthis.graph_disconnect_predecessors();\n\t}\n\n\tlisten_for_name_changes() {\n\t\tif (this.jsep_node && this.decomposed_path) {\n\t\t\tthis.decomposed_path.named_nodes.forEach((node_in_path) => {\n\t\t\t\tif (node_in_path && node_in_path instanceof BaseNodeClass) {\n\t\t\t\t\tthis.add_graph_input(node_in_path.name_controller.graph_node);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tset_jsep_node(jsep_node: jsep.Expression) {\n\t\tthis.jsep_node = jsep_node;\n\t}\n\tset_resolved_graph_node(node: CoreGraphNode) {\n\t\tthis.resolved_graph_node = node;\n\t}\n\tset_unresolved_path(path: string) {\n\t\tthis.unresolved_path = path;\n\t}\n\n\tstatic create(\n\t\tparam: BaseParamType,\n\t\tindex_or_path: number | string,\n\t\tnode: CoreGraphNode,\n\t\tnodes_in_path?: NodeOrParam[]\n\t) {\n\t\tconst is_index = lodash_isNumber(index_or_path);\n\n\t\tlet decomposed_path: DecomposedPath | undefined = undefined;\n\t\tif (nodes_in_path) {\n\t\t\tdecomposed_path = new DecomposedPath();\n\t\t\tfor (let node_in_path of nodes_in_path) {\n\t\t\t\tdecomposed_path.add_node(node_in_path.name, node_in_path);\n\t\t\t}\n\t\t}\n\n\t\tconst instance = new MethodDependency(param, index_or_path, decomposed_path);\n\t\tif (node) {\n\t\t\tinstance.set_resolved_graph_node(node);\n\t\t} else {\n\t\t\tif (!is_index) {\n\t\t\t\tconst path = index_or_path as string;\n\t\t\t\tinstance.set_unresolved_path(path);\n\t\t\t}\n\t\t}\n\t\treturn instance;\n\t}\n}\n","import {BaseMethod} from './_Base';\nimport {MethodDependency} from '../MethodDependency';\n// import Walker from 'src/core/Walker';\nimport {GeometryContainer} from 'src/engine/containers/Geometry';\n\nexport class Centroid extends BaseMethod {\n\t// bbox(0).min.x\n\t// bbox('../REF_bbox').min.x\n\tstatic required_arguments() {\n\t\treturn [\n\t\t\t['string', 'path to node'],\n\t\t\t['string', 'component_name, x,y or z'],\n\t\t];\n\t}\n\n\tfind_dependency(index_or_path: number | string): MethodDependency | null {\n\t\treturn this.create_dependency_from_index_or_path(index_or_path);\n\t}\n\n\tprocess_arguments(args: any[]): Promise<any> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\t// const path = args\n\t\t\t// this.get_referenced_param(path).eval_p().then(val=>{\n\t\t\t// \tresolve(val)\n\t\t\t// })\n\t\t\tif (args.length == 2) {\n\t\t\t\tconst index_or_path = args[0];\n\t\t\t\tconst component_name = args[1] as keyof Vector3Like;\n\t\t\t\tlet container: GeometryContainer | null = null;\n\t\t\t\ttry {\n\t\t\t\t\tcontainer = (await this.get_referenced_node_container(index_or_path)) as GeometryContainer;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treject(e);\n\t\t\t\t}\n\n\t\t\t\tif (container) {\n\t\t\t\t\tconst bbox = container.bounding_box();\n\t\t\t\t\tconst center = bbox.min\n\t\t\t\t\t\t.clone()\n\t\t\t\t\t\t.add(bbox.max)\n\t\t\t\t\t\t.multiplyScalar(0.5);\n\n\t\t\t\t\tconst value = center[component_name];\n\t\t\t\t\tif (value != null) {\n\t\t\t\t\t\tresolve(value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// throw \"only component names are x, y and z\";\n\t\t\t\t\t\tresolve(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(0);\n\t\t\t}\n\t\t});\n\t\t// return this._get_param_value(args[0], args[1], callback);\n\t}\n\n\t// _get_param_value(index_or_path, component_name, callback){\n\t// \treturn this.get_referenced_node_container(index_or_path, container=> {\n\t// \t\tlet value;\n\t// \t\tconst bbox = container.bounding_box();\n\t// \t\tconst size = bbox.min.clone().add(bbox.max).multiplyScalar(0.5);\n\n\t// \t\tif ((value = size[component_name]) != null) {\n\t// \t\t\treturn callback(value);\n\t// \t\t} else {\n\t// \t\t\tthrow \"only component names are x, y and z\";\n\t// \t\t}\n\t// \t});\n\t// }\n}\n","// import lodash_isNumber from 'lodash/isNumber';\n\nimport {BaseMethod} from './_Base';\nimport {DecomposedPath} from 'src/core/DecomposedPath';\nimport {MethodDependency} from '../MethodDependency';\n// import Walker from 'src/core/Walker';\n\nexport class Ch extends BaseMethod {\n\t// constructor() {\n\t// \tsuper();\n\t// }\n\n\tstatic required_arguments() {\n\t\treturn [['string', 'path to param']];\n\t}\n\n\t// dependencies(args: any[]): any[]{\n\t// \tconst path = args[0]\n\t// \treturn [this.get_referenced_param(path)]\n\t// }\n\tfind_dependency(index_or_path: number | string): MethodDependency | null {\n\t\tconst decomposed_path = new DecomposedPath();\n\t\tconst param = this.get_referenced_param(index_or_path as string, decomposed_path);\n\t\tif (param) {\n\t\t\treturn this.create_dependency(param, index_or_path, decomposed_path);\n\t\t}\n\t\treturn null;\n\t\t// const reference_search_result = new ReferenceSearchResult()\n\t\t// const param = this.get_referenced_param(index_or_path)\n\t\t// if(param){\n\t\t// \treference_search_result.set_found_graph_nodes([param])\n\t\t// } else {\n\t\t// \treference_search_result.set_missing_paths([path])\n\t\t// }\n\n\t\t// return reference_search_result\n\t}\n\t// find_dependencies(index_or_path: number|string): MethodDependency{\n\t// }\n\n\tasync process_arguments(args: any[]): Promise<any> {\n\t\tlet val: any = 0;\n\t\tif (args.length == 1) {\n\t\t\tconst path = args[0];\n\t\t\tconst ref = this.get_referenced_param(path);\n\t\t\tif (ref) {\n\t\t\t\tawait ref.compute();\n\t\t\t\tconst result = ref.value;\n\t\t\t\tif (result != null) {\n\t\t\t\t\t// if (lodash_isNumber(result)) {\n\t\t\t\t\tval = result;\n\t\t\t\t\t// }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn val;\n\t}\n\n\t// _get_param_value(path, callback){\n\t// \treturn this.get_referenced_param(path).eval(val=> {\n\t// \t\treturn callback(val);\n\t// \t});\n\t// }\n}\n","import {BaseMethod} from './_Base';\nimport {MethodDependency} from '../MethodDependency';\nimport {CoreWalker} from 'src/core/Walker';\nimport {CopySopNode} from 'src/engine/nodes/sop/Copy';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class Copy extends BaseMethod {\n\tstatic required_arguments() {\n\t\treturn [\n\t\t\t['string', 'path to copy'],\n\t\t\t['integer', 'default value'],\n\t\t];\n\t}\n\tstatic optional_arguments() {\n\t\treturn [['string', 'attribute name (optional)']];\n\t}\n\n\tfind_dependency(index_or_path: number | string): MethodDependency | null {\n\t\tconst node = this.find_referenced_graph_node(index_or_path) as BaseNodeType;\n\t\t// I'd prefer testing with if(node instanceof CopySopNode)\n\t\t// but tslib generates an error when doing so\n\t\tif (node && node.type == 'copy') {\n\t\t\tconst stamp_node = (node as CopySopNode).stamp_node;\n\t\t\treturn this.create_dependency(stamp_node, index_or_path);\n\t\t}\n\t\treturn null;\n\t}\n\t// find_dependencies(index_or_path: number|string): ReferenceSearchResult{\n\t// \t// return this.find_node_dependency_from_index_or_path(index_or_path)\n\t// \tconst node = this.find_dependency_from_index_or_path(index_or_path)\n\t// \treturn this.create_search_result(stamp_node, index_or_path)\n\t// }\n\n\tprocess_arguments(args: any[]): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (args.length == 2 || args.length == 3) {\n\t\t\t\tconst path = args[0];\n\t\t\t\tconst default_value = args[1];\n\t\t\t\tconst attribute_name = args[2];\n\n\t\t\t\tconst node = CoreWalker.find_node(this.node, path);\n\n\t\t\t\tlet value;\n\t\t\t\tif (node && node.type == 'copy') {\n\t\t\t\t\tvalue = (node as CopySopNode).stamp_value(attribute_name);\n\t\t\t\t}\n\t\t\t\t// if (node && node instanceof CopySopNode) {\n\t\t\t\t// \tvalue = node.stamp_value(attribute_name);\n\t\t\t\t// }\n\n\t\t\t\tif (value == null) {\n\t\t\t\t\tvalue = default_value;\n\t\t\t\t}\n\t\t\t\tresolve(value);\n\t\t\t} else {\n\t\t\t\tresolve(0);\n\t\t\t}\n\t\t});\n\t}\n\t// update_dependencies() {\n\t// \treturn this.jsep_node()._graph_node.add_graph_input( this.copy_sop.stamp_node() );\n\t// }\n\n\t// process_arguments(args, callback){\n\t// \tconst path = args[0];\n\t// \tconst default_value = args[1];\n\t// \tconst attribute_name = args[2];\n\n\t// \tthis.copy_sop = Walker.find_node(this.node(), path);\n\t// \tlet value = (this.copy_sop != null) ?\n\t// \t\tthis.copy_sop.stamp_value(attribute_name) : undefined;\n\n\t// \tif (value == null) { value = default_value; }\n\n\t// \treturn callback(value);\n\t// }\n}\n","import {BaseMethod} from './_Base';\nimport {MethodDependency} from '../MethodDependency';\nimport {TextureContainer} from 'src/engine/containers/Texture';\n\nexport class CopRes extends BaseMethod {\n\t// cop_res(0, 'x')\n\t// cop_res('../REF_bbox', 'x')\n\tstatic required_arguments() {\n\t\treturn [\n\t\t\t['string', 'path to node'],\n\t\t\t['string', 'component_name: x or y'],\n\t\t];\n\t}\n\n\tfind_dependency(index_or_path: number | string): MethodDependency | null {\n\t\treturn this.create_dependency_from_index_or_path(index_or_path);\n\t}\n\n\tasync process_arguments(args: any[]): Promise<number> {\n\t\tlet value = 0;\n\t\tif (args.length == 2) {\n\t\t\tconst index_or_path = args[0];\n\t\t\tconst component_name = args[1];\n\t\t\tconst container = (await this.get_referenced_node_container(index_or_path)) as TextureContainer;\n\n\t\t\tif (container) {\n\t\t\t\tconst resolution = container.resolution();\n\t\t\t\tif ([0, '0', 'x'].includes(component_name)) {\n\t\t\t\t\tvalue = resolution[0];\n\t\t\t\t} else {\n\t\t\t\t\tif ([1, '1', 'y'].includes(component_name)) {\n\t\t\t\t\t\tvalue = resolution[1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n}\n","import {BaseMethod} from './_Base';\nimport {POLY} from 'src/engine/Poly';\n\nexport class Local extends BaseMethod {\n\t// constructor() {\n\t// \tsuper();\n\t// }\n\n\tstatic required_arguments() {\n\t\treturn [['string', 'path']];\n\t}\n\n\tprocess_arguments(args: any[]): Promise<string> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.request_asset_url(args[0]).then((url) => {\n\t\t\t\tresolve(url);\n\t\t\t});\n\t\t});\n\t}\n\t// find_dependency(index_or_path: number | string): MethodDependency {\n\t// \treturn null\n\t// }\n\n\t// TODO: add error management\n\trequest_asset_url(name: string): Promise<string> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// const scene = this.node.scene()\n\t\t\t// const scene_uuid = scene.uuid();\n\n\t\t\tlet url;\n\n\t\t\tif (POLY.desktop_controller().active()) {\n\t\t\t\tPOLY.desktop_controller().add_local_path(name, this.param);\n\t\t\t\turl = POLY.desktop_controller().local_path_server_url(name);\n\t\t\t\tresolve(url);\n\t\t\t} else {\n\t\t\t\treturn resolve('');\n\t\t\t}\n\t\t});\n\t}\n}\n","import {BaseMethod} from './_Base';\nimport {BaseNodeClass} from 'src/engine/nodes/_Base';\nimport {MethodDependency} from '../MethodDependency';\n// import Walker from 'src/core/Walker';\nimport {CoreString} from 'src/core/String';\n// import {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n\nexport class Opdigits extends BaseMethod {\n\tstatic required_arguments() {\n\t\treturn [['string', 'path to node']];\n\t}\n\n\tfind_dependency(index_or_path: number | string): MethodDependency | null {\n\t\tconst node = this.find_referenced_graph_node(index_or_path);\n\t\tif (node) {\n\t\t\tif (node instanceof BaseNodeClass) {\n\t\t\t\tconst name_node = node.name_controller.graph_node;\n\t\t\t\treturn this.create_dependency(name_node, index_or_path);\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t\t// return [this.create_dependency_from_index_or_path(index_or_path)]\n\t}\n\t// find_dependencies(index_or_path: number|string): ReferenceSearchResult{\n\n\t// \t// TODO: ensure the dependency update works for space params when they get renamed\n\t// \tconsole.log(node)\n\t// \tconst name_node = node.name_graph_node()\n\t// \treturn this.create_search_result(name_node, index_or_path)\n\t// \t// return this.create_reference_search_result_from_index_or_path(index_or_path)\n\t// }\n\n\tprocess_arguments(args: any[]): Promise<any> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (args.length == 1) {\n\t\t\t\tconst index_or_path = args[0];\n\t\t\t\tconst node = this.get_referenced_node(index_or_path);\n\t\t\t\tif (node) {\n\t\t\t\t\tconst name = node.name;\n\t\t\t\t\tconst value = CoreString.tail_digits(name);\n\t\t\t\t\tresolve(value);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(0);\n\t\t\t}\n\t\t});\n\t}\n}\n","import {BaseMethod} from './_Base';\nimport {MethodDependency} from '../MethodDependency';\nimport {GeometryContainer} from 'src/engine/containers/Geometry';\n// import {CoreGroup} from 'src/core/Geometry/Group'\n\nexport class Point extends BaseMethod {\n\tstatic required_arguments() {\n\t\treturn [\n\t\t\t['string', 'path to node'],\n\t\t\t['index', 'point index'],\n\t\t\t['string', 'attribute name'],\n\t\t];\n\t}\n\n\tfind_dependency(index_or_path: number | string): MethodDependency | null {\n\t\treturn this.create_dependency_from_index_or_path(index_or_path);\n\t}\n\n\tprocess_arguments(args: any[]): Promise<any> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tif (args.length == 3) {\n\t\t\t\tconst index_or_path = args[0];\n\t\t\t\tconst attrib_name = args[1];\n\t\t\t\tconst point_index = args[2];\n\t\t\t\tlet container: GeometryContainer | null = null;\n\t\t\t\ttry {\n\t\t\t\t\tcontainer = (await this.get_referenced_node_container(index_or_path)) as GeometryContainer;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treject(e);\n\t\t\t\t}\n\t\t\t\tif (container) {\n\t\t\t\t\tconst value = this._get_value_from_container(container, attrib_name, point_index);\n\t\t\t\t\tresolve(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(0);\n\t\t\t}\n\t\t});\n\t}\n\n\t_get_value_from_container(container: GeometryContainer, attrib_name: string, point_index: number) {\n\t\tconst core_group = container.core_content();\n\t\t// TODO: optimise and store the group_wrapper in the json_node\n\t\tif (core_group) {\n\t\t\tconst point = core_group.points()[point_index];\n\n\t\t\tif (point) {\n\t\t\t\treturn point.attrib_value(attrib_name);\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t// _get_param_value(index_or_path, point_index, attrib_name, callback){\n\t// \treturn this.get_referenced_node_container(index_or_path, container=> {\n\t// \t\tconst group = container.group({clone: false});\n\t// \t\tconst group_wrapper = new Core.Geometry.Group(group);\n\t// \t\t// TODO: optimise and store the group_wrapper in the json_node\n\t// \t\tconst point = group_wrapper.points()[point_index];\n\n\t// \t\tif (point != null) {\n\t// \t\t\tconst value = point.attrib_value(attrib_name);\n\t// \t\t\tif (value != null) {\n\t// \t\t\t\treturn callback(value);\n\t// \t\t\t} else {\n\t// \t\t\t\t//throw \"no attribute #{attrib_name} found\"\n\t// \t\t\t\tconsole.error(`no attribute ${attrib_name} found`);\n\t// \t\t\t\treturn callback(0);\n\t// \t\t\t}\n\t// \t\t} else {\n\t// \t\t\tconsole.error(`no point found with index ${point_index}`);\n\t// \t\t\treturn callback(0);\n\t// \t\t}\n\t// \t});\n\t// }\n}\n","import {BaseMethod} from './_Base';\nimport {MethodDependency} from '../MethodDependency';\nimport {GeometryContainer} from 'src/engine/containers/Geometry';\n// import {CoreGroup} from 'src/core/Geometry/Group';\n\nexport class PointsCount extends BaseMethod {\n\t// npoints(0)\n\t// npoints('../REF_bbox')\n\tstatic required_arguments() {\n\t\treturn [['string', 'path to node']];\n\t}\n\n\tfind_dependency(index_or_path: number | string): MethodDependency | null {\n\t\treturn this.create_dependency_from_index_or_path(index_or_path);\n\t}\n\n\tprocess_arguments(args: any[]): Promise<any> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tif (args.length == 1) {\n\t\t\t\tconst index_or_path = args[0];\n\t\t\t\tlet container: GeometryContainer;\n\t\t\t\ttry {\n\t\t\t\t\tcontainer = (await this.get_referenced_node_container(index_or_path)) as GeometryContainer;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treject(e);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (container) {\n\t\t\t\t\tconst value = container.points_count();\n\t\t\t\t\tresolve(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(0);\n\t\t\t}\n\t\t});\n\t}\n}\n","import {BaseMethod} from './_Base';\n// import {MethodDependency} from '../MethodDependency'\n\nexport class StrCharsCount extends BaseMethod {\n\t// str_chars_count('bla') => 3\n\tstatic required_arguments() {\n\t\treturn [['string', 'string to count characters of']];\n\t}\n\n\t// find_dependency(index_or_path: number | string): null {\n\t// \treturn null\n\t// \t// return this.create_dependency_from_index_or_path(index_or_path)\n\t// }\n\n\tasync process_arguments(args: any[]): Promise<number> {\n\t\tlet value = 0;\n\t\tif (args.length == 1) {\n\t\t\tconst string = args[0];\n\t\t\tvalue = string.length;\n\t\t}\n\t\treturn value;\n\t}\n}\n","import {BaseMethod} from './_Base';\n// import {MethodDependency} from '../MethodDependency'\n\nexport class StrConcat extends BaseMethod {\n\t// str_concat(1,2) => '12'\n\t// str_concat(1,\"a\") => '1a'\n\t// str_concat(\"a\",12, \"b\", \" \", 17) => 'a12b 17'\n\tstatic required_arguments(): any[] {\n\t\treturn [\n\t\t\t// ['string', 'string to get range from'],\n\t\t\t// ['integer', 'range start'],\n\t\t\t// ['integer', 'range size'],\n\t\t];\n\t}\n\n\t// find_dependency(index_or_path: number | string): null {\n\t// \treturn null\n\t// \t// return this.create_dependency_from_index_or_path(index_or_path)\n\t// }\n\n\tasync process_arguments(args: any[]): Promise<string> {\n\t\tlet value = '';\n\n\t\tfor (let arg of args) {\n\t\t\tif (arg == null) {\n\t\t\t\targ = '';\n\t\t\t}\n\t\t\tvalue += `${arg}`;\n\t\t}\n\n\t\treturn value;\n\t}\n}\n","import {BaseMethod} from './_Base';\n// import {MethodDependency} from '../MethodDependency'\n\nexport class StrIndex extends BaseMethod {\n\t// str_chars_count('bla') => 3\n\tstatic required_arguments() {\n\t\treturn [\n\t\t\t['string', 'string to get index from'],\n\t\t\t['string', 'char to find index of'],\n\t\t];\n\t}\n\n\t// find_dependency(index_or_path: number | string): null {\n\t// \treturn null\n\t// \t// return this.create_dependency_from_index_or_path(index_or_path)\n\t// }\n\n\tasync process_arguments(args: any[]): Promise<number> {\n\t\tlet value = -1;\n\t\tif (args.length == 2) {\n\t\t\tconst string = args[0];\n\t\t\tconst sub_string = args[1];\n\t\t\tvalue = string.indexOf(sub_string);\n\t\t}\n\t\treturn value;\n\t}\n}\n","import {BaseMethod} from './_Base';\n// import {MethodDependency} from '../MethodDependency'\n\nexport class StrSub extends BaseMethod {\n\t// str_chars_count('bla') => 3\n\tstatic required_arguments() {\n\t\treturn [\n\t\t\t['string', 'string to get range from'],\n\t\t\t['integer', 'range start'],\n\t\t\t['integer', 'range size'],\n\t\t];\n\t}\n\n\t// find_dependency(index_or_path: number | string): MethodDependency | null {\n\t// \treturn null;\n\t// \t// return this.create_dependency_from_index_or_path(index_or_path)\n\t// }\n\n\tasync process_arguments(args: any[]): Promise<string> {\n\t\tlet value = '';\n\t\tconst string = args[0];\n\t\tconst range_start = args[1] || 0;\n\t\tlet range_size = args[2] || 1;\n\t\tif (string) {\n\t\t\tvalue = string.substr(range_start, range_size);\n\t\t}\n\t\treturn value;\n\t}\n}\n","// this class is suffixed 'Creator' as opposed to the FunctionGenerator class\n// since it is much simpler and only used to generated the lines for the async function\n// of FunctionGenerator\nexport class AttributeRequirementsController {\n\tprivate _attribute_names: Set<string> | undefined;\n\tconstructor() {}\n\n\treset() {\n\t\tif (this._attribute_names) {\n\t\t\tthis._attribute_names.clear();\n\t\t}\n\t}\n\tassign_attributes_lines(): string {\n\t\tif (this._attribute_names) {\n\t\t\tconst lines: string[] = [];\n\t\t\tthis._attribute_names?.forEach((attribute_name: string) => {\n\t\t\t\tlines.push(AttributeRequirementsController.assign_attribute_line(attribute_name));\n\t\t\t});\n\t\t\treturn lines.join(';\\n');\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\tassign_arrays_lines(): string {\n\t\tif (this._attribute_names) {\n\t\t\tconst lines: string[] = [];\n\t\t\tthis._attribute_names?.forEach((attribute_name: string) => {\n\t\t\t\tlines.push(AttributeRequirementsController.assign_item_size_line(attribute_name));\n\t\t\t\tlines.push(AttributeRequirementsController.assign_array_line(attribute_name));\n\t\t\t});\n\t\t\treturn lines.join(';\\n');\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\tattribute_presence_check_line(): string {\n\t\tif (this._attribute_names) {\n\t\t\tconst var_names: string[] = [];\n\t\t\tthis._attribute_names?.forEach((attribute_name: string) => {\n\t\t\t\tconst var_name = AttributeRequirementsController.var_attribute(attribute_name);\n\t\t\t\tvar_names.push(var_name);\n\t\t\t});\n\t\t\treturn var_names.join(' && ');\n\t\t} else {\n\t\t\treturn 'true';\n\t\t}\n\t}\n\n\tadd(attribute_name: string) {\n\t\tthis._attribute_names = this._attribute_names || new Set<string>();\n\t\tthis._attribute_names.add(attribute_name);\n\t}\n\n\tstatic assign_attribute_line(attribute_name: string) {\n\t\tconst var_attribute = this.var_attribute(attribute_name);\n\t\treturn `const ${var_attribute} = entities[0].geometry().attributes['${attribute_name}']`;\n\t}\n\tstatic assign_item_size_line(attribute_name: string) {\n\t\tconst var_attribute = this.var_attribute(attribute_name);\n\t\tconst var_attribute_size = this.var_attribute_size(attribute_name);\n\t\treturn `const ${var_attribute_size} = ${var_attribute}.itemSize`;\n\t}\n\tstatic assign_array_line(attribute_name: string) {\n\t\tconst var_attribute = this.var_attribute(attribute_name);\n\t\tconst var_array = this.var_array(attribute_name);\n\t\treturn `const ${var_array} = ${var_attribute}.array`;\n\t}\n\n\tstatic var_attribute(attribute_name: string) {\n\t\treturn `attrib_${attribute_name}`;\n\t}\n\tstatic var_attribute_size(attribute_name: string) {\n\t\treturn `attrib_size_${attribute_name}`;\n\t}\n\tstatic var_array(attribute_name: string) {\n\t\treturn `array_${attribute_name}`;\n\t}\n\tvar_attribute_size(attribute_name: string) {\n\t\treturn AttributeRequirementsController.var_attribute_size(attribute_name);\n\t}\n\tvar_array(attribute_name: string) {\n\t\treturn AttributeRequirementsController.var_array(attribute_name);\n\t}\n}\n","import {BaseParamType} from 'src/engine/params/_Base';\nimport {ParsedTree} from './ParsedTree';\n// import {LiteralConstructsController} from './LiteralConstructsController'\nimport jsep from 'jsep';\n// import {BaseMethod} from 'src/Engine/Expression/Method/_Base'\n// import {ReferenceSearchResult, MissingExpressionReference} from './MissingReference'\n// import {MissingReferencesControler} from './MissingReferencesController'\n\nconst ARGUMENTS_SEPARATOR = ', ';\n// const ATTRIBUTE_PREFIX = '@'\n// const VARIABLE_PREFIX = '$'\n\n// export interface MethodsByName {\n// \t[propName: string]: BaseMethod;\n// }\n// interface JsepsByString {\n// \t[propName: string]: jsep.Expression[];\n// }\n// interface MissingExpressionReferenceByString {\n// \t[propName: string]: MissingExpressionReference;\n// }\nimport {BaseTraverser} from './_Base';\n\nexport class ExpressionStringGenerator extends BaseTraverser {\n\tconstructor(public param: BaseParamType) {\n\t\tsuper(param);\n\t}\n\n\tparse_tree(parsed_tree: ParsedTree) {\n\t\tif (parsed_tree.error_message == null && parsed_tree.node) {\n\t\t\ttry {\n\t\t\t\treturn this.traverse_node(parsed_tree.node);\n\t\t\t} catch (e) {\n\t\t\t\tthis.set_error('could not traverse tree');\n\t\t\t}\n\t\t} else {\n\t\t\tthis.set_error('cannot parse tree');\n\t\t}\n\t}\n\n\tprotected traverse_CallExpression(node: jsep.CallExpression): string {\n\t\tconst method_arguments = node.arguments.map((arg) => {\n\t\t\treturn this.traverse_node(arg);\n\t\t});\n\t\tconst arguments_joined = `${method_arguments.join(ARGUMENTS_SEPARATOR)}`;\n\n\t\tconst method_name = (node.callee as jsep.Identifier).name;\n\t\treturn `${method_name}(${arguments_joined})`;\n\t}\n\tprotected traverse_UnaryExpression(node: jsep.UnaryExpression): string {\n\t\treturn `${node.operator}${this.traverse_node(node.argument)}`; // -5\n\t}\n\n\tprotected traverse_Identifier(node: jsep.Identifier): string {\n\t\treturn `${node.name}`;\n\t}\n}\n","import {BaseParamType} from 'src/engine/params/_Base';\n// import {ParsedTree} from './Traverser/ParsedTree'\nimport {FunctionGenerator} from './traversers/FunctionGenerator';\n// import {NodeSimple} from 'src/core/graph/NodeSimple'\n// import {MissingExpressionReference} from './MissingReference'\n// import {MissingReferencesController} from './MissingReferencesController'\n// import {NamesListener} from './NamesListener'\nimport {MethodDependency} from './MethodDependency';\nimport jsep from 'jsep';\n\n// interface MissingExpressionReferenceByString {\n// \t[propName: string]: MissingExpressionReference;\n// }\nexport interface JsepsByString {\n\t[propName: string]: jsep.Expression[];\n}\n\nexport class DependenciesController {\n\terror_message: string | undefined;\n\t// private references_controller: MissingReferencesController\n\t// private missing_expression_references_by_id: MissingExpressionReferenceByString = {}\n\tprivate cyclic_graph_detected: boolean = false;\n\t// private jsep_nodes_by_missing_paths: JsepsByString = {}\n\tprivate method_dependencies: MethodDependency[] = [];\n\n\t// private names_listeners: NamesListener[] = []\n\n\tconstructor(public param: BaseParamType) {\n\t\t// this.references_controller = this.param.scene().missing_expression_references_controller\n\t}\n\n\tprotected set_error(message: string) {\n\t\tthis.error_message = this.error_message || message;\n\t}\n\n\treset() {\n\t\tthis.param.graph_disconnect_predecessors();\n\n\t\tthis.method_dependencies.forEach((method_dependency) => {\n\t\t\tmethod_dependency.reset();\n\t\t});\n\t\tthis.method_dependencies = [];\n\n\t\t// this.jsep_nodes_by_missing_paths = {}\n\t\t// const ref_ids = Object.keys(this.missing_expression_references_by_id)\n\t\t// ref_ids.forEach(ref_id=>{\n\t\t// \tconst ref = this.missing_expression_references_by_id[ref_id]\n\t\t// \tthis.references_controller.unregister(ref)\n\t\t// })\n\t\t// this.missing_expression_references_by_id = {}\n\n\t\t// this.names_listeners.forEach(names_listener=>{names_listener.reset()})\n\t}\n\n\tupdate(function_generator: FunctionGenerator) {\n\t\t// const immutable_dependencies = function_generator.immutable_dependencies\n\t\t// const jsep_dependencies = function_generator.jsep_dependencies\n\t\t// const jsep_nodes_by_missing_paths = function_generator.jsep_nodes_by_missing_paths\n\n\t\t// if(jsep_dependencies.length > 0){\n\t\t// \tconsole.log(\"connect_param_to_dependencies\", this.param.full_path())\n\t\t// }\n\n\t\tthis.cyclic_graph_detected = false;\n\n\t\tthis.connect_immutable_dependencies(function_generator);\n\t\tthis.method_dependencies = function_generator.method_dependencies;\n\t\tthis.handle_method_dependencies();\n\t\t// this.connect_missing_paths(function_generator)\n\n\t\tthis.listen_for_name_changes();\n\t}\n\n\tprivate connect_immutable_dependencies(function_generator: FunctionGenerator) {\n\t\tfunction_generator.immutable_dependencies.forEach((dependency) => {\n\t\t\tif (this.cyclic_graph_detected == false) {\n\t\t\t\tif (this.param.add_graph_input(dependency) == false) {\n\t\t\t\t\tthis.cyclic_graph_detected = true;\n\t\t\t\t\tthis.set_error('cannot create expression, infinite graph detected');\n\t\t\t\t\tthis.reset();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\tprivate handle_method_dependencies() {\n\t\tthis.method_dependencies.forEach((method_dependency) => {\n\t\t\tif (this.cyclic_graph_detected == false) {\n\t\t\t\tthis.handle_method_dependency(method_dependency);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate handle_method_dependency(method_dependency: MethodDependency) {\n\t\tconst node_simple = method_dependency.resolved_graph_node;\n\n\t\tif (node_simple) {\n\t\t\t// this should update the jsep_node, and run the expression to string parser\n\t\t\t// when a name in the referenced nodes is updated\n\t\t\t// const names_listener = new NamesListener(this.param, node_simple, jsep_node)\n\t\t\t// TODO: test that it is no longer active if expression is updated\n\n\t\t\tif (!this.param.add_graph_input(node_simple)) {\n\t\t\t\tthis.cyclic_graph_detected = true;\n\t\t\t\tthis.set_error('cannot create expression, infinite graph detected');\n\t\t\t\tthis.reset();\n\t\t\t\treturn;\n\t\t\t}\n\t\t} // else {\n\t\t// const jsep_node = method_dependency.jsep_node\n\t\t//}\n\t}\n\n\tprivate listen_for_name_changes() {\n\t\tthis.method_dependencies.forEach((method_dependency) => {\n\t\t\tmethod_dependency.listen_for_name_changes();\n\t\t});\n\t}\n\n\t// private connect_missing_paths(function_generator: FunctionGenerator){\n\n\t// \tconst jsep_nodes_by_missing_paths = function_generator.jsep_nodes_by_missing_paths\n\t// \tconst missing_paths = Object.keys(jsep_nodes_by_missing_paths)\n\n\t// \tmissing_paths.forEach((missing_path)=>{\n\t// \t\tconst full_path = CoreWalker.make_absolute(this.param.node(), missing_path)\n\t// \t\tconst jsep_nodes = jsep_nodes_by_missing_paths[missing_path]\n\t// \t\tjsep_nodes.forEach(jsep_node=>{\n\t// \t\t\tconst missing_expression_reference = this.references_controller.register(this.param, jsep_node, full_path)\n\n\t// \t\t\tthis.missing_expression_references_by_id[missing_expression_reference.id] = missing_expression_reference\n\t// \t\t})\n\t// \t})\n\n\t// }\n}\n","import {TypedParam} from './_Base';\nimport {ParamType} from '../poly/ParamType';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n\nexport class ButtonParam extends TypedParam<ParamType.BUTTON> {\n\tstatic type() {\n\t\treturn ParamType.BUTTON;\n\t}\n\tget default_value_serialized() {\n\t\treturn this.default_value;\n\t}\n\tget raw_input_serialized() {\n\t\treturn this._raw_input;\n\t}\n\tget value_serialized() {\n\t\treturn this.value;\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.BUTTON],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.BUTTON]\n\t) {\n\t\treturn true;\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.BUTTON], val2: ParamValuesTypeMap[ParamType.BUTTON]) {\n\t\treturn true;\n\t}\n\tpress_button() {\n\t\tthis.options.execute_callback();\n\t}\n}\n","import {TypedMultipleParam} from './_Multiple';\nimport lodash_isArray from 'lodash/isArray';\n// import lodash_isNumber from 'lodash/isNumber';\nimport {Color} from 'three/src/math/Color';\nimport {ParamType} from '../poly/ParamType';\nimport {FloatParam} from './Float';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n\n// import {ParamInitValuesTypeMap} from '../nodes/utils/params/ParamsController';\n\nconst COMPONENT_NAMES_COLOR = ['r', 'g', 'b'];\nexport class ColorParam extends TypedMultipleParam<ParamType.COLOR> {\n\tprotected _value = new Color();\n\tr!: FloatParam;\n\tg!: FloatParam;\n\tb!: FloatParam;\n\tstatic type() {\n\t\treturn ParamType.COLOR;\n\t}\n\tstatic get component_names() {\n\t\treturn COMPONENT_NAMES_COLOR;\n\t}\n\tget default_value_serialized() {\n\t\tif (lodash_isArray(this.default_value)) {\n\t\t\treturn this.default_value;\n\t\t} else {\n\t\t\treturn this.default_value.toArray() as Number3;\n\t\t}\n\t}\n\t// get raw_input_serialized() {\n\t// \tif (this._raw_input instanceof Color) {\n\t// \t\treturn this._raw_input.toArray() as Number3;\n\t// \t} else {\n\t// \t\tconst new_array: StringOrNumber3 = [this._raw_input[0], this._raw_input[1], this._raw_input[2]];\n\t// \t\treturn new_array;\n\t// \t}\n\t// }\n\tget value_serialized() {\n\t\treturn this.value.toArray() as Number3;\n\t}\n\tprotected _clone_raw_input(raw_input: ParamInitValuesTypeMap[ParamType.COLOR]) {\n\t\tif (raw_input instanceof Color) {\n\t\t\treturn raw_input.clone();\n\t\t} else {\n\t\t\tconst new_array: StringOrNumber3 = [raw_input[0], raw_input[1], raw_input[2]];\n\t\t\treturn new_array;\n\t\t}\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.OPERATOR_PATH],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.OPERATOR_PATH]\n\t) {\n\t\treturn raw_input1 == raw_input2;\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.COLOR], val2: ParamValuesTypeMap[ParamType.COLOR]) {\n\t\treturn val1.equals(val2);\n\t}\n\tinit_components() {\n\t\tsuper.init_components();\n\t\tthis.r = this.components[0];\n\t\tthis.g = this.components[1];\n\t\tthis.b = this.components[2];\n\t}\n\t// set_raw_input_from_components() {\n\t// \tif (this._raw_input instanceof Color) {\n\t// \t\tif (\n\t// \t\t\tlodash_isNumber(this.r.raw_input) &&\n\t// \t\t\tlodash_isNumber(this.g.raw_input) &&\n\t// \t\t\tlodash_isNumber(this.b.raw_input)\n\t// \t\t) {\n\t// \t\t\tthis._raw_input.r = this.r.raw_input;\n\t// \t\t\tthis._raw_input.g = this.g.raw_input;\n\t// \t\t\tthis._raw_input.b = this.b.raw_input;\n\t// \t\t} else {\n\t// \t\t\tthis._raw_input = [this.r.raw_input, this.g.raw_input, this.b.raw_input];\n\t// \t\t}\n\t// \t} else {\n\t// \t\tthis._raw_input[0] = this.r.raw_input;\n\t// \t\tthis._raw_input[1] = this.g.raw_input;\n\t// \t\tthis._raw_input[2] = this.b.raw_input;\n\t// \t}\n\t// }\n\tset_value_from_components() {\n\t\tthis._value.r = this.r.value;\n\t\tthis._value.g = this.g.value;\n\t\tthis._value.b = this.b.value;\n\t}\n\t// convert(input: ParamInitValuesTypeMap[ParamType.COLOR]): Color | null {\n\t// \tif (lodash_isArray(input)) {\n\t// \t\tif(input.length == 3){\n\t// \t\t\tif( input.filter(lodash_isNumber).length > 0 ){\n\t// \t\t\t\treturn new Color().fromArray(input);\n\t// \t\t\t}\n\t// \t\t\tif(first){\n\t// \t\t\t\tif(lodash_isNumber(first)){\n\t// \t\t\t\t\treturn new Color().fromArray(input);\n\t// \t\t\t\t}\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// \treturn new Color();\n\t// }\n}\n","import {TypedParam} from './_Base';\nimport {ParamType} from '../poly/ParamType';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n\nexport class FolderParam extends TypedParam<ParamType.FOLDER> {\n\tstatic type() {\n\t\treturn ParamType.FOLDER;\n\t}\n\tget default_value_serialized() {\n\t\treturn this.default_value;\n\t}\n\tget raw_input_serialized() {\n\t\treturn this._raw_input;\n\t}\n\tget value_serialized() {\n\t\treturn this.value;\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.FOLDER],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.FOLDER]\n\t) {\n\t\treturn true;\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.FOLDER], val2: ParamValuesTypeMap[ParamType.FOLDER]) {\n\t\treturn true;\n\t}\n}\n","import {TypedParam} from './_Base';\nimport {ParamType} from '../poly/ParamType';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n\nexport class SeparatorParam extends TypedParam<ParamType.SEPARATOR> {\n\tstatic type() {\n\t\treturn ParamType.SEPARATOR;\n\t}\n\tget default_value_serialized() {\n\t\treturn this.default_value;\n\t}\n\tget raw_input_serialized() {\n\t\treturn this._raw_input;\n\t}\n\tget value_serialized() {\n\t\treturn this.value;\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.SEPARATOR],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.SEPARATOR]\n\t) {\n\t\treturn true;\n\t}\n\tstatic are_values_equal(\n\t\tval1: ParamValuesTypeMap[ParamType.SEPARATOR],\n\t\tval2: ParamValuesTypeMap[ParamType.SEPARATOR]\n\t) {\n\t\treturn true;\n\t}\n}\n","import {TypedMultipleParam} from './_Multiple';\n\nimport lodash_isArray from 'lodash/isArray';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {ParamType} from '../poly/ParamType';\nimport {FloatParam} from './Float';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n\nconst COMPONENT_NAMES_VECTOR2 = ['x', 'y'];\nexport class Vector2Param extends TypedMultipleParam<ParamType.VECTOR2> {\n\tprotected _value = new Vector2();\n\tx!: FloatParam;\n\ty!: FloatParam;\n\tstatic type() {\n\t\treturn ParamType.VECTOR2;\n\t}\n\n\tstatic get component_names() {\n\t\treturn COMPONENT_NAMES_VECTOR2;\n\t}\n\tget default_value_serialized() {\n\t\tif (lodash_isArray(this.default_value)) {\n\t\t\treturn this.default_value;\n\t\t} else {\n\t\t\treturn this.default_value.toArray() as Number2;\n\t\t}\n\t}\n\t// get raw_input_serialized() {\n\t// \tif (this._raw_input instanceof Vector2) {\n\t// \t\treturn this._raw_input.toArray() as Number2;\n\t// \t} else {\n\t// \t\tconst new_array: StringOrNumber2 = [this._raw_input[0], this._raw_input[1]];\n\t// \t\treturn new_array;\n\t// \t}\n\t// }\n\tget value_serialized() {\n\t\treturn this.value.toArray() as Number2;\n\t}\n\tprotected _clone_raw_input(raw_input: ParamInitValuesTypeMap[ParamType.VECTOR2]) {\n\t\tif (raw_input instanceof Vector2) {\n\t\t\treturn raw_input.clone();\n\t\t} else {\n\t\t\tconst new_array: StringOrNumber2 = [raw_input[0], raw_input[1]];\n\t\t\treturn new_array;\n\t\t}\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.VECTOR2],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.VECTOR2]\n\t) {\n\t\tif (raw_input1 instanceof Vector2) {\n\t\t\tif (raw_input2 instanceof Vector2) {\n\t\t\t\treturn raw_input1.equals(raw_input2);\n\t\t\t} else {\n\t\t\t\treturn raw_input1.x == raw_input2[0] && raw_input1.y == raw_input2[1];\n\t\t\t}\n\t\t} else {\n\t\t\tif (raw_input2 instanceof Vector2) {\n\t\t\t\treturn raw_input1[0] == raw_input2.x && raw_input1[1] == raw_input2.y;\n\t\t\t} else {\n\t\t\t\treturn raw_input1[0] == raw_input2[0] && raw_input1[1] == raw_input2[1];\n\t\t\t}\n\t\t}\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.VECTOR2], val2: ParamValuesTypeMap[ParamType.VECTOR2]) {\n\t\treturn val1.equals(val2);\n\t}\n\tinit_components() {\n\t\tsuper.init_components();\n\t\tthis.x = this.components[0];\n\t\tthis.y = this.components[1];\n\t}\n\n\tset_value_from_components() {\n\t\tthis._value.x = this.x.value;\n\t\tthis._value.y = this.y.value;\n\t}\n\t// convert(input: any) {\n\t// \tif (lodash_isArray(input)) {\n\t// \t\treturn new Vector2().fromArray(input);\n\t// \t}\n\t// \treturn new Vector2();\n\t// }\n}\n","import {TypedMultipleParam} from './_Multiple';\nimport lodash_isArray from 'lodash/isArray';\n// import lodash_isNumber from 'lodash/isNumber';\nimport {FloatParam} from './Float';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {ParamType} from '../poly/ParamType';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n// import {ParamInitValuesTypeMap} from '../nodes/utils/params/ParamsController';\n\nconst COMPONENT_NAMES_VECTOR3 = ['x', 'y', 'z'];\nexport class Vector3Param extends TypedMultipleParam<ParamType.VECTOR3> {\n\tprotected _value = new Vector3();\n\tx!: FloatParam;\n\ty!: FloatParam;\n\tz!: FloatParam;\n\tstatic type() {\n\t\treturn ParamType.VECTOR3;\n\t}\n\tstatic get component_names() {\n\t\treturn COMPONENT_NAMES_VECTOR3;\n\t}\n\tget default_value_serialized() {\n\t\tif (lodash_isArray(this.default_value)) {\n\t\t\treturn this.default_value;\n\t\t} else {\n\t\t\treturn this.default_value.toArray() as Number3;\n\t\t}\n\t}\n\t// get raw_input_serialized() {\n\t// \tif (this._raw_input instanceof Vector3) {\n\t// \t\treturn this._raw_input.toArray() as Number3;\n\t// \t} else {\n\t// \t\tconst new_array: StringOrNumber3 = [this._raw_input[0], this._raw_input[1], this._raw_input[2]];\n\t// \t\treturn new_array;\n\t// \t}\n\t// }\n\tget value_serialized() {\n\t\treturn this.value.toArray() as Number3;\n\t}\n\tprotected _clone_raw_input(raw_input: ParamInitValuesTypeMap[ParamType.VECTOR3]) {\n\t\tif (raw_input instanceof Vector3) {\n\t\t\treturn raw_input.clone();\n\t\t} else {\n\t\t\tconst new_array: StringOrNumber3 = [raw_input[0], raw_input[1], raw_input[2]];\n\t\t\treturn new_array;\n\t\t}\n\t}\n\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.VECTOR3],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.VECTOR3]\n\t) {\n\t\tif (raw_input1 instanceof Vector3) {\n\t\t\tif (raw_input2 instanceof Vector3) {\n\t\t\t\treturn raw_input1.equals(raw_input2);\n\t\t\t} else {\n\t\t\t\treturn raw_input1.x == raw_input2[0] && raw_input1.y == raw_input2[1] && raw_input1.z == raw_input2[2];\n\t\t\t}\n\t\t} else {\n\t\t\tif (raw_input2 instanceof Vector3) {\n\t\t\t\treturn raw_input1[0] == raw_input2.x && raw_input1[1] == raw_input2.y && raw_input1[2] == raw_input2.z;\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\traw_input1[0] == raw_input2[0] && raw_input1[1] == raw_input2[1] && raw_input1[2] == raw_input2[2]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.VECTOR3], val2: ParamValuesTypeMap[ParamType.VECTOR3]) {\n\t\treturn val1.equals(val2);\n\t}\n\tinit_components() {\n\t\tsuper.init_components();\n\t\tthis.x = this.components[0];\n\t\tthis.y = this.components[1];\n\t\tthis.z = this.components[2];\n\t}\n\n\t// set_raw_input_from_components() {\n\t// \tif (this._raw_input instanceof Vector3) {\n\t// \t\tif (\n\t// \t\t\tlodash_isNumber(this.x.raw_input) &&\n\t// \t\t\tlodash_isNumber(this.y.raw_input) &&\n\t// \t\t\tlodash_isNumber(this.z.raw_input)\n\t// \t\t) {\n\t// \t\t\tthis._raw_input.x = this.x.raw_input;\n\t// \t\t\tthis._raw_input.y = this.y.raw_input;\n\t// \t\t\tthis._raw_input.z = this.z.raw_input;\n\t// \t\t} else {\n\t// \t\t\tthis._raw_input = [this.x.raw_input, this.y.raw_input, this.z.raw_input];\n\t// \t\t}\n\t// \t} else {\n\t// \t\tthis._raw_input[0] = this.x.raw_input;\n\t// \t\tthis._raw_input[1] = this.y.raw_input;\n\t// \t\tthis._raw_input[2] = this.z.raw_input;\n\t// \t}\n\t// }\n\tset_value_from_components() {\n\t\tthis._value.x = this.x.value;\n\t\tthis._value.y = this.y.value;\n\t\tthis._value.z = this.z.value;\n\t}\n\t// convert(input: ParamInitValuesTypeMap[ParamType.VECTOR3]) {\n\t// \tif (lodash_isArray(input)) {\n\t// \t\treturn new Vector3().fromArray(input);\n\t// \t}\n\t// \treturn new Vector3();\n\t// }\n}\n","import {TypedMultipleParam} from './_Multiple';\n\nimport lodash_isArray from 'lodash/isArray';\nimport {Vector4} from 'three/src/math/Vector4';\nimport {ParamType} from '../poly/ParamType';\nimport {FloatParam} from './Float';\nimport {ParamValuesTypeMap} from './types/ParamValuesTypeMap';\nimport {ParamInitValuesTypeMap} from './types/ParamInitValuesTypeMap';\n\nconst COMPONENT_NAMES_VECTOR4 = ['x', 'y', 'z', 'w'];\nexport class Vector4Param extends TypedMultipleParam<ParamType.VECTOR4> {\n\tprotected _value = new Vector4();\n\tx!: FloatParam;\n\ty!: FloatParam;\n\tz!: FloatParam;\n\tw!: FloatParam;\n\tstatic type() {\n\t\treturn ParamType.VECTOR4;\n\t}\n\tstatic get component_names() {\n\t\treturn COMPONENT_NAMES_VECTOR4;\n\t}\n\tget default_value_serialized() {\n\t\tif (lodash_isArray(this.default_value)) {\n\t\t\treturn this.default_value;\n\t\t} else {\n\t\t\treturn this.default_value.toArray() as Number4;\n\t\t}\n\t}\n\t// get raw_input_serialized() {\n\t// \tif (this._raw_input instanceof Vector4) {\n\t// \t\treturn this._raw_input.toArray() as Number4;\n\t// \t} else {\n\t// \t\tconst new_array: StringOrNumber4 = [\n\t// \t\t\tthis._raw_input[0],\n\t// \t\t\tthis._raw_input[1],\n\t// \t\t\tthis._raw_input[2],\n\t// \t\t\tthis._raw_input[3],\n\t// \t\t];\n\t// \t\treturn new_array;\n\t// \t}\n\t// }\n\tget value_serialized() {\n\t\treturn this.value.toArray() as Number4;\n\t}\n\n\tprotected _clone_raw_input(raw_input: ParamInitValuesTypeMap[ParamType.VECTOR4]) {\n\t\tif (raw_input instanceof Vector4) {\n\t\t\treturn raw_input.clone();\n\t\t} else {\n\t\t\tconst new_array: StringOrNumber4 = [raw_input[0], raw_input[1], raw_input[2], raw_input[3]];\n\t\t\treturn new_array;\n\t\t}\n\t}\n\tstatic are_raw_input_equal(\n\t\traw_input1: ParamInitValuesTypeMap[ParamType.VECTOR4],\n\t\traw_input2: ParamInitValuesTypeMap[ParamType.VECTOR4]\n\t) {\n\t\tif (raw_input1 instanceof Vector4) {\n\t\t\tif (raw_input2 instanceof Vector4) {\n\t\t\t\treturn raw_input1.equals(raw_input2);\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\traw_input1.x == raw_input2[0] &&\n\t\t\t\t\traw_input1.y == raw_input2[1] &&\n\t\t\t\t\traw_input1.z == raw_input2[2] &&\n\t\t\t\t\traw_input1.w == raw_input2[3]\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tif (raw_input2 instanceof Vector4) {\n\t\t\t\treturn (\n\t\t\t\t\traw_input1[0] == raw_input2.x &&\n\t\t\t\t\traw_input1[1] == raw_input2.y &&\n\t\t\t\t\traw_input1[2] == raw_input2.z &&\n\t\t\t\t\traw_input1[3] == raw_input2.w\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\traw_input1[0] == raw_input2[0] &&\n\t\t\t\t\traw_input1[1] == raw_input2[1] &&\n\t\t\t\t\traw_input1[2] == raw_input2[2] &&\n\t\t\t\t\traw_input1[3] == raw_input2[3]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\tstatic are_values_equal(val1: ParamValuesTypeMap[ParamType.VECTOR4], val2: ParamValuesTypeMap[ParamType.VECTOR4]) {\n\t\treturn val1.equals(val2);\n\t}\n\tinit_components() {\n\t\tsuper.init_components();\n\t\tthis.x = this.components[0];\n\t\tthis.y = this.components[1];\n\t\tthis.z = this.components[2];\n\t\tthis.w = this.components[3];\n\t}\n\n\tset_value_from_components() {\n\t\tthis._value.x = this.x.value;\n\t\tthis._value.y = this.y.value;\n\t\tthis._value.z = this.z.value;\n\t\tthis._value.w = this.w.value;\n\t}\n\t// convert(input: any) {\n\t// \tif (lodash_isArray(input)) {\n\t// \t\treturn new Vector4().fromArray(input);\n\t// \t}\n\t// \treturn new Vector4();\n\t// }\n}\n","import {NodeParamsConfig} from './ParamsConfig';\n// import {ParamValuesTypeMap} from './ParamsController';\n// import {ParamType} from 'src/engine/poly/ParamType';\n\n// function getProperty<T, K extends keyof T>(o: T, propertyName: K): T[K] {\n// \treturn o[propertyName]; // o[propertyName] is of type T[K]\n// }\n\n// let t: getProperty(ParamConfig, 'type')\n// function prop<T, K extends keyof T>(obj: T, key: K) {\n// \treturn typeof obj[key];\n// }\n// type test = Pick<ParamConfig<ParamType.FLOAT>, 'default_value'>;\n\nexport type ParamsValueAccessorType<T extends NodeParamsConfig> = {\n\treadonly [P in keyof T]: T[P]['value_type'];\n};\n\nexport class ParamsValueAccessor<T extends NodeParamsConfig> {\n\tconstructor() {\n\t\t// console.log('accessor', this);\n\t}\n}\n","import {BaseNodeType} from '../_Base';\n\nexport class ProcessingContext {\n\tprivate _frame: number = 0;\n\tconstructor(node: BaseNodeType) {}\n\tcopy(src_context: ProcessingContext) {\n\t\tthis._frame = src_context.frame;\n\t}\n\tget frame() {\n\t\treturn this._frame;\n\t}\n}\n","import {BaseNodeType} from '../../_Base';\n\nimport {ConnectionsController} from './ConnectionsController';\nimport {InputsController} from './InputsController';\nimport {OutputsController} from './OutputsController';\n\nexport class IOController<T extends BaseNodeType> {\n\tprotected _connections: ConnectionsController = new ConnectionsController(this.node);\n\tprotected _inputs: InputsController<T> | undefined;\n\tprotected _outputs: OutputsController<T> | undefined;\n\n\tconstructor(protected node: T) {}\n\n\t// add_connections_controller() {\n\t// \tthis._connections =\n\t// }\n\tget connections() {\n\t\treturn this._connections;\n\t}\n\n\t// inputs\n\t// init_inputs(options: InputsControllerOptions) {\n\t// \tthis.inputs.set_options(options);\n\t// }\n\tget inputs(): InputsController<T> {\n\t\treturn (this._inputs = this._inputs || new InputsController<T>(this.node));\n\t}\n\thas_inputs() {\n\t\treturn this._inputs != null;\n\t}\n\n\t// outputs\n\t// init_outputs() {\n\t// \tthis._outputs = this._outputs || new OutputsController(this.node);\n\t// }\n\tget outputs(): OutputsController<T> {\n\t\treturn (this._outputs = this._outputs || new OutputsController<T>(this.node));\n\t}\n\thas_outputs() {\n\t\treturn this._outputs != null;\n\t}\n}\n","import {BaseNodeType} from '../../_Base';\nimport lodash_compact from 'lodash/compact';\nimport {NodeConnection} from './NodeConnection';\n\n// interface NodeConnectionByString {\n// \t[propName: string]: NodeConnection;\n// }\n// interface NodeConnectionByStringByString {\n// \t[propName: string]: NodeConnectionByString;\n// }\n\nexport class ConnectionsController {\n\tprivate _input_connections: Array<NodeConnection | undefined> | undefined;\n\tprivate _output_connections: Map<number, Map<number, NodeConnection>> = new Map();\n\n\tconstructor(protected _node: BaseNodeType) {}\n\n\tinit_inputs() {\n\t\tconst count = this._node.io.inputs.max_inputs_count;\n\t\tthis._input_connections = new Array(count);\n\t}\n\n\t//\n\t//\n\t// INPUT CONNECTIONS\n\t//\n\t//\n\tadd_input_connection(connection: NodeConnection) {\n\t\tif (this._input_connections) {\n\t\t\t// if (connection.input_index < this._input_connections.length) {\n\t\t\tthis._input_connections[connection.input_index] = connection;\n\t\t\t// } else {\n\t\t\t// \tconsole.warn(`attempt to add an input connection at index ${connection.input_index}`);\n\t\t\t// }\n\t\t} else {\n\t\t\tconsole.warn(`input connections array not initialized`);\n\t\t}\n\t}\n\tremove_input_connection(connection: NodeConnection) {\n\t\tif (this._input_connections) {\n\t\t\tif (connection.input_index < this._input_connections.length) {\n\t\t\t\tthis._input_connections[connection.input_index] = undefined;\n\t\t\t} else {\n\t\t\t\tconsole.warn(`attempt to remove an input connection at index ${connection.input_index}`);\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(`input connections array not initialized`);\n\t\t}\n\t}\n\tinput_connection(index: number): NodeConnection | undefined {\n\t\tif (this._input_connections) {\n\t\t\treturn this._input_connections[index];\n\t\t}\n\t}\n\tfirst_input_connection(): NodeConnection {\n\t\treturn lodash_compact(this._input_connections)[0];\n\t}\n\tlast_input_connection(): NodeConnection {\n\t\tconst connections = lodash_compact(this._input_connections);\n\t\treturn connections[connections.length - 1];\n\t}\n\tinput_connections() {\n\t\treturn this._input_connections;\n\t}\n\n\t//\n\t//\n\t// OUTPUT CONNECTIONS\n\t//\n\t//\n\tadd_output_connection(connection: NodeConnection) {\n\t\tconst output_index = connection.output_index;\n\t\tconst id = connection.id;\n\t\tlet connections_by_id = this._output_connections.get(output_index);\n\t\tif (!connections_by_id) {\n\t\t\tconnections_by_id = new Map<number, NodeConnection>();\n\t\t\tthis._output_connections.set(output_index, connections_by_id);\n\t\t}\n\t\tconnections_by_id.set(id, connection);\n\t\t// this._output_connections[output_index] = this._output_connections[output_index] || {};\n\t\t// this._output_connections[output_index][id] = connection;\n\t}\n\tremove_output_connection(connection: NodeConnection) {\n\t\tconst output_index = connection.output_index;\n\t\tconst id = connection.id;\n\t\tlet connections_by_id = this._output_connections.get(output_index);\n\t\tif (connections_by_id) {\n\t\t\tconnections_by_id.delete(id);\n\t\t}\n\t\t// delete this._output_connections[output_index][id];\n\t}\n\n\toutput_connections() {\n\t\tlet list: NodeConnection[] = [];\n\n\t\tthis._output_connections.forEach((connections_by_id, output_index) => {\n\t\t\tconnections_by_id.forEach((connection, id) => {\n\t\t\t\tif (connection) {\n\t\t\t\t\tlist.push(connection);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t// Object.keys(this._output_connections).forEach((index) => {\n\t\t// \tconst connections_for_index = this._output_connections[index];\n\t\t// \tObject.keys(connections_for_index).forEach((id) => {\n\t\t// \t\tlist.push(connections_for_index[id]);\n\t\t// \t});\n\t\t// });\n\t\treturn list;\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseContainer} from 'src/engine/containers/_Base';\n// import lodash_includes from 'lodash/includes'\n// import lodash_filter from 'lodash/filter'\nimport lodash_each from 'lodash/each';\nimport lodash_isString from 'lodash/isString';\n// import lodash_compact from 'lodash/compact'\nimport {BaseNamedConnectionPointType} from './NamedConnectionPoint';\nimport {NodeConnection} from './NodeConnection';\n\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {TypeAssert} from 'src/engine/poly/Assert';\n\n// export class InputGraphNode extends NodeSimple {\n// \tconstructor(name: string) {\n// \t\tsuper(name);\n// \t}\n// }\n\n// export interface InputsControllerOptions {\n// \tmin_inputs?: number;\n// \tmax_inputs?: number;\n// \tdepends_on_inputs?: boolean;\n// }\ntype OnUpdateHook = () => void;\n\n// TODO: remove the \"throw\" statements, which seem less necessary now with typescript\nexport class InputsController<T extends BaseNodeType> {\n\tprivate _graph_node_inputs: CoreGraphNode[] = [];\n\tprivate _inputs: Array<T | null> = [];\n\tprivate _has_named_inputs: boolean = false;\n\t// _input_connections: NodeConnection[] = []\n\tprivate _named_input_connection_points: BaseNamedConnectionPointType[] | undefined;\n\tprivate _min_inputs_count: number = 0;\n\tprivate _max_inputs_count: number = 0;\n\tprivate _depends_on_inputs: boolean = true;\n\n\t// hooks\n\tprivate _on_update_hooks: OnUpdateHook[] | undefined;\n\n\t// clonable\n\tprivate _user_inputs_clonable_states: InputCloneMode[] | undefined;\n\tprivate _inputs_clonable_states: InputCloneMode[] | undefined;\n\tprivate _override_clonable_state: boolean = false;\n\n\tconstructor(protected node: T) {\n\t\t//, options: InputsControllerOptions = {}) {\n\t\t// this.set_options(options);\n\t}\n\n\t// set_options(options: InputsControllerOptions) {\n\t// \tif (options['min_inputs']) {\n\t// \t\tthis.set_min_inputs_count(options['min_inputs']);\n\t// \t}\n\t// \tif (options['max_inputs']) {\n\t// \t\tthis.set_max_inputs_count(options['max_inputs']);\n\t// \t}\n\t// \tif (options['depends_on_inputs']) {\n\t// \t\tthis.set_depends_on_inputs(options['depends_on_inputs']);\n\t// \t}\n\t// }\n\n\t// _init_inputs() {\n\t// \tthis._inputs = [];\n\t// }\n\tset_depends_on_inputs(depends_on_inputs: boolean) {\n\t\tthis._depends_on_inputs = depends_on_inputs;\n\t}\n\tprivate set_min_inputs_count(min_inputs_count: number) {\n\t\tthis._min_inputs_count = min_inputs_count;\n\t}\n\t// min_inputs_count() {\n\t// \treturn this._min_inputs_count || 0;\n\t// }\n\tprivate set_max_inputs_count(max_inputs_count: number) {\n\t\tthis._max_inputs_count = max_inputs_count;\n\t\tthis.init_graph_node_inputs();\n\t}\n\n\tnamed_input_connection_points_by_name(name: string): BaseNamedConnectionPointType | undefined {\n\t\tif (this._named_input_connection_points) {\n\t\t\tfor (let connection_point of this._named_input_connection_points) {\n\t\t\t\tif (connection_point.name == name) {\n\t\t\t\t\treturn connection_point;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tset_named_input_connection_points(connection_points: BaseNamedConnectionPointType[]) {\n\t\tthis._has_named_inputs = true;\n\t\tthis._named_input_connection_points = connection_points;\n\t\tthis.set_min_inputs_count(0);\n\t\tthis.set_max_inputs_count(connection_points.length);\n\t\tthis.init_graph_node_inputs();\n\t\tthis.node.emit(NodeEvent.NAMED_INPUTS_UPDATED);\n\t}\n\tget has_named_inputs() {\n\t\treturn this._has_named_inputs;\n\t}\n\tget named_input_connection_points(): BaseNamedConnectionPointType[] {\n\t\treturn this._named_input_connection_points || [];\n\t}\n\tprivate init_graph_node_inputs() {\n\t\tfor (let i = 0; i < this._max_inputs_count; i++) {\n\t\t\tthis._graph_node_inputs[i] = this._graph_node_inputs[i] || this._create_graph_node_input(i);\n\t\t}\n\t}\n\tprivate _create_graph_node_input(index: number): CoreGraphNode {\n\t\tconst graph_input_node = new CoreGraphNode(this.node.scene, `input_${index}`);\n\t\t// graph_input_node.set_scene(this.node.scene);\n\t\tthis.node.add_graph_input(graph_input_node);\n\t\treturn graph_input_node;\n\t}\n\n\tget max_inputs_count(): number {\n\t\treturn this._max_inputs_count || 0;\n\t}\n\tinput_graph_node(input_index: number): CoreGraphNode {\n\t\treturn this._graph_node_inputs[input_index];\n\t}\n\n\t// set_count_to_zero() {\n\t// \tthis.set_min_inputs_count(0);\n\t// \tthis.set_max_inputs_count(0);\n\n\t// \tthis.init_inputs_clonable_state();\n\t// }\n\t// set_count_to_one_max() {\n\t// \tthis.set_min_inputs_count(0);\n\t// \tthis.set_max_inputs_count(1);\n\n\t// \tthis.init_inputs_clonable_state();\n\t// }\n\tset_count(min: number, max?: number) {\n\t\tif (max == null) {\n\t\t\tmax = min;\n\t\t}\n\t\tthis.set_min_inputs_count(min);\n\t\tthis.set_max_inputs_count(max);\n\n\t\tthis.init_inputs_clonable_state();\n\t\tthis.init_connections_controller_inputs();\n\t}\n\tprivate init_connections_controller_inputs() {\n\t\tthis.node.io.connections.init_inputs();\n\t}\n\t// requires_two_inputs: ->\n\t// \tthis.set_min_inputs_count(2)\n\t// \tthis.set_max_inputs_count(2)\n\n\t// requires_one_input() {\n\t// \treturn this._min_inputs_count > 0;\n\t// }\n\n\t// eval_required_inputs(callback){\n\t// \tconst containers = [];\n\t// \tif (this._max_inputs_count === 0) {\n\t// \t\treturn callback(containers);\n\t// \t} else {\n\t// \t\tconst existing_inputs = lodash_compact(this.inputs());\n\t// \t\tif (existing_inputs.length < this._min_inputs_count) {\n\t// \t\t\treturn this.self.set_error(\"inputs are missing\");\n\t// \t\t} else {\n\t// \t\t\t// const frame = this.self.context().frame();\n\t// \t\t\t// const full_path = this.self.full_path();\n\n\t// \t\t\tswitch (existing_inputs.length) {\n\t// \t\t\t\tcase 0:\n\t// \t\t\t\t\treturn callback(containers);\n\t// \t\t\t\tcase 1:\n\t// \t\t\t\t\treturn this.eval_required_input(0, container=> {\n\t// \t\t\t\t\t\tcontainers.push(container);\n\t// \t\t\t\t\t\treturn callback(containers);\n\t// \t\t\t\t\t});\n\t// \t\t\t\tcase 2:\n\t// \t\t\t\t\treturn this.eval_required_input(0, container0=> {\n\t// \t\t\t\t\t\treturn this.eval_required_input(1, container1=> {\n\t// \t\t\t\t\t\t\tcontainers.push(container0);\n\t// \t\t\t\t\t\t\tcontainers.push(container1);\n\t// \t\t\t\t\t\t\treturn callback(containers);\n\t// \t\t\t\t\t\t});\n\t// \t\t\t\t\t});\n\t// \t\t\t\t\t// TODO: I could also here check if the inputs are dirty\n\t// \t\t\t\t\t// instead of going through the callback chain\n\t// \t\t\t\t\t// input_node0 = this.input(0)\n\t// \t\t\t\t\t// input_node0.context().set_frame(frame, full_path)\n\t// \t\t\t\t\t// input_node0.request_container (container0)=>\n\t// \t\t\t\t\t// \tinput_node1 = this.input(1)\n\t// \t\t\t\t\t// \tinput_node1.context().set_frame(frame, full_path)\n\t// \t\t\t\t\t// \tinput_node1.request_container (container1)=>\n\t// \t\t\t\t\t// \t\tcontainers.push(container0)\n\t// \t\t\t\t\t// \t\tcontainers.push(container1)\n\t// \t\t\t\t\t// \t\tcallback([container0, container1])\n\t// \t\t\t\tdefault:\n\t// \t\t\t\t\tconsole.warn(`${this.self.full_path()} inputs not evaluated`);\n\t// \t\t\t\t\treturn callback();\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// }\n\tasync eval_required_inputs_p() {\n\t\tlet containers: Array<BaseContainer | null> = [];\n\t\tif (this._max_inputs_count > 0) {\n\t\t\tconst existing_input_indices: number[] = [];\n\t\t\tthis.inputs().forEach((input, i) => {\n\t\t\t\tif (input) {\n\t\t\t\t\texisting_input_indices.push(i);\n\t\t\t\t}\n\t\t\t});\n\t\t\t// const existing_inputs = lodash_compact(this.inputs());\n\t\t\tif (existing_input_indices.length < this._min_inputs_count) {\n\t\t\t\tthis.node.states.error.set('inputs are missing');\n\t\t\t} else {\n\t\t\t\tif (existing_input_indices.length > 0) {\n\t\t\t\t\tconst promises = existing_input_indices.map((input_index) => {\n\t\t\t\t\t\treturn this.node.io.inputs.eval_required_input(input_index);\n\t\t\t\t\t});\n\t\t\t\t\tcontainers = await Promise.all(promises);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn containers;\n\t}\n\t// eval_required_input(input_index: number, callback){\n\t// \treturn this.self.request_input_container(input_index, container=> {\n\t// \t\t// we do not clone here, as we just check if a group is present\n\t// \t\tlet group;\n\t// \t\tif ((container != null) && ((group = container.object({clone: false})) != null)) {\n\t// \t\t\treturn callback(container);\n\t// \t\t} else {\n\t// \t\t\tconst input_node = this.input(input_index);\n\t// \t\t\tif (input_node != null) {\n\t// \t\t\t\tconst input_error_message = input_node.error_message();\n\t// \t\t\t\treturn this.self.set_error(`input ${input_index} is invalid (error: ${input_error_message})`);\n\t// \t\t\t}\n\t// \t\t}\n\t// \t});\n\t// }\n\tasync eval_required_input(input_index: number) {\n\t\tconst container = await this.node.container_controller.request_input_container(input_index);\n\t\t// we do not clone here, as we just check if a group is present\n\t\tif (container && container.core_content()) {\n\t\t\t// return container;\n\t\t} else {\n\t\t\tconst input_node = this.input(input_index);\n\t\t\tif (input_node) {\n\t\t\t\tconst input_error_message = input_node.states.error.message;\n\t\t\t\tif (input_error_message) {\n\t\t\t\t\tthis.node.states.error.set(`input ${input_index} is invalid (error: ${input_error_message})`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn container;\n\t}\n\t// protected _get_named_input_index_without_error(name: string): number {\n\t// \tconst connections = this.named_input_connections;\n\t// \tlet index = -1;\n\t// \tfor (let i = 0; i < connections.length; i++) {\n\t// \t\tconst connection = connections[i];\n\t// \t\tif (connection.name == name) {\n\t// \t\t\treturn i;\n\t// \t\t}\n\t// \t}\n\t// \treturn index;\n\t// }\n\tget_named_input_index(name: string): number {\n\t\tif (this._named_input_connection_points) {\n\t\t\tfor (let i = 0; i < this._named_input_connection_points.length; i++) {\n\t\t\t\tif (this._named_input_connection_points[i].name == name) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t\t// const index = this._get_named_input_index_without_error(name);\n\t\t// if (index == null) {\n\t\t// \tconst connections = this.named_input_connections;\n\t\t// \tconst available_names = connections.map((o) => o.name).join(', ');\n\t\t// \tconsole.log('named_input_connections', connections);\n\t\t// \tthrow new Error(\n\t\t// \t\t`${this.node.full_path()}: no inputs named '${name}'. available names are '${available_names}' (${\n\t\t// \t\t\tconnections.length\n\t\t// \t\t} inputs)`\n\t\t// \t);\n\t\t// }\n\t\t// return index;\n\t}\n\tget_input_index(input_index_or_name: number | string): number {\n\t\tif (lodash_isString(input_index_or_name)) {\n\t\t\tif (this.has_named_inputs) {\n\t\t\t\treturn this.get_named_input_index(input_index_or_name);\n\t\t\t} else {\n\t\t\t\tthrow new Error(`node ${this.node.full_path()} has no named inputs`);\n\t\t\t}\n\t\t} else {\n\t\t\treturn input_index_or_name;\n\t\t}\n\t}\n\n\tset_input(input_index_or_name: number | string, node: T | null, output_index_or_name: number | string = 0) {\n\t\tconst input_index = this.get_input_index(input_index_or_name) || 0;\n\t\tlet output_index = 0;\n\t\tif (node) {\n\t\t\tif (node.io.outputs.has_named_outputs) {\n\t\t\t\t// if(node.has_named_output(output_index_or_name)){\n\t\t\t\toutput_index = node.io.outputs.get_output_index(output_index_or_name) || 0;\n\t\t\t\t// this seems to prevent connecting output 1 from a vec to float to something else\n\t\t\t\t// } else {\n\t\t\t\t// \tconsole.warn(`${node.full_path()} has no output '${output_index_or_name}'`)\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\n\t\tconst graph_input_node = this._graph_node_inputs[input_index];\n\t\tif (graph_input_node == null) {\n\t\t\tthrow `graph_input_node not found at index ${input_index}`;\n\t\t}\n\n\t\tif (node && this.node.parent != node.parent) {\n\t\t\treturn;\n\t\t}\n\t\t// use the name if the node is either not defined or in another parent\n\t\t// const parent = this.self.parent()\n\t\t// if ((node == null) || (node.parent().graph_node_id !== parent.graph_node_id)) {\n\t\t// \tif (node_name != null) {\n\t\t// \t\tnode = parent.node(node_name);\n\t\t// \t}\n\t\t// }\n\n\t\tconst old_input_node = this._inputs[input_index];\n\t\tlet old_output_index: number | null = null;\n\t\tlet old_connection: NodeConnection | undefined = undefined;\n\t\tif (this.node.io.connections) {\n\t\t\told_connection = this.node.io.connections.input_connection(input_index);\n\t\t}\n\t\tif (old_connection) {\n\t\t\told_output_index = old_connection.output_index;\n\t\t}\n\n\t\tif (node !== old_input_node || output_index != old_output_index) {\n\t\t\t// TODO: test: add test to make sure this is necessary\n\t\t\tif (old_input_node != null) {\n\t\t\t\tif (this._depends_on_inputs) {\n\t\t\t\t\tgraph_input_node.remove_graph_input(old_input_node);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (node != null) {\n\t\t\t\tif (graph_input_node.add_graph_input(node)) {\n\t\t\t\t\t// we do test if we can create the graph connection\n\t\t\t\t\t// to ensure we are not in a cyclical graph,\n\t\t\t\t\t// but we delete it right after\n\t\t\t\t\tif (!this._depends_on_inputs) {\n\t\t\t\t\t\tgraph_input_node.remove_graph_input(node);\n\t\t\t\t\t}\n\n\t\t\t\t\t//this._input_connections[input_index] = new NodeConnection(node, this.self, output_index, input_index);\n\t\t\t\t\tif (old_connection) {\n\t\t\t\t\t\told_connection.disconnect({set_input: false});\n\t\t\t\t\t}\n\t\t\t\t\tthis._inputs[input_index] = node;\n\t\t\t\t\tnew NodeConnection(node, this.node, output_index, input_index);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(`cannot connect ${node.full_path()} to ${this.node.full_path()}`);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._inputs[input_index] = null;\n\t\t\t\tif (old_connection) {\n\t\t\t\t\told_connection.disconnect({set_input: false});\n\t\t\t\t}\n\t\t\t\t// this._input_connections[input_index] = null;\n\t\t\t}\n\n\t\t\tthis.run_hooks();\n\t\t\tthis.node.set_dirty(node);\n\t\t\tthis.node.emit(NodeEvent.INPUTS_UPDATED);\n\t\t}\n\t}\n\t// TODO: make hooks like post set dirty hooks\n\t// post_set_input() {} // TODO: typescript: handle hook\n\t//\n\tadd_hook(hook: OnUpdateHook) {\n\t\tthis._on_update_hooks = this._on_update_hooks || [];\n\t\tthis._on_update_hooks.push(hook);\n\t}\n\trun_hooks() {\n\t\tif (this._on_update_hooks) {\n\t\t\tfor (let hook of this._on_update_hooks) {\n\t\t\t\thook();\n\t\t\t}\n\t\t}\n\t}\n\n\tremove_input(node: T) {\n\t\tlodash_each(this.inputs(), (input, index) => {\n\t\t\tif (input != null && node != null) {\n\t\t\t\tif (input.graph_node_id === node.graph_node_id) {\n\t\t\t\t\tthis.set_input(index, null);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tinput(input_index: number): T | null {\n\t\treturn this._inputs[input_index];\n\t}\n\t// TODO: the named_input and named_output API really needs to change\n\tnamed_input(input_name: string): T | null {\n\t\tif (this.has_named_inputs) {\n\t\t\tconst input_index = this.get_input_index(input_name);\n\t\t\treturn this._inputs[input_index];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\tnamed_input_connection_point(input_name: string): BaseNamedConnectionPointType | undefined {\n\t\tif (this.has_named_inputs && this._named_input_connection_points) {\n\t\t\tconst input_index = this.get_input_index(input_name);\n\t\t\treturn this._named_input_connection_points[input_index];\n\t\t}\n\t}\n\thas_named_input(name: string): boolean {\n\t\treturn this.get_named_input_index(name) >= 0;\n\t}\n\thas_input(input_index: number): boolean {\n\t\treturn this._inputs[input_index] != null;\n\t}\n\tinputs() {\n\t\treturn this._inputs;\n\t}\n\n\t// outputs(): BaseNode[] {\n\t// \treturn lodash_filter(this.self.graph_successors(), successor=> {\n\t// \t\tif (successor.is_a(Node)) {\n\t// \t\t\treturn lodash_includes(successor.inputs(), this.self);\n\t// \t\t}\n\t// \t});\n\t// }\n\n\t// clonable states\n\toverride_clonable_state_allowed() {\n\t\tlet value = false;\n\t\tfor (let state of this.inputs_clonable_state()) {\n\t\t\tif (state == InputCloneMode.FROM_NODE) {\n\t\t\t\tvalue = true;\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tinputs_clonable_state(): InputCloneMode[] {\n\t\treturn (this._inputs_clonable_states = this._inputs_clonable_states || this.init_inputs_clonable_state());\n\t}\n\tinput_cloned(index: number): boolean {\n\t\treturn this.input_clonable_state_with_override(index);\n\t}\n\tinputs_clonable_state_with_override(): boolean[] {\n\t\tconst list = [];\n\t\tconst states = this.inputs_clonable_state();\n\t\tfor (let i = 0; i < states.length; i++) {\n\t\t\tlist.push(this.input_clonable_state_with_override(i));\n\t\t}\n\t\treturn list;\n\t}\n\tinput_clonable_state_with_override(index: number): boolean {\n\t\tconst states = this.inputs_clonable_state();\n\t\t// for (let i = 0; i < states.length; i++) {\n\t\t// TODO: typescript: not sure if this loop was justified\n\t\tconst state = states[index];\n\t\tswitch (state) {\n\t\t\tcase InputCloneMode.ALWAYS:\n\t\t\t\treturn true;\n\t\t\tcase InputCloneMode.NEVER:\n\t\t\t\treturn false;\n\t\t\tcase InputCloneMode.FROM_NODE:\n\t\t\t\treturn !this._override_clonable_state;\n\t\t\t// default:\n\t\t\t// \tthrow new Error('unsupported type');\n\t\t}\n\t\treturn TypeAssert.unreachable(state);\n\t\t// }\n\t}\n\n\tinit_inputs_clonable_state(values: InputCloneMode[] | null = null) {\n\t\tif (values) {\n\t\t\tthis._user_inputs_clonable_states = values;\n\t\t}\n\t\tthis._inputs_clonable_states = this._user_inputs_clonable_states || this._default_inputs_clonale_state_values();\n\n\t\treturn this._inputs_clonable_states;\n\t}\n\tprivate _default_inputs_clonale_state_values() {\n\t\tconst list = [];\n\t\tfor (let i = 0; i < this._max_inputs_count; i++) {\n\t\t\t// lodash_times(this.self._max_inputs_count, (i)=>{\n\t\t\tlist.push(InputCloneMode.ALWAYS);\n\t\t}\n\t\treturn list;\n\t}\n\n\tset_override_clonable_state(state: boolean) {\n\t\tthis._override_clonable_state = state;\n\t\tthis.node.emit(NodeEvent.OVERRIDE_CLONABLE_STATE_UPDATE);\n\t}\n\toverride_clonable_state() {\n\t\treturn this._override_clonable_state;\n\t}\n}\n","import {BaseNodeType} from '../../_Base';\n// import {_Math} from 'three/src/math/Math';\n\n// export enum ConnectionType {\n// \tGEOMETRY = 'geometry',\n// \tMATRIX = 'matrix',\n// \tINT = 'int',\n// \tFLOAT = 'float',\n// \tBOOL = 'bool',\n// \tVEC2 = 'vec2',\n// \tVEC3 = 'vec3',\n// \tVEC4 = 'vec4',\n// \tMAT3 = 'mat3',\n// \tRGB = 'rgb',\n// \tRGBA = 'rgba',\n// }\n\ninterface DisconnectionOptions {\n\tset_input?: boolean;\n}\n\nexport class NodeConnection {\n\tprivate static _next_id: number = 0;\n\tprivate _id: number;\n\n\tconstructor(\n\t\tprivate _node_src: BaseNodeType,\n\t\tprivate _node_dest: BaseNodeType,\n\t\tprivate _output_index: number = 0,\n\t\tprivate _input_index: number = 0\n\t) {\n\t\tthis._id = NodeConnection._next_id++;\n\n\t\tif (this._node_src.io.connections && this._node_dest.io.connections) {\n\t\t\tthis._node_src.io.connections.add_output_connection(this);\n\t\t\tthis._node_dest.io.connections.add_input_connection(this);\n\t\t}\n\t}\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget node_src() {\n\t\treturn this._node_src;\n\t}\n\tget node_dest() {\n\t\treturn this._node_dest;\n\t}\n\tget output_index() {\n\t\treturn this._output_index;\n\t}\n\tget input_index() {\n\t\treturn this._input_index;\n\t}\n\n\tdisconnect(options: DisconnectionOptions = {}) {\n\t\tif (this._node_src.io.connections && this._node_dest.io.connections) {\n\t\t\tthis._node_src.io.connections.remove_output_connection(this);\n\t\t\tthis._node_dest.io.connections.remove_input_connection(this);\n\t\t}\n\n\t\tif (options.set_input === true) {\n\t\t\tthis._node_dest.io.inputs.set_input(this._input_index, null);\n\t\t}\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseNamedConnectionPointType} from './NamedConnectionPoint';\nimport lodash_isNumber from 'lodash/isNumber';\nimport lodash_uniq from 'lodash/uniq';\nimport lodash_isString from 'lodash/isString';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\n// interface OutputsOptions {\n// \thas_outputs?: boolean;\n// }\n// TODO: remove the \"throw\" statements, which seem less necessary now with typescript\nexport class OutputsController<T extends BaseNodeType> {\n\tprivate _has_outputs: boolean = false;\n\tprivate _named_output_connection_points: BaseNamedConnectionPointType[] | undefined;\n\tprivate _has_named_outputs: boolean = false;\n\n\tconstructor(private node: T) {}\n\n\t// init(options?: OutputsOptions) {\n\t// \tif (options == null) {\n\t// \t\toptions = {};\n\t// \t}\n\t// \tif (options['has_outputs'] == null) {\n\t// \t\toptions['has_outputs'] = true;\n\t// \t}\n\t// \tthis._has_outputs = options['has_outputs'];\n\t// }\n\tset_has_one_output() {\n\t\tthis._has_outputs = true;\n\t}\n\tset_has_no_output() {\n\t\tthis._has_outputs = false;\n\t}\n\n\tget has_outputs() {\n\t\treturn this._has_outputs;\n\t}\n\tget has_named_outputs() {\n\t\treturn this._has_named_outputs;\n\t}\n\thas_named_output(name: string): boolean {\n\t\t// return this._get_named_output_index_without_error(name) != null;\n\t\treturn this.get_named_output_index(name) >= 0;\n\t}\n\tget named_output_connection_points(): BaseNamedConnectionPointType[] {\n\t\treturn this._named_output_connection_points || [];\n\t}\n\tnamed_output_connection(index: number): BaseNamedConnectionPointType | undefined {\n\t\tif (this._named_output_connection_points) {\n\t\t\treturn this._named_output_connection_points[index];\n\t\t}\n\t}\n\t// protected _get_named_output_index_without_error(name: string): number {\n\t// \tconst connections = this.named_output_connection_points;\n\t// \tfor (let i = 0; i < connections.length; i++) {\n\t// \t\tconst connection = connections[i];\n\t// \t\tif (connection.name == name) {\n\t// \t\t\treturn i;\n\t// \t\t}\n\t// \t}\n\t// \treturn -1;\n\t// }\n\tget_named_output_index(name: string): number {\n\t\tif (this._named_output_connection_points) {\n\t\t\tfor (let i = 0; i < this._named_output_connection_points.length; i++) {\n\t\t\t\tif (this._named_output_connection_points[i].name == name) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\n\t\t// const index = this._get_named_output_index_without_error(name);\n\t\t// if (index == null) {\n\t\t// \tconst connection_points = this.named_output_connection_points;\n\t\t// \tconst available_names = connection_points.map((o) => o.name).join(', ');\n\t\t// \tthrow new Error(`no outputs named '${name}'. available names are ${available_names}`);\n\t\t// }\n\t\t// return index;\n\t}\n\tget_output_index(output_index_or_name: number | string): number {\n\t\tif (output_index_or_name != null) {\n\t\t\tif (lodash_isString(output_index_or_name)) {\n\t\t\t\tif (this.has_named_outputs) {\n\t\t\t\t\treturn this.get_named_output_index(output_index_or_name);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(`node ${this.node.full_path()} has no named outputs`);\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn output_index_or_name;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\n\tnamed_output_connection_points_by_name(name: string): BaseNamedConnectionPointType | undefined {\n\t\tif (this._named_output_connection_points) {\n\t\t\tfor (let connection_point of this._named_output_connection_points) {\n\t\t\t\tif (connection_point.name == name) {\n\t\t\t\t\treturn connection_point;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tset_named_output_connection_points(connection_points: BaseNamedConnectionPointType[]) {\n\t\tthis._has_named_outputs = true;\n\t\tthis._named_output_connection_points = connection_points;\n\t\tif (this.node.scene) {\n\t\t\tthis.node.set_dirty(this.node);\n\t\t}\n\t\tthis.node.emit(NodeEvent.NAMED_OUTPUTS_UPDATED);\n\t}\n\tused_output_names(): string[] {\n\t\tif (this.node.io.connections) {\n\t\t\tconst output_indices = lodash_uniq(\n\t\t\t\tthis.node.io.connections\n\t\t\t\t\t.output_connections()\n\t\t\t\t\t.map((connection) => (connection ? connection.output_index : null))\n\t\t\t);\n\t\t\tconst used_output_indices: number[] = [];\n\t\t\toutput_indices.forEach((index) => {\n\t\t\t\tif (lodash_isNumber(index)) {\n\t\t\t\t\tused_output_indices.push(index);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst used_output_names: string[] = used_output_indices.map((index) => {\n\t\t\t\treturn this.named_output_connection_points[index].name;\n\t\t\t});\n\t\t\treturn used_output_names;\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n}\n","import {NodeParamsConfig} from './ParamsConfig';\n// import {ParamValuesTypeMap} from './ParamsController';\n// import {ParamType} from 'src/engine/poly/ParamType';\n\n// function getProperty<T, K extends keyof T>(o: T, propertyName: K): T[K] {\n// \treturn o[propertyName]; // o[propertyName] is of type T[K]\n// }\n\n// let t: getProperty(ParamConfig, 'type')\n// function prop<T, K extends keyof T>(obj: T, key: K) {\n// \treturn typeof obj[key];\n// }\n// type test = Pick<ParamConfig<ParamType.FLOAT>, 'default_value'>;\n\nexport type ParamsAccessorType<T extends NodeParamsConfig> = {\n\treadonly [P in keyof T]: T[P]['param_class'];\n};\n\nexport class ParamsAccessor<T extends NodeParamsConfig> {\n\tconstructor() {\n\t\t// console.log('accessor', this);\n\t}\n}\n","import {TypedContainer} from './_Base';\nimport {ContainableMap} from './utils/ContainableMap';\n\nexport class ManagerContainer extends TypedContainer<ContainableMap['MANAGER']> {\n\tset_content(content: ContainableMap['MANAGER']) {\n\t\tsuper.set_content(content);\n\t}\n}\n","import lodash_uniq from 'lodash/uniq';\nimport lodash_clone from 'lodash/clone';\nimport lodash_sortBy from 'lodash/sortBy';\nimport {PerformanceNode} from './PerformanceNode';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class CorePerformance {\n\tprivate _started: boolean = false;\n\t_start_time: number | null = 0;\n\t_previous_timestamp: number = 0;\n\t_nodes_cook_data: Dictionary<PerformanceNode> = {};\n\t_durations_by_name: Dictionary<number> = {};\n\t_durations_count_by_name: Dictionary<number> = {};\n\t// _performance_id: number;\n\n\t// constructor(){\n\t// \tconsole.log(\"creating perf\")\n\t// \tthis._performance_id = Math.random()\n\t// }\n\n\tprofile(name: string, method: (args?: any) => any) {\n\t\tconst start_time = performance.now();\n\t\tmethod();\n\t\tconst total_time = performance.now() - start_time;\n\t\tconsole.log(`${name}: ${total_time}`);\n\t}\n\n\tstart() {\n\t\tif (!this._started) {\n\t\t\tthis.reset();\n\t\t\tthis._started = true;\n\t\t\tthis._start_time = performance.now();\n\t\t\tthis._nodes_cook_data = {};\n\t\t\tthis._previous_timestamp = this._start_time;\n\t\t}\n\t}\n\t// else\n\t// \tthrow \"performance already started\"\n\tstop() {\n\t\tthis.reset();\n\t}\n\treset() {\n\t\tthis._started = false;\n\t\tthis._start_time = null;\n\t\tthis._durations_by_name = {};\n\t\tthis._durations_count_by_name = {};\n\t\tthis._nodes_cook_data = {};\n\t}\n\n\tget started(): boolean {\n\t\treturn this._started;\n\t}\n\n\trecord_node_cook_data(node: BaseNodeType) {\n\t\tconst id = node.graph_node_id;\n\t\tif (this._nodes_cook_data[id] == null) {\n\t\t\tthis._nodes_cook_data[id] = new PerformanceNode(node);\n\t\t}\n\t\tthis._nodes_cook_data[id].update_cook_data();\n\t}\n\n\trecord(name: string) {\n\t\tif (!this.started) {\n\t\t\tthis.start();\n\t\t}\n\n\t\tconst current_timestamp = performance.now();\n\n\t\tif (this._durations_by_name[name] == null) {\n\t\t\tthis._durations_by_name[name] = 0;\n\t\t}\n\t\tthis._durations_by_name[name] += current_timestamp - this._previous_timestamp;\n\t\tif (this._durations_count_by_name[name] == null) {\n\t\t\tthis._durations_count_by_name[name] = 0;\n\t\t}\n\t\tthis._durations_count_by_name[name] += 1;\n\n\t\treturn (this._previous_timestamp = current_timestamp);\n\t}\n\n\tprint() {\n\t\tthis.print_node_cook_data();\n\t\tthis.print_recordings();\n\t}\n\n\tprint_node_cook_data() {\n\t\tlet performance_nodes = Object.values(this._nodes_cook_data);\n\t\tperformance_nodes = lodash_sortBy(performance_nodes, (performance_node) => -performance_node.cook_time_total);\n\n\t\tconst print_objects = performance_nodes.map((performance_node) => performance_node.print_object());\n\n\t\tconsole.log('--------------- NODES COOK TIME -----------');\n\n\t\tconst table_entries = [];\n\t\tconst sorted_print_objects = lodash_sortBy(print_objects, (print_object) => -print_object['cook_time_total']);\n\t\tfor (let print_object of sorted_print_objects) {\n\t\t\ttable_entries.push(print_object);\n\t\t}\n\n\t\tconsole.table(table_entries);\n\n\t\treturn print_objects;\n\t}\n\n\tprint_recordings() {\n\t\t// const start_time = this._start_time\n\t\tconst durations_by_name = lodash_clone(this._durations_by_name);\n\t\tconst durations_count_by_name = lodash_clone(this._durations_count_by_name);\n\t\t//this.reset()\n\n\t\tconst durations = [];\n\t\t//durations_by_name = {}\n\t\tconst names_by_duration: Dictionary<string[]> = {};\n\n\t\tfor (let name of Object.keys(durations_by_name)) {\n\t\t\tconst duration = durations_by_name[name];\n\n\t\t\t//durations_by_name[name] = duration\n\t\t\tdurations.push(duration);\n\t\t\tif (names_by_duration[duration] == null) {\n\t\t\t\tnames_by_duration[duration] = [];\n\t\t\t}\n\t\t\tnames_by_duration[duration].push(name);\n\t\t}\n\n\t\tdurations.sort((a, b) => a - b);\n\t\tconst sorted_durations = lodash_uniq(durations);\n\n\t\tconsole.log('--------------- PERF RECORDINGS -----------');\n\t\t//console.log(\"sorted_durations\", sorted_durations)\n\t\t// let previous_duration = start_time\n\t\tconst table_entries = [];\n\t\tfor (let duration of sorted_durations) {\n\t\t\tconst names = names_by_duration[duration];\n\t\t\tfor (let name of names) {\n\t\t\t\tconst count = durations_count_by_name[name];\n\t\t\t\tconst duration_per_iteration = duration / count;\n\n\t\t\t\tconst entry = {duration, name, count, duration_per_iteration};\n\t\t\t\ttable_entries.push(entry);\n\t\t\t}\n\n\t\t\t// previous_duration = duration\n\t\t}\n\n\t\tconsole.table(table_entries);\n\t\treturn table_entries;\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class PerformanceNode {\n\t_cooks_count: number = 0;\n\t_cook_time_total: number = 0;\n\t_cook_time_total_with_inputs: number = 0;\n\t_cook_time_total_params: number = 0;\n\tconstructor(private _node: BaseNodeType) {}\n\n\tupdate_cook_data(): void {\n\t\tthis._cooks_count += 1;\n\t\tthis._cook_time_total += this._node.cook_controller.cook_time;\n\t\tthis._cook_time_total_with_inputs += this._node.cook_controller.cook_time_with_inputs;\n\t\tthis._cook_time_total_params += this._node.cook_controller.cook_time_params;\n\t}\n\n\tget cook_time_total(): number {\n\t\treturn this._cook_time_total;\n\t}\n\tget cook_time_per_iteration(): number {\n\t\tif (this._cooks_count > 0) {\n\t\t\treturn this._cook_time_total / this._cooks_count;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tget cook_time_total_with_inputs(): number {\n\t\treturn this._cook_time_total_with_inputs;\n\t}\n\tget cook_time_total_with_inputs_per_iteration(): number {\n\t\tif (this._cooks_count > 0) {\n\t\t\treturn this._cook_time_total_with_inputs / this._cooks_count;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tget cook_time_total_params(): number {\n\t\treturn this._cook_time_total_params;\n\t}\n\tget cook_time_total_params_per_iteration(): number {\n\t\tif (this._cooks_count > 0) {\n\t\t\treturn this._cook_time_total_params / this._cooks_count;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tget cooks_count(): number {\n\t\treturn this._cooks_count;\n\t}\n\n\tprint_object() {\n\t\treturn {\n\t\t\tfull_path: this._node.full_path(),\n\t\t\tcooks_count: this.cooks_count,\n\t\t\tcook_time_total: this.cook_time_total,\n\t\t\tcook_time_per_iteration: this.cook_time_per_iteration,\n\t\t\tcook_time_total_with_inputs: this.cook_time_total_with_inputs,\n\t\t\tcook_time_total_with_inputs_per_iteration: this.cook_time_total_with_inputs_per_iteration,\n\t\t\tcook_time_total_params: this.cook_time_total_params,\n\t\t\tcook_time_total_params_per_iteration: this.cook_time_total_params_per_iteration,\n\t\t};\n\t}\n}\n","// import {SceneContext} from 'src/core/context/Scene';\nimport {PolyScene} from '../PolyScene';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {SceneEvent} from 'src/engine/poly/SceneEvent';\n// import {BaseNode} from 'src/engine/nodes/_Base'\n\ntype FrameRange = [number, number];\n\nexport class TimeController {\n\tprotected self: PolyScene = (<unknown>this) as PolyScene;\n\tprivate _frame: number = 1;\n\tprivate _graph_node: CoreGraphNode;\n\tprivate _frame_range: FrameRange = [1, 600];\n\tprivate _frame_range_locked: [boolean, boolean] = [true, true];\n\tprivate _playing: boolean = false;\n\tprivate _fps: number = 60;\n\tprivate _frame_interval: number = 1000 / 60;\n\tprivate _next_frame_bound = this.play_next_frame.bind(this);\n\n\tconstructor(private scene: PolyScene) {\n\t\tthis._graph_node = new CoreGraphNode(scene, 'time controller');\n\t\t// this._graph_node.set_scene(this.scene);\n\t}\n\tget graph_node() {\n\t\treturn this._graph_node;\n\t}\n\n\t// init() {\n\t// \tthis._context = new SceneContext();\n\t// \tthis._context.set_scene(this.scene);\n\n\t// \tthis.set_frame_range(1, 240); //100 - 288*100-100\n\t// \tthis.set_fps(60);\n\t// }\n\t// context() {\n\t// \treturn this._context;\n\t// }\n\tget fps(): number {\n\t\treturn this._fps;\n\t}\n\tget frame(): number {\n\t\treturn this._frame;\n\t}\n\tget time(): number {\n\t\treturn this._frame / this._fps;\n\t}\n\tget frame_range(): FrameRange {\n\t\treturn this._frame_range;\n\t}\n\tget frame_range_locked(): [boolean, boolean] {\n\t\treturn this._frame_range_locked;\n\t}\n\tset_frame_range(start_frame: number, end_frame: number) {\n\t\tthis._frame_range[0] = Math.floor(start_frame);\n\t\tthis._frame_range[1] = Math.floor(end_frame);\n\t\tthis.scene.events_controller.dispatch(this._graph_node, SceneEvent.FRAME_RANGE_UPDATED);\n\t}\n\tset_frame_range_locked(start_locked: boolean, end_locked: boolean) {\n\t\tthis._frame_range_locked[0] = start_locked;\n\t\tthis._frame_range_locked[1] = end_locked;\n\t\tthis.scene.events_controller.dispatch(this._graph_node, SceneEvent.FRAME_RANGE_UPDATED);\n\t}\n\tset_fps(fps: number) {\n\t\tthis._fps = Math.floor(fps);\n\t\tthis._frame_interval = 1000 / this._fps;\n\t\tthis.scene.events_controller.dispatch(this._graph_node, SceneEvent.FRAME_RANGE_UPDATED);\n\t}\n\n\tset_frame(frame: number) {\n\t\tframe = this._ensure_frame_within_bounds(frame);\n\t\tif (frame != this.frame) {\n\t\t\tthis._frame = frame;\n\t\t\tthis.scene.events_controller.dispatch(this._graph_node, SceneEvent.FRAME_UPDATED);\n\t\t\tthis.scene.uniforms_controller.update_frame_dependent_uniform_owners();\n\n\t\t\t// we block updates here, so that dependent nodes only cook once\n\t\t\tthis.scene.cooker.block();\n\t\t\tthis.graph_node.set_successors_dirty();\n\t\t\tthis.scene.cooker.unblock();\n\t\t}\n\t}\n\tincrement_frame() {\n\t\t// let frame = this._context.frame() + 1;\n\t\t// frame = this._ensure_frame_within_bounds(frame);\n\t\tthis.set_frame(this.frame + 1);\n\t}\n\tdecrement_frame() {\n\t\tthis.set_frame(this.frame - 1);\n\t\t// let frame = this._context.frame() - 1;\n\t\t// frame = this._ensure_frame_within_bounds(frame);\n\t\t// this.set_frame(frame);\n\t}\n\tset_first_frame() {\n\t\tthis.set_frame(this.frame_range[0]);\n\t}\n\t_ensure_frame_within_bounds(frame: number): number {\n\t\tif (this._frame_range_locked[0] && frame < this._frame_range[0]) {\n\t\t\treturn this._frame_range[1];\n\t\t}\n\t\tif (this._frame_range_locked[1] && frame > this._frame_range[1]) {\n\t\t\treturn this._frame_range[0];\n\t\t}\n\t\treturn frame;\n\t}\n\tget playing() {\n\t\treturn this._playing === true;\n\t}\n\tpause() {\n\t\tthis._playing = false;\n\t\tthis.scene.events_controller.dispatch(this._graph_node, SceneEvent.PLAY_STATE_UPDATED);\n\t}\n\tplay() {\n\t\tif (this._playing !== true) {\n\t\t\tsetTimeout(this.play_next_frame.bind(this), this._frame_interval);\n\t\t}\n\t\tthis._playing = true;\n\t\tthis.scene.events_controller.dispatch(this._graph_node, SceneEvent.PLAY_STATE_UPDATED);\n\t}\n\ttoggle_play_pause() {\n\t\tif (this.playing) {\n\t\t\tthis.pause();\n\t\t} else {\n\t\t\tthis.play();\n\t\t}\n\t}\n\n\t// private _prev_t: number = 0;\n\tplay_next_frame() {\n\t\t// const cur_t = performance.now();\n\t\t// console.log(cur_t - this._prev_t, cur_t, this._frame_interval);\n\t\t// this._prev_t = cur_t;\n\t\t//current_time = performance.now()\n\t\t//if !@_last_time_frame_incremented? || ( (current_time - @_last_time_frame_incremented) > 40 )\n\t\tif (this.playing) {\n\t\t\t//@_last_time_frame_incremented = current_time\n\t\t\tif (!this.scene.root.are_children_cooking()) {\n\t\t\t\tthis.increment_frame();\n\t\t\t}\n\n\t\t\tsetTimeout(this._next_frame_bound, this._frame_interval);\n\t\t}\n\t}\n}\n","import {PolyScene} from '../PolyScene';\nimport {NodeSerializer} from 'src/engine/nodes/utils/Serializer';\n\nexport class PolySceneSerializer {\n\tconstructor(private scene: PolyScene) {}\n\n\tto_json(include_node_param_components: boolean = false) {\n\t\tconst nodes_by_graph_node_id: Dictionary<object> = {};\n\t\tconst params_by_graph_node_id: Dictionary<object> = {};\n\n\t\tfor (let node of this.scene.nodes_controller.all_nodes()) {\n\t\t\tconst node_serializer = new NodeSerializer(node);\n\t\t\tnodes_by_graph_node_id[node.graph_node_id] = node_serializer.to_json(include_node_param_components);\n\n\t\t\tconst params = node.params.all; //lodash_compact(lodash_concat( lodash_values(node.params()), lodash_values(node.spare_params()) ));\n\t\t\tfor (let param of params) {\n\t\t\t\tparams_by_graph_node_id[param.graph_node_id] = param.to_json();\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tnodes_by_graph_node_id,\n\t\t\tparams_by_graph_node_id,\n\t\t};\n\t}\n}\n","import {PolyScene} from '../PolyScene';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {IUniform} from 'three/src/renderers/shaders/UniformsLib';\n\ntype IUniforms = Dictionary<IUniform>;\nexport interface IUniformsWithFrame extends IUniforms {\n\tframe: IUniform;\n}\nexport interface IUniformsWithResolution extends IUniforms {\n\tresolution: {\n\t\tvalue: Vector2Like;\n\t};\n}\n\nexport class UniformsController {\n\tconstructor(private scene: PolyScene) {}\n\n\tprivate _frame_dependent_uniform_owners: Dictionary<IUniformsWithFrame> = {}; //new Map()\n\tprivate _frame_dependent_uniform_owners_ids: string[] | null = null;\n\n\tprivate _resolution: Vector2 = new Vector2(1, 1);\n\tprivate _resolution_dependent_uniform_owners: Dictionary<IUniformsWithResolution> = {};\n\tprivate _resolution_dependent_uniform_owners_ids: string[] = [];\n\n\t// frame\n\tadd_frame_dependent_uniform_owner(id: string, uniforms: IUniformsWithFrame) {\n\t\tthis._frame_dependent_uniform_owners[id] = uniforms;\n\t\tthis._update_frame_dependent_uniform_owners_ids();\n\t}\n\tremove_frame_dependent_uniform_owner(id: string) {\n\t\tdelete this._frame_dependent_uniform_owners[id];\n\t\tthis._update_frame_dependent_uniform_owners_ids();\n\t}\n\tprotected _update_frame_dependent_uniform_owners_ids() {\n\t\tthis._frame_dependent_uniform_owners_ids = Object.keys(this._frame_dependent_uniform_owners);\n\t}\n\tpublic update_frame_dependent_uniform_owners() {\n\t\tconst frame = this.scene.frame;\n\t\tif (this._frame_dependent_uniform_owners_ids) {\n\t\t\tfor (let id of this._frame_dependent_uniform_owners_ids) {\n\t\t\t\tconst uniforms = this._frame_dependent_uniform_owners[id];\n\t\t\t\tuniforms.frame.value = frame;\n\t\t\t}\n\t\t}\n\t}\n\n\t// resolution\n\tadd_resolution_dependent_uniform_owner(id: string, uniforms: IUniformsWithResolution) {\n\t\tthis._resolution_dependent_uniform_owners[id] = uniforms;\n\t\tthis._update_resolution_dependent_uniform_owners_ids();\n\t\tif (this._resolution) {\n\t\t\tthis.update_resolution_dependent_uniforms(uniforms);\n\t\t}\n\t}\n\tremove_resolution_dependent_uniform_owner(id: string) {\n\t\tdelete this._resolution_dependent_uniform_owners[id];\n\t\tthis._update_resolution_dependent_uniform_owners_ids();\n\t}\n\tprotected _update_resolution_dependent_uniform_owners_ids() {\n\t\tthis._resolution_dependent_uniform_owners_ids = Object.keys(this._resolution_dependent_uniform_owners);\n\t}\n\tupdate_resolution_dependent_uniform_owners(resolution: Vector2) {\n\t\tthis._resolution.copy(resolution);\n\t\tfor (let id of this._resolution_dependent_uniform_owners_ids) {\n\t\t\tconst uniforms = this._resolution_dependent_uniform_owners[id];\n\t\t\tthis.update_resolution_dependent_uniforms(uniforms);\n\t\t}\n\t}\n\tupdate_resolution_dependent_uniforms(uniforms: IUniformsWithResolution) {\n\t\tuniforms.resolution.value.x = this._resolution.x * window.devicePixelRatio;\n\t\tuniforms.resolution.value.y = this._resolution.y * window.devicePixelRatio;\n\t}\n}\n","import {POLY} from 'src/engine/Poly';\n\n// import {PolyScene} from 'src/engine/scene/PolyScene';\n\nexport class WebGLController {\n\tconstructor() {}\n\n\t_require_webgl2: boolean = false;\n\n\trequire_webgl2() {\n\t\treturn this._require_webgl2;\n\t}\n\tset_require_webgl2() {\n\t\tif (!this._require_webgl2) {\n\t\t\tthis._require_webgl2 = true;\n\t\t\tPOLY.renderers_controller.set_require_webgl2();\n\t\t}\n\t}\n}\n","import {CopRegister} from './Cop';\nimport {EventRegister} from './Event';\nimport {GlRegister} from './Gl';\nimport {MatRegister} from './Mat';\nimport {ObjRegister} from './Obj';\nimport {SopRegister} from './Sop';\n\nimport {POLY} from 'src/engine/Poly';\nCopRegister.run(POLY);\nEventRegister.run(POLY);\nGlRegister.run(POLY);\nMatRegister.run(POLY);\nObjRegister.run(POLY);\nSopRegister.run(POLY);\n","import {CATEGORY_COP} from './Category';\n\n// import {BuilderCopNode} from 'src/engine/nodes/cop/Builder';\nimport {EnvMapCopNode} from 'src/engine/nodes/cop/EnvMap';\nimport {FileCopNode} from 'src/engine/nodes/cop/File';\nimport {NullCopNode} from 'src/engine/nodes/cop/Null';\nimport {SwitchCopNode} from 'src/engine/nodes/cop/Switch';\n\nexport interface CopNodeChildrenMap {\n\t// builder: BuilderCopNode;\n\tenv_map: EnvMapCopNode;\n\tfile: FileCopNode;\n\tnull: NullCopNode;\n\tswitch: SwitchCopNode;\n}\n\nimport {Poly} from 'src/engine/Poly';\nexport class CopRegister {\n\tstatic run(poly: Poly) {\n\t\t// poly.register_node(BuilderCopNode, CATEGORY_COP.ADVANCED);\n\t\tpoly.register_node(EnvMapCopNode, CATEGORY_COP.INPUT);\n\t\tpoly.register_node(FileCopNode, CATEGORY_COP.INPUT);\n\t\tpoly.register_node(NullCopNode, CATEGORY_COP.MISC);\n\t\tpoly.register_node(SwitchCopNode, CATEGORY_COP.MISC);\n\t}\n}\n","import {Texture} from 'three/src/textures/Texture';\n// import {NearestFilter} from 'three/src/constants';\n// import {LinearEncoding} from 'three/src/constants';\n// import {HalfFloatType} from 'three/src/constants';\n// import {WebGLRenderTargetCube} from 'three/src/renderers/WebGLRenderTargetCube';\nimport {PMREMGenerator} from 'three/src/extras/PMREMGenerator';\n\n// import NodeBase from '../_Base'\n\nimport {TypedCopNode} from './_Base';\n// import {BaseParam} from 'src/Engine/Param/_Base'\n// import {CoreTextureLoader} from 'src/core/loader/Texture';\n// import { CoreScriptLoader } from \"src/Core/Loader/Script\";\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {POLY} from 'src/engine/Poly';\nclass EnvMapCopParamsConfig extends NodeParamsConfig {\n\t// url = ParamConfig.STRING(CoreTextureLoader.PARAM_DEFAULT, {\n\t// \tdesktop_browse: {file_type: 'texture'},\n\t// });\n}\nconst ParamsConfig = new EnvMapCopParamsConfig();\nexport class EnvMapCopNode extends TypedCopNode<EnvMapCopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'env_map';\n\t}\n\t// static required_three_imports() {\n\t// \treturn [\n\t// \t\t'loaders/EXRLoader',\n\t// \t\t// 'pmrem/PMREMGenerator',\n\t// \t\t// 'pmrem/PMREMCubeUVPacker',\n\t// \t];\n\t// }\n\n\t// private _texture_loader: CoreTextureLoader\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\n\t\t// for now, if I clone the input, it gets messed up\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.NEVER]);\n\t}\n\n\t// create_params() {\n\t// \t// this.add_param(ParamType.STRING, 'url', CoreTextureLoader.PARAM_DEFAULT)\n\t// }\n\n\tasync cook(input_contents: Texture[]) {\n\t\tconst texture = input_contents[0];\n\t\tconst env_map = await this.convert_texture_to_env_map(texture);\n\t\tif (env_map) {\n\t\t\tthis.set_texture(env_map);\n\t\t} else {\n\t\t\tthis.cook_controller.end_cook();\n\t\t}\n\t}\n\n\tprivate async convert_texture_to_env_map(texture: Texture): Promise<Texture | undefined> {\n\t\t// texture.minFilter = NearestFilter;\n\t\t// texture.encoding = LinearEncoding;\n\n\t\tconst renderer = await POLY.renderers_controller.wait_for_renderer();\n\t\t// if (!renderer) {\n\t\t// \tawait CoreSleep.sleep(1000);\n\t\t// \tconsole.log('waited 1s');\n\t\t// \trenderer = POLY.renderers_controller.first_renderer();\n\t\t// \tconsole.log('renderer', renderer, texture);\n\t\t// }\n\n\t\tif (renderer) {\n\t\t\tconst pmremGenerator = new PMREMGenerator(renderer);\n\t\t\t// console.log('env inout', texture);\n\t\t\tconst exrCubeRenderTarget = pmremGenerator.fromEquirectangular(texture);\n\n\t\t\t// pmremGenerator.dispose();\n\t\t\t// texture.dispose();\n\t\t\t// console.log('exrCubeRenderTarget.texture', exrCubeRenderTarget.texture);\n\t\t\tconst env_map_texture = exrCubeRenderTarget.texture;\n\t\t\t// (window.scene as any).background = env_map_texture;\n\t\t\t// (window.scene as any).environment = env_map_texture;\n\t\t\treturn env_map_texture;\n\t\t} else {\n\t\t\tthis.states.error.set('no renderer found to convert the texture to an env map');\n\t\t}\n\t}\n}\n","import {TypedContainer} from './_Base';\nimport {ContainableMap} from './utils/ContainableMap';\n\nexport class TextureContainer extends TypedContainer<ContainableMap['TEXTURE']> {\n\t// _content: Texture;\n\tset_content(content: ContainableMap['TEXTURE']) {\n\t\tsuper.set_content(content);\n\t}\n\n\t// set_texture(texture: Texture){\n\t// \tif (this._content != null) {\n\t// \t\tthis._content.dispose();\n\t// \t}\n\t// \tthis.set_content(texture);\n\t// }\n\ttexture(): ContainableMap['TEXTURE'] {\n\t\treturn this._content;\n\t}\n\tcore_content(): ContainableMap['TEXTURE'] {\n\t\treturn this._content;\n\t}\n\tcore_content_cloned(): ContainableMap['TEXTURE'] | undefined {\n\t\tconsole.log('clone', this._content);\n\t\tconst texture = this._content?.clone();\n\t\tif (texture) {\n\t\t\ttexture.needsUpdate = true;\n\t\t}\n\t\treturn texture;\n\t}\n\n\tobject() {\n\t\treturn this.texture();\n\t}\n\n\tinfos() {\n\t\tif (this._content != null) {\n\t\t\treturn [this._content];\n\t\t}\n\t}\n\tresolution(): [number, number] {\n\t\tif (this._content) {\n\t\t\tif (this._content.image) {\n\t\t\t\treturn [this._content.image.width, this._content.image.height];\n\t\t\t}\n\t\t}\n\t\treturn [-1, -1];\n\t}\n}\n","import {BaseFlag} from './Base';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\n// export interface BypassOptions {\n// \thas_bypass_flag?: boolean;\n// }\n\nexport class BypassFlag extends BaseFlag {\n\tprotected _state: boolean = false;\n\ton_update() {\n\t\tthis.node.emit(NodeEvent.FLAG_BYPASS_UPDATED);\n\t\tthis.node.set_dirty();\n\t}\n}\n\n// export function Bypass<TBase extends Constructor>(Base: TBase) {\n// \treturn class Mixin extends Base {\n// \t\tprotected self: BaseNode = (<unknown>this) as BaseNode;\n// \t\t_has_bypass_flag: boolean = true;\n// \t\t_bypass_flag: boolean = false;\n\n// \t\t_init_bypass_flag(options: BypassOptions = {}) {\n// \t\t\tif (options['has_bypass_flag'] == null) {\n// \t\t\t\toptions['has_bypass_flag'] = true;\n// \t\t\t}\n\n// \t\t\tthis._has_bypass_flag = options['has_bypass_flag'];\n// \t\t\tthis._bypass_flag = false;\n// \t\t}\n\n// \t\thas_bypass_flag(): boolean {\n// \t\t\treturn this._has_bypass_flag;\n// \t\t}\n\n// \t\tis_bypassed(): boolean {\n// \t\t\treturn this._bypass_flag;\n// \t\t}\n\n// \t\tset_bypass_flag(state: boolean) {\n// \t\t\tif (state == null) {\n// \t\t\t\tstate = true;\n// \t\t\t}\n// \t\t\tif (state !== this._bypass_flag) {\n// \t\t\t\tthis._bypass_flag = state;\n// \t\t\t\tthis.self.emit('bypass_flag_update');\n// \t\t\t\tthis.self.set_dirty();\n// \t\t\t\t// this.post_set_bypass_flag()\n// \t\t\t}\n// \t\t}\n\n// \t\t// post_process_container_request_as_bypassed(input_node: BaseNode){}\n// \t\t// post_set_bypass_flag(){}\n\n// \t\ttoggle_bypass_flag() {\n// \t\t\tthis.set_bypass_flag(!this.is_bypassed());\n// \t\t}\n// \t};\n// }\n","import {BaseFlag} from './Base';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\nexport class DisplayFlag extends BaseFlag {\n\ton_update() {\n\t\tthis.node.emit(NodeEvent.FLAG_DISPLAY_UPDATED);\n\t\t// this.node.set_dirty();\n\t}\n}\n","import {VideoTexture} from 'three/src/textures/VideoTexture';\nimport {TextureLoader} from 'three/src/loaders/TextureLoader';\nimport {Texture} from 'three/src/textures/Texture';\n// import {RepeatWrapping} from 'three/src/constants';\n// import {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\n// import lodash_isArray from 'lodash/isArray';\n// import {CoreScriptLoader} from 'src/core/loader/Script';\n// import {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {UnsignedByteType} from 'three/src/constants';\nimport {CoreWalker} from 'src/core/Walker';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {BaseCopNodeClass} from 'src/engine/nodes/cop/_Base';\nimport {TextureContainer} from 'src/engine/containers/Texture';\nimport {POLY} from 'src/engine/Poly';\n// import {BufferGeometry} from 'three/src/core/BufferGeometry';\n\ninterface VideoSourceTypeByExt {\n\togg: string;\n\togv: string;\n\tmp4: string;\n}\n// interface ImageScriptUrlByExt {\n// \texr: string;\n// \tbasis: string;\n// }\ninterface ThreeLoaderByExt {\n\texr: string;\n\tbasis: string;\n\thdr: string;\n}\n\nenum Extension {\n\tEXR = 'exr',\n\tBASIS = 'basis',\n\tHDR = 'hdr',\n}\n\nexport class CoreTextureLoader {\n\tstatic PARAM_DEFAULT = '/examples/textures/uv.jpg';\n\tstatic PARAM_ENV_DEFAULT = '/examples/textures/piz_compressed.exr';\n\n\tstatic VIDEO_EXTENSIONS = ['mp4', 'webm', 'ogv'];\n\tstatic VIDEO_SOURCE_TYPE_BY_EXT: VideoSourceTypeByExt = {\n\t\togg: 'video/ogg; codecs=\"theora, vorbis\"',\n\t\togv: 'video/ogg; codecs=\"theora, vorbis\"',\n\t\tmp4: 'video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"',\n\t};\n\t// static SCRIPT_URL_BY_EXT: ImageScriptUrlByExt = {\n\t// \texr: 'EXRLoader',\n\t// \tbasis: 'BasisTextureLoader',\n\t// };\n\t// static THREE_LOADER_BY_EXT: ThreeLoaderByExt = {\n\t// \texr: 'EXRLoader',\n\t// \tbasis: 'BasisTextureLoader',\n\t// };\n\t// @load_texture: (url, callback)->\n\t// \tif url\n\t// \t\tloader = this._texture_loader(url)\n\n\t// \t\tloader.load(\n\t// \t\t\turl,\n\t// \t\t\tcallback,\n\t// \t\t\tnull,\n\t// \t\t\t(error)=>\n\t// \t\t\t\tthis.set_error(\"could not load texture #{url}\")\n\t// \t\t\t\t#this._on_error(error)\n\t// \t\t\t)\n\t// \telse\n\t// \t\tthis.set_error(\"not url given to Mat/Base._load_texture\")\n\t// _on_error: (error)->\n\t// \tconsole.log(\"ERROR\")\n\t// \tconsole.log(error)\n\t// \tthis.set_error_message()\n\n\tconstructor(private _node: BaseNodeType, private _param: BaseParamType) {}\n\n\tasync load_texture_from_url_or_op(url: string): Promise<Texture | VideoTexture | null> {\n\t\tlet texture: Texture | null = null;\n\t\tlet found_node;\n\n\t\tif (url.substring(0, 3) == 'op:') {\n\t\t\tconst node_path = url.substring(3);\n\t\t\tfound_node = CoreWalker.find_node(this._node, node_path);\n\t\t\tif (found_node) {\n\t\t\t\tif (found_node instanceof BaseCopNodeClass) {\n\t\t\t\t\tconst container: TextureContainer = await found_node.request_container();\n\t\t\t\t\ttexture = container.texture();\n\t\t\t\t} else {\n\t\t\t\t\tthis._node.states.error.set(`found node is not a texture node`);\n\t\t\t\t}\n\n\t\t\t\t// this._assign_texture(attrib, texture)\n\t\t\t} else {\n\t\t\t\tthis._node.states.error.set(`no node found in path '${node_path}'`);\n\t\t\t}\n\t\t} else {\n\t\t\ttexture = await this.load_url(url);\n\t\t\tif (texture) {\n\t\t\t\t// param.mark_as_referencing_asset(url)\n\t\t\t\tif (this._param.options.texture_as_env()) {\n\t\t\t\t\t// texture = await CoreTextureLoader.set_texture_for_env(texture, this._node);\n\t\t\t\t} else {\n\t\t\t\t\ttexture = CoreTextureLoader.set_texture_for_mapping(texture);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._node.states.error.set(`could not load texture ${url}`);\n\t\t\t}\n\t\t}\n\n\t\t// NOTE: if this._param gets its value from an expression like `ch('/CONTROL/photo_url')`\n\t\t// then found_node will be null, so the graph should not be changed\n\t\tif (found_node && this._param.graph_predecessors()[0] != found_node) {\n\t\t\tthis._param.graph_disconnect_predecessors();\n\t\t\tthis._param.add_graph_input(found_node);\n\t\t}\n\n\t\t// this._assign_texture(attrib, texture)\n\t\treturn texture;\n\t}\n\n\tasync load_url(url: string): Promise<Texture> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\t// url = this._resolve_url(url)\n\t\t\tconst ext = CoreTextureLoader._ext(url);\n\n\t\t\tif (CoreTextureLoader.VIDEO_EXTENSIONS.includes(ext)) {\n\t\t\t\tconst texture: VideoTexture = await this._load_as_video(url);\n\t\t\t\treturn texture;\n\t\t\t} else {\n\t\t\t\tthis.loader_for_ext(ext).then((loader) => {\n\t\t\t\t\tloader.load(url, resolve, undefined, (error: any) => {\n\t\t\t\t\t\tconsole.warn('error', error);\n\t\t\t\t\t\treject();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tasync loader_for_ext(ext: string) {\n\t\tconst ext_lowercase = ext.toLowerCase() as keyof ThreeLoaderByExt;\n\t\t// const script_name = CoreTextureLoader.SCRIPT_URL_BY_EXT[ext_lowercase];\n\t\t// var loader;\n\n\t\tswitch (ext_lowercase) {\n\t\t\tcase Extension.EXR: {\n\t\t\t\tconst {EXRLoader} = await import('modules/three/examples/jsm/loaders/EXRLoader');\n\t\t\t\treturn new EXRLoader();\n\t\t\t}\n\t\t\tcase Extension.HDR: {\n\t\t\t\tconst {RGBELoader} = await import('modules/three/examples/jsm/loaders/RGBELoader');\n\t\t\t\tconst loader = new RGBELoader();\n\t\t\t\tloader.setDataType(UnsignedByteType); // FloatType,HalfFloatType\n\t\t\t\t// loader.setPath('/examples/textures/equirectangular/');\n\t\t\t\treturn loader;\n\t\t\t}\n\t\t\tcase Extension.BASIS: {\n\t\t\t\tconst {BasisTextureLoader} = await import('modules/three/examples/jsm/loaders/BasisTextureLoader');\n\t\t\t\tconst loader = new BasisTextureLoader();\n\t\t\t\tloader.setTranscoderPath('/three/js/libs/basis/');\n\t\t\t\tconst renderer = await POLY.renderers_controller.wait_for_renderer();\n\t\t\t\tif (renderer) {\n\t\t\t\t\tloader.detectSupport(renderer);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn('texture loader found no renderer for basis texture loader');\n\t\t\t\t}\n\t\t\t\treturn loader;\n\t\t\t}\n\t\t}\n\n\t\t// if (script_name) {\n\t\t// const imported_classes = await CoreScriptLoader.load_module_three_loader(script_name)\n\t\t// const imported_classes = await CoreScriptLoader.three_module(`loaders/${script_name}`);\n\t\t// const imported_classes = await import(`modules/three/examples/jsm/loaders/${script_name}`);\n\t\t// const loader_class_name = CoreTextureLoader.THREE_LOADER_BY_EXT[ext_lowercase];\n\t\t// const loader_class = imported_classes[loader_class_name];\n\t\t// if (loader_class) {\n\t\t// \tloader = new loader_class();\n\t\t// \tif (ext == 'basis') {\n\t\t// \t\tloader.setTranscoderPath('/three/js/libs/basis/');\n\t\t// \t\tconst renderer = POLY.renderers_controller.first_renderer();\n\t\t// \t\tloader.detectSupport(renderer);\n\t\t// \t}\n\t\t// }\n\t\t// }\n\t\treturn new TextureLoader();\n\n\t\t// const constructor = (() => { switch (ext) {\n\t\t// \tcase 'exr': return EXRLoader;\n\t\t// \tdefault: return TextureLoader;\n\t\t// } })();\n\t\t// return new constructor();\n\t}\n\n\t_load_as_video(url: string): Promise<VideoTexture> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst video = document.createElement('video');\n\t\t\t// document.body.appendChild(video)\n\t\t\t// video.id = 'video'\n\t\t\t// console.log(\"video\", video)\n\t\t\tvideo.setAttribute('crossOrigin', 'anonymous');\n\t\t\tvideo.setAttribute('autoplay', `${true}`); // to ensure it loads\n\t\t\tvideo.setAttribute('loop', `${true}`);\n\n\t\t\t// wait for onloadedmetadata to ensure that we have a duration\n\t\t\tvideo.onloadedmetadata = function() {\n\t\t\t\tvideo.pause();\n\t\t\t\tconst texture = new VideoTexture(video);\n\t\t\t\tresolve(texture);\n\t\t\t};\n\t\t\t// video.setAttribute('controls', true)\n\t\t\t// video.style=\"display:none\"\n\t\t\tconst source = document.createElement('source');\n\t\t\tconst ext = CoreTextureLoader._ext(url) as keyof VideoSourceTypeByExt;\n\t\t\tlet type: string = CoreTextureLoader.VIDEO_SOURCE_TYPE_BY_EXT[ext];\n\t\t\ttype = type || CoreTextureLoader._default_video_source_type(url);\n\t\t\tsource.setAttribute('type', type);\n\t\t\tsource.setAttribute('src', url);\n\n\t\t\tvideo.appendChild(source);\n\t\t});\n\t}\n\tstatic _default_video_source_type(url: string) {\n\t\tconst ext = this._ext(url);\n\t\treturn `video/${ext}`;\n\t}\n\n\tstatic pixel_data(texture: Texture) {\n\t\tconst img = texture.image;\n\t\tconst canvas = document.createElement('canvas');\n\t\tcanvas.width = img.width;\n\t\tcanvas.height = img.height;\n\t\tconst context = canvas.getContext('2d');\n\t\tif (context) {\n\t\t\tcontext.drawImage(img, 0, 0, img.width, img.height);\n\t\t\treturn context.getImageData(0, 0, img.width, img.height);\n\t\t}\n\t}\n\n\t// TODO: typescript: check what type the pixel_data is\n\t// static pixel_data_to_attribute(pixel_data: Pixel, geometry: BufferGeometry, attrib_name_with_component:string, convert_method: (x:number, y:number, z:number, w:number)=>number) {\n\t// \tconst {data} = pixel_data;\n\t// \tconst geometry_wrapper = new CoreGeometry(geometry);\n\t// \t// TODO: add error if no uvs\n\t// \tconst values = [];\n\t// \tconst points = geometry_wrapper.points();\n\t// \tfor (let point of points) {\n\t// \t\tconst uv = point.attrib_value('uv');\n\t// \t\tconst x = Math.floor((pixel_data.width - 1) * uv.x);\n\t// \t\tconst y = Math.floor((pixel_data.height - 1) * (1 - uv.y));\n\t// \t\tconst i = y * pixel_data.width + x;\n\t// \t\t// const val = data[4*i] / 255.0;\n\t// \t\tif (convert_method) {\n\t// \t\t\tconst val = convert_method(data[4 * i + 0], data[4 * i + 1], data[4 * i + 2], data[4 * i + 3]);\n\t// \t\t\tvalues.push(val);\n\t// \t\t} else {\n\t// \t\t\tvalues.push([data[4 * i + 0], data[4 * i + 1], data[4 * i + 2]]);\n\t// \t\t}\n\t// \t}\n\n\t// \tconst attrib_name_elements = attrib_name_with_component.split('.');\n\t// \tlet attrib_name = attrib_name_elements[0];\n\t// \tlet component_offset = null;\n\t// \tif (attrib_name_elements.length > 1) {\n\t// \t\tconst component = attrib_name_elements[1] as keyof Vector4Like\n\t// \t\tcomponent_offset = {x: 0, y: 1, z: 2, w: 3}[component];\n\t// \t}\n\n\t// \tlet attrib = geometry.attributes[attrib_name];\n\t// \tif (attrib) {\n\t// \t\tconst array = attrib.array;\n\t// \t\tlet index = 0;\n\t// \t\tlet is_array = null;\n\t// \t\tfor (let value of values) {\n\t// \t\t\tif (is_array || lodash_isArray(value)) {\n\t// \t\t\t\tis_array = true;\n\t// \t\t\t\tlet component_index = 0;\n\t// \t\t\t\tfor (let value_c of value) {\n\t// \t\t\t\t\tarray[attrib.itemSize * index + component_index] = value_c;\n\t// \t\t\t\t\tcomponent_index++;\n\t// \t\t\t\t}\n\t// \t\t\t} else {\n\t// \t\t\t\tarray[attrib.itemSize * index + component_offset] = value;\n\t// \t\t\t}\n\t// \t\t\tindex++;\n\t// \t\t}\n\t// \t} else {\n\t// \t\tattrib = geometry.setAttribute(attrib_name, new Float32BufferAttribute(values, 1));\n\t// \t}\n\t// \tattrib.needsUpdate = true;\n\t// }\n\n\tstatic _ext(url: string) {\n\t\tconst elements = url.split('.');\n\t\treturn elements[elements.length - 1].toLowerCase();\n\t}\n\t// static private _resolve_url(url: string):string{\n\t// \tif(url[0] == '/'){\n\t// \t\tconst root_url = POLY.env_is_production() ? 'https://polygonjs.com' : 'http://localhost:5000'\n\t// \t\turl = `${root_url}${url}`\n\t// \t}\n\t// \treturn url\n\t// }\n\n\tstatic set_texture_for_mapping(texture: Texture) {\n\t\t// let val = texture['wrapS']\n\t\t// Object.defineProperty(texture, 'wrapS', {\n\t\t// \tget () {\n\t\t// \t\treturn val // Simply return the cached value\n\t\t// \t},\n\t\t// \tset (newVal) {\n\t\t// \t\tval = newVal // Save the newVal\n\t\t// \t\tconsole.warn(\"set\", newVal)\n\t\t// \t}\n\t\t// })\n\n\t\t// texture.wrapS = RepeatWrapping\n\t\t// texture.wrapT = RepeatWrapping\n\t\t// console.log(\"set_texture_for_mapping\", RepeatWrapping, texture, texture.wrapS)\n\t\treturn texture;\n\t}\n\n\t// static async set_texture_for_env(texture: Texture, registerer: BaseNode) {\n\t// \tif (registerer._registered_env_map) {\n\t// \t\tPOLY.renderers_controller.deregister_env_map(registerer._registered_env_map);\n\t// \t}\n\t// \tregisterer._registered_env_map = await POLY.renderers_controller.register_env_map(texture);\n\t// \treturn registerer._registered_env_map;\n\t// }\n}\n","import {DataTextureLoader} from 'three/src/loaders/DataTextureLoader';\nimport {FloatType} from 'three/src/constants';\nimport {HalfFloatType} from 'three/src/constants';\nimport {LinearEncoding} from 'three/src/constants';\nimport {LinearFilter} from 'three/src/constants';\nimport {NearestFilter} from 'three/src/constants';\nimport {RGBEEncoding} from 'three/src/constants';\nimport {RGBEFormat} from 'three/src/constants';\nimport {RGBFormat} from 'three/src/constants';\nimport {UnsignedByteType} from 'three/src/constants';\n/**\n * @author Nikos M. / https://github.com/foo123/\n */\n\n\n// https://github.com/mrdoob/three.js/issues/5552\n// http://en.wikipedia.org/wiki/RGBE_image_format\n\nvar RGBELoader = function ( manager ) {\n\n\tDataTextureLoader.call( this, manager );\n\n\tthis.type = UnsignedByteType;\n\n};\n\nRGBELoader.prototype = Object.assign( Object.create( DataTextureLoader.prototype ), {\n\n\tconstructor: RGBELoader,\n\n\t// adapted from http://www.graphics.cornell.edu/~bjw/rgbe.html\n\n\tparse: function ( buffer ) {\n\n\t\tvar\n\t\t\t/* return codes for rgbe routines */\n\t\t\t//RGBE_RETURN_SUCCESS = 0,\n\t\t\tRGBE_RETURN_FAILURE = - 1,\n\n\t\t\t/* default error routine.  change this to change error handling */\n\t\t\trgbe_read_error = 1,\n\t\t\trgbe_write_error = 2,\n\t\t\trgbe_format_error = 3,\n\t\t\trgbe_memory_error = 4,\n\t\t\trgbe_error = function ( rgbe_error_code, msg ) {\n\n\t\t\t\tswitch ( rgbe_error_code ) {\n\n\t\t\t\t\tcase rgbe_read_error: console.error( \"RGBELoader Read Error: \" + ( msg || '' ) );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase rgbe_write_error: console.error( \"RGBELoader Write Error: \" + ( msg || '' ) );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase rgbe_format_error: console.error( \"RGBELoader Bad File Format: \" + ( msg || '' ) );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\tcase rgbe_memory_error: console.error( \"RGBELoader: Error: \" + ( msg || '' ) );\n\n\t\t\t\t}\n\t\t\t\treturn RGBE_RETURN_FAILURE;\n\n\t\t\t},\n\n\t\t\t/* offsets to red, green, and blue components in a data (float) pixel */\n\t\t\t//RGBE_DATA_RED = 0,\n\t\t\t//RGBE_DATA_GREEN = 1,\n\t\t\t//RGBE_DATA_BLUE = 2,\n\n\t\t\t/* number of floats per pixel, use 4 since stored in rgba image format */\n\t\t\t//RGBE_DATA_SIZE = 4,\n\n\t\t\t/* flags indicating which fields in an rgbe_header_info are valid */\n\t\t\tRGBE_VALID_PROGRAMTYPE = 1,\n\t\t\tRGBE_VALID_FORMAT = 2,\n\t\t\tRGBE_VALID_DIMENSIONS = 4,\n\n\t\t\tNEWLINE = \"\\n\",\n\n\t\t\tfgets = function ( buffer, lineLimit, consume ) {\n\n\t\t\t\tlineLimit = ! lineLimit ? 1024 : lineLimit;\n\t\t\t\tvar p = buffer.pos,\n\t\t\t\t\ti = - 1, len = 0, s = '', chunkSize = 128,\n\t\t\t\t\tchunk = String.fromCharCode.apply( null, new Uint16Array( buffer.subarray( p, p + chunkSize ) ) )\n\t\t\t\t;\n\t\t\t\twhile ( ( 0 > ( i = chunk.indexOf( NEWLINE ) ) ) && ( len < lineLimit ) && ( p < buffer.byteLength ) ) {\n\n\t\t\t\t\ts += chunk; len += chunk.length;\n\t\t\t\t\tp += chunkSize;\n\t\t\t\t\tchunk += String.fromCharCode.apply( null, new Uint16Array( buffer.subarray( p, p + chunkSize ) ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( - 1 < i ) {\n\n\t\t\t\t\t/*for (i=l-1; i>=0; i--) {\n\t\t\t\t\t\tbyteCode = m.charCodeAt(i);\n\t\t\t\t\t\tif (byteCode > 0x7f && byteCode <= 0x7ff) byteLen++;\n\t\t\t\t\t\telse if (byteCode > 0x7ff && byteCode <= 0xffff) byteLen += 2;\n\t\t\t\t\t\tif (byteCode >= 0xDC00 && byteCode <= 0xDFFF) i--; //trail surrogate\n\t\t\t\t\t}*/\n\t\t\t\t\tif ( false !== consume ) buffer.pos += len + i + 1;\n\t\t\t\t\treturn s + chunk.slice( 0, i );\n\n\t\t\t\t}\n\t\t\t\treturn false;\n\n\t\t\t},\n\n\t\t\t/* minimal header reading.  modify if you want to parse more information */\n\t\t\tRGBE_ReadHeader = function ( buffer ) {\n\n\t\t\t\tvar line, match,\n\n\t\t\t\t\t// regexes to parse header info fields\n\t\t\t\t\tmagic_token_re = /^#\\?(\\S+)$/,\n\t\t\t\t\tgamma_re = /^\\s*GAMMA\\s*=\\s*(\\d+(\\.\\d+)?)\\s*$/,\n\t\t\t\t\texposure_re = /^\\s*EXPOSURE\\s*=\\s*(\\d+(\\.\\d+)?)\\s*$/,\n\t\t\t\t\tformat_re = /^\\s*FORMAT=(\\S+)\\s*$/,\n\t\t\t\t\tdimensions_re = /^\\s*\\-Y\\s+(\\d+)\\s+\\+X\\s+(\\d+)\\s*$/,\n\n\t\t\t\t\t// RGBE format header struct\n\t\t\t\t\theader = {\n\n\t\t\t\t\t\tvalid: 0, /* indicate which fields are valid */\n\n\t\t\t\t\t\tstring: '', /* the actual header string */\n\n\t\t\t\t\t\tcomments: '', /* comments found in header */\n\n\t\t\t\t\t\tprogramtype: 'RGBE', /* listed at beginning of file to identify it after \"#?\". defaults to \"RGBE\" */\n\n\t\t\t\t\t\tformat: '', /* RGBE format, default 32-bit_rle_rgbe */\n\n\t\t\t\t\t\tgamma: 1.0, /* image has already been gamma corrected with given gamma. defaults to 1.0 (no correction) */\n\n\t\t\t\t\t\texposure: 1.0, /* a value of 1.0 in an image corresponds to <exposure> watts/steradian/m^2. defaults to 1.0 */\n\n\t\t\t\t\t\twidth: 0, height: 0 /* image dimensions, width/height */\n\n\t\t\t\t\t};\n\n\t\t\t\tif ( buffer.pos >= buffer.byteLength || ! ( line = fgets( buffer ) ) ) {\n\n\t\t\t\t\treturn rgbe_error( rgbe_read_error, \"no header found\" );\n\n\t\t\t\t}\n\t\t\t\t/* if you want to require the magic token then uncomment the next line */\n\t\t\t\tif ( ! ( match = line.match( magic_token_re ) ) ) {\n\n\t\t\t\t\treturn rgbe_error( rgbe_format_error, \"bad initial token\" );\n\n\t\t\t\t}\n\t\t\t\theader.valid |= RGBE_VALID_PROGRAMTYPE;\n\t\t\t\theader.programtype = match[ 1 ];\n\t\t\t\theader.string += line + \"\\n\";\n\n\t\t\t\twhile ( true ) {\n\n\t\t\t\t\tline = fgets( buffer );\n\t\t\t\t\tif ( false === line ) break;\n\t\t\t\t\theader.string += line + \"\\n\";\n\n\t\t\t\t\tif ( '#' === line.charAt( 0 ) ) {\n\n\t\t\t\t\t\theader.comments += line + \"\\n\";\n\t\t\t\t\t\tcontinue; // comment line\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( match = line.match( gamma_re ) ) {\n\n\t\t\t\t\t\theader.gamma = parseFloat( match[ 1 ], 10 );\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( match = line.match( exposure_re ) ) {\n\n\t\t\t\t\t\theader.exposure = parseFloat( match[ 1 ], 10 );\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( match = line.match( format_re ) ) {\n\n\t\t\t\t\t\theader.valid |= RGBE_VALID_FORMAT;\n\t\t\t\t\t\theader.format = match[ 1 ];//'32-bit_rle_rgbe';\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( match = line.match( dimensions_re ) ) {\n\n\t\t\t\t\t\theader.valid |= RGBE_VALID_DIMENSIONS;\n\t\t\t\t\t\theader.height = parseInt( match[ 1 ], 10 );\n\t\t\t\t\t\theader.width = parseInt( match[ 2 ], 10 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ( header.valid & RGBE_VALID_FORMAT ) && ( header.valid & RGBE_VALID_DIMENSIONS ) ) break;\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! ( header.valid & RGBE_VALID_FORMAT ) ) {\n\n\t\t\t\t\treturn rgbe_error( rgbe_format_error, \"missing format specifier\" );\n\n\t\t\t\t}\n\t\t\t\tif ( ! ( header.valid & RGBE_VALID_DIMENSIONS ) ) {\n\n\t\t\t\t\treturn rgbe_error( rgbe_format_error, \"missing image size specifier\" );\n\n\t\t\t\t}\n\n\t\t\t\treturn header;\n\n\t\t\t},\n\n\t\t\tRGBE_ReadPixels_RLE = function ( buffer, w, h ) {\n\n\t\t\t\tvar data_rgba, offset, pos, count, byteValue,\n\t\t\t\t\tscanline_buffer, ptr, ptr_end, i, l, off, isEncodedRun,\n\t\t\t\t\tscanline_width = w, num_scanlines = h, rgbeStart\n\t\t\t\t;\n\n\t\t\t\tif (\n\t\t\t\t\t// run length encoding is not allowed so read flat\n\t\t\t\t\t( ( scanline_width < 8 ) || ( scanline_width > 0x7fff ) ) ||\n\t\t\t\t\t// this file is not run length encoded\n\t\t\t\t\t( ( 2 !== buffer[ 0 ] ) || ( 2 !== buffer[ 1 ] ) || ( buffer[ 2 ] & 0x80 ) )\n\t\t\t\t) {\n\n\t\t\t\t\t// return the flat buffer\n\t\t\t\t\treturn new Uint8Array( buffer );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scanline_width !== ( ( buffer[ 2 ] << 8 ) | buffer[ 3 ] ) ) {\n\n\t\t\t\t\treturn rgbe_error( rgbe_format_error, \"wrong scanline width\" );\n\n\t\t\t\t}\n\n\t\t\t\tdata_rgba = new Uint8Array( 4 * w * h );\n\n\t\t\t\tif ( ! data_rgba || ! data_rgba.length ) {\n\n\t\t\t\t\treturn rgbe_error( rgbe_memory_error, \"unable to allocate buffer space\" );\n\n\t\t\t\t}\n\n\t\t\t\toffset = 0; pos = 0; ptr_end = 4 * scanline_width;\n\t\t\t\trgbeStart = new Uint8Array( 4 );\n\t\t\t\tscanline_buffer = new Uint8Array( ptr_end );\n\n\t\t\t\t// read in each successive scanline\n\t\t\t\twhile ( ( num_scanlines > 0 ) && ( pos < buffer.byteLength ) ) {\n\n\t\t\t\t\tif ( pos + 4 > buffer.byteLength ) {\n\n\t\t\t\t\t\treturn rgbe_error( rgbe_read_error );\n\n\t\t\t\t\t}\n\n\t\t\t\t\trgbeStart[ 0 ] = buffer[ pos ++ ];\n\t\t\t\t\trgbeStart[ 1 ] = buffer[ pos ++ ];\n\t\t\t\t\trgbeStart[ 2 ] = buffer[ pos ++ ];\n\t\t\t\t\trgbeStart[ 3 ] = buffer[ pos ++ ];\n\n\t\t\t\t\tif ( ( 2 != rgbeStart[ 0 ] ) || ( 2 != rgbeStart[ 1 ] ) || ( ( ( rgbeStart[ 2 ] << 8 ) | rgbeStart[ 3 ] ) != scanline_width ) ) {\n\n\t\t\t\t\t\treturn rgbe_error( rgbe_format_error, \"bad rgbe scanline format\" );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// read each of the four channels for the scanline into the buffer\n\t\t\t\t\t// first red, then green, then blue, then exponent\n\t\t\t\t\tptr = 0;\n\t\t\t\t\twhile ( ( ptr < ptr_end ) && ( pos < buffer.byteLength ) ) {\n\n\t\t\t\t\t\tcount = buffer[ pos ++ ];\n\t\t\t\t\t\tisEncodedRun = count > 128;\n\t\t\t\t\t\tif ( isEncodedRun ) count -= 128;\n\n\t\t\t\t\t\tif ( ( 0 === count ) || ( ptr + count > ptr_end ) ) {\n\n\t\t\t\t\t\t\treturn rgbe_error( rgbe_format_error, \"bad scanline data\" );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( isEncodedRun ) {\n\n\t\t\t\t\t\t\t// a (encoded) run of the same value\n\t\t\t\t\t\t\tbyteValue = buffer[ pos ++ ];\n\t\t\t\t\t\t\tfor ( i = 0; i < count; i ++ ) {\n\n\t\t\t\t\t\t\t\tscanline_buffer[ ptr ++ ] = byteValue;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//ptr += count;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// a literal-run\n\t\t\t\t\t\t\tscanline_buffer.set( buffer.subarray( pos, pos + count ), ptr );\n\t\t\t\t\t\t\tptr += count; pos += count;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// now convert data from buffer into rgba\n\t\t\t\t\t// first red, then green, then blue, then exponent (alpha)\n\t\t\t\t\tl = scanline_width; //scanline_buffer.byteLength;\n\t\t\t\t\tfor ( i = 0; i < l; i ++ ) {\n\n\t\t\t\t\t\toff = 0;\n\t\t\t\t\t\tdata_rgba[ offset ] = scanline_buffer[ i + off ];\n\t\t\t\t\t\toff += scanline_width; //1;\n\t\t\t\t\t\tdata_rgba[ offset + 1 ] = scanline_buffer[ i + off ];\n\t\t\t\t\t\toff += scanline_width; //1;\n\t\t\t\t\t\tdata_rgba[ offset + 2 ] = scanline_buffer[ i + off ];\n\t\t\t\t\t\toff += scanline_width; //1;\n\t\t\t\t\t\tdata_rgba[ offset + 3 ] = scanline_buffer[ i + off ];\n\t\t\t\t\t\toffset += 4;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tnum_scanlines --;\n\n\t\t\t\t}\n\n\t\t\t\treturn data_rgba;\n\n\t\t\t};\n\n\t\tvar RGBEByteToRGBFloat = function ( sourceArray, sourceOffset, destArray, destOffset ) {\n\n\t\t\tvar e = sourceArray[ sourceOffset + 3 ];\n\t\t\tvar scale = Math.pow( 2.0, e - 128.0 ) / 255.0;\n\n\t\t\tdestArray[ destOffset + 0 ] = sourceArray[ sourceOffset + 0 ] * scale;\n\t\t\tdestArray[ destOffset + 1 ] = sourceArray[ sourceOffset + 1 ] * scale;\n\t\t\tdestArray[ destOffset + 2 ] = sourceArray[ sourceOffset + 2 ] * scale;\n\n\t\t};\n\n\t\tvar RGBEByteToRGBHalf = ( function () {\n\n\t\t\t// Source: http://gamedev.stackexchange.com/questions/17326/conversion-of-a-number-from-single-precision-floating-point-representation-to-a/17410#17410\n\n\t\t\tvar floatView = new Float32Array( 1 );\n\t\t\tvar int32View = new Int32Array( floatView.buffer );\n\n\t\t\t/* This method is faster than the OpenEXR implementation (very often\n\t\t\t * used, eg. in Ogre), with the additional benefit of rounding, inspired\n\t\t\t * by James Tursa?s half-precision code. */\n\t\t\tfunction toHalf( val ) {\n\n\t\t\t\tfloatView[ 0 ] = val;\n\t\t\t\tvar x = int32View[ 0 ];\n\n\t\t\t\tvar bits = ( x >> 16 ) & 0x8000; /* Get the sign */\n\t\t\t\tvar m = ( x >> 12 ) & 0x07ff; /* Keep one extra bit for rounding */\n\t\t\t\tvar e = ( x >> 23 ) & 0xff; /* Using int is faster here */\n\n\t\t\t\t/* If zero, or denormal, or exponent underflows too much for a denormal\n\t\t\t\t * half, return signed zero. */\n\t\t\t\tif ( e < 103 ) return bits;\n\n\t\t\t\t/* If NaN, return NaN. If Inf or exponent overflow, return Inf. */\n\t\t\t\tif ( e > 142 ) {\n\n\t\t\t\t\tbits |= 0x7c00;\n\t\t\t\t\t/* If exponent was 0xff and one mantissa bit was set, it means NaN,\n\t\t\t\t\t\t\t * not Inf, so make sure we set one mantissa bit too. */\n\t\t\t\t\tbits |= ( ( e == 255 ) ? 0 : 1 ) && ( x & 0x007fffff );\n\t\t\t\t\treturn bits;\n\n\t\t\t\t}\n\n\t\t\t\t/* If exponent underflows but not too much, return a denormal */\n\t\t\t\tif ( e < 113 ) {\n\n\t\t\t\t\tm |= 0x0800;\n\t\t\t\t\t/* Extra rounding may overflow and set mantissa to 0 and exponent\n\t\t\t\t\t * to 1, which is OK. */\n\t\t\t\t\tbits |= ( m >> ( 114 - e ) ) + ( ( m >> ( 113 - e ) ) & 1 );\n\t\t\t\t\treturn bits;\n\n\t\t\t\t}\n\n\t\t\t\tbits |= ( ( e - 112 ) << 10 ) | ( m >> 1 );\n\t\t\t\t/* Extra rounding. An overflow will set mantissa to 0 and increment\n\t\t\t\t * the exponent, which is OK. */\n\t\t\t\tbits += m & 1;\n\t\t\t\treturn bits;\n\n\t\t\t}\n\n\t\t\treturn function ( sourceArray, sourceOffset, destArray, destOffset ) {\n\n\t\t\t\tvar e = sourceArray[ sourceOffset + 3 ];\n\t\t\t\tvar scale = Math.pow( 2.0, e - 128.0 ) / 255.0;\n\n\t\t\t\tdestArray[ destOffset + 0 ] = toHalf( sourceArray[ sourceOffset + 0 ] * scale );\n\t\t\t\tdestArray[ destOffset + 1 ] = toHalf( sourceArray[ sourceOffset + 1 ] * scale );\n\t\t\t\tdestArray[ destOffset + 2 ] = toHalf( sourceArray[ sourceOffset + 2 ] * scale );\n\n\t\t\t};\n\n\t\t} )();\n\n\t\tvar byteArray = new Uint8Array( buffer );\n\t\tbyteArray.pos = 0;\n\t\tvar rgbe_header_info = RGBE_ReadHeader( byteArray );\n\n\t\tif ( RGBE_RETURN_FAILURE !== rgbe_header_info ) {\n\n\t\t\tvar w = rgbe_header_info.width,\n\t\t\t\th = rgbe_header_info.height,\n\t\t\t\timage_rgba_data = RGBE_ReadPixels_RLE( byteArray.subarray( byteArray.pos ), w, h );\n\n\t\t\tif ( RGBE_RETURN_FAILURE !== image_rgba_data ) {\n\n\t\t\t\tswitch ( this.type ) {\n\n\t\t\t\t\tcase UnsignedByteType:\n\n\t\t\t\t\t\tvar data = image_rgba_data;\n\t\t\t\t\t\tvar format = RGBEFormat; // handled as THREE.RGBAFormat in shaders\n\t\t\t\t\t\tvar type = UnsignedByteType;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\n\t\t\t\t\t\tvar numElements = ( image_rgba_data.length / 4 ) * 3;\n\t\t\t\t\t\tvar floatArray = new Float32Array( numElements );\n\n\t\t\t\t\t\tfor ( var j = 0; j < numElements; j ++ ) {\n\n\t\t\t\t\t\t\tRGBEByteToRGBFloat( image_rgba_data, j * 4, floatArray, j * 3 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar data = floatArray;\n\t\t\t\t\t\tvar format = RGBFormat;\n\t\t\t\t\t\tvar type = FloatType;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase HalfFloatType:\n\n\t\t\t\t\t\tvar numElements = ( image_rgba_data.length / 4 ) * 3;\n\t\t\t\t\t\tvar halfArray = new Uint16Array( numElements );\n\n\t\t\t\t\t\tfor ( var j = 0; j < numElements; j ++ ) {\n\n\t\t\t\t\t\t\tRGBEByteToRGBHalf( image_rgba_data, j * 4, halfArray, j * 3 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar data = halfArray;\n\t\t\t\t\t\tvar format = RGBFormat;\n\t\t\t\t\t\tvar type = HalfFloatType;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tconsole.error( 'THREE.RGBELoader: unsupported type: ', this.type );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\twidth: w, height: h,\n\t\t\t\t\tdata: data,\n\t\t\t\t\theader: rgbe_header_info.string,\n\t\t\t\t\tgamma: rgbe_header_info.gamma,\n\t\t\t\t\texposure: rgbe_header_info.exposure,\n\t\t\t\t\tformat: format,\n\t\t\t\t\ttype: type\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t},\n\n\tsetDataType: function ( value ) {\n\n\t\tthis.type = value;\n\t\treturn this;\n\n\t},\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tfunction onLoadCallback( texture, texData ) {\n\n\t\t\tswitch ( texture.type ) {\n\n\t\t\t\tcase UnsignedByteType:\n\n\t\t\t\t\ttexture.encoding = RGBEEncoding;\n\t\t\t\t\ttexture.minFilter = NearestFilter;\n\t\t\t\t\ttexture.magFilter = NearestFilter;\n\t\t\t\t\ttexture.generateMipmaps = false;\n\t\t\t\t\ttexture.flipY = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase FloatType:\n\n\t\t\t\t\ttexture.encoding = LinearEncoding;\n\t\t\t\t\ttexture.minFilter = LinearFilter;\n\t\t\t\t\ttexture.magFilter = LinearFilter;\n\t\t\t\t\ttexture.generateMipmaps = false;\n\t\t\t\t\ttexture.flipY = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase HalfFloatType:\n\n\t\t\t\t\ttexture.encoding = LinearEncoding;\n\t\t\t\t\ttexture.minFilter = LinearFilter;\n\t\t\t\t\ttexture.magFilter = LinearFilter;\n\t\t\t\t\ttexture.generateMipmaps = false;\n\t\t\t\t\ttexture.flipY = true;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( onLoad ) onLoad( texture, texData );\n\n\t\t}\n\n\t\treturn DataTextureLoader.prototype.load.call( this, url, onLoadCallback, onProgress, onError );\n\n\t}\n\n} );\n\nexport { RGBELoader };\n","import {CompressedTexture} from 'three/src/textures/CompressedTexture';\nimport {FileLoader} from 'three/src/loaders/FileLoader';\nimport {LinearFilter} from 'three/src/constants';\nimport {LinearMipmapLinearFilter} from 'three/src/constants';\nimport {Loader} from 'three/src/loaders/Loader';\nimport {RGBA_ASTC_4x4_Format} from 'three/src/constants';\nimport {RGBA_PVRTC_4BPPV1_Format} from 'three/src/constants';\nimport {RGB_ETC1_Format} from 'three/src/constants';\nimport {RGB_PVRTC_4BPPV1_Format} from 'three/src/constants';\nimport {UnsignedByteType} from 'three/src/constants';\n/**\n * @author Don McCurdy / https://www.donmccurdy.com\n * @author Austin Eng / https://github.com/austinEng\n * @author Shrek Shao / https://github.com/shrekshao\n */\n\n\n/**\n * Loader for Basis Universal GPU Texture Codec.\n *\n * Basis Universal is a \"supercompressed\" GPU texture and texture video\n * compression system that outputs a highly compressed intermediate file format\n * (.basis) that can be quickly transcoded to a wide variety of GPU texture\n * compression formats.\n *\n * This loader parallelizes the transcoding process across a configurable number\n * of web workers, before transferring the transcoded compressed texture back\n * to the main thread.\n */\nvar BasisTextureLoader = function ( manager ) {\n\n\tLoader.call( this, manager );\n\n\tthis.transcoderPath = '';\n\tthis.transcoderBinary = null;\n\tthis.transcoderPending = null;\n\n\tthis.workerLimit = 4;\n\tthis.workerPool = [];\n\tthis.workerNextTaskID = 1;\n\tthis.workerSourceURL = '';\n\tthis.workerConfig = {\n\t\tformat: null,\n\t\tastcSupported: false,\n\t\tetcSupported: false,\n\t\tdxtSupported: false,\n\t\tpvrtcSupported: false,\n\t};\n\n};\n\nBasisTextureLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: BasisTextureLoader,\n\n\tsetTranscoderPath: function ( path ) {\n\n\t\tthis.transcoderPath = path;\n\n\t\treturn this;\n\n\t},\n\n\tsetWorkerLimit: function ( workerLimit ) {\n\n\t\tthis.workerLimit = workerLimit;\n\n\t\treturn this;\n\n\t},\n\n\tdetectSupport: function ( renderer ) {\n\n\t\tvar config = this.workerConfig;\n\n\t\tconfig.astcSupported = !! renderer.extensions.get( 'WEBGL_compressed_texture_astc' );\n\t\tconfig.etcSupported = !! renderer.extensions.get( 'WEBGL_compressed_texture_etc1' );\n\t\tconfig.dxtSupported = !! renderer.extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\t\tconfig.pvrtcSupported = !! renderer.extensions.get( 'WEBGL_compressed_texture_pvrtc' )\n\t\t\t|| !! renderer.extensions.get( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\n\n\t\tif ( config.astcSupported ) {\n\n\t\t\tconfig.format = BasisTextureLoader.BASIS_FORMAT.cTFASTC_4x4;\n\n\t\t} else if ( config.dxtSupported ) {\n\n\t\t\tconfig.format = BasisTextureLoader.BASIS_FORMAT.cTFBC3;\n\n\t\t} else if ( config.pvrtcSupported ) {\n\n\t\t\tconfig.format = BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGBA;\n\n\t\t} else if ( config.etcSupported ) {\n\n\t\t\tconfig.format = BasisTextureLoader.BASIS_FORMAT.cTFETC1;\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.BasisTextureLoader: No suitable compressed texture format found.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar loader = new FileLoader( this.manager );\n\n\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\tloader.load( url, ( buffer ) => {\n\n\t\t\tthis._createTexture( buffer )\n\t\t\t\t.then( onLoad )\n\t\t\t\t.catch( onError );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\t/**\n\t * @param  {ArrayBuffer} buffer\n\t * @return {Promise<CompressedTexture>}\n\t */\n\t_createTexture: function ( buffer ) {\n\n\t\tvar worker;\n\t\tvar taskID;\n\n\t\tvar taskCost = buffer.byteLength;\n\n\t\tvar texturePending = this._allocateWorker( taskCost )\n\t\t\t.then( ( _worker ) => {\n\n\t\t\t\tworker = _worker;\n\t\t\t\ttaskID = this.workerNextTaskID ++;\n\n\t\t\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\t\t\tworker._callbacks[ taskID ] = { resolve, reject };\n\n\t\t\t\t\tworker.postMessage( { type: 'transcode', id: taskID, buffer }, [ buffer ] );\n\n\t\t\t\t} );\n\n\t\t\t} )\n\t\t\t.then( ( message ) => {\n\n\t\t\t\tvar config = this.workerConfig;\n\n\t\t\t\tvar { width, height, mipmaps, format } = message;\n\n\t\t\t\tvar texture;\n\n\t\t\t\tswitch ( format ) {\n\n\t\t\t\t\tcase BasisTextureLoader.BASIS_FORMAT.cTFASTC_4x4:\n\t\t\t\t\t\ttexture = new CompressedTexture( mipmaps, width, height, RGBA_ASTC_4x4_Format );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase BasisTextureLoader.BASIS_FORMAT.cTFBC1:\n\t\t\t\t\tcase BasisTextureLoader.BASIS_FORMAT.cTFBC3:\n\t\t\t\t\t\ttexture = new CompressedTexture( mipmaps, width, height, BasisTextureLoader.DXT_FORMAT_MAP[ config.format ], UnsignedByteType );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase BasisTextureLoader.BASIS_FORMAT.cTFETC1:\n\t\t\t\t\t\ttexture = new CompressedTexture( mipmaps, width, height, RGB_ETC1_Format );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGB:\n\t\t\t\t\t\ttexture = new CompressedTexture( mipmaps, width, height, RGB_PVRTC_4BPPV1_Format );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGBA:\n\t\t\t\t\t\ttexture = new CompressedTexture( mipmaps, width, height, RGBA_PVRTC_4BPPV1_Format );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error( 'THREE.BasisTextureLoader: No supported format available.' );\n\n\t\t\t\t}\n\n\t\t\t\ttexture.minFilter = mipmaps.length === 1 ? LinearFilter : LinearMipmapLinearFilter;\n\t\t\t\ttexture.magFilter = LinearFilter;\n\t\t\t\ttexture.generateMipmaps = false;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\treturn texture;\n\n\t\t\t} );\n\n\t\ttexturePending\n\t\t\t.finally( () => {\n\n\t\t\t\tif ( worker && taskID ) {\n\n\t\t\t\t\tworker._taskLoad -= taskCost;\n\t\t\t\t\tdelete worker._callbacks[ taskID ];\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\treturn texturePending;\n\n\t},\n\n\t_initTranscoder: function () {\n\n\t\tif ( ! this.transcoderPending ) {\n\n\t\t\t// Load transcoder wrapper.\n\t\t\tvar jsLoader = new FileLoader( this.manager );\n\t\t\tjsLoader.setPath( this.transcoderPath );\n\t\t\tvar jsContent = new Promise( ( resolve, reject ) => {\n\n\t\t\t\tjsLoader.load( 'basis_transcoder.js', resolve, undefined, reject );\n\n\t\t\t} );\n\n\t\t\t// Load transcoder WASM binary.\n\t\t\tvar binaryLoader = new FileLoader( this.manager );\n\t\t\tbinaryLoader.setPath( this.transcoderPath );\n\t\t\tbinaryLoader.setResponseType( 'arraybuffer' );\n\t\t\tvar binaryContent = new Promise( ( resolve, reject ) => {\n\n\t\t\t\tbinaryLoader.load( 'basis_transcoder.wasm', resolve, undefined, reject );\n\n\t\t\t} );\n\n\t\t\tthis.transcoderPending = Promise.all( [ jsContent, binaryContent ] )\n\t\t\t\t.then( ( [ jsContent, binaryContent ] ) => {\n\n\t\t\t\t\tvar fn = BasisTextureLoader.BasisWorker.toString();\n\n\t\t\t\t\tvar body = [\n\t\t\t\t\t\t'/* basis_transcoder.js */',\n\t\t\t\t\t\tjsContent,\n\t\t\t\t\t\t'/* worker */',\n\t\t\t\t\t\tfn.substring( fn.indexOf( '{' ) + 1, fn.lastIndexOf( '}' ) )\n\t\t\t\t\t].join( '\\n' );\n\n\t\t\t\t\tthis.workerSourceURL = URL.createObjectURL( new Blob( [ body ] ) );\n\t\t\t\t\tthis.transcoderBinary = binaryContent;\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\treturn this.transcoderPending;\n\n\t},\n\n\t_allocateWorker: function ( taskCost ) {\n\n\t\treturn this._initTranscoder().then( () => {\n\n\t\t\tif ( this.workerPool.length < this.workerLimit ) {\n\n\t\t\t\tvar worker = new Worker( this.workerSourceURL );\n\n\t\t\t\tworker._callbacks = {};\n\t\t\t\tworker._taskLoad = 0;\n\n\t\t\t\tworker.postMessage( {\n\t\t\t\t\ttype: 'init',\n\t\t\t\t\tconfig: this.workerConfig,\n\t\t\t\t\ttranscoderBinary: this.transcoderBinary,\n\t\t\t\t} );\n\n\t\t\t\tworker.onmessage = function ( e ) {\n\n\t\t\t\t\tvar message = e.data;\n\n\t\t\t\t\tswitch ( message.type ) {\n\n\t\t\t\t\t\tcase 'transcode':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].resolve( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].reject( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.BasisTextureLoader: Unexpected message, \"' + message.type + '\"' );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tthis.workerPool.push( worker );\n\n\t\t\t} else {\n\n\t\t\t\tthis.workerPool.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a._taskLoad > b._taskLoad ? - 1 : 1;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tvar worker = this.workerPool[ this.workerPool.length - 1 ];\n\n\t\t\tworker._taskLoad += taskCost;\n\n\t\t\treturn worker;\n\n\t\t} );\n\n\t},\n\n\tdispose: function () {\n\n\t\tfor ( var i = 0; i < this.workerPool.length; i ++ ) {\n\n\t\t\tthis.workerPool[ i ].terminate();\n\n\t\t}\n\n\t\tthis.workerPool.length = 0;\n\n\t\treturn this;\n\n\t}\n\n} );\n\n/* CONSTANTS */\n\nBasisTextureLoader.BASIS_FORMAT = {\n\tcTFETC1: 0,\n\tcTFETC2: 1,\n\tcTFBC1: 2,\n\tcTFBC3: 3,\n\tcTFBC4: 4,\n\tcTFBC5: 5,\n\tcTFBC7_M6_OPAQUE_ONLY: 6,\n\tcTFBC7_M5: 7,\n\tcTFPVRTC1_4_RGB: 8,\n\tcTFPVRTC1_4_RGBA: 9,\n\tcTFASTC_4x4: 10,\n\tcTFATC_RGB: 11,\n\tcTFATC_RGBA_INTERPOLATED_ALPHA: 12,\n\tcTFRGBA32: 13,\n\tcTFRGB565: 14,\n\tcTFBGR565: 15,\n\tcTFRGBA4444: 16,\n};\n\n// DXT formats, from:\n// http://www.khronos.org/registry/webgl/extensions/WEBGL_compressed_texture_s3tc/\nBasisTextureLoader.DXT_FORMAT = {\n\tCOMPRESSED_RGB_S3TC_DXT1_EXT: 0x83F0,\n\tCOMPRESSED_RGBA_S3TC_DXT1_EXT: 0x83F1,\n\tCOMPRESSED_RGBA_S3TC_DXT3_EXT: 0x83F2,\n\tCOMPRESSED_RGBA_S3TC_DXT5_EXT: 0x83F3,\n};\nBasisTextureLoader.DXT_FORMAT_MAP = {};\nBasisTextureLoader.DXT_FORMAT_MAP[ BasisTextureLoader.BASIS_FORMAT.cTFBC1 ] =\n\tBasisTextureLoader.DXT_FORMAT.COMPRESSED_RGB_S3TC_DXT1_EXT;\nBasisTextureLoader.DXT_FORMAT_MAP[ BasisTextureLoader.BASIS_FORMAT.cTFBC3 ] =\n\tBasisTextureLoader.DXT_FORMAT.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n\n/* WEB WORKER */\n\nBasisTextureLoader.BasisWorker = function () {\n\n\tvar config;\n\tvar transcoderPending;\n\tvar _BasisFile;\n\n\tonmessage = function ( e ) {\n\n\t\tvar message = e.data;\n\n\t\tswitch ( message.type ) {\n\n\t\t\tcase 'init':\n\t\t\t\tconfig = message.config;\n\t\t\t\tinit( message.transcoderBinary );\n\t\t\t\tbreak;\n\n\t\t\tcase 'transcode':\n\t\t\t\ttranscoderPending.then( () => {\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tvar { width, height, hasAlpha, mipmaps, format } = transcode( message.buffer );\n\n\t\t\t\t\t\tvar buffers = [];\n\n\t\t\t\t\t\tfor ( var i = 0; i < mipmaps.length; ++ i ) {\n\n\t\t\t\t\t\t\tbuffers.push( mipmaps[ i ].data.buffer );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself.postMessage( { type: 'transcode', id: message.id, width, height, hasAlpha, mipmaps, format }, buffers );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tconsole.error( error );\n\n\t\t\t\t\t\tself.postMessage( { type: 'error', id: message.id, error: error.message } );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t};\n\n\tfunction init( wasmBinary ) {\n\n\t\tvar BasisModule;\n\t\ttranscoderPending = new Promise( ( resolve ) => {\n\n\t\t\tBasisModule = { wasmBinary, onRuntimeInitialized: resolve };\n\t\t\tBASIS( BasisModule );\n\n\t\t} ).then( () => {\n\n\t\t\tvar { BasisFile, initializeBasis } = BasisModule;\n\n\t\t\t_BasisFile = BasisFile;\n\n\t\t\tinitializeBasis();\n\n\t\t} );\n\n\t}\n\n\tfunction transcode( buffer ) {\n\n\t\tvar basisFile = new _BasisFile( new Uint8Array( buffer ) );\n\n\t\tvar width = basisFile.getImageWidth( 0, 0 );\n\t\tvar height = basisFile.getImageHeight( 0, 0 );\n\t\tvar levels = basisFile.getNumLevels( 0 );\n\t\tvar hasAlpha = basisFile.getHasAlpha();\n\n\t\tfunction cleanup() {\n\n\t\t\tbasisFile.close();\n\t\t\tbasisFile.delete();\n\n\t\t}\n\n\t\tif ( ! hasAlpha ) {\n\n\t\t\tswitch ( config.format ) {\n\n\t\t\t\tcase 9: // Hardcoded: BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGBA\n\t\t\t\t\tconfig.format = 8; // Hardcoded: BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGB;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ! width || ! height || ! levels ) {\n\n\t\t\tcleanup();\n\t\t\tthrow new Error( 'THREE.BasisTextureLoader:  Invalid .basis file' );\n\n\t\t}\n\n\t\tif ( ! basisFile.startTranscoding() ) {\n\n\t\t\tcleanup();\n\t\t\tthrow new Error( 'THREE.BasisTextureLoader: .startTranscoding failed' );\n\n\t\t}\n\n\t\tvar mipmaps = [];\n\n\t\tfor ( var mip = 0; mip < levels; mip ++ ) {\n\n\t\t\tvar mipWidth = basisFile.getImageWidth( 0, mip );\n\t\t\tvar mipHeight = basisFile.getImageHeight( 0, mip );\n\t\t\tvar dst = new Uint8Array( basisFile.getImageTranscodedSizeInBytes( 0, mip, config.format ) );\n\n\t\t\tvar status = basisFile.transcodeImage(\n\t\t\t\tdst,\n\t\t\t\t0,\n\t\t\t\tmip,\n\t\t\t\tconfig.format,\n\t\t\t\t0,\n\t\t\t\thasAlpha\n\t\t\t);\n\n\t\t\tif ( ! status ) {\n\n\t\t\t\tcleanup();\n\t\t\t\tthrow new Error( 'THREE.BasisTextureLoader: .transcodeImage failed.' );\n\n\t\t\t}\n\n\t\t\tmipmaps.push( { data: dst, width: mipWidth, height: mipHeight } );\n\n\t\t}\n\n\t\tcleanup();\n\n\t\treturn { width, height, hasAlpha, mipmaps, format: config.format };\n\n\t}\n\n};\n\nexport { BasisTextureLoader };\n","import {Texture} from 'three/src/textures/Texture';\nimport {TypedCopNode} from './_Base';\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\nconst ParamsConfig = new NodeParamsConfig();\nexport class NullCopNode extends TypedCopNode<NodeParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'null';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.NEVER]);\n\t}\n\n\tasync cook(input_contents: Texture[]) {\n\t\tconst texture = input_contents[0];\n\t\tthis.set_texture(texture);\n\t}\n}\n","import {TypedCopNode} from './_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nclass SwitchCopParamsConfig extends NodeParamsConfig {\n\tinput = ParamConfig.INTEGER(0, {\n\t\trange: [0, 3],\n\t\trange_locked: [true, true],\n\t});\n}\nconst ParamsConfig = new SwitchCopParamsConfig();\n\nexport class SwitchCopNode extends TypedCopNode<SwitchCopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'switch';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(0, 4);\n\t\tthis.io.inputs.init_inputs_clonable_state([\n\t\t\tInputCloneMode.NEVER,\n\t\t\tInputCloneMode.NEVER,\n\t\t\tInputCloneMode.NEVER,\n\t\t\tInputCloneMode.NEVER,\n\t\t]);\n\t\tthis.ui_data.set_width(100);\n\t\t// this.ui_data.set_icon('code-branch');\n\n\t\tthis.cook_controller.disallow_inputs_evaluation();\n\t}\n\n\tasync cook() {\n\t\tconst input_index = this.pv.input;\n\t\tif (this.io.inputs.has_input(input_index)) {\n\t\t\tconst container = await this.container_controller.request_input_container(input_index);\n\t\t\tthis.set_texture(container.texture());\n\t\t} else {\n\t\t\tthis.states.error.set(`no input ${input_index}`);\n\t\t}\n\t}\n}\n","import {CATEGORY_EVENT} from './Category';\n\nimport {CameraMapControlsEventNode} from 'src/engine/nodes/event/CameraMapControls';\nimport {CameraOrbitControlsEventNode} from 'src/engine/nodes/event/CameraOrbitControls';\n\nexport interface EventNodeChildrenMap {\n\tcamera_orbit_controls: CameraMapControlsEventNode;\n\tcamera_map_controls: CameraOrbitControlsEventNode;\n}\n\nimport {Poly} from 'src/engine/Poly';\nexport class EventRegister {\n\tstatic run(poly: Poly) {\n\t\tpoly.register_node(CameraMapControlsEventNode, CATEGORY_EVENT.CAMERA);\n\t\tpoly.register_node(CameraOrbitControlsEventNode, CATEGORY_EVENT.CAMERA);\n\t}\n}\n","import {Camera} from 'three/src/cameras/Camera';\nimport {MapControls} from 'modules/three/examples/jsm/controls/OrbitControls';\nimport {CameraOrbitControlsEventNode} from './CameraOrbitControls';\n\nexport class CameraMapControlsEventNode extends CameraOrbitControlsEventNode {\n\tstatic type() {\n\t\treturn 'camera_map_controls';\n\t}\n\n\tasync create_controls_instance(camera: Camera, element: HTMLElement) {\n\t\t// await CoreScriptLoader.load_module_three_example('controls/OrbitControls')\n\t\t// const constructor_name = 'MapControls'\n\t\t// const constructor = THREE[constructor_name]\n\t\t// const c = this.constructor as typeof CameraMapControlsEventNode;\n\t\t// const {MapControls} = await CoreScriptLoader.module(c.required_imports()[0]);\n\n\t\treturn new MapControls(camera, element);\n\t}\n}\n","import {Camera} from 'three/src/cameras/Camera';\n\nimport {TypedEventNode} from './_Base';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\n\nimport {OrbitControls} from 'modules/three/examples/jsm/controls/OrbitControls';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\n\nexport interface CameraControls extends OrbitControls {\n\tname?: string;\n\t// this_is_a_control: any;\n\t// name: string;\n}\n\nexport abstract class TypedCameraControlsEventNode<K extends NodeParamsConfig> extends TypedEventNode<K> {\n\t// controls() {\n\t// \treturn this._controls;\n\t// }\n\n\tasync apply_controls(camera: Camera, html_element: HTMLElement) {\n\t\t// I don't think I can just assign the camera at the moment\n\t\t// so the controls may need to be re-created everytime\n\t\t// TODO: the controls should be created (and disposed?) by the viewer\n\t\t//this.dispose_controls()\n\n\t\tconst controls = await this.create_controls_instance(camera, html_element);\n\t\tconst timestamp = performance.now();\n\t\tcontrols.name = `${this.full_path()}:${camera.name}:${timestamp}:${this.controls_id()}`;\n\t\t// console.log(this._controls)\n\t\tawait this.params.eval_all();\n\t\tthis.setup_controls(controls);\n\t\treturn controls;\n\t\t// })\n\t\t// });\n\t}\n\tcontrols_id() {\n\t\treturn JSON.stringify(this.params.all.map((p) => p.value_serialized));\n\t}\n\t//this.cook()\n\n\t// dispose_controls: (controls_instance)->\n\t// \tif controls_instance?\n\t// \t\tcontrols_instance.dispose()\n\n\tabstract setup_controls(controls: CameraControls): void;\n\t//\n\n\tabstract async create_controls_instance(camera: Camera, element: HTMLElement): Promise<CameraControls>;\n\tabstract set_from_camera_node(controls: CameraControls, camera_node: BaseCameraObjNodeType): void;\n}\n\nexport type BaseCameraControlsEventNodeType = TypedCameraControlsEventNode<any>;\n","import {TypedNode} from '../_Base';\nimport {EventContainer} from 'src/engine/containers/Event';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {TypedContainerController} from '../utils/ContainerController';\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\n\nexport class TypedEventNode<K extends NodeParamsConfig> extends TypedNode<'EVENT', BaseEventNodeType, K> {\n\tcontainer_controller: TypedContainerController<EventContainer> = new TypedContainerController<EventContainer>(\n\t\tthis,\n\t\tEventContainer\n\t);\n\tstatic node_context(): NodeContext {\n\t\treturn NodeContext.EVENT;\n\t}\n\n\tprivate _eval_all_params_on_dirty_bound = this._eval_all_params_on_dirty.bind(this);\n\tinitialize_base_node() {\n\t\t// this._init_display_flag({\n\t\t// \thas_display_flag: false\n\t\t// });\n\n\t\tthis.add_post_dirty_hook('_eval_all_params_on_dirty', this._eval_all_params_on_dirty_bound);\n\t}\n\n\t// ensures that event nodes are cooked when scene is loaded\n\t_eval_all_params_on_dirty() {\n\t\tthis.params.eval_all();\n\t}\n}\n\nexport type BaseEventNodeType = TypedEventNode<any>;\nexport class BaseEventNodeClass extends TypedEventNode<any> {}\n","import {TypedContainer} from './_Base';\nimport {ContainableMap} from './utils/ContainableMap';\n\nexport class EventContainer extends TypedContainer<ContainableMap['EVENT']> {\n\tset_content(content: ContainableMap['EVENT']) {\n\t\tsuper.set_content(content);\n\t}\n}\n","import {CATEGORY_GL} from './Category';\n\nimport {AttributeGlNode} from 'src/engine/nodes/gl/Attribute';\nimport {ConstantGlNode} from 'src/engine/nodes/gl/Constant';\nimport {FloatToVec3GlNode} from 'src/engine/nodes/gl/FloatToVec3';\nimport {GlobalsGlNode} from 'src/engine/nodes/gl/Globals';\nimport {OutputGlNode} from 'src/engine/nodes/gl/Output';\nimport {ParamGlNode} from 'src/engine/nodes/gl/Param';\n\nexport interface GlNodeChildrenMap {\n\tattribute: AttributeGlNode;\n\tconstant: ConstantGlNode;\n\tfloat_to_vec3: FloatToVec3GlNode;\n\tglobals: GlobalsGlNode;\n\toutput: OutputGlNode;\n\tparam: ParamGlNode;\n}\n\nimport {Poly} from 'src/engine/Poly';\nexport class GlRegister {\n\tstatic run(poly: Poly) {\n\t\tpoly.register_node(AttributeGlNode, CATEGORY_GL.GLOBALS);\n\t\tpoly.register_node(ConstantGlNode, CATEGORY_GL.GLOBALS);\n\t\tpoly.register_node(FloatToVec3GlNode, CATEGORY_GL.CONVERSION);\n\t\tpoly.register_node(GlobalsGlNode, CATEGORY_GL.GLOBALS);\n\t\tpoly.register_node(OutputGlNode, CATEGORY_GL.GLOBALS);\n\t\tpoly.register_node(ParamGlNode, CATEGORY_GL.GLOBALS);\n\t}\n}\n","import {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamInitValuesTypeMap} from '../../../params/types/ParamInitValuesTypeMap';\nimport {ParamValue} from '../../../params/types/ParamValue';\n\nimport lodash_isNumber from 'lodash/isNumber';\n// import lodash_isString from 'lodash/isString';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Vector4} from 'three/src/math/Vector4';\nimport {Color} from 'three/src/math/Color';\n\n// import {TypeAssert} from 'src/engine/poly/Assert';\nimport {RampParam} from 'src/engine/params/Ramp';\n// type ConvertMethod<T extends ParamType> = (val: ParamValuesTypeMap[T]) => ParamInitValuesTypeMap[T];\ntype ConvertMethod<T extends ParamType> = (val: ParamValue) => ParamInitValuesTypeMap[T];\ntype ParamValuetoInitValueMapGeneric = {[key in ParamType]: ConvertMethod<key>};\n\n// function convert_boolean(value: ParamValuesTypeMap[ParamType.BOOLEAN]): ParamInitValuesTypeMap[ParamType.BOOLEAN] {\n// \treturn value ? 1 : 0;\n// }\n// function convert_button(value: ParamValuesTypeMap[ParamType.BUTTON]): ParamInitValuesTypeMap[ParamType.BUTTON] {\n// \treturn value;\n// }\n// function convert_color(value: ParamValuesTypeMap[ParamType.COLOR]): ParamInitValuesTypeMap[ParamType.COLOR] {\n// \treturn value.toArray() as Number3;\n// }\n// function convert_float(value: ParamValuesTypeMap[ParamType.FLOAT]): ParamInitValuesTypeMap[ParamType.FLOAT] {\n// \treturn value;\n// }\n// function convert_integer(value: ParamValuesTypeMap[ParamType.INTEGER]): ParamInitValuesTypeMap[ParamType.INTEGER] {\n// \treturn value;\n// }\n// function convert_operator_path(\n// \tvalue: ParamValuesTypeMap[ParamType.OPERATOR_PATH]\n// ): ParamInitValuesTypeMap[ParamType.OPERATOR_PATH] {\n// \treturn value;\n// }\n// function convert_ramp(value: ParamValuesTypeMap[ParamType.RAMP]): ParamInitValuesTypeMap[ParamType.RAMP] {\n// \treturn value;\n// }\n// function convert_separator(\n// \tvalue: ParamValuesTypeMap[ParamType.SEPARATOR]\n// ): ParamInitValuesTypeMap[ParamType.SEPARATOR] {\n// \treturn value;\n// }\n// function convert_string(value: ParamValuesTypeMap[ParamType.STRING]): ParamInitValuesTypeMap[ParamType.STRING] {\n// \treturn value;\n// }\n// function convert_vector2(value: ParamValuesTypeMap[ParamType.VECTOR2]): ParamInitValuesTypeMap[ParamType.VECTOR2] {\n// \treturn value.toArray() as Number2;\n// }\n// function convert_vector3(value: ParamValuesTypeMap[ParamType.VECTOR3]): ParamInitValuesTypeMap[ParamType.VECTOR3] {\n// \treturn value.toArray() as Number3;\n// }\n// function convert_vector4(value: ParamValuesTypeMap[ParamType.VECTOR4]): ParamInitValuesTypeMap[ParamType.VECTOR4] {\n// \treturn value.toArray() as Number4;\n// }\n\nfunction convert_boolean(value: ParamValue): ParamInitValuesTypeMap[ParamType.BOOLEAN] {\n\treturn value ? 1 : 0;\n}\nfunction convert_button(value: ParamValue): ParamInitValuesTypeMap[ParamType.BUTTON] {\n\treturn null;\n}\nfunction convert_color(value: ParamValue): ParamInitValuesTypeMap[ParamType.COLOR] {\n\tif (lodash_isNumber(value)) {\n\t\treturn [value, value, value];\n\t}\n\tif (value instanceof Vector2) {\n\t\tconst v2 = value.toArray() as Number2;\n\t\treturn [v2[0], v2[1], v2[0]];\n\t}\n\tif (value instanceof Vector3) {\n\t\treturn value.toArray() as Number3;\n\t}\n\tif (value instanceof Color) {\n\t\treturn value.toArray() as Number3;\n\t}\n\tif (value instanceof Vector4) {\n\t\tconst v4 = value.toArray() as Number4;\n\t\treturn [v4[0], v4[1], v4[2]];\n\t}\n\treturn [0, 0, 0];\n}\nfunction convert_float(value: ParamValue): ParamInitValuesTypeMap[ParamType.FLOAT] {\n\tif (lodash_isNumber(value)) {\n\t\treturn value;\n\t}\n\tif (value instanceof Vector2 || value instanceof Vector3 || value instanceof Vector4) {\n\t\treturn value.toArray()[0];\n\t}\n\treturn 0;\n}\nfunction convert_folder(value: ParamValue): ParamInitValuesTypeMap[ParamType.FOLDER] {\n\treturn null;\n}\nfunction convert_integer(value: ParamValue): ParamInitValuesTypeMap[ParamType.INTEGER] {\n\tif (lodash_isNumber(value)) {\n\t\treturn Math.floor(value);\n\t}\n\tif (value instanceof Vector2 || value instanceof Vector3 || value instanceof Vector4) {\n\t\treturn Math.floor(value.toArray()[0]);\n\t}\n\treturn 0;\n}\nfunction convert_operator_path(value: ParamValue): ParamInitValuesTypeMap[ParamType.OPERATOR_PATH] {\n\treturn `${value}`;\n}\nfunction convert_ramp(value: ParamValue): ParamInitValuesTypeMap[ParamType.RAMP] {\n\treturn RampParam.DEFAULT_VALUE;\n}\nfunction convert_separator(value: ParamValue): ParamInitValuesTypeMap[ParamType.SEPARATOR] {\n\treturn null;\n}\nfunction convert_string(value: ParamValue): ParamInitValuesTypeMap[ParamType.STRING] {\n\treturn `${value}`;\n}\nfunction convert_vector2(value: ParamValue): ParamInitValuesTypeMap[ParamType.VECTOR2] {\n\tif (lodash_isNumber(value)) {\n\t\treturn [value, value];\n\t}\n\tif (value instanceof Vector2) {\n\t\treturn value.toArray() as Number2;\n\t}\n\tif (value instanceof Vector3) {\n\t\tconst v3 = value.toArray();\n\t\treturn [v3[0], v3[1]];\n\t}\n\tif (value instanceof Color) {\n\t\tconst v3 = value.toArray();\n\t\treturn [v3[0], v3[1]];\n\t}\n\tif (value instanceof Vector4) {\n\t\tconst v4 = value.toArray() as Number4;\n\t\treturn [v4[0], v4[1]];\n\t}\n\treturn [0, 0];\n}\nfunction convert_vector3(value: ParamValue): ParamInitValuesTypeMap[ParamType.VECTOR3] {\n\tif (lodash_isNumber(value)) {\n\t\treturn [value, value, value];\n\t}\n\tif (value instanceof Vector2) {\n\t\tconst v2 = value.toArray() as Number2;\n\t\treturn [v2[0], v2[1], v2[0]];\n\t}\n\tif (value instanceof Vector3) {\n\t\treturn value.toArray() as Number3;\n\t}\n\tif (value instanceof Color) {\n\t\treturn value.toArray() as Number3;\n\t}\n\tif (value instanceof Vector4) {\n\t\tconst v4 = value.toArray() as Number4;\n\t\treturn [v4[0], v4[1], v4[2]];\n\t}\n\treturn [0, 0, 0];\n}\nfunction convert_vector4(value: ParamValue): ParamInitValuesTypeMap[ParamType.VECTOR4] {\n\tif (lodash_isNumber(value)) {\n\t\treturn [value, value, value, value];\n\t}\n\tif (value instanceof Vector2) {\n\t\tconst v2 = value.toArray() as Number2;\n\t\treturn [v2[0], v2[1], v2[0], v2[0]];\n\t}\n\tif (value instanceof Vector3) {\n\t\tconst v3 = value.toArray() as Number3;\n\t\treturn [v3[0], v3[1], v3[2], v3[0]];\n\t}\n\tif (value instanceof Color) {\n\t\tconst v3 = value.toArray() as Number3;\n\t\treturn [v3[0], v3[1], v3[2], v3[0]];\n\t}\n\tif (value instanceof Vector4) {\n\t\treturn value.toArray() as Number4;\n\t}\n\treturn [0, 0, 0, 0];\n}\n\nconst ParamValuetoInitValueMap: ParamValuetoInitValueMapGeneric = {\n\t[ParamType.BOOLEAN]: convert_boolean,\n\t[ParamType.BUTTON]: convert_button,\n\t[ParamType.COLOR]: convert_color,\n\t[ParamType.FLOAT]: convert_float,\n\t[ParamType.FOLDER]: convert_folder,\n\t[ParamType.INTEGER]: convert_integer,\n\t[ParamType.OPERATOR_PATH]: convert_operator_path,\n\t[ParamType.RAMP]: convert_ramp,\n\t[ParamType.SEPARATOR]: convert_separator,\n\t[ParamType.STRING]: convert_string,\n\t[ParamType.VECTOR2]: convert_vector2,\n\t[ParamType.VECTOR3]: convert_vector3,\n\t[ParamType.VECTOR4]: convert_vector4,\n};\n\nexport class ParamValueToDefaultConverter {\n\t// static from_value<T extends ParamType>(type: T, value: ParamValuesTypeMap[T]): ParamInitValuesTypeMap[T] {\n\t// \t// TODO: typescript, try and work out of I can avoid this cast (check file Debug.ts in same folder)\n\t// \tconst method: ConvertMethod<T> = (<unknown>ParamValuetoInitValueMap[type]) as ConvertMethod<T>;\n\t// \treturn method(value);\n\t// }\n\tstatic from_value<T extends ParamType>(type: T, value: ParamValue): ParamInitValuesTypeMap[T] {\n\t\t// const method: ConvertMethod<T> = (<unknown>ParamValuetoInitValueMap[type]) as ConvertMethod<T>;\n\t\tconst method: ConvertMethod<T> = (<unknown>ParamValuetoInitValueMap[type]) as ConvertMethod<T>;\n\t\treturn method(value);\n\t}\n}\n","import {TypedGlNode} from './_Base';\nimport {ThreeToGl} from 'src/core/ThreeToGl';\n\n// const OUTPUT_NAME = 'longer_name_to_test';\n\nimport {TypedNamedConnectionPoint} from '../utils/connections/NamedConnectionPoint';\nimport {ConnectionPointType, ConnectionPointTypes} from '../utils/connections/ConnectionPointType';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n\nfunction typed_visible_options(type: ConnectionPointType) {\n\tconst val = ConnectionPointTypes.indexOf(type);\n\treturn {visible_if: {type: val}};\n}\n\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ShadersCollectionController} from './code/utils/ShadersCollectionController';\nclass ConstantGlParamsConfig extends NodeParamsConfig {\n\ttype = ParamConfig.INTEGER(0, {\n\t\tmenu: {\n\t\t\tentries: ConnectionPointTypes.map((name, i) => {\n\t\t\t\treturn {name: name, value: i};\n\t\t\t}),\n\t\t},\n\t});\n\tvalue_bool = ParamConfig.BOOLEAN(0, typed_visible_options(ConnectionPointType.BOOL));\n\tvalue_int = ParamConfig.INTEGER(0, typed_visible_options(ConnectionPointType.INT));\n\tvalue_float = ParamConfig.FLOAT(0, typed_visible_options(ConnectionPointType.FLOAT));\n\tvalue_vec2 = ParamConfig.VECTOR2([0, 0], typed_visible_options(ConnectionPointType.VEC2));\n\tvalue_vec3 = ParamConfig.VECTOR3([0, 0, 0], typed_visible_options(ConnectionPointType.VEC3));\n\tvalue_vec4 = ParamConfig.VECTOR4([0, 0, 0, 0], typed_visible_options(ConnectionPointType.VEC4));\n}\nconst ParamsConfig = new ConstantGlParamsConfig();\nexport class ConstantGlNode extends TypedGlNode<ConstantGlParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'constant';\n\t}\n\tprivate _params_by_type: Map<ConnectionPointType, BaseParamType> | undefined;\n\tprotected _allow_inputs_created_from_params: boolean = false;\n\tprivate _update_signature_if_required_bound = this._update_signature_if_required.bind(this);\n\tinitialize_node() {\n\t\tthis.params.add_on_scene_load_hook('_update_signature_if_required', this._update_signature_if_required_bound);\n\t\tthis.add_post_dirty_hook('_update_signature_if_required', this._update_signature_if_required_bound);\n\t}\n\t_update_signature_if_required(dirty_trigger?: CoreGraphNode) {\n\t\tif (!this.lifecycle.creation_completed || dirty_trigger == this.p.type) {\n\t\t\tthis.update_output_type();\n\t\t\tthis.remove_dirty_state();\n\t\t\tthis.make_output_nodes_dirty();\n\t\t}\n\t}\n\n\tset_lines(shaders_collection_controller: ShadersCollectionController) {\n\t\tconst param = this._current_param;\n\t\tif (param) {\n\t\t\tconst connection_type = this._current_connection_type;\n\t\t\tconst value = ThreeToGl.any(param.value);\n\t\t\tconst var_value = this._current_var_name;\n\t\t\tconst body_line = `${connection_type} ${var_value} = ${value}`;\n\t\t\tshaders_collection_controller.add_body_lines(this, [body_line]);\n\t\t} else {\n\t\t\tconsole.warn(`no param found for constant node for type '${this.pv.type}'`);\n\t\t}\n\t}\n\n\tprivate get _current_connection_type() {\n\t\tif (this.pv.type == null) {\n\t\t\tconsole.warn('constant gl node type if not valid');\n\t\t}\n\t\tconst connection_type = ConnectionPointTypes[this.pv.type];\n\t\tif (connection_type == null) {\n\t\t\tconsole.warn('constant gl node type if not valid');\n\t\t}\n\t\treturn connection_type;\n\t}\n\n\tprivate get _current_param(): BaseParamType {\n\t\tthis._params_by_type =\n\t\t\tthis._params_by_type ||\n\t\t\tnew Map<ConnectionPointType, BaseParamType>([\n\t\t\t\t[ConnectionPointType.BOOL, this.p.value_bool],\n\t\t\t\t[ConnectionPointType.INT, this.p.value_int],\n\t\t\t\t[ConnectionPointType.FLOAT, this.p.value_float],\n\t\t\t\t[ConnectionPointType.VEC2, this.p.value_vec2],\n\t\t\t\t[ConnectionPointType.VEC3, this.p.value_vec3],\n\t\t\t\t[ConnectionPointType.VEC4, this.p.value_vec4],\n\t\t\t]);\n\t\tconst connection_type = ConnectionPointTypes[this.pv.type];\n\t\treturn this._params_by_type.get(connection_type)!;\n\t}\n\tprivate get _current_var_name(): string {\n\t\treturn this.gl_var_name(this._current_connection_type);\n\t}\n\n\tprivate update_output_type() {\n\t\tconst current_connection = this.io.outputs.named_output_connection_points[0];\n\t\tif (current_connection && current_connection.type == this._current_connection_type) {\n\t\t\treturn;\n\t\t}\n\t\tthis.io.outputs.set_named_output_connection_points([\n\t\t\tnew TypedNamedConnectionPoint(this._current_connection_type, this._current_connection_type),\n\t\t]);\n\t}\n}\n","import {TypedGlNode} from './_Base';\nimport {ThreeToGl} from 'src/core/ThreeToGl';\n\nimport {TypedNamedConnectionPoint} from '../utils/connections/NamedConnectionPoint';\nimport {ConnectionPointType} from '../utils/connections/ConnectionPointType';\n\nconst OUTPUT_NAME = 'vec3';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ShadersCollectionController} from './code/utils/ShadersCollectionController';\nclass FloatToVec3GlParamsConfig extends NodeParamsConfig {\n\tx = ParamConfig.FLOAT(0);\n\ty = ParamConfig.FLOAT(0);\n\tz = ParamConfig.FLOAT(0);\n}\nconst ParamsConfig = new FloatToVec3GlParamsConfig();\nexport class FloatToVec3GlNode extends TypedGlNode<FloatToVec3GlParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'float_to_vec3';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.outputs.set_named_output_connection_points([\n\t\t\tnew TypedNamedConnectionPoint(OUTPUT_NAME, ConnectionPointType.VEC3),\n\t\t]);\n\t}\n\n\tset_lines(shaders_collection_controller: ShadersCollectionController) {\n\t\tconst x = this.variable_for_input('x');\n\t\tconst y = this.variable_for_input('y');\n\t\tconst z = this.variable_for_input('z');\n\n\t\tconst vec = this.gl_var_name(OUTPUT_NAME);\n\t\tconst body_line = `vec3 ${vec} = ${ThreeToGl.float3(x, y, z)}`;\n\t\tshaders_collection_controller.add_body_lines(this, [body_line]);\n\t}\n}\n","import {TypedGlNode} from './_Base';\n// import {ThreeToGl} from 'src/Core/ThreeToGl';\n// import {CodeBuilder} from './Util/CodeBuilder'\n// import {Definition} from './Definition/_Module';\n// import {ShaderName, LineType, LINE_TYPES} from './Assembler/Util/CodeBuilder';\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ShadersCollectionController} from './code/utils/ShadersCollectionController';\nclass OutputGlParamsConfig extends NodeParamsConfig {\n\t// type = ParamConfig.INTEGER(0, {\n\t// \tmenu: {\n\t// \t\tentries: ConnectionPointTypes.map((name, i) => {\n\t// \t\t\treturn {name: name, value: i};\n\t// \t\t}),\n\t// \t},\n\t// });\n\t// value_float = ParamConfig.FLOAT(0, ConstantGlNode.typed_visible_options(ConnectionPointType.FLOAT));\n\t// value_vec2 = ParamConfig.VECTOR2([0, 0], ConstantGlNode.typed_visible_options(ConnectionPointType.VEC2));\n\t// value_vec3 = ParamConfig.VECTOR3([0, 0, 0], ConstantGlNode.typed_visible_options(ConnectionPointType.VEC3));\n\t// value_vec4 = ParamConfig.VECTOR4([0, 0, 0, 0], ConstantGlNode.typed_visible_options(ConnectionPointType.VEC4));\n}\nconst ParamsConfig = new OutputGlParamsConfig();\n\nexport class OutputGlNode extends TypedGlNode<OutputGlParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'output';\n\t}\n\n\tcreate_params() {\n\t\tthis.material_node?.assembler_controller.add_output_params(this);\n\t}\n\n\tset_lines(shaders_collection_controller: ShadersCollectionController) {\n\t\t// if (shaders_collection_controller.shader_name) {\n\t\tthis.material_node?.assembler_controller.assembler.set_node_lines_output(this, shaders_collection_controller);\n\t\t// }\n\t}\n\n\t// set_color_declaration(color_declaration: string){\n\t// \tthis._color_declaration = color_declaration\n\t// }\n}\n","import {TypedGlNode} from './_Base';\nimport {TypedNamedConnectionPoint} from '../utils/connections/NamedConnectionPoint';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {\n\tConnectionPointTypes,\n\tConnectionPointType,\n\tConnectionPointInitValueMap,\n\tConnectionPointTypeToParamTypeMap,\n} from '../utils/connections/ConnectionPointType';\nimport lodash_isArray from 'lodash/isArray';\n\nconst OUTPUT_NAME = 'val';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {UniformGLDefinition} from './utils/GLDefinition';\nimport {ParamConfigsController} from '../utils/code/controllers/ParamConfigsController';\nimport {ShadersCollectionController} from './code/utils/ShadersCollectionController';\nclass ParamGlParamsConfig extends NodeParamsConfig {\n\tname = ParamConfig.STRING('');\n\ttype = ParamConfig.INTEGER(0, {\n\t\tmenu: {\n\t\t\tentries: ConnectionPointTypes.map((name, i) => {\n\t\t\t\treturn {name: name, value: i};\n\t\t\t}),\n\t\t},\n\t});\n\tas_color = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {type: ConnectionPointTypes.indexOf(ConnectionPointType.VEC3)},\n\t});\n}\nconst ParamsConfig = new ParamGlParamsConfig();\n\nexport class ParamGlNode extends TypedGlNode<ParamGlParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'param';\n\t}\n\tprotected _allow_inputs_created_from_params: boolean = false;\n\tprivate _update_if_type_changed_bound = this._update_if_type_changed.bind(this);\n\tinitialize_node() {\n\t\tthis.update_output_type();\n\n\t\tthis.add_post_dirty_hook('_update_if_type_changed', this._update_if_type_changed_bound);\n\t}\n\tprivate _update_if_type_changed(dirty_trigger?: CoreGraphNode) {\n\t\tif (dirty_trigger == this.p.type) {\n\t\t\tthis.update_output_type();\n\t\t\tthis.remove_dirty_state();\n\t\t\tthis.make_output_nodes_dirty();\n\t\t}\n\t}\n\n\tset_lines(shaders_collection_controller: ShadersCollectionController) {\n\t\tconst definitions = [];\n\n\t\tconst gl_type = ConnectionPointTypes[this.pv.type];\n\t\tconst var_name = this.uniform_name();\n\n\t\tdefinitions.push(new UniformGLDefinition(this, gl_type, var_name));\n\t\tshaders_collection_controller.add_definitions(this, definitions);\n\t}\n\tset_param_configs() {\n\t\tconst gl_type = ConnectionPointTypes[this.pv.type];\n\t\tconst default_value = ConnectionPointInitValueMap[gl_type];\n\t\tlet param_type = ConnectionPointTypeToParamTypeMap[gl_type];\n\n\t\tthis._param_configs_controller = this._param_configs_controller || new ParamConfigsController();\n\t\tthis._param_configs_controller.reset();\n\n\t\tif (\n\t\t\tparam_type == ParamType.VECTOR3 &&\n\t\t\tthis.p.as_color.value &&\n\t\t\tlodash_isArray(default_value) &&\n\t\t\tdefault_value.length == 3\n\t\t) {\n\t\t\tthis._param_configs_controller.create_and_push(\n\t\t\t\tParamType.COLOR,\n\t\t\t\tthis.pv.name,\n\t\t\t\tdefault_value,\n\t\t\t\tthis.uniform_name()\n\t\t\t);\n\t\t} else {\n\t\t\tthis._param_configs_controller.create_and_push(\n\t\t\t\tparam_type,\n\t\t\t\tthis.pv.name,\n\t\t\t\tdefault_value,\n\t\t\t\tthis.uniform_name()\n\t\t\t);\n\t\t}\n\t}\n\tuniform_name() {\n\t\tconst output_connection_point = this.io.outputs.named_output_connection_points[0];\n\t\tconst var_name = this.gl_var_name(output_connection_point.name);\n\t\treturn var_name;\n\t}\n\n\tupdate_output_type() {\n\t\tthis.io.outputs.set_named_output_connection_points([\n\t\t\tnew TypedNamedConnectionPoint(OUTPUT_NAME, ConnectionPointTypes[this.pv.type]),\n\t\t]);\n\t}\n}\n","import {VideoTexture} from 'three/src/textures/VideoTexture';\nimport {Vector4} from 'three/src/math/Vector4';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Vector2} from 'three/src/math/Vector2';\n\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {ParamInitValuesTypeMap} from 'src/engine/params/types/ParamInitValuesTypeMap';\nimport {ParamValuesTypeMap} from 'src/engine/params/types/ParamValuesTypeMap';\nimport {ParamConstructorByType} from 'src/engine/params/types/ParamConstructorByType';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {TypedParam, BaseParamType} from 'src/engine/params/_Base';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {TypeAssert} from 'src/engine/poly/Assert';\nimport {IUniform} from 'three/src/renderers/shaders/UniformsLib';\n// import { RampValue } from 'src/engine/params/ramp/RampValue';\nimport {RampParam} from 'src/engine/params/Ramp';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\n// import {ParamValueComparer} from 'src/engine/nodes/utils/params/ParamValueComparer';\n// import {ParamValueCloner} from 'src/engine/nodes/utils/params/ParamValueCloner';\n// import {CoreTextureLoader} from 'src/Core/Loader/Texture'\n\nexport class ParamConfig<T extends ParamType> {\n\tprivate _uniform: IUniform | undefined;\n\tprivate _cached_param_value: ParamValuesTypeMap[T] | undefined;\n\t// private _texture_loader: CoreTextureLoader\n\n\tconstructor(\n\t\tprivate _type: T,\n\t\tprivate _name: string,\n\t\tprivate _default_value: ParamInitValuesTypeMap[T],\n\t\tprivate _uniform_name: string\n\t) {}\n\n\tstatic from_param<K extends ParamType>(param: TypedParam<K>, uniform_name: string): ParamConfig<K> {\n\t\treturn new ParamConfig<K>(param.type, param.name, param.default_value, uniform_name);\n\t}\n\n\tget type() {\n\t\treturn this._type;\n\t}\n\tget name() {\n\t\treturn this._name;\n\t}\n\tget default_value() {\n\t\treturn this._default_value;\n\t}\n\tget uniform_name() {\n\t\treturn this._uniform_name;\n\t}\n\n\tget uniform() {\n\t\treturn (this._uniform = this._uniform || this._create_uniform());\n\t}\n\n\tprivate _create_uniform() {\n\t\treturn ParamConfig.uniform_by_type(this._type);\n\t}\n\n\tget param_options() {\n\t\tconst callback_bound = this._callback.bind(this);\n\t\tswitch (this._type) {\n\t\t\tcase ParamType.OPERATOR_PATH:\n\t\t\t\treturn {callback: callback_bound, node_selection: {context: NodeContext.COP}}; // TODO: typescript - why is COP here?\n\t\t\tdefault:\n\t\t\t\treturn {callback: callback_bound};\n\t\t}\n\t}\n\n\tprivate _callback(node: BaseNodeType, param: BaseParamType) {\n\t\t// console.log('callback', node, param, param.value);\n\t\tthis.uniform.value = param.value;\n\t}\n\n\t// TODO: refactor that to use the default values map?\n\tstatic uniform_by_type(type: ParamType): IUniform {\n\t\tswitch (type) {\n\t\t\tcase ParamType.BOOLEAN:\n\t\t\t\treturn {value: 0};\n\t\t\tcase ParamType.BUTTON:\n\t\t\t\treturn {value: 0};\n\t\t\tcase ParamType.COLOR:\n\t\t\t\treturn {value: new Vector3(0, 0, 0)};\n\t\t\tcase ParamType.FLOAT:\n\t\t\t\treturn {value: 0};\n\t\t\tcase ParamType.FOLDER:\n\t\t\t\treturn {value: 0};\n\t\t\tcase ParamType.INTEGER:\n\t\t\t\treturn {value: 0};\n\t\t\tcase ParamType.OPERATOR_PATH:\n\t\t\t\treturn {value: 0};\n\t\t\t// case ParamType.STRING: return {type: 't', value: null} // new Texture()}\n\t\t\tcase ParamType.RAMP:\n\t\t\t\treturn {value: null}; // new Texture()}\n\t\t\tcase ParamType.SEPARATOR:\n\t\t\t\treturn {value: 0};\n\t\t\tcase ParamType.STRING:\n\t\t\t\treturn {value: null};\n\t\t\tcase ParamType.VECTOR2:\n\t\t\t\treturn {value: new Vector2(0, 0)};\n\t\t\tcase ParamType.VECTOR3:\n\t\t\t\treturn {value: new Vector3(0, 0, 0)};\n\t\t\tcase ParamType.VECTOR4:\n\t\t\t\treturn {value: new Vector4(0, 0, 0, 0)};\n\t\t}\n\t\tTypeAssert.unreachable(type);\n\t}\n\n\tasync set_uniform_value(node: BaseNodeType) {\n\t\t// return new Promise( async (resolve, reject)=>{\n\t\tconst uniform = this.uniform;\n\t\t// the cache cannot be trusted...\n\t\tconst param = node.params.get(this._name) as TypedParam<T>;\n\t\tif (param) {\n\t\t\tawait param.compute(); //node[node.param_cache_name(this._name)]\n\t\t\tconst value = param.value;\n\n\t\t\tif ((value != null && this.has_value_changed(value)) || this.is_video_texture()) {\n\t\t\t\t// this._update_cached_value(value);\n\t\t\t\t// console.log(this._name, value)\n\n\t\t\t\tswitch (this._type) {\n\t\t\t\t\tcase ParamType.OPERATOR_PATH: {\n\t\t\t\t\t\tawait this.set_uniform_value_from_texture((<unknown>param) as OperatorPathParam, uniform);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase ParamType.RAMP: {\n\t\t\t\t\t\tthis.set_uniform_value_from_ramp((<unknown>param) as RampParam, uniform);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tdefault: {\n\t\t\t\t\t\tuniform.value = param.value;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// resolve()\n\t\t\t} // else {\n\t\t\t//\tresolve()\n\t\t\t//}\n\t\t\t// })\n\t\t}\n\t}\n\n\tasync set_uniform_value_from_texture(param: OperatorPathParam, uniform: IUniform) {\n\t\t// this._texture_loader = this._texture_loader || new CoreTextureLoader(node, node.param(this.name()))\n\n\t\t// // param.graph_disconnect_predecessors()\n\t\t// const texture = await this._texture_loader.load_texture_from_url_or_op( url );\n\t\t// uniform.value = texture\n\t\tconst found_node = param.found_node();\n\t\tif (found_node) {\n\t\t\tconst container = await found_node.request_container();\n\t\t\tconst texture = container.texture();\n\t\t\tuniform.value = texture;\n\t\t} else {\n\t\t\tuniform.value = null;\n\t\t}\n\t}\n\n\tset_uniform_value_from_ramp(param: RampParam, uniform: IUniform) {\n\t\tuniform.value = param.ramp_texture();\n\t}\n\n\thas_value_changed(new_value: ParamValuesTypeMap[T]): boolean {\n\t\tconst param_constructor = ParamConstructorByType[this._type];\n\t\tif (this._cached_param_value) {\n\t\t\tconst has_changed = !param_constructor.are_values_equal(new_value, this._cached_param_value);\n\t\t\tif (has_changed) {\n\t\t\t\tthis._cached_param_value = param_constructor.clone_value(new_value);\n\t\t\t}\n\t\t\treturn has_changed;\n\t\t} else {\n\t\t\tthis._cached_param_value = param_constructor.clone_value(new_value);\n\t\t\treturn false;\n\t\t}\n\n\t\t// let has_changed = false;\n\t\t// if (this._type == ParamType.RAMP) {\n\t\t// \thas_changed = new_value.uuid() != this._cached_param_value;\n\t\t// \t// if(has_changed){ this._cached_param_value = new_value.uuid() }\n\t\t// } else {\n\t\t// \tif (this._cached_param_value != null) {\n\t\t// \t\tif (lodash_isString(new_value) || lodash_isNumber(new_value)) {\n\t\t// \t\t\t// console.log(\"new f\", new_value, this._cached_param_value)\n\t\t// \t\t\thas_changed = this._cached_param_value != new_value;\n\t\t// \t\t} else {\n\t\t// \t\t\tif (new_value != null) {\n\t\t// \t\t\t\t// console.log(\"new v\", new_value, this._cached_param_value)\n\t\t// \t\t\t\thas_changed = new_value.toArray().join('.') != this._cached_param_value.toArray().join('.');\n\t\t// \t\t\t} else {\n\t\t// \t\t\t\thas_changed = this._cached_param_value != new_value;\n\t\t// \t\t\t}\n\t\t// \t\t}\n\t\t// \t} else {\n\t\t// \t\thas_changed = true;\n\t\t// \t}\n\t\t// \t// this._cached_param_value = new_value\n\t\t// }\n\t\t// return has_changed;\n\t}\n\t// private _update_cached_value(new_value) {\n\t// \t// console.log(\"_update_cached_value\", this._name, new_value)\n\t// \tif (this._type == 'ramp') {\n\t// \t\tthis._cached_param_value = new_value.uuid();\n\t// \t} else {\n\t// \t\tif (lodash_isString(new_value) || lodash_isNumber(new_value)) {\n\t// \t\t\tthis._cached_param_value = new_value;\n\t// \t\t} else {\n\t// \t\t\t// make sure to copy the value, not assign to it\n\t// \t\t\t// otherwise we won't detect changes (since the objects would be the same)\n\t// \t\t\tthis._cached_param_value = this._cached_param_value || new_value.clone();\n\t// \t\t\tthis._cached_param_value.copy(new_value);\n\t// \t\t}\n\t// \t}\n\t// }\n\n\tis_video_texture(): boolean {\n\t\tlet result = false;\n\t\tconst uniform = this.uniform;\n\t\tif (uniform) {\n\t\t\tconst value = uniform.value;\n\t\t\tif (value) {\n\t\t\t\tresult = value.constructor == VideoTexture;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {CATEGORY_MAT} from './Category';\n\nimport {MeshBasicMatNode} from 'src/engine/nodes/mat/MeshBasic';\nimport {MeshBasicBuilderMatNode} from 'src/engine/nodes/mat/MeshBasicBuilder';\nimport {MeshLambertMatNode} from 'src/engine/nodes/mat/MeshLambert';\nimport {MeshStandardMatNode} from 'src/engine/nodes/mat/MeshStandard';\nimport {PointsMatNode} from 'src/engine/nodes/mat/Points';\n\nexport interface MatNodeChildrenMap {\n\tmesh_basic: MeshBasicMatNode;\n\tmesh_basic_builder: MeshBasicBuilderMatNode;\n\tmesh_lambert: MeshLambertMatNode;\n\tmesh_standard: MeshStandardMatNode;\n\tpoints: PointsMatNode;\n}\n\nimport {Poly} from 'src/engine/Poly';\nexport class MatRegister {\n\tstatic run(poly: Poly) {\n\t\tpoly.register_node(MeshBasicMatNode, CATEGORY_MAT.MESH);\n\t\tpoly.register_node(MeshBasicBuilderMatNode, CATEGORY_MAT.ADVANCED);\n\t\tpoly.register_node(MeshLambertMatNode, CATEGORY_MAT.MESH);\n\t\tpoly.register_node(MeshStandardMatNode, CATEGORY_MAT.MESH);\n\t\tpoly.register_node(PointsMatNode, CATEGORY_MAT.POINTS);\n\t}\n}\n","import {NoColors} from 'three/src/constants';\nimport {MeshBasicMaterial} from 'three/src/materials/MeshBasicMaterial';\nimport {FrontSide} from 'three/src/constants';\nimport {TypedMatNode} from './_Base';\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ColorsController, ColorParamConfig} from './utils/ColorsController';\nimport {SideController, SideParamConfig} from './utils/SideController';\nimport {SkinningController, SkinningParamConfig} from './utils/SkinningController';\nimport {TextureMapController, TextureMapParamConfig} from './utils/TextureMapController';\nimport {TextureAlphaMapController, TextureAlphaMapParamConfig} from './utils/TextureAlphaMapController';\nclass MeshBasicMatParamsConfig extends TextureAlphaMapParamConfig(\n\tTextureMapParamConfig(SkinningParamConfig(SideParamConfig(ColorParamConfig(NodeParamsConfig))))\n) {}\nconst ParamsConfig = new MeshBasicMatParamsConfig();\n\nexport class MeshBasicMatNode extends TypedMatNode<MeshBasicMaterial, MeshBasicMatParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'mesh_basic';\n\t}\n\n\tcreate_material() {\n\t\treturn new MeshBasicMaterial({\n\t\t\tvertexColors: NoColors,\n\t\t\tside: FrontSide,\n\t\t\tcolor: 0xffffff,\n\t\t\topacity: 1,\n\t\t});\n\t}\n\treadonly texture_map_controller: TextureMapController = new TextureMapController(this);\n\treadonly texture_alpha_map_controller: TextureAlphaMapController = new TextureAlphaMapController(this);\n\tinitialize_node() {\n\t\tthis.params.set_post_create_params_hook(() => {\n\t\t\tthis.texture_map_controller.initialize_node();\n\t\t\tthis.texture_alpha_map_controller.initialize_node();\n\t\t});\n\t}\n\tasync cook() {\n\t\tColorsController.update(this);\n\t\tSideController.update(this);\n\t\tSkinningController.update(this);\n\t\tthis.texture_map_controller.update();\n\t\tthis.texture_alpha_map_controller.update();\n\n\t\tthis.set_material(this.material);\n\t}\n}\n","import {Material} from 'three/src/materials/Material';\nimport {TypedContainer} from './_Base';\nimport {ContainableMap} from './utils/ContainableMap';\n\nexport class MaterialContainer extends TypedContainer<ContainableMap['MATERIAL']> {\n\tset_content(content: ContainableMap['MATERIAL']) {\n\t\tsuper.set_content(content);\n\t}\n\tset_material(material: Material) {\n\t\tif (this._content != null) {\n\t\t\tthis._content.dispose();\n\t\t}\n\t\tthis.set_content(material);\n\t}\n\thas_material() {\n\t\treturn this.has_content();\n\t}\n\tmaterial() {\n\t\treturn this.content();\n\t}\n}\n","import {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ColorParamConfig} from './utils/ColorsController';\nimport {SideParamConfig} from './utils/SideController';\nimport {SkinningParamConfig} from './utils/SkinningController';\nimport {TextureMapParamConfig} from './utils/TextureMapController';\nimport {TextureAlphaMapParamConfig} from './utils/TextureAlphaMapController';\nimport {ShaderAssemblerBasic} from '../gl/code/assemblers/Basic';\nimport {TypedBuilderMatNode} from './_BaseBuilder';\nimport {GlAssemblerController} from '../gl/code/Controller';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nclass MeshBasicMatParamsConfig extends TextureAlphaMapParamConfig(\n\tTextureMapParamConfig(SkinningParamConfig(SideParamConfig(ColorParamConfig(NodeParamsConfig))))\n) {}\nconst ParamsConfig = new MeshBasicMatParamsConfig();\n\nexport class MeshBasicBuilderMatNode extends TypedBuilderMatNode<ShaderAssemblerBasic, MeshBasicMatParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'mesh_basic_builder';\n\t}\n\n\tprotected _children_controller_context = NodeContext.GL;\n\tinitialize_node() {\n\t\tthis.children_controller?.init();\n\n\t\t// this.add_post_dirty_hook('gl compile', (trigger_node?: CoreGraphNode) => {\n\n\t\t// \tconsole.log('gl dirty');\n\t\t// });\n\t}\n\n\tprotected _create_assembler_controller() {\n\t\treturn new GlAssemblerController<ShaderAssemblerBasic>(this, ShaderAssemblerBasic);\n\t}\n\n\tasync cook() {\n\t\tthis.compile_if_required();\n\n\t\t// ColorsController.update(this);\n\t\t// SideController.update(this);\n\t\t// SkinningController.update(this);\n\t\t// await TextureMapController.update(this);\n\t\t// await TextureAlphaMapController.update(this);\n\n\t\tthis.set_material(this.material);\n\t}\n\n\tprotected async _compile() {\n\t\tif (this._material) {\n\t\t\tawait this.assembler_controller.assembler.compile_material(this._material);\n\t\t\tawait this.assembler_controller.post_compile();\n\t\t}\n\n\t\t// console.log(this._material.vertexShader);\n\t\t// console.log(this._material.fragmentShader);\n\t}\n}\n","import {VertexColors} from 'three/src/constants';\nimport {UniformsUtils} from 'three/src/renderers/shaders/UniformsUtils';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\nimport {ShaderLib} from 'three/src/renderers/shaders/ShaderLib';\nimport {FrontSide} from 'three/src/constants';\n\nimport {ShaderAssemblerMesh} from './_BaseMesh';\n\n// import TemplateVertex from './Template/Basic.vert.glsl'\n// import TemplateFragment from './Template/Basic.frag.glsl'\n\nexport class ShaderAssemblerBasic extends ShaderAssemblerMesh {\n\t// _color_declaration() { return 'gl_FragColor' }\n\tget _template_shader() {\n\t\tconst template = ShaderLib.basic;\n\t\treturn {\n\t\t\tvertexShader: template.vertexShader, //TemplateVertex,\n\t\t\tfragmentShader: template.fragmentShader, //TemplateFragment,\n\t\t\tuniforms: template.uniforms,\n\t\t};\n\t}\n\t_create_material() {\n\t\tconst template_shader = this._template_shader;\n\n\t\treturn new ShaderMaterial({\n\t\t\tvertexColors: VertexColors,\n\t\t\tside: FrontSide,\n\t\t\ttransparent: true,\n\t\t\tfog: true,\n\t\t\tlights: false,\n\t\t\tdepthTest: true,\n\t\t\talphaTest: 0.5,\n\n\t\t\tuniforms: UniformsUtils.clone(template_shader.uniforms),\n\t\t\tvertexShader: template_shader.vertexShader,\n\t\t\tfragmentShader: template_shader.fragmentShader,\n\t\t});\n\t}\n}\n","import {ShaderAssemblerRender, CustomAssemblerMap, CustomMaterialName} from './_BaseRender';\n\nimport {ShaderAssemblerCustomMeshDistance} from './CustomMeshDistance';\nimport {ShaderAssemblerCustomMeshDepth} from './CustomMeshDepth';\nimport {ShaderAssemblerCustomMeshDepthDOF} from './CustomMeshDepthDOF';\nimport {GlNodeFinder} from '../utils/NodeFinder';\nimport {ShaderMaterialWithCustomMaterials} from 'src/core/geometry/Material';\nimport {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\n\nconst ASSEMBLER_MAP: CustomAssemblerMap = new Map([\n\t// [CustomMaterialName.DISTANCE, ShaderAssemblerCustomMeshDistance],\n\t// [CustomMaterialName.DEPTH, ShaderAssemblerCustomMeshDepth],\n\t// [CustomMaterialName.DEPTH_DOF, ShaderAssemblerCustomMeshDepthDOF],\n]);\nASSEMBLER_MAP.set(CustomMaterialName.DISTANCE, ShaderAssemblerCustomMeshDistance);\nASSEMBLER_MAP.set(CustomMaterialName.DEPTH, ShaderAssemblerCustomMeshDepth);\nASSEMBLER_MAP.set(CustomMaterialName.DEPTH_DOF, ShaderAssemblerCustomMeshDepthDOF);\n\nexport abstract class ShaderAssemblerMesh extends ShaderAssemblerRender {\n\t// TODO: I've noticed a case where instances would not display when those shadow shaders were exported\n\t// But the objects display fine if those are not assigned\n\t// so it could be a bug at render time (not sure if my code, threejs or hardware)\n\tcustom_assembler_class_by_custom_name(): CustomAssemblerMap {\n\t\treturn ASSEMBLER_MAP;\n\t}\n\n\tasync compile_material(material: ShaderMaterialWithCustomMaterials) {\n\t\t// no need to compile if the globals handler has not been declared\n\t\tif (!this.compile_allowed()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst output_nodes = GlNodeFinder.find_output_nodes(this._gl_parent_node);\n\t\tif (output_nodes.length > 1) {\n\t\t\tthis._gl_parent_node.states.error.set('only one output node allowed');\n\t\t}\n\t\tthis.set_root_nodes(output_nodes);\n\t\tawait this._update_shaders();\n\n\t\tconst new_vertex_shader = this._shaders_by_name.get(ShaderName.VERTEX);\n\t\tconst new_fragment_shader = this._shaders_by_name.get(ShaderName.FRAGMENT);\n\t\tif (new_vertex_shader && new_fragment_shader) {\n\t\t\tmaterial.vertexShader = new_vertex_shader;\n\t\t\tmaterial.fragmentShader = new_fragment_shader;\n\t\t\t// console.log(material.fragmentShader);\n\t\t\tmaterial.uniforms = this.build_uniforms(this._template_shader?.uniforms);\n\t\t\tmaterial.needsUpdate = true;\n\t\t}\n\n\t\t// const material = await this._assembler.get_material();\n\t\t// if (material) {\n\t\t// this._shaders_by_name.set(ShaderName.VERTEX, this._template_shader!.vertexShader!);\n\t\t// this._shaders_by_name.set(ShaderName.FRAGMENT, this._template_shader!.fragmentShader!);\n\n\t\t// assign custom materials\n\t\tawait this.compile_custom_materials(material);\n\t\t// const custom_materials = await this.get_custom_materials();\n\t\t// const material_with_custom_materials = material as ShaderMaterialWithCustomMaterials;\n\t\t// material_with_custom_materials.custom_materials = {};\n\t\t// custom_materials.forEach((custom_material, shader_name) => {\n\t\t// \tmaterial_with_custom_materials.custom_materials[shader_name] = custom_material;\n\t\t// });\n\n\t\t// material.needsUpdate = true;\n\t\t// }\n\n\t\t// this.create_spare_parameters();\n\t}\n\tprivate async _update_shaders() {\n\t\tthis._shaders_by_name = new Map();\n\t\tthis._lines = new Map();\n\t\tfor (let shader_name of this.shader_names) {\n\t\t\tconst template = this._template_shader_for_shader_name(shader_name);\n\t\t\tif (template) {\n\t\t\t\tthis._lines.set(shader_name, template.split('\\n'));\n\t\t\t}\n\t\t}\n\t\tif (this._root_nodes.length > 0) {\n\t\t\t// this._output_node.set_assembler(this)\n\t\t\tawait this.build_code_from_nodes(this._root_nodes);\n\n\t\t\tthis._build_lines();\n\t\t}\n\t\t// this._material.uniforms = this.build_uniforms(template_shader)\n\t\tfor (let shader_name of this.shader_names) {\n\t\t\tconst lines = this._lines.get(shader_name);\n\t\t\tif (lines) {\n\t\t\t\tthis._shaders_by_name.set(shader_name, lines.join('\\n'));\n\t\t\t}\n\t\t}\n\t}\n}\n","import {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\n\nexport class ShaderConfig {\n\tconstructor(private _name: ShaderName, private _input_names: string[], private _dependencies: ShaderName[]) {}\n\n\tname() {\n\t\treturn this._name;\n\t}\n\tinput_names() {\n\t\treturn this._input_names;\n\t}\n\tdependencies() {\n\t\treturn this._dependencies;\n\t}\n}\n","interface VariableConfigOptions {\n\t// asset refererences\n\tdefault_from_attribute?: boolean;\n\tdefault?: string;\n\tif?: string;\n\tprefix?: string;\n\tsuffix?: string;\n}\n\nexport class VariableConfig {\n\tconstructor(private _name: string, private _options: VariableConfigOptions = {}) {}\n\n\tname() {\n\t\treturn this._name;\n\t}\n\tdefault_from_attribute() {\n\t\treturn this._options['default_from_attribute'] || false;\n\t}\n\tdefault() {\n\t\treturn this._options['default'];\n\t}\n\tif_condition() {\n\t\treturn this._options['if'];\n\t}\n\t// required_definitions(){\n\t// \treturn this._options['required_definitions']\n\t// }\n\tprefix() {\n\t\treturn this._options['prefix'] || '';\n\t}\n\tsuffix() {\n\t\treturn this._options['suffix'] || '';\n\t}\n}\n","import lodash_uniq from 'lodash/uniq';\nimport {BaseGlNodeType} from '../../_Base';\nimport {TypedNodeTraverser} from '../../../utils/shaders/NodeTraverser';\nimport {BaseNodeType} from '../../../_Base';\nimport {BaseGlShaderAssembler} from '../assemblers/_Base';\nimport {MapUtils} from 'src/core/MapUtils';\nimport {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\nimport {GLDefinitionType, BaseGLDefinition} from '../../utils/GLDefinition';\nimport {TypedGLDefinitionCollection} from '../../utils/GLDefinitionCollection';\nimport {ParamConfigsController} from 'src/engine/nodes/utils/code/controllers/ParamConfigsController';\nimport {ShadersCollectionController} from './ShadersCollectionController';\nimport {CodeFormatter} from './CodeFormatter';\n\nimport {LineType} from './LineType';\n\nexport class CodeBuilder {\n\t_param_configs_controller: ParamConfigsController = new ParamConfigsController();\n\t_param_configs_set_allowed: boolean = true;\n\n\tprivate _shaders_collection_controller: ShadersCollectionController | undefined;\n\t_lines: Map<ShaderName, Map<LineType, string[]>> = new Map();\n\t_function_declared: Map<ShaderName, Map<string, boolean>> = new Map();\n\n\tconstructor(private _assembler: BaseGlShaderAssembler, private _gl_parent_node: BaseNodeType) {}\n\n\tasync build_from_nodes(root_nodes: BaseGlNodeType[]) {\n\t\tconst node_traverser = new TypedNodeTraverser<BaseGlNodeType>(this._assembler, this._gl_parent_node);\n\t\tnode_traverser.traverse(root_nodes);\n\n\t\tconst nodes_by_shader_name: Map<ShaderName, BaseGlNodeType[]> = new Map();\n\t\tfor (let shader_name of this.shader_names()) {\n\t\t\tnodes_by_shader_name.set(shader_name, node_traverser.nodes_for_shader_name(shader_name));\n\t\t}\n\t\tconst sorted_nodes = node_traverser.sorted_nodes();\n\t\tfor (let shader_name of this.shader_names()) {\n\t\t\tconst root_nodes_for_shader = this._assembler.root_nodes_by_shader_name(shader_name);\n\t\t\tconst leaf_nodes_for_shader = this._assembler.leaf_nodes_by_shader_name(shader_name);\n\n\t\t\t// keep track of which nodes are both leaf and root, and do not use their code twice\n\t\t\t// as this may happen with an attribute node, when used as both import and export\n\t\t\t// TODO: that seems useless, as I surely should be able to filter duplicates if needed\n\n\t\t\t// ensure nodes are unique\n\t\t\tconst node_ids: Map<string, boolean> = new Map();\n\t\t\tnodes_by_shader_name.forEach((nodes, shader_name) => {\n\t\t\t\tfor (let node of nodes) {\n\t\t\t\t\tnode_ids.set(node.graph_node_id, true);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (let root_node of root_nodes_for_shader) {\n\t\t\t\t// if(!both_leaf_and_root_nodes_by_id[root_node.graph_node_id()]){\n\t\t\t\tif (!node_ids.get(root_node.graph_node_id)) {\n\t\t\t\t\tMapUtils.push_on_array_at_entry(nodes_by_shader_name, shader_name, root_node);\n\t\t\t\t\tnode_ids.set(root_node.graph_node_id, true);\n\t\t\t\t}\n\t\t\t\t// }\n\t\t\t}\n\t\t\tfor (let leaf_node of leaf_nodes_for_shader) {\n\t\t\t\t// if(!both_leaf_and_root_nodes_by_id[leaf_node.graph_node_id()]){\n\t\t\t\tif (!node_ids.get(leaf_node.graph_node_id)) {\n\t\t\t\t\tMapUtils.unshift_on_array_at_entry(nodes_by_shader_name, shader_name, leaf_node);\n\t\t\t\t}\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\n\t\t// ensure nodes are not added if already present\n\t\tconst sorted_node_ids: Map<string, boolean> = new Map();\n\t\tfor (let node of sorted_nodes) {\n\t\t\tsorted_node_ids.set(node.graph_node_id, true);\n\t\t}\n\n\t\tfor (let root_node of root_nodes) {\n\t\t\tif (!sorted_node_ids.get(root_node.graph_node_id)) {\n\t\t\t\tsorted_nodes.push(root_node);\n\t\t\t\tsorted_node_ids.set(root_node.graph_node_id, true);\n\t\t\t}\n\t\t}\n\t\tfor (let node of sorted_nodes) {\n\t\t\t// node.set_assembler(this._assembler);\n\t\t\tnode.reset_code();\n\t\t}\n\t\tfor (let node of sorted_nodes) {\n\t\t\tawait node.params.eval_all();\n\t\t}\n\n\t\t// const param_promises = sorted_nodes.map(node=>{\n\t\t// \treturn node.eval_all_params()\n\t\t// })\n\t\t// await Promise.all(param_promises)\n\n\t\tthis._shaders_collection_controller = new ShadersCollectionController(\n\t\t\tthis.shader_names(),\n\t\t\tthis.shader_names()[0]\n\t\t);\n\t\tthis.reset();\n\t\tfor (let shader_name of this.shader_names()) {\n\t\t\tconst nodes = nodes_by_shader_name.get(shader_name);\n\t\t\tthis._shaders_collection_controller.set_current_shader_name(shader_name);\n\t\t\tif (nodes) {\n\t\t\t\tfor (let node of nodes) {\n\t\t\t\t\t// node.set_shader_name(shader_name);\n\t\t\t\t\tif (this._param_configs_set_allowed) {\n\t\t\t\t\t\tnode.set_param_configs();\n\t\t\t\t\t}\n\t\t\t\t\tnode.set_lines(this._shaders_collection_controller);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// fragment_nodes.forEach(node=>{\n\t\t// \tnode.set_shader_name(ShaderName.FRAGMENT)\n\t\t// \tnode.set_param_configs()\n\t\t// \tnode.set_lines()\n\t\t// })\n\t\tif (this._param_configs_set_allowed) {\n\t\t\tthis.set_param_configs(sorted_nodes);\n\t\t}\n\t\tthis.set_code_lines(sorted_nodes);\n\t}\n\n\tdisallow_new_param_configs() {\n\t\tthis._param_configs_set_allowed = false;\n\t}\n\tallow_new_param_configs() {\n\t\tthis._param_configs_set_allowed = true;\n\t}\n\n\tshader_names() {\n\t\treturn this._assembler.shader_names;\n\t}\n\n\tprivate reset() {\n\t\tfor (let shader_name of this.shader_names()) {\n\t\t\tconst lines_map = new Map();\n\t\t\t// for (let line_type of LINE_TYPES) {\n\t\t\t// \tlines_map.set(line_type, []);\n\t\t\t// }\n\t\t\tthis._lines.set(shader_name, lines_map);\n\t\t\tthis._function_declared.set(shader_name, new Map());\n\t\t}\n\t}\n\n\tparam_configs() {\n\t\treturn this._param_configs_controller.list || [];\n\t}\n\tlines(shader_name: ShaderName, line_type: LineType) {\n\t\treturn this._lines.get(shader_name)!.get(line_type);\n\t}\n\tall_lines() {\n\t\treturn this._lines;\n\t}\n\n\tset_param_configs(nodes: BaseGlNodeType[]) {\n\t\tthis._param_configs_controller.reset();\n\t\tfor (let node of nodes) {\n\t\t\tconst param_configs = node.param_configs();\n\t\t\tif (param_configs) {\n\t\t\t\tfor (let param_config of param_configs) {\n\t\t\t\t\tthis._param_configs_controller.push(param_config);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tset_code_lines(nodes: BaseGlNodeType[]) {\n\t\tfor (let shader_name of this.shader_names()) {\n\t\t\t// nodes.forEach((node, i)=>{\n\t\t\tthis.add_code_lines(nodes, shader_name);\n\t\t\t// })\n\t\t}\n\t}\n\n\tadd_code_lines(nodes: BaseGlNodeType[], shader_name: ShaderName) {\n\t\tthis.add_definitions(nodes, shader_name, GLDefinitionType.FUNCTION, LineType.FUNCTION_DECLARATION);\n\t\tthis.add_definitions(nodes, shader_name, GLDefinitionType.UNIFORM, LineType.DEFINE);\n\t\tthis.add_definitions(nodes, shader_name, GLDefinitionType.VARYING, LineType.DEFINE);\n\t\tthis.add_definitions(nodes, shader_name, GLDefinitionType.ATTRIBUTE, LineType.DEFINE);\n\n\t\tthis.add_code_line_for_nodes_and_line_type(nodes, shader_name, LineType.BODY);\n\t}\n\n\tprivate add_definitions(\n\t\tnodes: BaseGlNodeType[],\n\t\tshader_name: ShaderName,\n\t\tdefinition_type: GLDefinitionType,\n\t\tline_type: LineType\n\t) {\n\t\tif (!this._shaders_collection_controller) {\n\t\t\treturn;\n\t\t}\n\t\tconst definitions = [];\n\t\tfor (let node of nodes) {\n\t\t\tlet node_definitions = this._shaders_collection_controller.definitions(shader_name, node);\n\t\t\tif (node_definitions) {\n\t\t\t\tnode_definitions = node_definitions.filter((d) => d.definition_type == definition_type);\n\t\t\t\tfor (let definition of node_definitions) {\n\t\t\t\t\tdefinitions.push(definition);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (definitions.length > 0) {\n\t\t\tconst collection = new TypedGLDefinitionCollection<GLDefinitionType>(definitions);\n\t\t\tconst uniq_definitions = collection.uniq();\n\t\t\tif (collection.errored) {\n\t\t\t\t// TODO: handle error\n\t\t\t\tthrow `code builder error: ${collection.error_message}`;\n\t\t\t}\n\n\t\t\tconst definitions_by_node_id: Map<string, BaseGLDefinition[]> = new Map();\n\t\t\tconst node_ids: Map<string, boolean> = new Map();\n\t\t\tfor (let definition of uniq_definitions) {\n\t\t\t\tconst node_id = definition.node.graph_node_id;\n\t\t\t\tif (!node_ids.has(node_id)) {\n\t\t\t\t\tnode_ids.set(node_id, true);\n\t\t\t\t}\n\t\t\t\tMapUtils.push_on_array_at_entry(definitions_by_node_id, node_id, definition);\n\t\t\t}\n\t\t\tconst lines_for_shader = this._lines.get(shader_name)!;\n\t\t\tnode_ids.forEach((boolean: boolean, node_id: string) => {\n\t\t\t\tconst definitions = definitions_by_node_id.get(node_id);\n\t\t\t\tif (definitions) {\n\t\t\t\t\tconst first_definition = definitions[0];\n\n\t\t\t\t\tif (first_definition) {\n\t\t\t\t\t\tconst comment = CodeFormatter.node_comment(first_definition.node, line_type);\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(lines_for_shader, line_type, comment);\n\n\t\t\t\t\t\tfor (let definition of definitions) {\n\t\t\t\t\t\t\tconst line = CodeFormatter.line_wrap(definition.line, line_type);\n\t\t\t\t\t\t\tMapUtils.push_on_array_at_entry(lines_for_shader, line_type, line);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst separator = CodeFormatter.post_line_separator(line_type);\n\t\t\t\t\t\tMapUtils.push_on_array_at_entry(lines_for_shader, line_type, separator);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\tadd_code_line_for_nodes_and_line_type(nodes: BaseGlNodeType[], shader_name: ShaderName, line_type: LineType) {\n\t\tnodes = nodes.filter((node) => {\n\t\t\tif (this._shaders_collection_controller) {\n\t\t\t\tconst lines = this._shaders_collection_controller.body_lines(shader_name, node);\n\t\t\t\treturn lines && lines.length > 0;\n\t\t\t}\n\t\t});\n\n\t\tvar nodes_count = nodes.length;\n\t\tfor (let i = 0; i < nodes_count; i++) {\n\t\t\tconst is_last = i == nodes.length - 1;\n\t\t\tthis.add_code_line_for_node_and_line_type(nodes[i], shader_name, line_type, is_last);\n\t\t}\n\t}\n\tadd_code_line_for_node_and_line_type(\n\t\tnode: BaseGlNodeType,\n\t\tshader_name: ShaderName,\n\t\tline_type: LineType,\n\t\tis_last: boolean\n\t): void {\n\t\tif (!this._shaders_collection_controller) {\n\t\t\treturn;\n\t\t}\n\t\tconst lines = this._shaders_collection_controller.body_lines(shader_name, node);\n\n\t\tif (lines && lines.length > 0) {\n\t\t\tconst lines_for_shader = this._lines.get(shader_name)!;\n\t\t\tconst comment = CodeFormatter.node_comment(node, line_type);\n\t\t\tMapUtils.push_on_array_at_entry(lines_for_shader, line_type, comment);\n\t\t\tlodash_uniq(lines).forEach((line) => {\n\t\t\t\tline = CodeFormatter.line_wrap(line, line_type);\n\t\t\t\tMapUtils.push_on_array_at_entry(lines_for_shader, line_type, line);\n\t\t\t});\n\t\t\tif (!(line_type == LineType.BODY && is_last)) {\n\t\t\t\tconst separator = CodeFormatter.post_line_separator(line_type);\n\t\t\t\tMapUtils.push_on_array_at_entry(lines_for_shader, line_type, separator);\n\t\t\t}\n\t\t}\n\t}\n}\n","import {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\nimport {BaseGLDefinition} from '../../utils/GLDefinition';\nimport {LinesController} from './LinesController';\nimport {BaseGlNodeType} from '../../_Base';\n\nexport class ShadersCollectionController {\n\tprivate _lines_controller_by_shader_name: Map<ShaderName, LinesController> = new Map();\n\tconstructor(private _shader_names: ShaderName[], private _current_shader_name: ShaderName) {\n\t\tfor (let shader_name of this._shader_names) {\n\t\t\tthis._lines_controller_by_shader_name.set(shader_name, new LinesController(shader_name));\n\t\t}\n\t}\n\n\tget shader_names() {\n\t\treturn this._shader_names;\n\t}\n\n\tset_current_shader_name(shader_name: ShaderName) {\n\t\tthis._current_shader_name = shader_name;\n\t}\n\tget current_shader_name() {\n\t\treturn this._current_shader_name;\n\t}\n\n\tadd_definitions(node: BaseGlNodeType, definitions: BaseGLDefinition[], shader_name?: ShaderName) {\n\t\tif (definitions.length == 0) {\n\t\t\treturn;\n\t\t}\n\t\tshader_name = shader_name || this._current_shader_name;\n\t\tconst lines_controller = this._lines_controller_by_shader_name.get(shader_name);\n\t\tif (lines_controller) {\n\t\t\tlines_controller.add_definitions(node, definitions);\n\t\t}\n\t}\n\tdefinitions(shader_name: ShaderName, node: BaseGlNodeType) {\n\t\tconst lines_controller = this._lines_controller_by_shader_name.get(shader_name);\n\t\tif (lines_controller) {\n\t\t\treturn lines_controller.definitions(node);\n\t\t}\n\t}\n\n\tadd_body_lines(node: BaseGlNodeType, lines: string[], shader_name?: ShaderName) {\n\t\tif (lines.length == 0) {\n\t\t\treturn;\n\t\t}\n\t\tshader_name = shader_name || this._current_shader_name;\n\t\tconst lines_controller = this._lines_controller_by_shader_name.get(shader_name);\n\t\tif (lines_controller) {\n\t\t\tlines_controller.add_body_lines(node, lines);\n\t\t}\n\t}\n\tbody_lines(shader_name: ShaderName, node: BaseGlNodeType) {\n\t\tconst lines_controller = this._lines_controller_by_shader_name.get(shader_name);\n\t\tif (lines_controller) {\n\t\t\treturn lines_controller.body_lines(node);\n\t\t}\n\t}\n}\n","import {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\nimport {BaseGLDefinition} from '../../utils/GLDefinition';\nimport {BaseGlNodeType} from '../../_Base';\nimport {MapUtils} from 'src/core/MapUtils';\n\nexport class LinesController {\n\tprivate _definitions_by_node_id: Map<string, BaseGLDefinition[]> = new Map();\n\tprivate _body_lines_by_node_id: Map<string, string[]> = new Map();\n\n\tconstructor(private _shader_name: ShaderName) {}\n\n\tget shader_name() {\n\t\treturn this._shader_name;\n\t}\n\n\tadd_definitions(node: BaseGlNodeType, definitions: BaseGLDefinition[]) {\n\t\tfor (let definition of definitions) {\n\t\t\tMapUtils.push_on_array_at_entry(this._definitions_by_node_id, node.graph_node_id, definition);\n\t\t}\n\t}\n\tdefinitions(node: BaseGlNodeType): BaseGLDefinition[] | undefined {\n\t\treturn this._definitions_by_node_id.get(node.graph_node_id);\n\t}\n\n\tadd_body_lines(node: BaseGlNodeType, lines: string[]) {\n\t\tfor (let line of lines) {\n\t\t\tMapUtils.push_on_array_at_entry(this._body_lines_by_node_id, node.graph_node_id, line);\n\t\t}\n\t}\n\tbody_lines(node: BaseGlNodeType): string[] | undefined {\n\t\treturn this._body_lines_by_node_id.get(node.graph_node_id);\n\t}\n}\n","import {BaseGlNodeType} from '../../_Base';\nimport {LineType} from './LineType';\n\nconst LINE_SUFFIXES = {\n\t[LineType.FUNCTION_DECLARATION]: '',\n\t[LineType.DEFINE]: ';',\n\t[LineType.BODY]: ';',\n};\n\nconst LINE_PREFIXES = {\n\t[LineType.FUNCTION_DECLARATION]: '',\n\t[LineType.DEFINE]: '',\n\t[LineType.BODY]: '\t',\n};\n\nexport class CodeFormatter {\n\tstatic node_comment(node: BaseGlNodeType, line_type: LineType): string {\n\t\tlet line = `// ${node.full_path()}`;\n\t\tif (line_type == LineType.BODY) {\n\t\t\tline = `\t${line}`;\n\t\t}\n\t\treturn line;\n\t}\n\tstatic line_wrap(line: string, line_type: LineType) {\n\t\tlet add_suffix = true;\n\t\tif (line.indexOf('#if') == 0 || line.indexOf('#endif') == 0) {\n\t\t\tadd_suffix = false;\n\t\t}\n\t\tif (add_suffix) {\n\t\t\treturn `${LINE_PREFIXES[line_type]}${line}${LINE_SUFFIXES[line_type]}`;\n\t\t} else {\n\t\t\treturn `${LINE_PREFIXES[line_type]}${line}`;\n\t\t}\n\t}\n\tstatic post_line_separator(line_type: LineType) {\n\t\treturn line_type == LineType.BODY ? '\t' : '';\n\t}\n}\n","import {TypedNode} from '../../_Base';\nimport {ShaderName} from './ShaderName';\n\nexport abstract class TypedAssembler<T extends TypedNode<any, any, any>> {\n\tabstract get shader_names(): ShaderName[];\n\tabstract input_names_for_shader_name(node: T, shader_name: ShaderName): string[];\n}\n","import {UniformsUtils} from 'three/src/renderers/shaders/UniformsUtils';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\nimport {ShaderLib} from 'three/src/renderers/shaders/ShaderLib';\nimport {RGBADepthPacking} from 'three/src/constants';\nimport {BasicDepthPacking} from 'three/src/constants';\n\nimport {ShaderAssemblerRender} from './_BaseRender';\nimport {ShaderName} from '../../../utils/shaders/ShaderName';\n\nconst INSERT_BODY_AFTER_MAP: Map<ShaderName, string> = new Map([\n\t[ShaderName.VERTEX, '#include <begin_vertex>'],\n\t[ShaderName.FRAGMENT, 'vec4 diffuseColor = vec4( 1.0 );'],\n]);\n\nexport class ShaderAssemblerCustomMeshDistance extends ShaderAssemblerRender {\n\t// _color_declaration() { return 'vec4 diffuseColor' }\n\t// _template_shader(){ return ShaderLib.standard }\n\tget _template_shader() {\n\t\tconst template = ShaderLib.distanceRGBA;\n\t\treturn {\n\t\t\tvertexShader: template.vertexShader, //TemplateVertex,\n\t\t\tfragmentShader: template.fragmentShader, //TemplateFragment,\n\t\t\tuniforms: template.uniforms,\n\t\t};\n\t}\n\tprotected insert_body_after(shader_name: ShaderName) {\n\t\treturn INSERT_BODY_AFTER_MAP.get(shader_name);\n\t}\n\n\t_create_material() {\n\t\tconst template_shader = this._template_shader;\n\t\treturn new ShaderMaterial({\n\t\t\t// vertexColors: VertexColors,\n\t\t\t// side: FrontSide,\n\t\t\t// transparent: true,\n\t\t\t// fog: true,\n\t\t\t// lights: true,\n\t\t\tdefines: {\n\t\t\t\tDEPTH_PACKING: [RGBADepthPacking, BasicDepthPacking][0],\n\t\t\t},\n\n\t\t\tuniforms: UniformsUtils.clone(template_shader.uniforms),\n\t\t\tvertexShader: template_shader.vertexShader,\n\t\t\tfragmentShader: template_shader.fragmentShader,\n\t\t});\n\t}\n}\n","import {UniformsUtils} from 'three/src/renderers/shaders/UniformsUtils';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\nimport {ShaderLib} from 'three/src/renderers/shaders/ShaderLib';\nimport {RGBADepthPacking} from 'three/src/constants';\nimport {BasicDepthPacking} from 'three/src/constants';\n\nimport {ShaderAssemblerRender} from './_BaseRender';\nimport {ShaderName} from '../../../utils/shaders/ShaderName';\n\nconst INSERT_BODY_AFTER_MAP: Map<ShaderName, string> = new Map([\n\t[ShaderName.VERTEX, '#include <begin_vertex>'],\n\t[ShaderName.FRAGMENT, 'vec4 diffuseColor = vec4( 1.0 );'],\n]);\n\nexport class ShaderAssemblerCustomMeshDepth extends ShaderAssemblerRender {\n\t// _color_declaration() { return 'vec4 diffuseColor' }\n\t// _template_shader(){ return ShaderLib.standard }\n\tget _template_shader() {\n\t\tconst template = ShaderLib.depth;\n\t\treturn {\n\t\t\tvertexShader: template.vertexShader, //TemplateVertex,\n\t\t\tfragmentShader: template.fragmentShader, //TemplateFragment,\n\t\t\tuniforms: template.uniforms,\n\t\t};\n\t}\n\tprotected insert_body_after(shader_name: ShaderName) {\n\t\treturn INSERT_BODY_AFTER_MAP.get(shader_name);\n\t}\n\n\t_create_material() {\n\t\tconst template_shader = this._template_shader;\n\t\treturn new ShaderMaterial({\n\t\t\t// vertexColors: VertexColors,\n\t\t\t// side: FrontSide,\n\t\t\t// transparent: true,\n\t\t\t// fog: true,\n\t\t\t// lights: true,\n\t\t\tdefines: {\n\t\t\t\tDEPTH_PACKING: [RGBADepthPacking, BasicDepthPacking][0],\n\t\t\t},\n\n\t\t\tuniforms: UniformsUtils.clone(template_shader.uniforms),\n\t\t\tvertexShader: template_shader.vertexShader,\n\t\t\tfragmentShader: template_shader.fragmentShader,\n\t\t});\n\t}\n}\n","import {UniformsUtils} from 'three/src/renderers/shaders/UniformsUtils';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\n// import {ShaderLib} from 'three/src/renderers/shaders/ShaderLib';\n// import {RGBADepthPacking} from 'three/src/constants';\n// import {BasicDepthPacking} from 'three/src/constants';\n\nimport {ShaderAssemblerRender} from './_BaseRender';\n\nimport TemplateVertex from '../templates/CustomMeshDepthDOF.vert.glsl';\nimport TemplateFragment from '../templates/CustomMeshDepthDOF.frag.glsl';\nimport {ShaderName} from '../../../utils/shaders/ShaderName';\n\nconst INSERT_DEFINE_AFTER_MAP: Map<ShaderName, string> = new Map([[ShaderName.VERTEX, '// INSERT DEFINES']]);\nconst INSERT_BODY_AFTER_MAP: Map<ShaderName, string> = new Map([[ShaderName.VERTEX, '// INSERT BODY']]);\n// fragment: 'vec4 diffuseColor = vec4( 1.0 );' // do not change? unless there is a texture lookup\n\nexport class ShaderAssemblerCustomMeshDepthDOF extends ShaderAssemblerRender {\n\t// _color_declaration() { return 'vec4 diffuseColor' }\n\t// _template_shader(){ return ShaderLib.standard }\n\tget _template_shader() {\n\t\treturn {\n\t\t\tvertexShader: TemplateVertex,\n\t\t\tfragmentShader: TemplateFragment,\n\t\t\tuniforms: {\n\t\t\t\tmNear: {value: 0},\n\t\t\t\tmFar: {value: 10},\n\t\t\t},\n\t\t};\n\t}\n\tprotected insert_define_after(shader_name: ShaderName) {\n\t\treturn INSERT_DEFINE_AFTER_MAP.get(shader_name);\n\t}\n\tprotected insert_body_after(shader_name: ShaderName) {\n\t\treturn INSERT_BODY_AFTER_MAP.get(shader_name);\n\t}\n\n\t_create_material() {\n\t\tconst template_shader = this._template_shader;\n\t\treturn new ShaderMaterial({\n\t\t\t// defines: {\n\t\t\t// \tDEPTH_PACKING: [RGBADepthPacking, BasicDepthPacking][0]\n\t\t\t// },\n\n\t\t\tuniforms: UniformsUtils.clone(template_shader.uniforms),\n\t\t\tvertexShader: template_shader.vertexShader,\n\t\t\tfragmentShader: template_shader.fragmentShader,\n\t\t});\n\t}\n}\n","export default \"#include <common>\\n\\nvarying float vViewZDepth;\\n\\n// INSERT DEFINES\\n\\n\\n\\nvoid main() {\\n\\n\\t// INSERT BODY\\n\\n\\n\\t#include <project_vertex>\\n\\n\\tvViewZDepth = - mvPosition.z;\\n}\"","export default \"uniform float mNear;\\nuniform float mFar;\\n\\nvarying float vViewZDepth;\\n\\nvoid main() {\\n\\n\\tfloat color = 1.0 - smoothstep( mNear, mFar, vViewZDepth );\\n\\tgl_FragColor = vec4( vec3( color ), 1.0 );\\n\\n}\\n\"","import {TypedMatNode} from './_Base';\nimport {GlAssemblerController} from '../gl/code/Controller';\n\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\n\n// import DisplayFlag from '../Concerns/DisplayFlag';\n\nimport {NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {BaseGlShaderAssembler} from '../gl/code/assemblers/_Base';\nimport {GlNodeChildrenMap} from 'src/engine/poly/registers/Gl';\nimport {BaseGlNodeType} from '../gl/_Base';\nimport {ShaderMaterialWithCustomMaterials} from 'src/core/geometry/Material';\nimport {CustomMaterialName} from '../gl/code/assemblers/_BaseRender';\n\nexport abstract class TypedBuilderMatNode<\n\tA extends BaseGlShaderAssembler,\n\tK extends NodeParamsConfig\n> extends TypedMatNode<ShaderMaterialWithCustomMaterials, K> {\n\tprotected _assembler_controller: GlAssemblerController<A> | undefined;\n\n\t//\n\t//\n\t// MATERIAL\n\t//\n\t//\n\tcreate_material() {\n\t\tconst material = new ShaderMaterial() as ShaderMaterialWithCustomMaterials;\n\n\t\tmaterial.custom_materials = {\n\t\t\t[CustomMaterialName.DEPTH]: new ShaderMaterial(),\n\t\t\t[CustomMaterialName.DEPTH_DOF]: new ShaderMaterial(),\n\t\t\t[CustomMaterialName.DISTANCE]: new ShaderMaterial(),\n\t\t};\n\n\t\treturn material;\n\t}\n\t//\n\t//\n\t// ASSEMBLER\n\t//\n\t//\n\tget assembler_controller() {\n\t\treturn (this._assembler_controller = this._assembler_controller || this._create_assembler_controller());\n\t}\n\tprotected abstract _create_assembler_controller(): GlAssemblerController<A>;\n\n\tcreate_node<K extends keyof GlNodeChildrenMap>(type: K): GlNodeChildrenMap[K] {\n\t\treturn super.create_node(type) as GlNodeChildrenMap[K];\n\t}\n\tchildren() {\n\t\treturn super.children() as BaseGlNodeType[];\n\t}\n\tnodes_by_type<K extends keyof GlNodeChildrenMap>(type: K): GlNodeChildrenMap[K][] {\n\t\treturn super.nodes_by_type(type) as GlNodeChildrenMap[K][];\n\t}\n\n\t//\n\t//\n\t// COMPILATION\n\t//\n\t//\n\tasync compile_if_required() {\n\t\tif (this.assembler_controller.compile_required()) {\n\t\t\tthis._compile();\n\t\t}\n\t}\n\tprotected abstract _compile(): void;\n}\n\nexport type BaseBuilderMatNodeType = TypedBuilderMatNode<BaseGlShaderAssembler, NodeParamsConfig>;\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {SceneJsonExporter} from './Scene';\n// import {JsonExporterVisitor} from './Visitor';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {JsonExportDispatcher} from './Dispatcher';\nimport {ParamJsonExporterData} from './Param';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\ninterface NamedInputData {\n\tname: string;\n\tnode: string;\n\toutput: string;\n}\ntype IndexedInputData = string | null;\nexport type InputData = NamedInputData | IndexedInputData;\n\ninterface FlagsData {\n\tbypass?: boolean;\n\tdisplay?: boolean;\n}\n\nexport interface NodeJsonExporterData {\n\ttype: string;\n\tnodes: Dictionary<NodeJsonExporterData>;\n\tchildren_context: NodeContext;\n\tparams?: Dictionary<ParamJsonExporterData<ParamType>>;\n\tinputs?: InputData[];\n\tselection?: string[];\n\tflags?: FlagsData;\n\toverride_clonable_state: boolean;\n}\n\nexport interface NodeJsonExporterUIData {\n\tpos?: Number2;\n\tcomment?: string;\n\tnodes: Dictionary<NodeJsonExporterUIData>;\n}\n\nexport class NodeJsonExporter<T extends BaseNodeType> {\n\tprivate _data: NodeJsonExporterData | undefined; // = {} as NodeJsonExporterData;\n\tconstructor(protected _node: T) {}\n\n\tdata(): NodeJsonExporterData {\n\t\tif (!this.is_root()) {\n\t\t\tthis._node.scene.nodes_controller.register_node_context_signature(this._node);\n\t\t}\n\t\tthis._data = {\n\t\t\ttype: this._node.type,\n\t\t} as NodeJsonExporterData;\n\n\t\t// const required_imports = this._node.required_imports()\n\t\t// if(required_imports){\n\t\t// \tthis._data['required_imports'] = required_imports\n\t\t// }\n\n\t\tconst nodes_data = this.nodes_data();\n\t\tif (Object.keys(nodes_data).length > 0) {\n\t\t\tthis._data['nodes'] = nodes_data;\n\n\t\t\t// required by the Store::Scene::Exporter.rb\n\t\t\tconst context = this._node.children_controller?.context;\n\t\t\tif (context) {\n\t\t\t\tthis._data['children_context'] = context;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.is_root()) {\n\t\t\tthis._data['params'] = this.params_data();\n\t\t\t//data['custom'] = []\n\t\t\tthis._data['inputs'] = this.inputs_data();\n\t\t}\n\n\t\t// TODO: does that create flags automatically? it should not\n\t\tif (this._node.flags) {\n\t\t\tthis._data['flags'] = {};\n\t\t\tif (this._node.flags.has_bypass()) {\n\t\t\t\tif (this._node.flags.bypass?.active) {\n\t\t\t\t\tthis._data['flags']['bypass'] = this._node.flags.bypass.active;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._node.flags.has_display()) {\n\t\t\t\tthis._data['flags']['display'] = this._node.flags.display?.active;\n\t\t\t}\n\t\t}\n\n\t\tif (this._node.children_allowed()) {\n\t\t\tconst selection = this._node.children_controller?.selection;\n\t\t\tif (selection && this._node.children().length > 0) {\n\t\t\t\t// only save the nodes that are still present, in case the selection just got deleted\n\t\t\t\tconst selected_children: BaseNodeType[] = [];\n\t\t\t\tconst selected_ids: Dictionary<boolean> = {};\n\t\t\t\tfor (let selected_node of selection.nodes()) {\n\t\t\t\t\tselected_ids[selected_node.graph_node_id] = true;\n\t\t\t\t}\n\t\t\t\tfor (let child of this._node.children()) {\n\t\t\t\t\tif (child.graph_node_id in selected_ids) {\n\t\t\t\t\t\tselected_children.push(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._data['selection'] = selected_children.map((n) => n.name);\n\t\t\t}\n\t\t}\n\n\t\t// inputs clone\n\t\tif (this._node.io.inputs.override_clonable_state_allowed()) {\n\t\t\tconst override = this._node.io.inputs.override_clonable_state();\n\t\t\tif (override) {\n\t\t\t\tthis._data['override_clonable_state'] = override;\n\t\t\t}\n\t\t}\n\n\t\t// custom\n\t\tthis.add_custom();\n\n\t\treturn this._data;\n\t}\n\n\tui_data(): NodeJsonExporterUIData {\n\t\tconst data: NodeJsonExporterUIData = {} as NodeJsonExporterUIData;\n\t\tif (!this.is_root()) {\n\t\t\tconst ui_data = this._node.ui_data;\n\t\t\tdata['pos'] = ui_data.position.toArray() as Number2;\n\t\t\tconst comment = ui_data.comment;\n\t\t\tif (comment) {\n\t\t\t\tdata['comment'] = SceneJsonExporter.sanitize_string(comment);\n\t\t\t}\n\t\t}\n\t\tconst children = this._node.children();\n\t\tif (children.length > 0) {\n\t\t\tdata['nodes'] = {};\n\t\t\tchildren.forEach((child) => {\n\t\t\t\tconst node_exporter = JsonExportDispatcher.dispatch_node(child); //.visit(JsonExporterVisitor); //.json_exporter()\n\t\t\t\tdata['nodes'][child.name] = node_exporter.ui_data();\n\t\t\t});\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tprivate is_root() {\n\t\treturn this._node.parent === null && this._node.graph_node_id == this._node.root.graph_node_id;\n\t}\n\n\tprotected inputs_data() {\n\t\tconst data: InputData[] = [];\n\t\t// Object.keys(this._node.io.inputs.inputs()).forEach((input_index) => {\n\t\tthis._node.io.inputs.inputs().forEach((input, input_index) => {\n\t\t\t// const input = this._node.io.inputs.input(input_index);\n\t\t\tif (input) {\n\t\t\t\t// const connection_point = this._node.io.inputs.named_input_connection_points;\n\t\t\t\tconst connection = this._node.io.connections.input_connection(input_index)!;\n\t\t\t\tif (this._node.io.inputs.has_named_inputs) {\n\t\t\t\t\tconst input_name = this._node.io.inputs.named_input_connection_points[input_index].name;\n\t\t\t\t\t// const output_index = input_connections[input_index].output_index();\n\t\t\t\t\tconst output_index = connection.output_index;\n\t\t\t\t\tconst output_name = input.io.outputs.named_output_connection_points[output_index].name;\n\t\t\t\t\tdata.push({name: input_name, node: input.name, output: output_name});\n\t\t\t\t} else {\n\t\t\t\t\tdata.push(input.name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tprotected params_data() {\n\t\tconst data: Dictionary<ParamJsonExporterData<ParamType>> = {};\n\n\t\tfor (let param_name of this._node.params.names) {\n\t\t\tconst param = this._node.params.get(param_name);\n\t\t\tif (param && !param.parent_param) {\n\t\t\t\tconst param_exporter = JsonExportDispatcher.dispatch_param(param); //.visit(JsonExporterVisitor); //.json_exporter()\n\t\t\t\tif (param_exporter.required) {\n\t\t\t\t\tconst params_data = param_exporter.data();\n\t\t\t\t\tdata[param.name] = params_data;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tprotected nodes_data() {\n\t\tconst data: Dictionary<NodeJsonExporterData> = {};\n\t\tfor (let child of this._node.children()) {\n\t\t\tconst node_exporter = JsonExportDispatcher.dispatch_node(child); //.json_exporter()\n\t\t\tdata[child.name] = node_exporter.data();\n\t\t}\n\t\treturn data;\n\t}\n\n\tprotected add_custom() {}\n}\n","import {ParamJsonExporter, ParamJsonExporterDataByName} from '../Param';\n// import {JsonExporterVisitor} from '../Visitor';\nimport {TypedMultipleParam} from 'src/engine/params/_Multiple';\nimport {JsonExportDispatcher} from '../Dispatcher';\n\nexport class ParamMultipleJsonExporter extends ParamJsonExporter<TypedMultipleParam<any>> {\n\tadd_main() {\n\t\tconst components_data: ParamJsonExporterDataByName = {};\n\t\tconst component_names = this._param.component_names;\n\t\tthis._param.components?.forEach((component, i) => {\n\t\t\tconst exporter = JsonExportDispatcher.dispatch_param(component); //.accepts_visitor();\n\t\t\tif (exporter.required) {\n\t\t\t\tcomponents_data[component_names[i]] = exporter.data();\n\t\t\t}\n\t\t});\n\n\t\treturn components_data;\n\t}\n}\n","import {ParamJsonExporter} from '../Param';\nimport {TypedNumericParam} from 'src/engine/params/_Numeric';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nexport class ParamNumericJsonExporter extends ParamJsonExporter<TypedNumericParam<ParamType>> {\n\tadd_main() {\n\t\t// if (this._param.has_expression() && this._param.expression_controller?.expression) {\n\t\t// \t// const escaped_expression = this._param.expression().replace(/'/g, \"\\\\'\");\n\t\t// \tthis._data['expression'] = this._param.expression_controller?.expression;\n\t\t// } else {\n\t\tif (this._require_data_complex()) {\n\t\t\tthis._complex_data['raw_input'] = this._param.raw_input_serialized;\n\t\t} else {\n\t\t\treturn this._param.raw_input_serialized;\n\t\t}\n\t\t// }\n\t}\n}\n","import {ParamJsonExporter} from '../Param';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\nimport {SceneJsonExporter} from '../Scene';\n\nexport class ParamOperatorPathJsonExporter extends ParamJsonExporter<OperatorPathParam> {\n\tadd_main() {\n\t\tlet val = this._param.raw_input;\n\t\t// val = val.replace(/'/g, \"\\\\'\");\n\t\tval = SceneJsonExporter.sanitize_string(val);\n\n\t\tif (this._require_data_complex()) {\n\t\t\tthis._complex_data['raw_input'] = val;\n\t\t} else {\n\t\t\treturn val;\n\t\t}\n\t}\n}\n","// import lodash_isString from 'lodash/isString'\nimport {ParamJsonExporter} from '../Param';\nimport {SceneJsonExporter} from '../Scene';\nimport {StringParam} from 'src/engine/params/String';\n\nexport class ParamStringJsonExporter extends ParamJsonExporter<StringParam> {\n\tadd_main() {\n\t\t// let val = this._param.input_value();\n\t\tlet val = this._param.raw_input;\n\t\t// if (lodash_isString(val)){\n\t\tval = SceneJsonExporter.sanitize_string(val);\n\t\t// }\n\t\tif (this._require_data_complex()) {\n\t\t\tthis._complex_data['raw_input'] = val;\n\t\t} else {\n\t\t\treturn val;\n\t\t}\n\t}\n}\n","import {ParamJsonExporter} from '../Param';\nimport {RampParam} from 'src/engine/params/Ramp';\n\nexport class ParamRampJsonExporter extends ParamJsonExporter<RampParam> {\n\tadd_main() {\n\t\tif (this._require_data_complex()) {\n\t\t\tthis._complex_data['raw_input'] = this._param.raw_input_serialized;\n\t\t} else {\n\t\t\treturn this._param.raw_input_serialized;\n\t\t}\n\t}\n}\n","import {NoColors} from 'three/src/constants';\nimport {MeshLambertMaterial} from 'three/src/materials/MeshLambertMaterial';\nimport {FrontSide} from 'three/src/constants';\nimport {TypedMatNode} from './_Base';\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ColorsController, ColorParamConfig} from './utils/ColorsController';\nimport {SideController, SideParamConfig} from './utils/SideController';\nimport {SkinningController, SkinningParamConfig} from './utils/SkinningController';\nimport {TextureMapController, TextureMapParamConfig} from './utils/TextureMapController';\nimport {TextureAlphaMapController, TextureAlphaMapParamConfig} from './utils/TextureAlphaMapController';\nclass MeshLambertMatParamsConfig extends TextureAlphaMapParamConfig(\n\tTextureMapParamConfig(SkinningParamConfig(SideParamConfig(ColorParamConfig(NodeParamsConfig))))\n) {}\nconst ParamsConfig = new MeshLambertMatParamsConfig();\n\nexport class MeshLambertMatNode extends TypedMatNode<MeshLambertMaterial, MeshLambertMatParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'mesh_lambert';\n\t}\n\n\tcreate_material() {\n\t\treturn new MeshLambertMaterial({\n\t\t\tvertexColors: NoColors,\n\t\t\tside: FrontSide,\n\t\t\tcolor: 0xffffff,\n\t\t\topacity: 1,\n\t\t});\n\t}\n\treadonly texture_map_controller: TextureMapController = new TextureMapController(this);\n\treadonly texture_alpha_map_controller: TextureAlphaMapController = new TextureAlphaMapController(this);\n\tinitialize_node() {\n\t\tthis.params.set_post_create_params_hook(() => {\n\t\t\tthis.texture_map_controller.initialize_node();\n\t\t\tthis.texture_alpha_map_controller.initialize_node();\n\t\t});\n\t}\n\tasync cook() {\n\t\tColorsController.update(this);\n\t\tSideController.update(this);\n\t\tSkinningController.update(this);\n\t\tthis.texture_map_controller.update();\n\t\tthis.texture_alpha_map_controller.update();\n\n\t\tthis.set_material(this.material);\n\t}\n}\n","import {NoColors} from 'three/src/constants';\nimport {MeshStandardMaterial} from 'three/src/materials/MeshStandardMaterial';\nimport {FrontSide} from 'three/src/constants';\nimport {TypedMatNode} from './_Base';\n\nimport {ParamConfig, NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ColorsController, ColorParamConfig} from './utils/ColorsController';\nimport {SideController, SideParamConfig} from './utils/SideController';\nimport {SkinningController, SkinningParamConfig} from './utils/SkinningController';\nimport {TextureMapController, TextureMapParamConfig} from './utils/TextureMapController';\nimport {TextureAlphaMapController, TextureAlphaMapParamConfig} from './utils/TextureAlphaMapController';\nimport {TextureEnvMapController, TextureEnvMapParamConfig} from './utils/TextureEnvMapController';\nclass MeshStandardMatParamsConfig extends TextureEnvMapParamConfig(\n\tTextureAlphaMapParamConfig(\n\t\tTextureMapParamConfig(SkinningParamConfig(SideParamConfig(ColorParamConfig(NodeParamsConfig))))\n\t)\n) {\n\tmetalness = ParamConfig.FLOAT(1);\n\troughness = ParamConfig.FLOAT(0);\n}\n// TODO: add the following texture params:\n// - aoMap+aoMapIntensity\n// - bumpMap+bumpScale\n// - displacementMap+displaycementScale+displacementBias\n// - emissiveMap\n// - envMap\n// - lightMap\n// - metalnessMap\n// - normalMap\n// - roughnessMap,\nconst ParamsConfig = new MeshStandardMatParamsConfig();\n\nexport class MeshStandardMatNode extends TypedMatNode<MeshStandardMaterial, MeshStandardMatParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'mesh_standard';\n\t}\n\n\tcreate_material() {\n\t\treturn new MeshStandardMaterial({\n\t\t\tvertexColors: NoColors,\n\t\t\tside: FrontSide,\n\t\t\tcolor: 0xffffff,\n\t\t\topacity: 1,\n\t\t\tmetalness: 1,\n\t\t\troughness: 0,\n\t\t});\n\t}\n\n\treadonly texture_map_controller: TextureMapController = new TextureMapController(this);\n\treadonly texture_alpha_map_controller: TextureAlphaMapController = new TextureAlphaMapController(this);\n\treadonly texture_env_map_controller: TextureEnvMapController = new TextureEnvMapController(this);\n\tinitialize_node() {\n\t\tthis.params.set_post_create_params_hook(() => {\n\t\t\tthis.texture_map_controller.initialize_node();\n\t\t\tthis.texture_alpha_map_controller.initialize_node();\n\t\t\tthis.texture_env_map_controller.initialize_node();\n\t\t});\n\t}\n\n\tasync cook() {\n\t\tColorsController.update(this);\n\t\tSideController.update(this);\n\t\tSkinningController.update(this);\n\t\tthis.texture_map_controller.update();\n\t\tthis.texture_alpha_map_controller.update();\n\t\tthis.texture_env_map_controller.update();\n\n\t\tif (this._material) {\n\t\t\tthis._material.envMapIntensity = this.pv.env_map_intensity;\n\t\t\tthis._material.roughness = this.pv.roughness;\n\t\t\tthis._material.metalness = this.pv.metalness;\n\t\t}\n\n\t\tthis.set_material(this.material);\n\t}\n}\n","// import {BaseController} from './_BaseController';\nimport {Material} from 'three/src/materials/Material';\nimport {Texture} from 'three/src/textures/Texture';\nimport {FileCopNode} from 'src/engine/nodes/cop/File';\nimport {TypedMatNode} from '../_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\n// import {NodeContext} from 'src/engine/poly/NodeContext';\n// import {BaseCopNodeType} from '../../cop/_Base';\nimport {BaseTextureMapController, BooleanParamOptions, OperatorPathOptions} from './_BaseTextureController';\nexport function TextureEnvMapParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tuse_env_map = ParamConfig.BOOLEAN(0, BooleanParamOptions(TextureEnvMapController));\n\t\tenv_map = ParamConfig.OPERATOR_PATH(\n\t\t\tFileCopNode.DEFAULT_NODE_PATH.ENV_MAP,\n\t\t\tOperatorPathOptions(TextureEnvMapController, 'use_env_map')\n\t\t);\n\t\tenv_map_intensity = ParamConfig.FLOAT(1, {visible_if: {use_env_map: 1}});\n\t};\n}\nclass TextureEnvMaterial extends Material {\n\tenvMap!: Texture | null;\n}\nclass TextureEnvMapParamsConfig extends TextureEnvMapParamConfig(NodeParamsConfig) {}\nclass TextureEnvMapMatNode extends TypedMatNode<TextureEnvMaterial, TextureEnvMapParamsConfig> {\n\ttexture_env_map_controller!: TextureEnvMapController;\n\tcreate_material() {\n\t\treturn new TextureEnvMaterial();\n\t}\n}\n\n// import {EXRLoader} from 'three/examples/jsm/loaders/EXRLoader';\n// import {FloatType} from 'three/src/constants';\n// import {POLY} from 'src/engine/Poly';\n// import {PMREMGenerator} from 'three/src/extras/PMREMGenerator';\nexport class TextureEnvMapController extends BaseTextureMapController {\n\tconstructor(protected node: TextureEnvMapMatNode) {\n\t\tsuper(node);\n\t}\n\tinitialize_node() {\n\t\tthis.add_hooks(this.node.p.use_env_map, this.node.p.env_map);\n\t}\n\tasync update() {\n\t\tthis._update_texture(this.node.material, 'envMap', this.node.p.use_env_map, this.node.p.env_map);\n\t}\n\tstatic async update(node: TextureEnvMapMatNode) {\n\t\tnode.texture_env_map_controller.update();\n\t}\n\n\t// const renderer = POLY.renderers_controller.first_renderer();\n\t// if (renderer) {\n\t// \tconst pmremGenerator = new PMREMGenerator(renderer);\n\t// \tconsole.log(pmremGenerator);\n\n\t// \tnew EXRLoader().setDataType(FloatType).load('/examples/textures/piz_compressed.exr', function(texture) {\n\t// \t\tconsole.log(texture);\n\t// \t\tconst exrCubeRenderTarget = pmremGenerator.fromEquirectangular(texture);\n\t// \t\tconst exrBackground = exrCubeRenderTarget.texture;\n\t// \t\tnode.scene.display_scene.background = exrBackground;\n\t// \t\tnode.material.envMap = exrBackground;\n\t// \t\tnode.material.envMapIntensity = 1;\n\t// \t\tnode.material.needsUpdate = true;\n\n\t// \t\ttexture.dispose();\n\t// \t});\n\t// \tpmremGenerator.compileEquirectangularShader();\n\t// }\n\t// }\n\n\t// static async update(node: TextureEnvMapMatNode) {\n\t// \tconst material = node.material;\n\n\t// \tif (node.pv.use_map) {\n\t// \t\tconst found_node = node.p.Env_map.found_node();\n\t// \t\tif (found_node) {\n\t// \t\t\tif (found_node.node_context() == NodeContext.COP) {\n\t// \t\t\t\tconst texture_node = found_node as BaseCopNodeType;\n\n\t// \t\t\t\t// if the texture has already been created, we don't have to wait for request_container\n\t// \t\t\t\tif (texture_node.texture) {\n\t// \t\t\t\t\ttexture_node.request_container();\n\t// \t\t\t\t} else {\n\t// \t\t\t\t\tawait texture_node.request_container();\n\t// \t\t\t\t}\n\n\t// \t\t\t\tif (texture_node.texture) {\n\t// \t\t\t\t\tmaterial.EnvMap = texture_node.texture;\n\t// \t\t\t\t\treturn;\n\t// \t\t\t\t}\n\t// \t\t\t} else {\n\t// \t\t\t\tnode.states.error.set(`found map node is not a COP node`);\n\t// \t\t\t}\n\t// \t\t} else {\n\t// \t\t\tnode.states.error.set(`could not find map node`);\n\t// \t\t}\n\t// \t}\n\t// \tmaterial.EnvMap = null;\n\t// }\n}\n","import {NoColors} from 'three/src/constants';\nimport {PointsMaterial} from 'three/src/materials/PointsMaterial';\nimport {FrontSide} from 'three/src/constants';\nimport {TypedMatNode} from './_Base';\n\nimport {ColorsController, ColorParamConfig} from './utils/ColorsController';\nimport {SideController, SideParamConfig} from './utils/SideController';\n// import {TextureMapController, TextureMapParamConfig} from './utils/TextureMapController';\n// import {TextureAlphaMapController, TextureAlphaMapParamConfig} from './utils/TextureAlphaMapController';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nexport function PointsParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tsize = ParamConfig.FLOAT(1);\n\t\tsize_attenuation = ParamConfig.BOOLEAN(1);\n\t};\n}\n\nclass PointsMatParamsConfig extends SideParamConfig(ColorParamConfig(PointsParamConfig(NodeParamsConfig))) {}\nconst ParamsConfig = new PointsMatParamsConfig();\n\nexport class PointsMatNode extends TypedMatNode<PointsMaterial, PointsMatParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'points';\n\t}\n\n\tcreate_material() {\n\t\treturn new PointsMaterial({\n\t\t\tvertexColors: NoColors,\n\t\t\tside: FrontSide,\n\t\t\tcolor: 0xffffff,\n\t\t\topacity: 1,\n\t\t});\n\t}\n\n\tasync cook() {\n\t\tColorsController.update(this);\n\t\tSideController.update(this);\n\t\t// await TextureMapController.update(this);\n\t\t// await TextureAlphaMapController.update(this);\n\n\t\tthis.material.size = this.pv.size;\n\t\tthis.material.sizeAttenuation = this.pv.size_attenuation;\n\n\t\tthis.set_material(this.material);\n\t}\n}\n","import {CATEGORY_OBJ} from './Category';\n\nimport {AmbientLightObjNode} from 'src/engine/nodes/obj/AmbientLight';\nimport {AreaLightObjNode} from 'src/engine/nodes/obj/AreaLight';\nimport {DirectionalLightObjNode} from 'src/engine/nodes/obj/DirectionalLight';\nimport {HemisphereLightObjNode} from 'src/engine/nodes/obj/HemisphereLight';\nimport {PointLightObjNode} from 'src/engine/nodes/obj/PointLight';\nimport {SpotLightObjNode} from 'src/engine/nodes/obj/SpotLight';\n\nimport {EventsObjNode} from 'src/engine/nodes/obj/Events';\nimport {MaterialsObjNode} from 'src/engine/nodes/obj/Materials';\nimport {CopObjNode} from 'src/engine/nodes/obj/Cop';\nimport {PostProcessObjNode} from 'src/engine/nodes/obj/PostProcess';\n\nimport {GeoObjNode} from 'src/engine/nodes/obj/Geo';\nimport {NullObjNode} from 'src/engine/nodes/obj/Null';\nimport {FogObjNode} from 'src/engine/nodes/obj/Fog';\n\nimport {OrthographicCameraObjNode} from 'src/engine/nodes/obj/OrthographicCamera';\nimport {PerspectiveCameraObjNode} from 'src/engine/nodes/obj/PerspectiveCamera';\n// import {CubeCameraObj} from 'src/engine/nodes/obj/CubeCamera';\n\nexport interface ObjNodeChildrenMap {\n\tambient_light: AmbientLightObjNode;\n\tarea_light: AreaLightObjNode;\n\tdirectional_light: DirectionalLightObjNode;\n\themisphere_light: HemisphereLightObjNode;\n\tpoint_light: PointLightObjNode;\n\tspot_light: SpotLightObjNode;\n\tcop: CopObjNode;\n\tevents: EventsObjNode;\n\tfog: FogObjNode;\n\tgeo: GeoObjNode;\n\tmaterials: MaterialsObjNode;\n\tnull: NullObjNode;\n\tperspective_camera: PerspectiveCameraObjNode;\n\tpost_process: PostProcessObjNode;\n\torthographic_camera: OrthographicCameraObjNode;\n}\n\nimport {Poly} from 'src/engine/Poly';\nexport class ObjRegister {\n\tstatic run(poly: Poly) {\n\t\tpoly.register_node(AmbientLightObjNode, CATEGORY_OBJ.LIGHT);\n\t\tpoly.register_node(AreaLightObjNode, CATEGORY_OBJ.LIGHT);\n\t\tpoly.register_node(DirectionalLightObjNode, CATEGORY_OBJ.LIGHT);\n\t\tpoly.register_node(HemisphereLightObjNode, CATEGORY_OBJ.LIGHT);\n\t\tpoly.register_node(PointLightObjNode, CATEGORY_OBJ.LIGHT);\n\t\tpoly.register_node(SpotLightObjNode, CATEGORY_OBJ.LIGHT);\n\n\t\tpoly.register_node(EventsObjNode, CATEGORY_OBJ.MANAGER);\n\t\tpoly.register_node(MaterialsObjNode, CATEGORY_OBJ.MANAGER);\n\t\tpoly.register_node(CopObjNode, CATEGORY_OBJ.MANAGER);\n\t\tpoly.register_node(PostProcessObjNode, CATEGORY_OBJ.MANAGER);\n\n\t\tpoly.register_node(GeoObjNode, CATEGORY_OBJ.GEOMETRY);\n\t\tpoly.register_node(NullObjNode, CATEGORY_OBJ.GEOMETRY);\n\n\t\tpoly.register_node(OrthographicCameraObjNode, CATEGORY_OBJ.CAMERA);\n\t\tpoly.register_node(PerspectiveCameraObjNode, CATEGORY_OBJ.CAMERA);\n\t\t// poly.register_node(CubeCameraObj, CATEGORY_OBJ.CAMERA)\n\n\t\tpoly.register_node(FogObjNode, CATEGORY_OBJ.MISC);\n\t}\n}\n","import {AmbientLight} from 'three/src/lights/AmbientLight';\nimport {TypedLightObjNode} from './_BaseLight';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass AmbientLightObjParamsConfig extends NodeParamsConfig {\n\tcolor = ParamConfig.COLOR([1, 1, 1]);\n\tintensity = ParamConfig.FLOAT(1);\n}\nconst ParamsConfig = new AmbientLightObjParamsConfig();\n\nexport class AmbientLightObjNode extends TypedLightObjNode<AmbientLight, AmbientLightObjParamsConfig> {\n\tparams_config = ParamsConfig;\n\n\tstatic type() {\n\t\treturn 'ambient_light';\n\t}\n\n\tcreate_light() {\n\t\treturn new AmbientLight();\n\t}\n\n\tupdate_light_params() {\n\t\tthis.light.color = this.pv.color;\n\t\tthis.light.intensity = this.pv.intensity;\n\t}\n}\n","import {Object3D} from 'three/src/core/Object3D';\nimport {TypedContainer} from './_Base';\nimport {ContainableMap} from './utils/ContainableMap';\n\nexport class ObjectContainer extends TypedContainer<ContainableMap['OBJECT']> {\n\tset_content(content: ContainableMap['OBJECT']) {\n\t\tsuper.set_content(content);\n\t}\n\tset_object(object: Object3D) {\n\t\treturn this.set_content(object);\n\t}\n\thas_object() {\n\t\treturn this.has_content();\n\t}\n\tobject() {\n\t\treturn this.content();\n\t}\n\n\t// infos() {\n\t// \tconst node = this.node()\n\t// \treturn [\n\t// \t\t`full path: ${node.full_path()}`,\n\t// \t\t`${node.cooks_count()} cooks`,\n\t// \t\t`cook time: ${node.cook_time()}`,\n\t// \t\tthis.content(),\n\t// \t]\n\t// }\n}\n","import {RectAreaLight} from 'three/src/lights/RectAreaLight';\n// import {RectAreaLightHelper} from 'modules/three/examples/jsm/helpers/RectAreaLightHelper';\nimport {RectAreaLightUniformsLib} from 'modules/three/examples/jsm/lights/RectAreaLightUniformsLib';\n\nimport {BaseLightTransformedObjNode} from './_BaseLightTransformed';\nimport {TransformedParamConfig} from './utils/TransformController';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\n// import {HelperController, HelperParamConfig} from './utils/HelperController';\n\nexport function AreaLightParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tcolor = ParamConfig.COLOR([1, 1, 1]);\n\t\tintensity = ParamConfig.FLOAT(1, {range: [0, 10]});\n\t\twidth = ParamConfig.FLOAT(1, {range: [0, 10]});\n\t\theight = ParamConfig.FLOAT(1, {range: [0, 10]});\n\t};\n}\n\nclass AreaLightObjParamsConfig extends AreaLightParamConfig(TransformedParamConfig(NodeParamsConfig)) {}\nconst ParamsConfig = new AreaLightObjParamsConfig();\n\nexport class AreaLightObjNode extends BaseLightTransformedObjNode<RectAreaLight, AreaLightObjParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'area_light';\n\t}\n\t// private _helper_controller = new HelperController<RectAreaLightHelper, RectAreaLight>(this, RectAreaLightHelper);\n\t// initialize_node() {\n\t// \tthis._helper_controller.initialize_node();\n\t// }\n\n\tcreate_light() {\n\t\tconst object = new RectAreaLight(0xffffff, 1, 1, 1);\n\n\t\treturn object;\n\t}\n\n\t// create_light_params() {\n\t// \tthis.add_param(ParamType.COLOR, 'color', [1, 1, 1]);\n\t// \tthis.add_param(ParamType.FLOAT, 'intensity', 1, {range: [0, 10]});\n\t// \tthis.add_param(ParamType.FLOAT, 'width', 1, {range: [0, 10]});\n\t// \tthis.add_param(ParamType.FLOAT, 'height', 1, {range: [0, 10]});\n\t// }\n\n\tupdate_light_params() {\n\t\tthis.light.color = this.pv.color;\n\t\tthis.light.intensity = this.pv.intensity;\n\t\tthis.light.width = this.pv.width;\n\t\tthis.light.height = this.pv.height;\n\t\t// this._helper_controller.update();\n\t}\n\n\tasync cook() {\n\t\t// const {RectAreaLightUniformsLib} = await CoreScriptLoader.load_module_three_light('RectAreaLightUniformsLib');\n\t\t// const module = RectAreaLightUniformsLib\n\t\tif (!(RectAreaLightUniformsLib as any).initialized) {\n\t\t\tRectAreaLightUniformsLib.init();\n\t\t\t(RectAreaLightUniformsLib as any).initialized = true;\n\t\t}\n\n\t\tthis.transform_controller.update();\n\t\tthis.update_light_params();\n\t\tthis.update_shadow_params();\n\t\tthis.cook_controller.end_cook();\n\t}\n}\n","import {DirectionalLight} from 'three/src/lights/DirectionalLight';\nimport {DirectionalLightHelper} from './utils/helpers/DirectionalLightHelper';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\n// import {NodeContext} from 'src/engine/poly/NodeContext';\n// import {BaseObjNodeType} from './_Base';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {HelperController, HelperConstructor} from './utils/HelperController';\nimport {BaseLightTransformedObjNode} from './_BaseLightTransformed';\nimport {TransformedParamConfig} from './utils/TransformController';\n\nexport function DirectionalLightParamConfig<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\t// transform = ParamConfig.FOLDER();\n\t\t// directional\n\t\t// position = ParamConfig.VECTOR3([0, 1, 0]);\n\t\t// target = ParamConfig.VECTOR3([0, 0, 0]);\n\t\t// lookat = ParamConfig.OPERATOR_PATH('', {dependent_on_found_node: false});\n\n\t\tlight = ParamConfig.FOLDER();\n\t\tcolor = ParamConfig.COLOR([1, 1, 1]);\n\t\tintensity = ParamConfig.FLOAT(1);\n\t\tdistance = ParamConfig.FLOAT(100, {range: [0, 100]});\n\t\t// shadows\n\t\tcast_shadows = ParamConfig.BOOLEAN(1);\n\t\tshadow_res = ParamConfig.VECTOR2([1024, 1024]);\n\t\tshadow_bias = ParamConfig.FLOAT(0.001);\n\n\t\t// helper\n\t\tshow_helper = ParamConfig.BOOLEAN(1);\n\t\thelper_size = ParamConfig.FLOAT(1, {visible_if: {show_helper: 1}});\n\t};\n}\n\nclass DirectionalLightObjParamsConfig extends DirectionalLightParamConfig(TransformedParamConfig(NodeParamsConfig)) {}\nconst ParamsConfig = new DirectionalLightObjParamsConfig();\n\nexport class DirectionalLightObjNode extends BaseLightTransformedObjNode<\n\tDirectionalLight,\n\tDirectionalLightObjParamsConfig\n> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'directional_light';\n\t}\n\tprivate _target_target!: Object3D;\n\tprivate _helper_controller = new HelperController<DirectionalLight>(\n\t\tthis,\n\t\t(<unknown>DirectionalLightHelper) as HelperConstructor<DirectionalLight>,\n\t\t'DirectionalLightHelper'\n\t);\n\tinitialize_node() {\n\t\t// this.io.inputs.set_count(0, 1);\n\t\t// this.io.inputs.set_depends_on_inputs(false);\n\n\t\tthis._helper_controller.initialize_node();\n\t}\n\n\tcreate_light() {\n\t\tconst light = new DirectionalLight();\n\n\t\tlight.castShadow = true;\n\t\tlight.shadow.bias = -0.001;\n\t\tlight.shadow.mapSize.x = 1024;\n\t\tlight.shadow.mapSize.y = 1024;\n\t\tlight.shadow.camera.near = 0.1;\n\n\t\tthis._target_target = light.target;\n\t\tthis._target_target.name = 'DirectionalLight Default Target';\n\t\tthis.object.add(this._target_target);\n\n\t\treturn light;\n\t}\n\t// add_object_to_parent(parent: Object3D) {\n\t// \tsuper.add_object_to_parent(parent);\n\t// \tparent.add(this._target_target);\n\t// }\n\t// remove_object_from_parent() {\n\t// \tsuper.remove_object_from_parent();\n\t// \tconst parent = this._target_target.parent;\n\t// \tif (parent) {\n\t// \t\tparent.remove(this._target_target);\n\t// \t}\n\t// }\n\n\tupdate_light_params() {\n\t\t// this.light.position.copy(this.pv.t);\n\t\tthis.light.color = this.pv.color;\n\t\tthis.light.intensity = this.pv.intensity;\n\t\tthis.light.shadow.camera.far = this.pv.distance;\n\n\t\tthis._helper_controller.update();\n\t}\n\tupdate_shadow_params() {\n\t\tthis.light.castShadow = this.pv.cast_shadows;\n\t\tthis.light.shadow.mapSize.copy(this.pv.shadow_res);\n\t\t// object.shadow.camera.near = this.pv.shadow_near\n\t\t// object.shadow.camera.far = this.pv.shadow_far\n\t\tthis.light.shadow.bias = this.pv.shadow_bias;\n\n\t\t// updating the camera matrix is not necessary for point light\n\t\t// so probably should not for this\n\t\tthis.light.shadow.camera.updateProjectionMatrix();\n\t}\n}\n","// import {Object3D} from 'three/src/core/Object3D';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {LineBasicMaterial} from 'three/src/materials/LineBasicMaterial';\nimport {DirectionalLightObjNode} from '../../DirectionalLight';\nimport {DirectionalLight} from 'three/src/lights/DirectionalLight';\nimport {BaseLightHelper} from './_BaseLightHelper';\nimport {Line} from 'three/src/objects/Line';\n\nexport class DirectionalLightHelper extends BaseLightHelper<DirectionalLight, DirectionalLightObjNode> {\n\tprivate _square = new Line();\n\tprivate _line_material = new LineBasicMaterial({fog: false});\n\tprotected build_helper() {\n\t\tconst geometry = new BufferGeometry();\n\t\tconst size = 1;\n\t\tgeometry.setAttribute(\n\t\t\t'position',\n\t\t\tnew Float32BufferAttribute(\n\t\t\t\t[-size, size, 0, size, size, 0, size, -size, 0, -size, -size, 0, -size, size, 0],\n\t\t\t\t3\n\t\t\t)\n\t\t);\n\n\t\tthis._square.geometry = geometry;\n\t\tthis._square.material = this._line_material;\n\t\tthis._square.rotateX(Math.PI * 0.5);\n\n\t\tthis.object.add(this._square);\n\t}\n\n\t// private _v1 = new Vector3();\n\t// private _v2 = new Vector3();\n\t// private _v3 = new Vector3();\n\tupdate() {\n\t\t// this._v1.copy(this.node.light.position);\n\t\t// this._v2.copy(this.node.light.target.position);\n\t\t// this._v3.subVectors(this._v2, this._v1);\n\n\t\t// this._object.position.copy(this.node.pv.position).multiplyScalar(-1);\n\t\t// this._quat.setFromUnitVectors(this._default_position, this.node.pv.position);\n\t\t// this._object.setRotationFromQuaternion(this._quat);\n\t\tthis._object.scale.setScalar(this.node.pv.helper_size);\n\n\t\tthis._line_material.color.copy(this.node.light.color);\n\t}\n}\n","import {HemisphereLight} from 'three/src/lights/HemisphereLight';\nimport {HemisphereLightHelper} from './utils/helpers/HemisphereLightHelper';\nimport {TypedLightObjNode} from './_BaseLight';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {HelperController, HelperConstructor} from './utils/HelperController';\nclass HemisphereLightObjParamsConfig extends NodeParamsConfig {\n\tlight = ParamConfig.FOLDER();\n\tsky_color = ParamConfig.COLOR([0.2, 0.7, 1]);\n\tground_color = ParamConfig.COLOR([0.1, 0.1, 0.25]);\n\tintensity = ParamConfig.FLOAT(1);\n\tposition = ParamConfig.VECTOR3([0, 1, 0]);\n\tshow_helper = ParamConfig.BOOLEAN(1);\n\thelper_size = ParamConfig.FLOAT(1, {visible_if: {show_helper: 1}});\n}\nconst ParamsConfig = new HemisphereLightObjParamsConfig();\n\nexport class HemisphereLightObjNode extends TypedLightObjNode<HemisphereLight, HemisphereLightObjParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'hemisphere_light';\n\t}\n\tprivate _helper_controller = new HelperController<HemisphereLight>(\n\t\tthis,\n\t\t(<unknown>HemisphereLightHelper) as HelperConstructor<HemisphereLight>,\n\t\t'HemisphereLightHelper'\n\t);\n\n\tcreate_light() {\n\t\tconst light = new HemisphereLight();\n\n\t\treturn light;\n\t}\n\tinitialize_node() {\n\t\tthis._helper_controller.initialize_node();\n\t}\n\n\tupdate_light_params() {\n\t\tthis.light.color = this.pv.sky_color;\n\t\tthis.light.groundColor = this.pv.ground_color;\n\t\tthis.light.position.copy(this.pv.position);\n\t\tthis.light.intensity = this.pv.intensity;\n\n\t\tthis._helper_controller.update();\n\t}\n}\n","import {Color} from 'three/src/math/Color';\nimport {OctahedronBufferGeometry} from 'three/src/geometries/OctahedronGeometry';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {VertexColors} from 'three/src/constants';\n\nimport {HemisphereLightObjNode} from '../../HemisphereLight';\nimport {Quaternion} from 'three/src/math/Quaternion';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {BaseLightHelper} from './_BaseLightHelper';\nimport {HemisphereLight} from 'three/src/lights/HemisphereLight';\n\nexport class HemisphereLightHelper extends BaseLightHelper<HemisphereLight, HemisphereLightObjNode> {\n\tprivate _geometry = new OctahedronBufferGeometry(1);\n\n\tprotected build_helper() {\n\t\tthis._geometry.rotateZ(Math.PI * 0.5);\n\n\t\tthis._material.vertexColors = VertexColors;\n\n\t\tconst position = this._geometry.getAttribute('position');\n\t\tconst colors = new Float32Array(position.count * 3);\n\n\t\tthis._geometry.setAttribute('color', new BufferAttribute(colors, 3));\n\t\tthis._object.geometry = this._geometry;\n\t\tthis._object.material = this._material;\n\t}\n\n\t// private _inverse_position = new Vector3();\n\tprivate _quat = new Quaternion();\n\tprivate _default_position = new Vector3(0, 1, 0);\n\tprivate _color1 = new Color();\n\tprivate _color2 = new Color();\n\tupdate() {\n\t\tif (!this.node.pv.position) {\n\t\t\treturn;\n\t\t}\n\t\t// this._inverse_position.copy(this.node.pv.position).multiplyScalar(-1)\n\t\tthis._object.position.copy(this.node.pv.position).multiplyScalar(-1);\n\t\tthis._quat.setFromUnitVectors(this._default_position, this.node.pv.position);\n\t\tthis._object.setRotationFromQuaternion(this._quat);\n\t\tthis._object.scale.setScalar(this.node.pv.helper_size);\n\n\t\tconst colors = this._geometry.getAttribute('color') as BufferAttribute;\n\n\t\tthis._color1.copy(this.node.light.color);\n\t\tthis._color2.copy(this.node.light.groundColor);\n\n\t\tfor (let i = 0, l = colors.count; i < l; i++) {\n\t\t\tconst color = i < l / 2 ? this._color1 : this._color2;\n\n\t\t\tcolors.setXYZ(i, color.r, color.g, color.b);\n\t\t}\n\n\t\tcolors.needsUpdate = true;\n\t}\n}\n","import {PointLight} from 'three/src/lights/PointLight';\nimport {PointLightHelper} from './utils/helpers/PointLightHelper';\n\nimport {BaseLightTransformedObjNode} from './_BaseLightTransformed';\nimport {TransformedParamConfig} from './utils/TransformController';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {HelperController, HelperConstructor} from './utils/HelperController';\n// import {HelperController} from './utils/HelperController';\nclass PointLightObjParamsConfig extends TransformedParamConfig(NodeParamsConfig) {\n\tlight = ParamConfig.FOLDER();\n\tcolor = ParamConfig.COLOR([1, 1, 1]);\n\tintensity = ParamConfig.FLOAT(1);\n\tdecay = ParamConfig.FLOAT(0.1);\n\tdistance = ParamConfig.FLOAT(100);\n\t// shadows\n\tcast_shadows = ParamConfig.BOOLEAN(1);\n\tshadow_res = ParamConfig.VECTOR2([1024, 1024], {visible_if: {cast_shadows: 1}});\n\tshadow_bias = ParamConfig.FLOAT(0.001, {visible_if: {cast_shadows: 1}});\n\tshadow_near = ParamConfig.FLOAT(1, {visible_if: {cast_shadows: 1}});\n\tshadow_far = ParamConfig.FLOAT(100, {visible_if: {cast_shadows: 1}});\n\n\t// helper\n\tshow_helper = ParamConfig.BOOLEAN(1);\n\thelper_size = ParamConfig.FLOAT(1, {visible_if: {show_helper: 1}});\n}\nconst ParamsConfig = new PointLightObjParamsConfig();\n\nexport class PointLightObjNode extends BaseLightTransformedObjNode<PointLight, PointLightObjParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'point_light';\n\t}\n\tprivate _helper_controller = new HelperController<PointLight>(\n\t\tthis,\n\t\t(<unknown>PointLightHelper) as HelperConstructor<PointLight>,\n\t\t'PointLightHelper'\n\t);\n\tinitialize_node() {\n\t\tthis._helper_controller.initialize_node();\n\t}\n\n\tcreate_light() {\n\t\tconst light = new PointLight();\n\n\t\tlight.castShadow = true;\n\t\tlight.shadow.bias = -0.001;\n\t\tlight.shadow.mapSize.x = 1024;\n\t\tlight.shadow.mapSize.y = 1024;\n\t\tlight.shadow.camera.near = 0.1;\n\n\t\treturn light;\n\t}\n\n\tupdate_light_params() {\n\t\tthis.light.color = this.pv.color;\n\t\tthis.light.intensity = this.pv.intensity;\n\t\tthis.light.decay = this.pv.decay;\n\n\t\tthis.light.distance = this.pv.distance;\n\n\t\tthis._helper_controller.update();\n\t}\n\tupdate_shadow_params() {\n\t\tthis.light.castShadow = this.pv.cast_shadows;\n\t\tthis.light.shadow.mapSize.copy(this.pv.shadow_res);\n\t\tthis.light.shadow.camera.near = this.pv.shadow_near;\n\t\tthis.light.shadow.camera.far = this.pv.shadow_far;\n\t\tthis.light.shadow.bias = this.pv.shadow_bias;\n\t}\n}\n","import {PointLightObjNode} from '../../PointLight';\n// import {Mesh} from 'three/src/objects/Mesh';\n// import {MeshBasicMaterial} from 'three/src/materials/MeshBasicMaterial';\nimport {SphereBufferGeometry} from 'three/src/geometries/SphereGeometry';\nimport {BaseLightHelper} from './_BaseLightHelper';\nimport {PointLight} from 'three/src/lights/PointLight';\n\nexport class PointLightHelper extends BaseLightHelper<PointLight, PointLightObjNode> {\n\tprotected build_helper() {\n\t\tconst size = 1;\n\t\tthis._object.geometry = new SphereBufferGeometry(size, 4, 2);\n\t\tthis._object.material = this._material;\n\t}\n\n\tupdate() {\n\t\tthis._object.scale.setScalar(this.node.pv.helper_size);\n\t\tthis._material.color.copy(this.node.light.color);\n\t}\n}\n","import {SpotLight} from 'three/src/lights/SpotLight';\n// import {SpotLightHelper} from 'three/src/helpers/SpotLightHelper';\nimport {BaseLightTransformedObjNode} from './_BaseLightTransformed';\nimport {TransformedParamConfig} from './utils/TransformController';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {HelperController, HelperConstructor} from './utils/HelperController';\nimport {SpotLightHelper} from './utils/helpers/SpotLightHelper';\nimport {Object3D} from 'three/src/core/Object3D';\n// import {HelperController} from './utils/HelperController';\nclass SpotLightObjParamsConfig extends TransformedParamConfig(NodeParamsConfig) {\n\tlight = ParamConfig.FOLDER();\n\tcolor = ParamConfig.COLOR([1, 1, 1]);\n\tintensity = ParamConfig.FLOAT(1);\n\tangle = ParamConfig.FLOAT(45, {range: [0, 180]});\n\tpenumbra = ParamConfig.FLOAT(0.1);\n\tdecay = ParamConfig.FLOAT(0.1, {range: [0, 1]});\n\tdistance = ParamConfig.FLOAT(100, {range: [0, 100]});\n\t// target = ParamConfig.OPERATOR_PATH('');\n\n\t// shadows\n\tcast_shadows = ParamConfig.BOOLEAN(1);\n\tshadow_res = ParamConfig.VECTOR2([1024, 1024]);\n\tshadow_bias = ParamConfig.FLOAT(0.001);\n\n\t// helper\n\tshow_helper = ParamConfig.BOOLEAN(1);\n\thelper_size = ParamConfig.FLOAT(1, {visible_if: {show_helper: 1}});\n}\nconst ParamsConfig = new SpotLightObjParamsConfig();\n\nexport class SpotLightObjNode extends BaseLightTransformedObjNode<SpotLight, SpotLightObjParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'spot_light';\n\t}\n\tprivate _target_target!: Object3D;\n\tprivate _helper_controller = new HelperController<SpotLight>(\n\t\tthis,\n\t\t(<unknown>SpotLightHelper) as HelperConstructor<SpotLight>,\n\t\t'SpotLightHelper'\n\t);\n\tinitialize_node() {\n\t\t// this.io.inputs.set_count(0, 1);\n\t\tthis._helper_controller.initialize_node();\n\t}\n\n\tcreate_light() {\n\t\tconst light = new SpotLight();\n\n\t\tlight.castShadow = true;\n\t\tlight.shadow.bias = -0.001;\n\t\tlight.shadow.mapSize.x = 1024;\n\t\tlight.shadow.mapSize.y = 1024;\n\t\tlight.shadow.camera.near = 0.1;\n\n\t\tthis._target_target = light.target;\n\t\tthis._target_target.name = 'SpotLight Default Target';\n\t\tthis.object.add(this._target_target);\n\n\t\treturn light;\n\t}\n\t// add_object_to_parent(parent: Object3D) {\n\t// \tsuper.add_object_to_parent(parent);\n\t// \tparent.add(this._target_target);\n\t// }\n\t// remove_object_from_parent() {\n\t// \tsuper.remove_object_from_parent();\n\t// \tconst parent = this._target_target.parent;\n\t// \tif (parent) {\n\t// \t\tparent.remove(this._target_target);\n\t// \t}\n\t// }\n\n\tupdate_light_params() {\n\t\tthis.light.color = this.pv.color;\n\t\tthis.light.intensity = this.pv.intensity;\n\t\tthis.light.angle = this.pv.angle * (Math.PI / 180);\n\t\tthis.light.penumbra = this.pv.penumbra;\n\t\tthis.light.decay = this.pv.decay;\n\t\tthis.light.distance = this.pv.distance;\n\n\t\tthis._helper_controller.update();\n\t}\n\tupdate_shadow_params() {\n\t\tthis.light.castShadow = this.pv.cast_shadows;\n\t\tthis.light.shadow.mapSize.copy(this.pv.shadow_res);\n\t\t// object.shadow.camera.near = this.pv.shadow_near\n\t\t// object.shadow.camera.far = this.pv.shadow_far\n\t\tthis.light.shadow.bias = this.pv.shadow_bias;\n\t}\n}\n","import {SpotLightObjNode} from '../../SpotLight';\n// import {Mesh} from 'three/src/objects/Mesh';\n// import {MeshBasicMaterial} from 'three/src/materials/MeshBasicMaterial';\nimport {BaseLightHelper} from './_BaseLightHelper';\nimport {SpotLight} from 'three/src/lights/SpotLight';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {LineBasicMaterial} from 'three/src/materials/LineBasicMaterial';\nimport {LineSegments} from 'three/src/objects/LineSegments';\n\nexport class SpotLightHelper extends BaseLightHelper<SpotLight, SpotLightObjNode> {\n\tprivate _cone = new LineSegments();\n\tprivate _line_material = new LineBasicMaterial({fog: false});\n\tprotected build_helper() {\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst positions = [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, -1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, -1, 1];\n\n\t\tfor (let i = 0, j = 1, l = 32; i < l; i++, j++) {\n\t\t\tconst p1 = (i / l) * Math.PI * 2;\n\t\t\tconst p2 = (j / l) * Math.PI * 2;\n\n\t\t\tpositions.push(Math.cos(p1), Math.sin(p1), 1, Math.cos(p2), Math.sin(p2), 1);\n\t\t}\n\n\t\tgeometry.setAttribute('position', new Float32BufferAttribute(positions, 3));\n\t\tthis._cone.geometry = geometry;\n\n\t\tthis._cone.material = this._line_material;\n\t\tthis._cone.rotateX(Math.PI * 0.5);\n\n\t\tthis.object.add(this._cone);\n\t}\n\n\tupdate() {\n\t\tconst coneLength = (this.node.light.distance ? this.node.light.distance : 1000) * this.node.pv.helper_size;\n\t\tconst coneWidth = coneLength * Math.tan(this.node.light.angle);\n\n\t\tthis._cone.scale.set(coneWidth, coneWidth, coneLength);\n\n\t\tthis._line_material.color.copy(this.node.light.color);\n\t}\n}\n","import {BaseManagerObjNode} from './_BaseManager';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {ObjNodeRenderOrder} from './_Base';\nimport {EventNodeChildrenMap} from 'src/engine/poly/registers/Event';\nimport {BaseEventNodeType} from '../event/_Base';\n\nexport class EventsObjNode extends BaseManagerObjNode {\n\tpublic readonly render_order: number = ObjNodeRenderOrder.EVENT;\n\tstatic type() {\n\t\treturn 'events';\n\t}\n\n\tprotected _children_controller_context = NodeContext.EVENT;\n\tinitialize_node() {\n\t\tthis.children_controller?.init();\n\t}\n\n\tcreate_node<K extends keyof EventNodeChildrenMap>(type: K): EventNodeChildrenMap[K] {\n\t\treturn super.create_node(type) as EventNodeChildrenMap[K];\n\t}\n\tchildren() {\n\t\treturn super.children() as BaseEventNodeType[];\n\t}\n\tnodes_by_type<K extends keyof EventNodeChildrenMap>(type: K): EventNodeChildrenMap[K][] {\n\t\treturn super.nodes_by_type(type) as EventNodeChildrenMap[K][];\n\t}\n}\n","import {BaseManagerObjNode} from './_BaseManager';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {ObjNodeRenderOrder} from './_Base';\nimport {MatNodeChildrenMap} from 'src/engine/poly/registers/Mat';\nimport {BaseMatNodeType} from '../mat/_Base';\n\nexport class MaterialsObjNode extends BaseManagerObjNode {\n\tpublic readonly render_order: number = ObjNodeRenderOrder.MAT;\n\tstatic type() {\n\t\treturn 'materials';\n\t}\n\t// children_context(){ return NodeContext.MAT }\n\n\tprotected _children_controller_context = NodeContext.MAT;\n\tinitialize_node() {\n\t\tthis.children_controller?.init();\n\t}\n\n\tcreate_node<K extends keyof MatNodeChildrenMap>(type: K): MatNodeChildrenMap[K] {\n\t\treturn super.create_node(type) as MatNodeChildrenMap[K];\n\t}\n\tchildren() {\n\t\treturn super.children() as BaseMatNodeType[];\n\t}\n\tnodes_by_type<K extends keyof MatNodeChildrenMap>(type: K): MatNodeChildrenMap[K][] {\n\t\treturn super.nodes_by_type(type) as MatNodeChildrenMap[K][];\n\t}\n}\n","import {BaseManagerObjNode} from './_BaseManager';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {CopNodeChildrenMap} from 'src/engine/poly/registers/Cop';\nimport {BaseCopNodeType} from '../cop/_Base';\n\nexport class CopObjNode extends BaseManagerObjNode {\n\tstatic type() {\n\t\treturn 'cop';\n\t}\n\t// children_context(){ return NodeContext.COP }\n\n\tprotected _children_controller_context = NodeContext.COP;\n\tinitialize_node() {\n\t\tthis.children_controller?.init();\n\t\t// this._init_manager();\n\t}\n\n\tcreate_node<K extends keyof CopNodeChildrenMap>(type: K): CopNodeChildrenMap[K] {\n\t\treturn super.create_node(type) as CopNodeChildrenMap[K];\n\t}\n\tchildren() {\n\t\treturn super.children() as BaseCopNodeType[];\n\t}\n\tnodes_by_type<K extends keyof CopNodeChildrenMap>(type: K): CopNodeChildrenMap[K][] {\n\t\treturn super.nodes_by_type(type) as CopNodeChildrenMap[K][];\n\t}\n}\n","import {BaseManagerObjNode} from './_BaseManager';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\n\nexport class PostProcessObjNode extends BaseManagerObjNode {\n\tstatic type() {\n\t\treturn 'post_process';\n\t}\n\t// children_context(){ return NodeContext.POST }\n\n\tprotected _children_controller_context = NodeContext.POST;\n\tinitialize_node() {\n\t\tthis.children_controller?.init();\n\t\t// this._init_manager();\n\t}\n}\n","import {TypedObjNode} from './_Base';\nimport {Group} from 'three/src/objects/Group';\n// const THREE = {Group};\n\n// import {CoreTransform} from 'src/core/Transform';\n\nimport {BaseNodeType} from '../_Base';\nimport {DisplayNodeController} from '../utils/DisplayNodeController';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\n\n//import Layers from './Concerns/Layers'\n// import {Transformed} from './Concerns/Transformed';\n\n// sop map\nimport {BaseSopNodeType} from '../sop/_Base';\n// import {PolyScene} from 'src/engine/scene/PolyScene';\nimport {TransformedParamConfig, TransformController} from './utils/TransformController';\n\nimport {GeoNodeChildrenMap} from 'src/engine/poly/registers/Sop';\nimport {FlagsControllerD} from '../utils/FlagsController';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass GeoObjParamConfig extends TransformedParamConfig(NodeParamsConfig) {\n\tdisplay = ParamConfig.BOOLEAN(1);\n}\nconst ParamsConfig = new GeoObjParamConfig();\n\nexport class GeoObjNode extends TypedObjNode<Group, GeoObjParamConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'geo';\n\t}\n\treadonly transform_controller: TransformController = new TransformController(this);\n\tprotected _display_node_controller: DisplayNodeController = new DisplayNodeController(this);\n\tget display_node_controller() {\n\t\treturn this._display_node_controller;\n\t}\n\tpublic readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\n\tprivate _sop_group = this._create_sop_group();\n\tprivate _create_sop_group() {\n\t\treturn new Group();\n\t}\n\tget sop_group() {\n\t\treturn this._sop_group;\n\t}\n\tset_sop_group_name() {\n\t\tthis._sop_group.name = `${this.full_path()}:sop_group`;\n\t}\n\n\t// children_context() {\n\t// \treturn NodeContext.SOP;\n\t// }\n\n\tprotected _children_controller_context = NodeContext.SOP;\n\tinitialize_node() {\n\t\tthis.children_controller?.init();\n\n\t\tthis.display_node_controller.initialize_node();\n\t\tthis.transform_controller.initialize_node();\n\t\t// this.flags.display.add_hook(() => {\n\t\t// \tthis.set_used_in_scene(this.flags.display.active);\n\t\t// });\n\n\t\tthis.object.add(this.sop_group);\n\n\t\tthis.name_controller.add_post_set_full_path_hook(this.set_sop_group_name.bind(this));\n\t\tthis._create_sop_group();\n\t\t// this._init_display_flag({\n\t\t// \tmultiple_display_flags_allowed: false,\n\t\t// \taffects_hierarchy: true,\n\t\t// });\n\t\t// this._init_dirtyable_hook();\n\n\t\t// this.io.inputs.set_count(0, 1);\n\t\t// this.io.outputs.set_has_one_output();\n\t}\n\n\tcreate_object() {\n\t\treturn new Group();\n\t}\n\n\t//base_layers_included: -> false\n\n\t// create_params() {\n\t// \t// CoreTransform.create_params(this);\n\t// }\n\t//this.create_layers_params()\n\n\trequest_display_node() {\n\t\tif (!this.scene.loading_controller.auto_updating) {\n\t\t\treturn;\n\t\t}\n\n\t\t// TODO: typescript\n\t\t// if (this.is_displayed)\n\t\t// \tconst display_node = this.display_node();\n\t\t// \tif (display_node) {\n\t\t// \t\tdisplay_node.request_container_p().then(async (container) => {\n\t\t// \t\t\tif (!this._sop_loaded) {\n\t\t// \t\t\t\tthis.root().notify_geo_loaded(this);\n\t\t// \t\t\t}\n\t\t// \t\t\tthis._sop_loaded = true;\n\n\t\t// \t\t\tconst update_needed = await this.display_node_objects_changed(container);\n\t\t// \t\t\tif (update_needed) {\n\t\t// \t\t\t\tthis.remove_display_node_group();\n\t\t// \t\t\t\tawait this.add_display_node_group(container);\n\t\t// \t\t\t}\n\t\t// \t\t\t// this.set_needsUpdate(container)\n\t\t// \t\t});\n\t\t// \t} else {\n\t\t// \t\tthis.root().notify_geo_loaded(this);\n\t\t// \t\tthis._sop_loaded = true;\n\t\t// \t}\n\t\t// }\n\t}\n\n\tis_display_node_cooking(): boolean {\n\t\tif (this.flags.display.active) {\n\t\t\tconst display_node = this._display_node_controller.display_node;\n\t\t\treturn display_node ? display_node.is_dirty : false;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tpost_display_flag_node_set_dirty() {\n\t\tthis.request_display_node();\n\t}\n\tpost_add_node(node: BaseNodeType) {\n\t\t// we test if the scene is loaded\n\t\t// otherwise a display flag will be set for the first node\n\t\t// that is added when the scene is being loaded,\n\t\t// only to be changed again when the actual display node is set.\n\t\t// Without this, we have a jarring first object being displayed\n\t\t// only to be replaced by the proper one when it is ready.\n\t\tif (this.scene.loading_controller.loaded) {\n\t\t\tif (this.children().length == 1) {\n\t\t\t\tnode.flags?.display?.set(true);\n\t\t\t}\n\t\t}\n\t}\n\tcreate_node<K extends keyof GeoNodeChildrenMap>(type: K): GeoNodeChildrenMap[K] {\n\t\treturn super.create_node(type) as GeoNodeChildrenMap[K];\n\t}\n\tchildren() {\n\t\treturn super.children() as BaseSopNodeType[];\n\t}\n\tnodes_by_type<K extends keyof GeoNodeChildrenMap>(type: K): GeoNodeChildrenMap[K][] {\n\t\treturn super.nodes_by_type(type) as GeoNodeChildrenMap[K][];\n\t}\n\t// create_node(type: string): BaseSopNode<any> {\n\t// \treturn super.create_node(type) as  BaseSopNode<any>;\n\t// }\n\ton_create() {\n\t\t// this.create_node('text')\n\t}\n\t// private _core_transform = new CoreTransform();\n\tcook() {\n\t\tthis.transform_controller.update();\n\t\t//this.update_layers()\n\n\t\tthis.cook_controller.end_cook();\n\t}\n}\n","import {GeoObjNode} from '../obj/Geo';\nimport {BaseSopNodeType} from '../sop/_Base';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n\nexport class DisplayNodeController {\n\t_graph_node: CoreGraphNode;\n\t_display_node: BaseSopNodeType | undefined;\n\t_children_uuids_dict: Dictionary<boolean> = {};\n\t_children_length: number = 0;\n\tprivate _request_display_node_container_bound = this.request_display_node_container.bind(this);\n\tconstructor(protected node: GeoObjNode) {\n\t\tthis._graph_node = new CoreGraphNode(node.scene, 'DisplayNodeController');\n\n\t\tthis._graph_node.dirty_controller.add_post_dirty_hook(\n\t\t\t'_request_display_node_container',\n\t\t\tthis._request_display_node_container_bound\n\t\t);\n\t}\n\n\tget display_node() {\n\t\treturn this._display_node;\n\t}\n\tprivate _parent_object: Object3D | undefined;\n\tset_parent_object(object: Object3D) {\n\t\tthis._parent_object = object;\n\t}\n\tget parent_object() {\n\t\treturn this._parent_object || this.node.object;\n\t}\n\n\tinitialize_node() {\n\t\tthis.set_parent_object(this.node.sop_group);\n\t\tthis.node.flags.display.add_hook(() => {\n\t\t\tthis.node.sop_group.visible = this.used_in_scene;\n\t\t\tif (this.node.flags.display.active) {\n\t\t\t\tthis.request_display_node_container();\n\t\t\t}\n\t\t});\n\n\t\tthis.node.lifecycle.add_on_child_add_hook((child_node) => {\n\t\t\tif (!this._display_node) {\n\t\t\t\tchild_node.flags?.display?.set(true);\n\t\t\t}\n\t\t});\n\t}\n\n\tasync set_display_node(new_display_node: BaseSopNodeType) {\n\t\tif (this._display_node != new_display_node) {\n\t\t\tconst old_display_node = this._display_node;\n\t\t\tif (old_display_node) {\n\t\t\t\told_display_node.flags.display.set(false);\n\t\t\t\tthis._graph_node.remove_graph_input(old_display_node);\n\t\t\t\tthis.remove_children();\n\t\t\t}\n\t\t\tthis._display_node = new_display_node;\n\t\t\tif (this._display_node) {\n\t\t\t\tthis._graph_node.add_graph_input(this._display_node);\n\t\t\t}\n\t\t\tthis.request_display_node_container();\n\t\t}\n\t}\n\n\tremove_children() {\n\t\tlet child: Object3D | undefined;\n\t\twhile ((child = this.parent_object.children.pop())) {\n\t\t\tthis.parent_object.remove(child);\n\t\t}\n\t}\n\n\tget used_in_scene() {\n\t\treturn this.node.used_in_scene && this.node.flags.display.active && this.node.pv.display == true;\n\t}\n\n\tprivate async request_display_node_container() {\n\t\tif (!this.node.scene.loading_controller.loaded) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.used_in_scene) {\n\t\t\tif (this._display_node) {\n\t\t\t\tconst container = await this._display_node.request_container();\n\t\t\t\tconst core_group = container.core_content();\n\t\t\t\tif (core_group) {\n\t\t\t\t\t// check if the new objects are different\n\t\t\t\t\tconst new_objects = core_group.objects();\n\t\t\t\t\tlet new_objects_are_different = new_objects.length != this._children_length;\n\t\t\t\t\tif (!new_objects_are_different) {\n\t\t\t\t\t\tfor (let object of new_objects) {\n\t\t\t\t\t\t\tif (!(object.uuid in this._children_uuids_dict)) {\n\t\t\t\t\t\t\t\tnew_objects_are_different = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// update hierarchy if different\n\t\t\t\t\tif (new_objects_are_different) {\n\t\t\t\t\t\tthis.remove_children();\n\t\t\t\t\t\tthis._children_uuids_dict = {};\n\t\t\t\t\t\tfor (let object of new_objects) {\n\t\t\t\t\t\t\tthis.parent_object.add(object);\n\t\t\t\t\t\t\tthis._children_uuids_dict[object.uuid] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._children_length = new_objects.length;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.remove_children();\n\t\t\t\t\tthis._children_uuids_dict = {};\n\t\t\t\t\tthis._children_length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","import {TypedObjNode} from './_Base';\nimport {Group} from 'three/src/objects/Group';\nimport {TransformedParamConfig, TransformController} from './utils/TransformController';\n// import {CoreTransform} from 'src/core/Transform';\nimport {FlagsControllerD} from '../utils/FlagsController';\nimport {AxesHelper} from 'three/src/helpers/AxesHelper';\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass NullObjParamConfig extends TransformedParamConfig(NodeParamsConfig) {}\nconst ParamsConfig = new NullObjParamConfig();\n\nexport class NullObjNode extends TypedObjNode<Group, NullObjParamConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'null';\n\t}\n\treadonly transform_controller: TransformController = new TransformController(this);\n\tpublic readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\tprivate _helper = new AxesHelper(1);\n\n\tcreate_object() {\n\t\treturn new Group();\n\t}\n\tinitialize_node() {\n\t\tthis.transform_controller.initialize_node();\n\t\tthis.object.add(this._helper);\n\t\tthis.flags.display.add_hook(() => {\n\t\t\tthis._helper.visible = this.flags.display.active;\n\t\t});\n\t}\n\tcook() {\n\t\tthis.transform_controller.update();\n\t\tthis.cook_controller.end_cook();\n\t}\n}\n","// import {BaseNode} from '../_Base';\nimport {TypedObjNode, ObjNodeRenderOrder} from './_Base';\nimport {FogExp2} from 'three/src/scenes/FogExp2';\nimport {Fog} from 'three/src/scenes/Fog';\nimport {Color} from 'three/src/math/Color';\n\nconst DEFAULT = {\n\tcolor: new Color(1, 1, 1),\n\tnear: 0,\n\tfar: 100,\n\tdensity: 0.00025,\n};\n\n// export Fog = (function() {\n// \tlet DEFAULT = undefined;\n// \tFog = class Fog extends BaseModules {\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {FlagsControllerD} from '../utils/FlagsController';\nclass FogObjParamConfig extends NodeParamsConfig {\n\tcolor = ParamConfig.COLOR(DEFAULT.color.toArray() as [number, number, number]);\n\texponential = ParamConfig.BOOLEAN(0);\n\tdensity = ParamConfig.FLOAT(1);\n\tnear = ParamConfig.FLOAT(0, {range: [0, 100]});\n\tfar = ParamConfig.FLOAT(100, {range: [0, 100]});\n}\nconst ParamsConfig = new FogObjParamConfig();\nexport class FogObjNode extends TypedObjNode<Object3D, FogObjParamConfig> {\n\tparams_config = ParamsConfig;\n\tpublic readonly flags: FlagsControllerD = new FlagsControllerD(this);\n\tpublic readonly render_order: number = ObjNodeRenderOrder.MANAGER;\n\t// public readonly add_to_hierarchy: boolean = false;\n\tprotected _attachable_to_hierarchy: boolean = false;\n\n\tprotected _linear_fog!: Fog;\n\tprotected _linear_fogexp2!: FogExp2;\n\n\tinitialize_node() {\n\t\t// this._init_display_flag({\n\t\t// \tmultiple_display_flags_allowed: false,\n\t\t// });\n\n\t\t// this.set_inputs_count_to_zero();\n\t\t// this._init_dirtyable_hook();\n\n\t\tthis._linear_fog = new Fog(DEFAULT.color.getHex(), DEFAULT.near, DEFAULT.far);\n\t\tthis._linear_fogexp2 = new FogExp2(DEFAULT.color.getHex(), DEFAULT.density);\n\t}\n\tstatic type() {\n\t\treturn 'fog';\n\t}\n\n\t// create_params() {\n\t// \tthis.add_param(ParamType.COLOR, 'color', DEFAULT.color.toArray() as [number, number, number]);\n\t// \tthis.add_param(ParamType.BOOLEAN, 'exponential', 0);\n\t// \tthis.add_param(ParamType.FLOAT, 'density', DEFAULT.density);\n\t// \tthis.add_param(ParamType.FLOAT, 'near', DEFAULT.near, {\n\t// \t\trange: [0, 100],\n\t// \t});\n\t// \tthis.add_param(ParamType.FLOAT, 'far', DEFAULT.far, {\n\t// \t\trange: [0, 100],\n\t// \t});\n\t// }\n\n\t// get_fog: (callback)->\n\t// \tthis.param('exponential').eval (val)=>\n\t// \t\tfog = if val then @_exponential_fog else @_linear_fog\n\t// \t\tcallback(fog)\n\n\tcook() {\n\t\tlet fog: Fog | FogExp2;\n\t\tif (this.pv.exponential) {\n\t\t\tthis._linear_fogexp2.density = this.pv.density;\n\t\t\tfog = this._linear_fogexp2;\n\t\t} else {\n\t\t\tthis._linear_fog.near = this.pv.near;\n\t\t\tthis._linear_fog.far = this.pv.far; // * (1/@_param_intensity)\n\t\t\tfog = this._linear_fog;\n\t\t}\n\n\t\tfog.color.copy(this.pv.color);\n\n\t\tthis.scene.display_scene.fog = fog;\n\n\t\tthis.cook_controller.end_cook();\n\t}\n}\n","// import {Vector2} from 'three/src/math/Vector2';\nimport {OrthographicCamera} from 'three/src/cameras/OrthographicCamera';\n// import {Group} from 'three/src/objects/Group';\n// import {CameraHelper} from 'three/src/helpers/CameraHelper';\n// import lodash_clamp from 'lodash/clamp';\nimport {TypedCameraObjNode, BASE_CAMERA_DEFAULT, CameraTransformParamConfig} from './_BaseCamera';\n\nimport {OrthographicCameraBackgroundController} from './utils/cameras/background/OrthographicCameraController';\n// import {ParamType} from 'src/engine/poly/ParamType';\n\nconst DEFAULT = {\n\tleft: -0.5,\n\tright: 0.5,\n\ttop: 0.5,\n\tbottom: -0.5,\n};\n\nimport {ParamConfig, NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {CameraPostProcessParamConfig} from './utils/cameras/PostProcessController';\nimport {CameraBackgroundParamConfig} from './utils/cameras/background/_BaseController';\nimport {LayerParamConfig} from './utils/LayersController';\nimport {TransformedParamConfig} from './utils/TransformController';\nexport function OrthographicCameraObjParamConfigMixin<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tsize = ParamConfig.FLOAT(1);\n\t\t// vertical_size_range = ParamConfig.VECTOR2([-1, -1]);\n\t\t// horizontal_size_range = ParamConfig.VECTOR2([-1, -1]);\n\t};\n}\n\nclass OrthographicCameraObjParamConfig extends CameraPostProcessParamConfig(\n\tCameraBackgroundParamConfig(\n\t\tTransformedParamConfig(\n\t\t\tLayerParamConfig(OrthographicCameraObjParamConfigMixin(CameraTransformParamConfig(NodeParamsConfig)))\n\t\t)\n\t)\n) {}\nconst ParamsConfig = new OrthographicCameraObjParamConfig();\n\nexport class OrthographicCameraObjNode extends TypedCameraObjNode<\n\tOrthographicCamera,\n\tOrthographicCameraObjParamConfig\n> {\n\tparams_config = ParamsConfig;\n\n\tprotected get background_controller_constructor() {\n\t\treturn OrthographicCameraBackgroundController;\n\t}\n\n\tstatic type() {\n\t\treturn 'orthographic_camera';\n\t}\n\n\tcreate_object() {\n\t\treturn new OrthographicCamera(\n\t\t\tDEFAULT.left * 2,\n\t\t\tDEFAULT.right * 2,\n\t\t\tDEFAULT.top * 2,\n\t\t\tDEFAULT.bottom * 2,\n\t\t\tBASE_CAMERA_DEFAULT.near,\n\t\t\tBASE_CAMERA_DEFAULT.far\n\t\t);\n\t}\n\t//@_helper = new CameraHelper( @_camera )\n\t//group = new Group()\n\t//group.add(@_camera)\n\t//group.add(@_helper)\n\n\t//this.set_object(@_camera)\n\n\t// create_params() {\n\t// \t// this.create_common_params();\n\t// \t// this.add_param('float', 'left', DEFAULT.left)\n\t// \t// this.add_param('float', 'right', DEFAULT.right)\n\t// \t// this.add_param('float', 'top', DEFAULT.top)\n\t// \t// this.add_param('float', 'bottom', DEFAULT.bottom)\n\n\t// \t// this.within_param_folder('render', () => {\n\t// \tthis.add_param(ParamType.FLOAT, 'size', 2, {range: [0, 10]});\n\t// \t// left : Number, right : Number, top : Number, bottom : Number, near : Number, far : Number\n\t// \tthis.add_param(ParamType.VECTOR2, 'vertical_size_range', [0, 10], {visible_if: {lock_width: 1}});\n\t// \tthis.add_param(ParamType.VECTOR2, 'horizontal_size_range', [0, 10], {visible_if: {lock_width: 0}});\n\n\t// \t// this.create_player_camera_params();\n\t// \t// });\n\t// }\n\n\tupdate_camera() {\n\t\tthis._update_for_aspect_ratio();\n\t}\n\n\tprotected _update_for_aspect_ratio() {\n\t\tif (this._aspect) {\n\t\t\tconst size = this.pv.size || 1;\n\t\t\t// let lock_width = this.pv.lock_width;\n\t\t\t// if (lock_width == null) {\n\t\t\t// \tlock_width = true;\n\t\t\t// }\n\t\t\t// if (lock_width) {\n\t\t\t// \tconst vertical_size = size / this._aspect;\n\t\t\t// \tconst zoom = 1 //this.get_zoom(vertical_size, this.pv.vertical_size_range);\n\t\t\t// \tthis._object.left = DEFAULT.left * size * zoom;\n\t\t\t// \tthis._object.right = DEFAULT.right * size * zoom;\n\t\t\t// \tthis._object.top = DEFAULT.top * vertical_size * zoom;\n\t\t\t// \tthis._object.bottom = DEFAULT.bottom * vertical_size * zoom;\n\t\t\t// } else {\n\t\t\tconst horizontal_size = size * this._aspect;\n\t\t\tconst zoom = 1; //this.get_zoom(horizontal_size, this.pv.horizontal_size_range);\n\t\t\tthis._object.left = DEFAULT.left * horizontal_size * zoom;\n\t\t\tthis._object.right = DEFAULT.right * horizontal_size * zoom;\n\t\t\tthis._object.top = DEFAULT.top * size * zoom;\n\t\t\tthis._object.bottom = DEFAULT.bottom * size * zoom;\n\t\t\t// }\n\t\t\tthis._object.updateProjectionMatrix();\n\t\t}\n\t}\n\n\t// private get_zoom(size: number, range: Vector2) {\n\t// \tlet zoom = 1;\n\t// \tif (range) {\n\t// \t\tif (size < range.x || size > range.y) {\n\t// \t\t\tconst new_size = lodash_clamp(size, range.x, range.y);\n\t// \t\t\tzoom = new_size / size;\n\t// \t\t}\n\t// \t}\n\t// \treturn zoom;\n\t// }\n}\n","import {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\nimport {BaseCameraControlsEventNodeType, CameraControls} from 'src/engine/nodes/event/_BaseCameraControls';\nimport {CameraControlsConfig} from 'src/engine/nodes/event/utils/CameraControlConfig';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {CameraOrbitControlsEventNode} from 'src/engine/nodes/event/CameraOrbitControls';\n\nconst CONTROLS_PARAM_NAME = 'controls';\n\nexport class ControlsController {\n\t_applied_controls_by_element_id: Dictionary<Dictionary<boolean>> = {};\n\tprivate _controls_node: BaseCameraControlsEventNodeType | null = null;\n\tprivate controls_start_listener: (() => void) | undefined;\n\tprivate controls_end_listener: (() => void) | undefined;\n\n\tconstructor(private node: BaseCameraObjNodeType) {}\n\n\tcontrols_param(): BaseParamType | null {\n\t\tif (this.node.params.has(CONTROLS_PARAM_NAME)) {\n\t\t\treturn this.node.params.get(CONTROLS_PARAM_NAME);\n\t\t}\n\t\treturn null;\n\t}\n\n\tasync controls_node(): Promise<BaseCameraControlsEventNodeType | null> {\n\t\tconst controls_param = this.node.p.controls;\n\t\tconst raw_input = controls_param.raw_input;\n\t\tif (raw_input && raw_input != '') {\n\t\t\tif (controls_param.is_dirty) {\n\t\t\t\tawait controls_param.compute();\n\t\t\t}\n\t\t\tconst node = controls_param.found_node();\n\t\t\tif (node) {\n\t\t\t\tif (node instanceof CameraOrbitControlsEventNode) {\n\t\t\t\t\treturn node;\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.states.error.set('found node is not of a camera control type');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.node.states.error.set('no node has been found');\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tasync update_controls() {\n\t\tconst controls_node = await this.controls_node();\n\t\tif (controls_node) {\n\t\t\tif (this._controls_node != controls_node) {\n\t\t\t\tthis.dispose_control_refs();\n\t\t\t}\n\t\t}\n\n\t\tthis._controls_node = controls_node;\n\t}\n\n\tasync apply_controls(html_element: HTMLElement) {\n\t\tconst controls_node = await this.controls_node();\n\t\tif (controls_node) {\n\t\t\t// keep last_control_node_id to ensure we don't apply the controls more than once\n\t\t\t// OR it allow the viewer to remain in control of this\n\t\t\t//if !@_last_control_node_id? || (@_last_control_node_id != controls_node.graph_node_id)\n\t\t\t// but for now, the controls are still applied again after mouse up\n\t\t\tconst controls_id = controls_node.controls_id();\n\t\t\tlet controls_aleady_applied = false;\n\t\t\tif (\n\t\t\t\tthis._applied_controls_by_element_id[html_element.id] &&\n\t\t\t\tthis._applied_controls_by_element_id[html_element.id][controls_id]\n\t\t\t) {\n\t\t\t\tcontrols_aleady_applied = true;\n\t\t\t}\n\t\t\tif (!controls_aleady_applied) {\n\t\t\t\t// this._last_control_node_id = controls_id;\n\t\t\t\tthis._applied_controls_by_element_id[html_element.id] =\n\t\t\t\t\tthis._applied_controls_by_element_id[html_element.id] || {};\n\t\t\t\tthis._applied_controls_by_element_id[html_element.id][controls_id] = true;\n\n\t\t\t\t// request_container forces a cook\n\t\t\t\t//controls_node.request_container (controls_container)=>\n\t\t\t\tconst controls = await controls_node.apply_controls(this.node.object, html_element);\n\t\t\t\tconst config = new CameraControlsConfig(this.node.graph_node_id, controls_node, controls);\n\t\t\t\tcontrols_node.set_from_camera_node(controls, this.node);\n\t\t\t\tthis.set_controls_events(controls);\n\t\t\t\treturn config;\n\t\t\t}\n\t\t}\n\t}\n\tdispose_control_refs() {\n\t\tthis._applied_controls_by_element_id = {};\n\t}\n\n\t// calling dispose controls\n\t// ensure that we can set the camera menu to camera1, then camera2 and back to camera1\n\t// and controls will be cleared each time\n\tasync dispose_controls(html_element: HTMLElement) {\n\t\tdelete this._applied_controls_by_element_id[html_element.id];\n\t\t// if (this._applied_controls_by_element_id[html_element.id]) {\n\t\t// \tconst controls_node = await this.controls_node();\n\t\t// \tif (controls_node) {\n\t\t// \t\tconst controls_id = controls_node.controls_id();\n\t\t// \t\tdelete this._applied_controls_by_element_id[html_element.id][controls_id];\n\t\t// \t}\n\t\t// }\n\t\t// @_controls_node?.dispose_controls()\n\t\t// if(this._applied_controls_by_element_id[html_element.id]){\n\t\t// \tdelete this._applied_controls_by_element_id[html_element.id][controls_id]\n\t\t// }\n\t\t// this._last_control_node_id = null\n\t}\n\tset_controls_events(controls: CameraControls) {\n\t\t// restore target (for orbit controls only for now)\n\t\t// to ensure that camera does not reset its target on 0,0,0 on first move\n\t\t// const controls_node = this.controls_node()\n\t\t// if (controls_node){\n\t\t// \tcontrols_node.\n\t\t// }\n\t\t// if(controls.target){\n\t\t// \tcontrols.target.copy(this._param_target) //.clone()\n\t\t// }\n\n\t\tthis.controls_start_listener = () => {\n\t\t\tthis.on_controls_start(controls);\n\t\t};\n\t\tthis.controls_end_listener = () => {\n\t\t\tthis.on_controls_end(controls);\n\t\t};\n\t\tcontrols.addEventListener('start', this.controls_start_listener);\n\t\tcontrols.addEventListener('end', this.controls_end_listener);\n\t}\n\n\ton_controls_start(controls: CameraControls) {\n\t\t// this.param('is_updating').set(1)\n\t}\n\ton_controls_end(controls: CameraControls) {\n\t\t// this.param('is_updating').set(0)\n\t\tif (controls.target) {\n\t\t\tconst val = controls.target.toArray() as [number, number, number];\n\t\t\tthis.node.params.set_vector3('target', val);\n\t\t}\n\t\tthis.node.update_transform_params_from_object();\n\t}\n}\n","import {BaseCameraControlsEventNodeType, CameraControls} from '../_BaseCameraControls';\n\nexport class CameraControlsConfig {\n\tconstructor(\n\t\tprivate _camera_node_id: string,\n\t\tprivate _controls_node: BaseCameraControlsEventNodeType,\n\t\tprivate _controls: CameraControls\n\t) {}\n\n\tget camera_node_id() {\n\t\treturn this._camera_node_id;\n\t}\n\t// camera_controls_node_id(){\n\t// \treturn this._camera_controls_node_id\n\t// }\n\tget controls() {\n\t\treturn this._controls;\n\t}\n\tget controls_node() {\n\t\treturn this._controls_node;\n\t}\n\n\tis_equal(other_config: CameraControlsConfig): boolean {\n\t\treturn (\n\t\t\tother_config.camera_node_id == this._camera_node_id &&\n\t\t\tother_config.controls_node.graph_node_id == this._controls_node.graph_node_id\n\t\t);\n\t}\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\n\nimport { Pass } from \"../postprocessing/Pass.js\";\n\nvar RenderPass = function ( scene, camera, overrideMaterial, clearColor, clearAlpha ) {\n\n\tPass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.overrideMaterial = overrideMaterial;\n\n\tthis.clearColor = clearColor;\n\tthis.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;\n\n\tthis.clear = true;\n\tthis.clearDepth = false;\n\tthis.needsSwap = false;\n\n};\n\nRenderPass.prototype = Object.assign( Object.create( Pass.prototype ), {\n\n\tconstructor: RenderPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tvar oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tthis.scene.overrideMaterial = this.overrideMaterial;\n\n\t\tvar oldClearColor, oldClearAlpha;\n\n\t\tif ( this.clearColor ) {\n\n\t\t\toldClearColor = renderer.getClearColor().getHex();\n\t\t\toldClearAlpha = renderer.getClearAlpha();\n\n\t\t\trenderer.setClearColor( this.clearColor, this.clearAlpha );\n\n\t\t}\n\n\t\tif ( this.clearDepth ) {\n\n\t\t\trenderer.clearDepth();\n\n\t\t}\n\n\t\trenderer.setRenderTarget( this.renderToScreen ? null : readBuffer );\n\n\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\trenderer.render( this.scene, this.camera );\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\n\t\t}\n\n\t\tthis.scene.overrideMaterial = null;\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n} );\n\nexport { RenderPass };\n","import {PolyScene} from 'src/engine/scene/PolyScene';\nimport {Vector2} from 'three/src/math/Vector2';\n// import {WebGLRenderer} from 'three/src/renderers/WebGLRenderer'\n// import {Color} from 'three/src/math/Color'\n\nimport {BaseViewer} from './_Base';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\n\n// import 'src/engine/Poly';\n// import {POLY} from 'src/engine/Poly';\n\nconst CSS_CLASS = 'CoreThreejsViewer';\n\ndeclare global {\n\tinterface HTMLCanvasElement {\n\t\tonwebglcontextlost: () => void;\n\t\tonwebglcontextrestored: () => void;\n\t}\n}\n\nexport class ThreejsViewer extends BaseViewer {\n\tprivate _request_animation_frame_id: number | undefined;\n\tprivate do_render: boolean = true;\n\n\tprivate _animate_method: () => void = this.animate.bind(this);\n\n\tconstructor(_container: HTMLElement, protected _scene: PolyScene, camera_node: BaseCameraObjNodeType) {\n\t\tsuper(_container, _scene, camera_node);\n\n\t\tthis._canvas = document.createElement('canvas');\n\t\tthis._canvas.id = `canvas_id_${Math.random()}`.replace('.', '_');\n\t\tthis._canvas.style.display = 'block';\n\t\tthis._canvas.style.outline = 'none';\n\n\t\tthis._container.appendChild(this._canvas);\n\t\tthis._container.classList.add(CSS_CLASS);\n\t\tthis._container.style.height = '100%';\n\n\t\tthis._set_events();\n\t}\n\n\tpublic _build() {\n\t\tthis._init_display();\n\t\tthis.activate();\n\t}\n\n\tdispose() {\n\t\tthis._cancel_animate();\n\t\tthis.controls_controller.dispose_controls();\n\t\t// this._dispose_graph_node()\n\t}\n\n\tprivate _set_events() {\n\t\tthis.events_controller.init();\n\t\tthis.webgl_controller.init();\n\n\t\t// if (POLY.player_mode()) {\n\t\twindow.onresize = () => {\n\t\t\tthis.cameras_controller.on_resize();\n\t\t};\n\t\t// }\n\t}\n\t// protected _on_touchmove(event: TouchEvent){\n\t// \tconsole.log(\"touch\", event)\n\t// }\n\n\tprivate _init_display() {\n\t\tif (!this._canvas) {\n\t\t\treturn;\n\t\t}\n\t\tthis.cameras_controller.compute_size_and_aspect();\n\t\tconst size: Vector2 = this.cameras_controller.size;\n\n\t\tthis.cameras_controller.camera_node?.post_process_controller.create_renderer(this._canvas, size);\n\t\t// this.canvas_context = canvas.getContext('2d')\n\n\t\t// init renderer\n\t\t// @renderer = new THREE.WebGLRenderer\n\t\t// \tcanvas: canvas\n\t\t// \tantialias: true\n\t\t// \talpha: true\n\n\t\t// @renderer.shadowMap.enabled = true\n\t\t// this.compute_size_and_aspect()\n\n\t\t//\n\t\t// https://stackoverflow.com/questions/31407778/display-scene-at-lower-resolution-in-three-js\n\t\t// TODO: this article mentions that setSize should be called after\n\t\t// @renderer.setSize(this._size[0], this._size[1])\n\t\t// @renderer.setPixelRatio(window.devicePixelRatio)\n\t\t// @renderer.setSize(size[0]*1.5, size[1]*1.5)\n\t\t// canvas.width = \"//{size[0]}px\"\n\t\t// canvas.height = \"//{size[1]}px\"\n\t\t// canvas.style.width = \"//{size[0]}px\"\n\t\t// canvas.style.height = \"//{size[1]}px\"\n\n\t\t// TODO: ensure the renderers get added to a list\n\t\t//if !this.player_mode\n\t\t//\tconsole.log(\"set window.viewer_renderer from Threejs.vue component\")\n\t\t// window.viewer_renderer = @renderer\n\t\t// POLY.renderers_controller.register_renderer(@renderer)\n\n\t\t//this._init_webgl_utils()\n\n\t\t// init scene\n\t\t// @display_scene.background = new THREE.Color(\"//111\")\n\n\t\t//window.display_scene = @display_scene\n\n\t\t// this._init_ray_helper(); // TODO: typescript\n\n\t\t//@cam_animation_helper = new CameraAnimationHelper(@ray_helper, @event_helper)\n\n\t\tthis.cameras_controller.prepare_current_camera();\n\t\t// this._add_helpers_to_scene()\n\n\t\tthis.animate();\n\t}\n\n\tanimate() {\n\t\tif (this.do_render) {\n\t\t\tthis.render();\n\t\t\t// this.update_stats()\n\t\t\t// this._controls?.update(false)\n\n\t\t\t// @_renders_count ?= 0\n\t\t\t// @_renders_count += 1\n\t\t\t// if @_renders_count < 6\n\t\t\tthis._request_animation_frame_id = requestAnimationFrame(this._animate_method);\n\t\t}\n\t}\n\n\tprivate _cancel_animate() {\n\t\tthis.do_render = false;\n\t\tif (this._request_animation_frame_id) {\n\t\t\tcancelAnimationFrame(this._request_animation_frame_id);\n\t\t}\n\t\tif (this._canvas) {\n\t\t\tthis.cameras_controller.camera_node?.post_process_controller.delete_renderer(this._canvas);\n\t\t}\n\t\t// POLY.renderers_controller.deregister_renderer(@renderer)\n\t\t// this.dispose_camera()\n\t}\n\n\trender() {\n\t\tif (this.cameras_controller.camera_node && this._canvas) {\n\t\t\tconst size = this.cameras_controller.size;\n\t\t\tconst aspect = this.cameras_controller.aspect;\n\t\t\tthis.cameras_controller.camera_node.post_process_controller.render(this._canvas, size, aspect);\n\n\t\t\t// TODO: typescript\n\t\t\tthis._controls_controller?.update();\n\n\t\t\t// TODO: typescript\n\t\t\t// if (this._capturer) {\n\t\t\t// \tthis._capturer.perform_capture();\n\t\t\t// }\n\t\t} else {\n\t\t\tconsole.warn('no camera to render with');\n\t\t}\n\t}\n}\n","import {Scene} from 'three/src/scenes/Scene';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\n\n// import {CameraMixin} from './concerns/Camera';\n// import {Capturer} from './concerns/Capturer';\n// import {ContainerClass} from './concerns/ContainerClass';\n// import {Controls} from './concerns/Controls';\n// import {PickerForViewer} from './concerns/Picker';\n\nimport {CamerasController} from './utils/CamerasController';\nimport {ControlsController} from './utils/ControlsController';\nimport {EventsController} from './utils/EventsController';\nimport {WebGLController} from './utils/WebglController';\n\n// class AbstractViewer {}\n\nconst HOVERED_CLASS_NAME = 'hovered';\n\nexport abstract class BaseViewer {\n\tprotected _display_scene: Scene;\n\tprotected _canvas: HTMLCanvasElement | undefined;\n\tprotected _active: boolean = false;\n\n\tget active() {\n\t\treturn this._active;\n\t}\n\tactivate() {\n\t\tthis._active = true;\n\t}\n\tdeactivate() {\n\t\tthis._active = false;\n\t}\n\n\tprotected _cameras_controller: CamerasController | undefined;\n\tget cameras_controller() {\n\t\treturn (this._cameras_controller = this._cameras_controller || new CamerasController(this));\n\t}\n\tprotected _controls_controller: ControlsController | undefined;\n\tget controls_controller() {\n\t\treturn (this._controls_controller = this._controls_controller || new ControlsController(this));\n\t}\n\tprotected _events_controller: EventsController | undefined;\n\tget events_controller() {\n\t\treturn (this._events_controller = this._events_controller || new EventsController(this));\n\t}\n\tprotected _webgl_controller: WebGLController | undefined;\n\tget webgl_controller() {\n\t\treturn (this._webgl_controller = this._webgl_controller || new WebGLController(this));\n\t}\n\n\tconstructor(protected _container: HTMLElement, protected _scene: PolyScene, camera_node: BaseCameraObjNodeType) {\n\t\tthis._display_scene = this._scene.display_scene;\n\t\tthis._init_from_scene(camera_node).then(() => {\n\t\t\tthis._build();\n\t\t});\n\t}\n\tget container() {\n\t\treturn this._container;\n\t}\n\tget scene() {\n\t\treturn this._scene;\n\t}\n\tget canvas() {\n\t\treturn this._canvas;\n\t}\n\n\tprivate async _init_from_scene(camera_node: BaseCameraObjNodeType) {\n\t\tawait this.cameras_controller.set_camera_node(camera_node || this._scene.cameras_controller.master_camera_node);\n\t\t// await this.update_picker_nodes(); // TODO: typescript\n\t}\n\tprotected abstract _build(): void;\n\n\t// html container class\n\treset_container_class() {\n\t\tthis.container.classList.remove(HOVERED_CLASS_NAME);\n\t}\n\tset_container_class_hovered() {\n\t\tthis.container.classList.add(HOVERED_CLASS_NAME);\n\t}\n}\n","// import {Camera} from 'three/src/cameras/Camera';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\nimport {BaseViewer} from '../_Base';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\n\nexport class CamerasController {\n\t// private _is_active: boolean = false;\n\tprivate _camera_node: BaseCameraObjNodeType | null = null;\n\t// private _camera: Camera;\n\n\tprivate _size: Vector2 = new Vector2(100, 100);\n\tprivate _aspect: number = 1;\n\t// private current_camera_controls_node_graph_id: number = null;\n\n\tconstructor(private viewer: BaseViewer) {}\n\n\t// activate() {\n\t// \tthis._is_active = true;\n\t// }\n\tasync set_camera_node(camera_node: BaseCameraObjNodeType) {\n\t\tif (!this._camera_node || camera_node.graph_node_id != this._camera_node.graph_node_id) {\n\t\t\tthis._camera_node = camera_node;\n\t\t\t// this._camera = camera_node.object;\n\t\t\tthis._update_graph_node();\n\t\t\tawait this.viewer.controls_controller.create_controls();\n\t\t}\n\t}\n\tprivate _graph_node: CoreGraphNode | undefined;\n\tprivate _update_graph_node() {\n\t\tif (!this._camera_node) {\n\t\t\treturn;\n\t\t}\n\t\tconst controls_param = this._camera_node.params.get_operator_path('controls');\n\t\tif (!controls_param) {\n\t\t\treturn;\n\t\t}\n\t\tthis._graph_node = this._graph_node || this._create_graph_node();\n\t\tif (!this._graph_node) {\n\t\t\treturn;\n\t\t}\n\t\tthis._graph_node.graph_disconnect_predecessors();\n\t\tthis._graph_node.add_graph_input(controls_param);\n\t}\n\tprivate _create_graph_node() {\n\t\tif (!this._camera_node) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst node = new CoreGraphNode(this._camera_node.scene, 'viewer-controls');\n\t\tnode.add_post_dirty_hook('this.viewer.controls_controller', async () => {\n\t\t\tawait this.viewer.controls_controller.create_controls();\n\t\t});\n\t\treturn node;\n\t}\n\n\tget camera_node() {\n\t\treturn this._camera_node;\n\t}\n\tget size() {\n\t\treturn this._size;\n\t}\n\tget aspect() {\n\t\treturn this._aspect;\n\t}\n\n\ton_resize() {\n\t\tif (!this.viewer.canvas) {\n\t\t\treturn;\n\t\t}\n\t\tthis.compute_size_and_aspect();\n\t\tthis._camera_node?.post_process_controller.set_renderer_size(this.viewer.canvas, this._size);\n\t\tthis.update_camera_aspect();\n\t}\n\tcompute_size_and_aspect() {\n\t\tthis._update_size();\n\t\tthis._camera_node?.scene.uniforms_controller.update_resolution_dependent_uniform_owners(this._size);\n\t\tthis._aspect = this._get_aspect();\n\t}\n\n\tprivate _update_size() {\n\t\tthis._size.x = this.viewer.container.offsetWidth;\n\t\tthis._size.y = this.viewer.container.offsetHeight;\n\t}\n\tprivate _get_aspect(): number {\n\t\treturn this._size.x / this._size.y;\n\t}\n\n\tupdate_camera_aspect() {\n\t\tthis._camera_node?.setup_for_aspect_ratio(this._aspect);\n\t}\n\t// dispose_camera: ->\n\t// \tthis.$emit('before_controls_apply', null)\n\t// \t// if @_controls?\n\t// \t// \t@_controls.dispose()\n\t// \t// camera_graph_node_id ?= this.current_camera_node_graph_id\n\t// \t// camera_node = this.$store.scene.graph().node_from_id(camera_graph_node_id)\n\t// \t// this.current_camera_node.dipose_controls()\n\t// \t//if this.current_camera_node?\n\t// \t//\tthis.current_camera_node.dispose_controls()\n\tasync prepare_current_camera() {\n\t\tif (this._camera_node) {\n\t\t\t// we dispose the controls first, so they can be applied\n\t\t\t// if they were not disposed properly when we closed the viewer\n\t\t\t// but I'm now trying in the destroyed callback\n\t\t\t//this.current_camera_node.dispose_controls()\n\n\t\t\t//this.current_camera_node.apply_controls()\n\t\t\t//this.current_camera_node.prepare_for_viewer(this.aspect())\n\t\t\t// const name = this.current_camera_node.name()\n\t\t\t// const graph_node_id = this._camera_node.graph_node_id\n\t\t\t/*const container = */ await this._camera_node.request_container(); // ensure the camera is cooked\n\t\t\tawait this._update_from_camera_container(); //container, graph_node_id)\n\t\t}\n\t}\n\t// remove_cloned_camera: ->\n\t// \tif @_current_camera?\n\t// \t\t@_current_camera.camera_source.node.remove_clone(@_current_camera)\n\n\tasync _update_from_camera_container() {\n\t\t//container, graph_node_id:number){\n\t\t// ensure that we get the same as we requested\n\t\t// if(graph_node_id == this._camera_node.graph_node_id){\n\n\t\t// this.remove_cloned_camera()\n\t\t// cloned_camera = this.current_camera_node.clone_camera()\n\t\t// @_current_camera = cloned_camera\n\t\tthis.update_camera_aspect();\n\n\t\t//this.dispose_camera()\n\n\t\t// @_is_active is use to check if the component has been destroyed\n\t\t// which can happen on app load, but also when user switches the camera menu\n\n\t\t// if this.current_camera_controls_node_graph_id == null || ()\n\n\t\t// if(@_is_active == true)\n\t\tawait this.viewer.controls_controller.create_controls();\n\n\t\t// }\n\t}\n}\n","import {BaseViewer} from '../_Base';\nimport {CameraControls} from 'src/engine/nodes/event/_BaseCameraControls';\n\nexport class ControlsController {\n\tprotected _active: boolean = false;\n\tprotected _controls: CameraControls | null = null;\n\t_bound_on_controls_start: () => void = this._on_controls_start.bind(this);\n\t_bound_on_controls_end: () => void = this._on_controls_end.bind(this);\n\tconstructor(private viewer: BaseViewer) {}\n\n\tget active() {\n\t\treturn this._active;\n\t}\n\tget camera_node() {\n\t\treturn this.viewer.cameras_controller.camera_node;\n\t}\n\tget controls() {\n\t\treturn this._controls;\n\t}\n\n\tasync create_controls() {\n\t\tthis.dispose_controls();\n\n\t\tif (!this.viewer.canvas) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst config = await this.camera_node?.controls_controller.apply_controls(this.viewer.canvas);\n\t\tif (config) {\n\t\t\t// this.current_camera_controls_node_graph_id = config.camera_controls_node_id()\n\t\t\tthis._controls = config.controls;\n\t\t\t// this._controls_node = config.controls_node()\n\n\t\t\tif (this._controls) {\n\t\t\t\tif (this.viewer.active) {\n\t\t\t\t\tthis._controls.addEventListener('start', this._bound_on_controls_start);\n\t\t\t\t\tthis._controls.addEventListener('end', this._bound_on_controls_end);\n\t\t\t\t} else {\n\t\t\t\t\tthis.dispose_controls();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// test in case @_is_active has changed\n\t\t\t// if (this._is_active != true && this._controls){\n\t\t\t// \tthis._dispose_controls()\n\n\t\t\t// }\n\t\t\t// TODO\n\t\t\t// we have to reassign the camera here, as this method is called twice\n\t\t\t// and the first time without the controls being present apparently.. (more tests needed)\n\t\t\t// CURRENT ANSWER: the method this.prepare_current_camera() is called twice on app load\n\t\t\t// which only cause problems when switching back to perspective.\n\t\t\t// @_current_camera = cloned_camera\n\t\t\t//@_controls = controls\n\t\t\t// this.$emit('before_controls_apply', controls)\n\t\t}\n\t}\n\tupdate() {\n\t\tif (this._controls) {\n\t\t\tthis._controls.update();\n\t\t}\n\t}\n\n\tdispose_controls() {\n\t\tif (this._controls) {\n\t\t\tif (this.viewer.canvas) {\n\t\t\t\tthis.camera_node?.controls_controller.dispose_controls(this.viewer.canvas);\n\t\t\t}\n\n\t\t\tif (this._bound_on_controls_start) {\n\t\t\t\tthis._controls.removeEventListener('start', this._bound_on_controls_start);\n\t\t\t}\n\t\t\tif (this._bound_on_controls_end) {\n\t\t\t\tthis._controls.removeEventListener('end', this._bound_on_controls_end);\n\t\t\t}\n\n\t\t\tthis._controls.dispose();\n\t\t\tthis._controls = null;\n\t\t}\n\t}\n\tprivate _on_controls_start() {\n\t\tthis._active = true;\n\t}\n\tprivate _on_controls_end() {\n\t\tthis._active = false;\n\t}\n}\n","import {BaseViewer} from '../_Base';\nimport {Vector2} from 'three/src/math/Vector2';\n\nconst DIST_UNINITIALIZED = -1;\ntype MouseOrTouchEvent = MouseEvent | TouchEvent;\ntype MouseOrTouchEventCallback = (e: MouseOrTouchEvent) => void;\n\nexport class EventsController {\n\tprivate _mousedown_pos = new Vector2();\n\tprivate _mouse_distance_travelled: number = DIST_UNINITIALIZED;\n\tprotected _bound_on_mousedown: MouseOrTouchEventCallback = this._on_mousedown.bind(this);\n\tprotected _bound_on_mousemove: MouseOrTouchEventCallback = this._on_mousemove.bind(this);\n\tprotected _bound_on_mouseup: MouseOrTouchEventCallback = this._on_mouseup.bind(this);\n\t// protected _bound_on_click: MouseEventCallback\n\n\tconstructor(protected viewer: BaseViewer) {}\n\n\tget camera_node() {\n\t\treturn this.viewer.cameras_controller.camera_node;\n\t}\n\tget canvas() {\n\t\treturn this.viewer.canvas;\n\t}\n\n\tinit() {\n\t\tif (!this.canvas) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._bound_on_mousedown) {\n\t\t\tthis.canvas.removeEventListener('mousedown', this._bound_on_mousedown);\n\t\t}\n\t\tif (this._bound_on_mousemove) {\n\t\t\tthis.canvas.removeEventListener('mousemove', this._bound_on_mousemove);\n\t\t}\n\t\tif (this._bound_on_mouseup) {\n\t\t\tthis.canvas.removeEventListener('mouseup', this._bound_on_mouseup);\n\t\t}\n\t\tthis._bound_on_mousedown = this._bound_on_mousedown || this._on_mousedown.bind(this);\n\t\tthis._bound_on_mousemove = this._bound_on_mousemove || this._on_mousemove.bind(this);\n\t\tthis._bound_on_mouseup = this._bound_on_mouseup || this._on_mouseup.bind(this);\n\n\t\tthis.canvas.addEventListener('mousedown', this._bound_on_mousedown);\n\t\tthis.canvas.addEventListener('mousemove', this._bound_on_mousemove);\n\t\tthis.canvas.addEventListener('mouseup', this._bound_on_mouseup);\n\n\t\t// this._bound_on_touchmove = this._bound_on_touchmove || this._on_touchmove.bind(this)\n\t\tthis.canvas.addEventListener('touchstart', this._bound_on_mousedown, false);\n\t\tthis.canvas.addEventListener('touchmove', this._bound_on_mousemove, false);\n\t\tthis.canvas.addEventListener('touchend', this._bound_on_mouseup, false);\n\t\tthis.canvas.addEventListener('touchcancel', this._bound_on_mouseup, false);\n\t}\n\n\tprotected _on_mousedown(event: MouseOrTouchEvent) {\n\t\tthis._mouse_distance_travelled = 0;\n\t\tif (event instanceof MouseEvent) {\n\t\t\tthis._mousedown_pos.x = event.pageX;\n\t\t\tthis._mousedown_pos.y = event.pageY;\n\t\t} else {\n\t\t\tconst touch = event.touches[0];\n\t\t\tthis._mousedown_pos.x = touch.pageX;\n\t\t\tthis._mousedown_pos.y = touch.pageY;\n\t\t}\n\t}\n\n\tprotected _on_mousemove(event: MouseOrTouchEvent) {\n\t\tif (this._mouse_distance_travelled !== DIST_UNINITIALIZED) {\n\t\t\tlet distance: number = 0;\n\t\t\tif (event instanceof MouseEvent) {\n\t\t\t\tdistance = event.pageX - this._mousedown_pos.x + (event.pageY - this._mousedown_pos.y);\n\t\t\t} else {\n\t\t\t\tconst touch = event.touches[0];\n\t\t\t\tdistance = touch.pageX - this._mousedown_pos.x + (touch.pageY - this._mousedown_pos.y);\n\t\t\t}\n\t\t\tthis._mouse_distance_travelled += Math.abs(distance);\n\t\t}\n\n\t\tif (!this.viewer.controls_controller.active) {\n\t\t\t// this.viewer.process_picker_nodes_on_mouse_move(event, this.camera_node, this.ray_helper);\n\t\t}\n\t}\n\n\tprotected _on_mouseup(event: MouseOrTouchEvent) {\n\t\tif (this._mouse_distance_travelled < 2) {\n\t\t\t// this.viewer.process_picker_nodes_on_click(event, this.camera_node, this.ray_helper);\n\t\t}\n\t\tthis._mouse_distance_travelled = DIST_UNINITIALIZED;\n\t}\n}\n","import {BaseViewer} from '../_Base';\n\nexport class WebGLController {\n\tpublic request_animation_frame_id: number | undefined;\n\n\tconstructor(protected viewer: BaseViewer) {}\n\n\tinit() {\n\t\tconst canvas = this.viewer.canvas;\n\t\tif (canvas) {\n\t\t\tcanvas.onwebglcontextlost = this._on_webglcontextlost.bind(this);\n\t\t\tcanvas.onwebglcontextrestored = this._on_webglcontextrestored.bind(this);\n\t\t}\n\t}\n\n\tprotected _on_webglcontextlost() {\n\t\tconsole.warn('context lost at frame', this.viewer.scene.frame);\n\t\t// event.preventDefault();\n\t\tif (this.request_animation_frame_id) {\n\t\t\tcancelAnimationFrame(this.request_animation_frame_id);\n\t\t} else {\n\t\t\tconsole.warn('request_animation_frame_id not initialized');\n\t\t}\n\t\tconsole.warn('not canceled', this.request_animation_frame_id);\n\t}\n\tprotected _on_webglcontextrestored() {\n\t\tconsole.log('context restored');\n\t}\n}\n","import {BaseBackgroundController} from './_BaseController';\n\nimport lodash_isNaN from 'lodash/isNaN';\n\nexport class OrthographicCameraBackgroundController extends BaseBackgroundController {\n\tprotected update_screen_quad() {\n\t\tconst quad = this.screen_quad;\n\n\t\tlet width = this.node.params.float('size');\n\t\tlet height = width;\n\n\t\tconst far = this.node.params.float('far');\n\t\tif (far && !lodash_isNaN(width) && !lodash_isNaN(height)) {\n\t\t\tquad.scale.x = width;\n\t\t\tquad.scale.y = height;\n\t\t\tquad.position.z = -0.9999 * far; //.copy(this._bg_center)\n\t\t}\n\t}\n}\n","// import lodash_clamp from 'lodash/clamp';\n// import {Vector2} from 'three/src/math/Vector2';\nimport {PerspectiveCamera} from 'three/src/cameras/PerspectiveCamera';\nimport {TypedCameraObjNode, BASE_CAMERA_DEFAULT, CameraTransformParamConfig} from './_BaseCamera';\nimport {PerspectiveCameraBackgroundController} from './utils/cameras/background/PerspectiveCameraController';\n// import {NodeParamsConfig} from '../utils/params/ParamsConfig';\n\nconst DEFAULT = {\n\tfov: 50,\n};\n\n// const EVENT_CHANGE = { type: 'change' };\nimport {ParamConfig, NodeParamsConfig} from '../utils/params/ParamsConfig';\nimport {CameraPostProcessParamConfig} from './utils/cameras/PostProcessController';\nimport {CameraBackgroundParamConfig} from './utils/cameras/background/_BaseController';\nimport {LayerParamConfig} from './utils/LayersController';\nimport {TransformedParamConfig} from './utils/TransformController';\nexport function PerspectiveCameraObjParamConfigMixin<TBase extends Constructor>(Base: TBase) {\n\treturn class Mixin extends Base {\n\t\tfov = ParamConfig.FLOAT(DEFAULT.fov, {range: [0, 100]});\n\t\t// vertical_fov_range = ParamConfig.VECTOR2([0, 100], {visible_if: {lock_width: 1}});\n\t\t// horizontal_fov_range = ParamConfig.VECTOR2([0, 100], {visible_if: {lock_width: 0}});\n\t};\n}\nclass PerspectiveCameraObjParamConfig extends CameraPostProcessParamConfig(\n\tCameraBackgroundParamConfig(\n\t\tTransformedParamConfig(\n\t\t\tLayerParamConfig(PerspectiveCameraObjParamConfigMixin(CameraTransformParamConfig(NodeParamsConfig)))\n\t\t)\n\t)\n) {}\nconst ParamsConfig = new PerspectiveCameraObjParamConfig();\n\nexport class PerspectiveCameraObjNode extends TypedCameraObjNode<PerspectiveCamera, PerspectiveCameraObjParamConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'perspective_camera';\n\t}\n\n\tprotected get background_controller_constructor() {\n\t\treturn PerspectiveCameraBackgroundController;\n\t}\n\n\tcreate_object() {\n\t\treturn new PerspectiveCamera(DEFAULT.fov, 1, BASE_CAMERA_DEFAULT.near, BASE_CAMERA_DEFAULT.far);\n\t}\n\n\t// create_params() {\n\t// \t// this.create_common_params();\n\t// \t// this.within_param_folder('render', () => {\n\t// \t// this.add_param(ParamType.FLOAT, 'fov', DEFAULT.fov, {\n\t// \t// \trange: [0, 180],\n\t// \t// \trange_locked: [true, true],\n\t// \t// });\n\t// \t// this.add_param(ParamType.VECTOR2, 'vertical_fov_range', [0, 100], {visible_if: {lock_width: 1}});\n\t// \t// this.add_param(ParamType.VECTOR2, 'horizontal_fov_range', [0, 100], {visible_if: {lock_width: 0}});\n\t// \t// this.create_player_camera_params();\n\t// \t// });\n\t// }\n\n\tupdate_camera() {\n\t\tif (this._object.fov != this.pv.fov) {\n\t\t\tthis._object.fov = this.pv.fov;\n\t\t\tthis._object.updateProjectionMatrix();\n\t\t}\n\t\tthis._update_for_aspect_ratio();\n\t}\n\n\tprotected _update_for_aspect_ratio() {\n\t\tif (this._aspect) {\n\t\t\t// let lock_width = true;//this.pv.lock_width;\n\n\t\t\tthis._object.aspect = this._aspect;\n\t\t\t// if (lock_width) {\n\t\t\t// \tconst other_fov = this.pv.fov / this._aspect;\n\t\t\t// \tthis._object.zoom = this.get_zoom(this._aspect, other_fov, this.pv.vertical_fov_range);\n\t\t\t// } else {\n\t\t\t// \tthis._object.zoom = 1;\n\t\t\t// }\n\t\t\tthis._object.updateProjectionMatrix();\n\t\t}\n\t}\n\t// private get_zoom(start_zoom: number, other_fov: number, range: Vector2) {\n\t// \tlet zoom = start_zoom;\n\t// \tif (range) {\n\t// \t\tif (other_fov < range.x || other_fov > range.y) {\n\t// \t\t\tconst new_other_fov = lodash_clamp(other_fov, range.x, range.y);\n\t// \t\t\tzoom = start_zoom * (other_fov / new_other_fov);\n\t// \t\t\t// zoom = Math.min(start_zoom, zoom)\n\t// \t\t}\n\t// \t}\n\t// \treturn zoom;\n\t// }\n}\n","import {BaseBackgroundController} from './_BaseController';\n\nimport {Vector3} from 'three/src/math/Vector3';\nimport lodash_isNaN from 'lodash/isNaN';\nimport lodash_sum from 'lodash/sum';\n// import { Vector2 } from 'three';\n\n// enum CornerNames {\n// \tbl = 'bl',\n// \tbr = 'br',\n// \ttl = 'tl',\n// \ttr = 'tr',\n// }\ninterface Corners2D {\n\tbl: Vector2Like;\n\tbr: Vector2Like;\n\ttl: Vector2Like;\n\ttr: Vector2Like;\n}\ninterface Corners3D {\n\tbl: Vector3;\n\tbr: Vector3;\n\ttl: Vector3;\n\ttr: Vector3;\n}\nconst SCREEN_COORD: Corners2D = {\n\tbl: {x: -1, y: -1},\n\tbr: {x: +1, y: -1},\n\ttl: {x: -1, y: +1},\n\ttr: {x: +1, y: +1},\n};\nconst CORNER_NAMES: Array<keyof Corners3D> = ['bl', 'br', 'tl', 'tr'];\n\nexport class PerspectiveCameraBackgroundController extends BaseBackgroundController {\n\tprivate _bg_corner: Corners3D = {\n\t\tbl: new Vector3(),\n\t\tbr: new Vector3(),\n\t\ttl: new Vector3(),\n\t\ttr: new Vector3(),\n\t};\n\tprivate _bg_center = new Vector3();\n\n\tprotected update_screen_quad() {\n\t\tconst quad = this.screen_quad;\n\n\t\tfor (let corner_name of CORNER_NAMES) {\n\t\t\tthis._update_corner_vector(this._bg_corner[corner_name], SCREEN_COORD[corner_name]);\n\t\t}\n\t\tlet width = this._bg_corner.bl.distanceTo(this._bg_corner.br);\n\t\tlet height = this._bg_corner.bl.distanceTo(this._bg_corner.tl);\n\n\t\tthis._bg_center.x = lodash_sum(CORNER_NAMES.map((name) => this._bg_corner[name].x)) / 4;\n\t\tthis._bg_center.y = lodash_sum(CORNER_NAMES.map((name) => this._bg_corner[name].y)) / 4;\n\t\tthis._bg_center.z = lodash_sum(CORNER_NAMES.map((name) => this._bg_corner[name].z)) / 4;\n\n\t\tconst far = this.node.params.float('far');\n\t\tconst background_ratio = this.node.params.float('background_ratio');\n\t\tif (far && !lodash_isNaN(width) && !lodash_isNaN(height)) {\n\t\t\tconst z = this._bg_center.distanceTo(this.node.object.position);\n\t\t\tconst z_ratio = far / z;\n\t\t\tconst desired_ratio = background_ratio || 1;\n\n\t\t\tif (width > height) {\n\t\t\t\theight = width / desired_ratio;\n\t\t\t} else {\n\t\t\t\theight = width * desired_ratio;\n\t\t\t}\n\n\t\t\tquad.scale.x = width * z_ratio;\n\t\t\tquad.scale.y = height * z_ratio;\n\t\t\tquad.position.z = -0.9999 * far; //.copy(this._bg_center)\n\t\t}\n\t}\n\t_update_corner_vector(vector: Vector3, coord: Vector2Like) {\n\t\tthis._bg_raycaster.setFromCamera(coord, this.node.object);\n\t\tvector\n\t\t\t.copy(this._bg_raycaster.ray.direction)\n\t\t\t.multiplyScalar(this.node.params.float('far'))\n\t\t\t.add(this._bg_raycaster.ray.origin);\n\t}\n}\n","import {CATEGORY_SOP} from './Category';\n\nimport {AddSopNode} from 'src/engine/nodes/sop/Add';\nimport {AnimationCopySopNode} from 'src/engine/nodes/sop/AnimationCopy';\nimport {AnimationMixerSopNode} from 'src/engine/nodes/sop/AnimationMixer';\nimport {AttribAddMultSopNode} from 'src/engine/nodes/sop/AttribAddMult';\nimport {AttribCopySopNode} from 'src/engine/nodes/sop/AttribCopy';\nimport {AttribCreateSopNode} from 'src/engine/nodes/sop/AttribCreate';\nimport {AttribDeleteSopNode} from 'src/engine/nodes/sop/AttribDelete';\nimport {AttribNormalizeSopNode} from 'src/engine/nodes/sop/AttribNormalize';\nimport {AttribPromoteSopNode} from 'src/engine/nodes/sop/AttribPromote';\nimport {AttribRemapSopNode} from 'src/engine/nodes/sop/AttribRemap';\nimport {AttribRenameSopNode} from 'src/engine/nodes/sop/AttribRename';\nimport {AttribTransferSopNode} from 'src/engine/nodes/sop/AttribTransfer';\nimport {BboxScatterSopNode} from 'src/engine/nodes/sop/BboxScatter';\nimport {BlendSopNode} from 'src/engine/nodes/sop/Blend';\nimport {BoxSopNode} from 'src/engine/nodes/sop/Box';\nimport {CacheSopNode} from 'src/engine/nodes/sop/Cache';\nimport {CircleSopNode} from 'src/engine/nodes/sop/Circle';\nimport {ColorSopNode} from 'src/engine/nodes/sop/Color';\nimport {CopySopNode} from 'src/engine/nodes/sop/Copy';\nimport {DataSopNode} from 'src/engine/nodes/sop/Data';\nimport {DataUrlSopNode} from 'src/engine/nodes/sop/DataUrl';\nimport {DelaySopNode} from 'src/engine/nodes/sop/Delay';\nimport {DeleteSopNode} from 'src/engine/nodes/sop/Delete';\nimport {FaceSopNode} from 'src/engine/nodes/sop/Face';\nimport {FileSopNode} from 'src/engine/nodes/sop/File';\nimport {FuseSopNode} from 'src/engine/nodes/sop/Fuse';\nimport {HexagonsSopNode} from 'src/engine/nodes/sop/Hexagons';\nimport {HierarchySopNode} from 'src/engine/nodes/sop/Hierarchy';\n// TODO: heightmap\n// TODO: particles\nimport {JitterSopNode} from 'src/engine/nodes/sop/Jitter';\nimport {LayerSopNode} from 'src/engine/nodes/sop/Layer';\nimport {LineSopNode} from 'src/engine/nodes/sop/Line';\nimport {MaterialSopNode} from 'src/engine/nodes/sop/Material';\nimport {MergeSopNode} from 'src/engine/nodes/sop/Merge';\nimport {NoiseSopNode} from 'src/engine/nodes/sop/Noise';\nimport {NormalsSopNode} from 'src/engine/nodes/sop/Normals';\nimport {NullSopNode} from 'src/engine/nodes/sop/Null';\nimport {ObjectMergeSopNode} from 'src/engine/nodes/sop/ObjectMerge';\nimport {OcclusionSopNode} from 'src/engine/nodes/sop/Occlusion';\nimport {PeakSopNode} from 'src/engine/nodes/sop/Peak';\nimport {PlaneSopNode} from 'src/engine/nodes/sop/Plane';\nimport {PointSopNode} from 'src/engine/nodes/sop/Point';\nimport {PolywireSopNode} from 'src/engine/nodes/sop/Polywire';\nimport {RaySopNode} from 'src/engine/nodes/sop/Ray';\nimport {ResampleSopNode} from 'src/engine/nodes/sop/Resample';\nimport {ScatterSopNode} from 'src/engine/nodes/sop/Scatter';\nimport {ShadowsSopNode} from 'src/engine/nodes/sop/Shadows';\nimport {SkinSopNode} from 'src/engine/nodes/sop/Skin';\nimport {SphereSopNode} from 'src/engine/nodes/sop/Sphere';\nimport {SwitchSopNode} from 'src/engine/nodes/sop/Switch';\nimport {TextSopNode} from 'src/engine/nodes/sop/Text';\nimport {TorusSopNode} from 'src/engine/nodes/sop/Torus';\nimport {TorusKnotSopNode} from 'src/engine/nodes/sop/TorusKnot';\nimport {TransformSopNode} from 'src/engine/nodes/sop/Transform';\nimport {TubeSopNode} from 'src/engine/nodes/sop/Tube';\nimport {UvProjectSopNode} from 'src/engine/nodes/sop/UvProject';\n\nexport interface GeoNodeChildrenMap {\n\tadd: AddSopNode;\n\tanimation_copy: AnimationCopySopNode;\n\tanimation_mixer: AnimationMixerSopNode;\n\tattrib_add_mult: AttribAddMultSopNode;\n\tattrib_copy: AttribCopySopNode;\n\tattrib_create: AttribCreateSopNode;\n\tattrib_delete: AttribDeleteSopNode;\n\tattrib_normalize: AttribNormalizeSopNode;\n\tattrib_promote: AttribPromoteSopNode;\n\tattrib_remap: AttribRemapSopNode;\n\tattrib_rename: AttribRenameSopNode;\n\tattrib_transfer: AttribTransferSopNode;\n\tbbox_scatter: BboxScatterSopNode;\n\tblend: BlendSopNode;\n\tbox: BoxSopNode;\n\tcache: CacheSopNode;\n\tcircle: CircleSopNode;\n\tcolor: ColorSopNode;\n\tcopy: CopySopNode;\n\tdata: DataSopNode;\n\tdata_url: DataUrlSopNode;\n\tdelay: DelaySopNode;\n\tdelete: DeleteSopNode;\n\tface: FaceSopNode;\n\tfile: FileSopNode;\n\tfuse: FuseSopNode;\n\thexagons: HexagonsSopNode;\n\thierarchy: HierarchySopNode;\n\tjitter: JitterSopNode;\n\tlayer: LayerSopNode;\n\tline: LineSopNode;\n\tmaterial: MaterialSopNode;\n\tmerge: MergeSopNode;\n\tnoise: NoiseSopNode;\n\tnormals: NormalsSopNode;\n\tnull: NullSopNode;\n\tobject_merge: ObjectMergeSopNode;\n\tocclusion: OcclusionSopNode;\n\tpeak: PeakSopNode;\n\tplane: PlaneSopNode;\n\tpoint: PointSopNode;\n\tpolywire: PolywireSopNode;\n\tray: RaySopNode;\n\tresample: ResampleSopNode;\n\tscatter: ScatterSopNode;\n\tshadows: ShadowsSopNode;\n\tskin: SkinSopNode;\n\tsphere: SphereSopNode;\n\tswitch: SwitchSopNode;\n\ttext: TextSopNode;\n\ttorus: TorusSopNode;\n\ttorus_knot: TorusKnotSopNode;\n\ttransform: TransformSopNode;\n\ttube: TubeSopNode;\n\tuv_project: UvProjectSopNode;\n}\n\nimport {Poly} from 'src/engine/Poly';\nexport class SopRegister {\n\tstatic run(poly: Poly) {\n\t\tpoly.register_node(AddSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(AnimationCopySopNode, CATEGORY_SOP.ANIMATION);\n\t\tpoly.register_node(AnimationMixerSopNode, CATEGORY_SOP.ANIMATION);\n\t\tpoly.register_node(AttribAddMultSopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(AttribCopySopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(AttribCreateSopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(AttribDeleteSopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(AttribNormalizeSopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(AttribPromoteSopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(AttribRemapSopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(AttribRenameSopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(AttribTransferSopNode, CATEGORY_SOP.ATTRIBUTE);\n\t\tpoly.register_node(BboxScatterSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(BlendSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(BoxSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(CacheSopNode, CATEGORY_SOP.MISC);\n\t\tpoly.register_node(CircleSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(ColorSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(CopySopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(DataSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(DataUrlSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(DelaySopNode, CATEGORY_SOP.MISC);\n\t\tpoly.register_node(DeleteSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(FaceSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(FileSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(FuseSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(HexagonsSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(HierarchySopNode, CATEGORY_SOP.MISC);\n\t\tpoly.register_node(JitterSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(LayerSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(LineSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(MaterialSopNode, CATEGORY_SOP.RENDER);\n\t\tpoly.register_node(MergeSopNode, CATEGORY_SOP.MISC);\n\t\tpoly.register_node(NoiseSopNode, CATEGORY_SOP.MISC);\n\t\tpoly.register_node(NormalsSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(NullSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(ObjectMergeSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(OcclusionSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(PeakSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(PlaneSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(PointSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(PolywireSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(RaySopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(ResampleSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(ScatterSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(SkinSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(ShadowsSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(SphereSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(SwitchSopNode, CATEGORY_SOP.MISC);\n\t\tpoly.register_node(TextSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(TorusSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(TorusKnotSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(TransformSopNode, CATEGORY_SOP.MODIFIER);\n\t\tpoly.register_node(TubeSopNode, CATEGORY_SOP.INPUT);\n\t\tpoly.register_node(UvProjectSopNode, CATEGORY_SOP.MODIFIER);\n\t}\n}\n","// import lodash_flatten from 'lodash/flatten';\n// import lodash_last from 'lodash/last';\nimport lodash_times from 'lodash/times';\nimport {Object3D} from 'three/src/core/Object3D';\n// import {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {TypedSopNode} from './_Base';\n// import {Core} from 'src/Core/_Module';\nimport {CoreConstant} from 'src/core/geometry/Constant';\nimport {CoreGroup} from 'src/core/geometry/Group';\n// import {CoreGeometryUtilShape} from 'src/core/geometry/util/Shape';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass AddSopParamsConfig extends NodeParamsConfig {\n\tcreate_point = ParamConfig.BOOLEAN(1);\n\tpoints_count = ParamConfig.INTEGER(1, {\n\t\trange: [1, 100],\n\t\trange_locked: [true, false],\n\t\tvisible_if: {create_point: true},\n\t});\n\tposition = ParamConfig.VECTOR3([0, 0, 0], {visible_if: {create_point: true}});\n\t// create_polygon = ParamConfig.BOOLEAN(0);\n\topen = ParamConfig.BOOLEAN(0);\n\tconnect_to_last_point = ParamConfig.BOOLEAN(0);\n}\nconst ParamsConfig = new AddSopParamsConfig();\n\nexport class AddSopNode extends TypedSopNode<AddSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'add';\n\t}\n\t_objects: Object3D[] | undefined;\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to create polygons from (optional)'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(0, 1);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tthis._objects = [];\n\t\tthis._create_point();\n\t\t// if (this.pv.create_polygon) {\n\t\t// \tthis._create_polygon(input_contents[0]);\n\t\t// }\n\n\t\tthis.set_objects(this._objects);\n\t}\n\n\tprivate _create_point() {\n\t\tif (this.pv.create_point) {\n\t\t\tconst geometry = new BufferGeometry();\n\t\t\tconst positions: number[] = [];\n\t\t\tlodash_times(this.pv.points_count, (i) => {\n\t\t\t\tthis.pv.position.toArray(positions, i * 3);\n\t\t\t});\n\t\t\tgeometry.setAttribute('position', new BufferAttribute(new Float32Array(positions), 3));\n\t\t\tconst object = this.create_object(geometry, CoreConstant.OBJECT_TYPE.POINTS);\n\n\t\t\tif (this._objects) {\n\t\t\t\tthis._objects.push(object);\n\t\t\t}\n\t\t}\n\t}\n\n\t// private _create_polygon(core_group: CoreGroup) {\n\t// \tconst points = core_group.points();\n\t// \tconst is_polygon_closed = !this.pv.open && points.length >= 3;\n\t// \tif (points.length > 0) {\n\t// \t\tif (is_polygon_closed) {\n\t// \t\t\tthis._create_polygon_closed(core_group);\n\t// \t\t} else {\n\t// \t\t\tthis._create_polygon_open(core_group);\n\t// \t\t}\n\t// \t}\n\t// }\n\n\t// _create_polygon_closed(core_group: CoreGroup) {\n\t// \tconst points = core_group.points();\n\n\t// \tconst geometry = CoreGeometryUtilShape.geometry_from_points(points);\n\t// \tconst object = this.create_object(geometry);\n\t// \tthis._objects.push(object);\n\t// }\n\n\t// _create_polygon_open(core_group:CoreGroup) {\n\t// \tconst points = core_group.points();\n\n\t// \tlet positions:number[][] = [];\n\t// \tconst indices:number[] = [];\n\t// \tpoints.forEach((point, i) => {\n\t// \t\tpoint.position().toArray(positions, i * 3);\n\t// \t\t// positions.push(point.position().toArray());\n\n\t// \t\tif (i > 0) {\n\t// \t\t\tindices.push(i - 1);\n\t// \t\t\tindices.push(i);\n\t// \t\t}\n\t// \t});\n\n\t// \tif (points.length > 2 && this.pv.connect_to_last_point) {\n\t// \t\tpositions.push(points[0].position().toArray());\n\t// \t\tindices.push(lodash_last(indices));\n\t// \t\tindices.push(0);\n\t// \t}\n\n\t// \tpositions = lodash_flatten(positions);\n\t// \tconst geometry = new BufferGeometry();\n\t// \tgeometry.setAttribute('position', new Float32BufferAttribute(positions, 3));\n\t// \tgeometry.setIndex(indices);\n\t// \tconst object = this.create_object(geometry, CoreConstant.OBJECT_TYPE.LINE_SEGMENTS);\n\t// \tthis._objects.push(object);\n\t// }\n}\n","import lodash_sum from 'lodash/sum';\n\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Triangle} from 'three/src/math/Triangle';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\n// const THREE = {BufferGeometry, Triangle, Vector2, Vector3}\nimport {CorePoint} from './Point';\nimport {CoreGeometry} from './Geometry';\nimport {CoreMath} from 'src/core/math/_Module';\n// import {CoreInterpolate} from 'src/core/Math/Interpolate'\n\ninterface FaceLike {\n\ta: number;\n\tb: number;\n\tc: number;\n}\n\ntype CorePointArray3 = [CorePoint, CorePoint, CorePoint];\ntype Vector3Array2 = [Vector3, Vector3];\ntype Vector3Array3 = [Vector3, Vector3, Vector3];\n\nexport class CoreFace {\n\t_geometry: BufferGeometry;\n\t_points: CorePointArray3 | undefined;\n\t_triangle: Triangle | undefined;\n\t_positions: Vector3Array3 | undefined;\n\t_deltas: Vector3Array2 | undefined;\n\n\tconstructor(private _core_geometry: CoreGeometry, private _index: number) {\n\t\tthis._geometry = this._core_geometry.geometry();\n\t}\n\tget index() {\n\t\treturn this._index;\n\t}\n\tget points() {\n\t\treturn (this._points = this._points || this._get_points());\n\t}\n\tprivate _get_points(): CorePointArray3 {\n\t\tconst index_array = this._geometry.index?.array || [];\n\t\tconst start = this._index * 3;\n\t\treturn [\n\t\t\tnew CorePoint(this._core_geometry, index_array[start + 0]),\n\t\t\tnew CorePoint(this._core_geometry, index_array[start + 1]),\n\t\t\tnew CorePoint(this._core_geometry, index_array[start + 2]),\n\t\t];\n\t}\n\tget positions() {\n\t\treturn (this._positions = this._positions || this._get_positions());\n\t}\n\tprivate _get_positions(): Vector3Array3 {\n\t\tconst points = this.points;\n\t\treturn [points[0].position(), points[1].position(), points[2].position()];\n\t}\n\tget triangle() {\n\t\treturn (this._triangle = this._triangle || this._get_triangle());\n\t}\n\tprivate _get_triangle(): Triangle {\n\t\tconst positions = this.positions;\n\t\treturn new Triangle(positions[0], positions[1], positions[2]);\n\t}\n\tget deltas() {\n\t\treturn (this._deltas = this._deltas || this._get_deltas());\n\t}\n\tprivate _get_deltas(): Vector3Array2 {\n\t\treturn [this.positions[1].clone().sub(this.positions[0]), this.positions[2].clone().sub(this.positions[0])];\n\t}\n\n\tget area(): number {\n\t\treturn this.triangle.getArea();\n\t}\n\tcenter(target: Vector3) {\n\t\tconst positions = this.positions;\n\t\ttarget.x = (positions[0].x + positions[1].x + positions[2].x) / 3;\n\t\ttarget.y = (positions[0].y + positions[1].y + positions[2].y) / 3;\n\t\ttarget.z = (positions[0].z + positions[1].z + positions[2].z) / 3;\n\n\t\treturn target;\n\t}\n\n\trandom_position(seed: number) {\n\t\tlet weights = [CoreMath.rand_float(seed), CoreMath.rand_float(seed * 6541)];\n\n\t\tif (weights[0] + weights[1] > 1) {\n\t\t\tweights[0] = 1 - weights[0];\n\t\t\tweights[1] = 1 - weights[1];\n\t\t}\n\n\t\treturn this.positions[0]\n\t\t\t.clone()\n\t\t\t.add(this.deltas[0].clone().multiplyScalar(weights[0]))\n\t\t\t.add(this.deltas[1].clone().multiplyScalar(weights[1]));\n\t}\n\t// random_position(seed: number){\n\t// \tlet weights = [\n\t// \t\tCoreMath.rand_float(seed),\n\t// \t\tCoreMath.rand_float(seed*524),\n\t// \t\tCoreMath.rand_float(seed*4631)\n\t// \t]\n\t// \tconst sum = lodash_sum(weights)\n\t// \tweights = weights.map(w=>w/sum)\n\t// \tconst pos = new Vector3()\n\t// \tlet positions = this.positions().map((p,i)=> p.multiplyScalar(weights[i]))\n\t// \tpositions.forEach(p=>{\n\t// \t\tpos.add(p)\n\t// \t})\n\t// \treturn pos\n\t// }\n\n\tattrib_value_at_position(attrib_name: string, position: Vector3) {\n\t\t// const weights = CoreInterpolate._weights_from_3(position, this._positions)\n\t\tconst barycentric_coordinates = new Vector3();\n\t\tthis.triangle.getBarycoord(position, barycentric_coordinates);\n\t\tconst weights = barycentric_coordinates.toArray();\n\n\t\tconst attrib = this._geometry.attributes[attrib_name];\n\t\tconst attrib_size = attrib.itemSize;\n\t\tconst point_values = this.points.map((point) => point.attrib_value(attrib_name));\n\n\t\tlet new_attrib_value;\n\t\tlet sum;\n\t\tlet index = 0;\n\t\tswitch (attrib_size) {\n\t\t\tcase 1: {\n\t\t\t\tsum = 0;\n\t\t\t\tfor (let point_value of point_values) {\n\t\t\t\t\tsum += point_value * weights[index];\n\t\t\t\t\tindex++;\n\t\t\t\t}\n\t\t\t\tnew_attrib_value = sum;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\tfor (let point_value of point_values) {\n\t\t\t\t\tconst weighted_value = point_value.multiplyScalar(weights[index]);\n\t\t\t\t\tif (sum) {\n\t\t\t\t\t\tsum.add(weighted_value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsum = weighted_value;\n\t\t\t\t\t}\n\t\t\t\t\tindex++;\n\t\t\t\t}\n\t\t\t\tnew_attrib_value = sum;\n\t\t\t}\n\t\t}\n\t\treturn new_attrib_value;\n\t}\n\n\tstatic interpolated_value(\n\t\tgeometry: BufferGeometry,\n\t\tface: FaceLike,\n\t\tintersect_point: Vector3,\n\t\tattrib: BufferAttribute\n\t) {\n\t\t// let point_index, i, sum\n\t\tconst point_indices = [face.a, face.b, face.c];\n\t\tconst position_attrib = geometry.getAttribute('position');\n\t\tconst position_attrib_array = position_attrib.array;\n\t\tconst point_positions = point_indices.map(\n\t\t\t(point_index) =>\n\t\t\t\tnew Vector3(\n\t\t\t\t\tposition_attrib_array[point_index * 3 + 0],\n\t\t\t\t\tposition_attrib_array[point_index * 3 + 1],\n\t\t\t\t\tposition_attrib_array[point_index * 3 + 2]\n\t\t\t\t)\n\t\t);\n\n\t\tconst attrib_size = attrib.itemSize;\n\t\tconst attrib_array = attrib.array;\n\t\tlet attrib_values: NumericAttribValue[] = [];\n\t\tswitch (attrib_size) {\n\t\t\tcase 1:\n\t\t\t\tattrib_values = point_indices.map((point_index) => attrib_array[point_index]);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tattrib_values = point_indices.map(\n\t\t\t\t\t(point_index) => new Vector2(attrib_array[point_index * 2 + 0], attrib_array[point_index * 2 + 1])\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tattrib_values = point_indices.map(\n\t\t\t\t\t(point_index) =>\n\t\t\t\t\t\tnew Vector3(\n\t\t\t\t\t\t\tattrib_array[point_index * 3 + 0],\n\t\t\t\t\t\t\tattrib_array[point_index * 3 + 1],\n\t\t\t\t\t\t\tattrib_array[point_index * 3 + 2]\n\t\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst dist_to_points = point_indices.map((point_index, i) => intersect_point.distanceTo(point_positions[i]));\n\n\t\t// https://math.stackexchange.com/questions/1336386/weighted-average-distance-between-3-or-more-points\n\t\t// TODO: replace this with Core.Math.Interpolate\n\t\tconst distance_total = lodash_sum([\n\t\t\tdist_to_points[0] * dist_to_points[1],\n\t\t\tdist_to_points[0] * dist_to_points[2],\n\t\t\tdist_to_points[1] * dist_to_points[2],\n\t\t]);\n\n\t\tconst weights = [\n\t\t\t(dist_to_points[1] * dist_to_points[2]) / distance_total,\n\t\t\t(dist_to_points[0] * dist_to_points[2]) / distance_total,\n\t\t\t(dist_to_points[0] * dist_to_points[1]) / distance_total,\n\t\t];\n\n\t\tlet new_attrib_value;\n\t\tswitch (attrib_size) {\n\t\t\tcase 1:\n\t\t\t\tnew_attrib_value = lodash_sum(\n\t\t\t\t\tpoint_indices.map((point_indx, i) => weights[i] * (attrib_values[i] as number))\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tvar values = point_indices.map((point_index, i) =>\n\t\t\t\t\t(attrib_values[i] as Vector3).multiplyScalar(weights[i])\n\t\t\t\t);\n\t\t\t\tnew_attrib_value = null;\n\t\t\t\tfor (let value of values) {\n\t\t\t\t\tif (new_attrib_value) {\n\t\t\t\t\t\tnew_attrib_value.add(value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnew_attrib_value = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\n\t\treturn new_attrib_value;\n\t}\n}\n","import {InterleavedBufferAttribute} from 'three/src/core/InterleavedBufferAttribute'\n\nexport class MonkeyPatcher {\n\t// this allows cloning of geometries containing InterleavedBufferAttribute such as soldier.glb\n\tstatic patch(attribute: InterleavedBufferAttribute) {\n\t\tObject.assign(attribute, {\n\t\t\tclone: function() {\n\t\t\t\treturn new InterleavedBufferAttribute(\n\t\t\t\t\tattribute.data.clone(),\n\t\t\t\t\tattribute.itemSize,\n\t\t\t\t\tattribute.offset,\n\t\t\t\t\tattribute.normalized\n\t\t\t\t)\n\t\t\t},\n\t\t})\n\t}\n}\n","import {Vector3} from 'three/src/math/Vector3';\n// import {Object3D} from 'three/src/core/Object3D'\n// import {Group} from 'three/src/objects/Group'\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {Box3} from 'three/src/math/Box3';\nimport {TypedContainer} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\n// import {CoreObject} from 'src/core/geometry/Object'\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {ContainableMap} from './utils/ContainableMap';\n// import {CoreConstant} from 'src/core/geometry/Constant'\n\n// const CoreGeometryGroup = CoreGroup\n\n// export type RequestContainerGeometryCallback = (container: Geometry)=>void\n\n// interface GroupOptions {\n// \tclone?: boolean\n// }\n// interface BooleanByString {\n// \t[propName: string]: boolean\n// }\nexport class GeometryContainer extends TypedContainer<ContainableMap['GEOMETRY']> {\n\t// protected _group: Group = new Group()\n\t// private _objects_by_uuid: BooleanByString = {}\n\t// protected _content: Object3D[] = []\n\t// protected _core_group: CoreGroup | null;\n\n\t// _points_count: number | null;\n\t// _bounding_box: Box3 | null;\n\n\t// constructor() {\n\t// \tsuper();\n\t// \t// this._materials = [];\n\t// }\n\n\t// _post_set_content() {\n\t// \tthis._core_group = this._core_group || new CoreGroup();\n\t// \tthis._core_group.touch();\n\t// \tthis._core_group.set_objects(this._content);\n\t// }\n\tset_objects(objects: Object3D[]) {}\n\n\t// clone_content(){\n\t// \treturn this._content.map(object=>CoreObject.clone(object))\n\t// }\n\t// core_content(): CoreGroup | null {\n\t// \treturn this._core_group; //= this._core_group || this._create_core_group()\n\t// }\n\tcore_content_cloned(): CoreGroup | undefined {\n\t\tif (this._content) {\n\t\t\treturn this._content.clone();\n\t\t}\n\t}\n\t// private _create_core_group(){\n\t// \tif(this._content){\n\t// \t\tconst core_group = new CoreGroup()\n\t// \t\tcore_group.set_objects(this._content)\n\t// \t\treturn core_group\n\t// \t}\n\t// }\n\t// reset_caches() {\n\t// \tconsole.log('reset cache');\n\t// \t// this._content = null;\n\t// \t// this._points_count = null;\n\t// \t// this._bounding_box = null;\n\t// }\n\t// _default_content() {\n\t// \treturn new CoreGroup();\n\t// }\n\n\t// set_geometry: (geometry)->\n\t// \tif @_content?\n\t// \t\t@_content.dispose()\n\t// \tthis.set_content(geometry)\n\t// has_group: ->\n\t// \tthis.has_content()\n\t// group(options?: GroupOptions): Group | null{\n\t// \tlet src_group;\n\t// \tif (options == null) { options = {}; }\n\t// \tif ((options['clone'] == null)) {\n\t// \t\toptions['clone'] = true;\n\t// \t}\n\n\t// \tlet new_group = null;\n\t// \tif ((src_group = this.content()) != null) {\n\t// \t\tif (options['clone'] === true) {\n\t// \t\t\tnew_group = CoreGroup.clone(src_group);\n\t// \t\t} else {\n\t// \t\t\tnew_group = src_group;\n\t// \t\t}\n\t// \t}\n\n\t// \treturn new_group;\n\t// }\n\n\t// group_wrapper(options){\n\t// \t// if (options == null) { options = {}; }\n\t// \t// return new CoreGroup(this.group(options));\n\t// }\n\t// core_group() {\n\t// \treturn this._core_group; //this.group_wrapper(options)\n\t// }\n\tset_content(content: ContainableMap['GEOMETRY']) {\n\t\tsuper.set_content(content);\n\t}\n\t// object(options){\n\t// \tif (options == null) { options = {}; }\n\t// \treturn this.group(options);\n\t// }\n\t// _post_set_content(){\n\t// \t// const objects_to_remove = []\n\t// \t// const objects_to_add = []\n\t// \t// const new_objects_by_uuid = {}\n\t// \t// for(let object of this._content){\n\t// \t// \tif(!this._objects_by_uuid[object.uuid]){\n\t// \t// \t\tobjects_to_add.push(object)\n\t// \t// \t}\n\t// \t// \tnew_objects_by_uuid[object.uuid] = true\n\t// \t// }\n\t// \t// for(let uuid of Object.keys(this._objects_by_uuid)){\n\n\t// \t// }\n\t// \tlet child\n\t// \twhile(child = this._group.children[0]){\n\t// \t\tthis._group.remove(child)\n\t// \t}\n\t// \tfor(let object of this._content){\n\t// \t\tthis._group.add(object)\n\t// \t}\n\t// }\n\n\t//\n\t//\n\t// INFOS\n\t//\n\t//\n\t// infos() {\n\t// \tif (this._content != null) {\n\t// \t\tconst bbox = this.bounding_box();\n\t// \t\tconst center = this.center(); //bbox.min.clone().add(bbox.max).multiplyScalar(0.5)\n\t// \t\tconst size = this.size(); //bbox.max.clone().sub(bbox.min)\n\n\t// \t\tconst node = this.node();\n\t// \t\tconst part_1 = [\n\t// \t\t\t`time dependent: ${node.is_time_dependent()}`,\n\t// \t\t\t`${node.cooks_count()} cooks`,\n\t// \t\t\t`cook time: ${node.cook_time()}`,\n\t// \t\t\t`cook time with inputs: ${node.cook_time_with_inputs()}`,\n\t// \t\t\t`${this.points_count()} points`,\n\t// \t\t\t`${this.objects_count()} object(s)  (${this.objects_visible_count()} visible)`\n\t// \t\t];\n\n\t// \t\tconst part_2 = [];\n\t// \t\tconst count_by_type = this.objects_count_by_type();\n\t// \t\tObject.keys(count_by_type).forEach((type)=>{\n\n\t// \t\t\tconst count = count_by_type[type];\n\t// \t\t\treturn part_2.push(`${count} ${type}`);\n\t// \t\t});\n\n\t// \t\tconst vertex_attributes = this.vertex_attribute_names();\n\t// \t\tconst object_attributes = this.object_attribute_names();\n\t// \t\tpart_2.push(`vertex attributes (${vertex_attributes.length}): ${vertex_attributes.join(', ')}`);\n\t// \t\tpart_2.push(`object attributes (${object_attributes.length}): ${object_attributes.join(', ')}`);\n\n\t// \t\tconst part_3 = [\n\t// \t\t\t\"bbox:\",\n\t// \t\t\t[bbox.min.x, bbox.min.y, bbox.min.z],\n\t// \t\t\t[bbox.max.x, bbox.max.y, bbox.max.z],\n\t// \t\t\t\"center:\",\n\t// \t\t\t[center.x, center.y, center.z],\n\t// \t\t\t\"size:\",\n\t// \t\t\t[size.x, size.y, size.z],\n\t// \t\t\tthis._content\n\t// \t\t];\n\n\t// \t\treturn lodash_concat( part_1, part_2, part_3 );\n\t// \t}\n\t// }\n\n\tprivate first_object() {\n\t\tif (this._content) {\n\t\t\treturn this._content.objects()[0];\n\t\t}\n\t}\n\tprivate first_geometry(): BufferGeometry | null {\n\t\tconst object = this.first_object();\n\t\tif (object) {\n\t\t\treturn (object as Mesh).geometry as BufferGeometry;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tobjects_count(): number {\n\t\t// let count = 0\n\t\t// if(this._content){\n\t\t// \tcount = this._content.children.length\n\t\t// }\n\t\t// return count\n\t\tif (this._content) {\n\t\t\treturn this._content.objects().length;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tobjects_visible_count(): number {\n\t\tlet count = 0;\n\t\tif (this._content) {\n\t\t\tcount = this._content.objects().filter((c) => c.visible).length; // lodash_filter(this._content, c=> c.visible).length;\n\t\t}\n\t\treturn count;\n\t}\n\tobjects_count_by_type() {\n\t\tconst count_by_type: Dictionary<number> = {};\n\t\tconst core_group = this._content;\n\t\tif (this._content && core_group) {\n\t\t\tfor (let core_object of core_group.core_objects()) {\n\t\t\t\tconst human_type = core_object.human_type();\n\t\t\t\tif (count_by_type[human_type] == null) {\n\t\t\t\t\tcount_by_type[human_type] = 0;\n\t\t\t\t}\n\t\t\t\tcount_by_type[human_type] += 1;\n\t\t\t}\n\t\t}\n\t\treturn count_by_type;\n\t}\n\tobjects_names_by_type() {\n\t\tconst names_by_type: Dictionary<string[]> = {};\n\t\tconst core_group = this._content;\n\t\tif (this._content && core_group) {\n\t\t\tfor (let core_object of core_group.core_objects()) {\n\t\t\t\tconst human_type = core_object.human_type();\n\t\t\t\tnames_by_type[human_type] = names_by_type[human_type] || [];\n\t\t\t\tnames_by_type[human_type].push(core_object.name());\n\t\t\t}\n\t\t}\n\t\treturn names_by_type;\n\t}\n\n\tvertex_attribute_names() {\n\t\tlet names: string[] = [];\n\t\tconst geometry = this.first_geometry();\n\t\tif (geometry) {\n\t\t\tnames = Object.keys(geometry.attributes);\n\t\t}\n\t\treturn names;\n\t}\n\tvertex_attribute_sizes_by_name() {\n\t\tlet sizes_by_name: Dictionary<number> = {};\n\t\tconst geometry = this.first_geometry();\n\t\tif (geometry) {\n\t\t\tObject.keys(geometry.attributes).forEach((attrib_name) => {\n\t\t\t\tconst attrib = geometry.attributes[attrib_name];\n\t\t\t\tsizes_by_name[attrib_name] = attrib.itemSize;\n\t\t\t});\n\t\t}\n\t\treturn sizes_by_name;\n\t}\n\tvertex_attribute_types_by_name() {\n\t\tlet types_by_name: Dictionary<number> = {};\n\t\tconst geometry = this.first_geometry();\n\t\tif (geometry) {\n\t\t\tconst core_geo = new CoreGeometry(geometry);\n\t\t\tObject.keys(geometry.attributes).forEach((attrib_name) => {\n\t\t\t\ttypes_by_name[attrib_name] = core_geo.attrib_type(attrib_name);\n\t\t\t});\n\t\t}\n\t\treturn types_by_name;\n\t}\n\tobject_attribute_names() {\n\t\tlet names: string[] = [];\n\t\tconst object = this.first_object();\n\t\tif (object) {\n\t\t\tnames = Object.keys(object.userData['attributes'] || {});\n\t\t}\n\t\treturn names;\n\t}\n\n\tpoints_count(): number {\n\t\tif (this._content) {\n\t\t\treturn this._content.points_count();\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\n\t\t// return this._points_count != null ? this._points_count : (this._points_count = this._compute_points_count());\n\t}\n\n\t// _compute_points_count() {\n\t// \tlet points_count = 0;\n\t// \tif (this._content) {\n\t// \t\tfor (let object of this._content.objects()) {\n\t// \t\t\tobject.traverse((object) => {\n\t// \t\t\t\tconst geometry = (object as Mesh).geometry as BufferGeometry;\n\t// \t\t\t\tif (geometry) {\n\t// \t\t\t\t\tpoints_count += CoreGeometry.points_count(geometry);\n\t// \t\t\t\t}\n\t// \t\t\t});\n\t// \t\t}\n\t// \t}\n\t// \treturn points_count;\n\t// }\n\t//@_content.userData['points_count']\n\t//Core.Geometry.Geometry.points_count(@_content)\n\t// count = 0\n\t// if (position = @_content.getAttribute('position'))?\n\t// \tif (array = position.array)?\n\t// \t\tcount = array.length / 3\n\n\t// count\n\n\t// points_for_geometry: (geometry)->\n\t// \tCore.Geometry.Geometry.points_from_geometry(geometry)\n\n\t// create_geometry_from_points: (points, index_mode)->\n\t// \tCore.Geometry.Geometry.geometry_from_points(points, index_mode)\n\n\t//\n\t//\n\t// BBOX\n\t//\n\t//\n\tbounding_box(): Box3 {\n\t\treturn this._content.bounding_box();\n\t\t// return this._bounding_box != null ? this._bounding_box : (this._bounding_box = this._compute_bounding_box());\n\t}\n\tcenter(): Vector3 {\n\t\treturn this._content.center();\n\t\t// const center = new Vector3();\n\t\t// this.bounding_box().getCenter(center);\n\t\t// return center;\n\t}\n\tsize(): Vector3 {\n\t\treturn this._content.size();\n\t\t// const size = new Vector3();\n\t\t// this.bounding_box().getSize(size);\n\t\t// return size;\n\t}\n\n\t// private _compute_bounding_box() {\n\t// \tconst bbox = new Box3();\n\t// \tif (this._content) {\n\t// \t\tfor (let object of this._content.objects()) {\n\t// \t\t\t// const box = new Box3()\n\t// \t\t\t// bbox.setFromObject(object);\n\t// \t\t\tbbox.expandByObject(object);\n\t// \t\t}\n\t// \t}\n\t// \treturn bbox;\n\t// }\n}\n","import {TypedSopNode} from './_Base';\n// import {CoreTransform} from 'src/Core/Transform';\n// import {ParamType} from 'src/Engine/Param/_Module'\n\n// interface ActionsByName {\n// \t[propName: string]: THREE.AnimationClip;\n// }\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {Object3DWithAnimation} from 'src/core/geometry/Animation';\nclass AnimationCopySopParamsConfig extends NodeParamsConfig {}\nconst ParamsConfig = new AnimationCopySopParamsConfig();\n\nexport class AnimationCopySopNode extends TypedSopNode<AnimationCopySopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'animation_copy';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to copy animation to', 'geometry to copy animation from'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(2);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE, InputCloneMode.NEVER]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group_target = input_contents[0];\n\t\tconst core_group_src = input_contents[1];\n\n\t\tconst src_object = core_group_src.objects()[0] as Object3DWithAnimation;\n\t\tconst target_object = core_group_target.objects()[0] as Object3DWithAnimation;\n\n\t\tconst src_animations = src_object.animations;\n\t\tif (src_animations) {\n\t\t\ttarget_object.animations = src_animations.map((a) => a.clone());\n\t\t\tthis.set_core_group(core_group_target);\n\t\t} else {\n\t\t\tthis.states.error.set('no animation found');\n\t\t}\n\t}\n}\n","import {TypedSopNode} from './_Base';\nimport lodash_isArray from 'lodash/isArray';\n// import {Object3D} from 'three/src/core/Object3D';\nimport {AnimationMixer} from 'three/src/animation/AnimationMixer';\n// import {AnimationClip} from 'three/src/animation/AnimationClip';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {Object3DWithAnimation} from 'src/core/geometry/Animation';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {AnimationAction} from 'three/src/animation/AnimationAction';\nimport {Mesh} from 'three/src/objects/Mesh';\n\nimport {Material} from 'three/src/materials/Materials';\nimport {MaterialWithSkinning} from 'src/core/geometry/Material';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {BaseNodeType} from '../_Base';\nclass AnimationMixerSopParamsConfig extends NodeParamsConfig {\n\ttime = ParamConfig.FLOAT('$T', {range: [0, 10]});\n\tprepare = ParamConfig.BUTTON(null, {\n\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\tAnimationMixerSopNode.PARAM_CALLBACK_prepare(node as AnimationMixerSopNode, param);\n\t\t},\n\t});\n}\nconst ParamsConfig = new AnimationMixerSopParamsConfig();\n\nexport class AnimationMixerSopNode extends TypedSopNode<AnimationMixerSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'animation_mixer';\n\t}\n\n\t_previous_time: number | null = null;\n\t_mixer: AnimationMixer | null = null;\n\t_actions_by_name: Dictionary<AnimationAction> = {};\n\t_values_by_param_name: Dictionary<number> = {};\n\t// _mixer_used_once: boolean = false\n\t_animation_target: Object3DWithAnimation | undefined;\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to be animated'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tif (!this._mixer) {\n\t\t\tthis.create_mixer(input_contents[0]);\n\t\t} else {\n\t\t\tthis._update_mixer();\n\t\t\tthis.cook_controller.end_cook();\n\t\t}\n\t}\n\n\tprivate create_mixer(core_group: CoreGroup) {\n\t\tthis._animation_target = core_group.objects()[0] as Object3DWithAnimation;\n\t\tthis._mixer = new AnimationMixer(this._animation_target);\n\n\t\tthis._remove_spare_params();\n\t\tthis._actions_by_name = {};\n\n\t\tif (this._animation_target.animations) {\n\t\t\tthis._animation_target.animations.forEach((animation, i) => {\n\t\t\t\tconst param_name = animation.name;\n\t\t\t\tconst previous_value = this._values_by_param_name[param_name];\n\t\t\t\tlet default_value = previous_value;\n\t\t\t\tif (default_value == null) {\n\t\t\t\t\tdefault_value = i == 0 ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tconst param = this.add_param(ParamType.FLOAT, param_name, default_value, {spare: true});\n\t\t\t\tif (param) {\n\t\t\t\t\tconst prev_value = this._values_by_param_name[param_name];\n\t\t\t\t\tif (prev_value) {\n\t\t\t\t\t\tparam.set(prev_value);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this._mixer) {\n\t\t\t\t\tconst action = this._mixer.clipAction(animation);\n\t\t\t\t\tthis._actions_by_name[animation.name] = action;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.emit(NodeEvent.PARAMS_UPDATED);\n\n\t\tObject.keys(this._actions_by_name).forEach((name) => {\n\t\t\tthis._actions_by_name[name].play();\n\t\t});\n\n\t\t// set material skinning\n\t\tconst materials_by_id: Dictionary<Material> = {};\n\t\tthis._animation_target.traverse((object3d: Object3D) => {\n\t\t\tconst child = object3d as Mesh;\n\t\t\tif (child.material) {\n\t\t\t\tif (!lodash_isArray(child.material)) {\n\t\t\t\t\tmaterials_by_id[child.material.uuid] = child.material;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tObject.keys(materials_by_id).forEach((uuid) => {\n\t\t\tconst material = materials_by_id[uuid] as MaterialWithSkinning;\n\t\t\tmaterial.skinning = true;\n\t\t\tmaterial.morphTargets = true;\n\t\t});\n\t\tthis._previous_time = null;\n\t\tthis._update_mixer();\n\t\tthis._update_mixer_weights(); // might be redundant with _update_mixer, but ensures this is done on load\n\t\tthis.set_object(this._animation_target);\n\t}\n\n\tprivate _remove_spare_params() {\n\t\tthis._values_by_param_name = {};\n\t\tconst current_param_names: string[] = this.params.spare_names;\n\t\tcurrent_param_names.forEach((param_name) => {\n\t\t\tconst param = this.params.get_float(param_name);\n\t\t\tif (param) {\n\t\t\t\tthis._values_by_param_name[param_name] = param.value;\n\t\t\t\tthis.params.delete_param(param_name);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _update_mixer() {\n\t\tif (this.pv.time != this._previous_time) {\n\t\t\tthis._update_mixer_time();\n\t\t} else {\n\t\t\tthis._update_mixer_weights();\n\t\t}\n\t}\n\tprivate _update_mixer_time() {\n\t\tconst delta = this.pv.time - (this._previous_time || 0);\n\t\tif (this._mixer) {\n\t\t\tthis._mixer.update(delta);\n\t\t}\n\t\tthis._previous_time = this.pv.time;\n\t}\n\n\tprivate _update_mixer_weights() {\n\t\tfor (let name of Object.keys(this._actions_by_name)) {\n\t\t\tconst action = this._actions_by_name[name];\n\t\t\tconst cache_value = this.params.get_float(name).value;\n\t\t\tif (cache_value != null) {\n\t\t\t\taction.setEffectiveWeight(cache_value);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic PARAM_CALLBACK_prepare(node: AnimationMixerSopNode, param: BaseParamType) {\n\t\tnode.prepare_animation_mixer();\n\t}\n\tasync prepare_animation_mixer() {\n\t\tthis._mixer = null;\n\t\tconst container = await this.io.inputs.eval_required_input(0);\n\t\tthis.create_mixer(container.core_content_cloned());\n\t\tthis.set_dirty();\n\t}\n}\n","import {TypedSopNode} from './_Base';\n// import {Core} from 'src/Core/_Module';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nclass AttribAddMultSopParamsConfig extends NodeParamsConfig {\n\tname = ParamConfig.STRING('');\n\tpre_add = ParamConfig.FLOAT(0, {range: [0, 1]});\n\tmult = ParamConfig.FLOAT(1, {range: [0, 1]});\n\tpost_add = ParamConfig.FLOAT(0, {range: [0, 1]});\n}\nconst ParamsConfig = new AttribAddMultSopParamsConfig();\n\nexport class AttribAddMultSopNode extends TypedSopNode<AttribAddMultSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_add_mult';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tconst attrib_names = core_group.attrib_names_matching_mask(this.pv.name);\n\n\t\tfor (let attrib_name of attrib_names) {\n\t\t\tconst geometries = core_group.geometries();\n\t\t\tfor (let geometry of geometries) {\n\t\t\t\tthis._update_attrib(attrib_name, geometry);\n\t\t\t}\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n\n\tprivate _update_attrib(attrib_name: string, geometry: BufferGeometry) {\n\t\tconst attribute = geometry.getAttribute(attrib_name) as BufferAttribute;\n\t\tif (attribute) {\n\t\t\tconst values = attribute.array as number[];\n\n\t\t\tconst pre_add = this.pv.pre_add;\n\t\t\tconst mult = this.pv.mult;\n\t\t\tconst post_add = this.pv.post_add;\n\t\t\tfor (let i = 0; i < values.length; i++) {\n\t\t\t\tconst value = values[i];\n\t\t\t\tvalues[i] = (value + pre_add) * mult + post_add;\n\t\t\t}\n\t\t\tif (!this.io.inputs.input_cloned(0)) {\n\t\t\t\tattribute.needsUpdate = true;\n\t\t\t}\n\t\t}\n\t}\n}\n","import {TypedSopNode} from './_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nclass AttribCopySopParamsConfig extends NodeParamsConfig {\n\t// class = ParamConfig.INTEGER(CoreConstant.ATTRIB_CLASS.VERTEX, {\n\t// \tmenu: {\n\t// \t\tentries: [\n\t// \t\t\t{name: 'vertex', value: CoreConstant.ATTRIB_CLASS.VERTEX},\n\t// \t\t\t{name: 'object', value: CoreConstant.ATTRIB_CLASS.OBJECT},\n\t// \t\t],\n\t// \t},\n\t// })\n\tname = ParamConfig.STRING('');\n\ttnew_name = ParamConfig.BOOLEAN(0);\n\tnew_name = ParamConfig.STRING('', {visible_if: {tnew_name: 1}});\n\t// to_all_components = ParamConfig.BOOLEAN(1)\n\t// src_component = ParamConfig.INTEGER(0, {\n\t// \trange: [0, 2],\n\t// \trange_locked: [true, true],\n\t// \tvisible_if: {to_all_components: 0},\n\t// })\n\t// dest_component = ParamConfig.INTEGER(0, {\n\t// \trange: [0, 2],\n\t// \trange_locked: [true, true],\n\t// \tvisible_if: {to_all_components: 0},\n\t// })\n}\nconst ParamsConfig = new AttribCopySopParamsConfig();\n\n// TODO: attrib copy should handle string attributes\nexport class AttribCopySopNode extends TypedSopNode<AttribCopySopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_copy';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to copy attributes to', 'geometry to copy attributes from'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(2);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE, InputCloneMode.NEVER]);\n\t}\n\n\tcreate_params() {}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group_dest = input_contents[0];\n\t\tconst core_group_src = input_contents[1];\n\n\t\tconst attrib_names = core_group_src.attrib_names_matching_mask(this.pv.name);\n\t\tfor (let attrib_name of attrib_names) {\n\t\t\tthis.copy_vertex_attribute_between_core_groups(core_group_dest, core_group_src, attrib_name);\n\t\t}\n\n\t\t// switch (this.pv.class) {\n\t\t// \tcase CoreConstant.ATTRIB_CLASS.VERTEX:\n\t\t// \t\tthis.copy_vertex_attribute(core_group_dest, core_group_src);\n\t\t// \t\tbreak;\n\t\t// \tcase CoreConstant.ATTRIB_CLASS.OBJECT:\n\t\t// \t\tthis.copy_object_attribute(core_group_dest, core_group_src);\n\t\t// \t\tbreak;\n\t\t// }\n\n\t\treturn this.set_core_group(core_group_dest);\n\t}\n\n\tprivate copy_vertex_attribute_between_core_groups(\n\t\tcore_group_dest: CoreGroup,\n\t\tcore_group_src: CoreGroup,\n\t\tattrib_name: string\n\t) {\n\t\tconst src_objects = core_group_src.objects();\n\t\tconst dest_objects = core_group_dest.objects();\n\n\t\tif (dest_objects.length > src_objects.length) {\n\t\t\tthis.states.error.set('second input does not have enough objects to copy attributes from');\n\t\t} else {\n\t\t\tfor (let i = 0; i < dest_objects.length; i++) {\n\t\t\t\tconst dest_geometry = dest_objects[i].geometry;\n\t\t\t\tconst src_geometry = dest_objects[i].geometry;\n\t\t\t\tthis.copy_vertex_attribute_between_geometries(dest_geometry, src_geometry, attrib_name);\n\t\t\t}\n\t\t}\n\t}\n\tprivate copy_vertex_attribute_between_geometries(\n\t\tdest_geometry: BufferGeometry,\n\t\tsrc_geometry: BufferGeometry,\n\t\tattrib_name: string\n\t) {\n\t\tconst src_attrib = src_geometry.getAttribute(attrib_name);\n\t\tif (src_attrib) {\n\t\t\tconst size = src_attrib.itemSize;\n\t\t\tconst src_points_count = src_geometry.getAttribute('position').array.length / 3;\n\t\t\tconst dest_points_count = dest_geometry.getAttribute('position').array.length / 3;\n\t\t\tif (dest_points_count > src_points_count) {\n\t\t\t\tthis.states.error.set('not enough points in second input');\n\t\t\t}\n\t\t\tconst src_array = src_attrib.array as number[];\n\t\t\tconst sub_array = src_array.slice(0, dest_points_count * size);\n\t\t\tconst dest_name = this.pv.tnew_name ? this.pv.new_name : attrib_name;\n\t\t\tdest_geometry.setAttribute(dest_name, new Float32BufferAttribute(sub_array, size));\n\t\t} else {\n\t\t\tthis.states.error.set(`attribute '${attrib_name}' does not exist on second input`);\n\t\t}\n\t}\n\n\t// _src_value_to_all_components(src_attrib_value: NumericAttribValue, dest_attrib_size) {\n\t// \tif (lodash_isNumber(src_attrib_value)) {\n\t// \t\tswitch (dest_attrib_size) {\n\t// \t\t\tcase 1:\n\t// \t\t\t\treturn src_attrib_value;\n\t// \t\t\tcase 2:\n\t// \t\t\t\treturn new THREE.Vector2(src_attrib_value, src_attrib_value);\n\t// \t\t\tcase 3:\n\t// \t\t\t\treturn new THREE.Vector3(src_attrib_value, src_attrib_value, src_attrib_value);\n\t// \t\t}\n\t// \t} else {\n\t// \t\tswitch (dest_attrib_size) {\n\t// \t\t\tcase 1:\n\t// \t\t\t\treturn src_attrib_value.x;\n\t// \t\t\tcase 2:\n\t// \t\t\t\treturn new THREE.Vector2(src_attrib_value.x, src_attrib_value.y);\n\t// \t\t\tcase 3:\n\t// \t\t\t\treturn new THREE.Vector3(\n\t// \t\t\t\t\tsrc_attrib_value.x,\n\t// \t\t\t\t\tsrc_attrib_value.y,\n\t// \t\t\t\t\tsrc_attrib_value.z || src_attrib_value.y\n\t// \t\t\t\t);\n\t// \t\t}\n\t// \t}\n\t// }\n\n\t// _src_value_to_component(src_attrib_value, current_dest_value, src_component, dest_component) {\n\t// \tconst src_component_value = (() => {\n\t// \t\tswitch (src_component) {\n\t// \t\t\tcase 0:\n\t// \t\t\t\treturn src_attrib_value.x || src_attrib_value;\n\t// \t\t\tcase 1:\n\t// \t\t\t\treturn src_attrib_value.y;\n\t// \t\t\tcase 2:\n\t// \t\t\t\treturn src_attrib_value.z;\n\t// \t\t}\n\t// \t})();\n\n\t// \tconst dest_component_name = ['x', 'y', 'z'][dest_component];\n\t// \tif (current_dest_value[dest_component_name] != null) {\n\t// \t\tcurrent_dest_value[dest_component_name] = src_component_value;\n\t// \t\treturn current_dest_value;\n\t// \t} else {\n\t// \t\tconst src_component_name = ['x', 'y', 'z'][src_component];\n\t// \t\treturn src_attrib_value[src_component_name];\n\t// \t}\n\t// }\n\n\t// TODO: find a way to use the point method, but have the group api allow easy switch\n\t// private  copy_object_attribute(core_group_dest: CoreGroup, core_group_src:CoreGroup) {\n\t// \t// const objects_dest = core_group_dest.objects();\n\t// \t// const objects_src = core_group_src.objects();\n\n\t// \t//attribute_names = core_group_src.attrib_names_matching_mask(@_param_name)\n\n\t// \t//lodash_each attribute_names, (attrib_name) =>\n\t// \tconst attrib_name = this.pv.name;\n\n\t// \tif (!core_group_dest.has_attrib(attrib_name)) {\n\t// \t\tconst attrib_size = core_group_src.attrib_size(attrib_name);\n\t// \t\tcore_group_dest.add_numeric_vertex_attrib(attrib_name, attrib_size, 0);\n\t// \t}\n\n\t// \tlodash_each(points_dest, (point_dest, i) => {\n\t// \t\tlet point_src;\n\t// \t\tif ((point_src = points_src[i]) != null) {\n\t// \t\t\tconst attrib_value = point_src.attrib_value(attrib_name);\n\t// \t\t\tpoint_dest.set_attrib_value(attrib_name, attrib_value);\n\t// \t\t}\n\t// \t});\n\t// }\n}\n","import lodash_trim from 'lodash/trim';\n\nimport {TypedSopNode} from './_Base';\nimport {\n\tCoreConstant,\n\tAttribClassMenuEntries,\n\tAttribTypeMenuEntries,\n\tAttribClass,\n\tAttribType,\n} from 'src/core/geometry/Constant';\nimport {CoreAttribute} from 'src/core/geometry/Attribute';\n// import {CoreGeometry} from 'src/core/geometry/Geometry'\nimport {CoreObject} from 'src/core/geometry/Object';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\n// import {Vector3} from 'three/src/math/Vector3';\n// import {Vector2} from 'three/src/math/Vector2';\n\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n\n// const VALUE_PARAM = {\n// \tVALUEX: 'valuex',\n// \tVALUE: 'value',\n// \tSTRING: 'string',\n// };\n// const DEFAULT_VALUE = {\n// \tvaluex: 0,\n// \tvalue: [0, 0, 0],\n// \tstring: '',\n// };\ntype COMPONENT_INDEX = keyof Vector4Like;\nconst COMPONENT_INDEX: Array<COMPONENT_INDEX> = ['x', 'y', 'z', 'w'];\ntype ValueArrayByName = Dictionary<number[]>;\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass AttribCreateSopParamsConfig extends NodeParamsConfig {\n\tgroup = ParamConfig.STRING('');\n\tclass = ParamConfig.INTEGER(AttribClass.VERTEX, {\n\t\tmenu: {\n\t\t\tentries: AttribClassMenuEntries,\n\t\t},\n\t});\n\ttype = ParamConfig.INTEGER(AttribType.NUMERIC, {\n\t\tmenu: {\n\t\t\tentries: AttribTypeMenuEntries,\n\t\t},\n\t});\n\tname = ParamConfig.STRING('new_attrib');\n\tsize = ParamConfig.INTEGER(1, {\n\t\trange: [1, 4],\n\t\trange_locked: [true, true],\n\t\tvisible_if: {type: CoreConstant.ATTRIB_TYPE.NUMERIC},\n\t});\n\tvalue1 = ParamConfig.FLOAT(0, {\n\t\tvisible_if: {type: CoreConstant.ATTRIB_TYPE.NUMERIC, size: 1},\n\t\texpression: {for_entities: true},\n\t});\n\tvalue2 = ParamConfig.VECTOR2([0, 0], {\n\t\tvisible_if: {type: CoreConstant.ATTRIB_TYPE.NUMERIC, size: 2},\n\t\texpression: {for_entities: true},\n\t});\n\tvalue3 = ParamConfig.VECTOR3([0, 0, 0], {\n\t\tvisible_if: {type: CoreConstant.ATTRIB_TYPE.NUMERIC, size: 3},\n\t\texpression: {for_entities: true},\n\t});\n\tvalue4 = ParamConfig.VECTOR4([0, 0, 0, 0], {\n\t\tvisible_if: {type: CoreConstant.ATTRIB_TYPE.NUMERIC, size: 4},\n\t\texpression: {for_entities: true},\n\t});\n\tstring = ParamConfig.STRING('', {\n\t\tvisible_if: {type: CoreConstant.ATTRIB_TYPE.STRING},\n\t\texpression: {for_entities: true},\n\t});\n}\nconst ParamsConfig = new AttribCreateSopParamsConfig();\nexport class AttribCreateSopNode extends TypedSopNode<AttribCreateSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_create';\n\t}\n\n\tprivate _x_arrays_by_geometry_uuid: ValueArrayByName = {};\n\tprivate _y_arrays_by_geometry_uuid: ValueArrayByName = {};\n\tprivate _z_arrays_by_geometry_uuid: ValueArrayByName = {};\n\tprivate _w_arrays_by_geometry_uuid: ValueArrayByName = {};\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tif (this.pv.name && lodash_trim(this.pv.name) != '') {\n\t\t\tswitch (this.pv.class) {\n\t\t\t\tcase AttribClass.VERTEX:\n\t\t\t\t\tthis.add_point_attribute(core_group);\n\t\t\t\t\tbreak;\n\t\t\t\tcase AttribClass.OBJECT:\n\t\t\t\t\tthis.add_object_attribute(core_group);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.states.error.set('attribute name is not valid');\n\t\t}\n\t}\n\n\tasync add_point_attribute(core_group: CoreGroup) {\n\t\tconst core_objects = core_group.core_objects();\n\t\tfor (let i = 0; i < core_objects.length; i++) {\n\t\t\tconst core_object = core_objects[i];\n\t\t\tswitch (this.pv.type) {\n\t\t\t\tcase CoreConstant.ATTRIB_TYPE.NUMERIC:\n\t\t\t\t\tawait this.add_numeric_attribute_to_points(core_object);\n\t\t\t\t\tbreak;\n\t\t\t\tcase CoreConstant.ATTRIB_TYPE.STRING:\n\t\t\t\t\tawait this.add_string_attribute_to_points(core_object);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.set_core_group(core_group);\n\t}\n\tasync add_object_attribute(core_group: CoreGroup) {\n\t\tconst core_objects = core_group.core_objects_from_group(this.pv.group);\n\t\tswitch (this.pv.type) {\n\t\t\tcase CoreConstant.ATTRIB_TYPE.NUMERIC:\n\t\t\t\tawait this.add_numeric_attribute_to_object(core_objects);\n\t\t\t\tbreak;\n\t\t\tcase CoreConstant.ATTRIB_TYPE.STRING:\n\t\t\t\tawait this.add_string_attribute_to_object(core_objects);\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.set_core_group(core_group);\n\t}\n\n\tasync add_numeric_attribute_to_points(core_object: CoreObject) {\n\t\tconst core_geometry = core_object.core_geometry();\n\t\tconst points = core_object.points_from_group(this.pv.group);\n\n\t\tconst param = [this.p.value1, this.p.value2, this.p.value3, this.p.value4][this.pv.size - 1];\n\n\t\tif (param.has_expression()) {\n\t\t\tif (!core_geometry.has_attrib(this.pv.name)) {\n\t\t\t\tcore_geometry.add_numeric_attrib(this.pv.name, this.pv.size, param.value);\n\t\t\t}\n\n\t\t\tconst geometry = core_geometry.geometry();\n\t\t\tconst array = geometry.getAttribute(this.pv.name).array as number[];\n\t\t\tif (this.pv.size == 1) {\n\t\t\t\tif (this.p.value1.expression_controller) {\n\t\t\t\t\tawait this.p.value1.expression_controller.compute_expression_for_points(points, (point, value) => {\n\t\t\t\t\t\tarray[point.index * this.pv.size + 0] = value;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst vparam = [this.p.value2, this.p.value3, this.p.value4][this.pv.size - 2];\n\t\t\t\tlet params = vparam.components;\n\t\t\t\tconst tmp_arrays = new Array(params.length);\n\t\t\t\tlet component_param;\n\n\t\t\t\tconst arrays_by_geometry_uuid = [\n\t\t\t\t\tthis._x_arrays_by_geometry_uuid,\n\t\t\t\t\tthis._y_arrays_by_geometry_uuid,\n\t\t\t\t\tthis._z_arrays_by_geometry_uuid,\n\t\t\t\t\tthis._w_arrays_by_geometry_uuid,\n\t\t\t\t];\n\n\t\t\t\tfor (let i = 0; i < params.length; i++) {\n\t\t\t\t\tcomponent_param = params[i];\n\t\t\t\t\tif (component_param.has_expression() && component_param.expression_controller) {\n\t\t\t\t\t\ttmp_arrays[i] = this._init_array_if_required(\n\t\t\t\t\t\t\tgeometry,\n\t\t\t\t\t\t\tarrays_by_geometry_uuid[i],\n\t\t\t\t\t\t\tpoints.length\n\t\t\t\t\t\t);\n\t\t\t\t\t\tawait component_param.expression_controller.compute_expression_for_points(\n\t\t\t\t\t\t\tpoints,\n\t\t\t\t\t\t\t(point, value) => {\n\t\t\t\t\t\t\t\t// array[point.index()*this.pv.size+i] = value\n\t\t\t\t\t\t\t\ttmp_arrays[i][point.index] = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst value = component_param.value;\n\t\t\t\t\t\tfor (let point of points) {\n\t\t\t\t\t\t\tarray[point.index * this.pv.size + i] = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// commit the tmp values\n\t\t\t\tfor (let j = 0; j < tmp_arrays.length; j++) {\n\t\t\t\t\tconst tmp_array = tmp_arrays[j];\n\t\t\t\t\tif (tmp_array) {\n\t\t\t\t\t\tfor (let i = 0; i < tmp_array.length; i++) {\n\t\t\t\t\t\t\tarray[i * this.pv.size + j] = tmp_array[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// const value = await param.eval_p();\n\t\t\tcore_object.add_numeric_vertex_attrib(this.pv.name, this.pv.size, param.value);\n\t\t}\n\t}\n\n\tasync add_numeric_attribute_to_object(core_objects: CoreObject[]) {\n\t\tconst param = [this.p.value1, this.p.value2, this.p.value3, this.p.value4][this.pv.size - 1];\n\t\tif (param.has_expression()) {\n\t\t\tif (this.pv.size == 1) {\n\t\t\t\tif (this.p.value1.expression_controller) {\n\t\t\t\t\tawait this.p.value1.expression_controller.compute_expression_for_objects(\n\t\t\t\t\t\tcore_objects,\n\t\t\t\t\t\t(core_object, value) => {\n\t\t\t\t\t\t\tcore_object.set_attrib_value(this.pv.name, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst vparam = [this.p.value2, this.p.value3, this.p.value4][this.pv.size - 2];\n\t\t\t\tlet params = vparam.components;\n\t\t\t\tlet values_by_core_object_index: Dictionary<NumericAttribValueAsArray> = {};\n\t\t\t\t// for (let component_param of params) {\n\t\t\t\t// \tvalues.push(component_param.value);\n\t\t\t\t// }\n\t\t\t\tfor (let core_object of core_objects) {\n\t\t\t\t\tvalues_by_core_object_index[core_object.index] = (<unknown>[]) as NumericAttribValueAsArray;\n\t\t\t\t}\n\t\t\t\tfor (let component_index = 0; component_index < params.length; component_index++) {\n\t\t\t\t\tconst component_param = params[component_index];\n\t\t\t\t\tif (component_param.has_expression() && component_param.expression_controller) {\n\t\t\t\t\t\tawait component_param.expression_controller.compute_expression_for_objects(\n\t\t\t\t\t\t\tcore_objects,\n\t\t\t\t\t\t\t(core_object, value) => {\n\t\t\t\t\t\t\t\tvalues_by_core_object_index[core_object.index][component_index] = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (let core_object of core_objects) {\n\t\t\t\t\t\t\tvalues_by_core_object_index[core_object.index][component_index] = component_param.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (let i = 0; i < core_objects.length; i++) {\n\t\t\t\t\tconst core_object = core_objects[i];\n\t\t\t\t\tconst value = values_by_core_object_index[core_object.index];\n\t\t\t\t\tcore_object.set_attrib_value(this.pv.name, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// let value = await param.eval_p();\n\t\t\t// if (this.pv.size > 1) {\n\t\t\t// \tvalue = this._convert_object_numeric_value(value);\n\t\t\t// }\n\t\t\tfor (let core_object of core_objects) {\n\t\t\t\tcore_object.set_attrib_value(this.pv.name, param.value);\n\t\t\t}\n\t\t}\n\t}\n\n\t// private _convert_object_numeric_value(value: Vector4) {\n\t// \tlet converted_value;\n\t// \tswitch (this.pv.size) {\n\t// \t\tcase 1: {\n\t// \t\t\tconverted_value = value.x;\n\t// \t\t\tbreak;\n\t// \t\t}\n\t// \t\tcase 2: {\n\t// \t\t\tconverted_value = new Vector2(value.x, value.y);\n\t// \t\t\tbreak;\n\t// \t\t}\n\t// \t\tcase 3: {\n\t// \t\t\tconverted_value = new Vector3(value.x, value.y, value.z);\n\t// \t\t\tbreak;\n\t// \t\t}\n\t// \t\tcase 4: {\n\t// \t\t\tconverted_value = new Vector4(value.x, value.y, value.z, value.w);\n\t// \t\t\tbreak;\n\t// \t\t}\n\t// \t}\n\t// \treturn converted_value;\n\t// }\n\n\tasync add_string_attribute_to_points(core_object: CoreObject) {\n\t\tconst points = core_object.points_from_group(this.pv.group);\n\t\tconst param = this.p.string;\n\n\t\tconst string_values: string[] = [];\n\t\tif (param.has_expression() && param.expression_controller) {\n\t\t\tawait param.expression_controller.compute_expression_for_points(points, (point, value) => {\n\t\t\t\tstring_values[point.index] = value;\n\t\t\t});\n\t\t} else {\n\t\t\tstring_values.push(param.value);\n\t\t}\n\n\t\tconst index_data = CoreAttribute.array_to_indexed_arrays(string_values);\n\t\tcore_object.core_geometry().set_indexed_attribute(this.pv.name, index_data['values'], index_data['indices']);\n\t}\n\n\tasync add_string_attribute_to_object(core_objects: CoreObject[]) {\n\t\tconst param = this.p.string;\n\t\tif (param.has_expression() && param.expression_controller) {\n\t\t\tawait param.expression_controller.compute_expression_for_objects(core_objects, (core_object, value) => {\n\t\t\t\tcore_object.set_attrib_value(this.pv.name, value);\n\t\t\t});\n\t\t} else {\n\t\t\tfor (let core_object of core_objects) {\n\t\t\t\tcore_object.set_attrib_value(this.pv.name, param.value);\n\t\t\t}\n\t\t}\n\t\t// this.context().set_entity(object);\n\n\t\t// const core_object = new CoreObject(object);\n\n\t\t// this.param('string').eval(val => {\n\t\t// \tcore_object.add_attribute(this.pv.name, val);\n\t\t// });\n\t}\n\n\t//\n\t//\n\t// PRIVATE\n\t//\n\t//\n\n\t// https://stackoverflow.com/questions/24586110/resolve-promises-one-after-another-i-e-in-sequence\n\t// async _eval_params_for_entities(entities){\n\t// \t// let p = Promise.resolve(); // Q() in q\n\n\t// \tconst param = this._value_param();\n\n\t// \tif (param.has_expression()) {\n\t// \t\t// const iterator = new CoreIterator()\n\t// \t\t// await iterator.start_with_array(entities, (element, index)=>{\n\n\t// \t\t// })\n\t// \t\tfor(let entity of entities){\n\t// \t\t\tawait this._eval_param_for_entity(param, entity);\n\t// \t\t}\n\n\t// \t\t// entities.forEach((entity, index)=> {\n\t// \t\t// \tp = p.then(() => {\n\t// \t\t// \t\treturn this._eval_param_for_entity(param, entity);\n\t// \t\t// \t});\n\t// \t\t// });\n\t// \t} else {\n\t// \t\tconst val = await param.eval_p();\n\t// \t\tfor(let entity of entities){\n\t// \t\t\tthis._values.push(val);\n\t// \t\t}\n\t// \t\t// entities.forEach(entity=> {\n\t// \t\t// \treturn this._values.push(val);\n\t// \t\t// });\n\t// \t}\n\n\t// \t// return p;\n\t// }\n\n\t// async _eval_param_for_entity(value_param, entity){\n\t// \tthis.context().set_entity(entity);\n\n\t// \tlet val = await value_param.eval_p()\n\n\t// \t // TODO: optimize. pass directly to the entity instead\n\t// \tif(val.clone){\n\t// \t\tval = val.clone()\n\t// \t}\n\t// \tthis._values.push(val);\n\t// }\n\n\t// private _default_attrib_value() {\n\t// \treturn DEFAULT_VALUE[this._value_param_name()];\n\t// }\n\n\t// private _value_param_name() {\n\t// \tif (this.pv.type == CoreConstant.ATTRIB_TYPE.NUMERIC) {\n\t// \t\tif (this.pv.size == 1) {\n\t// \t\t\treturn VALUE_PARAM.VALUEX;\n\t// \t\t} else {\n\t// \t\t\treturn VALUE_PARAM.VALUE;\n\t// \t\t}\n\t// \t} else {\n\t// \t\treturn VALUE_PARAM.STRING;\n\t// \t}\n\t// }\n\t// private _value_param() {\n\t// \treturn this.params.get(this._value_param_name());\n\t// }\n\n\tprivate _init_array_if_required(\n\t\tgeometry: BufferGeometry,\n\t\tarrays_by_geometry_uuid: ValueArrayByName,\n\t\tpoints_count: number\n\t) {\n\t\tconst uuid = geometry.uuid;\n\t\tconst current_array = arrays_by_geometry_uuid[uuid];\n\t\tif (current_array) {\n\t\t\t// only create new array if we need more point, or as soon as the length is different?\n\t\t\tif (current_array.length < points_count) {\n\t\t\t\tarrays_by_geometry_uuid[uuid] = new Array(points_count);\n\t\t\t}\n\t\t} else {\n\t\t\tarrays_by_geometry_uuid[uuid] = new Array(points_count);\n\t\t}\n\t\treturn arrays_by_geometry_uuid[uuid];\n\t}\n\n\t// private _commit_tmp_values(tmp_array: number[], target_array: number[], offset: number) {\n\t// \tfor (let i = 0; i < tmp_array.length; i++) {\n\t// \t\ttarget_array[i * 3 + offset] = tmp_array[i];\n\t// \t}\n\t// }\n}\n","import {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CoreObject} from 'src/core/geometry/Object';\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {AttribClassMenuEntries, AttribClass} from 'src/core/geometry/Constant';\n\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Mesh} from 'three/src/objects/Mesh';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass AttribDeleteSopParamsConfig extends NodeParamsConfig {\n\tclass = ParamConfig.INTEGER(AttribClass.VERTEX, {\n\t\tmenu: {\n\t\t\tentries: AttribClassMenuEntries,\n\t\t},\n\t});\n\tname = ParamConfig.STRING('');\n}\nconst ParamsConfig = new AttribDeleteSopParamsConfig();\n\nexport class AttribDeleteSopNode extends TypedSopNode<AttribDeleteSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_delete';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to delete attributes from'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tconst attrib_names = core_group.attrib_names_matching_mask(this.pv.name);\n\n\t\tfor (let attrib_name of attrib_names) {\n\t\t\tswitch (this.pv.class) {\n\t\t\t\tcase AttribClass.VERTEX:\n\t\t\t\t\tthis.delete_vertex_attribute(core_group, attrib_name);\n\t\t\t\tcase AttribClass.OBJECT:\n\t\t\t\t\tthis.delete_object_attribute(core_group, attrib_name);\n\t\t\t}\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n\n\tdelete_vertex_attribute(core_group: CoreGroup, attrib_name: string) {\n\t\tfor (let object of core_group.objects()) {\n\t\t\tobject.traverse((object3d: Object3D) => {\n\t\t\t\tconst child = object3d as Mesh;\n\t\t\t\tif (child.geometry) {\n\t\t\t\t\tconst core_geometry = new CoreGeometry(child.geometry as BufferGeometry);\n\t\t\t\t\tcore_geometry.delete_attribute(attrib_name);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\tdelete_object_attribute(core_group: CoreGroup, attrib_name: string) {\n\t\tfor (let object of core_group.objects()) {\n\t\t\tlet index = 0;\n\t\t\tobject.traverse((object3d: Object3D) => {\n\t\t\t\tconst child = object3d as Mesh;\n\t\t\t\tconst core_object = new CoreObject(child, index);\n\t\t\t\tcore_object.delete_attribute(attrib_name);\n\t\t\t\tindex++;\n\t\t\t});\n\t\t}\n\t}\n}\n","import {TypedSopNode} from './_Base';\nimport {Vector3} from 'three/src/math/Vector3';\nimport lodash_max from 'lodash/max';\nimport lodash_min from 'lodash/min';\nimport lodash_isNumber from 'lodash/isNumber';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass AttribNormalizeSopParamsConfig extends NodeParamsConfig {\n\tname = ParamConfig.STRING('');\n\tchange_name = ParamConfig.BOOLEAN(false);\n\tnew_name = ParamConfig.STRING('', {visible_if: {change_name: 1}});\n}\nconst ParamsConfig = new AttribNormalizeSopParamsConfig();\n\nexport class AttribNormalizeSopNode extends TypedSopNode<AttribNormalizeSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_normalize';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tthis._normalize_attribute(core_group);\n\t\tthis.set_core_group(core_group);\n\t}\n\n\t_normalize_attribute(core_group: CoreGroup) {\n\t\tconst points = core_group.points();\n\t\tif (points.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.pv.name === '') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst attrib_size = points[0].attrib_size(this.pv.name);\n\t\tconst values = points.map((point) => point.attrib_value(this.pv.name));\n\t\tlet normalized_values: NumericAttribValue[] = [];\n\t\tlet min: NumericAttribValue, max: NumericAttribValue;\n\t\tswitch (attrib_size) {\n\t\t\tcase 1:\n\t\t\t\t// if (this._param_only_integer_values) {\n\t\t\t\t// \tconst sorted_values = lodash_uniq(lodash_sortBy(values));\n\t\t\t\t// \tconst index_by_value = {};\n\t\t\t\t// \tlodash_each(sorted_values, (sorted_value, i)=> index_by_value[sorted_value] = i);\n\t\t\t\t// \tnormalized_values = lodash_map(values, value=> index_by_value[value]);\n\n\t\t\t\t// } else {\n\t\t\t\tmin = lodash_min(values);\n\t\t\t\tmax = lodash_max(values);\n\t\t\t\t//this._save_min_max(group, min, max)\n\t\t\t\tif (lodash_isNumber(min) && lodash_isNumber(max)) {\n\t\t\t\t\tfor (let value of values) {\n\t\t\t\t\t\tconst normalized_value = max > min ? (value - min) / (max - min) : 1;\n\t\t\t\t\t\tnormalized_values.push(normalized_value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 3:\n\t\t\t\tmin = new Vector3(\n\t\t\t\t\tlodash_min(values.map((v) => v.x)),\n\t\t\t\t\tlodash_min(values.map((v) => v.y)),\n\t\t\t\t\tlodash_min(values.map((v) => v.z))\n\t\t\t\t);\n\t\t\t\tmax = new Vector3(\n\t\t\t\t\tlodash_max(values.map((v) => v.x)),\n\t\t\t\t\tlodash_max(values.map((v) => v.y)),\n\t\t\t\t\tlodash_max(values.map((v) => v.z))\n\t\t\t\t);\n\t\t\t\t//this._save_min_max(group, min, max)\n\t\t\t\tif (min instanceof Vector3 && max instanceof Vector3) {\n\t\t\t\t\tfor (let value of values) {\n\t\t\t\t\t\tconst normalized_value = new Vector3(\n\t\t\t\t\t\t\t(value.x - min.x) / (max.x - min.x),\n\t\t\t\t\t\t\t(value.y - min.y) / (max.y - min.y),\n\t\t\t\t\t\t\t(value.z - min.z) / (max.z - min.z)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tnormalized_values.push(normalized_value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet target_name = this.pv.name;\n\t\tif (this.pv.change_name) {\n\t\t\ttarget_name = this.pv.new_name;\n\t\t\tif (!core_group.has_attrib(target_name)) {\n\t\t\t\tcore_group.add_numeric_vertex_attrib(target_name, attrib_size, 0);\n\t\t\t}\n\t\t}\n\n\t\tnormalized_values.forEach((normalized_value, i) => {\n\t\t\tconst point = points[i];\n\t\t\tpoint.set_attrib_value(target_name, normalized_value);\n\t\t});\n\t}\n}\n\n// TODO: they should be saved as a detail, not per object\n// _save_min_max: (group, min, max)->\n// \tgroup.traverse (object)=>\n// \t\tobject_wrapper = new Core.Geometry.Object(object)\n// \t\tobject_wrapper.add_attribute(\"#{@pv.name}_min\", min)\n// \t\tobject_wrapper.add_attribute(\"#{@pv.name}_max\", max)\n","import lodash_max from 'lodash/max';\nimport lodash_min from 'lodash/min';\n\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {TypedSopNode} from './_Base';\nimport {AttribClass, AttribClassMenuEntries} from 'src/core/geometry/Constant';\nimport {CoreObject} from 'src/core/geometry/Object';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CoreString} from 'src/core/String';\n\nexport enum AttribPromoteMode {\n\tMIN = 0,\n\tMAX = 1,\n\tFIRST_FOUND = 3,\n}\n// const PROMOTE_MODE:PROMOTE_MODE = {\n// \tMIN: 0,\n// \tMAX: 1,\n// \t// AVERAGE: 2,\n// \tFIRST_FOUND: 3,\n// };\nconst PromoteModeMenuEntries = [\n\t{name: 'min', value: AttribPromoteMode.MIN},\n\t{name: 'max', value: AttribPromoteMode.MAX},\n\t{name: 'first_found', value: AttribPromoteMode.FIRST_FOUND},\n];\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass AttribPromoteSopParamsConfig extends NodeParamsConfig {\n\tclass_from = ParamConfig.INTEGER(AttribClass.VERTEX, {\n\t\tmenu: {\n\t\t\tentries: AttribClassMenuEntries,\n\t\t},\n\t});\n\tclass_to = ParamConfig.INTEGER(AttribClass.OBJECT, {\n\t\tmenu: {\n\t\t\tentries: AttribClassMenuEntries,\n\t\t},\n\t});\n\tmode = ParamConfig.INTEGER(AttribPromoteMode.MIN, {\n\t\tmenu: {\n\t\t\tentries: PromoteModeMenuEntries,\n\t\t},\n\t});\n\tname = ParamConfig.STRING('');\n}\nconst ParamsConfig = new AttribPromoteSopParamsConfig();\n\nexport class AttribPromoteSopNode extends TypedSopNode<AttribPromoteSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_promote';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t\t// this.ui_data.set_icon('sort-amount-up');\n\t}\n\n\tcreate_params() {}\n\n\tprivate _core_group: CoreGroup | undefined;\n\tprivate _core_object: CoreObject | undefined;\n\tprivate _values_per_attrib_name: Dictionary<number[]> = {};\n\tprivate _filtered_values_per_attrib_name: Dictionary<number | undefined> = {};\n\tcook(input_contents: CoreGroup[]) {\n\t\tthis._core_group = input_contents[0];\n\n\t\tthis._values_per_attrib_name = {};\n\t\tthis._filtered_values_per_attrib_name = {};\n\n\t\tfor (let core_object of this._core_group.core_objects()) {\n\t\t\tthis._core_object = core_object;\n\t\t\tthis.find_values();\n\t\t\tthis.filter_values();\n\t\t\tthis.set_values();\n\t\t}\n\n\t\t// switch @_param_class_from\n\t\t// \twhen Core.Geometry.ATTRIB_CLASS.VERTEX then this.promote_attribute_from_vertex()\n\t\t// \twhen Core.Geometry.ATTRIB_CLASS.OBJECT then this.promote_attribute_from_object()\n\t\tthis.set_core_group(this._core_group);\n\t}\n\n\t// private promote_attribute_from_vertex() {\n\t// \t// switch (this.pv.class_to) {\n\t// \t// \tcase AttribClass.VERTEX:\n\t// \t\t\treturn this.promote_attribute_from_vertex_to_vertex();\n\t// \t\t// case AttribClass.OBJECT:\n\t// \t\t// return this.promote_attribute_from_vertex_to_object();\n\t// \t// }\n\t// }\n\n\t// private promote_attribute_from_object() {\n\t// \tswitch (this.pv.class_to) {\n\t// \t\tcase AttribClass.VERTEX:\n\t// \t\t// return this.promote_attribute_from_object_to_vertex();\n\t// \t\tcase AttribClass.OBJECT:\n\t// \t\t// return this.promote_attribute_from_object_to_object();\n\t// \t}\n\t// }\n\n\t// private promote_attribute_from_vertex_to_vertex() {\n\t// \tif (this._core_group) {\n\t// \t\tconst attrib_names = CoreString.attrib_names(this.pv.name);\n\t// \t\tconst points = this._core_group.points();\n\t// \t\tfor (let attrib_name of attrib_names) {\n\t// \t\t\tconst values = lodash_map(points, (point) => point.attrib_value(attrib_name));\n\t// \t\t\tconst new_value = (() => {\n\t// \t\t\t\tswitch (this.pv.mode) {\n\t// \t\t\t\t\tcase PromoteMode.MIN:\n\t// \t\t\t\t\t\treturn lodash_min(values);\n\t// \t\t\t\t\tcase PromoteMode.MAX:\n\t// \t\t\t\t\t\treturn lodash_max(values);\n\t// \t\t\t\t\t// case PROMOTE_MODE.AVERAGE: return lodash_average(values);\n\t// \t\t\t\t\tdefault:\n\t// \t\t\t\t\t\treturn null;\n\t// \t\t\t\t}\n\t// \t\t\t})();\n\n\t// \t\t\tif (new_value != null) {\n\t// \t\t\t\tlodash_each(points, (point) => point.set_attrib_value(attrib_name, new_value));\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// }\n\n\tprivate find_values() {\n\t\tconst attrib_names = CoreString.attrib_names(this.pv.name);\n\t\tfor (let attrib_name of attrib_names) {\n\t\t\tswitch (this.pv.class_from) {\n\t\t\t\tcase AttribClass.VERTEX:\n\t\t\t\t\treturn this.find_values_from_points(attrib_name);\n\t\t\t\tcase AttribClass.OBJECT:\n\t\t\t\t\treturn this.find_values_from_object(attrib_name);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate find_values_from_points(attrib_name: string) {\n\t\tif (this._core_object) {\n\t\t\tconst points = this._core_object.points();\n\t\t\tthis._values_per_attrib_name[attrib_name] = points.map((point) => point.attrib_value(attrib_name));\n\t\t}\n\t}\n\n\tprivate find_values_from_object(attrib_name: string) {\n\t\tthis._values_per_attrib_name[attrib_name] = [];\n\t\tif (this._core_object) {\n\t\t\tthis._values_per_attrib_name[attrib_name].push(this._core_object.attrib_value(attrib_name) as number);\n\t\t}\n\t}\n\n\tprivate filter_values() {\n\t\tconst attrib_names = Object.keys(this._values_per_attrib_name);\n\t\tfor (let attrib_name of attrib_names) {\n\t\t\tconst values = this._values_per_attrib_name[attrib_name];\n\t\t\tswitch (this.pv.mode) {\n\t\t\t\tcase AttribPromoteMode.MIN:\n\t\t\t\t\tthis._filtered_values_per_attrib_name[attrib_name] = lodash_min(values);\n\t\t\t\t\tbreak;\n\t\t\t\tcase AttribPromoteMode.MAX:\n\t\t\t\t\tthis._filtered_values_per_attrib_name[attrib_name] = lodash_max(values);\n\t\t\t\t\tbreak;\n\t\t\t\t// case PROMOTE_MODE.AVERAGE: return lodash_average(values);\n\t\t\t\tcase AttribPromoteMode.FIRST_FOUND:\n\t\t\t\t\tthis._filtered_values_per_attrib_name[attrib_name] = values[0];\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate set_values() {\n\t\tconst attrib_names = Object.keys(this._filtered_values_per_attrib_name);\n\t\tfor (let attrib_name of attrib_names) {\n\t\t\tconst new_value = this._filtered_values_per_attrib_name[attrib_name];\n\t\t\tif (new_value != null) {\n\t\t\t\tswitch (this.pv.class_to) {\n\t\t\t\t\tcase AttribClass.VERTEX:\n\t\t\t\t\t\tthis.set_values_to_points(attrib_name, new_value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AttribClass.OBJECT:\n\t\t\t\t\t\tthis.set_values_to_object(attrib_name, new_value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate set_values_to_points(attrib_name: string, new_value: NumericAttribValue) {\n\t\tif (this._core_group && this._core_object) {\n\t\t\tconst attribute_exists = this._core_group.has_attrib(attrib_name);\n\t\t\tif (!attribute_exists) {\n\t\t\t\tconst param_size = 1; // TODO: allow size with larger params\n\t\t\t\tthis._core_group.add_numeric_vertex_attrib(attrib_name, param_size, new_value);\n\t\t\t}\n\n\t\t\tconst points = this._core_object.points();\n\t\t\tpoints.forEach((point) => point.set_attrib_value(attrib_name, new_value));\n\t\t}\n\t}\n\n\tprivate set_values_to_object(attrib_name: string, new_value: NumericAttribValue) {\n\t\tthis._core_object?.set_attrib_value(attrib_name, new_value);\n\t}\n}\n","import lodash_max from 'lodash/max';\nimport lodash_min from 'lodash/min';\nimport lodash_sortBy from 'lodash/sortBy';\nimport lodash_uniq from 'lodash/uniq';\nimport lodash_isNumber from 'lodash/isNumber';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass AttribRemapSopParamsConfig extends NodeParamsConfig {\n\tname = ParamConfig.STRING();\n\tramp = ParamConfig.RAMP();\n\tchange_name = ParamConfig.BOOLEAN(0);\n\tnew_name = ParamConfig.STRING('', {visible_if: {change_name: 1}});\n}\nconst ParamsConfig = new AttribRemapSopParamsConfig();\n\nexport class AttribRemapSopNode extends TypedSopNode<AttribRemapSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_remap';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tthis._remap_attribute(core_group);\n\t\tthis.set_core_group(core_group);\n\t}\n\n\t_remap_attribute(core_group: CoreGroup) {\n\t\tconst points = core_group.points();\n\t\tif (points.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.pv.name === '') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst attrib_size = points[0].attrib_size(this.pv.name);\n\t\tconst values = points.map((point) => point.attrib_value(this.pv.name));\n\t\tlet min: NumericAttribValue, max: NumericAttribValue;\n\t\tlet normalized_values: NumericAttribValue[] = new Array(points.length);\n\t\tswitch (attrib_size) {\n\t\t\tcase 1:\n\t\t\t\tif (this.pv.only_integer_values) {\n\t\t\t\t\tconst sorted_values = lodash_uniq(lodash_sortBy(values));\n\t\t\t\t\tconst index_by_value: Dictionary<number> = {};\n\t\t\t\t\tsorted_values.forEach((sorted_value, i) => (index_by_value[sorted_value] = i));\n\t\t\t\t\tnormalized_values = values.map((value) => index_by_value[value]);\n\t\t\t\t} else {\n\t\t\t\t\tmin = lodash_min(values);\n\t\t\t\t\tmax = lodash_max(values);\n\t\t\t\t\t//this._save_min_max(group, min, max)\n\t\t\t\t\tif (lodash_isNumber(min) && lodash_isNumber(max)) {\n\t\t\t\t\t\tfor (let i = 0; i < values.length; i++) {\n\t\t\t\t\t\t\tconst value = values[i];\n\t\t\t\t\t\t\tconst normalized_value = max > min ? (value - min) / (max - min) : 1;\n\t\t\t\t\t\t\tnormalized_values[i] = normalized_value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 3:\n\t\t\t\tmin = new Vector3(\n\t\t\t\t\tlodash_min(values.map((v) => v.x)),\n\t\t\t\t\tlodash_min(values.map((v) => v.y)),\n\t\t\t\t\tlodash_min(values.map((v) => v.z))\n\t\t\t\t);\n\t\t\t\tmax = new Vector3(\n\t\t\t\t\tlodash_max(values.map((v) => v.x)),\n\t\t\t\t\tlodash_max(values.map((v) => v.y)),\n\t\t\t\t\tlodash_max(values.map((v) => v.z))\n\t\t\t\t);\n\t\t\t\t//this._save_min_max(group, min, max)\n\t\t\t\tif (min instanceof Vector3 && max instanceof Vector3) {\n\t\t\t\t\tfor (let i = 0; i < values.length; i++) {\n\t\t\t\t\t\tconst value = values[i];\n\t\t\t\t\t\tconst normalized_value = new Vector3(\n\t\t\t\t\t\t\t(value.x - min.x) / (max.x - min.x),\n\t\t\t\t\t\t\t(value.y - min.y) / (max.y - min.y),\n\t\t\t\t\t\t\t(value.z - min.z) / (max.z - min.z)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tnormalized_values[i] = normalized_value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet target_name = this.pv.name;\n\t\tif (this.pv.change_name) {\n\t\t\ttarget_name = this.pv.new_name;\n\t\t\tif (!core_group.has_attrib(target_name)) {\n\t\t\t\tcore_group.add_numeric_vertex_attrib(target_name, attrib_size, 0);\n\t\t\t}\n\t\t}\n\n\t\tnormalized_values.forEach((normalized_value, i) => {\n\t\t\tconst point = points[i];\n\t\t\tpoint.set_attrib_value(target_name, normalized_value);\n\t\t});\n\t}\n}\n\n// TODO: they should be saved as a detail, not per object\n// _save_min_max: (group, min, max)->\n// \tgroup.traverse (object)=>\n// \t\tobject_wrapper = new Core.Geometry.Object(object)\n// \t\tobject_wrapper.add_attribute(\"#{@_param_name}_min\", min)\n// \t\tobject_wrapper.add_attribute(\"#{@_param_name}_max\", max)\n","import {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {AttribClassMenuEntries, AttribClass} from 'src/core/geometry/Constant';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nclass AttribRenameSopParamsConfig extends NodeParamsConfig {\n\tclass = ParamConfig.INTEGER(AttribClass.VERTEX, {\n\t\tmenu: {\n\t\t\tentries: AttribClassMenuEntries,\n\t\t},\n\t});\n\told_name = ParamConfig.STRING();\n\tnew_name = ParamConfig.STRING();\n}\nconst ParamsConfig = new AttribRenameSopParamsConfig();\n\nexport class AttribRenameSopNode extends TypedSopNode<AttribRenameSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_rename';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\t// const group = input_containers[0].group();\n\t\tconst core_group = input_contents[0];\n\n\t\tcore_group.rename_attrib(this.pv.old_name, this.pv.new_name, this.pv.class);\n\n\t\tthis.set_core_group(core_group);\n\t}\n}\n","import {TypedSopNode} from './_Base';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {CoreGroup} from 'src/core/geometry/Group';\n// import {CoreMath} from 'src/core/math/_Module';\nimport {CoreInterpolate} from 'src/core/math/Interpolate';\nimport {CoreOctree} from 'src/core/math/octree/Octree';\nimport {CoreIterator} from 'src/core/Iterator';\n// import lodash_sum from 'lodash/sum';\n\n// enum TransferMethod {\n// \tAUTO = 0,\n// \tARTISTIC = 1,\n// }\n// const TransferMethodMenuEntries = [\n// \t{name: 'auto', value: TransferMethod.AUTO},\n// \t{name: 'artistic', value: TransferMethod.ARTISTIC},\n// ];\n\n// const LATITUDE = 'Latitude'\n// const LONGITUDE = 'Longitude'\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nclass AttribTransferSopParamsConfig extends NodeParamsConfig {\n\tsrc_group = ParamConfig.STRING();\n\tdest_group = ParamConfig.STRING();\n\tname = ParamConfig.STRING();\n\tmax_samples_count = ParamConfig.INTEGER(1, {\n\t\trange: [1, 10],\n\t\trange_locked: [true, false],\n\t});\n\t// method = ParamConfig.INTEGER(TransferMethod.AUTO, {\n\t// \tmenu: {\n\t// \t\tentries: TransferMethodMenuEntries,\n\t// \t},\n\t// });\n\tdistance_threshold = ParamConfig.FLOAT(1);\n\tblend_width = ParamConfig.FLOAT(0);\n}\nconst ParamsConfig = new AttribTransferSopParamsConfig();\n\nexport class AttribTransferSopNode extends TypedSopNode<AttribTransferSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'attrib_transfer';\n\t}\n\n\t_core_group_dest!: CoreGroup;\n\t_core_group_src!: CoreGroup;\n\n\t// utils\n\t_attrib_names!: string[];\n\t_octree_timestamp: number | undefined;\n\t_prev_param_src_group: string | undefined;\n\t_octree: CoreOctree | undefined;\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to transfer attributes to', 'geometry to transfer attributes from'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(2);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE, InputCloneMode.NEVER]);\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\t// this._group_dest = input_containers[0].group();\n\t\t// const container1 = input_containers[1];\n\n\t\tthis._core_group_dest = input_contents[0]; //new CoreGroup(this._group_dest);\n\t\tconst dest_points = this._core_group_dest.points_from_group(this.pv.dest_group);\n\n\t\t// this._group_src = input_containers[1] //container1.group({ clone: false });\n\t\tthis._core_group_src = input_contents[1]; //new CoreGroup(this._group_src);\n\n\t\tthis._attrib_names = this._core_group_src.attrib_names_matching_mask(this.pv.name);\n\t\tthis._error_if_attribute_not_found_on_second_input();\n\t\tthis._build_octree_if_required(this._core_group_src);\n\t\tthis._add_attribute_if_required();\n\n\t\tawait this._transfer_attributes(dest_points);\n\t\tthis.set_core_group(this._core_group_dest);\n\t}\n\n\t_error_if_attribute_not_found_on_second_input() {\n\t\tfor (let attrib_name of this._attrib_names) {\n\t\t\tif (!this._core_group_src.has_attrib(attrib_name)) {\n\t\t\t\tthis.states.error.set(`attribute '${attrib_name}' not found on second input`);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _build_octree_if_required(core_group: CoreGroup) {\n\t\tconst second_input_changed =\n\t\t\tthis._octree_timestamp == null || this._octree_timestamp !== core_group.timestamp();\n\t\tconst src_group_changed = this._prev_param_src_group !== this.pv.src_group;\n\n\t\tif (src_group_changed || second_input_changed) {\n\t\t\tthis._octree_timestamp = core_group.timestamp();\n\t\t\tthis._prev_param_src_group = this.pv.src_group;\n\n\t\t\tconst points_src = this._core_group_src.points_from_group(this.pv.src_group);\n\n\t\t\tthis._octree = new CoreOctree(this._core_group_src.bounding_box());\n\t\t\tthis._octree.set_points(points_src);\n\t\t}\n\t}\n\n\tprivate _add_attribute_if_required() {\n\t\tthis._attrib_names.forEach((attrib_name) => {\n\t\t\tif (!this._core_group_dest.has_attrib(attrib_name)) {\n\t\t\t\tconst attrib_size = this._core_group_src.attrib_size(attrib_name);\n\t\t\t\tthis._core_group_dest.add_numeric_vertex_attrib(attrib_name, attrib_size, 0);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async _transfer_attributes(dest_points: CorePoint[]) {\n\t\t// const start_time = performance.now()\n\t\tconst iterator = new CoreIterator();\n\t\tawait iterator.start_with_array(dest_points, this._transfer_attributes_for_point.bind(this));\n\t\t// for(let dest_point of dest_points){\n\n\t\t// \tthis._transfer_attributes_for_point(dest_point)\n\n\t\t// }\n\t}\n\tprivate _transfer_attributes_for_point(dest_point: CorePoint) {\n\t\tconst total_dist = this.pv.distance_threshold + this.pv.blend_width;\n\t\tconst nearest_points: CorePoint[] =\n\t\t\tthis._octree?.find_points(dest_point.position(), total_dist, this.pv.max_samples_count) || [];\n\n\t\t// test[nearest_points.length] = test[nearest_points.length] || 0\n\t\t// test[nearest_points.length] += 1\n\n\t\tfor (let attrib_name of this._attrib_names) {\n\t\t\tthis._interpolate_points(dest_point, nearest_points, attrib_name);\n\t\t}\n\t}\n\n\t// if @_param_draw_connections\n\t// \tlodash_each nearest_points, (nearest_point)=>\n\t// \t\t@_connection_point_pairs.push([ nearest_point.position(), dest_point.position() ])\n\n\t// if @_param_draw_connections\n\t// \tthis._draw_connections()\n\n\tprivate _interpolate_points(point_dest: CorePoint, src_points: CorePoint[], attrib_name: string) {\n\t\tlet new_value: number;\n\t\t// if (this.pv.method == TransferMethod.ARTISTIC) {\n\n\t\tnew_value = CoreInterpolate.perform(\n\t\t\tpoint_dest,\n\t\t\tsrc_points,\n\t\t\tattrib_name,\n\t\t\tthis.pv.distance_threshold,\n\t\t\tthis.pv.blend_width\n\t\t);\n\t\t// } else {\n\t\t// \tnew_value = this._select(point_dest, src_points, attrib_name);\n\t\t// \tconsole.log('B new_value', new_value);\n\t\t// }\n\n\t\tif (new_value != null) {\n\t\t\tpoint_dest.set_attrib_value(attrib_name, new_value);\n\t\t}\n\t}\n\n\t// private _select(point_dest: CorePoint, src_points: CorePoint[], attrib_name: string) {\n\t// \tconst src_values = [];\n\t// \tconst inverse_distances = [];\n\t// \tconst dest_position = point_dest.position();\n\t// \tconst dest_lng_lat = {lng: dest_position.x, lat: dest_position.z};\n\t// \tfor (let src_point of src_points) {\n\t// \t\t// const dist = dest_position.distanceTo(src_point.position()) //* 0.1\n\t// \t\tconst src_position = src_point.position();\n\t// \t\tconst src_lng_lat = {lng: src_position.x, lat: src_position.z};\n\t// \t\tconst dist = CoreMath.geodesic_distance(src_lng_lat, dest_lng_lat);\n\t// \t\tconst dist_squared = dist * dist;\n\t// \t\tconst attrib_value = src_point.attrib_value(attrib_name);\n\n\t// \t\tsrc_values.push(attrib_value / dist_squared);\n\t// \t\tinverse_distances.push(1 / dist_squared);\n\t// \t}\n\n\t// \tconst sum = lodash_sum(src_values) / lodash_sum(inverse_distances);\n\t// \treturn sum;\n\t// }\n\n\t// ROUND(\n\n\t// \tSUM(\n\t// \t\tValue\n\t// \t\t/\n\t// \t\t(dist_meters*dist_meters)\n\t// \t\t)\n\t// \t/\n\t// \tSUM(\n\t// \t\t1\n\t// \t\t/\n\t// \t\t(dist_meters*dist_meters)\n\t// \t\t)\n\n\t// \t,1\n\n\t// )\n\n\t// _draw_connections() {\n\t// \tlet positions = [];\n\t// \tconst indices = [];\n\n\t// \tlodash_each(this._connection_point_pairs, function(current_positions, i) {\n\n\t// \t\tpositions.push(current_positions[0].toArray());\n\t// \t\tpositions.push(current_positions[1].toArray());\n\n\t// \t\tindices.push((2 * i) + 0);\n\t// \t\treturn indices.push((2 * i) + 1);\n\t// \t});\n\n\t// \tpositions = lodash_flatten(positions);\n\t// \tconst geometry = new THREE.BufferGeometry();\n\t// \tgeometry.setAttribute( 'position', new THREE.Float32BufferAttribute( positions, 3 ) );\n\t// \tgeometry.setIndex(indices);\n\t// \tconst object = this.create_object(geometry, Core.Geometry.Constant.OBJECT_TYPE.LINE_SEGMENTS);\n\t// \treturn this._group_dest.add(object);\n\t// }\n}\n","import lodash_max from 'lodash/max';\n// import lodash_last from 'lodash/last'\nimport lodash_sum from 'lodash/sum';\n\nimport {Vector3} from 'three/src/math/Vector3';\n// import {Vector2} from 'three/src/math/Vector2';\nimport {_Math} from 'three/src/math/Math';\n// const THREE = {Math: _Math, Vector2, Vector3}\nimport {CorePoint} from 'src/core/geometry/Point';\n\nexport class CoreInterpolate {\n\tstatic perform(\n\t\tpoint_dest: CorePoint,\n\t\tpoints_src: CorePoint[],\n\t\tattrib_name: string,\n\t\tdistance_threshold: number,\n\t\tblend_with: number\n\t): number {\n\t\tswitch (points_src.length) {\n\t\t\tcase 0:\n\t\t\t\treturn 0;\n\t\t\tcase 1:\n\t\t\t\treturn this._interpolate_with_1_point(\n\t\t\t\t\tpoint_dest,\n\t\t\t\t\tpoints_src[0],\n\t\t\t\t\tattrib_name,\n\t\t\t\t\tdistance_threshold,\n\t\t\t\t\tblend_with\n\t\t\t\t);\n\t\t\tdefault:\n\t\t\t\t// positions_src = lodash_map(points_src, (point) -> point.position())\n\t\t\t\t// values_src = lodash_map(points_src, (point) -> point.attrib_value(attrib_name))\n\t\t\t\t// position_dest = point_dest.position()\n\t\t\t\t//if positions_src.length > 3\n\t\t\t\t//\tpositions_src = positions_src.slice(0,3)\n\t\t\t\t//this._interpolate_with_3_points_max(positions_src, values_src, position_dest, dest_value)\n\t\t\t\treturn this._interpolate_with_multiple_points(\n\t\t\t\t\tpoint_dest,\n\t\t\t\t\tpoints_src,\n\t\t\t\t\tattrib_name,\n\t\t\t\t\tdistance_threshold,\n\t\t\t\t\tblend_with\n\t\t\t\t);\n\t\t}\n\t}\n\n\tstatic _interpolate_with_1_point(\n\t\tpoint_dest: CorePoint,\n\t\tpoint_src: CorePoint,\n\t\tattrib_name: string,\n\t\tdistance_threshold: number,\n\t\tblend_with: number\n\t): number {\n\t\tconst position_dest = point_dest.position();\n\t\tconst position_src = point_src.position();\n\t\tconst distance = position_dest.distanceTo(position_src);\n\n\t\tconst value_src = point_src.attrib_value(attrib_name);\n\t\treturn this._weighted_value_from_distance(\n\t\t\tpoint_dest,\n\t\t\tvalue_src,\n\t\t\tattrib_name,\n\t\t\tdistance,\n\t\t\tdistance_threshold,\n\t\t\tblend_with\n\t\t);\n\t}\n\n\tstatic _weight_from_distance(distance: number, distance_threshold: number, blend_with: number) {\n\t\treturn (distance - distance_threshold) / blend_with;\n\t}\n\n\tstatic _weighted_value_from_distance(\n\t\tpoint_dest: CorePoint,\n\t\tvalue_src: number,\n\t\tattrib_name: string,\n\t\tdistance: number,\n\t\tdistance_threshold: number,\n\t\tblend_with: number\n\t): number {\n\t\tif (distance <= distance_threshold) {\n\t\t\treturn value_src;\n\t\t} else {\n\t\t\tconst value_dest = point_dest.attrib_value(attrib_name);\n\t\t\tconst blend = this._weight_from_distance(distance, distance_threshold, blend_with);\n\t\t\treturn blend * value_dest + (1 - blend) * value_src;\n\t\t\t// switch (point_dest.attrib_size(attrib_name)) {\n\t\t\t// \tcase 1:\n\t\t\t// \t\t// const value_src_as_number = value_src as number;\n\t\t\t// \t\treturn blend * value_dest + (1 - blend) * value_src;\n\t\t\t// \tcase 2:\n\t\t\t// \t\tconst value_src_as_vec2 = value_src as Vector2Like;\n\t\t\t// \t\treturn new Vector2(\n\t\t\t// \t\t\tblend * value_dest.x + (1 - blend) * value_src_as_vec2.x,\n\t\t\t// \t\t\tblend * value_dest.y + (1 - blend) * value_src_as_vec2.y\n\t\t\t// \t\t);\n\t\t\t// \tcase 3:\n\t\t\t// \t\tconst value_src_as_vec3 = value_src as Vector3Like;\n\t\t\t// \t\treturn new Vector3(\n\t\t\t// \t\t\tblend * value_dest.x + (1 - blend) * value_src_as_vec3.x,\n\t\t\t// \t\t\tblend * value_dest.y + (1 - blend) * value_src_as_vec3.y,\n\t\t\t// \t\t\tblend * value_dest.z + (1 - blend) * value_src_as_vec3.z\n\t\t\t// \t\t);\n\t\t\t// \tdefault:\n\t\t\t// \t\treturn 0;\n\t\t\t// }\n\t\t}\n\t}\n\n\t// @_interpolate_with_3_points_max: (positions_src, values_src, position_dest, dest_value)->\n\t// \tweights = this.weights( position_dest, positions_src )\n\t// \tinterpolated_value = lodash_sum lodash_map values_src, (src_value, i)=>\n\t// \t\tweights[i] * src_value\n\n\t// \tif dest_value?\n\t// \t\t0.5 * (dest_value + src_value)\n\t// \telse\n\t// \t\tinterpolated_value\n\n\t// weights: http://www.sidefx.com/docs/houdini/nodes/vop/pcfilter.html\n\t// w_i = 1-smooth(0, maxd*1.1, d_i);\n\t// maxd is the farthest point, and w_i is the weight for a given point at distance (d_i). Points that are closer to the center will be weighted higher with that formula, rather than it being an average.\n\tstatic _interpolate_with_multiple_points(\n\t\tpoint_dest: CorePoint,\n\t\tpoints_src: CorePoint[],\n\t\tattrib_name: string,\n\t\tdistance_threshold: number,\n\t\tblend_with: number\n\t): number {\n\t\t// let new_value\n\t\t// const positions_src = lodash_map(points_src, (point) =>\n\t\t// \tpoint.position()\n\t\t// )\n\t\t// const values_src = lodash_map(points_src, (point) =>\n\t\t// \tpoint.attrib_value(attrib_name)\n\t\t// )\n\t\t// const position_dest = point_dest.position()\n\t\t// const attrib_size = point_dest.attrib_size(attrib_name);\n\n\t\t// const distances = lodash_map(positions_src, (src_position) =>\n\t\t// \tsrc_position.distanceTo(position_dest)\n\t\t// )\n\t\t// distances = distances.sort()\n\t\t// max_dist = lodash_last(distances)\n\t\t// const max_dist = distance_threshold + blend_with\n\n\t\t// const weights = lodash_map(positions_src, (src_position, i) => {\n\t\t// \tconst distance = distances[i]\n\t\t// \t//1 - Math.smootherstep(distance, 0, max_dist*1.1)\n\t\t// \treturn this._weight_from_distance(\n\t\t// \t\tdistance,\n\t\t// \t\tdistance_threshold,\n\t\t// \t\tblend_with\n\t\t// \t)\n\t\t// })\n\n\t\t// const total_weight = lodash_sum(weights)\n\n\t\t// weighted_values = lodash_map values_src, (src_value, i)->\n\t\t// \tswitch attrib_size\n\t\t// \t\twhen 1 then src_value * weights[i]\n\t\t// \t\telse\n\t\t// \t\t\tsrc_value.clone().multiplyScalar(weights[i])\n\t\tconst weighted_values_src = points_src.map((point_src) => {\n\t\t\treturn this._interpolate_with_1_point(point_dest, point_src, attrib_name, distance_threshold, blend_with);\n\t\t});\n\t\treturn lodash_max(weighted_values_src) || 0;\n\n\t\t// // TODO: we could have 2 modes of interpolation?\n\t\t// // return (new_value = (() => {\n\t\t// switch (attrib_size) {\n\t\t// \t// when 1 then lodash_sum(weighted_values_src) / values_src.length # mode 1\n\t\t// \tcase 1:\n\t\t// \t\treturn lodash_max(weighted_values_src); // mode 2\n\t\t// \tdefault:\n\t\t// \t\tthrow 'interpolation with multiple vectors not implemented yet';\n\t\t// \t// var new_vector = weighted_values_src[0].clone();\n\t\t// \t// new_vector.x = lodash_sum(lodash_map(weighted_values, 'x')) / total_weight;\n\t\t// \t// new_vector.y = lodash_sum(lodash_map(weighted_values, 'y')) / total_weight;\n\t\t// \t// if (new_vector.z != null) {\n\t\t// \t// \tnew_vector.z = lodash_sum(lodash_map(weighted_values, 'z')) / total_weight;\n\t\t// \t// }\n\t\t// \t// return new_vector;\n\t\t// }\n\t\t// })())\n\t}\n\n\t// https://math.stackexchange.com/questions/1336386/weighted-average-distance-between-3-or-more-positions\n\tstatic weights(current_position: Vector3, other_positions: Vector3[]) {\n\t\tswitch (other_positions.length) {\n\t\t\tcase 1:\n\t\t\t\treturn 1;\n\t\t\tcase 2:\n\t\t\t\treturn this._weights_from_2(current_position, other_positions);\n\t\t\tdefault:\n\t\t\t\tother_positions = other_positions.slice(0, 3);\n\t\t\t\treturn this._weights_from_3(current_position, other_positions);\n\t\t}\n\t}\n\n\tstatic _weights_from_2(current_position: Vector3, other_positions: Vector3[]) {\n\t\tconst dist_to_positions = other_positions.map((other_position) => current_position.distanceTo(other_position));\n\n\t\tconst distance_total = lodash_sum(dist_to_positions);\n\n\t\treturn [dist_to_positions[1] / distance_total, dist_to_positions[0] / distance_total];\n\t}\n\n\tstatic _weights_from_3(current_position: Vector3, other_positions: Vector3[]) {\n\t\tconst dist_to_positions = other_positions.map((other_position) => current_position.distanceTo(other_position));\n\n\t\tconst distance_total = lodash_sum([\n\t\t\tdist_to_positions[0] * dist_to_positions[1],\n\t\t\tdist_to_positions[0] * dist_to_positions[2],\n\t\t\tdist_to_positions[1] * dist_to_positions[2],\n\t\t]);\n\n\t\treturn [\n\t\t\t(dist_to_positions[1] * dist_to_positions[2]) / distance_total,\n\t\t\t(dist_to_positions[0] * dist_to_positions[2]) / distance_total,\n\t\t\t(dist_to_positions[0] * dist_to_positions[1]) / distance_total,\n\t\t];\n\t}\n}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Sphere} from 'three/src/math/Sphere';\nimport {Box3} from 'three/src/math/Box3';\nimport lodash_sortBy from 'lodash/sortBy';\nimport {CorePoint} from 'src/core/geometry/Point';\n// import {CoreMath} from './_Module'\n// import OctreeModule from './Octree/_Module';\nimport {OctreeNode, OctreeNodeTraverseCallback} from './Node';\n\nexport class CoreOctree {\n\tprivate _root: OctreeNode;\n\n\tconstructor(bbox: Box3) {\n\t\tthis._root = new OctreeNode(bbox);\n\t}\n\n\t// set_bounding_box(bbox: Box3) {\n\t// \tthis._root.set_bounding_box(bbox)\n\t// }\n\n\tset_points(points: CorePoint[]) {\n\t\tthis._root.set_points(points);\n\t}\n\n\ttraverse(callback: OctreeNodeTraverseCallback) {\n\t\tthis._root.traverse(callback);\n\t}\n\n\t// TODO: I am tempted to stop going through the leaves if\n\t// the ones currently seen already have the required number of points.\n\t// but that probably doesn't work as those points may end up being further\n\t// than the ones from the following leaf\n\tfind_points(position: Vector3, distance: number, max_points_count?: number): CorePoint[] {\n\t\tconst sphere = new Sphere(position, distance);\n\t\tlet found_points: CorePoint[] = [];\n\n\t\tif (this._root.intersects_sphere(sphere)) {\n\t\t\tthis._root.points_in_sphere(sphere, found_points);\n\t\t}\n\n\t\tif (max_points_count == null) {\n\t\t\treturn found_points;\n\t\t} else {\n\t\t\tif (found_points.length > max_points_count) {\n\t\t\t\tfound_points = lodash_sortBy(found_points, (point) => {\n\t\t\t\t\treturn point.position().distanceTo(position);\n\t\t\t\t});\n\t\t\t\t// const lng_lat = {lng: position.x, lat: position.z}\n\t\t\t\t// found_points = lodash_sortBy(found_points, (point)=>{\n\t\t\t\t// \tconst src_position = point.position()\n\t\t\t\t// \tconst src_lng_lat = {lng: src_position.x, lat: src_position.z}\n\t\t\t\t// \treturn CoreMath.geodesic_distance(src_lng_lat, lng_lat)\n\t\t\t\t// });\n\n\t\t\t\tfound_points = found_points.slice(0, max_points_count);\n\t\t\t}\n\n\t\t\treturn found_points;\n\t\t}\n\t}\n}\n\n// Octree.Node = OctreeNode;\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Sphere} from 'three/src/math/Sphere';\nimport {Box3} from 'three/src/math/Box3';\nimport lodash_flatten from 'lodash/flatten';\nimport {CorePoint} from 'src/core/geometry/Point';\n\nexport type OctreeNodeTraverseCallback = (node: OctreeNode) => void;\n\nexport class OctreeNode {\n\t_leaves_by_octant: Dictionary<OctreeNode> = {};\n\t_points_by_octant_id: Dictionary<CorePoint[]> = {};\n\t_leaves: OctreeNode[] = [];\n\t// _bbox: Box3 | undefined;\n\t_center: Vector3;\n\t_bounding_boxes_by_octant: Dictionary<Box3> = {};\n\t_bounding_boxes_by_octant_prepared: boolean = false;\n\n\tconstructor(private _bbox: Box3, private _level: number = 0) {\n\t\tthis._center = this._bbox.max\n\t\t\t.clone()\n\t\t\t.add(this._bbox.min)\n\t\t\t.multiplyScalar(0.5);\n\t}\n\t// set_bounding_box(bbox: Box3) {\n\t// \tthis._bbox = bbox;\n\t// }\n\n\tlevel() {\n\t\treturn this._level;\n\t}\n\n\ttraverse(callback: OctreeNodeTraverseCallback) {\n\t\tcallback(this);\n\t\tconst octants = Object.values(this._leaves_by_octant);\n\t\toctants.forEach((node) => {\n\t\t\tnode.traverse(callback);\n\t\t});\n\t}\n\n\tintersects_sphere(sphere: Sphere): boolean {\n\t\tif (this._bbox) {\n\t\t\treturn this._bbox.intersectsSphere(sphere);\n\t\t}\n\t\treturn false;\n\t}\n\n\t//@PERF = 0\n\tpoints_in_sphere(sphere: Sphere, accumulated_points: CorePoint[]): void {\n\t\tif (this._leaves.length == 0) {\n\t\t\tconst found_points = lodash_flatten(Object.values(this._points_by_octant_id));\n\t\t\tconst selected_points = found_points.filter((point) => sphere.containsPoint(point.position()));\n\t\t\tselected_points.forEach((point) => {\n\t\t\t\taccumulated_points.push(point);\n\t\t\t});\n\t\t} else {\n\t\t\t//start_time = performance.now()\n\t\t\tconst leaves_intersecting_with_sphere = this._leaves.filter((leaf) => leaf.intersects_sphere(sphere));\n\n\t\t\t//console.log(\"level: #{@_level}, found #{leaves_intersecting_with_sphere.length} leaves \")\n\t\t\tleaves_intersecting_with_sphere.forEach((leaf) => leaf.points_in_sphere(sphere, accumulated_points));\n\t\t}\n\t}\n\t//this.constructor.PERF += performance.now()-start_time\n\n\tbounding_box(): Box3 | undefined {\n\t\treturn this._bbox;\n\t}\n\n\t// points_count: ->\n\t// \t@_points_count\n\n\tset_points(points: CorePoint[]) {\n\t\t//@_points_count = points.length\n\n\t\tthis._points_by_octant_id = {};\n\t\tfor (let point of points) {\n\t\t\tthis.add_point(point);\n\t\t}\n\n\t\tconst octant_ids = Object.keys(this._points_by_octant_id);\n\t\tif (octant_ids.length > 1) {\n\t\t\toctant_ids.forEach((octant_id) => {\n\t\t\t\tthis.create_leaf(octant_id);\n\t\t\t});\n\t\t}\n\t}\n\n\tcreate_leaf(octant_id: string) {\n\t\tconst box = this._leaf_bbox(octant_id);\n\t\tconst leaf = new OctreeNode(box, this._level + 1);\n\t\tthis._leaves_by_octant[octant_id] = leaf;\n\t\tthis._leaves.push(leaf);\n\t\t//throw \"test #{@_level}\"\n\n\t\tleaf.set_points(this._points_by_octant_id[octant_id]);\n\t}\n\n\tadd_point(point: CorePoint) {\n\t\tconst octant_id = this._octant_id(point.position());\n\t\tif (this._points_by_octant_id[octant_id] == null) {\n\t\t\tthis._points_by_octant_id[octant_id] = [];\n\t\t}\n\t\tthis._points_by_octant_id[octant_id].push(point);\n\t}\n\n\tprivate _octant_id(position: Vector3): string {\n\t\tconst x_pos = position.x > this._center.x ? 1 : 0;\n\t\tconst y_pos = position.y > this._center.y ? 1 : 0;\n\t\tconst z_pos = position.z > this._center.z ? 1 : 0;\n\t\treturn `${x_pos}${y_pos}${z_pos}`;\n\t}\n\n\t_leaf_bbox(octant_id: string): Box3 {\n\t\tif (!this._bounding_boxes_by_octant_prepared) {\n\t\t\tthis._prepare_leaves_bboxes();\n\t\t\tthis._bounding_boxes_by_octant_prepared = true;\n\t\t}\n\t\treturn this._bounding_boxes_by_octant[octant_id];\n\t}\n\n\tprivate _bbox_center(x_pos: number, y_pos: number, z_pos: number) {\n\t\tconst corner = this._bbox.min.clone();\n\t\tif (x_pos) {\n\t\t\tcorner.x = this._bbox.max.x;\n\t\t}\n\t\tif (y_pos) {\n\t\t\tcorner.y = this._bbox.max.y;\n\t\t}\n\t\tif (z_pos) {\n\t\t\tcorner.z = this._bbox.max.z;\n\t\t}\n\n\t\treturn corner\n\t\t\t.clone()\n\t\t\t.add(this._center)\n\t\t\t.multiplyScalar(0.5);\n\t}\n\n\tprivate _prepare_leaves_bboxes() {\n\t\tconst bbox_centers = [];\n\t\tbbox_centers.push(this._bbox_center(0, 0, 0));\n\t\tbbox_centers.push(this._bbox_center(0, 0, 1));\n\t\tbbox_centers.push(this._bbox_center(0, 1, 0));\n\t\tbbox_centers.push(this._bbox_center(0, 1, 1));\n\t\tbbox_centers.push(this._bbox_center(1, 0, 0));\n\t\tbbox_centers.push(this._bbox_center(1, 0, 1));\n\t\tbbox_centers.push(this._bbox_center(1, 1, 0));\n\t\tbbox_centers.push(this._bbox_center(1, 1, 1));\n\n\t\tconst bbox_size_quarter = this._bbox.max\n\t\t\t.clone()\n\t\t\t.sub(this._bbox.min)\n\t\t\t.multiplyScalar(0.25);\n\t\tfor (let bbox_center of bbox_centers) {\n\t\t\tconst octant_id = this._octant_id(bbox_center);\n\t\t\tconst bbox = new Box3(\n\t\t\t\tbbox_center.clone().sub(bbox_size_quarter),\n\t\t\t\tbbox_center.clone().add(bbox_size_quarter)\n\t\t\t);\n\t\t\tthis._bounding_boxes_by_octant[octant_id] = bbox;\n\t\t}\n\t\t// this._bounding_boxes_by_octant;\n\t}\n}\n","import {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport lodash_range from 'lodash/range';\nimport {TypedSopNode} from './_Base';\nimport {CoreConstant} from 'src/core/geometry/Constant';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {CoreGroup} from 'src/core/geometry/Group';\nclass BboxScatterSopParamsConfig extends NodeParamsConfig {\n\tstep_size = ParamConfig.FLOAT(0.1);\n}\nconst ParamsConfig = new BboxScatterSopParamsConfig();\n\nexport class BboxScatterSopNode extends TypedSopNode<BboxScatterSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'bbox_scatter';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to create points from'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst container = input_contents[0];\n\t\t// const group = container.group();\n\n\t\tconst step_size = this.pv.step_size;\n\t\t// jitter = @_param_jitter\n\n\t\tconst bbox = container.bounding_box();\n\n\t\tconst range = {\n\t\t\tx: lodash_range(bbox.min.x, bbox.max.x, step_size),\n\t\t\ty: lodash_range(bbox.min.y, bbox.max.y, step_size),\n\t\t\tz: lodash_range(bbox.min.z, bbox.max.z, step_size),\n\t\t};\n\n\t\t// create buffer geometry\n\t\t// const vertices_count = range.x * range.y * range.z;\n\t\tconst positions: number[] = [];\n\t\trange.x.forEach((x) => {\n\t\t\trange.y.forEach((y) => {\n\t\t\t\trange.z.forEach((z) => {\n\t\t\t\t\tpositions.push(x);\n\t\t\t\t\tpositions.push(y);\n\t\t\t\t\tpositions.push(z);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute('position', new BufferAttribute(new Float32Array(positions), 3));\n\n\t\tthis.set_geometry(geometry, CoreConstant.OBJECT_TYPE.POINTS);\n\t}\n}\n","import {TypedSopNode} from './_Base';\n\nimport {Object3D} from 'three/src/core/Object3D';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Mesh} from 'three/src/objects/Mesh';\n\nclass BlendSopParamsConfig extends NodeParamsConfig {\n\tattrib_name = ParamConfig.STRING();\n\tblend = ParamConfig.FLOAT(0.5, {\n\t\trange: [0, 1],\n\t\trange_locked: [true, true],\n\t});\n}\nconst ParamsConfig = new BlendSopParamsConfig();\n\nexport class BlendSopNode extends TypedSopNode<BlendSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'blend';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to blend from', 'geometry to blend to'];\n\t}\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(2);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE, InputCloneMode.NEVER]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\t// this.request_input_container 0, (container0)=>\n\t\t// \tif container0? && (group0 = container0.group())?\n\t\t// \t\tthis.request_input_container 1, (container1)=>\n\t\t// \t\t\tif container1? && (group1 = container1.group({clone: false}))?\n\n\t\t//this.eval_all_params =>\n\t\t// const container0 = input_containers[0];\n\t\t// const container1 = input_containers[1];\n\n\t\t// const group0 = container0.group();\n\t\t// const group1 = container1.group();\n\t\tconst core_group0 = input_contents[0];\n\t\tconst core_group1 = input_contents[1];\n\n\t\tconst objects0 = core_group0.objects();\n\t\tconst objects1 = core_group1.objects();\n\n\t\tlet object0, object1;\n\t\tfor (let i = 0; i < objects0.length; i++) {\n\t\t\tobject0 = objects0[i];\n\t\t\tobject1 = objects1[i];\n\t\t\tthis.blend(object0, object1, this.pv.blend);\n\t\t}\n\t\tthis.set_core_group(core_group0);\n\t}\n\n\t// \t\telse\n\t// \t\t\tthis.set_error(\"input 1 required\")\n\n\t// else\n\t// \tthis.set_error(\"input 0 required\")\n\tprivate blend(object0: Object3D, object1: Object3D, blend: number) {\n\t\tconst geometry0 = (object0 as Mesh).geometry as BufferGeometry;\n\t\tconst geometry1 = (object1 as Mesh).geometry as BufferGeometry;\n\t\tif (geometry0 == null || geometry1 == null) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst attrib0 = geometry0.getAttribute(this.pv.attrib_name);\n\t\tconst attrib1 = geometry1.getAttribute(this.pv.attrib_name);\n\t\tif (attrib0 == null || attrib1 == null) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst attrib0_array = attrib0.array as number[];\n\t\tconst attrib1_array = attrib1.array as number[];\n\n\t\tlet c0, c1;\n\t\tfor (let i = 0; i < attrib0_array.length; i++) {\n\t\t\tc0 = attrib0_array[i];\n\t\t\tc1 = attrib1_array[i];\n\t\t\tif (c1 != null) {\n\t\t\t\tattrib0_array[i] = (1 - blend) * c0 + blend * c1;\n\t\t\t}\n\t\t}\n\n\t\tgeometry0.computeVertexNormals();\n\t}\n}\n","import {TypedSopNode} from './_Base';\nimport {CoreTransform} from 'src/core/Transform';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\n// import {Vector3} from 'three/src/math/Vector3';\nimport {BoxBufferGeometry} from 'three/src/geometries/BoxGeometry';\n// import {CoreGeometry} from 'src/core/geometry/Geometry'\n// import {ParamType} from 'src/engine/poly/ParamType';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass BoxSopParamsConfig extends NodeParamsConfig {\n\tsize = ParamConfig.FLOAT(1);\n\tdivisions = ParamConfig.FLOAT(1, {\n\t\trange: [1, 10],\n\t\trange_locked: [true, false],\n\t});\n\tcenter = ParamConfig.VECTOR3([0, 0, 0]);\n}\nconst ParamsConfig = new BoxSopParamsConfig();\n\nexport class BoxSopNode extends TypedSopNode<BoxSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'box';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to create bounding box from (optional)'];\n\t}\n\n\tprivate _core_transform = new CoreTransform();\n\t// constructor(scene: PolyScene) {\n\t// \tsuper(scene);\n\t// }\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(0, 1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.NEVER]);\n\t}\n\t// create_params() {\n\t// \tthis.add_param(ParamType.FLOAT, 'size', 1);\n\t// \tthis.add_param(ParamType.INTEGER, 'divisions', 1, {\n\t// \t\trange: [1, 10],\n\t// \t\trange_locked: [true, false],\n\t// \t});\n\t// \tthis.add_param(ParamType.VECTOR3, 'center', [0, 0, 0]);\n\t// }\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tif (core_group) {\n\t\t\tthis._cook_with_input(core_group);\n\t\t} else {\n\t\t\tthis._cook_without_input();\n\t\t}\n\t}\n\n\tprivate _cook_without_input() {\n\t\t//\t\tthis.eval_all_params =>\n\t\tconst divisions = this.pv.divisions;\n\t\tconst size = this.pv.size;\n\t\tconst geometry = new BoxBufferGeometry(size, size, size, divisions, divisions, divisions);\n\n\t\tgeometry.translate(this.pv.center.x, this.pv.center.y, this.pv.center.z);\n\n\t\tgeometry.computeVertexNormals();\n\t\t// const buffer_geometry = CoreGeometry.clone(geometry);\n\t\tthis.set_geometry(geometry);\n\t}\n\n\tprivate _cook_with_input(core_group: CoreGroup) {\n\t\t// this.request_input_container 0, (container)=>\n\t\t// \tif container? && (group = container.group({clone: false}))?\n\t\t// \t\tthis.eval_all_params =>\n\n\t\tconst divisions = this.pv.divisions;\n\n\t\tconst bbox = core_group.bounding_box();\n\t\tconst size = bbox.max.clone().sub(bbox.min);\n\t\tconst center = bbox.max\n\t\t\t.clone()\n\t\t\t.add(bbox.min)\n\t\t\t.multiplyScalar(0.5);\n\n\t\tconst geometry = new BoxBufferGeometry(size.x, size.y, size.z, divisions, divisions, divisions);\n\t\tconst matrix = this._core_transform.translation_matrix(center);\n\t\tgeometry.applyMatrix(matrix);\n\n\t\t// const buffer_geometry = CoreGeometry.clone(geometry);\n\t\tthis.set_geometry(geometry);\n\t}\n\n\t// else\n\t// \tthis.set_error(\"first input is invalid\")\n\n\t// _divisions() {\n\t// \treturn Math.max(1, this.pv.divisions);\n\t// }\n}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {CircleBufferGeometry} from 'three/src/geometries/CircleGeometry';\nimport {TypedSopNode} from './_Base';\nimport {CoreGeometryUtilCircle} from 'src/core/geometry/util/Circle';\nimport {ObjectType} from 'src/core/geometry/Constant';\nimport {CoreTransform} from 'src/core/Transform';\n\nconst DEFAULT_UP = new Vector3(0, 0, 1);\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass CircleSopParamsConfig extends NodeParamsConfig {\n\tradius = ParamConfig.FLOAT(1);\n\tsegments = ParamConfig.INTEGER(12, {\n\t\trange: [1, 50],\n\t\trange_locked: [true, false],\n\t});\n\topen = ParamConfig.BOOLEAN(1);\n\tarc_angle = ParamConfig.FLOAT(360, {\n\t\trange: [0, 360],\n\t\trange_locked: [false, false],\n\t\tvisible_if: {open: 1},\n\t});\n\tdirection = ParamConfig.VECTOR3([0, 1, 0]);\n}\nconst ParamsConfig = new CircleSopParamsConfig();\n\nexport class CircleSopNode extends TypedSopNode<CircleSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'circle';\n\t}\n\n\tprivate _core_transform = new CoreTransform();\n\n\tinitialize_node() {\n\t\t// this.io.inputs.set_count(0);\n\t\t// this.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook() {\n\t\tif (this.pv.open) {\n\t\t\tthis._create_circle();\n\t\t} else {\n\t\t\tthis._create_disk();\n\t\t}\n\t}\n\n\t_create_circle() {\n\t\tconst geometry = CoreGeometryUtilCircle.create(this.pv.radius, this.pv.segments, this.pv.arc_angle);\n\n\t\tthis._core_transform.rotate_geometry(geometry, DEFAULT_UP, this.pv.direction);\n\n\t\tthis.set_geometry(geometry, ObjectType.LINE_SEGMENTS);\n\t}\n\n\t_create_disk() {\n\t\tconst geometry = new CircleBufferGeometry(this.pv.radius, this.pv.segments);\n\n\t\tthis._core_transform.rotate_geometry(geometry, DEFAULT_UP, this.pv.direction);\n\n\t\tthis.set_geometry(geometry);\n\t}\n}\n","import {Color} from 'three/src/math/Color';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {CoreColor} from 'src/core/Color';\n// import lodash_times from 'lodash/times'\n// import lodash_each from 'lodash/each'\n// import {CoreGroup} from 'src/core/geometry/Group';\nimport {TypedSopNode} from './_Base';\n\nimport {CoreObject} from 'src/core/geometry/Object';\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {CorePoint} from 'src/core/geometry/Point';\n\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Mesh} from 'three/src/objects/Mesh';\n\nconst DEFAULT_COLOR = new Color(1, 1, 1);\nconst COLOR_ATTRIB_NAME = 'color';\n\ntype ValueArrayByName = Dictionary<number[]>;\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass ColorSopParamsConfig extends NodeParamsConfig {\n\tfrom_attribute = ParamConfig.BOOLEAN(0);\n\tattrib_name = ParamConfig.STRING('', {\n\t\tvisible_if: {from_attribute: 1},\n\t});\n\tcolor = ParamConfig.COLOR([1, 1, 1], {\n\t\tvisible_if: {from_attribute: 0},\n\t\texpression: {for_entities: true},\n\t});\n\tas_hsv = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {from_attribute: 0},\n\t});\n}\nconst ParamsConfig = new ColorSopParamsConfig();\n\nexport class ColorSopNode extends TypedSopNode<ColorSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'color';\n\t}\n\n\tprivate _r_arrays_by_geometry_uuid: ValueArrayByName = {};\n\tprivate _g_arrays_by_geometry_uuid: ValueArrayByName = {};\n\tprivate _b_arrays_by_geometry_uuid: ValueArrayByName = {};\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to update color of'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t\t// this.ui_data.set_icon('palette');\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tconst core_objects = core_group.core_objects();\n\n\t\tfor (let core_object of core_objects) {\n\t\t\tif (this.pv.from_attribute) {\n\t\t\t\tthis._set_from_attribute(core_object);\n\t\t\t} else {\n\t\t\t\tconst has_expression = this.p.color.has_expression();\n\t\t\t\tif (has_expression) {\n\t\t\t\t\tawait this._eval_expressions(core_object);\n\t\t\t\t} else {\n\t\t\t\t\tthis._eval_simple_values(core_object);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// needs update required for when no cloning\n\t\tif (!this.io.inputs.input_cloned(0)) {\n\t\t\tconst geometries = core_group.geometries();\n\t\t\tfor (let geometry of geometries) {\n\t\t\t\t(geometry.getAttribute(COLOR_ATTRIB_NAME) as BufferAttribute).needsUpdate = true;\n\t\t\t}\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n\n\t_set_from_attribute(core_object: CoreObject) {\n\t\tconst core_geometry = core_object.core_geometry();\n\t\tthis._create_init_color(core_geometry, DEFAULT_COLOR);\n\t\tconst points = core_geometry.points();\n\n\t\tconst src_attrib_size = core_geometry.attrib_size(this.pv.attrib_name);\n\t\tconst geometry = core_geometry.geometry();\n\t\tconst src_array = geometry.getAttribute(this.pv.attrib_name).array;\n\t\tconst dest_array = geometry.getAttribute(COLOR_ATTRIB_NAME).array as number[];\n\n\t\tswitch (src_attrib_size) {\n\t\t\tcase 1: {\n\t\t\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\t\t\tconst dest_i = i * 3;\n\t\t\t\t\tdest_array[dest_i + 0] = src_array[i];\n\t\t\t\t\tdest_array[dest_i + 1] = 1 - src_array[i];\n\t\t\t\t\tdest_array[dest_i + 2] = 0;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 2: {\n\t\t\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\t\t\tconst dest_i = i * 3;\n\t\t\t\t\tconst src_i = i * 2;\n\t\t\t\t\tdest_array[dest_i + 0] = src_array[src_i + 0];\n\t\t\t\t\tdest_array[dest_i + 1] = src_array[src_i + 1];\n\t\t\t\t\tdest_array[dest_i + 2] = 0;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 3: {\n\t\t\t\tfor (let i = 0; i < src_array.length; i++) {\n\t\t\t\t\tdest_array[i] = src_array[i];\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 4: {\n\t\t\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\t\t\tconst dest_i = i * 3;\n\t\t\t\t\tconst src_i = i * 4;\n\t\t\t\t\tdest_array[dest_i + 0] = src_array[src_i + 0];\n\t\t\t\t\tdest_array[dest_i + 1] = src_array[src_i + 1];\n\t\t\t\t\tdest_array[dest_i + 2] = src_array[src_i + 2];\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _create_init_color(core_geometry: CoreGeometry, color: Color) {\n\t\tif (!core_geometry.has_attrib(COLOR_ATTRIB_NAME)) {\n\t\t\tcore_geometry.add_numeric_attrib(COLOR_ATTRIB_NAME, 3, DEFAULT_COLOR);\n\t\t}\n\t}\n\n\t_eval_simple_values(core_object: CoreObject) {\n\t\tconst core_geometry = core_object.core_geometry();\n\t\tthis._create_init_color(core_geometry, DEFAULT_COLOR);\n\n\t\tlet new_color: Color;\n\t\tif (this.pv.as_hsv) {\n\t\t\tnew_color = new Color();\n\t\t\tCoreColor.set_hsv(this.pv.color.r, this.pv.color.g, this.pv.color.b, new_color);\n\t\t} else {\n\t\t\tnew_color = this.pv.color; //.clone();\n\t\t}\n\t\tcore_geometry.add_numeric_attrib(COLOR_ATTRIB_NAME, 3, new_color);\n\t}\n\n\tasync _eval_expressions(core_object: CoreObject) {\n\t\tconst points = core_object.points();\n\t\tconst object = core_object.object();\n\t\tconst core_geometry = core_object.core_geometry();\n\t\tthis._create_init_color(core_geometry, DEFAULT_COLOR);\n\t\tconst geometry = (object as Mesh).geometry as BufferGeometry;\n\t\tif (geometry) {\n\t\t\tconst array = geometry.getAttribute(COLOR_ATTRIB_NAME).array as number[];\n\n\t\t\tconst tmp_array_r = await this._update_from_param(geometry, array, points, 0);\n\t\t\tconst tmp_array_g = await this._update_from_param(geometry, array, points, 1);\n\t\t\tconst tmp_array_b = await this._update_from_param(geometry, array, points, 2);\n\n\t\t\tif (tmp_array_r) {\n\t\t\t\tthis._commit_tmp_values(tmp_array_r, array, 0);\n\t\t\t}\n\t\t\tif (tmp_array_g) {\n\t\t\t\tthis._commit_tmp_values(tmp_array_g, array, 1);\n\t\t\t}\n\t\t\tif (tmp_array_b) {\n\t\t\t\tthis._commit_tmp_values(tmp_array_b, array, 2);\n\t\t\t}\n\n\t\t\t// to hsv\n\t\t\tif (this.pv.as_hsv) {\n\t\t\t\tlet current = new Color();\n\t\t\t\tlet target = new Color();\n\t\t\t\tlet index;\n\t\t\t\tfor (let point of points) {\n\t\t\t\t\tindex = point.index * 3;\n\t\t\t\t\tcurrent.fromArray(array, index);\n\t\t\t\t\tCoreColor.set_hsv(current.r, current.g, current.b, target);\n\t\t\t\t\ttarget.toArray(array, index);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// const colorr_param = this.param('colorr');\n\t\t// const colorg_param = this.param('colorg');\n\t\t// const colorb_param = this.param('colorb');\n\n\t\t// r\n\t\t// if(colorr_param.has_expression()){\n\t\t// \tawait colorr_param.eval_expression_for_entities(points, (point, value)=>{\n\t\t// \t\tarray[point.index()*3+0] = value\n\t\t// \t})\n\t\t// } else {\n\t\t// \tfor(let point of points){\n\t\t// \t\tarray[point.index()*3+0] = this.pv.color.r\n\t\t// \t}\n\t\t// }\n\t\t// g\n\t\t// if(colorg_param.has_expression()){\n\t\t// \tawait colorg_param.eval_expression_for_entities(points, (point, value)=>{\n\t\t// \t\tarray[point.index()*3+1] = value\n\t\t// \t})\n\t\t// } else {\n\t\t// \tfor(let point of points){\n\t\t// \t\tarray[point.index()*3+1] = this.pv.color.g\n\t\t// \t}\n\t\t// }\n\t\t// b\n\t\t// if(colorb_param.has_expression()){\n\t\t// \tawait colorb_param.eval_expression_for_entities(points, (point, value)=>{\n\t\t// \t\tarray[point.index()*3+2] = value\n\t\t// \t})\n\t\t// } else {\n\t\t// \tfor(let point of points){\n\t\t// \t\tarray[point.index()*3+2] = this.pv.color.b\n\t\t// \t}\n\t\t// }\n\t}\n\n\tprivate async _update_from_param(\n\t\tgeometry: BufferGeometry,\n\t\tarray: number[],\n\t\tpoints: CorePoint[],\n\t\toffset: number\n\t): Promise<number[] | undefined> {\n\t\t// const component_name = ['r', 'g', 'b'][offset];\n\t\tconst param = this.p.color.components[offset];\n\t\tconst param_value = [this.pv.color.r, this.pv.color.g, this.pv.color.b][offset];\n\t\tconst arrays_by_geometry_uuid = [\n\t\t\tthis._r_arrays_by_geometry_uuid,\n\t\t\tthis._g_arrays_by_geometry_uuid,\n\t\t\tthis._b_arrays_by_geometry_uuid,\n\t\t][offset];\n\n\t\tlet tmp_array: number[] | undefined;\n\t\tif (param.has_expression() && param.expression_controller) {\n\t\t\ttmp_array = this._init_array_if_required(geometry, arrays_by_geometry_uuid, points.length);\n\t\t\tawait param.expression_controller.compute_expression_for_points(points, (point, value) => {\n\t\t\t\t// array[point.index()*3+2] = value\n\t\t\t\t(tmp_array as number[])[point.index] = value;\n\t\t\t});\n\t\t} else {\n\t\t\tfor (let point of points) {\n\t\t\t\tarray[point.index * 3 + offset] = param_value;\n\t\t\t}\n\t\t}\n\t\treturn tmp_array;\n\t}\n\n\tprivate _init_array_if_required(\n\t\tgeometry: BufferGeometry,\n\t\tarrays_by_geometry_uuid: ValueArrayByName,\n\t\tpoints_count: number\n\t) {\n\t\tconst uuid = geometry.uuid;\n\t\tconst current_array = arrays_by_geometry_uuid[uuid];\n\t\tif (current_array) {\n\t\t\t// only create new array if we need more point, or as soon as the length is different?\n\t\t\tif (current_array.length < points_count) {\n\t\t\t\tarrays_by_geometry_uuid[uuid] = new Array(points_count);\n\t\t\t}\n\t\t} else {\n\t\t\tarrays_by_geometry_uuid[uuid] = new Array(points_count);\n\t\t}\n\t\treturn arrays_by_geometry_uuid[uuid];\n\t}\n\n\tprivate _commit_tmp_values(tmp_array: number[], target_array: number[], offset: number) {\n\t\tfor (let i = 0; i < tmp_array.length; i++) {\n\t\t\ttarget_array[i * 3 + offset] = tmp_array[i];\n\t\t}\n\t}\n}\n","import {_Math} from 'three/src/math/Math'\nimport {Color} from 'three/src/math/Color'\n\nexport class CoreColor {\n\t// use color.toStyle() if needed\n\t// static to_css(color: Color): string {\n\t// \tconst color_elements = color.toArray().map((e) => e * 255)\n\t// \treturn `rgb(${color_elements.join(', ')})`\n\t// }\n\n\t// from THREE.js examples ColorConverter.js\n\tstatic set_hsv(h: number, s: number, v: number, target: Color) {\n\t\th = _Math.euclideanModulo(h, 1)\n\t\ts = _Math.clamp(s, 0, 1)\n\t\tv = _Math.clamp(v, 0, 1)\n\n\t\ttarget.setHSL(h, (s * v) / ((h = (2 - s) * v) < 1 ? h : 2 - h), h * 0.5)\n\t}\n}\n","import lodash_compact from 'lodash/compact';\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup, Object3DWithGeometry} from 'src/core/geometry/Group';\nimport {CoreObject} from 'src/core/geometry/Object';\n// import {CoreGeometry} from 'src/core/geometry/Geometry'\nimport {CoreInstancer} from 'src/core/geometry/Instancer';\nimport {CoreString} from 'src/core/String';\n// import {NodeSimple} from 'src/Core/Graph/NodeSimple'\nimport {CopyStamp} from './utils/CopyStamp';\nimport {Matrix4} from 'three/src/math/Matrix4';\nimport {CorePoint} from 'src/core/geometry/Point';\n// import RSVP from 'rsvp'\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {Object3D} from 'three/src/core/Object3D';\nclass CopySopParamsConfig extends NodeParamsConfig {\n\tcount = ParamConfig.INTEGER(1, {\n\t\trange: [1, 20],\n\t\trange_locked: [true, false],\n\t});\n\ttransform_only = ParamConfig.BOOLEAN(0);\n\tcopy_attributes = ParamConfig.BOOLEAN(0);\n\tattributes_to_copy = ParamConfig.STRING('', {\n\t\tvisible_if: {copy_attributes: true},\n\t});\n\tuse_copy_expr = ParamConfig.BOOLEAN(0);\n}\nconst ParamsConfig = new CopySopParamsConfig();\n\nexport class CopySopNode extends TypedSopNode<CopySopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'copy';\n\t}\n\n\tprivate _attribute_names_to_copy: string[] = [];\n\t// private _group: Group|undefined;\n\tprivate _objects: Object3D[] = [];\n\tprivate _stamp_node!: CopyStamp;\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to be copied', 'points to copy to'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1, 2);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.ALWAYS, InputCloneMode.NEVER]);\n\t}\n\n\t// async evaluate_inputs_and_params() {\n\t// \tawait this.eval_all_params()\n\t// }\n\n\tasync cook() {\n\t\tlet core_group0;\n\t\tconst container0 = await this.container_controller.request_input_container(0);\n\t\tif (container0 != null && (core_group0 = container0.core_content()) != null) {\n\t\t\tif (this.io.inputs.has_input(1)) {\n\t\t\t\tlet core_group1;\n\t\t\t\tconst container1 = await this.container_controller.request_input_container(1);\n\t\t\t\tif (container1 != null && (core_group1 = container1.core_content()) != null) {\n\t\t\t\t\tawait this.cook_with_template(core_group0, core_group1);\n\t\t\t\t} else {\n\t\t\t\t\tthis.states.error.set('second input required');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cook_without_template(core_group0);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.states.error.set('first input required');\n\t\t}\n\t}\n\n\tprivate async cook_with_template(instance_core_group: CoreGroup, template_core_group: CoreGroup) {\n\t\tthis._objects = [];\n\n\t\tconst template_points = template_core_group.points();\n\n\t\tconst instancer = new CoreInstancer(template_core_group);\n\t\tlet instance_matrices = instancer.matrices();\n\n\t\tthis._attribute_names_to_copy = CoreString.attrib_names(this.pv.attributes_to_copy).filter((attrib_name) =>\n\t\t\ttemplate_core_group.has_attrib(attrib_name)\n\t\t);\n\t\tawait this._copy_moved_objects_on_template_points(instance_core_group, instance_matrices, template_points);\n\t\tthis.set_objects(this._objects);\n\t}\n\n\t// https://stackoverflow.com/questions/24586110/resolve-promises-one-after-another-i-e-in-sequence\n\tprivate async _copy_moved_objects_on_template_points(\n\t\tinstance_core_group: CoreGroup,\n\t\tinstance_matrices: Matrix4[],\n\t\ttemplate_points: CorePoint[]\n\t) {\n\t\tfor (let point_index = 0; point_index < template_points.length; point_index++) {\n\t\t\tawait this._copy_moved_object_on_template_point(\n\t\t\t\tinstance_core_group,\n\t\t\t\tinstance_matrices,\n\t\t\t\ttemplate_points,\n\t\t\t\tpoint_index\n\t\t\t);\n\t\t}\n\t\t// template_points.forEach((template_point, point_index) => {\n\t\t// \tp = p.then(() => {\n\t\t// \t\treturn this._copy_moved_object_on_template_point(\n\t\t// \t\t\tinstance_core_group,\n\t\t// \t\t\tinstance_matrices,\n\t\t// \t\t\ttemplate_points,\n\t\t// \t\t\tpoint_index\n\t\t// \t\t);\n\t\t// \t});\n\t\t// });\n\t}\n\n\tprivate _copy_moved_object_on_template_point(\n\t\tinstance_core_group: CoreGroup,\n\t\tinstance_matrices: Matrix4[],\n\t\ttemplate_points: CorePoint[],\n\t\tpoint_index: number\n\t) {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tconst matrix = instance_matrices[point_index];\n\t\t\tconst template_point = template_points[point_index];\n\t\t\tthis.stamp_node.set_point(template_point);\n\n\t\t\tconst moved_objects = await this._get_moved_objects_for_template_point(instance_core_group, point_index);\n\n\t\t\tmoved_objects.forEach((moved_object) => {\n\t\t\t\tif (this.pv.copy_attributes) {\n\t\t\t\t\tthis._copy_attributes_from_template(moved_object, template_point);\n\t\t\t\t}\n\n\t\t\t\t// TODO: that node is getting inconsistent...\n\t\t\t\t// should I always only move the object?\n\t\t\t\t// and have a toggle to bake back to the geo?\n\t\t\t\t// or just enfore the use of a merge?\n\t\t\t\tif (this.pv.transform_only) {\n\t\t\t\t\tmoved_object.applyMatrix(matrix);\n\t\t\t\t} else {\n\t\t\t\t\tmoved_object.geometry.applyMatrix(matrix);\n\t\t\t\t}\n\n\t\t\t\treturn this._objects.push(moved_object);\n\t\t\t});\n\n\t\t\treturn resolve();\n\t\t});\n\t}\n\n\tprivate _get_moved_objects_for_template_point(\n\t\tinstance_core_group: CoreGroup,\n\t\tpoint_index: number\n\t): Promise<Object3DWithGeometry[]> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tconst stamped_instance_core_group = await this._stamp_instance_group_if_required(instance_core_group);\n\t\t\tif (stamped_instance_core_group) {\n\t\t\t\t// duplicate or select from instance children\n\t\t\t\tconst moved_objects = this.pv.transform_only\n\t\t\t\t\t? // TODO: why is doing a transform slower than cloning the input??\n\t\t\t\t\t  lodash_compact([instance_core_group.objects()[point_index]])\n\t\t\t\t\t: instance_core_group.clone().objects();\n\n\t\t\t\tresolve(moved_objects);\n\t\t\t} else {\n\t\t\t\tresolve([]);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _stamp_instance_group_if_required(instance_core_group: CoreGroup): Promise<CoreGroup | undefined> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tif (this.pv.use_copy_expr) {\n\t\t\t\tconst container0 = await this.container_controller.request_input_container(0);\n\t\t\t\tlet core_group0: CoreGroup;\n\t\t\t\tif (container0 && (core_group0 = container0.core_content()) != null) {\n\t\t\t\t\t// this.stamp_node.increment_global_value()\n\t\t\t\t\tresolve(core_group0);\n\t\t\t\t} else {\n\t\t\t\t\tthis.states.error.set(`input failed for index ${this.stamp_value()}`);\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve(instance_core_group);\n\t\t\t}\n\t\t});\n\t}\n\n\t// https://stackoverflow.com/questions/24586110/resolve-promises-one-after-another-i-e-in-sequence\n\tprivate async _copy_moved_objects_for_each_instance(instance_core_group: CoreGroup) {\n\t\t// let p = Promise.resolve(); // Q() in q\n\n\t\tfor (let i = 0; i < this.pv.count; i++) {\n\t\t\tawait this._copy_moved_objects_for_instance(instance_core_group, i);\n\t\t}\n\t\t// lodash_times(this.pv.count, (i) => {\n\t\t// \tp = p.then(() => {\n\t\t// \t\treturn this._copy_moved_objects_for_instance(instance_core_group, i);\n\t\t// \t});\n\t\t// });\n\n\t\t// return p;\n\t}\n\n\tprivate _copy_moved_objects_for_instance(instance_core_group: CoreGroup, i: number) {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tthis.stamp_node.set_global_index(i);\n\n\t\t\tconst stamped_instance_core_group = await this._stamp_instance_group_if_required(instance_core_group);\n\t\t\tif (stamped_instance_core_group) {\n\t\t\t\tstamped_instance_core_group.objects().forEach((object) => {\n\t\t\t\t\t// TODO: I should use the Group wrapper, to ensure that material.linewidth is properly cloned\n\t\t\t\t\tconst new_object = CoreObject.clone(object);\n\t\t\t\t\tthis._objects.push(new_object);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tresolve();\n\t\t});\n\t}\n\n\t// TODO: what if I combine both @_param_count and stamping?!\n\tprivate cook_without_template(instance_core_group: CoreGroup) {\n\t\tthis._objects = [];\n\t\tthis._copy_moved_objects_for_each_instance(instance_core_group).then(() => {\n\t\t\tthis.set_objects(this._objects);\n\t\t});\n\t}\n\n\tprivate _copy_attributes_from_template(object: Object3D, template_point: CorePoint) {\n\t\tthis._attribute_names_to_copy.forEach((attrib_name, i) => {\n\t\t\tconst attrib_value = template_point.attrib_value(attrib_name);\n\t\t\tconst object_wrapper = new CoreObject(object, i);\n\t\t\tobject_wrapper.add_attribute(attrib_name, attrib_value);\n\t\t});\n\t}\n\n\t//\n\t//\n\t// STAMP\n\t//\n\t//\n\tstamp_value(attrib_name?: string) {\n\t\treturn this.stamp_node.value(attrib_name);\n\t}\n\tget stamp_node() {\n\t\treturn (this._stamp_node = this._stamp_node || this.create_stamp_node());\n\t}\n\tprivate create_stamp_node() {\n\t\tconst stamp_node = new CopyStamp(this.scene);\n\t\tthis.dirty_controller.set_forbidden_trigger_nodes([stamp_node]);\n\t\treturn stamp_node;\n\t}\n\n\t// private set_dirty_allowed(original_trigger_graph_node: CoreGraphNode): boolean {\n\t// \treturn original_trigger_graph_node.graph_node_id !== this.stamp_node.graph_node_id;\n\t// }\n}\n","import lodash_isNumber from 'lodash/isNumber';\n\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {Quaternion} from 'three/src/math/Quaternion';\nimport {Matrix4} from 'three/src/math/Matrix4';\nimport {InstancedBufferGeometry} from 'three/src/core/InstancedBufferGeometry';\nimport {InstancedBufferAttribute} from 'three/src/core/InstancedBufferAttribute';\n// import {BoxBufferGeometry} from 'three/src/geometries/BoxGeometry'\n// const THREE = {BoxBufferGeometry, InstancedBufferAttribute, InstancedBufferGeometry, Matrix4, Quaternion, Vector2, Vector3}\n\nimport {CorePoint} from './Point';\n// import {Core} from 'src/core/_Module';\nimport {CoreGroup} from './Group';\nimport {CoreGeometry} from './Geometry';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n\nconst DEFAULT = {\n\tSCALE: new Vector3(1, 1, 1),\n\tPSCALE: 1,\n\tEYE: new Vector3(0, 0, 0),\n\tUP: new Vector3(0, 1, 0),\n};\nconst SCALE_ATTRIB_NAME = 'scale';\nconst PSCALE_ATTRIB_NAME = 'pscale';\nconst NORMAL_ATTRIB_NAME = 'normal';\nconst UP_ATTRIB_NAME = 'up';\nconst MATRIX_T = 'translate';\nconst MATRIX_R = 'rotate';\nconst MATRIX_S = 'scale';\n\nconst DEFAULT_COLOR = new Vector3(1, 1, 1);\nconst DEFAULT_UV = new Vector2(0, 0);\nconst ATTRIB_NAME_UV = 'uv';\nconst ATTRIB_NAME_COLOR = 'color';\n\nexport class CoreInstancer {\n\tprivate _is_pscale_present: boolean;\n\tprivate _is_scale_present: boolean;\n\tprivate _is_normal_present: boolean;\n\tprivate _is_up_present: boolean;\n\tprivate _do_rotate_matrices: boolean;\n\tprivate _matrices: Dictionary<Matrix4> = {};\n\n\tconstructor(private _group_wrapper: CoreGroup) {\n\t\tthis._is_pscale_present = this._group_wrapper.has_attrib('pscale');\n\t\tthis._is_scale_present = this._group_wrapper.has_attrib('scale');\n\n\t\tthis._is_normal_present = this._group_wrapper.has_attrib('normal');\n\t\tthis._is_up_present = this._group_wrapper.has_attrib('up');\n\n\t\tthis._do_rotate_matrices = this._is_normal_present; //&& this._is_up_present;\n\t}\n\n\tmatrices(): Matrix4[] {\n\t\tthis._matrices = {};\n\t\tthis._matrices[MATRIX_T] = new Matrix4();\n\t\tthis._matrices[MATRIX_R] = new Matrix4();\n\t\tthis._matrices[MATRIX_S] = new Matrix4();\n\n\t\treturn this._group_wrapper.points().map((point) => {\n\t\t\treturn this._matrix_from_point(point);\n\t\t});\n\t}\n\n\t_matrix_from_point(point: CorePoint): Matrix4 {\n\t\tconst t = point.position();\n\t\t//r = new Vector3(0,0,0)\n\t\tlet scale = this._is_scale_present ? point.attrib_value(SCALE_ATTRIB_NAME) : DEFAULT.SCALE;\n\t\tconst pscale = this._is_pscale_present ? point.attrib_value(PSCALE_ATTRIB_NAME) : DEFAULT.PSCALE;\n\t\tscale = scale.clone().multiplyScalar(pscale);\n\n\t\t//matrix = #Core.Transform.matrix(t, r, s, scale)\n\t\tconst matrix = new Matrix4();\n\t\tmatrix.identity();\n\n\t\tconst scale_matrix = this._matrices[MATRIX_S];\n\t\tscale_matrix.makeScale(scale.x, scale.y, scale.z);\n\n\t\tconst translate_matrix = this._matrices[MATRIX_T];\n\t\ttranslate_matrix.makeTranslation(t.x, t.y, t.z);\n\n\t\tmatrix.multiply(translate_matrix);\n\n\t\tif (this._do_rotate_matrices) {\n\t\t\tconst rotate_matrix = this._matrices[MATRIX_R];\n\t\t\tconst eye = DEFAULT.EYE;\n\t\t\tconst center = point.attrib_value(NORMAL_ATTRIB_NAME).multiplyScalar(-1);\n\t\t\tconst up = this._is_up_present ? point.attrib_value(UP_ATTRIB_NAME) : DEFAULT.UP;\n\t\t\tup.normalize();\n\t\t\trotate_matrix.lookAt(eye, center, up);\n\n\t\t\tmatrix.multiply(rotate_matrix);\n\t\t}\n\n\t\tmatrix.multiply(scale_matrix);\n\n\t\treturn matrix;\n\t}\n\n\tstatic create_instance_buffer_geo(\n\t\tgeometry_to_instance: BufferGeometry,\n\t\ttemplate_core_group: CoreGroup,\n\t\tattributes_to_copy: string\n\t) {\n\t\tconst instance_pts = template_core_group.points();\n\t\t// geometry_to_instance = new BoxBufferGeometry( 2, 2, 2 )\n\t\t// geometry = new InstancedBufferGeometry()\n\t\t// geometry.index = geometry_to_instance.index\n\t\t// geometry.attributes.position = geometry_to_instance.attributes.position\n\t\t// geometry.attributes.uv = geometry_to_instance.attributes.uv\n\n\t\tconst geometry = new InstancedBufferGeometry();\n\t\tgeometry.copy(geometry_to_instance);\n\n\t\tconst instances_count = instance_pts.length;\n\t\tconst positions = new Float32Array(instances_count * 3);\n\t\tconst colors = new Float32Array(instances_count * 3);\n\t\tconst scales = new Float32Array(instances_count * 3);\n\t\tconst orients = new Float32Array(instances_count * 4);\n\n\t\tconst has_color = template_core_group.has_attrib(ATTRIB_NAME_COLOR);\n\n\t\tconst position = new Vector3(0, 0, 0);\n\t\tconst quaternion = new Quaternion();\n\t\tconst scale = new Vector3(1, 1, 1);\n\n\t\tconst instancer = new CoreInstancer(template_core_group);\n\t\tconst instance_matrices = instancer.matrices();\n\n\t\tinstance_pts.forEach((instance_pt, i) => {\n\t\t\tconst index3 = i * 3;\n\t\t\tconst index4 = i * 4;\n\n\t\t\tconst matrix = instance_matrices[i];\n\t\t\tmatrix.decompose(position, quaternion, scale);\n\n\t\t\tposition.toArray(positions, index3);\n\t\t\tquaternion.toArray(orients, index4);\n\t\t\tscale.toArray(scales, index3);\n\n\t\t\tconst color = has_color ? instance_pt.attrib_value(ATTRIB_NAME_COLOR) : DEFAULT_COLOR;\n\t\t\tcolor.toArray(colors, index3);\n\t\t});\n\n\t\t// if(this._param_add_uv_offset){\n\t\tconst has_uv = template_core_group.has_attrib(ATTRIB_NAME_UV);\n\t\tif (has_uv) {\n\t\t\tconst uvs = new Float32Array(instances_count * 2);\n\t\t\tinstance_pts.forEach((instance_pt, i) => {\n\t\t\t\tconst index2 = i * 2;\n\t\t\t\tconst uv = has_uv ? instance_pt.attrib_value(ATTRIB_NAME_UV) : DEFAULT_UV;\n\t\t\t\tuv.toArray(uvs, index2);\n\t\t\t});\n\t\t\tgeometry.setAttribute('instanceUv', new InstancedBufferAttribute(uvs, 2));\n\t\t}\n\t\t// }\n\n\t\tgeometry.setAttribute('instancePosition', new InstancedBufferAttribute(positions, 3));\n\t\tgeometry.setAttribute('instanceScale', new InstancedBufferAttribute(scales, 3));\n\t\tgeometry.setAttribute('instanceOrientation', new InstancedBufferAttribute(orients, 4));\n\t\tgeometry.setAttribute('instanceColor', new InstancedBufferAttribute(colors, 3));\n\n\t\tconst attrib_names = template_core_group.attrib_names_matching_mask(attributes_to_copy);\n\n\t\tattrib_names.forEach((attrib_name) => {\n\t\t\tconst attrib_size = template_core_group.attrib_size(attrib_name);\n\t\t\tconst values = new Float32Array(instances_count * attrib_size);\n\t\t\tinstance_pts.forEach((pt, i) => {\n\t\t\t\tconst value = pt.attrib_value(attrib_name);\n\t\t\t\tif (lodash_isNumber(value)) {\n\t\t\t\t\tvalues[i] = value;\n\t\t\t\t} else {\n\t\t\t\t\tvalue.toArray(values, i * attrib_size);\n\t\t\t\t}\n\t\t\t});\n\t\t\tgeometry.setAttribute(attrib_name, new InstancedBufferAttribute(values, attrib_size));\n\t\t});\n\n\t\tconst geometry_wrapper = new CoreGeometry(geometry);\n\t\tgeometry_wrapper.mark_as_instance();\n\n\t\treturn geometry;\n\t}\n}\n","import {CorePoint} from 'src/core/geometry/Point';\nimport {CoreGraphNode} from 'src/core/graph/CoreGraphNode';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\n\nexport class CopyStamp extends CoreGraphNode {\n\tprivate _global_index: number = 0;\n\tprivate _point: CorePoint | undefined;\n\n\tconstructor(scene: PolyScene) {\n\t\tsuper(scene, 'CopyStamp');\n\t}\n\n\tset_point(point: CorePoint) {\n\t\tthis._point = point;\n\t\tthis.set_dirty();\n\t\tthis.remove_dirty_state();\n\t}\n\tset_global_index(index: number) {\n\t\tthis._global_index = index;\n\t\tthis.set_dirty();\n\t\tthis.remove_dirty_state();\n\t}\n\n\tvalue(attrib_name?: string) {\n\t\tif (this._point) {\n\t\t\tif (attrib_name) {\n\t\t\t\treturn this._point.attrib_value(attrib_name);\n\t\t\t} else {\n\t\t\t\treturn this._point.index;\n\t\t\t}\n\t\t} else {\n\t\t\treturn this._global_index;\n\t\t}\n\t}\n}\n","// import {Core} from 'src/Core/_Module';\nimport {TypedSopNode} from './_Base';\nimport {JsonDataLoader} from 'src/core/loader/geometry/JsonData';\n\nconst DEFAULT_DATA = [\n\t{value: -40},\n\t{value: -30},\n\t{value: -20},\n\t{value: -10},\n\t{value: 0},\n\t{value: 10},\n\t{value: 20},\n\t{value: 30},\n\t{value: 40},\n\t{value: 50},\n\t{value: 60},\n\t{value: 70},\n\t{value: 80},\n];\nconst DEFAULT_DATA_STR = JSON.stringify(DEFAULT_DATA);\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass DataSopParamsConfig extends NodeParamsConfig {\n\tdata = ParamConfig.STRING(DEFAULT_DATA_STR);\n}\nconst ParamsConfig = new DataSopParamsConfig();\n\nexport class DataSopNode extends TypedSopNode<DataSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'data';\n\t}\n\n\tcook() {\n\t\tlet json = null;\n\t\ttry {\n\t\t\tjson = JSON.parse(this.pv.data);\n\t\t} catch (e) {\n\t\t\tthis.states.error.set('could not parse json');\n\t\t}\n\n\t\tif (json) {\n\t\t\tconst loader = new JsonDataLoader();\n\t\t\tloader.set_json(json);\n\t\t\tconst object = loader.create_object();\n\t\t\tthis.set_object(object);\n\t\t} else {\n\t\t\tthis.cook_controller.end_cook();\n\t\t}\n\t}\n}\n","import lodash_isArray from 'lodash/isArray'\nimport lodash_isString from 'lodash/isString'\nimport {CoreConstant} from './Constant'\n\nexport class CoreAttributeData {\n\tconstructor(private _size: number, private _type: number) {}\n\n\tsize() {\n\t\treturn this._size\n\t}\n\ttype() {\n\t\treturn this._type\n\t}\n\n\tstatic from_value(attrib_value: any) {\n\t\tconst type = lodash_isString(attrib_value)\n\t\t\t? CoreConstant.ATTRIB_TYPE.STRING\n\t\t\t: CoreConstant.ATTRIB_TYPE.NUMERIC\n\t\tconst size = lodash_isArray(attrib_value) ? attrib_value.length : 1\n\n\t\treturn new this(size, type)\n\t}\n}\n","import {Object3D} from 'three/src/core/Object3D';\n// import lodash_flatten from 'lodash/flatten';\nimport {TypedSopNode} from './_Base';\n\n// import {CoreLoaderGeometry, LoaderType, LOADER_TYPES} from 'src/Core/Loader/Geometry';\nimport {JsonDataLoader} from 'src/core/loader/geometry/JsonData';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {BaseNodeType} from '../_Base';\nclass DataUrlSopParamsConfig extends NodeParamsConfig {\n\turl = ParamConfig.STRING('/examples/sop/data_url/basic.json');\n\tjson_data_keys_prefix = ParamConfig.STRING('');\n\tskip_entries = ParamConfig.STRING('');\n\tconvert = ParamConfig.BOOLEAN(0);\n\tconvert_to_numeric = ParamConfig.STRING('', {\n\t\tvisible_if: {convert: 1},\n\t});\n\treload = ParamConfig.BUTTON(null, {\n\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\tDataUrlSopNode.PARAM_CALLBACK_reload(node as DataUrlSopNode, param);\n\t\t},\n\t});\n}\nconst ParamsConfig = new DataUrlSopParamsConfig();\n\nexport class DataUrlSopNode extends TypedSopNode<DataUrlSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'data_url';\n\t}\n\n\t// TODO: no error when trying to load a non existing zip file??\n\tasync cook() {\n\t\tconst loader = new JsonDataLoader({\n\t\t\tdata_keys_prefix: this.pv.json_data_keys_prefix,\n\t\t\tskip_entries: this.pv.skip_entries,\n\t\t\tdo_convert: this.pv.convert,\n\t\t\tconvert_to_numeric: this.pv.convert_to_numeric,\n\t\t});\n\t\tloader.load(this.pv.url, this._on_load.bind(this), undefined, this._on_error.bind(this));\n\t}\n\n\t_on_load(objects: Object3D) {\n\t\t// objects = lodash_flatten(objects);\n\t\tthis.set_objects([objects]);\n\t}\n\t_on_error(error: ErrorEvent) {\n\t\tthis.states.error.set(`could not load geometry from ${this.pv.url} (${error})`);\n\t\tthis.cook_controller.end_cook();\n\t}\n\n\t// async _on_open_url(){\n\t// \tconst url = await this.param('url').eval_p()\n\t// \tconst a = document.createElement('a')\n\t// \ta.href = url\n\t// \ta.setAttribute('target', '_blank')\n\t// \ta.click()\n\t// }\n\n\tstatic PARAM_CALLBACK_reload(node: DataUrlSopNode, param: BaseParamType) {\n\t\tnode.param_callback_reload();\n\t}\n\tparam_callback_reload() {\n\t\t// this._previous_param_url = null\n\n\t\t// set the param dirty is preferable, in case this is used to refresh a local asset\n\t\tthis.p.url.set_dirty();\n\t\t// this.set_dirty()\n\t}\n}\n","import {TypedSopNode} from './_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\nclass DelaySopParamsConfig extends NodeParamsConfig {\n\tduration = ParamConfig.INTEGER(1000);\n}\nconst ParamsConfig = new DelaySopParamsConfig();\n\nexport class DelaySopNode extends TypedSopNode<DelaySopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'delay';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.ALWAYS]);\n\t}\n\n\tcook(inputs_contents: CoreGroup[]) {\n\t\tconst core_group = inputs_contents[0];\n\t\tconst c = () => {\n\t\t\tthis.set_core_group(core_group);\n\t\t};\n\t\tsetTimeout(c, this.pv.duration);\n\t}\n}\n","import {Box3} from 'three/src/math/Box3';\nimport lodash_isString from 'lodash/isString';\nimport lodash_each from 'lodash/each';\nimport {TypedSopNode} from './_Base';\nimport {CoreString} from 'src/core/String';\nimport {\n\tAttribClass,\n\tAttribClassMenuEntries,\n\tObjectType,\n\tObjectTypeMenuEntries,\n\tObjectTypes,\n} from 'src/core/geometry/Constant';\nimport {CoreGroup, Object3DWithGeometry} from 'src/core/geometry/Group';\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {CoreObject} from 'src/core/geometry/Object';\n\nenum ComparisonOperator {\n\t'==' = 0,\n\t'<' = 1,\n\t'<=' = 2,\n\t'>=' = 3,\n\t'>' = 4,\n\t'!=' = 5,\n}\nconst ComparisonOperatorMenuEntries = [\n\t{name: '==', value: ComparisonOperator['==']},\n\t{name: '<', value: ComparisonOperator['<']},\n\t{name: '<=', value: ComparisonOperator['<=']},\n\t{name: '>=', value: ComparisonOperator['>=']},\n\t{name: '>', value: ComparisonOperator['>']},\n\t{name: '!=', value: ComparisonOperator['!=']},\n];\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass DeleteSopParamsConfig extends NodeParamsConfig {\n\tclass = ParamConfig.INTEGER(AttribClass.VERTEX, {\n\t\tmenu: {\n\t\t\tentries: AttribClassMenuEntries,\n\t\t},\n\t});\n\tinvert = ParamConfig.BOOLEAN(0);\n\thide_objects = ParamConfig.BOOLEAN(0);\n\n\t// by_object_type\n\tby_object_type = ParamConfig.BOOLEAN(0);\n\tobject_type = ParamConfig.INTEGER(ObjectTypes.indexOf(ObjectType.MESH), {\n\t\tmenu: {\n\t\t\tentries: ObjectTypeMenuEntries,\n\t\t},\n\t\tvisible_if: {by_object_type: true},\n\t});\n\n\t// by_expression\n\tby_expression = ParamConfig.BOOLEAN(0);\n\texpression = ParamConfig.BOOLEAN('@ptnum==0', {\n\t\tvisible_if: {by_expression: true},\n\t\texpression: {for_entities: true},\n\t});\n\n\t// by_attrib\n\tby_attrib = ParamConfig.BOOLEAN(0);\n\tattrib_name = ParamConfig.STRING('', {\n\t\tvisible_if: {by_attrib: true},\n\t});\n\tattrib_string = ParamConfig.STRING('', {\n\t\tvisible_if: {by_attrib: true},\n\t});\n\t// attrib_float = ParamConfig.FLOAT(0, {\n\t// \tvisible_if: {by_attrib: true},\n\t// })\n\tattrib_numeric = ParamConfig.VECTOR4([0, 0, 0, 0], {\n\t\tvisible_if: {by_attrib: true},\n\t});\n\tattrib_comparison_operator = ParamConfig.INTEGER(ComparisonOperator['=='], {\n\t\tmenu: {\n\t\t\tentries: ComparisonOperatorMenuEntries,\n\t\t},\n\t\tvisible_if: {by_attrib: true},\n\t});\n\n\t// by_bbox\n\tby_bbox = ParamConfig.BOOLEAN(0);\n\tbbox_size = ParamConfig.VECTOR3([1, 1, 1], {\n\t\tvisible_if: {by_bbox: true},\n\t});\n\tbbox_center = ParamConfig.VECTOR3([0, 0, 0], {\n\t\tvisible_if: {by_bbox: true},\n\t});\n\t//this.add_param( ParamType.STRING, 'index_mode', Core.Geometry.Geometry.INDEX_MODE_FACES )\n\n\t// by_visible\n\tby_visible = ParamConfig.BOOLEAN(0);\n\tkeep_points = ParamConfig.BOOLEAN(1, {\n\t\tvisible_if: {\n\t\t\tclass: AttribClass.OBJECT,\n\t\t},\n\t});\n}\nconst ParamsConfig = new DeleteSopParamsConfig();\n\nexport class DeleteSopNode extends TypedSopNode<DeleteSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'delete';\n\t}\n\n\t// _param_attrib_class: number;\n\t// _param_invert: boolean;\n\t// _param_hide_objects: boolean;\n\t// _param_by_object_type: boolean;\n\t// _param_object_type: number;\n\t// _param_by_attrib: boolean;\n\t// _param_attrib_name: string;\n\t// _param_attrib_float: number;\n\t// _param_attrib_string: string;\n\t// _param_attrib_vector: Vector3;\n\t// _param_attrib_ComparisonOperator: number;\n\t// _param_by_expression: boolean;\n\t// _param_expression: string;\n\t// _param_by_bbox: boolean;\n\t// _param_bbox_size: Vector3;\n\t// _param_bbox_center: Vector3;\n\t// _param_by_visible: boolean;\n\n\tprivate _bbox_cache: Box3 | undefined;\n\n\tprivate _marked_for_deletion_per_object_index: Map<number, boolean> = new Map();\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to delete from'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tthis._bbox_cache = undefined;\n\t\tswitch (this.pv.class) {\n\t\t\tcase AttribClass.VERTEX:\n\t\t\t\tawait this._eval_for_points(core_group);\n\t\t\t\tbreak;\n\t\t\tcase AttribClass.OBJECT:\n\t\t\t\tawait this._eval_for_objects(core_group);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate async _eval_for_objects(core_group: CoreGroup) {\n\t\t// const objects_to_delete = [];\n\t\tconst objects_to_keep = [];\n\t\tconst core_objects = core_group.core_objects();\n\n\t\tthis._marked_for_deletion_per_object_index = new Map();\n\t\tfor (let core_object of core_objects) {\n\t\t\tthis._marked_for_deletion_per_object_index.set(core_object.index, false);\n\t\t}\n\n\t\tif (this.pv.by_expression) {\n\t\t\tawait this._eval_expressions_for_objects(core_objects);\n\t\t}\n\n\t\tif (this.pv.by_object_type) {\n\t\t\tthis._eval_type_for_objects(core_objects);\n\t\t}\n\n\t\tif (this.pv.by_attrib && this.pv.attrib_name !== '') {\n\t\t\tthis._eval_attrib_for_objects(core_objects);\n\n\t\t\t// \tif !is_deleted && @_param_by_bbox\n\t\t\t// \t\tis_deleted = this._eval_bbox_for_object(object)\n\n\t\t\t// \tif !is_deleted && @_param_by_visible\n\t\t\t// \t\tis_deleted = !object.visible\n\n\t\t\t// \tif @_param_invert\n\t\t\t// \t\tis_deleted = !is_deleted\n\n\t\t\t// \tif @_param_hide_objects\n\t\t\t// \t\tobject.visible = !is_deleted\n\t\t\t// \telse\n\t\t\t// \t\tif is_deleted\n\t\t\t// \t\t\tobjects_to_delete.push(object)\n\n\t\t\t// true; // to ensure the loop isn't breaking, which is what happens when setting the object.visible to false...\n\t\t}\n\n\t\tif (this.pv.invert) {\n\t\t\tthis._marked_for_deletion_per_object_index.forEach((marked_for_deletion, object_index) => {\n\t\t\t\tthis._marked_for_deletion_per_object_index.set(object_index, !marked_for_deletion);\n\t\t\t});\n\t\t}\n\n\t\tlet core_object, object;\n\t\tconst point_objects_from_deleted_objects: Object3DWithGeometry[] = [];\n\t\t// for (let object_index of Object.keys(this._marked_for_deletion_per_object_index)) {\n\t\tthis._marked_for_deletion_per_object_index.forEach((marked_for_deletion, object_index) => {\n\t\t\tcore_object = core_objects[object_index];\n\t\t\tobject = core_object.object();\n\n\t\t\tif (this.pv.hide_objects) {\n\t\t\t\tobjects_to_keep.push(object);\n\t\t\t\tif (marked_for_deletion) {\n\t\t\t\t\tobject.visible = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!marked_for_deletion) {\n\t\t\t\t\tobjects_to_keep.push(object);\n\t\t\t\t}\n\t\t\t\tif (marked_for_deletion) {\n\t\t\t\t\tpoint_objects_from_deleted_objects.push(this._point_object(core_object));\n\t\t\t\t}\n\t\t\t}\n\t\t\t// if (marked_for_deletion) {\n\t\t\t// \tcmptr += 1;\n\t\t\t// \tif (this.pv.hide_objects) {\n\t\t\t// \t\tobject.visible = true;\n\n\t\t\t// \t} else {\n\t\t\t// \t\t// object.parent.remove(object);\n\t\t\t// \t\t// const c = () =>\n\t\t\t// \t\t// \tobject.traverse(function(object_child) {\n\t\t\t// \t\t// \t\tif (object_child.geometry != null) {\n\t\t\t// \t\t// \t\t\tobject_child.geometry.dispose();\n\t\t\t// \t\t// \t\t}\n\t\t\t// \t\t// \t\t// const material = object_child.material\n\t\t\t// \t\t// \t\t// if(material){ material.dispose() }\n\t\t\t// \t\t// \t})\n\t\t\t// \t\t// ;\n\t\t\t// \t\t// setTimeout(c, 25);\n\t\t\t// \t}\n\t\t\t// }\n\t\t});\n\n\t\tfor (let object of point_objects_from_deleted_objects) {\n\t\t\tobjects_to_keep.push(object);\n\t\t}\n\n\t\tthis.set_objects(objects_to_keep);\n\t}\n\n\t//console.log(\"#{cmptr} marked for deletion\")\n\n\t// TODO: ensure that geometries with no remaining points are removed from the group\n\tprivate async _eval_for_points(core_group: CoreGroup) {\n\t\tconst core_objects = core_group.core_objects();\n\t\tlet core_object;\n\t\tfor (let i = 0; i < core_objects.length; i++) {\n\t\t\tcore_object = core_objects[i];\n\t\t\tlet core_geometry = core_object.core_geometry();\n\t\t\tif (core_geometry) {\n\t\t\t\tlet points = core_geometry.points_from_geometry();\n\t\t\t\tconst init_points_count = points.length;\n\t\t\t\tif (this.pv.by_expression) {\n\t\t\t\t\tpoints = await this._eval_expressions_for_points(points);\n\t\t\t\t}\n\n\t\t\t\tif (this.pv.by_attrib && this.pv.attrib_name !== '') {\n\t\t\t\t\tpoints = this._eval_attrib_for_points(points);\n\t\t\t\t}\n\t\t\t\tif (this.pv.by_bbox) {\n\t\t\t\t\tpoints = this._eval_bbox_for_points(points);\n\t\t\t\t}\n\n\t\t\t\tif (points.length != init_points_count) {\n\t\t\t\t\tconst object = core_object.object() as Object3DWithGeometry;\n\t\t\t\t\tcore_geometry.geometry().dispose();\n\t\t\t\t\tif (points.length > 0) {\n\t\t\t\t\t\t// TODO: if the new geo only has unconnected points, how do I know it and how do I change the material if it was previously a mesh?\n\t\t\t\t\t\tobject.geometry = CoreGeometry.geometry_from_points(\n\t\t\t\t\t\t\tpoints,\n\t\t\t\t\t\t\t(<unknown>object.constructor) as ObjectType\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// TODO: do not dispose material if not cloned\n\t\t\t\t\t\t// if (object.material != null) {\n\t\t\t\t\t\t// \tobject.material.dispose();\n\t\t\t\t\t\t// }\n\t\t\t\t\t\tobject.parent != null ? object.parent.remove(object) : undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n\n\tprivate async _eval_expressions_for_points(points: CorePoint[]) {\n\t\tconst kept_points = [];\n\n\t\t// const promises = points.map((point, i)=> {\n\t\t// \treturn new Promise( async (resolve, reject)=> {\n\t\t// \t\tthis.context().set_entity(point);\n\t\t// \t\tconst val = await(this.param('expression').eval_p());\n\t\t// \t\tconst keep_point = this.pv.invert ?\n\t\t// \t\t\tval === true\n\t\t// \t\t:\n\t\t// \t\t\tval === false;\n\n\t\t// \t\tif (keep_point) {\n\t\t// \t\t\tkept_points.push(point);\n\t\t// \t\t}\n\t\t// \t\tresolve();\n\t\t// \t});\n\t\t// });\n\n\t\t// await(Promise.all(promises));\n\t\tconst param = this.p.expression;\n\t\tif (this.p.expression.has_expression() && param.expression_controller) {\n\t\t\tawait param.expression_controller.compute_expression_for_points(points, (point, value) => {\n\t\t\t\tlet keep_point = !value;\n\t\t\t\tif (this.pv.invert) {\n\t\t\t\t\tkeep_point = !keep_point;\n\t\t\t\t}\n\t\t\t\tif (keep_point) {\n\t\t\t\t\tkept_points.push(point);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tconst value = this.pv.expression;\n\t\t\tlet keep_point = !value;\n\t\t\tif (this.pv.invert) {\n\t\t\t\tkeep_point = !keep_point;\n\t\t\t}\n\t\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\t\tif (keep_point) {\n\t\t\t\t\tkept_points.push(points[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconsole.log(kept_points);\n\t\treturn kept_points;\n\t}\n\n\tprivate async _eval_expressions_for_objects(core_objects: CoreObject[]) {\n\t\tconst param = this.p.expression;\n\n\t\tif (param.has_expression() && param.expression_controller) {\n\t\t\tawait param.expression_controller.compute_expression_for_objects(core_objects, (core_object, value) => {\n\t\t\t\tconst is_marked_for_deletion = this._marked_for_deletion_per_object_index.get(core_object.index);\n\t\t\t\tif (!is_marked_for_deletion) {\n\t\t\t\t\tthis._marked_for_deletion_per_object_index.set(core_object.index, value);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tfor (let core_object of core_objects) {\n\t\t\t\tthis._marked_for_deletion_per_object_index.set(core_object.index, param.value);\n\t\t\t}\n\t\t}\n\n\t\t// for (let core_object of core_objects) {\n\t\t// \tconst is_marked_for_deletion = this._marked_for_deletion_per_object_index.get(core_object.index);\n\n\t\t// \tif (!is_marked_for_deletion) {\n\t\t// \t\tthis.processing_context.set_entity(core_object);\n\t\t// \t\t// param.set_dirty();\n\t\t// \t\tawait param.compute();\n\t\t// \t\tthis._marked_for_deletion_per_object_index.set(core_object.index, param.value);\n\t\t// \t}\n\t\t// }\n\t}\n\n\tprivate _eval_attrib_for_points(points: CorePoint[]) {\n\t\tconst kept_points: CorePoint[] = [];\n\n\t\tif (points.length > 0) {\n\t\t\tconst first_attrib_value = points[0].attrib_value(this.pv.attrib_name);\n\t\t\t// TODO: should I just have @_param_attrib_string?\n\t\t\t// although I may need a vector one... maybe a multiple string?\n\t\t\tconst comparison_attrib_values = lodash_isString(first_attrib_value)\n\t\t\t\t? //@_param_attrib_string\n\t\t\t\t  CoreString.attrib_names(this.pv.attrib_string)\n\t\t\t\t: [this.pv.attrib_numeric.x];\n\n\t\t\tcomparison_attrib_values.forEach((comparison_attrib_value: string | number) => {\n\t\t\t\treturn points.forEach((point) => {\n\t\t\t\t\tconst attrib_value = point.attrib_value(this.pv.attrib_name);\n\n\t\t\t\t\t// TODO: and for vectors? should I have a point.attrib(name).is_equal(value)\n\t\t\t\t\t// or point.is_attrib_equal(name, value) ?\n\t\t\t\t\t//keep_point = (attrib_value != comparison_attrib_value)\n\t\t\t\t\tlet keep_point = !this._comparison(attrib_value, comparison_attrib_value);\n\n\t\t\t\t\tif (this.pv.invert) {\n\t\t\t\t\t\tkeep_point = !keep_point;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (keep_point) {\n\t\t\t\t\t\treturn kept_points.push(point);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn kept_points;\n\t}\n\n\tprivate _comparison(attrib_value: number | string, comparison_attrib_value: number | string) {\n\t\tswitch (this.pv.attrib_ComparisonOperator) {\n\t\t\tcase ComparisonOperator['==']:\n\t\t\t\treturn attrib_value === comparison_attrib_value;\n\t\t\tcase ComparisonOperator['<=']:\n\t\t\t\treturn attrib_value <= comparison_attrib_value;\n\t\t\tcase ComparisonOperator['<']:\n\t\t\t\treturn attrib_value < comparison_attrib_value;\n\t\t\tcase ComparisonOperator['>']:\n\t\t\t\treturn attrib_value > comparison_attrib_value;\n\t\t\tcase ComparisonOperator['>=']:\n\t\t\t\treturn attrib_value >= comparison_attrib_value;\n\t\t\tcase ComparisonOperator['!=']:\n\t\t\t\treturn attrib_value !== comparison_attrib_value;\n\t\t}\n\t}\n\n\tprivate _eval_type_for_objects(core_objects: CoreObject[]) {\n\t\tconst object_type_name = ObjectTypes[this.pv.object_type];\n\n\t\tfor (let core_object of core_objects) {\n\t\t\tconst is_marked_for_deletion = this._marked_for_deletion_per_object_index.get(core_object.index);\n\n\t\t\tif (!is_marked_for_deletion) {\n\t\t\t\tconst object = core_object.object();\n\n\t\t\t\tif (object.constructor.name === object_type_name) {\n\t\t\t\t\tthis._marked_for_deletion_per_object_index.set(core_object.index, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _eval_attrib_for_objects(core_objects: CoreObject[]) {\n\t\tfor (let core_object of core_objects) {\n\t\t\tconst is_marked_for_deletion = this._marked_for_deletion_per_object_index.get(core_object.index);\n\n\t\t\tif (!is_marked_for_deletion) {\n\t\t\t\t// const object = core_object.object();\n\t\t\t\tconst attrib_value = core_object.attrib_value(this.pv.attrib_name);\n\n\t\t\t\tconst comparison_attrib_value = lodash_isString(attrib_value)\n\t\t\t\t\t? this.pv.attrib_string\n\t\t\t\t\t: this.pv.attrib_float;\n\n\t\t\t\tif (attrib_value === comparison_attrib_value) {\n\t\t\t\t\tthis._marked_for_deletion_per_object_index.set(core_object.index, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _eval_bbox_for_points(points: CorePoint[]) {\n\t\tconst kept_points: CorePoint[] = [];\n\n\t\tlodash_each(points, (point, i) => {\n\t\t\tconst in_bbox = this._bbox.containsPoint(point.position());\n\n\t\t\tconst keep_point = this.pv.invert ? in_bbox : !in_bbox;\n\n\t\t\tif (keep_point) {\n\t\t\t\treturn kept_points.push(point);\n\t\t\t}\n\t\t});\n\n\t\treturn kept_points;\n\t}\n\n\t// private _eval_bbox_for_object(object: Object3D): boolean {\n\t// \tconst object_bbox = new Box3().setFromObject(object);\n\t// \tconst center = new Vector3();\n\t// \tobject_bbox.getCenter(center);\n\n\t// \treturn this.pv.bbox().containsPoint(center);\n\t// }\n\n\tprivate get _bbox() {\n\t\treturn this._bbox_cache != null\n\t\t\t? this._bbox_cache\n\t\t\t: (this._bbox_cache = new Box3(\n\t\t\t\t\tthis.pv.bbox_center.clone().sub(this.pv.bbox_size.clone().multiplyScalar(0.5)),\n\t\t\t\t\tthis.pv.bbox_center.clone().add(this.pv.bbox_size.clone().multiplyScalar(0.5))\n\t\t\t  ));\n\t}\n\n\tprivate _point_object(core_object: CoreObject) {\n\t\tconst core_points = core_object.points();\n\t\tconst geometry = CoreGeometry.geometry_from_points(\n\t\t\tcore_points,\n\t\t\t(<unknown>core_object.object().constructor) as ObjectType\n\t\t);\n\t\treturn this.create_object(geometry, ObjectType.POINTS);\n\t}\n}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport lodash_range from 'lodash/range';\nimport lodash_times from 'lodash/times';\nimport lodash_chunk from 'lodash/chunk';\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {CoreFace} from 'src/core/geometry/Face';\nclass FaceSopParamsConfig extends NodeParamsConfig {\n\tmake_faces_unique = ParamConfig.BOOLEAN(0);\n\tadd_face_center_attribute = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {make_faces_unique: 1},\n\t});\n\tadd_face_id = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {make_faces_unique: 1},\n\t});\n\ttransform = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {make_faces_unique: 1},\n\t});\n\tscale = ParamConfig.FLOAT(1, {\n\t\tvisible_if: {make_faces_unique: 1, transform: 1},\n\t});\n}\nconst ParamsConfig = new FaceSopParamsConfig();\n\nexport class FaceSopNode extends TypedSopNode<FaceSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'face';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tif (this.pv.make_faces_unique) {\n\t\t\tthis._make_faces_unique(core_group);\n\n\t\t\t// we can only add face_center attrib\n\t\t\t// if the faces have been split\n\t\t\t// otherwise a point may belong to multiple faces\n\t\t\tif (this.pv.add_face_center_attribute) {\n\t\t\t\tthis._add_face_center_attribute(core_group);\n\t\t\t}\n\t\t\tif (this.pv.add_face_id) {\n\t\t\t\tthis._add_face_id(core_group);\n\t\t\t}\n\t\t\tif (this.pv.transform) {\n\t\t\t\tthis._transform_faces(core_group);\n\t\t\t}\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n\n\tprivate _make_faces_unique(core_group: CoreGroup) {\n\t\tfor (let object of core_group.objects()) {\n\t\t\tif ((object as Mesh).isMesh) {\n\t\t\t\tconst geometry = (object as Mesh).geometry as BufferGeometry;\n\t\t\t\tconst faces = lodash_chunk(geometry.index?.array || [], 3);\n\t\t\t\tconst points_count = faces.length * 3;\n\t\t\t\tfor (let attrib_name of Object.keys(geometry.attributes)) {\n\t\t\t\t\tconst attrib = geometry.attributes[attrib_name];\n\t\t\t\t\tconst attrib_size = attrib.itemSize;\n\t\t\t\t\tconst new_values = new Float32Array(points_count * attrib_size);\n\t\t\t\t\tlet new_value_index = 0;\n\t\t\t\t\tfaces.forEach((face) => {\n\t\t\t\t\t\tface.forEach((index) => {\n\t\t\t\t\t\t\tlodash_times(attrib_size, (i) => {\n\t\t\t\t\t\t\t\tconst current_value = attrib.array[index * attrib_size + i];\n\t\t\t\t\t\t\t\tnew_values[new_value_index] = current_value;\n\t\t\t\t\t\t\t\tnew_value_index += 1;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tgeometry.setAttribute(attrib_name, new BufferAttribute(new_values, attrib_size));\n\t\t\t\t}\n\t\t\t\tconst new_indices = lodash_range(points_count);\n\t\t\t\tgeometry.setIndex(new_indices);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _add_face_center_attribute(core_group: CoreGroup) {\n\t\tconst attrib_name = 'face_center';\n\t\tconst face_center = new Vector3();\n\t\tlet faces: CoreFace[], face: CoreFace, points: CorePoint[], point: CorePoint;\n\n\t\tcore_group.core_objects().forEach((core_object) => {\n\t\t\tconst object = core_object.object();\n\t\t\tconst core_geometry = core_object.core_geometry();\n\t\t\tif ((object as Mesh).isMesh) {\n\t\t\t\tfaces = core_geometry.faces();\n\t\t\t\tif (!core_geometry.has_attrib(attrib_name)) {\n\t\t\t\t\tcore_geometry.add_numeric_attrib(attrib_name, 3, -1);\n\t\t\t\t}\n\n\t\t\t\tfor (let fi = 0; fi < faces.length; fi++) {\n\t\t\t\t\tface = faces[fi];\n\t\t\t\t\tface.center(face_center);\n\n\t\t\t\t\tpoints = face.points;\n\t\t\t\t\tfor (let pi = 0; pi < points.length; pi++) {\n\t\t\t\t\t\tpoint = points[pi];\n\t\t\t\t\t\tpoint.set_attrib_value(attrib_name, face_center);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _add_face_id(core_group: CoreGroup) {\n\t\tconst attrib_name = 'face_id';\n\n\t\tcore_group.core_objects().forEach((core_object) => {\n\t\t\tconst object = core_object.object();\n\t\t\tconst core_geometry = core_object.core_geometry();\n\t\t\tif ((object as Mesh).isMesh) {\n\t\t\t\tconst faces = core_geometry.faces();\n\t\t\t\t// const points_count = core_geometry.points_count();\n\n\t\t\t\tif (!core_geometry.has_attrib(attrib_name)) {\n\t\t\t\t\tcore_geometry.add_numeric_attrib(attrib_name, 1, -1);\n\t\t\t\t}\n\n\t\t\t\tfor (let i = 0; i < faces.length; i++) {\n\t\t\t\t\tconst face = faces[i];\n\t\t\t\t\tconst points = face.points;\n\t\t\t\t\tfor (let j = 0; j < points.length; j++) {\n\t\t\t\t\t\tconst point = points[j];\n\t\t\t\t\t\tpoint.set_attrib_value(attrib_name, i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _transform_faces(core_group: CoreGroup) {\n\t\tconst attrib_name = 'position';\n\t\tconst face_center = new Vector3();\n\t\tconst new_position = new Vector3();\n\t\tconst scale = this.pv.scale;\n\t\tlet faces: CoreFace[], face: CoreFace, points: CorePoint[], point: CorePoint;\n\n\t\tcore_group.core_objects().forEach((core_object) => {\n\t\t\tconst object = core_object.object();\n\t\t\tconst core_geometry = core_object.core_geometry();\n\t\t\tif ((object as Mesh).isMesh) {\n\t\t\t\tfaces = core_geometry.faces();\n\t\t\t\tif (!core_geometry.has_attrib(attrib_name)) {\n\t\t\t\t\tcore_geometry.add_numeric_attrib(attrib_name, 3, -1);\n\t\t\t\t}\n\n\t\t\t\tfor (let fi = 0; fi < faces.length; fi++) {\n\t\t\t\t\tface = faces[fi];\n\t\t\t\t\tface.center(face_center);\n\n\t\t\t\t\tpoints = face.points;\n\t\t\t\t\tfor (let pi = 0; pi < points.length; pi++) {\n\t\t\t\t\t\tpoint = points[pi];\n\t\t\t\t\t\tconst position = point.position();\n\t\t\t\t\t\tnew_position.x = position.x * scale + face_center.x * (1 - scale);\n\t\t\t\t\t\tnew_position.y = position.y * scale + face_center.y * (1 - scale);\n\t\t\t\t\t\tnew_position.z = position.z * scale + face_center.z * (1 - scale);\n\t\t\t\t\t\tpoint.set_attrib_value(attrib_name, new_position);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","import lodash_flatten from 'lodash/flatten';\n// import lodash_clone from 'lodash/clone';\n// import lodash_merge from 'lodash/merge';\nimport {TypedSopNode} from './_Base';\nimport {Object3D} from 'three/src/core/Object3D';\n\nimport {CoreLoaderGeometry} from 'src/core/loader/Geometry';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {BaseNodeType} from '../_Base';\nclass FileSopParamsConfig extends NodeParamsConfig {\n\turl = ParamConfig.STRING('', {\n\t\tdesktop_browse: {file_type: 'geometry'},\n\t\talways_reference_asset: true,\n\t});\n\treload = ParamConfig.BUTTON(null, {\n\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\tFileSopNode.PARAM_CALLBACK_reload(node as FileSopNode);\n\t\t},\n\t});\n}\nconst ParamsConfig = new FileSopParamsConfig();\n\nexport class FileSopNode extends TypedSopNode<FileSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'file';\n\t}\n\n\tinitialize_node() {\n\t\t// this.io.inputs.set_count_to_zero();\n\t}\n\n\t// TODO: no error when trying to load a non existing zip file??\n\tcook() {\n\t\tconst loader = new CoreLoaderGeometry(this.pv.url);\n\t\tloader.load(this._on_load.bind(this), this._on_error.bind(this));\n\t}\n\n\tprivate _on_load(objects: Object3D[]) {\n\t\tconsole.log('objects', objects);\n\t\tobjects = lodash_flatten(objects);\n\t\tthis.set_objects(objects);\n\t}\n\tprivate _on_error(message: string) {\n\t\tthis.states.error.set(`could not load geometry from ${this.pv.url} (${message})`);\n\t}\n\n\t// if I add this again, check if it can also work for desktop\n\t// async _on_open_url() {\n\t// \tconst url = this.pv.url\n\t// \tconst a = document.createElement('a');\n\t// \ta.href = url;\n\t// \ta.setAttribute('target', '_blank');\n\t// \ta.click();\n\t// }\n\n\tstatic PARAM_CALLBACK_reload(node: FileSopNode) {\n\t\tnode.param_callback_reload();\n\t}\n\tprivate param_callback_reload() {\n\t\t// this._previous_param_url = null\n\n\t\t// set the param dirty is preferable, in case this is used to refresh a local asset\n\t\tthis.p.url.set_dirty();\n\t\t// this.set_dirty()\n\t}\n\t// json_data_keys_prefix(){ return this.pv.json_data_keys_prefix }\n\t// json_skip_entries(){ return this.pv.skip_entries }\n\t// json_convert(){ return this.pv.convert }\n\t// json_convert_to_numeric(){ return this.pv.convert_to_numeric }\n}\n","import {ObjectLoader} from 'three/src/loaders/ObjectLoader';\nimport {Object3D} from 'three/src/core/Object3D';\n// import lodash_isArray from 'lodash/isArray';\n// import {CoreString} from 'src/core/String';\n\n// import {GeometryLoaderModule} from './Geometry/_Module';\n// import {DRACOLoader} from './Geometry/DRACOLoader';\n// import {JsonData} from './Geometry/JsonData'\n// import {CoreScriptLoader} from './Script';\nimport axios from 'axios';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {MeshLambertMaterial} from 'three/src/materials/MeshLambertMaterial';\n\n// import {DDSLoader} from 'modules/three/examples/jsm/loaders/DDSLoader';\n// import {DRACOLoader} from 'modules/three/examples/jsm/loaders/DRACOLoader';\n// import {GLTFLoader} from 'modules/three/examples/jsm/loaders/GLTFLoader';\n// import {OBJLoader} from 'modules/three/examples/jsm/loaders/OBJLoader';\n\n// const GLTFLoaders = ['DDSLoader', 'DRACOLoader', 'GLTFLoader'];\n// const SCRIPT_URLS_BY_EXT = {\n// \tgltf: GLTFLoaders,\n// \tglb: GLTFLoaders,\n// \tobj: 'OBJLoader',\n// };\n// const THREE_LOADER_BY_EXT = {\n// \tgltf: 'GLTFLoader',\n// \tglb: 'GLTFLoader',\n// \tobj: 'OBJLoader',\n// };\n// const DRACO_EXTENSIONS = ['gltf', 'glb']\n// const DRACO_EXTENSIONS = ['drc'];\n\n// export enum LoaderType {\n// \tAUTO = 'auto',\n// \tJSON_DATA = 'json_data',\n// \t// THREEJS_JSON = 'threejs_json',\n// }\n// export const LOADER_TYPES = [\n// \tLoaderType.AUTO,\n// \tLoaderType.JSON_DATA,\n// \t// LoaderType.THREEJS_JSON,\n// ];\n\nexport class CoreLoaderGeometry {\n\tprivate ext: string;\n\n\tconstructor(\n\t\tprivate url: string // private type: LoaderType, // private requester: any\n\t) {\n\t\tconst elements = this.url.split('.');\n\t\tthis.ext = elements[elements.length - 1].toLowerCase();\n\t\tif (this.ext === 'zip') {\n\t\t\tthis.ext = elements[elements.length - 2];\n\t\t}\n\t\t// if(!this.type){\n\t\t// \tconsole.error(\"CoreLoaderGeometry type is not valid\", this.type)\n\t\t// }\n\t}\n\n\tload(on_success: (objects: Object3D[]) => void, on_error: (error: string) => void) {\n\t\tthis.load_auto()\n\t\t\t.then((object) => {\n\t\t\t\ton_success(object);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\ton_error(error);\n\t\t\t});\n\t}\n\n\tprivate load_auto(): Promise<any> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tconst url = this.url; //.includes('?') ? this.url : `${this.url}?${Date.now()}`;\n\n\t\t\tif (this.ext == 'json') {\n\t\t\t\taxios\n\t\t\t\t\t.get(url)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tconst obj_loader = new ObjectLoader();\n\t\t\t\t\t\tobj_loader.parse(response.data, (obj) => {\n\t\t\t\t\t\t\tresolve(this.on_load_success(obj.children[0]));\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst loader = await this.loader_for_ext();\n\t\t\t\tif (loader) {\n\t\t\t\t\tloader.load(\n\t\t\t\t\t\turl,\n\t\t\t\t\t\t(object: any) => {\n\t\t\t\t\t\t\tconsole.log(object);\n\t\t\t\t\t\t\tthis.on_load_success(object).then((object2) => {\n\t\t\t\t\t\t\t\tresolve(object2);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t(error_message: ErrorEvent) => {\n\t\t\t\t\t\t\treject(error_message);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tconst error_message = `format not supported (${this.ext})`;\n\t\t\t\t\treject(error_message);\n\t\t\t\t}\n\t\t\t\t// CoreLoaderGeometry.loader_for_ext().then((loader) => {\n\t\t\t\t// \tif (loader) {\n\t\t\t\t// \t\tloader.load(\n\t\t\t\t// \t\t\turl,\n\t\t\t\t// \t\t\t(object: Object3D) => {\n\t\t\t\t// \t\t\t\tthis.on_load_success(object).then((object2) => {\n\t\t\t\t// \t\t\t\t\tresolve(object2);\n\t\t\t\t// \t\t\t\t});\n\t\t\t\t// \t\t\t},\n\t\t\t\t// \t\t\tnull,\n\t\t\t\t// \t\t\t(error_message: string) => {\n\t\t\t\t// \t\t\t\treject(error_message);\n\t\t\t\t// \t\t\t}\n\t\t\t\t// \t\t);\n\t\t\t\t// \t} else {\n\t\t\t\t// \t\tconst error_message = `format not supported (${this.ext})`;\n\t\t\t\t// \t\tconsole.warn(error_message);\n\t\t\t\t// \t\treject(error_message);\n\t\t\t\t// \t}\n\t\t\t\t// });\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async on_load_success(object: Object3D | BufferGeometry | object): Promise<Object3D[]> {\n\t\t// console.log(\"animation?\", object.animations)\n\t\t// if(object.animations){\n\t\t// \tawait CoreScriptLoader.load('/three/js/utils/SkeletonUtils')\n\t\t// }\n\t\tif (object instanceof Object3D) {\n\t\t\tswitch (this.ext) {\n\t\t\t\tcase 'gltf':\n\t\t\t\t\treturn this.on_load_succes_gltf(object);\n\t\t\t\tcase 'glb':\n\t\t\t\t\treturn this.on_load_succes_gltf(object);\n\t\t\t\t// case 'drc':\n\t\t\t\t// \treturn this.on_load_succes_drc(object);\n\t\t\t\tcase 'obj':\n\t\t\t\t\treturn [object]; // [object] //.children\n\t\t\t\tcase 'json':\n\t\t\t\t\treturn [object]; // [object] //.children\n\t\t\t\tdefault:\n\t\t\t\t\treturn [object];\n\t\t\t}\n\t\t}\n\t\tif (object instanceof BufferGeometry) {\n\t\t\tswitch (this.ext) {\n\t\t\t\tcase 'drc':\n\t\t\t\t\treturn this.on_load_succes_drc(object);\n\t\t\t\tdefault:\n\t\t\t\t\treturn [new Mesh(object)];\n\t\t\t}\n\t\t}\n\n\t\t// if it's an object, such as returned by glb\n\t\tswitch (this.ext) {\n\t\t\tcase 'gltf':\n\t\t\t\treturn this.on_load_succes_gltf(object);\n\t\t\tcase 'glb':\n\t\t\t\treturn this.on_load_succes_gltf(object);\n\t\t\tdefault:\n\t\t\t\treturn [];\n\t\t}\n\t\treturn [];\n\t}\n\n\tprivate on_load_succes_gltf(gltf: any): Object3D[] {\n\t\tconst scene = gltf['scene'];\n\t\tscene.animations = gltf.animations;\n\n\t\tconsole.log('[scene]', [scene]);\n\t\treturn [scene]; //.children\n\t}\n\tprivate on_load_succes_drc(geometry: BufferGeometry): Object3D[] {\n\t\tconst mat = new MeshLambertMaterial();\n\t\tconst mesh = new Mesh(geometry, mat);\n\n\t\treturn [mesh]; //.children\n\t}\n\n\tasync loader_for_ext() {\n\t\tswitch (this.ext.toLowerCase()) {\n\t\t\tcase 'gltf':\n\t\t\t\treturn this.loader_for_gltf();\n\t\t\tcase 'glb':\n\t\t\t\treturn this.loader_for_glb();\n\t\t\tcase 'drc':\n\t\t\t\treturn this.loader_for_drc();\n\t\t\tcase 'obj':\n\t\t\t\treturn this.loader_for_obj();\n\t\t}\n\t}\n\n\tasync loader_for_gltf() {\n\t\t// 'DDSLoader', 'DRACOLoader', 'GLTFLoader'\n\t\t// const {DDSLoader} = await import(`modules/three/examples/jsm/loaders/DDSLoader`);\n\t\t// const {DRACOLoader} = await import(`modules/three/examples/jsm/loaders/DRACOLoader`);\n\t\tconst {GLTFLoader} = await import(`modules/three/examples/jsm/loaders/GLTFLoader`);\n\t\treturn new GLTFLoader();\n\t}\n\tasync loader_for_glb() {\n\t\tconst {GLTFLoader} = await import(`modules/three/examples/jsm/loaders/GLTFLoader`);\n\t\tconst {DRACOLoader} = await import(`modules/three/examples/jsm/loaders/DRACOLoader`);\n\n\t\tconst loader = new GLTFLoader();\n\t\tconst draco_loader = new DRACOLoader();\n\t\tconst decoder_path = '/three/js/libs/draco/gltf/';\n\t\t// DRACOLoader.setDecoderPath( decoder_path );\n\t\tdraco_loader.setDecoderPath(decoder_path);\n\t\tdraco_loader.setDecoderConfig({type: 'js'});\n\t\tloader.setDRACOLoader(draco_loader);\n\n\t\treturn loader;\n\t}\n\tasync loader_for_drc() {\n\t\t// const {DDSLoader} = await import(`modules/three/examples/jsm/loaders/DDSLoader`);\n\t\tconst {DRACOLoader} = await import(`modules/three/examples/jsm/loaders/DRACOLoader`);\n\t\t// const {GLTFLoader} = await import(`modules/three/examples/jsm/loaders/GLTFLoader`);\n\n\t\t// const loader = new GLTFLoader();\n\t\tconst draco_loader = new DRACOLoader();\n\t\tconst decoder_path = '/three/js/libs/draco/';\n\t\t// DRACOLoader.setDecoderPath( decoder_path );\n\t\tdraco_loader.setDecoderPath(decoder_path);\n\t\tdraco_loader.setDecoderConfig({type: 'js'});\n\t\t// loader.setDRACOLoader(draco_loader);\n\t\t// console.log('loader', loader);\n\t\treturn draco_loader;\n\t}\n\tasync loader_for_obj() {\n\t\tconst {OBJLoader} = await import(`modules/three/examples/jsm/loaders/OBJLoader`);\n\t\treturn new OBJLoader();\n\t}\n\n\t// \tconst ext_lowercase = this.ext.toLowerCase();\n\t// \tlet script_names = SCRIPT_URLS_BY_EXT[ext_lowercase];\n\t// \tif (script_names) {\n\t// \t\tif (!lodash_isArray(script_names)) {\n\t// \t\t\tscript_names = [script_names];\n\t// \t\t}\n\t// \t\tlet imported_modules = {};\n\t// \t\tlet imported_module;\n\t// \t\tfor (let script_name of script_names) {\n\t// \t\t\timported_module = await CoreScriptLoader.load_module_three_loader(script_name);\n\t// \t\t\timported_modules[script_name] = imported_module;\n\t// \t\t}\n\n\t// \t\tconst loader_class_name = THREE_LOADER_BY_EXT[ext_lowercase];\n\t// \t\tconst loader_class = imported_module[loader_class_name];\n\t// \t\tif (loader_class) {\n\t// \t\t\tconst loader = new loader_class();\n\n\t// \t\t\tif (DRACO_EXTENSIONS.includes(ext_lowercase)) {\n\t// \t\t\t\tconst DRACOLoader = imported_modules.DRACOLoader.DRACOLoader;\n\t// \t\t\t\tconst draco_loader = new DRACOLoader();\n\t// \t\t\t\t// const decoder_path = '/three/js/libs/draco/gltf/'\n\t// \t\t\t\t// DRACOLoader.setDecoderPath( decoder_path );\n\t// \t\t\t\t// draco_loader.setDecoderPath( decoder_path );\n\t// \t\t\t\tloader.setDRACOLoader(draco_loader);\n\t// \t\t\t}\n\n\t// \t\t\treturn loader;\n\t// \t\t}\n\t// \t}\n\t// }\n}\n","import {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {FileLoader} from 'three/src/loaders/FileLoader';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {Group} from 'three/src/objects/Group';\nimport {LineBasicMaterial} from 'three/src/materials/LineBasicMaterial';\nimport {LineSegments} from 'three/src/objects/LineSegments';\nimport {Loader} from 'three/src/loaders/Loader';\nimport {Material} from 'three/src/materials/Material';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {MeshPhongMaterial} from 'three/src/materials/MeshPhongMaterial';\nimport {NoColors} from 'three/src/constants';\nimport {Points} from 'three/src/objects/Points';\nimport {PointsMaterial} from 'three/src/materials/PointsMaterial';\nimport {VertexColors} from 'three/src/constants';\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\n\nvar OBJLoader = ( function () {\n\n\t// o object_name | g group_name\n\tvar object_pattern = /^[og]\\s*(.+)?/;\n\t// mtllib file_reference\n\tvar material_library_pattern = /^mtllib /;\n\t// usemtl material_name\n\tvar material_use_pattern = /^usemtl /;\n\t// usemap map_name\n\tvar map_use_pattern = /^usemap /;\n\n\tfunction ParserState() {\n\n\t\tvar state = {\n\t\t\tobjects: [],\n\t\t\tobject: {},\n\n\t\t\tvertices: [],\n\t\t\tnormals: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\n\t\t\tmaterialLibraries: [],\n\n\t\t\tstartObject: function ( name, fromDeclaration ) {\n\n\t\t\t\t// If the current object (initial from reset) is not from a g/o declaration in the parsed\n\t\t\t\t// file. We need to use it for the first parsed g/o to keep things in sync.\n\t\t\t\tif ( this.object && this.object.fromDeclaration === false ) {\n\n\t\t\t\t\tthis.object.name = name;\n\t\t\t\t\tthis.object.fromDeclaration = ( fromDeclaration !== false );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tvar previousMaterial = ( this.object && typeof this.object.currentMaterial === 'function' ? this.object.currentMaterial() : undefined );\n\n\t\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\t\tthis.object._finalize( true );\n\n\t\t\t\t}\n\n\t\t\t\tthis.object = {\n\t\t\t\t\tname: name || '',\n\t\t\t\t\tfromDeclaration: ( fromDeclaration !== false ),\n\n\t\t\t\t\tgeometry: {\n\t\t\t\t\t\tvertices: [],\n\t\t\t\t\t\tnormals: [],\n\t\t\t\t\t\tcolors: [],\n\t\t\t\t\t\tuvs: []\n\t\t\t\t\t},\n\t\t\t\t\tmaterials: [],\n\t\t\t\t\tsmooth: true,\n\n\t\t\t\t\tstartMaterial: function ( name, libraries ) {\n\n\t\t\t\t\t\tvar previous = this._finalize( false );\n\n\t\t\t\t\t\t// New usemtl declaration overwrites an inherited material, except if faces were declared\n\t\t\t\t\t\t// after the material, then it must be preserved for proper MultiMaterial continuation.\n\t\t\t\t\t\tif ( previous && ( previous.inherited || previous.groupCount <= 0 ) ) {\n\n\t\t\t\t\t\t\tthis.materials.splice( previous.index, 1 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar material = {\n\t\t\t\t\t\t\tindex: this.materials.length,\n\t\t\t\t\t\t\tname: name || '',\n\t\t\t\t\t\t\tmtllib: ( Array.isArray( libraries ) && libraries.length > 0 ? libraries[ libraries.length - 1 ] : '' ),\n\t\t\t\t\t\t\tsmooth: ( previous !== undefined ? previous.smooth : this.smooth ),\n\t\t\t\t\t\t\tgroupStart: ( previous !== undefined ? previous.groupEnd : 0 ),\n\t\t\t\t\t\t\tgroupEnd: - 1,\n\t\t\t\t\t\t\tgroupCount: - 1,\n\t\t\t\t\t\t\tinherited: false,\n\n\t\t\t\t\t\t\tclone: function ( index ) {\n\n\t\t\t\t\t\t\t\tvar cloned = {\n\t\t\t\t\t\t\t\t\tindex: ( typeof index === 'number' ? index : this.index ),\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\tmtllib: this.mtllib,\n\t\t\t\t\t\t\t\t\tsmooth: this.smooth,\n\t\t\t\t\t\t\t\t\tgroupStart: 0,\n\t\t\t\t\t\t\t\t\tgroupEnd: - 1,\n\t\t\t\t\t\t\t\t\tgroupCount: - 1,\n\t\t\t\t\t\t\t\t\tinherited: false\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tcloned.clone = this.clone.bind( cloned );\n\t\t\t\t\t\t\t\treturn cloned;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthis.materials.push( material );\n\n\t\t\t\t\t\treturn material;\n\n\t\t\t\t\t},\n\n\t\t\t\t\tcurrentMaterial: function () {\n\n\t\t\t\t\t\tif ( this.materials.length > 0 ) {\n\n\t\t\t\t\t\t\treturn this.materials[ this.materials.length - 1 ];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn undefined;\n\n\t\t\t\t\t},\n\n\t\t\t\t\t_finalize: function ( end ) {\n\n\t\t\t\t\t\tvar lastMultiMaterial = this.currentMaterial();\n\t\t\t\t\t\tif ( lastMultiMaterial && lastMultiMaterial.groupEnd === - 1 ) {\n\n\t\t\t\t\t\t\tlastMultiMaterial.groupEnd = this.geometry.vertices.length / 3;\n\t\t\t\t\t\t\tlastMultiMaterial.groupCount = lastMultiMaterial.groupEnd - lastMultiMaterial.groupStart;\n\t\t\t\t\t\t\tlastMultiMaterial.inherited = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Ignore objects tail materials if no face declarations followed them before a new o/g started.\n\t\t\t\t\t\tif ( end && this.materials.length > 1 ) {\n\n\t\t\t\t\t\t\tfor ( var mi = this.materials.length - 1; mi >= 0; mi -- ) {\n\n\t\t\t\t\t\t\t\tif ( this.materials[ mi ].groupCount <= 0 ) {\n\n\t\t\t\t\t\t\t\t\tthis.materials.splice( mi, 1 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Guarantee at least one empty material, this makes the creation later more straight forward.\n\t\t\t\t\t\tif ( end && this.materials.length === 0 ) {\n\n\t\t\t\t\t\t\tthis.materials.push( {\n\t\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\t\tsmooth: this.smooth\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn lastMultiMaterial;\n\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// Inherit previous objects material.\n\t\t\t\t// Spec tells us that a declared material must be set to all objects until a new material is declared.\n\t\t\t\t// If a usemtl declaration is encountered while this new object is being parsed, it will\n\t\t\t\t// overwrite the inherited material. Exception being that there was already face declarations\n\t\t\t\t// to the inherited material, then it will be preserved for proper MultiMaterial continuation.\n\n\t\t\t\tif ( previousMaterial && previousMaterial.name && typeof previousMaterial.clone === 'function' ) {\n\n\t\t\t\t\tvar declared = previousMaterial.clone( 0 );\n\t\t\t\t\tdeclared.inherited = true;\n\t\t\t\t\tthis.object.materials.push( declared );\n\n\t\t\t\t}\n\n\t\t\t\tthis.objects.push( this.object );\n\n\t\t\t},\n\n\t\t\tfinalize: function () {\n\n\t\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\t\tthis.object._finalize( true );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tparseVertexIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t\t},\n\n\t\t\tparseNormalIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t\t},\n\n\t\t\tparseUVIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 2 ) * 2;\n\n\t\t\t},\n\n\t\t\taddVertex: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.vertices;\n\t\t\t\tvar dst = this.object.geometry.vertices;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t\t},\n\n\t\t\taddVertexPoint: function ( a ) {\n\n\t\t\t\tvar src = this.vertices;\n\t\t\t\tvar dst = this.object.geometry.vertices;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\n\t\t\t},\n\n\t\t\taddVertexLine: function ( a ) {\n\n\t\t\t\tvar src = this.vertices;\n\t\t\t\tvar dst = this.object.geometry.vertices;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\n\t\t\t},\n\n\t\t\taddNormal: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.normals;\n\t\t\t\tvar dst = this.object.geometry.normals;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t\t},\n\n\t\t\taddColor: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.colors;\n\t\t\t\tvar dst = this.object.geometry.colors;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t\t},\n\n\t\t\taddUV: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.uvs;\n\t\t\t\tvar dst = this.object.geometry.uvs;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ] );\n\t\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ] );\n\t\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ] );\n\n\t\t\t},\n\n\t\t\taddUVLine: function ( a ) {\n\n\t\t\t\tvar src = this.uvs;\n\t\t\t\tvar dst = this.object.geometry.uvs;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ] );\n\n\t\t\t},\n\n\t\t\taddFace: function ( a, b, c, ua, ub, uc, na, nb, nc ) {\n\n\t\t\t\tvar vLen = this.vertices.length;\n\n\t\t\t\tvar ia = this.parseVertexIndex( a, vLen );\n\t\t\t\tvar ib = this.parseVertexIndex( b, vLen );\n\t\t\t\tvar ic = this.parseVertexIndex( c, vLen );\n\n\t\t\t\tthis.addVertex( ia, ib, ic );\n\n\t\t\t\tif ( this.colors.length > 0 ) {\n\n\t\t\t\t\tthis.addColor( ia, ib, ic );\n\n\t\t\t\t}\n\n\t\t\t\tif ( ua !== undefined && ua !== '' ) {\n\n\t\t\t\t\tvar uvLen = this.uvs.length;\n\t\t\t\t\tia = this.parseUVIndex( ua, uvLen );\n\t\t\t\t\tib = this.parseUVIndex( ub, uvLen );\n\t\t\t\t\tic = this.parseUVIndex( uc, uvLen );\n\t\t\t\t\tthis.addUV( ia, ib, ic );\n\n\t\t\t\t}\n\n\t\t\t\tif ( na !== undefined && na !== '' ) {\n\n\t\t\t\t\t// Normals are many times the same. If so, skip function call and parseInt.\n\t\t\t\t\tvar nLen = this.normals.length;\n\t\t\t\t\tia = this.parseNormalIndex( na, nLen );\n\n\t\t\t\t\tib = na === nb ? ia : this.parseNormalIndex( nb, nLen );\n\t\t\t\t\tic = na === nc ? ia : this.parseNormalIndex( nc, nLen );\n\n\t\t\t\t\tthis.addNormal( ia, ib, ic );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\taddPointGeometry: function ( vertices ) {\n\n\t\t\t\tthis.object.geometry.type = 'Points';\n\n\t\t\t\tvar vLen = this.vertices.length;\n\n\t\t\t\tfor ( var vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\t\tthis.addVertexPoint( this.parseVertexIndex( vertices[ vi ], vLen ) );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\taddLineGeometry: function ( vertices, uvs ) {\n\n\t\t\t\tthis.object.geometry.type = 'Line';\n\n\t\t\t\tvar vLen = this.vertices.length;\n\t\t\t\tvar uvLen = this.uvs.length;\n\n\t\t\t\tfor ( var vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\t\tthis.addVertexLine( this.parseVertexIndex( vertices[ vi ], vLen ) );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var uvi = 0, l = uvs.length; uvi < l; uvi ++ ) {\n\n\t\t\t\t\tthis.addUVLine( this.parseUVIndex( uvs[ uvi ], uvLen ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tstate.startObject( '', false );\n\n\t\treturn state;\n\n\t}\n\n\t//\n\n\tfunction OBJLoader( manager ) {\n\n\t\tLoader.call( this, manager );\n\n\t\tthis.materials = null;\n\n\t}\n\n\tOBJLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\t\tconstructor: OBJLoader,\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar loader = new FileLoader( scope.manager );\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.load( url, function ( text ) {\n\n\t\t\t\tonLoad( scope.parse( text ) );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tsetMaterials: function ( materials ) {\n\n\t\t\tthis.materials = materials;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tparse: function ( text ) {\n\n\t\t\tconsole.time( 'OBJLoader' );\n\n\t\t\tvar state = new ParserState();\n\n\t\t\tif ( text.indexOf( '\\r\\n' ) !== - 1 ) {\n\n\t\t\t\t// This is faster than String.split with regex that splits on both\n\t\t\t\ttext = text.replace( /\\r\\n/g, '\\n' );\n\n\t\t\t}\n\n\t\t\tif ( text.indexOf( '\\\\\\n' ) !== - 1 ) {\n\n\t\t\t\t// join lines separated by a line continuation character (\\)\n\t\t\t\ttext = text.replace( /\\\\\\n/g, '' );\n\n\t\t\t}\n\n\t\t\tvar lines = text.split( '\\n' );\n\t\t\tvar line = '', lineFirstChar = '';\n\t\t\tvar lineLength = 0;\n\t\t\tvar result = [];\n\n\t\t\t// Faster to just trim left side of the line. Use if available.\n\t\t\tvar trimLeft = ( typeof ''.trimLeft === 'function' );\n\n\t\t\tfor ( var i = 0, l = lines.length; i < l; i ++ ) {\n\n\t\t\t\tline = lines[ i ];\n\n\t\t\t\tline = trimLeft ? line.trimLeft() : line.trim();\n\n\t\t\t\tlineLength = line.length;\n\n\t\t\t\tif ( lineLength === 0 ) continue;\n\n\t\t\t\tlineFirstChar = line.charAt( 0 );\n\n\t\t\t\t// @todo invoke passed in handler if any\n\t\t\t\tif ( lineFirstChar === '#' ) continue;\n\n\t\t\t\tif ( lineFirstChar === 'v' ) {\n\n\t\t\t\t\tvar data = line.split( /\\s+/ );\n\n\t\t\t\t\tswitch ( data[ 0 ] ) {\n\n\t\t\t\t\t\tcase 'v':\n\t\t\t\t\t\t\tstate.vertices.push(\n\t\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 2 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 3 ] )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif ( data.length >= 7 ) {\n\n\t\t\t\t\t\t\t\tstate.colors.push(\n\t\t\t\t\t\t\t\t\tparseFloat( data[ 4 ] ),\n\t\t\t\t\t\t\t\t\tparseFloat( data[ 5 ] ),\n\t\t\t\t\t\t\t\t\tparseFloat( data[ 6 ] )\n\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'vn':\n\t\t\t\t\t\t\tstate.normals.push(\n\t\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 2 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 3 ] )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'vt':\n\t\t\t\t\t\t\tstate.uvs.push(\n\t\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 2 ] )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( lineFirstChar === 'f' ) {\n\n\t\t\t\t\tvar lineData = line.substr( 1 ).trim();\n\t\t\t\t\tvar vertexData = lineData.split( /\\s+/ );\n\t\t\t\t\tvar faceVertices = [];\n\n\t\t\t\t\t// Parse the face vertex data into an easy to work with format\n\n\t\t\t\t\tfor ( var j = 0, jl = vertexData.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar vertex = vertexData[ j ];\n\n\t\t\t\t\t\tif ( vertex.length > 0 ) {\n\n\t\t\t\t\t\t\tvar vertexParts = vertex.split( '/' );\n\t\t\t\t\t\t\tfaceVertices.push( vertexParts );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Draw an edge between the first vertex and all subsequent vertices to form an n-gon\n\n\t\t\t\t\tvar v1 = faceVertices[ 0 ];\n\n\t\t\t\t\tfor ( var j = 1, jl = faceVertices.length - 1; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar v2 = faceVertices[ j ];\n\t\t\t\t\t\tvar v3 = faceVertices[ j + 1 ];\n\n\t\t\t\t\t\tstate.addFace(\n\t\t\t\t\t\t\tv1[ 0 ], v2[ 0 ], v3[ 0 ],\n\t\t\t\t\t\t\tv1[ 1 ], v2[ 1 ], v3[ 1 ],\n\t\t\t\t\t\t\tv1[ 2 ], v2[ 2 ], v3[ 2 ]\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( lineFirstChar === 'l' ) {\n\n\t\t\t\t\tvar lineParts = line.substring( 1 ).trim().split( \" \" );\n\t\t\t\t\tvar lineVertices = [], lineUVs = [];\n\n\t\t\t\t\tif ( line.indexOf( \"/\" ) === - 1 ) {\n\n\t\t\t\t\t\tlineVertices = lineParts;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tfor ( var li = 0, llen = lineParts.length; li < llen; li ++ ) {\n\n\t\t\t\t\t\t\tvar parts = lineParts[ li ].split( \"/\" );\n\n\t\t\t\t\t\t\tif ( parts[ 0 ] !== \"\" ) lineVertices.push( parts[ 0 ] );\n\t\t\t\t\t\t\tif ( parts[ 1 ] !== \"\" ) lineUVs.push( parts[ 1 ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\tstate.addLineGeometry( lineVertices, lineUVs );\n\n\t\t\t\t} else if ( lineFirstChar === 'p' ) {\n\n\t\t\t\t\tvar lineData = line.substr( 1 ).trim();\n\t\t\t\t\tvar pointData = lineData.split( \" \" );\n\n\t\t\t\t\tstate.addPointGeometry( pointData );\n\n\t\t\t\t} else if ( ( result = object_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// o object_name\n\t\t\t\t\t// or\n\t\t\t\t\t// g group_name\n\n\t\t\t\t\t// WORKAROUND: https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t// var name = result[ 0 ].substr( 1 ).trim();\n\t\t\t\t\tvar name = ( \" \" + result[ 0 ].substr( 1 ).trim() ).substr( 1 );\n\n\t\t\t\t\tstate.startObject( name );\n\n\t\t\t\t} else if ( material_use_pattern.test( line ) ) {\n\n\t\t\t\t\t// material\n\n\t\t\t\t\tstate.object.startMaterial( line.substring( 7 ).trim(), state.materialLibraries );\n\n\t\t\t\t} else if ( material_library_pattern.test( line ) ) {\n\n\t\t\t\t\t// mtl file\n\n\t\t\t\t\tstate.materialLibraries.push( line.substring( 7 ).trim() );\n\n\t\t\t\t} else if ( map_use_pattern.test( line ) ) {\n\n\t\t\t\t\t// the line is parsed but ignored since the loader assumes textures are defined MTL files\n\t\t\t\t\t// (according to https://www.okino.com/conv/imp_wave.htm, 'usemap' is the old-style Wavefront texture reference method)\n\n\t\t\t\t\tconsole.warn( 'THREE.OBJLoader: Rendering identifier \"usemap\" not supported. Textures must be defined in MTL files.' );\n\n\t\t\t\t} else if ( lineFirstChar === 's' ) {\n\n\t\t\t\t\tresult = line.split( ' ' );\n\n\t\t\t\t\t// smooth shading\n\n\t\t\t\t\t// @todo Handle files that have varying smooth values for a set of faces inside one geometry,\n\t\t\t\t\t// but does not define a usemtl for each face set.\n\t\t\t\t\t// This should be detected and a dummy material created (later MultiMaterial and geometry groups).\n\t\t\t\t\t// This requires some care to not create extra material on each smooth value for \"normal\" obj files.\n\t\t\t\t\t// where explicit usemtl defines geometry groups.\n\t\t\t\t\t// Example asset: examples/models/obj/cerberus/Cerberus.obj\n\n\t\t\t\t\t/*\n\t\t\t\t\t * http://paulbourke.net/dataformats/obj/\n\t\t\t\t\t * or\n\t\t\t\t\t * http://www.cs.utah.edu/~boulos/cs3505/obj_spec.pdf\n\t\t\t\t\t *\n\t\t\t\t\t * From chapter \"Grouping\" Syntax explanation \"s group_number\":\n\t\t\t\t\t * \"group_number is the smoothing group number. To turn off smoothing groups, use a value of 0 or off.\n\t\t\t\t\t * Polygonal elements use group numbers to put elements in different smoothing groups. For free-form\n\t\t\t\t\t * surfaces, smoothing groups are either turned on or off; there is no difference between values greater\n\t\t\t\t\t * than 0.\"\n\t\t\t\t\t */\n\t\t\t\t\tif ( result.length > 1 ) {\n\n\t\t\t\t\t\tvar value = result[ 1 ].trim().toLowerCase();\n\t\t\t\t\t\tstate.object.smooth = ( value !== '0' && value !== 'off' );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// ZBrush can produce \"s\" lines #11707\n\t\t\t\t\t\tstate.object.smooth = true;\n\n\t\t\t\t\t}\n\t\t\t\t\tvar material = state.object.currentMaterial();\n\t\t\t\t\tif ( material ) material.smooth = state.object.smooth;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Handle null terminated files without exception\n\t\t\t\t\tif ( line === '\\0' ) continue;\n\n\t\t\t\t\tconsole.warn( 'THREE.OBJLoader: Unexpected line: \"' + line + '\"' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.finalize();\n\n\t\t\tvar container = new Group();\n\t\t\tcontainer.materialLibraries = [].concat( state.materialLibraries );\n\n\t\t\tfor ( var i = 0, l = state.objects.length; i < l; i ++ ) {\n\n\t\t\t\tvar object = state.objects[ i ];\n\t\t\t\tvar geometry = object.geometry;\n\t\t\t\tvar materials = object.materials;\n\t\t\t\tvar isLine = ( geometry.type === 'Line' );\n\t\t\t\tvar isPoints = ( geometry.type === 'Points' );\n\t\t\t\tvar hasVertexColors = false;\n\n\t\t\t\t// Skip o/g line declarations that did not follow with any faces\n\t\t\t\tif ( geometry.vertices.length === 0 ) continue;\n\n\t\t\t\tvar buffergeometry = new BufferGeometry();\n\n\t\t\t\tbuffergeometry.setAttribute( 'position', new Float32BufferAttribute( geometry.vertices, 3 ) );\n\n\t\t\t\tif ( geometry.normals.length > 0 ) {\n\n\t\t\t\t\tbuffergeometry.setAttribute( 'normal', new Float32BufferAttribute( geometry.normals, 3 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbuffergeometry.computeVertexNormals();\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.colors.length > 0 ) {\n\n\t\t\t\t\thasVertexColors = true;\n\t\t\t\t\tbuffergeometry.setAttribute( 'color', new Float32BufferAttribute( geometry.colors, 3 ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.uvs.length > 0 ) {\n\n\t\t\t\t\tbuffergeometry.setAttribute( 'uv', new Float32BufferAttribute( geometry.uvs, 2 ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Create materials\n\n\t\t\t\tvar createdMaterials = [];\n\n\t\t\t\tfor ( var mi = 0, miLen = materials.length; mi < miLen; mi ++ ) {\n\n\t\t\t\t\tvar sourceMaterial = materials[ mi ];\n\t\t\t\t\tvar material = undefined;\n\n\t\t\t\t\tif ( this.materials !== null ) {\n\n\t\t\t\t\t\tmaterial = this.materials.create( sourceMaterial.name );\n\n\t\t\t\t\t\t// mtl etc. loaders probably can't create line materials correctly, copy properties to a line material.\n\t\t\t\t\t\tif ( isLine && material && ! ( material instanceof LineBasicMaterial ) ) {\n\n\t\t\t\t\t\t\tvar materialLine = new LineBasicMaterial();\n\t\t\t\t\t\t\tMaterial.prototype.copy.call( materialLine, material );\n\t\t\t\t\t\t\tmaterialLine.color.copy( material.color );\n\t\t\t\t\t\t\tmaterial = materialLine;\n\n\t\t\t\t\t\t} else if ( isPoints && material && ! ( material instanceof PointsMaterial ) ) {\n\n\t\t\t\t\t\t\tvar materialPoints = new PointsMaterial( { size: 10, sizeAttenuation: false } );\n\t\t\t\t\t\t\tMaterial.prototype.copy.call( materialPoints, material );\n\t\t\t\t\t\t\tmaterialPoints.color.copy( material.color );\n\t\t\t\t\t\t\tmaterialPoints.map = material.map;\n\t\t\t\t\t\t\tmaterial = materialPoints;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! material ) {\n\n\t\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\t\tmaterial = new LineBasicMaterial();\n\n\t\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\t\tmaterial = new PointsMaterial( { size: 1, sizeAttenuation: false } );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tmaterial = new MeshPhongMaterial();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaterial.name = sourceMaterial.name;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmaterial.flatShading = sourceMaterial.smooth ? false : true;\n\t\t\t\t\tmaterial.vertexColors = hasVertexColors ? VertexColors : NoColors;\n\n\t\t\t\t\tcreatedMaterials.push( material );\n\n\t\t\t\t}\n\n\t\t\t\t// Create mesh\n\n\t\t\t\tvar mesh;\n\n\t\t\t\tif ( createdMaterials.length > 1 ) {\n\n\t\t\t\t\tfor ( var mi = 0, miLen = materials.length; mi < miLen; mi ++ ) {\n\n\t\t\t\t\t\tvar sourceMaterial = materials[ mi ];\n\t\t\t\t\t\tbuffergeometry.addGroup( sourceMaterial.groupStart, sourceMaterial.groupCount, mi );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\tmesh = new LineSegments( buffergeometry, createdMaterials );\n\n\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\tmesh = new Points( buffergeometry, createdMaterials );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmesh = new Mesh( buffergeometry, createdMaterials );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\tmesh = new LineSegments( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\tmesh = new Points( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmesh = new Mesh( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = object.name;\n\n\t\t\t\tcontainer.add( mesh );\n\n\t\t\t}\n\n\t\t\tconsole.timeEnd( 'OBJLoader' );\n\n\t\t\treturn container;\n\n\t\t}\n\n\t} );\n\n\treturn OBJLoader;\n\n} )();\n\nexport { OBJLoader };\n","import {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CoreObject} from 'src/core/geometry/Object';\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Mesh} from 'three/src/objects/Mesh';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {ObjectType} from 'src/core/geometry/Constant';\nclass FuseSopParamsConfig extends NodeParamsConfig {\n\tdist = ParamConfig.FLOAT(0.1, {\n\t\trange: [0, 1],\n\t\trange_locked: [true, false],\n\t});\n}\nconst ParamsConfig = new FuseSopParamsConfig();\n\nexport class FuseSopNode extends TypedSopNode<FuseSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'fuse';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['points to fuse together'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tconst new_objects = [];\n\t\tlet new_object;\n\t\tfor (let core_object of core_group.core_objects()) {\n\t\t\tnew_object = this._fuse_core_object(core_object);\n\t\t\tif (new_object) {\n\t\t\t\tnew_objects.push(new_object);\n\t\t\t}\n\t\t}\n\n\t\tthis.set_objects(new_objects);\n\t}\n\n\tprivate _fuse_core_object(core_object: CoreObject) {\n\t\tconst object = core_object.object();\n\t\tif (!object) {\n\t\t\treturn;\n\t\t}\n\t\tconst points = core_object.points();\n\n\t\tconst precision = this.pv.dist;\n\t\tconst points_by_position: Dictionary<CorePoint[]> = {};\n\t\tfor (let point of points) {\n\t\t\tconst position = point.position();\n\t\t\tconst rounded_position = new Vector3(\n\t\t\t\tMath.round(position.x / precision),\n\t\t\t\tMath.round(position.y / precision),\n\t\t\t\tMath.round(position.z / precision)\n\t\t\t);\n\t\t\tconst key = rounded_position.toArray().join('-');\n\t\t\tpoints_by_position[key] = points_by_position[key] || [];\n\t\t\tpoints_by_position[key].push(point);\n\t\t}\n\n\t\tconst kept_points: CorePoint[] = [];\n\t\tObject.keys(points_by_position).forEach((key) => {\n\t\t\tkept_points.push(points_by_position[key][0]);\n\t\t});\n\n\t\t(object as Mesh).geometry.dispose();\n\t\tif (kept_points.length > 0) {\n\t\t\t(object as Mesh).geometry = CoreGeometry.geometry_from_points(\n\t\t\t\tkept_points,\n\t\t\t\t(<unknown>object.constructor) as ObjectType\n\t\t\t);\n\t\t\treturn object;\n\t\t} else {\n\t\t\t// if(object.material){ object.material.dispose() }\n\t\t\t// if(object.parent){ object.parent.remove(object) }\n\t\t}\n\t}\n}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {TypedSopNode} from './_Base';\nimport {CoreTransform} from 'src/core/Transform';\nimport {CoreConstant} from 'src/core/geometry/Constant';\n\nimport {CoreGeometryOperationHexagon} from 'src/core/geometry/operation/Hexagon';\n\nconst DEFAULT_UP = new Vector3(0, 1, 0);\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass HexagonsSopParamsConfig extends NodeParamsConfig {\n\tsize = ParamConfig.VECTOR2([1, 1]);\n\thexagon_radius = ParamConfig.FLOAT(0.1);\n\tdirection = ParamConfig.VECTOR3([0, 1, 0]);\n\tpoints_only = ParamConfig.BOOLEAN(0);\n\t// no need to have centers, as all points are centers anyway\n\t//this.add_param( ParamType.TOGGLE, 'centers_only', 0, {visible_if: {points_only: 1}})\n}\nconst ParamsConfig = new HexagonsSopParamsConfig();\n\nexport class HexagonsSopNode extends TypedSopNode<HexagonsSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'hexagons';\n\t}\n\n\tprivate _core_transform = new CoreTransform();\n\n\tinitialize_node() {}\n\n\tcook() {\n\t\tconst operation = new CoreGeometryOperationHexagon(this.pv.size, this.pv.hexagon_radius, this.pv.points_only);\n\t\tconst geometry = operation.process();\n\t\tconsole.log(geometry, geometry.attributes.position);\n\n\t\tthis._core_transform.rotate_geometry(geometry, DEFAULT_UP, this.pv.direction);\n\n\t\tif (this.pv.points_only) {\n\t\t\tthis.set_geometry(geometry, CoreConstant.OBJECT_TYPE.POINTS);\n\t\t} else {\n\t\t\tthis.set_geometry(geometry);\n\t\t}\n\t}\n}\n","import {Vector2} from 'three/src/math/Vector2'\nimport {BufferGeometry} from 'three/src/core/BufferGeometry'\nimport {BufferAttribute} from 'three/src/core/BufferAttribute'\nconst THREE = {BufferAttribute, BufferGeometry, Vector2}\nimport lodash_flatten from 'lodash/flatten'\n// import {CoreGeometry} from '../Geometry';\n\nexport class CoreGeometryOperationHexagon {\n\tconstructor(\n\t\tprivate _param_size: THREE.Vector2,\n\t\tprivate _param_hexagon_radius: number,\n\t\tprivate _param_points_only: boolean\n\t) {}\n\n\tprocess(): THREE.BufferGeometry {\n\t\tconst side_length = this._param_hexagon_radius\n\t\tconst half_side_length = side_length * 0.5\n\t\tconst step_size = {\n\t\t\tx: side_length,\n\t\t\ty: Math.cos(Math.PI / 6) * this._param_hexagon_radius,\n\t\t}\n\t\tconst steps_count = {\n\t\t\tx: Math.floor(this._param_size.x / step_size.x),\n\t\t\ty: Math.floor(this._param_size.y / step_size.y),\n\t\t}\n\t\tlet positions = []\n\t\tlet indices = []\n\t\tfor (let y = 0; y < steps_count.y; y++) {\n\t\t\tfor (let x = 0; x < steps_count.x; x++) {\n\t\t\t\tpositions.push([\n\t\t\t\t\t-(this._param_size.x * 0.5) +\n\t\t\t\t\t\tx * step_size.x +\n\t\t\t\t\t\t(y % 2 == 0 ? half_side_length : 0),\n\t\t\t\t\t0,\n\t\t\t\t\t-(this._param_size.y * 0.5) + y * step_size.y,\n\t\t\t\t])\n\n\t\t\t\tif (!this._param_points_only) {\n\t\t\t\t\tif (y >= 1) {\n\t\t\t\t\t\tif (x == 0 || x == steps_count.x - 1) {\n\t\t\t\t\t\t\tif (x == 0) {\n\t\t\t\t\t\t\t\tindices.push([\n\t\t\t\t\t\t\t\t\tx + 1 + (y - 1) * steps_count.x,\n\t\t\t\t\t\t\t\t\tx + (y - 1) * steps_count.x,\n\t\t\t\t\t\t\t\t\tx + y * steps_count.x,\n\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tindices.push([\n\t\t\t\t\t\t\t\t\tx + y * steps_count.x,\n\t\t\t\t\t\t\t\t\tx + (y - 1) * steps_count.x,\n\t\t\t\t\t\t\t\t\tx - 1 + y * steps_count.x,\n\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tindices.push([\n\t\t\t\t\t\t\t\tx + y * steps_count.x,\n\t\t\t\t\t\t\t\tx + (y - 1) * steps_count.x,\n\t\t\t\t\t\t\t\tx - 1 + y * steps_count.x,\n\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\tindices.push([\n\t\t\t\t\t\t\t\tx + y * steps_count.x,\n\t\t\t\t\t\t\t\tx + 1 + (y - 1) * steps_count.x,\n\t\t\t\t\t\t\t\tx + (y - 1) * steps_count.x,\n\t\t\t\t\t\t\t])\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tpositions = lodash_flatten(positions)\n\n\t\tconst geometry = new THREE.BufferGeometry()\n\t\tgeometry.setAttribute(\n\t\t\t'position',\n\t\t\tnew THREE.BufferAttribute(new Float32Array(positions), 3)\n\t\t)\n\n\t\tif (!this._param_points_only) {\n\t\t\tindices = lodash_flatten(indices)\n\t\t\tgeometry.setIndex(indices)\n\t\t\tgeometry.computeVertexNormals()\n\t\t}\n\n\t\treturn geometry\n\t}\n}\n","import {Object3D} from 'three/src/core/Object3D';\nimport {Group} from 'three/src/objects/Group';\nconst THREE = {Group, Object3D};\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\n// import {CoreGroup} from 'src/Core/Geometry/Group';\n// import {CoreConstant} from 'src/Core/Geometry/Constant'\n\nexport enum HierarchyMode {\n\tADD_PARENT = 'add_parent',\n\tREMOVE_PARENT = 'remove_parent',\n}\nexport const HIERARCHY_MODES: Array<HierarchyMode> = [HierarchyMode.ADD_PARENT, HierarchyMode.REMOVE_PARENT];\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass HierarchySopParamsConfig extends NodeParamsConfig {\n\tmode = ParamConfig.INTEGER(0, {\n\t\tmenu: {\n\t\t\tentries: HIERARCHY_MODES.map((m, i) => {\n\t\t\t\treturn {name: m, value: i};\n\t\t\t}),\n\t\t},\n\t});\n\tlevels = ParamConfig.INTEGER(1, {range: [0, 5]});\n}\nconst ParamsConfig = new HierarchySopParamsConfig();\n\nexport class HierarchySopNode extends TypedSopNode<HierarchySopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'hierarchy';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to add or remove parents to/from'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\t// const group_wrapper = new CoreGroup(group);\n\n\t\tif (HIERARCHY_MODES[this.pv.mode] == HierarchyMode.ADD_PARENT) {\n\t\t\tconst objects = this._add_parent_to_core_group(core_group);\n\t\t\tthis.set_objects(objects);\n\t\t} else {\n\t\t\tconst objects = this._remove_parent_from_core_group(core_group);\n\t\t\tthis.set_objects(objects);\n\t\t}\n\t}\n\n\tprivate _add_parent_to_core_group(core_group: CoreGroup): THREE.Object3D[] {\n\t\tif (this.pv.levels == 0) {\n\t\t\treturn core_group.objects();\n\t\t} else {\n\t\t\tconst new_objects: Object3D[] = [];\n\t\t\tlet new_object;\n\t\t\tfor (let object of core_group.objects()) {\n\t\t\t\tnew_object = this._add_parent_to_object(object);\n\t\t\t\tif (new_object) {\n\t\t\t\t\tnew_objects.push(new_object);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn new_objects;\n\t\t}\n\t}\n\tprivate _add_parent_to_object(object: THREE.Object3D): THREE.Object3D {\n\t\tlet new_parent = new THREE.Group();\n\n\t\t// while(child = object.children[0]){\n\t\tnew_parent.add(object);\n\t\t// }\n\n\t\tif (this.pv.levels > 0) {\n\t\t\tfor (let i = 0; i < this.pv.levels - 1; i++) {\n\t\t\t\t// for (let i of lodash_range(this.pv.levels - 1)) {\n\t\t\t\tnew_parent = this._add_new_parent(new_parent);\n\t\t\t}\n\t\t}\n\n\t\treturn new_parent;\n\t}\n\n\tprivate _add_new_parent(object: THREE.Object3D): THREE.Group {\n\t\tconst new_parent2 = new THREE.Group();\n\t\tnew_parent2.add(object);\n\t\treturn new_parent2;\n\t}\n\n\tprivate _remove_parent_from_core_group(core_group: CoreGroup): THREE.Object3D[] {\n\t\tif (this.pv.levels == 0) {\n\t\t\treturn core_group.objects();\n\t\t} else {\n\t\t\tconst new_objects: Object3D[] = [];\n\t\t\tfor (let object of core_group.objects()) {\n\t\t\t\tconst new_children = this._remove_parent_from_object(object);\n\t\t\t\tfor (let new_child of new_children) {\n\t\t\t\t\tnew_objects.push(new_child);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn new_objects;\n\t\t}\n\t}\n\n\tprivate _remove_parent_from_object(object: THREE.Object3D): THREE.Object3D[] {\n\t\tlet current_children = object.children;\n\n\t\tfor (let i = 0; i < this.pv.levels - 1; i++) {\n\t\t\tcurrent_children = this._get_children_from_objects(current_children);\n\t\t}\n\n\t\treturn current_children;\n\t}\n\n\tprivate _get_children_from_objects(objects: THREE.Object3D[]): THREE.Object3D[] {\n\t\tlet object;\n\t\tconst children: Object3D[] = [];\n\t\twhile ((object = objects.pop())) {\n\t\t\tif (object.children) {\n\t\t\t\tfor (let child of object.children) {\n\t\t\t\t\tchildren.push(child);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn children;\n\t}\n}\n","import {Vector3} from 'three/src/math/Vector3';\nconst THREE = {Vector3};\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CoreMath} from 'src/core/math/_Module';\nimport {TypedSopNode} from './_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nclass JitterSopParamsConfig extends NodeParamsConfig {\n\tamount = ParamConfig.FLOAT(1);\n\tseed = ParamConfig.INTEGER(1, {range: [0, 100]});\n}\nconst ParamsConfig = new JitterSopParamsConfig();\n\nexport class JitterSopNode extends TypedSopNode<JitterSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'jitter';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to jitter points of'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tcore_group.points().forEach((point, i) => {\n\t\t\t// TODO: replace by a pseudo random\n\t\t\tconst offset = new THREE.Vector3(\n\t\t\t\t2 * (CoreMath.rand(i * 75 + 764 + this.pv.seed) - 0.5),\n\t\t\t\t2 * (CoreMath.rand(i * 5678 + 3653 + this.pv.seed) - 0.5),\n\t\t\t\t2 * (CoreMath.rand(i * 657 + 48464 + this.pv.seed) - 0.5)\n\t\t\t);\n\t\t\toffset.normalize();\n\t\t\toffset.multiplyScalar(this.pv.amount);\n\n\t\t\tconst new_position = point\n\t\t\t\t.position()\n\t\t\t\t.clone()\n\t\t\t\t.add(offset);\n\t\t\tpoint.set_position(new_position);\n\t\t});\n\n\t\tthis.set_core_group(core_group);\n\t}\n}\n","import {TypedSopNode} from './_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\nclass LayerSopParamsConfig extends NodeParamsConfig {\n\tlayer = ParamConfig.INTEGER(0, {\n\t\trange: [0, 31],\n\t\trange_locked: [true, true],\n\t});\n}\nconst ParamsConfig = new LayerSopParamsConfig();\n\nexport class LayerSopNode extends TypedSopNode<LayerSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'layer';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['objects to change layers of'];\n\t}\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tfor (let object of core_group.objects()) {\n\t\t\tobject.layers.set(this.pv.layer);\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n}\n","import {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport lodash_times from 'lodash/times';\n\nimport {TypedSopNode} from './_Base';\nimport {CoreConstant} from 'src/core/geometry/Constant';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass LineSopParamsConfig extends NodeParamsConfig {\n\tlength = ParamConfig.FLOAT(1, {range: [0, 10]});\n\tpoints_count = ParamConfig.INTEGER(1, {\n\t\trange: [2, 100],\n\t\trange_locked: [true, false],\n\t});\n\torigin = ParamConfig.VECTOR3([0, 0, 0]);\n\tdirection = ParamConfig.VECTOR3([0, 1, 0]);\n}\nconst ParamsConfig = new LineSopParamsConfig();\n\nexport class LineSopNode extends TypedSopNode<LineSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'line';\n\t}\n\n\tinitialize_node() {}\n\n\tcook() {\n\t\tconst points_count = Math.max(2, this.pv.points_count);\n\n\t\tconst positions: number[] = new Array(points_count * 3);\n\t\tconst indices: number[] = new Array(points_count);\n\n\t\tconst last_pt = this.pv.direction\n\t\t\t.clone()\n\t\t\t.normalize()\n\t\t\t.multiplyScalar(this.pv.length);\n\n\t\tlodash_times(points_count, (i) => {\n\t\t\tconst i_n = i / (points_count - 1);\n\t\t\tconst point = last_pt.clone().multiplyScalar(i_n);\n\t\t\tpoint.add(this.pv.origin);\n\t\t\tpoint.toArray(positions, i * 3);\n\n\t\t\tif (i > 0) {\n\t\t\t\tindices[(i - 1) * 2] = i - 1;\n\t\t\t\tindices[(i - 1) * 2 + 1] = i;\n\t\t\t}\n\t\t});\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute('position', new Float32BufferAttribute(positions, 3));\n\t\tgeometry.setIndex(indices);\n\t\tthis.set_geometry(geometry, CoreConstant.OBJECT_TYPE.LINE_SEGMENTS);\n\t}\n}\n","import {TypedSopNode} from './_Base';\n// import {BaseNodeMat} from '../Mat/_Base'\n\nimport {CoreMaterial} from 'src/core/geometry/Material';\nimport {GlobalsGeometryHandler} from 'src/engine/nodes/gl/code/globals/Geometry';\n\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {BaseMatNodeType} from '../mat/_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {Material} from 'three/src/materials/Material';\nimport {Object3D} from 'three/src/core/Object3D';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {BaseBuilderMatNodeType} from '../mat/_BaseBuilder';\nclass MaterialSopParamsConfig extends NodeParamsConfig {\n\tgroup = ParamConfig.STRING('');\n\tmaterial = ParamConfig.OPERATOR_PATH('/MAT/mesh_standard1', {\n\t\tnode_selection: {\n\t\t\tcontext: NodeContext.MAT,\n\t\t},\n\t\tdependent_on_found_node: false,\n\t});\n\tapply_to_children = ParamConfig.BOOLEAN(0);\n}\nconst ParamsConfig = new MaterialSopParamsConfig();\n\nexport class MaterialSopNode extends TypedSopNode<MaterialSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'material';\n\t}\n\n\t_param_material: BaseMatNodeType | undefined;\n\t_globals_handler: GlobalsGeometryHandler = new GlobalsGeometryHandler();\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['objects to assign material to'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\t// TODO: optimize by not fetching the material node everytime\n\t// and maybe have a method in all operator_path params to do that quickly\n\t// TODO: does this apply the material to only 1 node?\n\tasync cook(core_groups: CoreGroup[]) {\n\t\t// let container = input_containers[0];\n\t\t// const group =\tcontainer.group(); // {clone: this.do_clone_inputs()})\n\t\tconst core_group = core_groups[0];\n\n\t\tconst node = this.p.material.found_node();\n\t\tif (node) {\n\t\t\tif (node.node_context() != NodeContext.MAT) {\n\t\t\t\tthis.states.error.set('node is not a material');\n\t\t\t} else {\n\t\t\t\tconst material_node = node as BaseMatNodeType;\n\t\t\t\tconst material = material_node.material;\n\t\t\t\tif (material instanceof ShaderMaterial) {\n\t\t\t\t\tconst material_builder_node = node as BaseBuilderMatNodeType;\n\t\t\t\t\tmaterial_builder_node.assembler_controller.set_assembler_globals_handler(this._globals_handler);\n\t\t\t\t}\n\n\t\t\t\tawait material_node.request_container();\n\t\t\t\tif (material) {\n\t\t\t\t\tfor (let object of core_group.objects_from_group(this.pv.group)) {\n\t\t\t\t\t\tif (this.pv.apply_to_children) {\n\t\t\t\t\t\t\tobject.traverse((grand_child) => {\n\t\t\t\t\t\t\t\tthis.apply_material(grand_child, material);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.apply_material(object, material);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.set_core_group(core_group);\n\t\t\t\t} else {\n\t\t\t\t\tthis.states.error.set(`material invalid. (error: '${material_node.states.error.message}')`);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.states.error.set(`node '${this.pv.material}' not found`);\n\t\t}\n\t}\n\n\tapply_material(object: Object3D, material: Material) {\n\t\tconst object_with_material = object as Mesh;\n\t\t// if (object.material != null) {\n\t\t// \tobject.material.dispose();\n\t\t// }\n\t\t// TODO: do I really need to clone this material?\n\t\t// does it get cloned when a node fetches the container?\n\t\t// I may only need to clone it for the copy SOP\n\t\tobject_with_material.material = material;\n\t\tCoreMaterial.apply_custom_materials(object, material);\n\t}\n}\n","// import lodash_times from 'lodash/times';\n// import lodash_each from 'lodash/each';\n// import lodash_difference from 'lodash/difference';\n// import lodash_keys from 'lodash/keys';\n// import {Object3D} from 'three/src/core/Object3D';\n// import {Group} from 'three/src/objects/Group';\n// import {BufferAttribute} from 'three/src/core/BufferAttribute';\n// const THREE = {BufferAttribute, Group, Object3D};\nimport {TypedSopNode} from './_Base';\n// import {ParamType} from 'src/Engine/Param/_Module';\n\n// import {CoreGroup} from 'src/Core/Geometry/Group';\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {CoreGroup, Object3DWithGeometry} from 'src/core/geometry/Group';\nimport {Object3D} from 'three/src/core/Object3D';\n// import {CoreConstant} from 'src/Core/Geometry/Constant';\nimport {ObjectType} from 'src/core/geometry/Constant';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {LineSegments} from 'three/src/objects/LineSegments';\nimport {Points} from 'three/src/objects/Points';\ntype ObjectsByType = {[key in ObjectType]: Object3DWithGeometry[]};\ntype ObjectTypes = Array<ObjectType>;\n\nconst INPUT_NAME = 'geometry to merge';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass MergeSopParamsConfig extends NodeParamsConfig {\n\tcompact = ParamConfig.BOOLEAN(1);\n}\nconst ParamsConfig = new MergeSopParamsConfig();\n\nexport class MergeSopNode extends TypedSopNode<MergeSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'merge';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn [INPUT_NAME, INPUT_NAME, INPUT_NAME, INPUT_NAME];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1, 4);\n\n\t\tthis.ui_data.set_width(100);\n\t\t// this.ui_data.set_icon('compress-arrows-alt');\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tlet all_objects: Object3DWithGeometry[] = []; //new Group()\n\t\tfor (let input_core_group of input_contents) {\n\t\t\tif (input_core_group) {\n\t\t\t\tconst objects = input_core_group.objects();\n\t\t\t\tfor (let object of objects) {\n\t\t\t\t\tobject.traverse((child) => {\n\t\t\t\t\t\tall_objects.push(child as Object3DWithGeometry);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.pv.compact) {\n\t\t\tall_objects = this._make_compact(all_objects);\n\t\t}\n\t\tthis.set_objects(all_objects);\n\t}\n\n\t_make_compact(all_objects: Object3DWithGeometry[]): Object3DWithGeometry[] {\n\t\tconst objects_by_type: ObjectsByType = {\n\t\t\t[ObjectType.MESH]: [],\n\t\t\t[ObjectType.POINTS]: [],\n\t\t\t[ObjectType.LINE_SEGMENTS]: [],\n\t\t};\n\t\tconst merged_objects: Object3DWithGeometry[] = [];\n\n\t\tfor (let object of all_objects) {\n\t\t\tobject.traverse((object3d: Object3D) => {\n\t\t\t\tconst object = object3d as Object3DWithGeometry;\n\t\t\t\tif (object.geometry) {\n\t\t\t\t\t// const type = child.constructor.name;\n\t\t\t\t\tif ((object as Mesh).isMesh) {\n\t\t\t\t\t\tobjects_by_type[ObjectType.MESH].push(object);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ((object as LineSegments).isLineSegments) {\n\t\t\t\t\t\t\tobjects_by_type[ObjectType.LINE_SEGMENTS].push(object);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif ((object as Points).isPoints) {\n\t\t\t\t\t\t\t\tobjects_by_type[ObjectType.POINTS].push(object);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfor (let type of Object.keys(objects_by_type) as ObjectTypes) {\n\t\t\tconst objects = objects_by_type[type];\n\n\t\t\tconst geometries = [];\n\t\t\tfor (let object of objects) {\n\t\t\t\tconst geometry = object.geometry;\n\t\t\t\tgeometry.applyMatrix(object.matrix);\n\t\t\t\tgeometries.push(geometry);\n\t\t\t}\n\n\t\t\t// TODO: test that this works with geometries with same attributes\n\t\t\tconst merged_geometry = CoreGeometry.merge_geometries(geometries);\n\t\t\tif (merged_geometry) {\n\t\t\t\tconst object = this.create_object(merged_geometry, type);\n\t\t\t\tmerged_objects.push(object);\n\t\t\t}\n\n\t\t\t// objects.forEach( object=> {\n\t\t\t// \tif (object.parent != null) {\n\t\t\t// \t\tobject.parent.remove(object);\n\t\t\t// \t}\n\t\t\t// \tif (object.geometry != null) {\n\t\t\t// \t\tobject.geometry.dispose();\n\t\t\t// \t}\n\t\t\t// \t(object.material != null ? object.material.dispose() : undefined);\n\t\t\t// });\n\t\t}\n\t\treturn merged_objects;\n\t}\n}\n\n// _add_missing_attributes: (geo0, geo1)->\n// \tgeo0_attribute_names = lodash_keys(geo0.attributes)\n// \tgeo1_attribute_names = lodash_keys(geo1.attributes)\n\n// \tattributes_not_in_geo0 = lodash_difference(geo1_attribute_names, geo0_attribute_names)\n// \tattributes_not_in_geo1 = lodash_difference(geo0_attribute_names, geo1_attribute_names)\n\n// \tlodash_each attributes_not_in_geo0, (attribute_not_in_geo0)=>\n// \t\tthis._add_attribute(geo0, attribute_not_in_geo0, geo1.attributes[attribute_not_in_geo0])\n// \tlodash_each attributes_not_in_geo1, (attribute_not_in_geo1)=>\n// \t\tthis._add_attribute(geo1, attribute_not_in_geo1, geo0.attributes[attribute_not_in_geo1])\n\n// _add_attribute: (geo, attrib_name, attribute_template)->\n\n// \titem_size = attribute_template['itemSize']\n// \tnormalized = attribute_template['normalized']\n// \tpoints_count = geo.getAttribute('position').array.length / 3\n\n// \traw_values = []\n// \tlodash_times points_count, (i)->\n// \t\tlodash_times item_size, (j)->\n// \t\t\traw_values.push(0)\n\n// \tvalues = new Float32Array(raw_values)\n// \tgeo.setAttribute( attrib_name, new BufferAttribute( values, item_size, normalized) )\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {CoreMath} from 'src/core/math/_Module';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {TypeAssert} from 'src/engine/poly/Assert';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {SimplexNoise} from 'modules/three/examples/jsm/math/SimplexNoise';\n\nenum Operation {\n\tADD = 'add',\n\tSET = 'set',\n\tMULT = 'mult',\n\tSUBSTRACT = 'substract',\n\tDIVIDE = 'divide',\n}\ntype Operations = Array<Operation>;\nconst Operations: Operations = [Operation.ADD, Operation.SET, Operation.MULT, Operation.SUBSTRACT, Operation.DIVIDE];\n\n// const COMPONENT_OFFSETS = [\n// \tnew Vector3(545, 125454, 2142),\n// \tnew Vector3(425, 25746, 95242),\n// \tnew Vector3(765132, 21, 9245),\n// ]\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass NoiseSopParamsConfig extends NodeParamsConfig {\n\tamount = ParamConfig.FLOAT(1);\n\tfreq = ParamConfig.VECTOR3([1, 1, 1]);\n\toffset = ParamConfig.VECTOR3([0, 0, 0]);\n\toctaves = ParamConfig.INTEGER(3, {\n\t\trange: [1, 8],\n\t\trange_locked: [true, false],\n\t});\n\tamp_attenuation = ParamConfig.FLOAT(0.5, {range: [0, 1]});\n\tfreq_increase = ParamConfig.FLOAT(2, {range: [0, 10]});\n\tseed = ParamConfig.INTEGER(0, {range: [0, 100]});\n\tseparator = ParamConfig.SEPARATOR();\n\tuse_normals = ParamConfig.BOOLEAN(0);\n\tattrib_name = ParamConfig.STRING('position');\n\toperation = ParamConfig.INTEGER(Operations.indexOf(Operation.ADD), {\n\t\tmenu: {\n\t\t\tentries: Operations.map((operation) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: operation,\n\t\t\t\t\tvalue: Operations.indexOf(operation),\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n\tcompute_normals = ParamConfig.BOOLEAN(1);\n}\nconst ParamsConfig = new NoiseSopParamsConfig();\n\nexport class NoiseSopNode extends TypedSopNode<NoiseSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'noise';\n\t}\n\n\t// _param_amount: number;\n\t// _param_offset: Vector3;\n\t// _param_freq: Vector3;\n\t// _param_seed: number;\n\t// _param_use_normals: boolean;\n\t// _param_attrib_name: string;\n\t// _param_operation: number;\n\t// _param_compute_normals: boolean;\n\n\tprivate _simplex_by_seed: Map<number, SimplexNoise> = new Map();\n\n\tprivate _rest_core_group_timestamp: number | undefined;\n\tprivate _rest_points: CorePoint[] = [];\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to add noise to', 'rest geometry'];\n\t}\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1, 2);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE, InputCloneMode.NEVER]);\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tconst core_group_rest = input_contents[1];\n\n\t\tconst dest_points = core_group.points();\n\t\tif (core_group_rest) {\n\t\t\tif (\n\t\t\t\tthis._rest_core_group_timestamp == null ||\n\t\t\t\tthis._rest_core_group_timestamp != core_group_rest.timestamp()\n\t\t\t) {\n\t\t\t\tthis._rest_points = core_group_rest.points();\n\t\t\t\tthis._rest_core_group_timestamp = core_group_rest.timestamp();\n\t\t\t}\n\t\t}\n\n\t\t// const {SimplexNoise} = await import(`three/examples/jsm/math/SimplexNoise`)\n\t\tconst simplex = this._get_simplex();\n\n\t\tconst use_normals = this.pv.use_normals && core_group.has_attrib('normal');\n\t\tconst target_attrib_size = core_group.attrib_size(this.pv.attrib_name);\n\n\t\tfor (let i = 0; i < dest_points.length; i++) {\n\t\t\tconst dest_point = dest_points[i];\n\t\t\tlet rest_point = core_group_rest ? this._rest_points[i] : dest_point;\n\t\t\tconst current_attrib_value = rest_point.attrib_value(this.pv.attrib_name);\n\t\t\tconst pos = rest_point\n\t\t\t\t.position()\n\t\t\t\t.add(this.pv.offset)\n\t\t\t\t.multiply(this.pv.freq);\n\n\t\t\tlet noise_value = (() => {\n\t\t\t\tif (use_normals) {\n\t\t\t\t\tconst normal = rest_point.attrib_value('normal');\n\t\t\t\t\tconst noise = this.pv.amount * this._fbm(simplex, pos.x, pos.y, pos.z);\n\t\t\t\t\treturn normal.clone().multiplyScalar(noise);\n\t\t\t\t\t//vertex.add(noise_vector)\n\t\t\t\t} else {\n\t\t\t\t\treturn new Vector3(\n\t\t\t\t\t\tthis.pv.amount * this._fbm(simplex, pos.x + 545, pos.y + 125454, pos.z + 2142),\n\t\t\t\t\t\tthis.pv.amount * this._fbm(simplex, pos.x - 425, pos.y - 25746, pos.z + 95242),\n\t\t\t\t\t\tthis.pv.amount * this._fbm(simplex, pos.x + 765132, pos.y + 21, pos.z - 9245)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t})();\n\n\t\t\tnoise_value = (() => {\n\t\t\t\tswitch (target_attrib_size) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\treturn noise_value.x;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\treturn new Vector2(noise_value.x, noise_value.y);\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\treturn noise_value;\n\t\t\t\t}\n\t\t\t})();\n\n\t\t\tconst new_attrib_value = (() => {\n\t\t\t\tconst operation = Operations[this.pv.operation];\n\t\t\t\tswitch (target_attrib_size) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tswitch (operation) {\n\t\t\t\t\t\t\tcase Operation.ADD:\n\t\t\t\t\t\t\t\treturn current_attrib_value + noise_value;\n\t\t\t\t\t\t\tcase Operation.SET:\n\t\t\t\t\t\t\t\treturn noise_value;\n\t\t\t\t\t\t\tcase Operation.MULT:\n\t\t\t\t\t\t\t\treturn current_attrib_value * noise_value;\n\t\t\t\t\t\t\tcase Operation.DIVIDE:\n\t\t\t\t\t\t\t\treturn current_attrib_value / noise_value;\n\t\t\t\t\t\t\tcase Operation.SUBSTRACT:\n\t\t\t\t\t\t\t\treturn current_attrib_value - noise_value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tTypeAssert.unreachable(operation);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tswitch (operation) {\n\t\t\t\t\t\t\tcase Operation.ADD:\n\t\t\t\t\t\t\t\treturn current_attrib_value.add(noise_value);\n\t\t\t\t\t\t\tcase Operation.SET:\n\t\t\t\t\t\t\t\treturn noise_value;\n\t\t\t\t\t\t\tcase Operation.MULT:\n\t\t\t\t\t\t\t\treturn current_attrib_value.multiply(noise_value);\n\t\t\t\t\t\t\tcase Operation.DIVIDE:\n\t\t\t\t\t\t\t\treturn current_attrib_value.divide(noise_value);\n\t\t\t\t\t\t\tcase Operation.SUBSTRACT:\n\t\t\t\t\t\t\t\treturn current_attrib_value.sub(noise_value);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tTypeAssert.unreachable(operation);\n\t\t\t\t}\n\t\t\t})();\n\n\t\t\tdest_point.set_attrib_value(this.pv.attrib_name, new_attrib_value);\n\t\t}\n\n\t\tif (!this.io.inputs.input_cloned(0)) {\n\t\t\tfor (let geometry of core_group.geometries()) {\n\t\t\t\t(geometry.getAttribute(this.pv.attrib_name) as BufferAttribute).needsUpdate = true;\n\t\t\t}\n\t\t}\n\n\t\tif (this.pv.compute_normals) {\n\t\t\tcore_group.compute_vertex_normals();\n\t\t}\n\t\tthis.set_core_group(core_group);\n\t}\n\n\tprivate _fbm(simplex: SimplexNoise, x: number, y: number, z: number): number {\n\t\tlet value = 0.0;\n\t\tlet amplitude = 1.0;\n\t\tfor (let i = 0; i < this.pv.octaves; i++) {\n\t\t\tvalue += amplitude * simplex.noise3d(x, y, z);\n\t\t\tx *= this.pv.freq_increase;\n\t\t\ty *= this.pv.freq_increase;\n\t\t\tz *= this.pv.freq_increase;\n\t\t\tamplitude *= this.pv.amp_attenuation;\n\t\t}\n\t\treturn value;\n\t}\n\n\tprivate _get_simplex(): SimplexNoise {\n\t\tconst simplex = this._simplex_by_seed.get(this.pv.seed);\n\t\tif (simplex) {\n\t\t\treturn simplex;\n\t\t} else {\n\t\t\tconst simplex = this._create_simplex();\n\t\t\tthis._simplex_by_seed.set(this.pv.seed, simplex);\n\t\t\treturn simplex;\n\t\t}\n\t}\n\tprivate _create_simplex(): SimplexNoise {\n\t\tconst seed = this.pv.seed;\n\t\tconst random_generator = {\n\t\t\trandom: function() {\n\t\t\t\treturn CoreMath.rand_float(seed);\n\t\t\t},\n\t\t};\n\t\tconst simplex = new SimplexNoise(random_generator);\n\t\t// for (let key of Object.keys(this._simplex_by_seed)) {\n\t\tthis._simplex_by_seed.delete(seed);\n\t\t// }\n\t\treturn simplex;\n\t}\n}\n","// Ported from Stefan Gustavson's java implementation\n// http://staffwww.itn.liu.se/~stegu/simplexnoise/simplexnoise.pdf\n// Read Stefan's excellent paper for details on how this code works.\n//\n// Sean McCullough banksean@gmail.com\n//\n// Added 4D noise\n// Joshua Koo zz85nus@gmail.com\n\n/**\n * You can pass in a random number generator object if you like.\n * It is assumed to have a random() method.\n */\nvar SimplexNoise = function ( r ) {\n\n\tif ( r == undefined ) r = Math;\n\tthis.grad3 = [[ 1, 1, 0 ], [ - 1, 1, 0 ], [ 1, - 1, 0 ], [ - 1, - 1, 0 ],\n\t\t[ 1, 0, 1 ], [ - 1, 0, 1 ], [ 1, 0, - 1 ], [ - 1, 0, - 1 ],\n\t\t[ 0, 1, 1 ], [ 0, - 1, 1 ], [ 0, 1, - 1 ], [ 0, - 1, - 1 ]];\n\n\tthis.grad4 = [[ 0, 1, 1, 1 ], [ 0, 1, 1, - 1 ], [ 0, 1, - 1, 1 ], [ 0, 1, - 1, - 1 ],\n\t     [ 0, - 1, 1, 1 ], [ 0, - 1, 1, - 1 ], [ 0, - 1, - 1, 1 ], [ 0, - 1, - 1, - 1 ],\n\t     [ 1, 0, 1, 1 ], [ 1, 0, 1, - 1 ], [ 1, 0, - 1, 1 ], [ 1, 0, - 1, - 1 ],\n\t     [ - 1, 0, 1, 1 ], [ - 1, 0, 1, - 1 ], [ - 1, 0, - 1, 1 ], [ - 1, 0, - 1, - 1 ],\n\t     [ 1, 1, 0, 1 ], [ 1, 1, 0, - 1 ], [ 1, - 1, 0, 1 ], [ 1, - 1, 0, - 1 ],\n\t     [ - 1, 1, 0, 1 ], [ - 1, 1, 0, - 1 ], [ - 1, - 1, 0, 1 ], [ - 1, - 1, 0, - 1 ],\n\t     [ 1, 1, 1, 0 ], [ 1, 1, - 1, 0 ], [ 1, - 1, 1, 0 ], [ 1, - 1, - 1, 0 ],\n\t     [ - 1, 1, 1, 0 ], [ - 1, 1, - 1, 0 ], [ - 1, - 1, 1, 0 ], [ - 1, - 1, - 1, 0 ]];\n\n\tthis.p = [];\n\tfor ( var i = 0; i < 256; i ++ ) {\n\n\t\tthis.p[ i ] = Math.floor( r.random() * 256 );\n\n\t}\n\t// To remove the need for index wrapping, double the permutation table length\n\tthis.perm = [];\n\tfor ( var i = 0; i < 512; i ++ ) {\n\n\t\tthis.perm[ i ] = this.p[ i & 255 ];\n\n\t}\n\n\t// A lookup table to traverse the simplex around a given point in 4D.\n\t// Details can be found where this table is used, in the 4D noise method.\n\tthis.simplex = [\n\t\t[ 0, 1, 2, 3 ], [ 0, 1, 3, 2 ], [ 0, 0, 0, 0 ], [ 0, 2, 3, 1 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 1, 2, 3, 0 ],\n\t\t[ 0, 2, 1, 3 ], [ 0, 0, 0, 0 ], [ 0, 3, 1, 2 ], [ 0, 3, 2, 1 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 1, 3, 2, 0 ],\n\t\t[ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ],\n\t\t[ 1, 2, 0, 3 ], [ 0, 0, 0, 0 ], [ 1, 3, 0, 2 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 2, 3, 0, 1 ], [ 2, 3, 1, 0 ],\n\t\t[ 1, 0, 2, 3 ], [ 1, 0, 3, 2 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 2, 0, 3, 1 ], [ 0, 0, 0, 0 ], [ 2, 1, 3, 0 ],\n\t\t[ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ],\n\t\t[ 2, 0, 1, 3 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 3, 0, 1, 2 ], [ 3, 0, 2, 1 ], [ 0, 0, 0, 0 ], [ 3, 1, 2, 0 ],\n\t\t[ 2, 1, 0, 3 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 0, 0, 0, 0 ], [ 3, 1, 0, 2 ], [ 0, 0, 0, 0 ], [ 3, 2, 0, 1 ], [ 3, 2, 1, 0 ]];\n\n};\n\nSimplexNoise.prototype.dot = function ( g, x, y ) {\n\n\treturn g[ 0 ] * x + g[ 1 ] * y;\n\n};\n\nSimplexNoise.prototype.dot3 = function ( g, x, y, z ) {\n\n\treturn g[ 0 ] * x + g[ 1 ] * y + g[ 2 ] * z;\n\n};\n\nSimplexNoise.prototype.dot4 = function ( g, x, y, z, w ) {\n\n\treturn g[ 0 ] * x + g[ 1 ] * y + g[ 2 ] * z + g[ 3 ] * w;\n\n};\n\nSimplexNoise.prototype.noise = function ( xin, yin ) {\n\n\tvar n0, n1, n2; // Noise contributions from the three corners\n\t// Skew the input space to determine which simplex cell we're in\n\tvar F2 = 0.5 * ( Math.sqrt( 3.0 ) - 1.0 );\n\tvar s = ( xin + yin ) * F2; // Hairy factor for 2D\n\tvar i = Math.floor( xin + s );\n\tvar j = Math.floor( yin + s );\n\tvar G2 = ( 3.0 - Math.sqrt( 3.0 ) ) / 6.0;\n\tvar t = ( i + j ) * G2;\n\tvar X0 = i - t; // Unskew the cell origin back to (x,y) space\n\tvar Y0 = j - t;\n\tvar x0 = xin - X0; // The x,y distances from the cell origin\n\tvar y0 = yin - Y0;\n\t// For the 2D case, the simplex shape is an equilateral triangle.\n\t// Determine which simplex we are in.\n\tvar i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\n\tif ( x0 > y0 ) {\n\n\t\ti1 = 1; j1 = 0;\n\n\t\t// lower triangle, XY order: (0,0)->(1,0)->(1,1)\n\n\t}\telse {\n\n\t\ti1 = 0; j1 = 1;\n\n\t} // upper triangle, YX order: (0,0)->(0,1)->(1,1)\n\t// A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\n\t// a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\n\t// c = (3-sqrt(3))/6\n\tvar x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\n\tvar y1 = y0 - j1 + G2;\n\tvar x2 = x0 - 1.0 + 2.0 * G2; // Offsets for last corner in (x,y) unskewed coords\n\tvar y2 = y0 - 1.0 + 2.0 * G2;\n\t// Work out the hashed gradient indices of the three simplex corners\n\tvar ii = i & 255;\n\tvar jj = j & 255;\n\tvar gi0 = this.perm[ ii + this.perm[ jj ] ] % 12;\n\tvar gi1 = this.perm[ ii + i1 + this.perm[ jj + j1 ] ] % 12;\n\tvar gi2 = this.perm[ ii + 1 + this.perm[ jj + 1 ] ] % 12;\n\t// Calculate the contribution from the three corners\n\tvar t0 = 0.5 - x0 * x0 - y0 * y0;\n\tif ( t0 < 0 ) n0 = 0.0;\n\telse {\n\n\t\tt0 *= t0;\n\t\tn0 = t0 * t0 * this.dot( this.grad3[ gi0 ], x0, y0 ); // (x,y) of grad3 used for 2D gradient\n\n\t}\n\tvar t1 = 0.5 - x1 * x1 - y1 * y1;\n\tif ( t1 < 0 ) n1 = 0.0;\n\telse {\n\n\t\tt1 *= t1;\n\t\tn1 = t1 * t1 * this.dot( this.grad3[ gi1 ], x1, y1 );\n\n\t}\n\tvar t2 = 0.5 - x2 * x2 - y2 * y2;\n\tif ( t2 < 0 ) n2 = 0.0;\n\telse {\n\n\t\tt2 *= t2;\n\t\tn2 = t2 * t2 * this.dot( this.grad3[ gi2 ], x2, y2 );\n\n\t}\n\t// Add contributions from each corner to get the final noise value.\n\t// The result is scaled to return values in the interval [-1,1].\n\treturn 70.0 * ( n0 + n1 + n2 );\n\n};\n\n// 3D simplex noise\nSimplexNoise.prototype.noise3d = function ( xin, yin, zin ) {\n\n\tvar n0, n1, n2, n3; // Noise contributions from the four corners\n\t// Skew the input space to determine which simplex cell we're in\n\tvar F3 = 1.0 / 3.0;\n\tvar s = ( xin + yin + zin ) * F3; // Very nice and simple skew factor for 3D\n\tvar i = Math.floor( xin + s );\n\tvar j = Math.floor( yin + s );\n\tvar k = Math.floor( zin + s );\n\tvar G3 = 1.0 / 6.0; // Very nice and simple unskew factor, too\n\tvar t = ( i + j + k ) * G3;\n\tvar X0 = i - t; // Unskew the cell origin back to (x,y,z) space\n\tvar Y0 = j - t;\n\tvar Z0 = k - t;\n\tvar x0 = xin - X0; // The x,y,z distances from the cell origin\n\tvar y0 = yin - Y0;\n\tvar z0 = zin - Z0;\n\t// For the 3D case, the simplex shape is a slightly irregular tetrahedron.\n\t// Determine which simplex we are in.\n\tvar i1, j1, k1; // Offsets for second corner of simplex in (i,j,k) coords\n\tvar i2, j2, k2; // Offsets for third corner of simplex in (i,j,k) coords\n\tif ( x0 >= y0 ) {\n\n\t\tif ( y0 >= z0 ) {\n\n\t\t\ti1 = 1; j1 = 0; k1 = 0; i2 = 1; j2 = 1; k2 = 0;\n\n\t\t\t// X Y Z order\n\n\t\t} else if ( x0 >= z0 ) {\n\n\t\t\ti1 = 1; j1 = 0; k1 = 0; i2 = 1; j2 = 0; k2 = 1;\n\n\t\t\t// X Z Y order\n\n\t\t} else {\n\n\t\t\ti1 = 0; j1 = 0; k1 = 1; i2 = 1; j2 = 0; k2 = 1;\n\n\t\t} // Z X Y order\n\n\t} else { // x0<y0\n\n\t\tif ( y0 < z0 ) {\n\n\t\t\ti1 = 0; j1 = 0; k1 = 1; i2 = 0; j2 = 1; k2 = 1;\n\n\t\t\t// Z Y X order\n\n\t\t} else if ( x0 < z0 ) {\n\n\t\t\ti1 = 0; j1 = 1; k1 = 0; i2 = 0; j2 = 1; k2 = 1;\n\n\t\t\t// Y Z X order\n\n\t\t} else {\n\n\t\t\ti1 = 0; j1 = 1; k1 = 0; i2 = 1; j2 = 1; k2 = 0;\n\n\t\t} // Y X Z order\n\n\t}\n\t// A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z),\n\t// a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and\n\t// a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where\n\t// c = 1/6.\n\tvar x1 = x0 - i1 + G3; // Offsets for second corner in (x,y,z) coords\n\tvar y1 = y0 - j1 + G3;\n\tvar z1 = z0 - k1 + G3;\n\tvar x2 = x0 - i2 + 2.0 * G3; // Offsets for third corner in (x,y,z) coords\n\tvar y2 = y0 - j2 + 2.0 * G3;\n\tvar z2 = z0 - k2 + 2.0 * G3;\n\tvar x3 = x0 - 1.0 + 3.0 * G3; // Offsets for last corner in (x,y,z) coords\n\tvar y3 = y0 - 1.0 + 3.0 * G3;\n\tvar z3 = z0 - 1.0 + 3.0 * G3;\n\t// Work out the hashed gradient indices of the four simplex corners\n\tvar ii = i & 255;\n\tvar jj = j & 255;\n\tvar kk = k & 255;\n\tvar gi0 = this.perm[ ii + this.perm[ jj + this.perm[ kk ] ] ] % 12;\n\tvar gi1 = this.perm[ ii + i1 + this.perm[ jj + j1 + this.perm[ kk + k1 ] ] ] % 12;\n\tvar gi2 = this.perm[ ii + i2 + this.perm[ jj + j2 + this.perm[ kk + k2 ] ] ] % 12;\n\tvar gi3 = this.perm[ ii + 1 + this.perm[ jj + 1 + this.perm[ kk + 1 ] ] ] % 12;\n\t// Calculate the contribution from the four corners\n\tvar t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0;\n\tif ( t0 < 0 ) n0 = 0.0;\n\telse {\n\n\t\tt0 *= t0;\n\t\tn0 = t0 * t0 * this.dot3( this.grad3[ gi0 ], x0, y0, z0 );\n\n\t}\n\tvar t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1;\n\tif ( t1 < 0 ) n1 = 0.0;\n\telse {\n\n\t\tt1 *= t1;\n\t\tn1 = t1 * t1 * this.dot3( this.grad3[ gi1 ], x1, y1, z1 );\n\n\t}\n\tvar t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2;\n\tif ( t2 < 0 ) n2 = 0.0;\n\telse {\n\n\t\tt2 *= t2;\n\t\tn2 = t2 * t2 * this.dot3( this.grad3[ gi2 ], x2, y2, z2 );\n\n\t}\n\tvar t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3;\n\tif ( t3 < 0 ) n3 = 0.0;\n\telse {\n\n\t\tt3 *= t3;\n\t\tn3 = t3 * t3 * this.dot3( this.grad3[ gi3 ], x3, y3, z3 );\n\n\t}\n\t// Add contributions from each corner to get the final noise value.\n\t// The result is scaled to stay just inside [-1,1]\n\treturn 32.0 * ( n0 + n1 + n2 + n3 );\n\n};\n\n// 4D simplex noise\nSimplexNoise.prototype.noise4d = function ( x, y, z, w ) {\n\n\t// For faster and easier lookups\n\tvar grad4 = this.grad4;\n\tvar simplex = this.simplex;\n\tvar perm = this.perm;\n\n\t// The skewing and unskewing factors are hairy again for the 4D case\n\tvar F4 = ( Math.sqrt( 5.0 ) - 1.0 ) / 4.0;\n\tvar G4 = ( 5.0 - Math.sqrt( 5.0 ) ) / 20.0;\n\tvar n0, n1, n2, n3, n4; // Noise contributions from the five corners\n\t// Skew the (x,y,z,w) space to determine which cell of 24 simplices we're in\n\tvar s = ( x + y + z + w ) * F4; // Factor for 4D skewing\n\tvar i = Math.floor( x + s );\n\tvar j = Math.floor( y + s );\n\tvar k = Math.floor( z + s );\n\tvar l = Math.floor( w + s );\n\tvar t = ( i + j + k + l ) * G4; // Factor for 4D unskewing\n\tvar X0 = i - t; // Unskew the cell origin back to (x,y,z,w) space\n\tvar Y0 = j - t;\n\tvar Z0 = k - t;\n\tvar W0 = l - t;\n\tvar x0 = x - X0; // The x,y,z,w distances from the cell origin\n\tvar y0 = y - Y0;\n\tvar z0 = z - Z0;\n\tvar w0 = w - W0;\n\n\t// For the 4D case, the simplex is a 4D shape I won't even try to describe.\n\t// To find out which of the 24 possible simplices we're in, we need to\n\t// determine the magnitude ordering of x0, y0, z0 and w0.\n\t// The method below is a good way of finding the ordering of x,y,z,w and\n\t// then find the correct traversal order for the simplex were in.\n\t// First, six pair-wise comparisons are performed between each possible pair\n\t// of the four coordinates, and the results are used to add up binary bits\n\t// for an integer index.\n\tvar c1 = ( x0 > y0 ) ? 32 : 0;\n\tvar c2 = ( x0 > z0 ) ? 16 : 0;\n\tvar c3 = ( y0 > z0 ) ? 8 : 0;\n\tvar c4 = ( x0 > w0 ) ? 4 : 0;\n\tvar c5 = ( y0 > w0 ) ? 2 : 0;\n\tvar c6 = ( z0 > w0 ) ? 1 : 0;\n\tvar c = c1 + c2 + c3 + c4 + c5 + c6;\n\tvar i1, j1, k1, l1; // The integer offsets for the second simplex corner\n\tvar i2, j2, k2, l2; // The integer offsets for the third simplex corner\n\tvar i3, j3, k3, l3; // The integer offsets for the fourth simplex corner\n\t// simplex[c] is a 4-vector with the numbers 0, 1, 2 and 3 in some order.\n\t// Many values of c will never occur, since e.g. x>y>z>w makes x<z, y<w and x<w\n\t// impossible. Only the 24 indices which have non-zero entries make any sense.\n\t// We use a thresholding to set the coordinates in turn from the largest magnitude.\n\t// The number 3 in the \"simplex\" array is at the position of the largest coordinate.\n\ti1 = simplex[ c ][ 0 ] >= 3 ? 1 : 0;\n\tj1 = simplex[ c ][ 1 ] >= 3 ? 1 : 0;\n\tk1 = simplex[ c ][ 2 ] >= 3 ? 1 : 0;\n\tl1 = simplex[ c ][ 3 ] >= 3 ? 1 : 0;\n\t// The number 2 in the \"simplex\" array is at the second largest coordinate.\n\ti2 = simplex[ c ][ 0 ] >= 2 ? 1 : 0;\n\tj2 = simplex[ c ][ 1 ] >= 2 ? 1 : 0; k2 = simplex[ c ][ 2 ] >= 2 ? 1 : 0;\n\tl2 = simplex[ c ][ 3 ] >= 2 ? 1 : 0;\n\t// The number 1 in the \"simplex\" array is at the second smallest coordinate.\n\ti3 = simplex[ c ][ 0 ] >= 1 ? 1 : 0;\n\tj3 = simplex[ c ][ 1 ] >= 1 ? 1 : 0;\n\tk3 = simplex[ c ][ 2 ] >= 1 ? 1 : 0;\n\tl3 = simplex[ c ][ 3 ] >= 1 ? 1 : 0;\n\t// The fifth corner has all coordinate offsets = 1, so no need to look that up.\n\tvar x1 = x0 - i1 + G4; // Offsets for second corner in (x,y,z,w) coords\n\tvar y1 = y0 - j1 + G4;\n\tvar z1 = z0 - k1 + G4;\n\tvar w1 = w0 - l1 + G4;\n\tvar x2 = x0 - i2 + 2.0 * G4; // Offsets for third corner in (x,y,z,w) coords\n\tvar y2 = y0 - j2 + 2.0 * G4;\n\tvar z2 = z0 - k2 + 2.0 * G4;\n\tvar w2 = w0 - l2 + 2.0 * G4;\n\tvar x3 = x0 - i3 + 3.0 * G4; // Offsets for fourth corner in (x,y,z,w) coords\n\tvar y3 = y0 - j3 + 3.0 * G4;\n\tvar z3 = z0 - k3 + 3.0 * G4;\n\tvar w3 = w0 - l3 + 3.0 * G4;\n\tvar x4 = x0 - 1.0 + 4.0 * G4; // Offsets for last corner in (x,y,z,w) coords\n\tvar y4 = y0 - 1.0 + 4.0 * G4;\n\tvar z4 = z0 - 1.0 + 4.0 * G4;\n\tvar w4 = w0 - 1.0 + 4.0 * G4;\n\t// Work out the hashed gradient indices of the five simplex corners\n\tvar ii = i & 255;\n\tvar jj = j & 255;\n\tvar kk = k & 255;\n\tvar ll = l & 255;\n\tvar gi0 = perm[ ii + perm[ jj + perm[ kk + perm[ ll ] ] ] ] % 32;\n\tvar gi1 = perm[ ii + i1 + perm[ jj + j1 + perm[ kk + k1 + perm[ ll + l1 ] ] ] ] % 32;\n\tvar gi2 = perm[ ii + i2 + perm[ jj + j2 + perm[ kk + k2 + perm[ ll + l2 ] ] ] ] % 32;\n\tvar gi3 = perm[ ii + i3 + perm[ jj + j3 + perm[ kk + k3 + perm[ ll + l3 ] ] ] ] % 32;\n\tvar gi4 = perm[ ii + 1 + perm[ jj + 1 + perm[ kk + 1 + perm[ ll + 1 ] ] ] ] % 32;\n\t// Calculate the contribution from the five corners\n\tvar t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0 - w0 * w0;\n\tif ( t0 < 0 ) n0 = 0.0;\n\telse {\n\n\t\tt0 *= t0;\n\t\tn0 = t0 * t0 * this.dot4( grad4[ gi0 ], x0, y0, z0, w0 );\n\n\t}\n\tvar t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1 - w1 * w1;\n\tif ( t1 < 0 ) n1 = 0.0;\n\telse {\n\n\t\tt1 *= t1;\n\t\tn1 = t1 * t1 * this.dot4( grad4[ gi1 ], x1, y1, z1, w1 );\n\n\t}\n\tvar t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2 - w2 * w2;\n\tif ( t2 < 0 ) n2 = 0.0;\n\telse {\n\n\t\tt2 *= t2;\n\t\tn2 = t2 * t2 * this.dot4( grad4[ gi2 ], x2, y2, z2, w2 );\n\n\t} var t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3 - w3 * w3;\n\tif ( t3 < 0 ) n3 = 0.0;\n\telse {\n\n\t\tt3 *= t3;\n\t\tn3 = t3 * t3 * this.dot4( grad4[ gi3 ], x3, y3, z3, w3 );\n\n\t}\n\tvar t4 = 0.6 - x4 * x4 - y4 * y4 - z4 * z4 - w4 * w4;\n\tif ( t4 < 0 ) n4 = 0.0;\n\telse {\n\n\t\tt4 *= t4;\n\t\tn4 = t4 * t4 * this.dot4( grad4[ gi4 ], x4, y4, z4, w4 );\n\n\t}\n\t// Sum up and scale the result to cover the range [-1,1]\n\treturn 27.0 * ( n0 + n1 + n2 + n3 + n4 );\n\n};\n\nexport { SimplexNoise };\n","// import {Vector3} from 'three/src/math/Vector3';\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\n// import {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreObject} from 'src/core/geometry/Object';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n\n// const DEFAULT_NORMAL = new Vector3(0, 0, 1);\nconst NORMAL_ATTRIB_NAME = 'normal';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass NormalsSopParamsConfig extends NodeParamsConfig {\n\tedit = ParamConfig.BOOLEAN(0);\n\tupdate_x = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {edit: 1},\n\t});\n\tx = ParamConfig.FLOAT('@N.x', {\n\t\tvisible_if: {update_x: 1, edit: 1},\n\t\texpression: {for_entities: true},\n\t});\n\tupdate_y = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {edit: 1},\n\t});\n\ty = ParamConfig.FLOAT('@N.y', {\n\t\tvisible_if: {update_y: 1, edit: 1},\n\t\texpression: {for_entities: true},\n\t});\n\tupdate_z = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {edit: 1},\n\t});\n\tz = ParamConfig.FLOAT('@N.z', {\n\t\tvisible_if: {update_z: 1, edit: 1},\n\t\texpression: {for_entities: true},\n\t});\n\n\trecompute = ParamConfig.BOOLEAN(0, {\n\t\tvisible_if: {edit: 0},\n\t});\n\tinvert = ParamConfig.BOOLEAN(0);\n}\nconst ParamsConfig = new NormalsSopParamsConfig();\n\nexport class NormalsSopNode extends TypedSopNode<NormalsSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'normals';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to update normals of'];\n\t}\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tif (this.pv.edit) {\n\t\t\tawait this._eval_expressions_for_core_group(core_group);\n\t\t} else {\n\t\t\tcore_group.compute_vertex_normals();\n\t\t}\n\t\tif (this.pv.invert) {\n\t\t\tthis._invert_normals(core_group);\n\t\t}\n\n\t\t// add attr if not present\n\t\t// for(let object of core_group.objects()){\n\t\t// \tlet geometry;\n\t\t// \tif ((geometry = object.geometry) != null) {\n\t\t// \t\tif(!geometry.getAttribute('normal')){\n\t\t// \t\t\tconst position_values = geometry.attributes['position'].array;\n\t\t// \t\t\tconst normal_values = [];\n\t\t// \t\t\tposition_values.forEach(p=> normal_values.push(0));\n\t\t// \t\t\tgeometry.setAttribute('normal', new Float32BufferAttribute(normal_values, 3));\n\t\t// \t\t}\n\t\t// \t}\n\t\t// }\n\n\t\t// if (this.pv.edit) {\n\t\t// \tthis._eval_expressions(core_group);\n\t\t// } else {\n\t\t// \tif(this.pv.recompute){\n\t\t// \t\tcore_group.compute_vertex_normals()\n\t\t// \t}\n\t\t// }\n\n\t\t// for(let object of core_group.objects()){\n\t\t// \tlet geometry;\n\t\t// \tif ((geometry = object.geometry) != null) {\n\n\t\t// \t\tif (this.pv.invert) {\n\t\t// \t\t\tthis._invert_normals(geometry);\n\t\t// \t\t}\n\n\t\t// \t\tif (!this.pv.edit) {\n\t\t// \t\t\tgeometry.computeVertexNormals();\n\t\t// \t\t}\n\t\t// \t}\n\t\t// }\n\n\t\tthis.set_core_group(core_group);\n\t}\n\n\tprivate async _eval_expressions_for_core_group(core_group: CoreGroup) {\n\t\t// const points = core_group.points();\n\n\t\t// const attrib_name = 'normal';\n\t\t// for(let point of points){\n\n\t\t// \tthis.context().set_entity(point);\n\n\t\t// \tthis.param(attrib_name).eval(val=> {\n\t\t// \t\tval.normalize();\n\t\t// \t\tpoint.set_attrib_value(attrib_name, val);\n\t\t// \t});\n\t\t// }\n\t\tconst core_objects = core_group.core_objects();\n\t\tfor (let i = 0; i < core_objects.length; i++) {\n\t\t\tawait this._eval_expressions_for_core_object(core_objects[i]);\n\t\t}\n\t}\n\tprivate async _eval_expressions_for_core_object(core_object: CoreObject) {\n\t\tconst object = core_object.object();\n\t\tconst geometry = (object as Mesh).geometry as BufferGeometry;\n\t\tconst points = core_object.points();\n\n\t\tconst array = geometry.getAttribute(NORMAL_ATTRIB_NAME).array as number[];\n\n\t\t// x\n\t\tif (this.pv.update_x) {\n\t\t\tif (this.p.x.has_expression() && this.p.x.expression_controller) {\n\t\t\t\tawait this.p.x.expression_controller.compute_expression_for_points(points, (point, value) => {\n\t\t\t\t\tarray[point.index * 3 + 0] = value;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet point;\n\t\t\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\t\t\tpoint = points[i];\n\t\t\t\t\tarray[point.index * 3 + 0] = this.pv.x;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// y\n\t\tif (this.pv.update_y) {\n\t\t\tif (this.p.y.has_expression() && this.p.y.expression_controller) {\n\t\t\t\tawait this.p.y.expression_controller.compute_expression_for_points(points, (point, value) => {\n\t\t\t\t\tarray[point.index * 3 + 1] = value;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet point;\n\t\t\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\t\t\tpoint = points[i];\n\t\t\t\t\tarray[point.index * 3 + 1] = this.pv.y;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// z\n\t\tif (this.pv.update_z) {\n\t\t\tif (this.p.z.has_expression() && this.p.z.expression_controller) {\n\t\t\t\tawait this.p.z.expression_controller.compute_expression_for_points(points, (point, value) => {\n\t\t\t\t\tarray[point.index * 3 + 2] = value;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet point;\n\t\t\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\t\t\tpoint = points[i];\n\t\t\t\t\tarray[point.index * 3 + 2] = this.pv.z;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// private _create_init_normal(core_geometry: CoreGeometry) {\n\t// \tif (!core_geometry.has_attrib(NORMAL_ATTRIB_NAME)) {\n\t// \t\tcore_geometry.add_numeric_attrib(NORMAL_ATTRIB_NAME, 3, DEFAULT_NORMAL);\n\t// \t}\n\t// }\n\n\tprivate _invert_normals(core_group: CoreGroup) {\n\t\t// this._create_init_normal();\n\n\t\tfor (let core_object of core_group.core_objects()) {\n\t\t\tconst geometry = core_object.core_geometry().geometry();\n\t\t\tconst normal_attrib = geometry.attributes[NORMAL_ATTRIB_NAME];\n\t\t\tif (normal_attrib) {\n\t\t\t\tconst array = normal_attrib.array as number[];\n\t\t\t\tfor (let i = 0; i < array.length; i++) {\n\t\t\t\t\tarray[i] *= -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// let index_attrib;\n\t\t// if ((index_attrib = geometry.getIndex()) != null) {\n\t\t// \tconst { array } = index_attrib;\n\n\t\t// \tconst faces_count = array.length / 3;\n\t\t// \tfor(let i=0; i<faces_count; i++){\n\t\t// \t\tconst tmp = array[i*3];\n\t\t// \t\tarray[i*3] = array[(i*3)+2];\n\t\t// \t\tarray[(i*3)+2] = tmp;\n\t\t// \t}\n\n\t\t// } else {\n\t\t// \tconst geometry_wrapper = new CoreGeometry(geometry);\n\t\t// \tconst points = geometry_wrapper.points();\n\n\t\t// \tconst attrib_name = 'normal';\n\t\t// \tfor(let point of points){\n\t\t// \t\tconst normal = point.normal();\n\t\t// \t\tnormal.multiplyScalar(-1);\n\t\t// \t\tpoint.set_attrib_value(attrib_name, normal);\n\t\t// \t}\n\t\t// }\n\t}\n}\n","import {TypedSopNode} from './_Base';\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\nclass NullSopParamsConfig extends NodeParamsConfig {}\nconst ParamsConfig = new NullSopParamsConfig();\n\nexport class NullSopNode extends TypedSopNode<NullSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'null';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(0, 1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t\tthis.ui_data.set_border_radius(1000);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tif (core_group) {\n\t\t\tthis.set_core_group(core_group);\n\t\t} else {\n\t\t\tthis.set_objects([]);\n\t\t}\n\t}\n}\n","import {TypedSopNode, BaseSopNodeType} from './_Base';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\n// import {CoreWalker} from 'src/Core/Walker';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {GeometryContainer} from 'src/engine/containers/Geometry';\nclass ObjectMergeSopParamsConfig extends NodeParamsConfig {\n\tgeometry = ParamConfig.OPERATOR_PATH('', {\n\t\tnode_selection: {\n\t\t\tcontext: NodeContext.SOP,\n\t\t},\n\t});\n}\nconst ParamsConfig = new ObjectMergeSopParamsConfig();\n\nexport class ObjectMergeSopNode extends TypedSopNode<ObjectMergeSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'object_merge';\n\t}\n\n\t// _param_apply_parent_transform: boolean\n\tinitialize_node() {}\n\n\tasync cook(input_containers: CoreGroup[]) {\n\t\tconst geometry_node = this.p.geometry.found_node();\n\t\tif (geometry_node) {\n\t\t\tif (geometry_node.node_context() == NodeContext.SOP) {\n\t\t\t\tconst container = await geometry_node.request_container();\n\t\t\t\tthis.import_input(geometry_node as BaseSopNodeType, container);\n\t\t\t} else {\n\t\t\t\tthis.states.error.set('found node is not a geometry');\n\t\t\t}\n\t\t} else {\n\t\t\tthis.states.error.set(`node not found at path '${this.pv.geometry}'`);\n\t\t}\n\t}\n\n\timport_input(geometry_node: BaseSopNodeType, container: GeometryContainer) {\n\t\tlet core_group;\n\t\t// I unfortunately need to do a clone here,\n\t\t// because if 2 objectmerge nodes import the same geometry,\n\t\t// they would try to place it under 2 different geo nodes\n\t\t// which is not possible\n\t\tif ((core_group = container.core_content_cloned()) != null) {\n\t\t\t// cannot do that until i know how to make it recook\n\t\t\t// when the obj changes\n\t\t\t// if (this._param_apply_parent_transform){\n\t\t\t// \tconst matrix = geometry_node.parent().object().matrixWorld\n\t\t\t// \tgroup.children.forEach(child=>{\n\t\t\t// \t\tconsole.log(child)\n\t\t\t// \t\tconst geometry = child.geometry\n\t\t\t// \t\tif(geometry){\n\t\t\t// \t\t\tgeometry.applyMatrix(matrix)\n\t\t\t// \t\t}\n\t\t\t// \t})\n\t\t\t// }\n\n\t\t\tthis.set_core_group(core_group);\n\t\t} else {\n\t\t\tthis.states.error.set('invalid target');\n\t\t}\n\t}\n\n\t// geometry_node() {\n\t// \tif ((this._param_geometry != null) && (this._param_geometry !== '')) {\n\t// \t\tCoreWalker.find_node(this, this._param_geometry);\n\t// \t}\n\t// }\n}\n","import {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nconst THREE = {Float32BufferAttribute};\nimport {TypedSopNode} from './_Base';\n\n// import {CoreGroup} from 'src/Core/Geometry/Group';\nimport {CoreObject} from 'src/core/geometry/Object';\n// import {CoreGeometry} from 'src/Core/Geometry/Geometry'\n// import {CorePoint} from 'src/Core/Geometry/Point'\n\n// https://github.com/wwwtyro/geo-ambient-occlusion\nimport geoao from 'geo-ambient-occlusion';\n\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass OcclusionSopParamsConfig extends NodeParamsConfig {\n\tattrib_name = ParamConfig.STRING('occlusion');\n\tsamples = ParamConfig.INTEGER(256, {\n\t\trange: [1, 256],\n\t\trange_locked: [true, false],\n\t});\n\tsep = ParamConfig.SEPARATOR();\n\tbuffer_resolution = ParamConfig.INTEGER(512);\n\tbias = ParamConfig.FLOAT(0.01);\n}\nconst ParamsConfig = new OcclusionSopParamsConfig();\n\nexport class OcclusionSopNode extends TypedSopNode<OcclusionSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'occlusion';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t\t// this.ui_data.set_icon('palette');\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tconst core_objects = core_group.core_objects();\n\n\t\tfor (let core_object of core_objects) {\n\t\t\tawait this._process_occlusion_on_object(core_object);\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n\n\tprivate async _process_occlusion_on_object(core_object: CoreObject) {\n\t\tconst geometry = core_object.core_geometry().geometry();\n\n\t\tconst position_array = geometry.attributes.position.array;\n\t\tconst normal_array = geometry.attributes.normal.array;\n\t\tconst index_array = geometry.getIndex()?.array;\n\t\tconst aoSampler = geoao(position_array, {\n\t\t\tcells: index_array,\n\t\t\tnormals: normal_array,\n\t\t\tresolution: this.pv.buffer_resolution,\n\t\t\tbias: this.pv.bias,\n\t\t});\n\n\t\tfor (let i = 0; i < this.pv.samples; i++) {\n\t\t\taoSampler.sample();\n\t\t}\n\t\tconst ao = aoSampler.report();\n\n\t\tgeometry.setAttribute(this.pv.attrib_name, new THREE.Float32BufferAttribute(ao, 1));\n\n\t\taoSampler.dispose();\n\t}\n}\n","import {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {TypedSopNode} from './_Base';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Mesh} from 'three/src/objects/Mesh';\n\nconst POSITION = 'position';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass PeakSopParamsConfig extends NodeParamsConfig {\n\tamount = ParamConfig.FLOAT(1, {range: [-1, 1]});\n}\nconst ParamsConfig = new PeakSopParamsConfig();\n\nexport class PeakSopNode extends TypedSopNode<PeakSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'peak';\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tlet core_geometry, point;\n\t\tfor (let object of core_group.objects()) {\n\t\t\tobject.traverse((child_object) => {\n\t\t\t\tlet geometry;\n\t\t\t\tif ((geometry = (child_object as Mesh).geometry as BufferGeometry) != null) {\n\t\t\t\t\tcore_geometry = new CoreGeometry(geometry);\n\t\t\t\t\tfor (point of core_geometry.points()) {\n\t\t\t\t\t\tconst normal = point.normal();\n\t\t\t\t\t\tconst position = point.position();\n\t\t\t\t\t\tconst new_position = position.clone().add(normal.multiplyScalar(this.pv.amount));\n\t\t\t\t\t\tpoint.set_position(new_position);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.io.inputs.input_cloned(0)) {\n\t\t\t\t\t\tconst attrib = core_geometry.geometry().getAttribute(POSITION) as BufferAttribute;\n\t\t\t\t\t\tattrib.needsUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.set_core_group(core_group);\n\t}\n}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {PlaneBufferGeometry} from 'three/src/geometries/PlaneGeometry';\nimport {TypedSopNode} from './_Base';\nimport {CoreTransform} from 'src/core/Transform';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\nconst DEFAULT_UP = new Vector3(0, 0, 1);\nconst ROTATE_START = new Vector3(0, 0, 1);\nconst ROTATE_END = new Vector3(0, 1, 0);\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass PlaneSopParamsConfig extends NodeParamsConfig {\n\tsize = ParamConfig.VECTOR2([1, 1]);\n\tuse_segments_count = ParamConfig.BOOLEAN(0);\n\tstep_size = ParamConfig.FLOAT(1, {visible_if: {use_segments_count: 0}});\n\tsegments = ParamConfig.VECTOR2([1, 1], {visible_if: {use_segments_count: 1}});\n\tdirection = ParamConfig.VECTOR3([0, 1, 0]);\n\tcenter = ParamConfig.VECTOR3([0, 0, 0]);\n}\nconst ParamsConfig = new PlaneSopParamsConfig();\n\nexport class PlaneSopNode extends TypedSopNode<PlaneSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'plane';\n\t}\n\n\tprivate _core_transform = new CoreTransform();\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to create plane from (optional)'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(0, 1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.NEVER]);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tif (core_group) {\n\t\t\tthis._cook_with_input(core_group);\n\t\t} else {\n\t\t\tthis._cook_without_input();\n\t\t}\n\t}\n\t_cook_without_input() {\n\t\tconst geometry = this._create_plane(this.pv.size);\n\n\t\t// convert to buffer geo, as some render problems can occur otherwise\n\t\t// geometry = BufferGeometryUtils.mergeBufferGeometries([geometry])\n\t\t// console.log(geometry, geometry.isBufferGeometry)\n\t\tthis._core_transform.rotate_geometry(geometry, DEFAULT_UP, this.pv.direction);\n\n\t\tconst matrix = this._core_transform.translation_matrix(this.pv.center);\n\t\tgeometry.applyMatrix(matrix);\n\n\t\tthis.set_geometry(geometry);\n\t}\n\t_cook_with_input(core_group: CoreGroup) {\n\t\tconst bbox = core_group.bounding_box();\n\t\tconst size = new Vector3();\n\t\tbbox.getSize(size);\n\t\tconst center = new Vector3();\n\t\tbbox.getCenter(center);\n\n\t\t// TODO: rotate the input geo to get the accurate bbox\n\t\tconst size2d = new Vector2(size.x, size.z);\n\t\tconst geometry = this._create_plane(size2d);\n\n\t\tthis._core_transform.rotate_geometry(geometry, ROTATE_START, ROTATE_END);\n\n\t\tconst matrix = this._core_transform.translation_matrix(center);\n\t\tgeometry.applyMatrix(matrix);\n\n\t\t// const buffer_geometry = CoreGeometry.clone(geometry);\n\t\tthis.set_geometry(geometry);\n\t}\n\n\t_create_plane(size: Vector2) {\n\t\tlet segments_count;\n\t\tsize = size.clone();\n\t\tif (this.pv.use_segments_count) {\n\t\t\tsegments_count = {\n\t\t\t\tx: Math.floor(this.pv.segments.x),\n\t\t\t\ty: Math.floor(this.pv.segments.y),\n\t\t\t};\n\t\t} else {\n\t\t\tsegments_count = {\n\t\t\t\tx: Math.floor(size.x / this.pv.step_size),\n\t\t\t\ty: Math.floor(size.y / this.pv.step_size),\n\t\t\t};\n\t\t\tsize.x = segments_count.x * this.pv.step_size;\n\t\t\tsize.y = segments_count.y * this.pv.step_size;\n\t\t}\n\t\treturn new PlaneBufferGeometry(size.x, size.y, segments_count.x, segments_count.y);\n\t}\n}\n","// import lodash_map from 'lodash/map'\n\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CoreObject} from 'src/core/geometry/Object';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {BooleanParam} from 'src/engine/params/Boolean';\nimport {FloatParam} from 'src/engine/params/Float';\n\nconst POSITION_ATTRIB_NAME = 'position';\n\ntype ValueArrayByName = Map<string, number[]>;\ntype ComponentOffset = 0 | 1 | 2;\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass PointSopParamsConfig extends NodeParamsConfig {\n\tupdate_x = ParamConfig.BOOLEAN(0);\n\tx = ParamConfig.FLOAT('@P.x', {\n\t\tvisible_if: {update_x: 1},\n\t\texpression: {for_entities: true},\n\t});\n\tupdate_y = ParamConfig.BOOLEAN(0);\n\ty = ParamConfig.FLOAT('@P.y', {\n\t\tvisible_if: {update_y: 1},\n\t\texpression: {for_entities: true},\n\t});\n\tupdate_z = ParamConfig.BOOLEAN(0);\n\tz = ParamConfig.FLOAT('@P.z', {\n\t\tvisible_if: {update_z: 1},\n\t\texpression: {for_entities: true},\n\t});\n\tupdate_normals = ParamConfig.BOOLEAN(1);\n}\nconst ParamsConfig = new PointSopParamsConfig();\n\nexport class PointSopNode extends TypedSopNode<PointSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'point';\n\t}\n\n\tprivate _x_arrays_by_geometry_uuid: ValueArrayByName = new Map();\n\tprivate _y_arrays_by_geometry_uuid: ValueArrayByName = new Map();\n\tprivate _z_arrays_by_geometry_uuid: ValueArrayByName = new Map();\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['points to move'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t\t// this.ui_data.set_icon('dot-circle');\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tawait this._eval_expressions_for_core_group(core_group);\n\t}\n\n\t// group.traverse (object)=>\n\t// \tif (geometry = object.geometry)?\n\t// \t\tthis._eval_expressions(geometry)\n\t// \t\tgeometry.computeVertexNormals()\n\n\tasync _eval_expressions_for_core_group(core_group: CoreGroup) {\n\t\tconst core_objects = core_group.core_objects();\n\t\t// this._allocate_arrays(core_objects)\n\n\t\tfor (let i = 0; i < core_objects.length; i++) {\n\t\t\tawait this._eval_expressions_for_core_object(core_objects[i]);\n\t\t}\n\n\t\tif (this.pv.update_normals) {\n\t\t\tcore_group.compute_vertex_normals();\n\t\t}\n\n\t\tconst geometries = core_group.geometries();\n\t\tfor (let geometry of geometries) {\n\t\t\tgeometry.computeBoundingBox();\n\t\t}\n\n\t\t// needs update required for when no cloning\n\t\tif (!this.io.inputs.input_cloned(0)) {\n\t\t\tconst geometries = core_group.geometries();\n\t\t\tfor (let geometry of geometries) {\n\t\t\t\tconst attrib = geometry.getAttribute(POSITION_ATTRIB_NAME) as BufferAttribute;\n\t\t\t\tattrib.needsUpdate = true;\n\t\t\t}\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n\tasync _eval_expressions_for_core_object(core_object: CoreObject) {\n\t\tconst object = core_object.object();\n\t\tconst geometry = (object as Mesh).geometry as BufferGeometry;\n\t\tconst points = core_object.points();\n\n\t\tconst array = geometry.getAttribute(POSITION_ATTRIB_NAME).array as number[];\n\n\t\tconst tmp_array_x = await this._update_from_param(\n\t\t\tgeometry,\n\t\t\tarray,\n\t\t\tpoints,\n\t\t\tthis.p.update_x,\n\t\t\tthis.p.x,\n\t\t\tthis.pv.x,\n\t\t\tthis._x_arrays_by_geometry_uuid,\n\t\t\t0\n\t\t);\n\t\tconst tmp_array_y = await this._update_from_param(\n\t\t\tgeometry,\n\t\t\tarray,\n\t\t\tpoints,\n\t\t\tthis.p.update_y,\n\t\t\tthis.p.y,\n\t\t\tthis.pv.y,\n\t\t\tthis._y_arrays_by_geometry_uuid,\n\t\t\t1\n\t\t);\n\t\tconst tmp_array_z = await this._update_from_param(\n\t\t\tgeometry,\n\t\t\tarray,\n\t\t\tpoints,\n\t\t\tthis.p.update_z,\n\t\t\tthis.p.z,\n\t\t\tthis.pv.z,\n\t\t\tthis._z_arrays_by_geometry_uuid,\n\t\t\t2\n\t\t);\n\n\t\tif (tmp_array_x) {\n\t\t\tthis._commit_tmp_values(tmp_array_x, array, 0);\n\t\t}\n\t\tif (tmp_array_y) {\n\t\t\tthis._commit_tmp_values(tmp_array_y, array, 1);\n\t\t}\n\t\tif (tmp_array_z) {\n\t\t\tthis._commit_tmp_values(tmp_array_z, array, 2);\n\t\t}\n\t}\n\n\tprivate async _update_from_param(\n\t\tgeometry: BufferGeometry,\n\t\tarray: number[],\n\t\tpoints: CorePoint[],\n\t\tdo_update_param: BooleanParam,\n\t\tvalue_param: FloatParam,\n\t\tparam_value: number,\n\t\tarrays_by_geometry_uuid: ValueArrayByName,\n\t\toffset: ComponentOffset\n\t) {\n\t\tconst do_update = do_update_param;\n\t\tconst param = value_param;\n\n\t\tlet tmp_array = this._init_array_if_required(geometry, arrays_by_geometry_uuid, points.length, offset);\n\t\tif (do_update.value) {\n\t\t\tif (param.has_expression() && param.expression_controller) {\n\t\t\t\tawait param.expression_controller.compute_expression_for_points(points, (point, value) => {\n\t\t\t\t\ttmp_array[point.index] = value;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet point;\n\t\t\t\tfor (let i = 0; i < points.length; i++) {\n\t\t\t\t\tpoint = points[i];\n\t\t\t\t\ttmp_array[point.index] = param_value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn tmp_array;\n\t}\n\n\tprivate _init_array_if_required(\n\t\tgeometry: BufferGeometry,\n\t\tarrays_by_geometry_uuid: ValueArrayByName,\n\t\tpoints_count: number,\n\t\toffset: ComponentOffset\n\t) {\n\t\tconst uuid = geometry.uuid;\n\t\tconst current_array = arrays_by_geometry_uuid.get(uuid);\n\t\tif (current_array) {\n\t\t\t// only create new array if we need more point, or as soon as the length is different?\n\t\t\tif (current_array.length < points_count) {\n\t\t\t\tconst new_array = this._array_for_component(geometry, points_count, offset);\n\t\t\t\tarrays_by_geometry_uuid.set(uuid, new_array);\n\t\t\t\treturn new_array;\n\t\t\t} else {\n\t\t\t\treturn current_array;\n\t\t\t}\n\t\t} else {\n\t\t\tconst new_array = this._array_for_component(geometry, points_count, offset);\n\t\t\tarrays_by_geometry_uuid.set(uuid, new_array);\n\t\t\treturn new_array;\n\t\t}\n\t}\n\n\tprivate _array_for_component(geometry: BufferGeometry, points_count: number, offset: ComponentOffset) {\n\t\tconst new_array = new Array<number>(points_count);\n\t\tconst src_array = geometry.getAttribute(POSITION_ATTRIB_NAME).array;\n\t\tfor (let i = 0; i < new_array.length; i++) {\n\t\t\tnew_array[i] = src_array[i * 3 + offset];\n\t\t}\n\t\treturn new_array;\n\t}\n\n\tprivate _commit_tmp_values(tmp_array: number[], target_array: number[], offset: number) {\n\t\tfor (let i = 0; i < tmp_array.length; i++) {\n\t\t\ttarget_array[i * 3 + offset] = tmp_array[i];\n\t\t}\n\t}\n}\n","import {TypedSopNode} from './_Base';\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\nimport {CoreTransform} from 'src/core/Transform';\nimport {CoreGeometryUtilCircle} from 'src/core/geometry/util/Circle';\nimport {CoreGeometryUtilCurve} from 'src/core/geometry/util/Curve';\nimport {CoreGeometryOperationSkin} from 'src/core/geometry/operation/Skin';\n\nimport {Vector3} from 'three/src/math/Vector3';\n// import {TubeBufferGeometry} from 'three/src/geometries/TubeGeometry';\nimport {LineSegments} from 'three/src/objects/LineSegments';\n// import {CatmullRomCurve3} from 'three/src/extras/curves/CatmullRomCurve3';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\nconst DEFAULT_R = new Vector3(0, 0, 0);\nconst DEFAULT_S = new Vector3(1, 1, 1);\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CorePoint} from 'src/core/geometry/Point';\nclass PolywireSopParamsConfig extends NodeParamsConfig {\n\tradius = ParamConfig.FLOAT(1);\n\tsegments_radial = ParamConfig.INTEGER(8, {\n\t\trange: [3, 20],\n\t\trange_locked: [true, false],\n\t});\n\tclosed = ParamConfig.BOOLEAN(0);\n}\nconst ParamsConfig = new PolywireSopParamsConfig();\n\nexport class PolywireSopNode extends TypedSopNode<PolywireSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'polywire';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['lines to create tubes from'];\n\t}\n\n\tprivate _core_transform = new CoreTransform();\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.NEVER]);\n\t}\n\n\tprivate _geometries: BufferGeometry[] = [];\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tthis._geometries = [];\n\t\tfor (let object of core_group.objects()) {\n\t\t\tif (object instanceof LineSegments) {\n\t\t\t\tthis._create_tube(object);\n\t\t\t}\n\t\t}\n\n\t\t//if @_param_merge\n\t\t//geometries = lodash_map @_geometries, (object)->object.geometry\n\t\tconst merged_geometry = CoreGeometry.merge_geometries(this._geometries);\n\t\tfor (let geometry of this._geometries) {\n\t\t\tgeometry.dispose();\n\t\t}\n\t\tif (merged_geometry) {\n\t\t\tconst object = this.create_object(merged_geometry);\n\n\t\t\tthis.set_object(object);\n\t\t} else {\n\t\t\tthis.set_objects([]);\n\t\t}\n\t}\n\t//else\n\t//\tthis.set_objects( @_objects )\n\n\t_create_tube(line_segment: LineSegments) {\n\t\tconst geometry = line_segment.geometry as BufferGeometry;\n\t\tconst wrapper = new CoreGeometry(geometry);\n\t\tconst points = wrapper.points();\n\t\tconst indices = geometry.getIndex()?.array as number[];\n\n\t\tconst accumulated_curve_point_indices = CoreGeometryUtilCurve.accumulated_curve_point_indices(indices);\n\n\t\tfor (let curve_point_indices of accumulated_curve_point_indices) {\n\t\t\tconst current_points = curve_point_indices.map((index) => points[index]);\n\t\t\tthis._create_tube_from_points(current_points);\n\t\t}\n\t}\n\n\t_create_tube_from_points(points: CorePoint[]) {\n\t\tif (points.length <= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst positions = points.map((point) => point.attrib_value('position'));\n\n\t\tconst circle_template = CoreGeometryUtilCircle.create(this.pv.radius, this.pv.segments_radial);\n\t\tconst circles: BufferGeometry[] = [];\n\t\tconst scale = 1;\n\t\tfor (let position of positions) {\n\t\t\tconst t = position;\n\t\t\tconst matrix = this._core_transform.matrix(t, DEFAULT_R, DEFAULT_S, scale);\n\n\t\t\tconst new_circle = circle_template.clone();\n\t\t\tnew_circle.applyMatrix(matrix);\n\t\t\tcircles.push(new_circle);\n\t\t}\n\n\t\tfor (let i = 0; i < circles.length; i++) {\n\t\t\tif (i > 0) {\n\t\t\t\tconst circle = circles[i];\n\t\t\t\tconst prev_circle = circles[i - 1];\n\n\t\t\t\tconst geometry = this._skin(prev_circle, circle);\n\t\t\t\tthis._geometries.push(geometry);\n\t\t\t}\n\t\t}\n\t}\n\n\t//this.set_geometries(circles, Core.Geometry.Constant.OBJECT_TYPE.LINE_SEGMENTS)\n\n\t// curve = new CatmullRomCurve3(positions)\n\t// segments_count = positions.length-1\n\n\t// geometry = new TubeBufferGeometry(\n\t// \tcurve,\n\t// \tsegments_count,\n\t// \t@_param_radius,\n\t// \t@_param_segments_radial,\n\t// \t@_param_closed\n\t// \t)\n\n\t// object = this.create_object(geometry)\n\t// @_objects.push(object)\n\t_skin(geometry1: BufferGeometry, geometry0: BufferGeometry) {\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst operation = new CoreGeometryOperationSkin(geometry, geometry1, geometry0);\n\t\toperation.process();\n\n\t\treturn geometry;\n\t}\n}\n","import {Vector3} from 'three/src/math/Vector3';\nimport {Raycaster, Intersection} from 'three/src/core/Raycaster';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {MeshBasicMaterial} from 'three/src/materials/MeshBasicMaterial';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {DoubleSide} from 'three/src/constants';\n\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\nconst MAT_DOUBLE_SIDED = new MeshBasicMaterial({\n\tside: DoubleSide,\n});\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass RaySopParamsConfig extends NodeParamsConfig {\n\tuse_normals = ParamConfig.BOOLEAN(1);\n\tdirection = ParamConfig.VECTOR3([0, -1, 0], {\n\t\tvisible_if: {use_normals: 0},\n\t});\n\ttransfer_face_normals = ParamConfig.BOOLEAN(1);\n}\nconst ParamsConfig = new RaySopParamsConfig();\n\nexport class RaySopNode extends TypedSopNode<RaySopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'ray';\n\t}\n\n\t// _material_by_object_uuid: MaterialByString\n\tprivate _bound_assign_mat = this._assign_double_sided_material_to_object.bind(this); //(Object3D)=>void;\n\tprivate _raycaster = new Raycaster();\n\n\tstatic double_sided_material() {\n\t\treturn MAT_DOUBLE_SIDED;\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to move', 'geometry to ray onto'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(2);\n\t\tthis.io.inputs.init_inputs_clonable_state([\n\t\t\tInputCloneMode.FROM_NODE,\n\t\t\tInputCloneMode.ALWAYS, // to assign double sided mat\n\t\t]);\n\t}\n\n\tcreate_params() {}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\tconst core_group_collision = input_contents[1];\n\n\t\tthis.ray(core_group, core_group_collision);\n\t}\n\n\tray(core_group: CoreGroup, core_group_collision: CoreGroup) {\n\t\t// this._material_by_object_uuid = {}\n\t\tthis._assign_double_sided_material_to_core_group(core_group_collision);\n\n\t\tlet direction: Vector3, first_intersect: Intersection;\n\t\tfor (let point of core_group.points()) {\n\t\t\tdirection = this.pv.use_normals ? point.normal() : this.pv.direction;\n\t\t\tthis._raycaster.set(point.position(), direction);\n\n\t\t\tfirst_intersect = this._raycaster.intersectObjects(core_group_collision.objects(), true)[0];\n\t\t\tif (first_intersect) {\n\t\t\t\tpoint.set_position(first_intersect.point);\n\t\t\t\tif (this.pv.transfer_face_normals && first_intersect.face) {\n\t\t\t\t\tpoint.set_normal(first_intersect.face.normal);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.set_core_group(core_group);\n\t}\n\n\t_assign_double_sided_material_to_core_group(core_group: CoreGroup) {\n\t\tfor (let object of core_group.objects()) {\n\t\t\tobject.traverse(this._bound_assign_mat);\n\t\t}\n\t}\n\t_assign_double_sided_material_to_object(object: Object3D) {\n\t\t// this._material_by_object_uuid[object.uuid] = object.material\n\t\t(object as Mesh).material = RaySopNode.double_sided_material();\n\t}\n\n\t// average_normals(geometry){\n\t// \tconst normals = [];\n\t// \tconst vertex_index_names = ['a', 'b', 'c'];\n\t// \tlodash_each(geometry.faces, face=> {\n\t// \t\treturn lodash_each(vertex_index_names, (vertex_index_name, i)=> {\n\t// \t\t\tconst vertex_index = face[vertex_index_name];\n\t// \t\t\tif (normals[vertex_index] == null) { normals[vertex_index] = []; }\n\t// \t\t\treturn normals[vertex_index].push(face.vertexNormals[i].clone());\n\t// \t\t});\n\t// \t});\n\n\t// \tlodash_each(normals, function(normal_group, i){\n\t// \t\tconst average = new Vector3(\n\t// \t\t\t(lodash_sum(lodash_map(normal_group, 'x')) / normal_group.length),\n\t// \t\t\t(lodash_sum(lodash_map(normal_group, 'y')) / normal_group.length),\n\t// \t\t\t(lodash_sum(lodash_map(normal_group, 'z')) / normal_group.length)\n\t// \t\t);\n\t// \t\treturn normals[i] = average;\n\t// \t});\n\n\t// \treturn normals;\n\t// }\n}\n","import {LineSegments} from 'three/src/objects/LineSegments';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\n\nimport {CatmullRomCurve3} from 'three/src/extras/curves/CatmullRomCurve3';\n// import {CubicBezierCurve3} from 'three/src/extras/curves/CubicBezierCurve3';\n// import {LineCurve3} from 'three/src/extras/curves/LineCurve3';\n// import {QuadraticBezierCurve3} from 'three/src/extras/curves/QuadraticBezierCurve3';\nimport {BufferGeometryUtils} from 'modules/three/examples/jsm/utils/BufferGeometryUtils';\n\nimport lodash_flatten from 'lodash/flatten';\nimport lodash_map from 'lodash/map';\nimport {TypedSopNode} from './_Base';\nimport {CoreConstant} from 'src/core/geometry/Constant';\nimport {CoreGeometryUtilCurve} from 'src/core/geometry/util/Curve';\nimport {CoreGeometry} from 'src/core/geometry/Geometry';\n\nexport enum METHOD {\n\tPOINTS_COUNT = 'points_count',\n\tSEGMENT_LENGTH = 'segment_length',\n}\nexport const METHODS = [METHOD.POINTS_COUNT, METHOD.SEGMENT_LENGTH];\n\n// matches threejs curve type in CatmullRomCurve3.js\nexport enum CURVE_TYPE {\n\tCENTRIPETAL = 'centripetal',\n\tCHORDAL = 'chordal',\n\tCATMULLROM = 'catmullrom',\n}\nexport const CURVE_TYPES = [CURVE_TYPE.CENTRIPETAL, CURVE_TYPE.CHORDAL, CURVE_TYPE.CATMULLROM];\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {TypeAssert} from 'src/engine/poly/Assert';\nclass ResampleSopParamsConfig extends NodeParamsConfig {\n\tmethod = ParamConfig.INTEGER(METHODS.indexOf(METHOD.POINTS_COUNT), {\n\t\tmenu: {\n\t\t\tentries: METHODS.map((name, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: name,\n\t\t\t\t\tvalue: i,\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n\tcurve_type = ParamConfig.INTEGER(CURVE_TYPES.indexOf(CURVE_TYPE.CATMULLROM), {\n\t\trange: [0, 2],\n\t\trange_locked: [true, true],\n\t\tmenu: {\n\t\t\tentries: CURVE_TYPES.map((name, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: name,\n\t\t\t\t\tvalue: i,\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n\ttension = ParamConfig.FLOAT(0.01, {\n\t\trange: [0, 1],\n\t\trange_locked: [true, true],\n\t});\n\tpoints_count = ParamConfig.INTEGER(100, {\n\t\tvisible_if: {method: METHODS.indexOf(METHOD.POINTS_COUNT)},\n\t});\n\tsegment_length = ParamConfig.FLOAT(1, {\n\t\tvisible_if: {method: METHODS.indexOf(METHOD.SEGMENT_LENGTH)},\n\t});\n}\nconst ParamsConfig = new ResampleSopParamsConfig();\n\nexport class ResampleSopNode extends TypedSopNode<ResampleSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'resample';\n\t}\n\n\t// private _objects: Object3D\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\t// this._objects = [];\n\t\tconst resampled_objects = [];\n\t\tif (this.pv.points_count >= 2) {\n\t\t\tconst core_objects = core_group.core_objects();\n\t\t\tfor (let i = 0; i < core_objects.length; i++) {\n\t\t\t\tconst core_object = core_objects[i];\n\t\t\t\tconst object = core_object.object();\n\t\t\t\tif (object instanceof LineSegments) {\n\t\t\t\t\tconst resampled_object = this._resample(object);\n\t\t\t\t\tresampled_objects.push(resampled_object);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// if (this.pv.merge) {\n\t\t// \tconst geometries = lodash_map(this._objects, object => object.geometry);\n\t\t// \tconst merged_geometry = CoreGeometry.merge_geometries(geometries);\n\t\t// \tlodash_each(geometries, geometry => geometry.dispose());\n\t\t// \tconst object = this.create_object(merged_geometry, CoreConstant.OBJECT_TYPE.LINE_SEGMENTS);\n\t\t// \tthis.set_object( object );\n\t\t// } else {\n\t\tthis.set_objects(resampled_objects);\n\t\t// }\n\t}\n\n\t_resample(line_segment: LineSegments) {\n\t\tconst geometry = line_segment.geometry as BufferGeometry;\n\t\tconst core_geometry = new CoreGeometry(geometry);\n\t\tconst points = core_geometry.points();\n\t\tconst indices = geometry.getIndex()?.array as number[];\n\n\t\tconst accumulated_curve_point_indices = CoreGeometryUtilCurve.accumulated_curve_point_indices(indices);\n\t\t// accumulated_curve_point_indices = [accumulated_curve_point_indices[0]]\n\t\tconst geometries: BufferGeometry[] = [];\n\t\tfor (let i = 0; i < accumulated_curve_point_indices.length; i++) {\n\t\t\tconst curve_point_indices = accumulated_curve_point_indices[i];\n\t\t\tconst current_points = curve_point_indices.map((index) => points[index]);\n\t\t\tconst geometry = this._create_curve_from_points(current_points);\n\t\t\tif (geometry) {\n\t\t\t\tgeometries.push(geometry);\n\t\t\t}\n\t\t}\n\t\tconst merged_geometry = BufferGeometryUtils.mergeBufferGeometries(geometries);\n\t\tconst object = this.create_object(merged_geometry, CoreConstant.OBJECT_TYPE.LINE_SEGMENTS);\n\t\treturn object;\n\t}\n\n\t_create_curve_from_points(points: CorePoint[]) {\n\t\tif (points.length <= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst old_curve_positions = lodash_map(points, (point) => point.attrib_value('position'));\n\t\tconst closed = false;\n\t\tconst curve_type = CURVE_TYPES[this.pv.curve_type];\n\t\tconst tension = this.pv.tension;\n\t\tconst curve = new CatmullRomCurve3(old_curve_positions, closed, curve_type, tension);\n\t\t// const curve = new LineCurve3(old_curve_positions);\n\t\t// const curve = new CubicBezierCurve3(old_curve_positions);\n\t\t// const curve = new QuadraticBezierCurve3(old_curve_positions);\n\n\t\t// TODO: could I detect when a curve has points that are very close\n\t\t// and prevent a curve to go too far\n\t\tconst new_curve_points = this._get_points_from_curve(curve);\n\n\t\tlet positions = [];\n\t\tconst indices = [];\n\n\t\tfor (let i = 0; i < new_curve_points.length; i++) {\n\t\t\tconst point_position = new_curve_points[i];\n\n\t\t\tconst position = point_position.toArray();\n\t\t\tpositions.push(position);\n\n\t\t\tif (i > 0) {\n\t\t\t\tindices.push(i - 1);\n\t\t\t\tindices.push(i);\n\t\t\t}\n\t\t}\n\n\t\tpositions = lodash_flatten(positions);\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute('position', new Float32BufferAttribute(positions, 3));\n\t\tgeometry.setIndex(indices);\n\n\t\treturn geometry;\n\t\t// const object = this.create_object(geometry, CoreConstant.OBJECT_TYPE.LINE_SEGMENTS);\n\t\t// this._objects.push(object);\n\t}\n\n\t_get_points_from_curve(curve: CatmullRomCurve3) {\n\t\tconst method = METHODS[this.pv.method];\n\t\tswitch (method) {\n\t\t\tcase METHOD.POINTS_COUNT:\n\t\t\t\treturn curve.getSpacedPoints(Math.max(2, this.pv.points_count));\n\t\t\tcase METHOD.SEGMENT_LENGTH:\n\t\t\t\tvar length = curve.getLength();\n\n\t\t\t\tvar points_count = this.pv.segment_length !== 0 ? 1 + length / this.pv.segment_length : 2;\n\n\t\t\t\tpoints_count = Math.max(2, points_count);\n\n\t\t\t\treturn curve.getSpacedPoints(points_count);\n\t\t}\n\t\tTypeAssert.unreachable(method);\n\t}\n}\n","import {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\nconst THREE = {BufferAttribute, BufferGeometry};\nimport lodash_range from 'lodash/range';\nimport lodash_isNumber from 'lodash/isNumber';\nimport lodash_sortBy from 'lodash/sortBy';\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CoreConstant} from 'src/core/geometry/Constant';\nimport {CoreMath} from 'src/core/math/_Module';\nimport {CoreIterator} from 'src/core/Iterator';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nclass ScatterSopParamsConfig extends NodeParamsConfig {\n\tpoints_count = ParamConfig.INTEGER(100, {\n\t\trange: [0, 100],\n\t\trange_locked: [true, false],\n\t});\n\tseed = ParamConfig.INTEGER(0, {\n\t\trange: [0, 100],\n\t\trange_locked: [false, false],\n\t});\n\ttransfer_attributes = ParamConfig.BOOLEAN(0);\n\tattributes_to_transfer = ParamConfig.STRING('normal', {\n\t\tvisible_if: {transfer_attributes: 1},\n\t});\n\tadd_id_attribute = ParamConfig.BOOLEAN(1);\n}\nconst ParamsConfig = new ScatterSopParamsConfig();\n\nexport class ScatterSopNode extends TypedSopNode<ScatterSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'scatter';\n\t}\n\n\t// private _positions: number[];\n\t// private _areas_thresholds: number[];\n\t// private _attrib_values_by_name = {};\n\t// private _area_sum: number;\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to scatter points onto'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.NEVER]);\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\t// const objects = input_contents[0] //.group({clone: false})\n\t\tconst core_group = input_contents[0]; //CoreGroup.from_objects(objects)\n\t\tlet faces = core_group.faces();\n\t\t// const areas_by_face_index = []\n\t\tconst areas_thresholds: number[] = [];\n\t\tlet area_sum = 0;\n\t\tconst area_by_face_index: Map<number, number> = new Map();\n\n\t\tfor (let face of faces) {\n\t\t\tconst area = face.area;\n\t\t\tarea_by_face_index.set(face.index, area);\n\t\t}\n\t\tconst sorted_faces = lodash_sortBy(faces, (f) => {\n\t\t\treturn area_by_face_index.get(f.index);\n\t\t});\n\n\t\tlet i = 0;\n\t\tfor (let face of sorted_faces) {\n\t\t\tarea_sum += area_by_face_index.get(face.index) as number;\n\t\t\tareas_thresholds[i] = area_sum;\n\t\t\ti++;\n\t\t}\n\n\t\tconst positions: number[] = [];\n\t\tlet attrib_names: string[] = [];\n\t\tif (this.pv.transfer_attributes) {\n\t\t\tattrib_names = core_group.attrib_names_matching_mask(this.pv.attributes_to_transfer);\n\t\t}\n\n\t\tconst attrib_values_by_name: Map<string, number[]> = new Map();\n\t\tconst attrib_sizes_by_name: Map<string, number> = new Map();\n\t\tfor (let attrib_name of attrib_names) {\n\t\t\tattrib_values_by_name.set(attrib_name, []);\n\t\t\tattrib_sizes_by_name.set(attrib_name, core_group.attrib_size(attrib_name));\n\t\t}\n\n\t\tconst iterator = new CoreIterator();\n\t\t// await iterator.start_with_count(this.pv.points_count, this._add_point.bind(this))\n\t\tawait iterator.start_with_count(this.pv.points_count, (point_index: number) => {\n\t\t\tconst rand = CoreMath.rand_float(this.pv.seed + point_index) * area_sum;\n\n\t\t\tfor (let face_index = 0; face_index < areas_thresholds.length; face_index++) {\n\t\t\t\tconst areas_threshold = areas_thresholds[face_index];\n\n\t\t\t\tif (rand <= areas_threshold) {\n\t\t\t\t\tconst face = sorted_faces[face_index];\n\t\t\t\t\tconst position = face.random_position(rand);\n\t\t\t\t\tposition.toArray(positions, positions.length);\n\n\t\t\t\t\tfor (let attrib_name of attrib_names) {\n\t\t\t\t\t\tconst attrib_value = face.attrib_value_at_position(attrib_name, position);\n\t\t\t\t\t\tif (lodash_isNumber(attrib_value)) {\n\t\t\t\t\t\t\tattrib_values_by_name.get(attrib_name)!.push(attrib_value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tattrib_value.toArray(\n\t\t\t\t\t\t\t\tattrib_values_by_name.get(attrib_name),\n\t\t\t\t\t\t\t\tattrib_values_by_name.get(attrib_name)!.length\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// for(let point_index=0; point_index<this.pv.points_count; point_index++){\n\n\t\t// \tconst rand = CoreMath.rand_float(this.pv.seed+point_index) * area_sum\n\n\t\t// \tfor(let face_index=0; face_index<areas_thresholds.length; face_index++){\n\n\t\t// \t\tconst areas_threshold = areas_thresholds[face_index]\n\n\t\t// \t\tif(rand <= areas_threshold){\n\t\t// \t\t\tconst face = sorted_faces[face_index]\n\t\t// \t\t\tconst position = face.random_position(rand)\n\t\t// \t\t\tposition.toArray(positions, positions.length)\n\n\t\t// \t\t\tfor(let attrib_name of attrib_names){\n\t\t// \t\t\t\tconst attrib_value = face.attrib_value_at_position(attrib_name, position)\n\t\t// \t\t\t\tif (lodash_isNumber(attrib_value)){\n\t\t// \t\t\t\t\tattrib_values_by_name[attrib_name].push(attrib_value)\n\t\t// \t\t\t\t} else {\n\t\t// \t\t\t\t\tattrib_value.toArray(\n\t\t// \t\t\t\t\t\tattrib_values_by_name[attrib_name],\n\t\t// \t\t\t\t\t\tattrib_values_by_name[attrib_name].length\n\t\t// \t\t\t\t\t)\n\t\t// \t\t\t\t}\n\t\t// \t\t\t}\n\n\t\t// \t\t\tbreak;\n\t\t// \t\t}\n\t\t// \t}\n\t\t// }\n\n\t\tconst geometry = new THREE.BufferGeometry();\n\t\tgeometry.setAttribute('position', new THREE.BufferAttribute(new Float32Array(positions), 3));\n\t\tfor (let attrib_name of attrib_names) {\n\t\t\tgeometry.setAttribute(\n\t\t\t\tattrib_name,\n\t\t\t\tnew THREE.BufferAttribute(\n\t\t\t\t\tnew Float32Array(attrib_values_by_name.get(attrib_name)!),\n\t\t\t\t\tattrib_sizes_by_name.get(attrib_name)!\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (this.pv.add_id_attribute) {\n\t\t\tconst ids = lodash_range(this.pv.points_count);\n\t\t\tgeometry.setAttribute('id', new THREE.BufferAttribute(new Float32Array(ids), 1));\n\t\t}\n\n\t\tthis.set_geometry(geometry, CoreConstant.OBJECT_TYPE.POINTS);\n\t}\n\n\t// private _add_point(point_index: number) {\n\t// \tconst rand = CoreMath.rand_float(this.pv.seed + point_index) * this._area_sum;\n\n\t// \tfor (let face_index = 0; face_index < this._areas_thresholds.length; face_index++) {\n\t// \t\tconst areas_threshold = this._areas_thresholds[face_index];\n\n\t// \t\tif (rand <= areas_threshold) {\n\t// \t\t\tconst face = this._sorted_faces[face_index];\n\t// \t\t\tconst position = face.random_position(rand);\n\t// \t\t\tposition.toArray(positions, positions.length);\n\n\t// \t\t\tfor (let attrib_name of attrib_names) {\n\t// \t\t\t\tconst attrib_value = face.attrib_value_at_position(attrib_name, position);\n\t// \t\t\t\tif (lodash_isNumber(attrib_value)) {\n\t// \t\t\t\t\tthis._attrib_values_by_name[attrib_name].push(attrib_value);\n\t// \t\t\t\t} else {\n\t// \t\t\t\t\tattrib_value.toArray(\n\t// \t\t\t\t\t\tthis._attrib_values_by_name[attrib_name],\n\t// \t\t\t\t\t\tthis._attrib_values_by_name[attrib_name].length\n\t// \t\t\t\t\t);\n\t// \t\t\t\t}\n\t// \t\t\t}\n\n\t// \t\t\tbreak;\n\t// \t\t}\n\t// \t}\n\t// }\n}\n","import {TypedSopNode} from './_Base';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass ShadowsSopParamsConfig extends NodeParamsConfig {\n\tcast_shadow = ParamConfig.BOOLEAN(1);\n\treceive_shadow = ParamConfig.BOOLEAN(1);\n\tapply_to_children = ParamConfig.BOOLEAN(0);\n}\nconst ParamsConfig = new ShadowsSopParamsConfig();\n\nexport class ShadowsSopNode extends TypedSopNode<ShadowsSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'shadows';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['objects to change shadows properties of'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\n\t\tfor (let object of core_group.objects()) {\n\t\t\tif (this.pv.apply_to_children) {\n\t\t\t\tobject.traverse((child) => {\n\t\t\t\t\tchild.castShadow = this.pv.cast_shadow;\n\t\t\t\t\tchild.receiveShadow = this.pv.receive_shadow;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tobject.castShadow = this.pv.cast_shadow;\n\t\t\t\tobject.receiveShadow = this.pv.receive_shadow;\n\t\t\t}\n\t\t}\n\n\t\tconsole.log(core_group.objects());\n\t\tthis.set_core_group(core_group);\n\t}\n}\n","import {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {LineSegments} from 'three/src/objects/LineSegments';\nimport lodash_sortBy from 'lodash/sortBy';\nimport lodash_reverse from 'lodash/reverse';\nimport lodash_compact from 'lodash/compact';\nimport {TypedSopNode} from './_Base';\n\nimport {CoreGeometryUtilCurve} from 'src/core/geometry/util/Curve';\nimport {CoreGeometryOperationSkin} from 'src/core/geometry/operation/Skin';\nimport {CoreGroup} from 'src/core/geometry/Group';\n\nimport {NodeParamsConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass SkinSopParamsConfig extends NodeParamsConfig {}\nconst ParamsConfig = new SkinSopParamsConfig();\n\nexport class SkinSopNode extends TypedSopNode<SkinSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'skin';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['lines to create polygons from', 'if used, lines from both inputs will be used'];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1, 2);\n\t}\n\n\tcook(input_contents: CoreGroup[]) {\n\t\tswitch (lodash_compact(this.io.inputs.inputs()).length) {\n\t\t\tcase 1:\n\t\t\t\treturn this.process_one_input(input_contents);\n\t\t\tcase 2:\n\t\t\t\treturn this.process_two_inputs(input_contents);\n\t\t\tdefault:\n\t\t\t\treturn this.states.error.set('inputs count not valid');\n\t\t}\n\t}\n\n\tprocess_one_input(input_contents: CoreGroup[]) {\n\t\tconst core_group0 = input_contents[0];\n\t\tconst line_segments0 = this._get_line_segments(core_group0);\n\n\t\tconst geometries: BufferGeometry[] = [];\n\t\tif (line_segments0) {\n\t\t\tconst first_line_segment = line_segments0[0] as Mesh;\n\t\t\tif (first_line_segment) {\n\t\t\t\tconst src_geometries = CoreGeometryUtilCurve.line_segment_to_geometries(\n\t\t\t\t\tfirst_line_segment.geometry as BufferGeometry\n\t\t\t\t);\n\t\t\t\tsrc_geometries.forEach((src_geometry, i) => {\n\t\t\t\t\tif (i > 0) {\n\t\t\t\t\t\tconst prev_src_geometry = src_geometries[i - 1];\n\n\t\t\t\t\t\tconst geometry = this._skin(prev_src_geometry, src_geometry);\n\t\t\t\t\t\tgeometries.push(geometry);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.set_geometries(geometries);\n\t}\n\n\tprocess_two_inputs(input_contents: CoreGroup[]) {\n\t\tconst core_group0 = input_contents[0];\n\t\tconst core_group1 = input_contents[1];\n\t\tconst line_segments0 = this._get_line_segments(core_group0);\n\t\tconst line_segments1 = this._get_line_segments(core_group1);\n\t\tconst line_segments = lodash_reverse(lodash_sortBy([line_segments0, line_segments1], (array) => array.length));\n\t\tconst smallest_array = line_segments[0];\n\t\tconst largest_array = line_segments[1];\n\n\t\tconst geometries: BufferGeometry[] = [];\n\t\tsmallest_array.forEach((line_segment, i) => {\n\t\t\tconst other_line_segment = largest_array[i];\n\n\t\t\tif (line_segment != null && other_line_segment != null) {\n\t\t\t\tconst geo = (line_segment as Mesh).geometry as BufferGeometry;\n\t\t\t\tconst other_geo = (other_line_segment as Mesh).geometry as BufferGeometry;\n\t\t\t\tconst geometry = this._skin(geo, other_geo);\n\t\t\t\tgeometries.push(geometry);\n\t\t\t}\n\t\t});\n\n\t\tthis.set_geometries(geometries);\n\t}\n\n\t_get_line_segments(core_group: CoreGroup) {\n\t\treturn core_group.objects().filter((child) => (child as LineSegments).isLineSegments);\n\t}\n\n\t_skin(geometry1: BufferGeometry, geometry0: BufferGeometry) {\n\t\t// TODO: maybe instead of doing this,\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst operation = new CoreGeometryOperationSkin(geometry, geometry1, geometry0);\n\t\toperation.process();\n\n\t\treturn geometry;\n\t}\n}\n","import {SphereBufferGeometry} from 'three/src/geometries/SphereGeometry';\nimport {IcosahedronBufferGeometry} from 'three/src/geometries/IcosahedronGeometry';\nimport {TypedSopNode} from './_Base';\n\nenum SphereType {\n\tDEFAULT = 'default',\n\tISOCAHEDRON = 'isocahedron',\n}\ntype SphereTypes = {[key in SphereType]: number};\nconst SPHERE_TYPE: SphereTypes = {\n\tdefault: 0,\n\tisocahedron: 1,\n};\nconst SPHERE_TYPES: Array<SphereType> = [SphereType.DEFAULT, SphereType.ISOCAHEDRON];\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass SphereSopParamsConfig extends NodeParamsConfig {\n\ttype = ParamConfig.INTEGER(SPHERE_TYPE.default, {\n\t\tmenu: {\n\t\t\tentries: SPHERE_TYPES.map((name) => {\n\t\t\t\treturn {name: name, value: SPHERE_TYPE[name]};\n\t\t\t}),\n\t\t},\n\t});\n\tradius = ParamConfig.FLOAT(1, {visible_if: {type: SPHERE_TYPE.default}});\n\tresolution = ParamConfig.VECTOR2([8, 6], {visible_if: {type: SPHERE_TYPE.default}});\n\topen = ParamConfig.BOOLEAN(0, {visible_if: {type: SPHERE_TYPE.default}});\n\tangle_range_x = ParamConfig.VECTOR2([0, '$PI*2'], {visible_if: {type: SPHERE_TYPE.default, open: true}});\n\tangle_range_y = ParamConfig.VECTOR2([0, '$PI*2'], {visible_if: {type: SPHERE_TYPE.default, open: true}});\n\tdetail = ParamConfig.INTEGER(1, {\n\t\trange: [0, 5],\n\t\trange_locked: [true, false],\n\t\tvisible_if: {type: SPHERE_TYPE.isocahedron},\n\t});\n\tcenter = ParamConfig.VECTOR3([0, 0, 0]);\n}\nconst ParamsConfig = new SphereSopParamsConfig();\n\nexport class SphereSopNode extends TypedSopNode<SphereSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'sphere';\n\t}\n\n\tcook() {\n\t\tlet geometry;\n\t\tif (this.pv.type == SPHERE_TYPE.default) {\n\t\t\tgeometry = this._create_default_sphere();\n\t\t} else {\n\t\t\tgeometry = this._create_default_isocahedron();\n\t\t}\n\t\tgeometry.translate(this.pv.center.x, this.pv.center.y, this.pv.center.z);\n\t\tthis.set_geometry(geometry);\n\t}\n\t_create_default_sphere() {\n\t\tif (this.pv.open) {\n\t\t\treturn new SphereBufferGeometry(\n\t\t\t\tthis.pv.radius,\n\t\t\t\tthis.pv.resolution.x,\n\t\t\t\tthis.pv.resolution.y,\n\t\t\t\tthis.pv.angle_range_x.x,\n\t\t\t\tthis.pv.angle_range_x.y,\n\t\t\t\tthis.pv.angle_range_y.x,\n\t\t\t\tthis.pv.angle_range_y.y\n\t\t\t);\n\t\t} else {\n\t\t\treturn new SphereBufferGeometry(this.pv.radius, this.pv.resolution.x, this.pv.resolution.y);\n\t\t}\n\t}\n\t_create_default_isocahedron() {\n\t\treturn new IcosahedronBufferGeometry(this.pv.radius, this.pv.detail);\n\t}\n}\n","import {TypedSopNode} from './_Base';\n\nconst INPUT_NAME = 'geometry to switch to';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nclass SwitchSopParamsConfig extends NodeParamsConfig {\n\tinput = ParamConfig.INTEGER(0, {\n\t\trange: [0, 3],\n\t\trange_locked: [true, true],\n\t});\n}\nconst ParamsConfig = new SwitchSopParamsConfig();\n\nexport class SwitchSopNode extends TypedSopNode<SwitchSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'switch';\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn [INPUT_NAME, INPUT_NAME, INPUT_NAME, INPUT_NAME];\n\t}\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(0, 4);\n\t\tthis.io.inputs.init_inputs_clonable_state([\n\t\t\tInputCloneMode.NEVER,\n\t\t\tInputCloneMode.NEVER,\n\t\t\tInputCloneMode.NEVER,\n\t\t\tInputCloneMode.NEVER,\n\t\t]);\n\t\tthis.ui_data.set_width(100);\n\t\t// this.ui_data.set_icon('code-branch');\n\n\t\tthis.cook_controller.disallow_inputs_evaluation();\n\t}\n\n\tasync cook() {\n\t\tconst input_index = this.pv.input;\n\t\tif (this.io.inputs.has_input(input_index)) {\n\t\t\tconst container = await this.container_controller.request_input_container(input_index);\n\t\t\tthis.set_core_group(container.core_content());\n\t\t} else {\n\t\t\tthis.states.error.set(`no input ${input_index}`);\n\t\t}\n\t}\n}\n","import lodash_range from 'lodash/range';\n\n// import {CoreFont} from 'src/Core/Font'\nimport {TypedSopNode} from './_Base';\nimport {CoreConstant} from 'src/core/geometry/Constant';\n\nimport {TextBufferGeometry} from 'three/src/geometries/TextGeometry';\nimport {BufferGeometry} from 'three/src/core/BufferGeometry';\nimport {ShapeBufferGeometry} from 'three/src/geometries/ShapeGeometry';\nimport {FontLoader} from 'three/src/loaders/FontLoader';\nimport {Font} from 'three/src/extras/core/Font';\nimport {Float32BufferAttribute} from 'three/src/core/BufferAttribute';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {Path} from 'three/src/extras/core/Path';\nimport {Shape} from 'three/src/extras/core/Shape';\n\nimport {BufferGeometryUtils} from 'modules/three/examples/jsm/utils/BufferGeometryUtils';\n\nvar opentype = require('opentype.js');\n\nimport {TTFLoader} from 'modules/three/examples/jsm/loaders/TTFLoader';\nimport {SVGLoader} from 'modules/three/examples/jsm/loaders/SVGLoader';\n\nconst DEFAULT_URL = '/fonts/droid_sans_regular.typeface.json';\n\ndeclare global {\n\tinterface Window {\n\t\topentype: any;\n\t}\n}\n\n// const DEFAULT_PARAMS = {\n// \tsize: 1,\n// \theight: 0.1,\n// \tcurveSegments: 1\n// };\n\nexport enum TEXT_TYPE {\n\tMESH = 'mesh',\n\tFLAT = 'flat',\n\tLINE = 'line',\n\tSTROKE = 'stroke',\n}\nexport const TEXT_TYPES: Array<TEXT_TYPE> = [TEXT_TYPE.MESH, TEXT_TYPE.FLAT, TEXT_TYPE.LINE, TEXT_TYPE.STROKE];\n\ninterface FontByUrl {\n\t[propName: string]: Font;\n}\n\nconst GENERATION_ERROR_MESSAGE = `failed to generate geometry. Try to remove some characters`;\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass TextSopParamsConfig extends NodeParamsConfig {\n\tfont = ParamConfig.STRING('');\n\ttext = ParamConfig.STRING('polygonjs', {multiline: true});\n\ttype = ParamConfig.INTEGER(0, {\n\t\tmenu: {\n\t\t\tentries: TEXT_TYPES.map((type, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: type,\n\t\t\t\t\tvalue: i,\n\t\t\t\t};\n\t\t\t}),\n\t\t},\n\t});\n\tsize = ParamConfig.FLOAT(1, {\n\t\trange: [0, 1],\n\t\trange_locked: [true, false],\n\t});\n\textrude = ParamConfig.FLOAT(0.1, {\n\t\tvisible_if: {\n\t\t\ttype: TEXT_TYPES.indexOf(TEXT_TYPE.MESH),\n\t\t},\n\t});\n\tsegments = ParamConfig.INTEGER(1, {\n\t\trange: [1, 20],\n\t\trange_locked: [true, false],\n\t\tvisible_if: {\n\t\t\ttype: TEXT_TYPES.indexOf(TEXT_TYPE.MESH),\n\t\t},\n\t});\n\tstroke_width = ParamConfig.FLOAT(0.02, {\n\t\tvisible_if: {\n\t\t\ttype: TEXT_TYPES.indexOf(TEXT_TYPE.STROKE),\n\t\t},\n\t});\n}\n\nconst ParamsConfig = new TextSopParamsConfig();\n\nexport class TextSopNode extends TypedSopNode<TextSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'text';\n\t}\n\t// static required_three_imports() {\n\t// \treturn ['loaders/TTFLoader', 'loaders/SVGLoader'];\n\t// }\n\n\tprivate _font_loader: FontLoader = new FontLoader();\n\tprivate _ttf_loader: TTFLoader | undefined;\n\tprivate _svg_loader: typeof SVGLoader | undefined;\n\tprivate _loaded_fonts: FontByUrl = {};\n\n\tinitialize_node() {}\n\n\tasync cook() {\n\t\ttry {\n\t\t\tthis._loaded_fonts[this.pv.font] = this._loaded_fonts[this.pv.font] || (await this._load_url(this.pv.font));\n\t\t} catch (err) {\n\t\t\tthis.states.error.set(`count not load font (${this.pv.font})`);\n\t\t\treturn;\n\t\t}\n\t\tconst font = this._loaded_fonts[this.pv.font];\n\t\tif (font) {\n\t\t\tswitch (TEXT_TYPES[this.pv.type]) {\n\t\t\t\tcase TEXT_TYPE.MESH:\n\t\t\t\t\treturn this._create_geometry_from_type_mesh(font);\n\t\t\t\tcase TEXT_TYPE.FLAT:\n\t\t\t\t\treturn this._create_geometry_from_type_flat(font);\n\t\t\t\tcase TEXT_TYPE.LINE:\n\t\t\t\t\treturn this._create_geometry_from_type_line(font);\n\t\t\t\tcase TEXT_TYPE.STROKE:\n\t\t\t\t\treturn this._create_geometry_from_type_stroke(font);\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn('type is not valid');\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _create_geometry_from_type_mesh(font: Font) {\n\t\tconst text = this.displayed_text();\n\n\t\tconst parameters = {\n\t\t\tfont: font,\n\t\t\tsize: this.pv.size,\n\t\t\theight: this.pv.extrude,\n\t\t\tcurveSegments: this.pv.segments,\n\t\t};\n\n\t\ttry {\n\t\t\tconst geometry = new TextBufferGeometry(text, parameters);\n\t\t\tif (!geometry.index) {\n\t\t\t\tconst position_array = geometry.getAttribute('position').array;\n\t\t\t\tgeometry.setIndex(lodash_range(position_array.length / 3));\n\t\t\t}\n\t\t\tthis.set_geometry(geometry);\n\t\t} catch (err) {\n\t\t\tthis.states.error.set(GENERATION_ERROR_MESSAGE);\n\t\t}\n\t}\n\n\tprivate _create_geometry_from_type_flat(font: Font) {\n\t\tconst shapes = this._get_shapes(font);\n\t\tif (shapes) {\n\t\t\tvar geometry = new ShapeBufferGeometry(shapes);\n\t\t\tthis.set_geometry(geometry);\n\t\t}\n\t}\n\tprivate _create_geometry_from_type_line(font: Font) {\n\t\tconst shapes = this.shapes_from_font(font);\n\t\tif (shapes) {\n\t\t\tconst positions = [];\n\t\t\tconst indices = [];\n\t\t\tlet current_index = 0;\n\n\t\t\tfor (let i = 0; i < shapes.length; i++) {\n\t\t\t\tconst shape = shapes[i];\n\t\t\t\tconst points = shape.getPoints();\n\t\t\t\tfor (let j = 0; j < points.length; j++) {\n\t\t\t\t\tconst point = points[j];\n\t\t\t\t\tpositions.push(point.x);\n\t\t\t\t\tpositions.push(point.y);\n\t\t\t\t\tpositions.push(0);\n\t\t\t\t\tindices.push(current_index);\n\t\t\t\t\tif (j > 0 && j < points.length - 1) {\n\t\t\t\t\t\tindices.push(current_index);\n\t\t\t\t\t}\n\t\t\t\t\tcurrent_index += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst geometry = new BufferGeometry();\n\t\t\tgeometry.setAttribute('position', new Float32BufferAttribute(positions, 3));\n\t\t\tgeometry.setIndex(indices);\n\t\t\tthis.set_geometry(geometry, CoreConstant.OBJECT_TYPE.LINE_SEGMENTS);\n\t\t}\n\t}\n\tprivate async _create_geometry_from_type_stroke(font: Font) {\n\t\tconst shapes = this.shapes_from_font(font);\n\t\tif (shapes) {\n\t\t\t// const color = new Color( 0xffffff );\n\t\t\tthis._svg_loader = this._svg_loader || (await this._load_svg_loader());\n\t\t\t// TODO: typescript: correct definition for last 3 optional args\n\t\t\tvar style = this._svg_loader.getStrokeStyle(this.pv.stroke_width, 'white', 'miter', 'butt', 4);\n\t\t\tconst geometries = [];\n\n\t\t\t// const positions = [];\n\t\t\t// const indices = [];\n\t\t\t// let current_index = 0;\n\n\t\t\tfor (let i = 0; i < shapes.length; i++) {\n\t\t\t\tconst shape = shapes[i];\n\t\t\t\tconst points = shape.getPoints();\n\t\t\t\t// TODO: typescript: correct definition for points, arcDivisions, and minDistance\n\t\t\t\tconst arcDivisions = 12;\n\t\t\t\tconst minDistance = 0.001;\n\t\t\t\tconst geometry = this._svg_loader.pointsToStroke(\n\t\t\t\t\t(<unknown>points) as Vector3[],\n\t\t\t\t\tstyle,\n\t\t\t\t\tarcDivisions,\n\t\t\t\t\tminDistance\n\t\t\t\t);\n\t\t\t\tgeometries.push(geometry);\n\t\t\t}\n\t\t\tconst merged_geometry = BufferGeometryUtils.mergeBufferGeometries(geometries);\n\t\t\tthis.set_geometry(merged_geometry); //, CoreConstant.OBJECT_TYPE.LINE_SEGMENTS);\n\t\t}\n\t}\n\n\tprivate shapes_from_font(font: Font) {\n\t\tconst shapes = this._get_shapes(font);\n\t\tif (shapes) {\n\t\t\tconst holeShapes: Path[] = [];\n\t\t\tfor (let i = 0; i < shapes.length; i++) {\n\t\t\t\tconst shape = shapes[i];\n\t\t\t\tif (shape.holes && shape.holes.length > 0) {\n\t\t\t\t\tfor (let j = 0; j < shape.holes.length; j++) {\n\t\t\t\t\t\tconst hole = shape.holes[j];\n\t\t\t\t\t\tholeShapes.push(hole);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tshapes.push.apply(shapes, holeShapes as Shape[]);\n\t\t\treturn shapes;\n\t\t}\n\t}\n\n\tprivate _get_shapes(font: Font) {\n\t\tconst text = this.displayed_text();\n\t\ttry {\n\t\t\tconst shapes = font.generateShapes(text, this.pv.size);\n\t\t\treturn shapes;\n\t\t} catch (err) {\n\t\t\tthis.states.error.set(GENERATION_ERROR_MESSAGE);\n\t\t}\n\t}\n\n\tprivate displayed_text(): string {\n\t\treturn this.pv.text || '';\n\t}\n\n\t// _create_shape(font){\n\t// \tconst shapes = font.generateShapes( this.displayed_text(), 100 );\n\t// \tvar geometry = new ShapeBufferGeometry( shapes );\n\t// \treturn geometry\n\t// \t// geometry.computeBoundingBox();\n\t// \t// xMid = - 0.5 * ( geometry.boundingBox.max.x - geometry.boundingBox.min.x );\n\t// \t// geometry.translate( xMid, 0, 0 );\n\t// \t// make shape ( N.B. edge view not visible )\n\t// \t// text = new Mesh( geometry, matLite );\n\t// \t// text.position.z = - 150;\n\t// }\n\n\tprivate _load_url(url: string) {\n\t\tif (url === '') {\n\t\t\turl = DEFAULT_URL;\n\t\t}\n\t\tconst elements1 = url.split('?')[0];\n\t\tconst elements2 = elements1.split('.');\n\t\tconst ext = elements2[elements2.length - 1];\n\t\turl = `${url}?${Date.now()}`;\n\t\tswitch (ext) {\n\t\t\tcase 'ttf': {\n\t\t\t\treturn this._load_ttf(url);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'json': {\n\t\t\t\treturn this._load_json(url);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _load_ttf(url: string): Promise<Font> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tthis._ttf_loader = this._ttf_loader || (await this._load_ttf_loader());\n\t\t\twindow.opentype = opentype;\n\t\t\tthis._ttf_loader.load(\n\t\t\t\turl,\n\t\t\t\t(fnt: object) => {\n\t\t\t\t\tconst parsed = this._font_loader.parse(fnt);\n\t\t\t\t\t// make sure not to delete opentype from window, as it may be required by other nodes\n\t\t\t\t\t// delete window.opentype;\n\t\t\t\t\tresolve(parsed);\n\t\t\t\t},\n\t\t\t\tundefined,\n\t\t\t\t() => {\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\tprivate _load_json(url: string): Promise<Font> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis._font_loader.load(\n\t\t\t\turl,\n\t\t\t\t(font) => {\n\t\t\t\t\tresolve(font);\n\t\t\t\t},\n\t\t\t\tundefined,\n\t\t\t\t() => {\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\t// private _default_font_parameters(options){\n\t// \tif (options == null) { options = {}; }\n\t// \tconst default_options = lodash_clone(DEFAULT_PARAMS);\n\t// \tif (options['font'] == null) { options['font'] = this.font(); }\n\n\t// \tfor(let key of Object.keys(options)){\n\t// \t\tdefault_options[key] = options[key];\n\t// \t}\n\n\t// \treturn default_options;\n\t// }\n\tprivate async _load_ttf_loader(): Promise<TTFLoader> {\n\t\tconst {TTFLoader} = await import(`modules/three/examples/jsm/loaders/TTFLoader`);\n\t\tconst loader_constructor = (<unknown>TTFLoader) as typeof TTFLoader;\n\t\treturn new loader_constructor();\n\t}\n\tprivate async _load_svg_loader(): Promise<typeof SVGLoader> {\n\t\tconst {SVGLoader} = await import(`modules/three/examples/jsm/loaders/SVGLoader`);\n\t\treturn (<unknown>SVGLoader) as typeof SVGLoader;\n\t}\n}\n","import {FileLoader} from 'three/src/loaders/FileLoader';\nimport {Loader} from 'three/src/loaders/Loader';\n/**\n * @author gero3 / https://github.com/gero3\n * @author tentone / https://github.com/tentone\n * @author troy351 / https://github.com/troy351\n *\n * Requires opentype.js to be included in the project.\n * Loads TTF files and converts them into typeface JSON that can be used directly\n * to create THREE.Font objects.\n */\n\n\nvar TTFLoader = function ( manager ) {\n\n\tLoader.call( this, manager );\n\n\tthis.reversed = false;\n\n};\n\n\nTTFLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: TTFLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\tonLoad( scope.parse( buffer ) );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\tparse: function ( arraybuffer ) {\n\n\t\tfunction convert( font, reversed ) {\n\n\t\t\tvar round = Math.round;\n\n\t\t\tvar glyphs = {};\n\t\t\tvar scale = ( 100000 ) / ( ( font.unitsPerEm || 2048 ) * 72 );\n\n\t\t\tvar glyphIndexMap = font.encoding.cmap.glyphIndexMap;\n\t\t\tvar unicodes = Object.keys( glyphIndexMap );\n\n\t\t\tfor ( var i = 0; i < unicodes.length; i ++ ) {\n\n\t\t\t\tvar unicode = unicodes[ i ];\n\t\t\t\tvar glyph = font.glyphs.glyphs[ glyphIndexMap[ unicode ] ];\n\n\t\t\t\tif ( unicode !== undefined ) {\n\n\t\t\t\t\tvar token = {\n\t\t\t\t\t\tha: round( glyph.advanceWidth * scale ),\n\t\t\t\t\t\tx_min: round( glyph.xMin * scale ),\n\t\t\t\t\t\tx_max: round( glyph.xMax * scale ),\n\t\t\t\t\t\to: ''\n\t\t\t\t\t};\n\n\t\t\t\t\tif ( reversed ) {\n\n\t\t\t\t\t\tglyph.path.commands = reverseCommands( glyph.path.commands );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tglyph.path.commands.forEach( function ( command ) {\n\n\t\t\t\t\t\tif ( command.type.toLowerCase() === 'c' ) {\n\n\t\t\t\t\t\t\tcommand.type = 'b';\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttoken.o += command.type.toLowerCase() + ' ';\n\n\t\t\t\t\t\tif ( command.x !== undefined && command.y !== undefined ) {\n\n\t\t\t\t\t\t\ttoken.o += round( command.x * scale ) + ' ' + round( command.y * scale ) + ' ';\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( command.x1 !== undefined && command.y1 !== undefined ) {\n\n\t\t\t\t\t\t\ttoken.o += round( command.x1 * scale ) + ' ' + round( command.y1 * scale ) + ' ';\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( command.x2 !== undefined && command.y2 !== undefined ) {\n\n\t\t\t\t\t\t\ttoken.o += round( command.x2 * scale ) + ' ' + round( command.y2 * scale ) + ' ';\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tglyphs[ String.fromCodePoint( glyph.unicode ) ] = token;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tglyphs: glyphs,\n\t\t\t\tfamilyName: font.getEnglishName( 'fullName' ),\n\t\t\t\tascender: round( font.ascender * scale ),\n\t\t\t\tdescender: round( font.descender * scale ),\n\t\t\t\tunderlinePosition: font.tables.post.underlinePosition,\n\t\t\t\tunderlineThickness: font.tables.post.underlineThickness,\n\t\t\t\tboundingBox: {\n\t\t\t\t\txMin: font.tables.head.xMin,\n\t\t\t\t\txMax: font.tables.head.xMax,\n\t\t\t\t\tyMin: font.tables.head.yMin,\n\t\t\t\t\tyMax: font.tables.head.yMax\n\t\t\t\t},\n\t\t\t\tresolution: 1000,\n\t\t\t\toriginal_font_information: font.tables.name\n\t\t\t};\n\n\t\t}\n\n\t\tfunction reverseCommands( commands ) {\n\n\t\t\tvar paths = [];\n\t\t\tvar path;\n\n\t\t\tcommands.forEach( function ( c ) {\n\n\t\t\t\tif ( c.type.toLowerCase() === 'm' ) {\n\n\t\t\t\t\tpath = [ c ];\n\t\t\t\t\tpaths.push( path );\n\n\t\t\t\t} else if ( c.type.toLowerCase() !== 'z' ) {\n\n\t\t\t\t\tpath.push( c );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tvar reversed = [];\n\n\t\t\tpaths.forEach( function ( p ) {\n\n\t\t\t\tvar result = {\n\t\t\t\t\ttype: 'm',\n\t\t\t\t\tx: p[ p.length - 1 ].x,\n\t\t\t\t\ty: p[ p.length - 1 ].y\n\t\t\t\t};\n\n\t\t\t\treversed.push( result );\n\n\t\t\t\tfor ( var i = p.length - 1; i > 0; i -- ) {\n\n\t\t\t\t\tvar command = p[ i ];\n\t\t\t\t\tvar result = { type: command.type };\n\n\t\t\t\t\tif ( command.x2 !== undefined && command.y2 !== undefined ) {\n\n\t\t\t\t\t\tresult.x1 = command.x2;\n\t\t\t\t\t\tresult.y1 = command.y2;\n\t\t\t\t\t\tresult.x2 = command.x1;\n\t\t\t\t\t\tresult.y2 = command.y1;\n\n\t\t\t\t\t} else if ( command.x1 !== undefined && command.y1 !== undefined ) {\n\n\t\t\t\t\t\tresult.x1 = command.x1;\n\t\t\t\t\t\tresult.y1 = command.y1;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresult.x = p[ i - 1 ].x;\n\t\t\t\t\tresult.y = p[ i - 1 ].y;\n\t\t\t\t\treversed.push( result );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\treturn reversed;\n\n\t\t}\n\n\t\tif ( typeof opentype === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.TTFLoader: The loader requires opentype.js. Make sure it\\'s included before using the loader.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn convert( opentype.parse( arraybuffer ), this.reversed );\n\n\t}\n\n} );\n\nexport { TTFLoader };\n","import {TorusBufferGeometry} from 'three/src/geometries/TorusGeometry';\nimport {TypedSopNode} from './_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass TorusSopParamsConfig extends NodeParamsConfig {\n\tradius = ParamConfig.FLOAT(1, {range: [0, 1]});\n\tradius_tube = ParamConfig.FLOAT(1, {range: [0, 1]});\n\tsegments_radial = ParamConfig.INTEGER(20, {\n\t\trange: [1, 50],\n\t\trange_locked: [true, false],\n\t});\n\tsegments_tube = ParamConfig.INTEGER(12, {\n\t\trange: [1, 50],\n\t\trange_locked: [true, false],\n\t});\n}\nconst ParamsConfig = new TorusSopParamsConfig();\n\nexport class TorusSopNode extends TypedSopNode<TorusSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'torus';\n\t}\n\tinitialize_node() {}\n\n\tcook() {\n\t\tconst radius = this.pv.radius;\n\t\tconst radius_tube = this.pv.radius_tube;\n\t\tconst segments_radial = this.pv.segments_radial;\n\t\tconst segments_tube = this.pv.segments_tube;\n\t\t//radius : Float, tube : Float, radialSegments : Integer, tubularSegments : Integer, arc : Float\n\n\t\tconst geometry = new TorusBufferGeometry(radius, radius_tube, segments_radial, segments_tube);\n\t\tthis.set_geometry(geometry);\n\t}\n}\n","import {TorusKnotBufferGeometry} from 'three/src/geometries/TorusKnotGeometry';\nconst THREE = {TorusKnotBufferGeometry};\nimport {TypedSopNode} from './_Base';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass TorusKnotSopParamsConfig extends NodeParamsConfig {\n\tradius = ParamConfig.FLOAT(1);\n\tradius_tube = ParamConfig.FLOAT(1);\n\tsegments_radial = ParamConfig.INTEGER(64, {range: [1, 128]});\n\tsegments_tube = ParamConfig.INTEGER(8, {range: [1, 32]});\n\tp = ParamConfig.INTEGER(2, {range: [1, 10]});\n\tq = ParamConfig.INTEGER(3, {range: [1, 10]});\n}\nconst ParamsConfig = new TorusKnotSopParamsConfig();\n\nexport class TorusKnotSopNode extends TypedSopNode<TorusKnotSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'torus_knot';\n\t}\n\tinitialize_node() {}\n\n\tcook() {\n\t\tconst radius = this.pv.radius;\n\t\tconst radius_tube = this.pv.radius_tube;\n\t\tconst segments_radial = this.pv.segments_radial;\n\t\tconst segments_tube = this.pv.segments_tube;\n\t\tconst p = this.pv.p;\n\t\tconst q = this.pv.q;\n\n\t\tconst geometry = new THREE.TorusKnotBufferGeometry(radius, radius_tube, segments_radial, segments_tube, p, q);\n\t\tthis.set_geometry(geometry);\n\t}\n}\n","import {TypedSopNode} from './_Base';\n// import {GroupParamController} from './utils/GroupParamController';\n\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CoreTransform} from 'src/core/Transform';\n// import {ParamType} from 'src/engine/poly/ParamType';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\n\n// const DEFAULT_PARAMS = {\n// \tPIVOT: [0, 0, 0] as [number, number, number],\n// };\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass TransformSopParamConfig extends NodeParamsConfig {\n\tgroup = ParamConfig.STRING('');\n\n\t// transform\n\tt = ParamConfig.VECTOR3([0, 0, 0]);\n\tr = ParamConfig.VECTOR3([0, 0, 0]);\n\ts = ParamConfig.VECTOR3([1, 1, 1]);\n\tscale = ParamConfig.FLOAT(1);\n\tlook_at = ParamConfig.OPERATOR_PATH('');\n\tup = ParamConfig.VECTOR3([0, 1, 0]);\n\tpivot = ParamConfig.VECTOR3([0, 0, 0]);\n}\nconst ParamsConfig = new TransformSopParamConfig();\n\nexport class TransformSopNode extends TypedSopNode<TransformSopParamConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'transform';\n\t}\n\t// allow_eval_key_check() {\n\t// \treturn true;\n\t// }\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['geometry to transform'];\n\t}\n\n\t// constructor(scene: PolyScene) {\n\t// \tsuper(scene);\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tprivate _core_transform = new CoreTransform();\n\tcook(input_contents: CoreGroup[]) {\n\t\tconst objects = input_contents[0].objects();\n\t\tconst matrix = this._core_transform.matrix(this.pv.t, this.pv.r, this.pv.s, this.pv.scale);\n\n\t\tif (this.pv.group === '') {\n\t\t\tfor (let object of objects) {\n\t\t\t\tlet geometry;\n\t\t\t\tif ((geometry = object.geometry) != null) {\n\t\t\t\t\tgeometry.translate(-this.pv.pivot.x, -this.pv.pivot.y, -this.pv.pivot.z);\n\t\t\t\t\tgeometry.applyMatrix(matrix);\n\t\t\t\t\tgeometry.translate(this.pv.pivot.x, this.pv.pivot.y, this.pv.pivot.z);\n\t\t\t\t} else {\n\t\t\t\t\tobject.applyMatrix(matrix);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst core_group = CoreGroup.from_objects(objects);\n\t\t\tconst points = core_group.points_from_group(this.pv.group);\n\t\t\tfor (let point of points) {\n\t\t\t\tconst position = point.position().sub(this.pv.pivot);\n\t\t\t\tposition.applyMatrix4(matrix);\n\t\t\t\tpoint.set_position(position.add(this.pv.pivot));\n\t\t\t}\n\t\t}\n\n\t\tthis.set_objects(objects);\n\t}\n}\n","import {TypedSopNode} from './_Base';\n\nimport {Vector3} from 'three/src/math/Vector3';\nimport {CylinderBufferGeometry} from 'three/src/geometries/CylinderGeometry';\nimport {CoreTransform} from 'src/core/Transform';\n\nconst DEFAULT_UP = new Vector3(0, 1, 0);\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nclass TubeSopParamsConfig extends NodeParamsConfig {\n\tradius = ParamConfig.FLOAT(1, {range: [0, 1]});\n\theight = ParamConfig.FLOAT(1, {range: [0, 1]});\n\tsegments_radial = ParamConfig.INTEGER(12, {range: [3, 20], range_locked: [true, false]});\n\tsegments_height = ParamConfig.INTEGER(1, {range: [1, 20], range_locked: [true, false]});\n\tcap = ParamConfig.BOOLEAN(1);\n\tcenter = ParamConfig.VECTOR3([0, 0, 0]);\n\tdirection = ParamConfig.VECTOR3([0, 0, 1]);\n}\nconst ParamsConfig = new TubeSopParamsConfig();\n\nexport class TubeSopNode extends TypedSopNode<TubeSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'tube';\n\t}\n\n\tprivate _core_transform = new CoreTransform();\n\n\tcook() {\n\t\tconst geometry = new CylinderBufferGeometry(\n\t\t\tthis.pv.radius,\n\t\t\tthis.pv.radius,\n\t\t\tthis.pv.height,\n\t\t\tthis.pv.segments_radial,\n\t\t\tthis.pv.segments_height,\n\t\t\t!this.pv.cap\n\t\t);\n\n\t\tthis._core_transform.rotate_geometry(geometry, DEFAULT_UP, this.pv.direction);\n\t\tgeometry.translate(this.pv.center.x, this.pv.center.y, this.pv.center.z);\n\n\t\tthis.set_geometry(geometry);\n\t}\n}\n","import {Camera} from 'three/src/cameras/Camera';\nimport {Object3D} from 'three/src/core/Object3D';\nimport {Matrix4} from 'three/src/math/Matrix4';\nimport {Vector3} from 'three/src/math/Vector3';\nimport {TypedSopNode} from './_Base';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CameraController} from 'src/core/CameraController';\nimport {BaseCameraObjNodeType} from 'src/engine/nodes/obj/_BaseCamera';\n\n// const MODE = [];\nconst UV_NAME = 'uv';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {BaseObjNodeType} from '../obj/_Base';\nclass UvProjectSopParamsConfig extends NodeParamsConfig {\n\tcamera = ParamConfig.OPERATOR_PATH('/perspective_camera1', {\n\t\tnode_selection: {\n\t\t\tcontext: NodeContext.OBJ,\n\t\t},\n\t});\n\t// force_aspect = ParamConfig.BOOLEAN(0)\n\t// aspect = ParamConfig.FLOAT(1, {\n\t// \trange: [0, 2],\n\t// \tvisible_if: {force_aspect: 1},\n\t// })\n}\nconst ParamsConfig = new UvProjectSopParamsConfig();\n\nexport class UvProjectSopNode extends TypedSopNode<UvProjectSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'uv_project';\n\t}\n\n\tprivate _camera_controller: CameraController = new CameraController(this._update_uvs_from_camera.bind(this));\n\t// private _param_camera: string\n\tprivate _processed_core_group: CoreGroup | undefined;\n\t// private _camera_node: BaseCameraObjNodeType | undefined;\n\tprivate _camera_object: Camera | undefined;\n\n\tinitialize_node() {\n\t\tthis.io.inputs.set_count(1);\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.FROM_NODE]);\n\t}\n\n\tcook(core_groups: CoreGroup[]) {\n\t\tthis._processed_core_group = core_groups[0];\n\n\t\tconst camera_node = this.p.camera.found_node();\n\t\tif (camera_node != null) {\n\t\t\tthis._camera_object = (camera_node as BaseCameraObjNodeType).object;\n\t\t\tthis._camera_controller.set_target(this._camera_object);\n\t\t\t// this._add_camera_event()\n\t\t} else {\n\t\t\tthis._camera_object = undefined;\n\t\t\t//this._remove_camera_event()\n\t\t\tthis._camera_controller.remove_target();\n\t\t}\n\n\t\tthis.set_core_group(this._processed_core_group);\n\t}\n\n\t_update_uvs_from_camera(look_at_target: Object3D) {\n\t\t// let old_aspect;\n\t\t// if (this.pv.force_aspect) {\n\t\t// \told_aspect = this._camera_object.aspect;\n\t\t// \tthis._camera_node.setup_for_aspect_ratio(this.pv.aspect);\n\t\t// }\n\n\t\tif (this._processed_core_group && this.parent) {\n\t\t\tconst points = this._processed_core_group.points();\n\t\t\tconst obj_world_matrix = (this.parent as BaseObjNodeType).object.matrixWorld;\n\t\t\tpoints.forEach((point) => {\n\t\t\t\tconst position = point.position();\n\t\t\t\tconst uvw = this._vector_in_camera_space(position, obj_world_matrix);\n\t\t\t\tif (uvw) {\n\t\t\t\t\tconst uv = {\n\t\t\t\t\t\tx: 1 - (uvw[0] * 0.5 + 0.5),\n\t\t\t\t\t\ty: uvw[1] * 0.5 + 0.5,\n\t\t\t\t\t};\n\t\t\t\t\tpoint.set_attrib_value(UV_NAME, uv);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// if (this.pv.force_aspect) {\n\t\t\t// \tthis._camera_node.setup_for_aspect_ratio(old_aspect);\n\t\t\t// }\n\t\t}\n\t}\n\n\tprivate _vector_in_camera_space(vector: Vector3, obj_world_matrix: Matrix4) {\n\t\tif (this._camera_object) {\n\t\t\tvector.applyMatrix4(obj_world_matrix);\n\t\t\treturn vector.project(this._camera_object).toArray();\n\t\t}\n\t}\n}\n","import {Object3D} from 'three/src/core/Object3D';\n\nenum EVENT {\n\tCHANGE = 'change',\n\tMOVEEND = 'moveend',\n}\n\ntype CameraControllerCallback = (target: Object3D) => void;\n\nexport class CameraController {\n\tprivate _update_always: boolean = true;\n\tprivate _listener: any;\n\tprivate _target: Object3D | undefined;\n\tprivate _listener_added: boolean = false;\n\n\tconstructor(private _callback: CameraControllerCallback) {\n\t\tthis._listener = this._execute_callback.bind(this);\n\t}\n\n\tremove_target() {\n\t\tthis.set_target(undefined);\n\t}\n\tset_target(target: Object3D | undefined) {\n\t\tif (!target) {\n\t\t\tthis._remove_camera_event();\n\t\t}\n\n\t\tconst old_target = this._target;\n\t\tthis._target = target;\n\n\t\tif (this._target != null) {\n\t\t\tthis._execute_callback();\n\t\t}\n\n\t\tif (\n\t\t\t(this._target != null ? this._target.uuid : undefined) !==\n\t\t\t(old_target != null ? old_target.uuid : undefined)\n\t\t) {\n\t\t\tthis._add_camera_event();\n\t\t}\n\t}\n\n\tset_update_always(new_update_always: boolean) {\n\t\tthis._remove_camera_event();\n\n\t\tthis._update_always = new_update_always;\n\n\t\tthis._add_camera_event();\n\t}\n\n\tprivate _current_event_name() {\n\t\tif (this._update_always) {\n\t\t\treturn EVENT.CHANGE;\n\t\t} else {\n\t\t\treturn EVENT.MOVEEND;\n\t\t}\n\t}\n\n\tprivate _add_camera_event() {\n\t\tif (this._listener_added) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._target != null) {\n\t\t\tthis._target.addEventListener(this._current_event_name(), this._listener);\n\t\t\tthis._listener_added = true;\n\t\t}\n\t}\n\n\tprivate _remove_camera_event() {\n\t\tif (this._listener_added !== true) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._target != null) {\n\t\t\tthis._target.removeEventListener(this._current_event_name(), this._listener);\n\t\t\tthis._listener_added = false;\n\t\t}\n\t}\n\n\tprivate _execute_callback() {\n\t\tif (this._target != null) {\n\t\t\tthis._callback(this._target);\n\t\t}\n\t}\n}\n","import {PolyScene} from 'src/engine/scene/PolyScene';\n// import {JsonImporterVisitor} from './Visitor'\nimport {SceneJsonExporterData} from '../export/Scene';\nimport {JsonImportDispatcher} from './Dispatcher';\n\nexport class SceneJsonImporter {\n\tconstructor(private _data: SceneJsonExporterData) {}\n\n\tstatic load_data(data: SceneJsonExporterData) {\n\t\tconst importer = new SceneJsonImporter(data);\n\t\treturn importer.scene();\n\t}\n\n\tasync scene(): Promise<PolyScene> {\n\t\tconst scene = new PolyScene();\n\t\tscene.loading_controller.mark_as_loading();\n\n\t\t// scene.set_js_version(this._data['__js_version'])\n\t\tconst properties = this._data['properties'];\n\t\tif (properties) {\n\t\t\t// scene.set_name(properties['name'])\n\t\t\tscene.set_frame(properties['frame'] || 1);\n\t\t\tconst frame_range = properties['frame_range'] || [];\n\t\t\tscene.time_controller.set_frame_range(frame_range[0] || 1, frame_range[1] || 100);\n\t\t\tconst frame_range_locked = properties['frame_range_locked'];\n\t\t\tif (frame_range_locked) {\n\t\t\t\tscene.time_controller.set_frame_range_locked(frame_range_locked[0], frame_range_locked[1]);\n\t\t\t}\n\t\t\tscene.time_controller.set_fps(properties['fps'] || 30);\n\t\t\tif (properties['master_camera_node_path']) {\n\t\t\t\tscene.cameras_controller.set_master_camera_node_path(properties['master_camera_node_path']);\n\t\t\t}\n\t\t}\n\n\t\t// we block to ensure that nodes will not run their dirty_hooks\n\t\t// which would trigger operator_path params to search for nodes that\n\t\t// may not exist yet\n\t\tscene.cooker.block();\n\n\t\tconst importer = JsonImportDispatcher.dispatch_node(scene.root);\n\t\tif (this._data['root']) {\n\t\t\timporter.process_data(this._data['root']);\n\t\t}\n\t\tif (this._data['ui']) {\n\t\t\timporter.process_ui_data(this._data['ui']);\n\t\t}\n\n\t\tawait scene.loading_controller.mark_as_loaded();\n\t\tscene.cooker.unblock();\n\t\t// DO NOT wait for cooks here,\n\t\t// as a viewer will only be created once everything has cooked\n\t\t// which would be a problem for env_map or other nodes relying on the renderer being created\n\t\t// await scene.wait_for_cooks_completed();\n\n\t\treturn scene;\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\nimport lodash_isString from 'lodash/isString';\nimport lodash_isBoolean from 'lodash/isBoolean';\nimport lodash_isObject from 'lodash/isObject';\nimport lodash_isNumber from 'lodash/isNumber';\nimport lodash_isArray from 'lodash/isArray';\n\nimport {NodeJsonExporterData, NodeJsonExporterUIData, InputData} from '../export/Node';\nimport {ParamJsonExporterData, SimpleParamJsonExporterData, ComplexParamJsonExporterData} from '../export/Param';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {JsonImportDispatcher} from './Dispatcher';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nexport class NodeJsonImporter<T extends BaseNodeType> {\n\tconstructor(protected _node: T) {}\n\n\tprocess_data(data: NodeJsonExporterData) {\n\t\tthis.create_nodes(data['nodes']);\n\t\tthis.set_selection(data['selection']);\n\n\t\t// inputs clone\n\t\tif (this._node.io.inputs.override_clonable_state_allowed()) {\n\t\t\tconst override = data['override_clonable_state'];\n\t\t\tif (override) {\n\t\t\t\tthis._node.io.inputs.set_override_clonable_state(override);\n\t\t\t}\n\t\t}\n\n\t\tthis.set_flags(data);\n\t\tthis.set_params(data['params']);\n\n\t\tthis.from_data_custom(data);\n\n\t\tthis._node.lifecycle.set_creation_completed();\n\t}\n\tprocess_inputs_data(data: NodeJsonExporterData) {\n\t\tthis.set_inputs(data['inputs']);\n\t}\n\n\tprocess_ui_data(data: NodeJsonExporterUIData) {\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\t\tconst ui_data = this._node.ui_data;\n\t\tconst pos = data['pos'];\n\t\tif (pos) {\n\t\t\tconst vector = new Vector2().fromArray(pos);\n\t\t\tui_data.set_position(vector);\n\t\t}\n\t\tconst comment = data['comment'];\n\t\tif (comment) {\n\t\t\tui_data.set_comment(comment);\n\t\t}\n\t\tthis.process_nodes_ui_data(data['nodes']);\n\t}\n\n\tcreate_nodes(data?: Dictionary<NodeJsonExporterData>) {\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst node_names = Object.keys(data);\n\t\tconst nodes: BaseNodeType[] = [];\n\t\tfor (let node_name of node_names) {\n\t\t\tconst node_data = data[node_name];\n\t\t\tconst node_type = node_data['type'];\n\t\t\tif (this._node.children_allowed() && this._node.children_controller) {\n\t\t\t\tconst node = this._node.create_node(node_type);\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.set_name(node_name);\n\t\t\t\t\tnodes.push(node);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst importers = [];\n\t\tlet index = 0;\n\t\tfor (let node of nodes) {\n\t\t\tconst importer = JsonImportDispatcher.dispatch_node(node); //.visit(JsonImporterVisitor)\n\t\t\timporters.push(importer);\n\t\t\timporter.process_data(data[node.name]);\n\t\t\tindex++;\n\t\t}\n\t\tindex = 0;\n\t\tfor (let node of nodes) {\n\t\t\tconst importer = importers[index];\n\t\t\timporter.process_inputs_data(data[node.name]);\n\t\t\tindex++;\n\t\t}\n\t}\n\tset_selection(data?: string[]) {\n\t\tif (this._node.children_allowed() && this._node.children_controller) {\n\t\t\tif (data && data.length > 0) {\n\t\t\t\tconst selected_nodes: BaseNodeType[] = [];\n\t\t\t\tdata.forEach((node_name) => {\n\t\t\t\t\tconst node = this._node.node(node_name);\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tselected_nodes.push(node);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._node.children_controller.selection.set(selected_nodes);\n\t\t\t}\n\t\t}\n\t}\n\n\tset_flags(data: NodeJsonExporterData) {\n\t\tconst flags = data['flags'];\n\t\tif (flags) {\n\t\t\tconst bypass = flags['bypass'];\n\t\t\tif (bypass != null) {\n\t\t\t\tthis._node.flags?.bypass?.set(bypass);\n\t\t\t}\n\t\t\tconst display = flags['display'];\n\t\t\tif (display != null) {\n\t\t\t\tthis._node.flags?.display?.set(display);\n\t\t\t}\n\t\t}\n\t}\n\n\tset_inputs(inputs_data?: InputData[]) {\n\t\tif (!inputs_data) {\n\t\t\treturn;\n\t\t}\n\n\t\tinputs_data.forEach((input_data, i) => {\n\t\t\tif (input_data && this._node.parent) {\n\t\t\t\tif (lodash_isString(input_data)) {\n\t\t\t\t\tconst input_node_name = input_data;\n\t\t\t\t\tconst input_node = this._node.parent.node(input_node_name);\n\t\t\t\t\tthis._node.set_input(i, input_node);\n\t\t\t\t} else {\n\t\t\t\t\tconst input_node = this._node.parent.node(input_data['node']);\n\t\t\t\t\tconst input_name = input_data['name'];\n\t\t\t\t\tif (this._node.io.inputs.has_named_input(input_name)) {\n\t\t\t\t\t\tthis._node.set_input(input_data['name'], input_node, input_data['output']);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(`${this._node.full_path()} has no input named ${input_name}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprocess_nodes_ui_data(data: Dictionary<NodeJsonExporterUIData>) {\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst node_names = Object.keys(data);\n\t\tnode_names.forEach((node_name) => {\n\t\t\tconst node = this._node.node(node_name);\n\t\t\tif (node) {\n\t\t\t\tconst node_data = data[node_name];\n\t\t\t\tJsonImportDispatcher.dispatch_node(node).process_ui_data(node_data);\n\t\t\t\t// node.visit(JsonImporterVisitor).process_ui_data(node_data);\n\t\t\t}\n\t\t});\n\t}\n\n\tset_params(data?: Dictionary<ParamJsonExporterData<ParamType>>) {\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\t\tconst param_names = Object.keys(data);\n\n\t\tfor (let param_name of param_names) {\n\t\t\tconst param_data = data[param_name];\n\t\t\tif (this._is_param_data_complex(param_data)) {\n\t\t\t\tthis._process_param_data_complex(param_name, param_data as ComplexParamJsonExporterData<ParamType>);\n\t\t\t} else {\n\t\t\t\tthis._process_param_data_simple(param_name, param_data as SimpleParamJsonExporterData<ParamType>);\n\t\t\t}\n\t\t}\n\t\t// those hooks are useful for some gl nodes,\n\t\t// such as the constant, which needs to update its connections\n\t\t// based on another parameter, which will be set just before\n\t\tthis._node.params.run_on_scene_load_hooks();\n\t}\n\n\tprivate _process_param_data_simple(param_name: string, param_data: SimpleParamJsonExporterData<ParamType>) {\n\t\tthis._node.params.get(param_name)?.set(param_data);\n\t}\n\n\tprivate _process_param_data_complex(param_name: string, param_data: ComplexParamJsonExporterData<ParamType>) {\n\t\tconst has_param = this._node.params.has_param(param_name);\n\t\tconst param_type = param_data['type']!;\n\n\t\tlet has_param_and_same_type = false;\n\t\tlet param;\n\t\tif (has_param) {\n\t\t\tparam = this._node.params.get(param_name);\n\t\t\t// we can safely consider same type if param_type is not mentioned\n\t\t\tif ((param && param.type == param_type) || param_type == null) {\n\t\t\t\thas_param_and_same_type = true;\n\t\t\t}\n\t\t}\n\t\tif (has_param_and_same_type) {\n\t\t\tparam = this._node.params.get(param_name);\n\t\t\tif (param) {\n\t\t\t\tJsonImportDispatcher.dispatch_param(param).process_data(param_data);\n\t\t\t\t// param.visit(JsonImporterVisitor).process_data(param_data);\n\t\t\t}\n\t\t} else {\n\t\t\tconst options = param_data['options'];\n\t\t\tif (options && param_type) {\n\t\t\t\tconst is_spare = options['spare'] === true;\n\t\t\t\tif (is_spare && param_data['default_value']) {\n\t\t\t\t\tif (has_param) {\n\t\t\t\t\t\tthis._node.params.delete_param(param_name);\n\t\t\t\t\t}\n\t\t\t\t\tparam = this._node.add_param(param_type, param_name, param_data['default_value'], options);\n\t\t\t\t\tif (param) {\n\t\t\t\t\t\tJsonImportDispatcher.dispatch_param(param).process_data(param_data);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _is_param_data_complex(param_data: ParamJsonExporterData<ParamType>): boolean {\n\t\t// we can test here most param value serialized, except for ramp\n\t\tif (\n\t\t\tlodash_isString(param_data) ||\n\t\t\tlodash_isNumber(param_data) ||\n\t\t\tlodash_isArray(param_data) ||\n\t\t\tlodash_isBoolean(param_data)\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (lodash_isObject(param_data)) {\n\t\t\tif (Object.keys(param_data).includes('type')) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tfrom_data_custom(data: NodeJsonExporterData) {}\n}\n","import {ParamJsonImporter} from '../Param';\nimport {ComplexParamJsonExporterData} from '../../export/Param';\nimport {TypedMultipleParam} from 'src/engine/params/_Multiple';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nexport class ParamMultipleJsonImporter extends ParamJsonImporter<TypedMultipleParam<ParamType>> {\n\tadd_main(data: ComplexParamJsonExporterData<ParamType>) {\n\t\t// const components = data['components'];\n\t\t// if (components) {\n\t\t// \tObject.keys(components).forEach((component_name) => {\n\t\t// \t\tconst param_name = `${this._param.name}${component_name}`;\n\t\t// \t\tconst component_param = this._param.node.params\n\t\t// \t\t\t.get(this._param.name)\n\t\t// \t\t\t?.components?.filter((c) => c.name == param_name)[0];\n\t\t// \t\tif (component_param) {\n\t\t// \t\t\tconst component_data = components[component_name];\n\t\t// \t\t\tJsonImportDispatcher.dispatch_param(component_param as FloatParam).process_data(component_data);\n\t\t// \t\t}\n\t\t// \t});\n\t\t// }\n\t}\n}\n","// import lodash_isString from 'lodash/isString';\nimport {ParamJsonImporter} from '../Param';\nimport {ComplexParamJsonExporterData} from '../../export/Param';\nimport {StringParam} from 'src/engine/params/String';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nconst LINE_BREAK_REGEXP = /\\\\n+/g;\n\nexport class ParamStringJsonImporter extends ParamJsonImporter<StringParam> {\n\tadd_main(data: ComplexParamJsonExporterData<ParamType.STRING>) {\n\t\tlet raw_input = data['raw_input'];\n\t\tif (raw_input !== undefined) {\n\t\t\t// if (lodash_isString(value)) {\n\t\t\traw_input = raw_input.replace(LINE_BREAK_REGEXP, '\\n');\n\t\t\tthis._param.set(raw_input);\n\t\t\t// }\n\t\t}\n\t}\n}\n","import {ParamJsonImporter} from '../Param';\n// import {RampValueJson} from 'src/engine/params/ramp/RampValue';\nimport {ComplexParamJsonExporterData} from '../../export/Param';\nimport {RampParam} from 'src/engine/params/Ramp';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nexport class ParamRampJsonImporter extends ParamJsonImporter<RampParam> {\n\tadd_main(data: ComplexParamJsonExporterData<ParamType.RAMP>) {\n\t\tconst raw_input = data['raw_input']; // as RampValueJson;\n\t\tif (raw_input) {\n\t\t\t// const ramp_value = RampValue.from_json(value);\n\t\t\tthis._param.set(raw_input);\n\t\t}\n\t}\n}\n","import {BaseCommand} from './commands/_Base';\n\nexport class HistoryStack {\n\tprivate static _instance: HistoryStack;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new HistoryStack());\n\t}\n\n\tprivate _commands: BaseCommand[] = [];\n\tprivate _index: number = 0;\n\tprivate _index_at_scene_save: number = 0;\n\n\tprivate constructor() {}\n\n\tget scene_modified(): boolean {\n\t\treturn this._index != this._index_at_scene_save;\n\t}\n\tmark_scene_as_saved() {\n\t\tthis._index_at_scene_save = this._index;\n\t}\n\n\tpush_command(command: BaseCommand) {\n\t\tif (this._commands.length > this._index) {\n\t\t\tthis._commands = this._commands.splice(0, this._index);\n\t\t}\n\n\t\tthis._commands.push(command);\n\t\tthis._index = this._commands.length;\n\n\t\tcommand.do();\n\t}\n\n\tundo() {\n\t\tconst command = this._commands[this._index - 1];\n\t\tif (command) {\n\t\t\tthis._index -= 1;\n\t\t\tcommand.undo();\n\t\t} else {\n\t\t\tconsole.log('nothing to undo');\n\t\t}\n\t\t// console.log(\"undo\", this._index, this._commands)\n\t}\n\n\tredo() {\n\t\tconst command = this._commands[this._index];\n\t\tif (command) {\n\t\t\tthis._index += 1;\n\t\t\tcommand.do();\n\t\t} else {\n\t\t\tconsole.log('nothing to redo');\n\t\t}\n\t\t// console.log(\"redo\", this._index, this._commands)\n\t}\n}\n","import {BaseNodeType} from 'src/engine/nodes/_Base';\n// import {NodeCodeExporter} from './Node'\nimport {CodeExporterDispatcher} from './Dispatcher';\n\nexport class NodesCodeExporter {\n\t_lines: string[] = [];\n\tconstructor(private _nodes: BaseNodeType[]) {}\n\n\tprocess(parent_var_name?: string, position_x_offset?: number) {\n\t\tthis._lines = [];\n\n\t\tthis.add_process(parent_var_name, position_x_offset);\n\n\t\treturn this._lines;\n\t}\n\n\tprocess_with_existing_nodes(parent: BaseNodeType, parent_var_name: string, position_x_offset?: number) {\n\t\tthis._lines = [];\n\n\t\tthis.add_existing_nodes(parent, parent_var_name);\n\t\tthis.add_process(parent_var_name, position_x_offset);\n\n\t\treturn this._lines;\n\t}\n\n\tprivate add_process(parent_var_name?: string, position_x_offset?: number) {\n\t\tif (parent_var_name) {\n\t\t\tthis.multi_push(this.create_function_declare(parent_var_name));\n\t\t\tthis.multi_push(this.create_function_call(parent_var_name));\n\t\t}\n\n\t\tthis._nodes.forEach((node) => {\n\t\t\tthis.multi_push(CodeExporterDispatcher.dispatch_node(node).set_up({position_x_offset: position_x_offset}));\n\t\t});\n\t}\n\n\tprivate add_existing_nodes(parent: BaseNodeType, parent_var_name: string) {\n\t\tparent.children().forEach((child) => {\n\t\t\tconst child_var_name = CodeExporterDispatcher.dispatch_node(child).var_name();\n\t\t\tconst line = `var ${child_var_name} = ${parent_var_name}.node('${child.name}')`;\n\t\t\tthis._lines.push(line);\n\t\t});\n\t}\n\n\tcreate_function_declare(parent_var_name: string): string[] {\n\t\tconst lines: string[] = [];\n\t\tthis._nodes.forEach((node) => {\n\t\t\tconst child_lines = CodeExporterDispatcher.dispatch_node(node).create_function_declare(parent_var_name);\n\t\t\tchild_lines.forEach((child_line) => {\n\t\t\t\tlines.push(child_line);\n\t\t\t});\n\t\t});\n\t\treturn lines;\n\t}\n\tcreate_function_call(parent_var_name: string): string[] {\n\t\tconst lines: string[] = [];\n\t\tthis._nodes.forEach((node) => {\n\t\t\tconst child_line = CodeExporterDispatcher.dispatch_node(node).create_function_call(parent_var_name);\n\t\t\tlines.push(child_line);\n\t\t});\n\t\treturn lines;\n\t}\n\n\tprivate multi_push(child_lines: string[]) {\n\t\tchild_lines.forEach((child_line) => {\n\t\t\tthis._lines.push(child_line);\n\t\t});\n\t}\n}\n","export enum MouseButton {\n\tLEFT = 0,\n\tMIDDLE = 1,\n\tRIGHT = 2,\n}\n","import {StoreController} from '../store/controllers/StoreController';\nimport {HistoryStack} from '../history/Stack';\n\nenum EventName {\n\tPRESS = 'on_key_press',\n\tDOWN = 'on_key_down',\n\tUP = 'on_key_up',\n}\n\nexport interface KeyEventProcessor {\n\ton_key_press: (event: KeyboardEvent) => boolean;\n\ton_key_down: (event: KeyboardEvent) => boolean;\n\ton_key_up: (event: KeyboardEvent) => boolean;\n}\n\nexport class KeyEventsDispatcher {\n\tprivate static _instance: KeyEventsDispatcher | undefined;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new KeyEventsDispatcher());\n\t}\n\n\tprivate _active: boolean = false;\n\tprivate _on_keypress_bound: (event: KeyboardEvent) => void;\n\tprivate _on_keydown_bound: (event: KeyboardEvent) => void;\n\tprivate _on_keyup_bound: (event: KeyboardEvent) => void;\n\tprivate _processor: KeyEventProcessor | undefined;\n\n\t// TODO: typescript - do I need this to have a component?\n\t// probably not, as it only seems to be to access the store\n\tprivate constructor(/*component?: any*/) {\n\t\t// this.component = component;\n\t\t// this._processor = null;\n\t\tthis._on_keypress_bound = this._on_keypress.bind(this);\n\t\tthis._on_keydown_bound = this._on_keydown.bind(this);\n\t\tthis._on_keyup_bound = this._on_keyup.bind(this);\n\t\tthis.activate();\n\t}\n\n\tstatic activate() {\n\t\tthis.instance().activate();\n\t}\n\tactivate() {\n\t\tif (!this._active) {\n\t\t\tthis._active = true;\n\t\t\tdocument.addEventListener('keypress', this._on_keypress_bound);\n\t\t\tdocument.addEventListener('keydown', this._on_keydown_bound);\n\t\t\tdocument.addEventListener('keyup', this._on_keyup_bound);\n\t\t}\n\t}\n\tstatic deactivate() {\n\t\tthis.instance().deactivate();\n\t}\n\tdeactivate() {\n\t\tif (this._active) {\n\t\t\tthis._active = false;\n\t\t\tdocument.removeEventListener('keypress', this._on_keypress_bound);\n\t\t\tdocument.removeEventListener('keydown', this._on_keydown_bound);\n\t\t\tdocument.removeEventListener('keyup', this._on_keyup_bound);\n\t\t}\n\t}\n\n\tregister_processor(processor: KeyEventProcessor) {\n\t\tthis._processor = processor;\n\t}\n\tderegister_processor(processor: KeyEventProcessor) {\n\t\tif (processor === this._processor) {\n\t\t\tthis._processor = undefined;\n\t\t}\n\t}\n\n\t_on_keypress(e: KeyboardEvent) {\n\t\tthis._process_on_key_event(e, EventName.PRESS);\n\t}\n\t_on_keydown(e: KeyboardEvent) {\n\t\tthis._process_on_key_event(e, EventName.DOWN);\n\t}\n\t_on_keyup(e: KeyboardEvent) {\n\t\tthis._process_on_key_event(e, EventName.UP);\n\t}\n\n\t_process_on_key_event(event: KeyboardEvent, event_type: EventName) {\n\t\tlet key_processed: boolean = false;\n\t\tif (this._processor) {\n\t\t\tconst method = this._processor[event_type];\n\t\t\tif (method) {\n\t\t\t\tkey_processed = method(event);\n\t\t\t}\n\t\t}\n\n\t\tif (!key_processed) {\n\t\t\tthis[event_type](event);\n\t\t}\n\t}\n\n\ton_key_press(event: KeyboardEvent) {\n\t\t// if (this.component) {\n\t\tswitch (event.key) {\n\t\t\t// when 'Delete'\n\t\t\t// \tthis.delete_selected_nodes()\n\t\t\tcase 'u':\n\t\t\t\treturn StoreController.editor.go_up();\n\t\t\tcase 'i':\n\t\t\t\treturn StoreController.editor.go_down();\n\t\t\tcase 'y':\n\t\t\t\tif (event.ctrlKey) {\n\t\t\t\t\treturn HistoryStack.instance().redo();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'z':\n\t\t\t\tif (event.ctrlKey) {\n\t\t\t\t\treturn HistoryStack.instance().undo();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tswitch (event.code) {\n\t\t\t\t\tcase 'Space':\n\t\t\t\t\t\treturn StoreController.scene.time_controller.toggle_play_pause();\n\t\t\t\t}\n\t\t}\n\t\t// }\n\t}\n\n\ton_key_down(event: KeyboardEvent) {\n\t\t// if (this.component) {\n\t\tconst scene = StoreController.scene;\n\t\tswitch (event.key) {\n\t\t\tcase 's':\n\t\t\t\tif (event.ctrlKey) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tStoreController.save_scene();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'ArrowRight':\n\t\t\t\tif (event.ctrlKey) {\n\t\t\t\t\treturn scene.set_frame(scene.frame_range[1]);\n\t\t\t\t} else {\n\t\t\t\t\treturn scene.time_controller.increment_frame();\n\t\t\t\t}\n\t\t\tcase 'ArrowLeft':\n\t\t\t\tif (event.ctrlKey) {\n\t\t\t\t\treturn scene.set_frame(scene.frame_range[0]);\n\t\t\t\t} else {\n\t\t\t\t\treturn scene.time_controller.decrement_frame();\n\t\t\t\t}\n\t\t}\n\t\t// }\n\t}\n\n\ton_key_up(event: KeyboardEvent) {\n\t\tif (event.key == 'Escape') {\n\t\t\tStoreController.close_all_popups();\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class NodeSetNameCommand extends BaseCommand {\n\tprivate _old_name: string;\n\n\tconstructor(private _node: BaseNodeType, private _new_name: string) {\n\t\tsuper();\n\t\tthis._old_name = this._node.name;\n\t}\n\n\tdo() {\n\t\tthis._node.set_name(this._new_name);\n\t}\n\n\tundo() {\n\t\tthis._node.set_name(this._old_name);\n\t}\n}\n","import {GlobalsBaseController} from './_Base';\nimport {GlobalsGlNode} from '../../Globals';\nimport {BaseGlNodeType} from '../../_Base';\n// import {Definition} from '../../Definition/_Module'\n// import { VariableConfig } from '../Config/VariableConfig';\nimport {TextureAllocationsController} from '../utils/TextureAllocationsController';\nimport {GlobalsGeometryHandler} from './Geometry';\nimport {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\nimport {UniformGLDefinition, AttributeGLDefinition, VaryingGLDefinition} from '../../utils/GLDefinition';\nimport {ConnectionPointType} from 'src/engine/nodes/utils/connections/ConnectionPointType';\nimport {ShadersCollectionController} from '../utils/ShadersCollectionController';\n\n// import {DefinitionBaseConfig} from '../Config/DefinitionBaseConfig'\n// import {UniformConfig} from '../Config/UniformConfig'\n// import {AttributeConfig} from '../Config/AttributeConfig'\n// import { Attribute } from '../../Attribute';\n\nexport class GlobalsTextureHandler extends GlobalsBaseController {\n\tprivate _texture_allocations_controller: TextureAllocationsController | undefined;\n\n\tstatic UV_ATTRIB = 'particles_sim_uv_attrib';\n\tstatic UV_VARYING = 'particles_sim_uv_varying';\n\tstatic PARTICLE_SIM_UV = 'particleUV';\n\n\tprivate globals_geometry_handler: GlobalsGeometryHandler | undefined;\n\n\tconstructor(private _uv_name: string) {\n\t\tsuper();\n\t}\n\n\tset_texture_allocations_controller(controller: TextureAllocationsController) {\n\t\tthis._texture_allocations_controller = controller;\n\t}\n\n\thandle_globals_node(\n\t\tglobals_node: GlobalsGlNode,\n\t\toutput_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t\t// definitions_by_shader_name: Map<ShaderName, BaseGLDefinition[]>,\n\t\t// body_lines_by_shader_name: Map<ShaderName, string[]>,\n\t\t// body_lines: string[],\n\t\t// dependencies: ShaderName[],\n\t\t// shader_name: ShaderName\n\t) {\n\t\tif (!this._texture_allocations_controller) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst connection_point = globals_node.io.outputs.named_output_connection_points_by_name(output_name);\n\t\tconst var_name = globals_node.gl_var_name(output_name);\n\n\t\tconst variable = this._texture_allocations_controller.variable(output_name);\n\n\t\tif (variable && connection_point) {\n\t\t\tconst gl_type = connection_point.type;\n\t\t\tconst new_value = this.read_attribute(globals_node, gl_type, output_name, shaders_collection_controller);\n\t\t\tconst body_line = `${gl_type} ${var_name} = ${new_value}`;\n\t\t\tshaders_collection_controller.add_body_lines(globals_node, [body_line]);\n\t\t} else {\n\t\t\tthis.globals_geometry_handler = this.globals_geometry_handler || new GlobalsGeometryHandler();\n\t\t\tthis.globals_geometry_handler.handle_globals_node(\n\t\t\t\tglobals_node,\n\t\t\t\toutput_name,\n\t\t\t\tshaders_collection_controller\n\t\t\t\t// definitions_by_shader_name,\n\t\t\t\t// body_lines_by_shader_name,\n\t\t\t\t// body_lines,\n\t\t\t\t// dependencies,\n\t\t\t\t// shader_name\n\t\t\t);\n\t\t}\n\n\t\t// definitions\n\t\t// const gl_type = named_output.gl_type()\n\t\t// const definition = new Definition.Varying(globals_node, gl_type, var_name)\n\t\t// definitions_by_shader_name[shader_name].push(definition)\n\n\t\t// const new_value = this.read_attribute(globals_node, gl_type, output_name)\n\t\t// const body_line = `${var_name} = ${new_value}`\n\t\t// if(allocation){\n\t\t// \tconst var_name_texture = allocation.texture_name()\n\t\t// \t// add another definition if a texture was allocated by ParticlesSystemGPU\n\t\t// \tconst texture_definition = new Definition.Uniform(globals_node, 'sampler2D', var_name_texture)\n\t\t// \tdefinitions_by_shader_name[shader_name].push(texture_definition)\n\n\t\t// \t// const particles_sim_uv_definition = new Definition.Attribute(globals_node, 'vec2', GlobalsTextureHandler.UV_ATTRIB)\n\t\t// \t// definitions_by_shader_name['vertex'].push(particles_sim_uv_definition)\n\t\t// \t// this.add_particles_sim_uv_attribute(globals_node)\n\n\t\t// \tconst new_value = this.read_attribute(globals_node, gl_type, output_name, shader_name)\n\t\t// \tbody_line = `${var_name} = ${new_value}`\n\n\t\t// } else {\n\t\t// \tbody_line = `${var_name} = vec3(${output_name})`\n\t\t// }\n\n\t\t// const new_body_lines = [\n\t\t// \t// `${var_name} = vec3(${output_name})`,\n\t\t// \t`vec3 ${var_name} = texture2D( ${var_name_texture}, uv ).xyz;`\n\t\t// ]\n\t\t// const body_line = `vec3 ${var_name} = texture2D( ${var_name_texture}, uv ).xyz`\n\n\t\t// for(let dependency of dependencies){\n\t\t// \tdefinitions_by_shader_name[dependency].push(definition)\n\t\t// \tbody_lines_by_shader_name[dependency].push(body_line)\n\t\t// }\n\t\t// if(dependencies.length == 0){\n\t\t// \tbody_lines.push(body_line)\n\t\t// }\n\t}\n\t// variable_config_default(variable_name: string): string {\n\t// \t// const allocation = this._texture_allocations_controller.allocation_for_variable(variable_name)\n\t// \t// if(allocation){\n\t// \t// \treturn `texture2D( texture_${allocation.name()}, ${GlobalsTextureHandler.UV_VARYING} ).xyz`\n\t// \t// } else {\n\t// \t// \tGlobalsGeometryHandler.variable_config_default(variable_name)\n\t// \t// }\n\t// \tthrow 'do I go through here?';\n\t// \treturn this.read_attribute(variable_name);\n\t// }\n\t// variable_config_required_definitions(variable_name:string):DefinitionBaseConfig[]{\n\t// \tconst allocation = this._texture_allocations_controller.allocation_for_variable(variable_name)\n\t// \tif(allocation){\n\t// \t\treturn [\n\t// \t\t\tnew AttributeConfig('vec2', GlobalsTextureHandler.UV_ATTRIB),\n\t// \t\t\tnew UniformConfig('sampler2D', `texture_${allocation.name()}`)\n\t// \t\t]\n\t// \t}\n\t// }\n\n\t// static remap_instance_attribute(name:string):string{\n\t// \tif(name == 'instancePosition'){\n\t// \t\treturn 'position'\n\t// \t}\n\t// \treturn name\n\t// }\n\t// static variable_name_to_instance_attrib(name:string):string{\n\t// \tif(name == 'position'){\n\t// \t\treturn 'instancePosition'\n\t// \t}\n\t// \treturn name\n\t// }\n\n\tread_attribute(\n\t\tnode: BaseGlNodeType,\n\t\tgl_type: ConnectionPointType,\n\t\tattrib_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {\n\t\tif (!this._texture_allocations_controller) {\n\t\t\treturn;\n\t\t}\n\t\t// attrib_name = GlobalsTextureHandler.remap_instance_attribute(attrib_name)\n\n\t\tconst texture_variable = this._texture_allocations_controller.variable(attrib_name);\n\n\t\tif (texture_variable) {\n\t\t\tthis.add_particles_sim_uv_attribute(node, shaders_collection_controller);\n\t\t\t// const texture_variable = allocation.variable(attrib_name)\n\t\t\t// if(!texture_variable){\n\t\t\t// \tconsole.error(`no tex var found for ${attrib_name}`)\n\t\t\t// \tthis._texture_allocations_controller.print(node.scene())\n\t\t\t// }\n\t\t\tconst component = texture_variable.component;\n\t\t\tconst allocation = texture_variable.allocation;\n\t\t\tif (allocation) {\n\t\t\t\t// const definitions_by_shader_name = {}\n\t\t\t\t// definitions_by_shader_name[shader_name] = []\n\t\t\t\tconst var_name_texture = allocation.texture_name;\n\t\t\t\tconst texture_definition = new UniformGLDefinition(\n\t\t\t\t\tnode,\n\t\t\t\t\tConnectionPointType.SAMPLER_2D,\n\t\t\t\t\tvar_name_texture\n\t\t\t\t);\n\t\t\t\t// definitions_by_shader_name[shader_name].push(texture_definition)\n\n\t\t\t\tshaders_collection_controller.add_definitions(node, [texture_definition]);\n\n\t\t\t\t// const particles_sim_uv_definition = new Definition.Attribute(globals_node, 'vec2', 'particles_sim_uv')\n\t\t\t\t// definitions_by_shader_name['vertex'].push(particles_sim_uv_definition)\n\t\t\t\tconst body_line = `texture2D( ${var_name_texture}, ${this._uv_name} ).${component}`;\n\t\t\t\treturn body_line;\n\t\t\t}\n\t\t} else {\n\t\t\treturn GlobalsGeometryHandler.read_attribute(node, gl_type, attrib_name, shaders_collection_controller);\n\t\t}\n\t}\n\n\tadd_particles_sim_uv_attribute(node: BaseGlNodeType, shaders_collection_controller: ShadersCollectionController) {\n\t\t// const shader_names = ['vertex', 'fragment'];\n\t\t// const definitions_by_shader_name:Map<ShaderName, BaseGLDefinition[]> = new Map();\n\t\t// definitions_by_shader_name.set(ShaderName.VERTEX, [])\n\t\t// definitions_by_shader_name.set(ShaderName.FRAGMENT, [])\n\t\t// for (let shader_name of shader_names) {\n\t\t// \tdefinitions_by_shader_name[shader_name] = [];\n\t\t// }\n\n\t\tconst particles_sim_uv_attrib_definition = new AttributeGLDefinition(\n\t\t\tnode,\n\t\t\tConnectionPointType.VEC2,\n\t\t\tGlobalsTextureHandler.UV_ATTRIB\n\t\t);\n\t\tconst particles_sim_uv_varying_definition = new VaryingGLDefinition(\n\t\t\tnode,\n\t\t\tConnectionPointType.VEC2,\n\t\t\tGlobalsTextureHandler.UV_VARYING\n\t\t);\n\n\t\tshaders_collection_controller.add_definitions(\n\t\t\tnode,\n\t\t\t[particles_sim_uv_attrib_definition, particles_sim_uv_varying_definition],\n\t\t\tShaderName.VERTEX\n\t\t);\n\t\tshaders_collection_controller.add_definitions(node, [particles_sim_uv_varying_definition], ShaderName.FRAGMENT);\n\n\t\tshaders_collection_controller.add_body_lines(\n\t\t\tnode,\n\t\t\t[`${GlobalsTextureHandler.UV_VARYING} = ${GlobalsTextureHandler.UV_ATTRIB}`],\n\t\t\tShaderName.VERTEX\n\t\t);\n\t}\n}\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Full-screen textured quad shader\n */\n\n\n\nvar CopyShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\": { value: null },\n\t\t\"opacity\": { value: 1.0 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\"\tvUv = uv;\",\n\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform float opacity;\",\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\"\tvec4 texel = texture2D( tDiffuse, vUv );\",\n\t\t\"\tgl_FragColor = opacity * texel;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nexport { CopyShader };\n","import {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\nimport {UniformsUtils} from 'three/src/renderers/shaders/UniformsUtils';\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nimport { Pass } from \"../postprocessing/Pass.js\";\n\nvar ShaderPass = function ( shader, textureID ) {\n\n\tPass.call( this );\n\n\tthis.textureID = ( textureID !== undefined ) ? textureID : \"tDiffuse\";\n\n\tif ( shader instanceof ShaderMaterial ) {\n\n\t\tthis.uniforms = shader.uniforms;\n\n\t\tthis.material = shader;\n\n\t} else if ( shader ) {\n\n\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\tthis.material = new ShaderMaterial( {\n\n\t\t\tdefines: Object.assign( {}, shader.defines ),\n\t\t\tuniforms: this.uniforms,\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader\n\n\t\t} );\n\n\t}\n\n\tthis.fsQuad = new Pass.FullScreenQuad( this.material );\n\n};\n\nShaderPass.prototype = Object.assign( Object.create( Pass.prototype ), {\n\n\tconstructor: ShaderPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tif ( this.uniforms[ this.textureID ] ) {\n\n\t\t\tthis.uniforms[ this.textureID ].value = readBuffer.texture;\n\n\t\t}\n\n\t\tthis.fsQuad.material = this.material;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t}\n\n} );\n\nexport { ShaderPass };\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\n\nimport { Pass } from \"../postprocessing/Pass.js\";\n\nvar MaskPass = function ( scene, camera ) {\n\n\tPass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.clear = true;\n\tthis.needsSwap = false;\n\n\tthis.inverse = false;\n\n};\n\nMaskPass.prototype = Object.assign( Object.create( Pass.prototype ), {\n\n\tconstructor: MaskPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tvar context = renderer.getContext();\n\t\tvar state = renderer.state;\n\n\t\t// don't update color or depth\n\n\t\tstate.buffers.color.setMask( false );\n\t\tstate.buffers.depth.setMask( false );\n\n\t\t// lock buffers\n\n\t\tstate.buffers.color.setLocked( true );\n\t\tstate.buffers.depth.setLocked( true );\n\n\t\t// set up stencil\n\n\t\tvar writeValue, clearValue;\n\n\t\tif ( this.inverse ) {\n\n\t\t\twriteValue = 0;\n\t\t\tclearValue = 1;\n\n\t\t} else {\n\n\t\t\twriteValue = 1;\n\t\t\tclearValue = 0;\n\n\t\t}\n\n\t\tstate.buffers.stencil.setTest( true );\n\t\tstate.buffers.stencil.setOp( context.REPLACE, context.REPLACE, context.REPLACE );\n\t\tstate.buffers.stencil.setFunc( context.ALWAYS, writeValue, 0xffffffff );\n\t\tstate.buffers.stencil.setClear( clearValue );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t\t// draw into the stencil buffer\n\n\t\trenderer.setRenderTarget( readBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\trenderer.setRenderTarget( writeBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\t// unlock color and depth buffer for subsequent rendering\n\n\t\tstate.buffers.color.setLocked( false );\n\t\tstate.buffers.depth.setLocked( false );\n\n\t\t// only render where stencil is set to 1\n\n\t\tstate.buffers.stencil.setLocked( false );\n\t\tstate.buffers.stencil.setFunc( context.EQUAL, 1, 0xffffffff ); // draw if == 1\n\t\tstate.buffers.stencil.setOp( context.KEEP, context.KEEP, context.KEEP );\n\t\tstate.buffers.stencil.setLocked( true );\n\n\t}\n\n} );\n\n\nvar ClearMaskPass = function () {\n\n\tPass.call( this );\n\n\tthis.needsSwap = false;\n\n};\n\nClearMaskPass.prototype = Object.create( Pass.prototype );\n\nObject.assign( ClearMaskPass.prototype, {\n\n\trender: function ( renderer /*, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\trenderer.state.buffers.stencil.setLocked( false );\n\t\trenderer.state.buffers.stencil.setTest( false );\n\n\t}\n\n} );\n\nexport { MaskPass, ClearMaskPass };\n","import {Clock} from 'three/src/core/Clock';\nimport {LinearFilter} from 'three/src/constants';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {OrthographicCamera} from 'three/src/cameras/OrthographicCamera';\nimport {PlaneBufferGeometry} from 'three/src/geometries/PlaneGeometry';\nimport {RGBAFormat} from 'three/src/constants';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {WebGLRenderTarget} from 'three/src/renderers/WebGLRenderTarget';\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nimport { CopyShader } from \"../shaders/CopyShader.js\";\nimport { ShaderPass } from \"../postprocessing/ShaderPass.js\";\nimport { MaskPass } from \"../postprocessing/MaskPass.js\";\nimport { ClearMaskPass } from \"../postprocessing/MaskPass.js\";\n\nvar EffectComposer = function ( renderer, renderTarget ) {\n\n\tthis.renderer = renderer;\n\n\tif ( renderTarget === undefined ) {\n\n\t\tvar parameters = {\n\t\t\tminFilter: LinearFilter,\n\t\t\tmagFilter: LinearFilter,\n\t\t\tformat: RGBAFormat,\n\t\t\tstencilBuffer: false\n\t\t};\n\n\t\tvar size = renderer.getSize( new Vector2() );\n\t\tthis._pixelRatio = renderer.getPixelRatio();\n\t\tthis._width = size.width;\n\t\tthis._height = size.height;\n\n\t\trenderTarget = new WebGLRenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, parameters );\n\t\trenderTarget.texture.name = 'EffectComposer.rt1';\n\n\t} else {\n\n\t\tthis._pixelRatio = 1;\n\t\tthis._width = renderTarget.width;\n\t\tthis._height = renderTarget.height;\n\n\t}\n\n\tthis.renderTarget1 = renderTarget;\n\tthis.renderTarget2 = renderTarget.clone();\n\tthis.renderTarget2.texture.name = 'EffectComposer.rt2';\n\n\tthis.writeBuffer = this.renderTarget1;\n\tthis.readBuffer = this.renderTarget2;\n\n\tthis.renderToScreen = true;\n\n\tthis.passes = [];\n\n\t// dependencies\n\n\tif ( CopyShader === undefined ) {\n\n\t\tconsole.error( 'THREE.EffectComposer relies on CopyShader' );\n\n\t}\n\n\tif ( ShaderPass === undefined ) {\n\n\t\tconsole.error( 'THREE.EffectComposer relies on ShaderPass' );\n\n\t}\n\n\tthis.copyPass = new ShaderPass( CopyShader );\n\n\tthis.clock = new Clock();\n\n};\n\nObject.assign( EffectComposer.prototype, {\n\n\tswapBuffers: function () {\n\n\t\tvar tmp = this.readBuffer;\n\t\tthis.readBuffer = this.writeBuffer;\n\t\tthis.writeBuffer = tmp;\n\n\t},\n\n\taddPass: function ( pass ) {\n\n\t\tthis.passes.push( pass );\n\t\tpass.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t},\n\n\tinsertPass: function ( pass, index ) {\n\n\t\tthis.passes.splice( index, 0, pass );\n\n\t},\n\n\tisLastEnabledPass: function ( passIndex ) {\n\n\t\tfor ( var i = passIndex + 1; i < this.passes.length; i ++ ) {\n\n\t\t\tif ( this.passes[ i ].enabled ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\trender: function ( deltaTime ) {\n\n\t\t// deltaTime value is in seconds\n\n\t\tif ( deltaTime === undefined ) {\n\n\t\t\tdeltaTime = this.clock.getDelta();\n\n\t\t}\n\n\t\tvar currentRenderTarget = this.renderer.getRenderTarget();\n\n\t\tvar maskActive = false;\n\n\t\tvar pass, i, il = this.passes.length;\n\n\t\tfor ( i = 0; i < il; i ++ ) {\n\n\t\t\tpass = this.passes[ i ];\n\n\t\t\tif ( pass.enabled === false ) continue;\n\n\t\t\tpass.renderToScreen = ( this.renderToScreen && this.isLastEnabledPass( i ) );\n\t\t\tpass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive );\n\n\t\t\tif ( pass.needsSwap ) {\n\n\t\t\t\tif ( maskActive ) {\n\n\t\t\t\t\tvar context = this.renderer.getContext();\n\t\t\t\t\tvar stencil = this.renderer.state.buffers.stencil;\n\n\t\t\t\t\t//context.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n\t\t\t\t\tthis.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime );\n\n\t\t\t\t\t//context.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\t\t\t\t\tstencil.setFunc( context.EQUAL, 1, 0xffffffff );\n\n\t\t\t\t}\n\n\t\t\t\tthis.swapBuffers();\n\n\t\t\t}\n\n\t\t\tif ( MaskPass !== undefined ) {\n\n\t\t\t\tif ( pass instanceof MaskPass ) {\n\n\t\t\t\t\tmaskActive = true;\n\n\t\t\t\t} else if ( pass instanceof ClearMaskPass ) {\n\n\t\t\t\t\tmaskActive = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.renderer.setRenderTarget( currentRenderTarget );\n\n\t},\n\n\treset: function ( renderTarget ) {\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tvar size = this.renderer.getSize( new Vector2() );\n\t\t\tthis._pixelRatio = this.renderer.getPixelRatio();\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = this.renderTarget1.clone();\n\t\t\trenderTarget.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t\t}\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget2.dispose();\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tvar effectiveWidth = this._width * this._pixelRatio;\n\t\tvar effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget1.setSize( effectiveWidth, effectiveHeight );\n\t\tthis.renderTarget2.setSize( effectiveWidth, effectiveHeight );\n\n\t\tfor ( var i = 0; i < this.passes.length; i ++ ) {\n\n\t\t\tthis.passes[ i ].setSize( effectiveWidth, effectiveHeight );\n\n\t\t}\n\n\t},\n\n\tsetPixelRatio: function ( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n} );\n\n\nvar Pass = function () {\n\n\t// if set to true, the pass is processed by the composer\n\tthis.enabled = true;\n\n\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\tthis.needsSwap = true;\n\n\t// if set to true, the pass clears its buffer before rendering\n\tthis.clear = false;\n\n\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\tthis.renderToScreen = false;\n\n};\n\nObject.assign( Pass.prototype, {\n\n\tsetSize: function ( /* width, height */ ) {},\n\n\trender: function ( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n} );\n\n// Helper for passes that need to fill the viewport with a single quad.\nPass.FullScreenQuad = ( function () {\n\n\tvar camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tvar geometry = new PlaneBufferGeometry( 2, 2 );\n\n\tvar FullScreenQuad = function ( material ) {\n\n\t\tthis._mesh = new Mesh( geometry, material );\n\n\t};\n\n\tObject.defineProperty( FullScreenQuad.prototype, 'material', {\n\n\t\tget: function () {\n\n\t\t\treturn this._mesh.material;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tthis._mesh.material = value;\n\n\t\t}\n\n\t} );\n\n\tObject.assign( FullScreenQuad.prototype, {\n\n\t\tdispose: function () {\n\n\t\t\tthis._mesh.geometry.dispose();\n\n\t\t},\n\n\t\trender: function ( renderer ) {\n\n\t\t\trenderer.render( this._mesh, camera );\n\n\t\t}\n\n\t} );\n\n\treturn FullScreenQuad;\n\n} )();\n\nexport { EffectComposer, Pass };\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"Editor full_page_height grid-y\",\n      on: {\n        \"!contextmenu\": function($event) {\n          $event.preventDefault()\n        }\n      }\n    },\n    [\n      _c(\"PanelNodeSelector\"),\n      _c(\"DialogAlert\"),\n      _c(\"DialogConfirm\"),\n      _c(\"DialogPrompt\"),\n      !_vm.full_screen_activated\n        ? _c(\n            \"Retractable\",\n            [\n              _c(\"TopBar\", {\n                attrs: {\n                  scene_update_allowed: _vm.scene_update_allowed,\n                  username: _vm.username\n                }\n              }),\n              _c(\"NavigationBar\")\n            ],\n            1\n          )\n        : _vm._e(),\n      _c(\"MultiplePanel\", { ref: \"multiple_panel\" }),\n      _c(\"PlayBar\"),\n      _c(\"NumericSlider\"),\n      _c(\"NodeContextMenu\"),\n      _c(\"ParamContextMenu\")\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=template&id=73cf5ecf&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"TopMenu cell shrink app_header grid-x\" }, [\n    _c(\n      \"div\",\n      { staticClass: \"cell shrink\" },\n      [\n        _c(\"DropDownMenu\", {\n          attrs: { label: \"File\", entries: _vm.file_menu_entries },\n          on: { select: _vm.on_file_menu_entry_select }\n        }),\n        _c(\"DropDownMenu\", {\n          attrs: { label: \"Edit\", entries: _vm.edit_menu_entries },\n          on: { select: _vm.on_edit_menu_entry_select }\n        }),\n        _vm.display_desktop_entries\n          ? _c(\"DropDownMenu\", {\n              attrs: { label: \"Desktop\", entries: _vm.desktop_menu_entries },\n              on: { select: _vm.on_desktop_menu_entry_select }\n            })\n          : _vm._e()\n      ],\n      1\n    )\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Top.vue?vue&type=template&id=5389aaa9&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"dropdown_menu\",\n      class: _vm.dropdown_menu_class_object,\n      on: { click: _vm.toggle_display }\n    },\n    [\n      _c(\n        \"div\",\n        {\n          class: _vm.dropdown_menu_label_object,\n          style: _vm.menu_label_style_object\n        },\n        [\n          _vm.display_label\n            ? _c(\"div\", { staticClass: \"dropdown_menu_label_content\" }, [\n                _vm._v(_vm._s(_vm.label))\n              ])\n            : _vm._e(),\n          _c(\n            \"div\",\n            {\n              staticClass: \"dropdown_menu_pixel\",\n              class: _vm.pixel_class_object\n            },\n            [\n              _c(\n                \"div\",\n                {\n                  ref: \"dropdown_menu_content\",\n                  staticClass: \"dropdown_menu_content\",\n                  class: _vm.content_class_object,\n                  style: _vm.content_style_object,\n                  on: { mouseleave: _vm.unset_hovered_entry }\n                },\n                [\n                  _c(\n                    \"ul\",\n                    _vm._l(_vm.sorted_entries, function(entry, i) {\n                      return _c(\n                        \"li\",\n                        {\n                          key: i,\n                          ref: \"entry_element\",\n                          refInFor: true,\n                          on: {\n                            mouseenter: function($event) {\n                              return _vm.set_hovered_entry_index(i)\n                            }\n                          }\n                        },\n                        [\n                          _c(\n                            \"div\",\n                            {\n                              staticClass: \"entry\",\n                              class: _vm.entry_class_objects[i],\n                              on: {\n                                click: function($event) {\n                                  $event.stopPropagation()\n                                  return _vm.select(entry)\n                                }\n                              }\n                            },\n                            [\n                              _vm.has_emphasis\n                                ? _c(\"span\", [\n                                    _c(\"span\", [\n                                      _vm._v(\n                                        _vm._s(_vm.entry_labels_pre_emphasis[i])\n                                      )\n                                    ]),\n                                    _c(\"span\", { staticClass: \"emphasis\" }, [\n                                      _vm._v(_vm._s(_vm.emphasis))\n                                    ]),\n                                    _c(\"span\", [\n                                      _vm._v(\n                                        _vm._s(\n                                          _vm.entry_labels_post_emphasis[i]\n                                        )\n                                      )\n                                    ])\n                                  ])\n                                : _c(\"span\", [\n                                    _c(\"span\", [\n                                      _vm._v(_vm._s(_vm.entry_labels[i]))\n                                    ])\n                                  ])\n                            ]\n                          )\n                        ]\n                      )\n                    }),\n                    0\n                  )\n                ]\n              ),\n              _vm.hovered_entry_has_children\n                ? _c(\"DropDownMenu\", {\n                    key: _vm.hovered_entry_id,\n                    staticClass: \"sub_entries_dropdown\",\n                    style: _vm.sub_dropdown_style_object,\n                    attrs: {\n                      init_position_top: _vm.sub_dropdown_init_position_top,\n                      level: _vm.level + 1,\n                      display_label: false,\n                      entries: _vm.hovered_entry_children,\n                      event_id_prefix: _vm.hovered_entry_id,\n                      always_visible: true,\n                      emphasis: _vm.emphasis\n                    },\n                    on: { select: _vm.on_entry_select }\n                  })\n                : _vm._e()\n            ],\n            1\n          )\n        ]\n      )\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDownMenu.vue?vue&type=template&id=da2d5a00&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.display\n    ? _c(\n        \"div\",\n        { staticClass: \"DialogAlert\" },\n        [\n          _c(\n            \"Modal\",\n            {\n              ref: \"modal\",\n              attrs: {\n                title: _vm.title,\n                size: { x: 400, y: 180 },\n                resizable: false\n              }\n            },\n            [\n              _c(\"div\", { staticClass: \"full_height_container grid-y\" }, [\n                _c(\n                  \"div\",\n                  { staticClass: \"cell auto text-center message-container\" },\n                  [_vm._v(_vm._s(_vm.message))]\n                ),\n                _c(\"div\", { staticClass: \"cell shrink text-right\" }, [\n                  _c(\"div\", { staticClass: \"buttons\" }, [\n                    _c(\n                      \"div\",\n                      {\n                        staticClass: \"button success\",\n                        on: { click: _vm.close }\n                      },\n                      [_vm._v(\"Ok\")]\n                    )\n                  ])\n                ])\n              ])\n            ]\n          )\n        ],\n        1\n      )\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Alert.vue?vue&type=template&id=31ab1650&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.display\n    ? _c(\n        \"div\",\n        { staticClass: \"DialogConfirm\" },\n        [\n          _c(\n            \"Modal\",\n            {\n              ref: \"modal\",\n              attrs: {\n                title: _vm.question,\n                size: { x: 400, y: 120 },\n                resizable: false\n              }\n            },\n            [\n              _c(\"div\", { staticClass: \"full_height_container grid-y\" }, [\n                _c(\"div\", { staticClass: \"cell shrink text-center\" }, [\n                  _c(\"div\", { staticClass: \"buttons\" }, [\n                    _c(\n                      \"button\",\n                      {\n                        ref: \"cancel_button\",\n                        staticClass: \"button clear\",\n                        on: { click: _vm.close }\n                      },\n                      [_vm._v(\"Cancel\")]\n                    ),\n                    _c(\n                      \"button\",\n                      {\n                        ref: \"accept_button\",\n                        staticClass: \"button alert\",\n                        on: { click: _vm.accept }\n                      },\n                      [_vm._v(_vm._s(_vm.accept_label))]\n                    )\n                  ])\n                ])\n              ])\n            ]\n          )\n        ],\n        1\n      )\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=template&id=5266573c&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.display\n    ? _c(\n        \"div\",\n        { staticClass: \"DialogPrompt\" },\n        [\n          _c(\n            \"Modal\",\n            {\n              ref: \"modal\",\n              attrs: {\n                title: _vm.title,\n                size: { x: 400, y: 180 },\n                resizable: false\n              }\n            },\n            [\n              _c(\"div\", { staticClass: \"full_height_container grid-y\" }, [\n                _c(\"div\", { staticClass: \"cell auto\" }, [\n                  _c(\"form\", [\n                    _c(\"input\", {\n                      ref: \"main_input\",\n                      attrs: { type: \"text\" },\n                      domProps: { value: _vm.default_value },\n                      on: {\n                        keypress: function($event) {\n                          $event.stopPropagation()\n                          return _vm.on_keypress($event)\n                        },\n                        keyup: function($event) {\n                          $event.stopPropagation()\n                        },\n                        keydown: function($event) {\n                          $event.stopPropagation()\n                        }\n                      }\n                    })\n                  ])\n                ]),\n                _c(\"div\", { staticClass: \"cell shrink text-right\" }, [\n                  _c(\"div\", { staticClass: \"buttons\" }, [\n                    _c(\n                      \"div\",\n                      { staticClass: \"button clear\", on: { click: _vm.close } },\n                      [_vm._v(\"Cancel\")]\n                    ),\n                    _c(\n                      \"div\",\n                      {\n                        staticClass: \"button success\",\n                        on: { click: _vm.save }\n                      },\n                      [_vm._v(_vm._s(_vm.confirm_label))]\n                    )\n                  ])\n                ])\n              ])\n            ]\n          )\n        ],\n        1\n      )\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Prompt.vue?vue&type=template&id=698160d0&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { ref: \"element\", staticClass: \"Panel Multiple cell auto\" },\n    [\n      _vm.is_split\n        ? _c(\"div\", { class: _vm.split_container_class_object }, [\n            _c(\n              \"div\",\n              { staticClass: \"cell\", style: _vm.cell_style_objects[0] },\n              [\n                _c(\n                  \"div\",\n                  { staticClass: \"full_height_container grid-y\" },\n                  [\n                    _c(\"MultiplePanel\", {\n                      ref: \"split_panel0\",\n                      attrs: {\n                        level: _vm.level + 1,\n                        init_properties: _vm.split_panel_init_properties[0],\n                        scene_update_allowed: _vm.scene_update_allowed,\n                        panel_id: _vm.cell_panel_ids[0]\n                      },\n                      on: {\n                        delete: function($event) {\n                          return _vm.delete_split_panel(0)\n                        }\n                      }\n                    })\n                  ],\n                  1\n                )\n              ]\n            ),\n            _c(\n              \"div\",\n              { staticClass: \"cell\", style: _vm.cell_style_objects[1] },\n              [\n                _c(\n                  \"div\",\n                  { staticClass: \"full_height_container grid-y\" },\n                  [\n                    _c(\"MultiplePanel\", {\n                      ref: \"split_panel1\",\n                      attrs: {\n                        level: _vm.level + 1,\n                        init_properties: _vm.split_panel_init_properties[1],\n                        scene_update_allowed: _vm.scene_update_allowed,\n                        panel_id: _vm.cell_panel_ids[1]\n                      },\n                      on: {\n                        delete: function($event) {\n                          return _vm.delete_split_panel(1)\n                        }\n                      }\n                    })\n                  ],\n                  1\n                )\n              ]\n            ),\n            !_vm.full_screen_activated\n              ? _c(\n                  \"div\",\n                  {\n                    staticClass: \"split_panel_separator\",\n                    style: _vm.split_panel_separator_style_object,\n                    on: { mousedown: _vm.on_move_start }\n                  },\n                  [_c(\"div\", { staticClass: \"split_panel_separator_line\" })]\n                )\n              : _vm._e()\n          ])\n        : _c(\"div\", { staticClass: \"full_height_container grid-y\" }, [\n            !_vm.full_screen_activated\n              ? _c(\"div\", { staticClass: \"cell shrink panel_tabs\" }, [\n                  _c(\"div\", { staticClass: \"grid-x\" }, [\n                    _c(\"div\", { staticClass: \"cell auto\" }, [\n                      _c(\n                        \"ul\",\n                        { staticClass: \"no-bullet tab_list\" },\n                        [\n                          _vm._l(_vm.panel_types, function(panel_type, i) {\n                            return _c(\n                              \"li\",\n                              {\n                                staticClass: \"tab_item_container\",\n                                class: _vm.tab_class_objects[i]\n                              },\n                              [\n                                _c(\"span\", { staticClass: \"tab_item\" }, [\n                                  _c(\n                                    \"span\",\n                                    {\n                                      staticClass: \"panel_type_name\",\n                                      on: {\n                                        click: function($event) {\n                                          return _vm.set_current_panel_index(i)\n                                        }\n                                      }\n                                    },\n                                    [_vm._v(_vm._s(panel_type))]\n                                  ),\n                                  _vm.tab_delete_allowed\n                                    ? _c(\n                                        \"span\",\n                                        {\n                                          staticClass: \"panel_type_close\",\n                                          on: {\n                                            click: function($event) {\n                                              return _vm.remove_tab(i)\n                                            }\n                                          }\n                                        },\n                                        [_vm._v(\"\")]\n                                      )\n                                    : _vm._e()\n                                ])\n                              ]\n                            )\n                          }),\n                          _c(\n                            \"li\",\n                            { staticClass: \"tab_item_container new_panel\" },\n                            [\n                              _c(\"DropDownMenu\", {\n                                attrs: {\n                                  label: \"+\",\n                                  entries: _vm.available_panel_types,\n                                  on_hover: false,\n                                  label_padding: _vm.tab_menu_label_padding\n                                },\n                                on: { select: _vm.add_tab }\n                              })\n                            ],\n                            1\n                          )\n                        ],\n                        2\n                      )\n                    ]),\n                    _c(\n                      \"div\",\n                      {\n                        staticClass:\n                          \"cell shrink split_menu_container_container\"\n                      },\n                      [\n                        _c(\n                          \"div\",\n                          { staticClass: \"split_menu_container\" },\n                          [\n                            _c(\"DropDownMenu\", {\n                              attrs: {\n                                label: \"-\",\n                                entries: _vm.split_types,\n                                on_hover: false,\n                                label_padding: _vm.tab_menu_label_padding,\n                                right_aligned: true\n                              },\n                              on: { select: _vm.set_split_mode }\n                            })\n                          ],\n                          1\n                        )\n                      ]\n                    )\n                  ])\n                ])\n              : _vm._e(),\n            _c(\n              \"div\",\n              { staticClass: \"cell auto panels_container\" },\n              [\n                _c(_vm.current_panel_type, {\n                  ref: \"current_panel\",\n                  tag: \"Component\",\n                  attrs: {\n                    panel_id: _vm.panel_id,\n                    scene_update_allowed: _vm.scene_update_allowed\n                  },\n                  on: { created: _vm.on_component_created }\n                })\n              ],\n              1\n            )\n          ])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Multiple.vue?vue&type=template&id=4667f202&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NavigationBar\" }, [\n    _c(\"div\", { staticClass: \"grid-x\" }, [\n      _c(\"div\", { staticClass: \"cell shrink\" }, [\n        _c(\"div\", { staticClass: \"button-group\" }, [\n          _c(\n            \"div\",\n            {\n              staticClass: \"button tiny primary backward\",\n              class: _vm.go_backward_class_object,\n              on: { click: _vm.go_backward }\n            },\n            [_c(\"v-icon\", { attrs: { name: \"angle-double-left\" } })],\n            1\n          ),\n          _c(\n            \"div\",\n            {\n              staticClass: \"button tiny primary forward\",\n              class: _vm.go_forward_class_object,\n              on: { click: _vm.go_forward }\n            },\n            [_c(\"v-icon\", { attrs: { name: \"angle-double-right\" } })],\n            1\n          )\n        ])\n      ]),\n      _c(\"div\", { staticClass: \"cell auto\" }, [\n        _c(\n          \"ul\",\n          { staticClass: \"path_elements\" },\n          [\n            _c(\"li\", { staticClass: \"path_element\" }, [\n              _c(\n                \"span\",\n                {\n                  staticClass: \"path_element_name\",\n                  on: {\n                    click: function($event) {\n                      return _vm.go_to_path(\"/\")\n                    }\n                  }\n                },\n                [_vm._v(\"/\")]\n              )\n            ]),\n            _vm._l(_vm.path_elements, function(path_element, i) {\n              return _c(\"li\", { key: i, staticClass: \"path_element\" }, [\n                _c(\n                  \"span\",\n                  {\n                    staticClass: \"path_element_name\",\n                    on: {\n                      click: function($event) {\n                        return _vm.go_to_path_elements_index(i)\n                      }\n                    }\n                  },\n                  [_vm._v(_vm._s(path_element))]\n                ),\n                i < _vm.path_elements.length - 1\n                  ? _c(\"span\", { staticClass: \"path_separator\" }, [_vm._v(\"/\")])\n                  : _vm._e()\n              ])\n            })\n          ],\n          2\n        )\n      ])\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=template&id=3ad40df0&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"Bar Play\" }, [\n    _c(\"div\", { staticClass: \"grid-x\", attrs: { id: \"play_bar\" } }, [\n      _c(\n        \"div\",\n        {\n          ref: \"scrubber\",\n          staticClass: \"cell auto play_bar_scrubber\",\n          on: { click: _vm.scrubber_set_frame, mousedown: _vm.on_mouse_down }\n        },\n        [\n          _c(\"div\", {\n            staticClass: \"frame_indicator\",\n            style: _vm.frame_indicator_style_object\n          })\n        ]\n      ),\n      _c(\"div\", { staticClass: \"cell shrink\" }, [\n        _c(\"div\", { staticClass: \"play_bar_buttons_container grid-x\" }, [\n          _c(\"div\", { staticClass: \"cell-shrink\" }, [\n            _c(\n              \"form\",\n              {\n                on: {\n                  submit: function($event) {\n                    $event.preventDefault()\n                    $event.stopPropagation()\n                  }\n                }\n              },\n              [\n                _c(\"input\", {\n                  directives: [\n                    {\n                      name: \"model\",\n                      rawName: \"v-model.number\",\n                      value: _vm.frame,\n                      expression: \"frame\",\n                      modifiers: { number: true }\n                    }\n                  ],\n                  attrs: { type: \"number\" },\n                  domProps: { value: _vm.frame },\n                  on: {\n                    input: function($event) {\n                      if ($event.target.composing) {\n                        return\n                      }\n                      _vm.frame = _vm._n($event.target.value)\n                    },\n                    blur: function($event) {\n                      return _vm.$forceUpdate()\n                    }\n                  }\n                })\n              ]\n            )\n          ]),\n          _c(\"div\", { staticClass: \"cell-shrink play_bar_buttons\" }, [\n            _c(\n              \"div\",\n              {\n                staticClass: \"button tiny disable-select\",\n                on: { click: _vm.decrement_frame }\n              },\n              [_c(\"v-icon\", { attrs: { name: \"angle-left\" } })],\n              1\n            ),\n            _c(\n              \"div\",\n              {\n                staticClass: \"button tiny success disable-select\",\n                on: { click: _vm.toggle_play_pause }\n              },\n              [\n                !_vm.playing\n                  ? _c(\"v-icon\", { attrs: { name: \"play\" } })\n                  : _c(\"v-icon\", { attrs: { name: \"pause\" } })\n              ],\n              1\n            ),\n            _c(\n              \"div\",\n              {\n                staticClass: \"button tiny disable-select\",\n                on: { click: _vm.increment_frame }\n              },\n              [_c(\"v-icon\", { attrs: { name: \"angle-right\" } })],\n              1\n            )\n          ]),\n          _c(\"div\", { staticClass: \"cell-shrink frame-range\" }, [\n            _c(\n              \"form\",\n              {\n                on: {\n                  submit: function($event) {\n                    $event.preventDefault()\n                    $event.stopPropagation()\n                  }\n                }\n              },\n              [\n                _c(\"input\", {\n                  directives: [\n                    {\n                      name: \"model\",\n                      rawName: \"v-model.number\",\n                      value: _vm.frame_range_start,\n                      expression: \"frame_range_start\",\n                      modifiers: { number: true }\n                    }\n                  ],\n                  attrs: { type: \"number\" },\n                  domProps: { value: _vm.frame_range_start },\n                  on: {\n                    input: function($event) {\n                      if ($event.target.composing) {\n                        return\n                      }\n                      _vm.frame_range_start = _vm._n($event.target.value)\n                    },\n                    blur: function($event) {\n                      return _vm.$forceUpdate()\n                    }\n                  }\n                }),\n                _c(\"input\", {\n                  directives: [\n                    {\n                      name: \"model\",\n                      rawName: \"v-model.number\",\n                      value: _vm.frame_range_end,\n                      expression: \"frame_range_end\",\n                      modifiers: { number: true }\n                    }\n                  ],\n                  attrs: {\n                    type: \"number\",\n                    disabled: !_vm.frame_range_end_locked\n                  },\n                  domProps: { value: _vm.frame_range_end },\n                  on: {\n                    input: function($event) {\n                      if ($event.target.composing) {\n                        return\n                      }\n                      _vm.frame_range_end = _vm._n($event.target.value)\n                    },\n                    blur: function($event) {\n                      return _vm.$forceUpdate()\n                    }\n                  }\n                }),\n                _c(\"input\", {\n                  directives: [\n                    {\n                      name: \"model\",\n                      rawName: \"v-model\",\n                      value: _vm.frame_range_end_locked,\n                      expression: \"frame_range_end_locked\"\n                    }\n                  ],\n                  attrs: { type: \"checkbox\" },\n                  domProps: {\n                    checked: Array.isArray(_vm.frame_range_end_locked)\n                      ? _vm._i(_vm.frame_range_end_locked, null) > -1\n                      : _vm.frame_range_end_locked\n                  },\n                  on: {\n                    change: function($event) {\n                      var $$a = _vm.frame_range_end_locked,\n                        $$el = $event.target,\n                        $$c = $$el.checked ? true : false\n                      if (Array.isArray($$a)) {\n                        var $$v = null,\n                          $$i = _vm._i($$a, $$v)\n                        if ($$el.checked) {\n                          $$i < 0 &&\n                            (_vm.frame_range_end_locked = $$a.concat([$$v]))\n                        } else {\n                          $$i > -1 &&\n                            (_vm.frame_range_end_locked = $$a\n                              .slice(0, $$i)\n                              .concat($$a.slice($$i + 1)))\n                        }\n                      } else {\n                        _vm.frame_range_end_locked = $$c\n                      }\n                    }\n                  }\n                })\n              ]\n            )\n          ])\n        ])\n      ])\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlayBar.vue?vue&type=template&id=06281ded&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.display\n    ? _c(\n        \"div\",\n        { staticClass: \"NodeSelector\" },\n        [\n          _c(\n            \"Modal\",\n            {\n              ref: \"modal\",\n              attrs: { title: \"Choose a node:\", size: { x: 400, y: 600 } }\n            },\n            [\n              _c(\"div\", { staticClass: \"full_height_container grid-y\" }, [\n                _c(\n                  \"div\",\n                  { staticClass: \"cell auto\" },\n                  [\n                    _c(\"NodeTree\", {\n                      attrs: {\n                        graph_node_id: _vm.root_id,\n                        node_context: _vm.node_context,\n                        selected_graph_node_id: _vm.selected_graph_node_id,\n                        init_expanded: true\n                      },\n                      on: { select: _vm.on_select }\n                    })\n                  ],\n                  1\n                ),\n                _c(\"div\", { staticClass: \"cell shrink text-right\" }, [\n                  _c(\"div\", { staticClass: \"buttons\" }, [\n                    _c(\n                      \"div\",\n                      {\n                        staticClass: \"button success\",\n                        class: _vm.accept_button_class_object,\n                        on: { click: _vm.accept_selected }\n                      },\n                      [_vm._v(\"Accept\")]\n                    ),\n                    _c(\n                      \"div\",\n                      { staticClass: \"button clear\", on: { click: _vm.close } },\n                      [_vm._v(\"Cancel\")]\n                    )\n                  ])\n                ])\n              ])\n            ]\n          )\n        ],\n        1\n      )\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PanelNodeSelector.vue?vue&type=template&id=058e1753&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NodeTree\", class: _vm.class_object }, [\n    _c(\"div\", { staticClass: \"grid-x\" }, [\n      _c(\"div\", { staticClass: \"cell shrink\" }, [\n        _c(\n          \"div\",\n          {\n            staticClass: \"expand_button\",\n            style: _vm.expand_button_class_object,\n            on: { click: _vm.toggle_expanded }\n          },\n          [_vm._v(_vm._s(_vm.expand_label))]\n        )\n      ]),\n      _c(\"div\", { staticClass: \"cell auto\" }, [\n        _c(\"div\", { staticClass: \"node_name\", on: { click: _vm.on_click } }, [\n          _vm._v(_vm._s(_vm.node_name))\n        ]),\n        _vm.expanded\n          ? _c(\n              \"div\",\n              { staticClass: \"children\" },\n              _vm._l(_vm.children, function(child, i) {\n                return _c(\"NodeTree\", {\n                  key: child.graph_node_id,\n                  attrs: {\n                    graph_node_id: child.graph_node_id,\n                    node_context: _vm.node_context,\n                    selected_graph_node_id: _vm.selected_graph_node_id\n                  },\n                  on: { select: _vm.on_child_select }\n                })\n              }),\n              1\n            )\n          : _vm._e()\n      ])\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeTree.vue?vue&type=template&id=3a6e6a90&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.display\n    ? _c(\n        \"div\",\n        { staticClass: \"NumericSlider\", style: _vm.main_style_object },\n        [\n          _c(\n            \"div\",\n            {\n              staticClass: \"increment_starters_container\",\n              class: _vm.starters_container_class_object\n            },\n            _vm._l(_vm.increments, function(increment, i) {\n              return _c(\n                \"div\",\n                {\n                  staticClass: \"increment_starter text-center\",\n                  class: _vm.increment_starter_class_objects[i],\n                  on: {\n                    mouseenter: function($event) {\n                      return _vm.set_current_increment_index(i)\n                    }\n                  }\n                },\n                [\n                  _c(\"div\", { staticClass: \"increment_label\" }, [\n                    _vm._v(_vm._s(increment))\n                  ]),\n                  _vm.increment_starter_class_actives[i]\n                    ? _c(\"div\", { staticClass: \"value_label\" }, [\n                        _vm._v(_vm._s(_vm.displayed_value))\n                      ])\n                    : _vm._e()\n                ]\n              )\n            }),\n            0\n          )\n        ]\n      )\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumericSlider.vue?vue&type=template&id=3f81e4a4&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.active\n    ? _c(\n        \"div\",\n        { staticClass: \"ParamMenu\", style: _vm.style_object },\n        [\n          _c(\"DropDownMenu\", {\n            attrs: {\n              display_label: false,\n              always_visible: true,\n              entries: _vm.menu_entries,\n              sort_entries: true\n            },\n            on: { select: _vm.on_select }\n          })\n        ],\n        1\n      )\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeContextMenu.vue?vue&type=template&id=be934afe&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.active\n    ? _c(\n        \"div\",\n        { staticClass: \"ParamMenu\", style: _vm.style_object },\n        [\n          _c(\"DropDownMenu\", {\n            attrs: {\n              display_label: false,\n              always_visible: true,\n              entries: _vm.menu_entries,\n              sort_entries: true\n            },\n            on: { select: _vm.on_select }\n          })\n        ],\n        1\n      )\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamContextMenu.vue?vue&type=template&id=e9fcae08&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"Retractable cell shrink\" }, [\n    _c(\n      \"div\",\n      {\n        directives: [\n          {\n            name: \"show\",\n            rawName: \"v-show\",\n            value: _vm.retracted,\n            expression: \"retracted\"\n          }\n        ],\n        staticClass: \"grid-x\"\n      },\n      [\n        _c(\"div\", {\n          staticClass: \"retractable-toggler horizontal\",\n          on: { click: _vm.toggle }\n        })\n      ]\n    ),\n    _c(\n      \"div\",\n      {\n        directives: [\n          {\n            name: \"show\",\n            rawName: \"v-show\",\n            value: !_vm.retracted,\n            expression: \"!retracted\"\n          }\n        ],\n        staticClass: \"grid-x\"\n      },\n      [\n        _c(\"div\", { staticClass: \"cell shrink\" }, [\n          _c(\"div\", {\n            staticClass: \"retractable-toggler vertical\",\n            on: { click: _vm.toggle }\n          })\n        ]),\n        _c(\"div\", { staticClass: \"cell auto\" }, [_vm._t(\"default\")], 2)\n      ]\n    )\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Retractable.vue?vue&type=template&id=146d1eee&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"Polygon-Modal-Container\" }, [\n    _c(\"div\", { staticClass: \"Polygon-Modal\", style: _vm.style_object }, [\n      _c(\"div\", { staticClass: \"grid-y modal-grid\" }, [\n        _c(\"div\", { staticClass: \"cell shrink disable-select\" }, [\n          _c(\n            \"div\",\n            {\n              staticClass: \"Modal-title text-center\",\n              on: { mousedown: _vm.on_move_start }\n            },\n            [_vm._v(_vm._s(_vm.title))]\n          )\n        ]),\n        _c(\n          \"div\",\n          { staticClass: \"cell auto Modal-body\" },\n          [_vm._t(\"default\")],\n          2\n        ),\n        _vm.resizable\n          ? _c(\"div\", { staticClass: \"cell shrink\" }, [\n              _c(\"div\", {\n                staticClass: \"Modal-size-handle\",\n                on: { mousedown: _vm.on_resize_start }\n              })\n            ])\n          : _vm._e()\n      ])\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=template&id=80ac54ae&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"Panel Network full_height_container grid-y\" },\n    [\n      _c(\"div\", { staticClass: \"cell shrink\" }, [\n        _c(\"div\", { staticClass: \"grid-x buttons-container-height-0\" }, [\n          _c(\"div\", { staticClass: \"cell shrink\" }, [\n            _c(\n              \"div\",\n              {\n                staticClass: \"button tiny above-event-catcher disable-select\",\n                on: {\n                  click: _vm.toggle_tab_menu,\n                  \"!contextmenu\": function($event) {\n                    $event.preventDefault()\n                    return _vm.toggle_tab_menu($event)\n                  }\n                }\n              },\n              [_vm._v(\"+ Add Node\")]\n            )\n          ]),\n          _c(\"div\", { staticClass: \"cell auto\" }),\n          _c(\"div\", { staticClass: \"cell shrink\" }, [\n            _vm.display_go_up_button\n              ? _c(\n                  \"div\",\n                  { staticClass: \"go-up-button-container above-event-catcher\" },\n                  [\n                    _c(\n                      \"div\",\n                      { staticClass: \"go-up-button\", on: { click: _vm.go_up } },\n                      [_c(\"v-icon\", { attrs: { name: \"angle-double-up\" } })],\n                      1\n                    )\n                  ]\n                )\n              : _vm._e()\n          ])\n        ])\n      ]),\n      _c(\"div\", { staticClass: \"cell auto\" }, [\n        _c(\n          \"div\",\n          { ref: \"canvas_container\", staticClass: \"canvas_container\" },\n          [\n            _c(\n              \"div\",\n              {\n                ref: \"canvas\",\n                staticClass: \"canvas\",\n                class: _vm.canvas_class_object,\n                on: {\n                  click: _vm.on_click,\n                  wheel: function($event) {\n                    $event.preventDefault()\n                    return _vm.on_wheel($event)\n                  }\n                }\n              },\n              [\n                _c(\n                  \"div\",\n                  {\n                    staticClass: \"zoom-container\",\n                    style: _vm.zoom_container_style_object\n                  },\n                  [\n                    _c(\n                      \"div\",\n                      {\n                        staticClass: \"pan-container\",\n                        style: _vm.pan_container_style_object\n                      },\n                      [\n                        _c(\n                          \"div\",\n                          {\n                            ref: \"nodes_container\",\n                            staticClass: \"nodes-container\",\n                            on: {\n                              mousedown: _vm.on_mouse_down,\n                              mousemove: _vm.on_mouse_move,\n                              mouseup: _vm.on_mouse_up\n                            }\n                          },\n                          [\n                            _c(\"div\", {\n                              staticClass: \"nodes-container-events-catcher\"\n                            }),\n                            _c(\"div\", {\n                              staticClass: \"selection-rectangle\",\n                              style: _vm.selection_rectangle_style_object\n                            }),\n                            _c(\"div\", {\n                              staticClass: \"node-creation-rectangle\",\n                              style: _vm.node_creation_rectangle_style_object\n                            }),\n                            _vm._l(_vm.json_children, function(json_child) {\n                              return _c(\"Node\", {\n                                key: json_child.graph_node_id,\n                                attrs: {\n                                  json_node: json_child,\n                                  json_parent: _vm.json_node,\n                                  action_in_progress: _vm.action_in_progress\n                                },\n                                on: {\n                                  capture_node_for_move:\n                                    _vm.on_capture_node_for_move,\n                                  capture_node_src_for_connection:\n                                    _vm.on_capture_node_src_for_connection,\n                                  capture_node_dest_for_connection:\n                                    _vm.on_capture_node_dest_for_connection,\n                                  capture_node_final_for_connection:\n                                    _vm.on_capture_node_final_for_connection,\n                                  set_display_flag: _vm.on_set_display_flag,\n                                  set_bypass_flag: _vm.on_set_bypass_flag\n                                }\n                              })\n                            }),\n                            _vm.connection_data.active\n                              ? _c(\"InterractiveConnection\", {\n                                  attrs: {\n                                    mouse_start:\n                                      _vm.connection_data.mouse_start,\n                                    mouse_progress:\n                                      _vm.connection_data.mouse_progress\n                                  }\n                                })\n                              : _vm._e()\n                          ],\n                          2\n                        )\n                      ]\n                    )\n                  ]\n                )\n              ]\n            )\n          ]\n        )\n      ]),\n      _vm.tab_menu_opened\n        ? _c(\"TabMenu\", {\n            style: _vm.tab_menu_style_object,\n            attrs: { json_node: _vm.json_node },\n            on: { close: _vm.close_tab_menu, select: _vm.on_tab_menu_select }\n          })\n        : _vm._e()\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Network.vue?vue&type=template&id=7de911dd&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"Panel Params full_height_container grid-y\" },\n    [\n      !_vm.first_selected_json_node\n        ? _c(\"div\", { staticClass: \"text-center\" }, [\n            _vm._v(\"no node selected.\")\n          ])\n        : _vm._e(),\n      _vm.display_toolbar\n        ? _c(\"div\", { staticClass: \"cell shrink\" }, [\n            _c(\"div\", { staticClass: \"grid-x\" }, [\n              _c(\"div\", { staticClass: \"cell auto\" }, [\n                _c(\"div\", { staticClass: \"node_name_container text-center\" }, [\n                  _c(\n                    \"span\",\n                    {\n                      staticClass: \"node_name\",\n                      on: { click: _vm.on_name_click }\n                    },\n                    [_vm._v(_vm._s(_vm.selected_node_name))]\n                  ),\n                  _vm.selected_node_type\n                    ? _c(\"span\", { staticClass: \"node_type\" }, [\n                        _vm._v(\"(\" + _vm._s(_vm.selected_node_type) + \")\")\n                      ])\n                    : _vm._e()\n                ])\n              ]),\n              _c(\"div\", { staticClass: \"cell shrink\" })\n            ])\n          ])\n        : _vm._e(),\n      _c(\"div\", { staticClass: \"cell auto params_container\" }, [\n        _c(\n          \"form\",\n          [\n            _vm.display_top_folders\n              ? _c(\n                  \"div\",\n                  { staticClass: \"grid-x\" },\n                  _vm._l(_vm.top_folder_json_params, function(json_param, i) {\n                    return _c(\n                      \"div\",\n                      {\n                        staticClass: \"cell auto params_folder\",\n                        class: _vm.folder_class_objects[i]\n                      },\n                      [\n                        json_param.name.length > 0\n                          ? _c(\n                              \"div\",\n                              {\n                                staticClass: \"folder_name\",\n                                on: {\n                                  click: function($event) {\n                                    return _vm.set_active_folder_id(\n                                      json_param.graph_node_id\n                                    )\n                                  }\n                                }\n                              },\n                              [_vm._v(_vm._s(json_param.name))]\n                            )\n                          : _vm._e()\n                      ]\n                    )\n                  }),\n                  0\n                )\n              : _vm._e(),\n            _vm._l(_vm.selected_node_json_params_for_current_folder, function(\n              json_param,\n              i\n            ) {\n              return _c(\"ParamFieldContainer\", {\n                key: json_param.graph_node_id,\n                attrs: { json_param: json_param, tabindex: (i + 1) * 100 }\n              })\n            })\n          ],\n          2\n        )\n      ])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Params.vue?vue&type=template&id=594125ff&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"Panel Viewer full_height_container grid-y\" },\n    [\n      _c(\"div\", { staticClass: \"cell shrink viewer_top_bar\" }, [\n        _c(\"div\", { staticClass: \"grid-x\" }, [\n          _c(\n            \"div\",\n            { staticClass: \"cell shrink\" },\n            [\n              _c(\"DropDownMenu\", {\n                attrs: {\n                  label: _vm.camera_menu_label,\n                  entries: _vm.camera_menu_entries,\n                  sort_entries: true\n                },\n                on: { select: _vm.on_select_camera_menu_entry_select }\n              })\n            ],\n            1\n          ),\n          _c(\"div\", { staticClass: \"cell auto\" }),\n          _c(\"div\", { staticClass: \"cell shrink text-right\" }, [\n            _c(\n              \"div\",\n              {\n                staticClass: \"full-screen-button\",\n                on: { click: _vm.toggle_fullscreen }\n              },\n              [_c(\"v-icon\", { attrs: { name: \"regular/square\" } })],\n              1\n            )\n          ])\n        ])\n      ]),\n      _c(\n        \"div\",\n        { ref: \"viewer_container\", staticClass: \"cell auto viewers_container\" },\n        [\n          _c(\"ThreejsViewer\", {\n            key: _vm.current_camera_node_graph_id,\n            ref: \"viewer\",\n            attrs: {\n              current_camera_node_graph_id: _vm.current_camera_node_graph_id\n            }\n          })\n        ],\n        1\n      )\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=template&id=3a6d707f&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"Panel Spreadsheet full_height_container grid-y\" },\n    [\n      _c(\"div\", { staticClass: \"cell shrink\" }, [\n        _vm.loading\n          ? _c(\"span\", [\n              _c(\"i\", { staticClass: \"fa fa-refresh fa-spin\" }),\n              _c(\"span\", [_vm._v(\"loading...\")])\n            ])\n          : _vm._e()\n      ]),\n      !_vm.loading\n        ? _c(\"div\", { ref: \"table_container\", staticClass: \"cell auto\" }, [\n            _c(\"div\", { staticClass: \"full_height_container grid-y\" }, [\n              _c(\"div\", { staticClass: \"cell shrink\" }, [\n                _c(\"div\", { staticClass: \"grid-x\" }, [\n                  _c(\"div\", { staticClass: \"cell shrink\" }, [\n                    _c(\n                      \"div\",\n                      { staticClass: \"spreadsheet-drop-down-container\" },\n                      [\n                        _c(\n                          \"div\",\n                          { staticClass: \"spreadsheet-drop-down-label\" },\n                          [_vm._v(\"view attributes\")]\n                        ),\n                        _c(\n                          \"div\",\n                          { staticClass: \"spreadsheet-drop-down-content\" },\n                          [\n                            _c(\n                              \"div\",\n                              {\n                                staticClass: \"spreadsheet-drop-down-entry\",\n                                on: { click: _vm.select_all_attributes }\n                              },\n                              [\n                                _c(\n                                  \"span\",\n                                  { staticClass: \"attr-selection-icon\" },\n                                  [\n                                    true\n                                      ? _c(\"v-icon\", {\n                                          attrs: {\n                                            name: \"regular/check-square\"\n                                          }\n                                        })\n                                      : _c(\"v-icon\", {\n                                          attrs: { name: \"regular/square\" }\n                                        })\n                                  ],\n                                  1\n                                ),\n                                _c(\"span\", { staticClass: \"attr-name\" }, [\n                                  _vm._v(\"select all\")\n                                ])\n                              ]\n                            ),\n                            _c(\n                              \"div\",\n                              {\n                                staticClass: \"spreadsheet-drop-down-entry\",\n                                on: { click: _vm.select_no_attributes }\n                              },\n                              [\n                                _c(\n                                  \"span\",\n                                  { staticClass: \"attr-selection-icon\" },\n                                  [\n                                    false\n                                      ? _c(\"v-icon\", {\n                                          attrs: {\n                                            name: \"regular/check-square\"\n                                          }\n                                        })\n                                      : _c(\"v-icon\", {\n                                          attrs: { name: \"regular/square\" }\n                                        })\n                                  ],\n                                  1\n                                ),\n                                _c(\"span\", { staticClass: \"attr-name\" }, [\n                                  _vm._v(\"select none\")\n                                ])\n                              ]\n                            ),\n                            _c(\"div\", {\n                              staticClass: \"spreadsheet-drop-down-separator\"\n                            }),\n                            _vm._l(_vm.attrib_names, function(attrib_name) {\n                              return _c(\n                                \"div\",\n                                {\n                                  staticClass: \"spreadsheet-drop-down-entry\",\n                                  on: {\n                                    click: function($event) {\n                                      return _vm.toggle_attrib_selection(\n                                        attrib_name\n                                      )\n                                    }\n                                  }\n                                },\n                                [\n                                  _c(\n                                    \"span\",\n                                    { staticClass: \"attr-selection-icon\" },\n                                    [\n                                      _vm.attrib_selected_states[attrib_name]\n                                        ? _c(\"v-icon\", {\n                                            attrs: {\n                                              name: \"regular/check-square\"\n                                            }\n                                          })\n                                        : _c(\"v-icon\", {\n                                            attrs: { name: \"regular/square\" }\n                                          })\n                                    ],\n                                    1\n                                  ),\n                                  _c(\"span\", { staticClass: \"attr-name\" }, [\n                                    _vm._v(_vm._s(attrib_name))\n                                  ])\n                                ]\n                              )\n                            })\n                          ],\n                          2\n                        )\n                      ]\n                    )\n                  ]),\n                  _c(\"div\", { staticClass: \"cell shrink\" }, [\n                    _c(\"div\", { staticClass: \"attrib-class-selectors\" }, [\n                      _c(\n                        \"div\",\n                        {\n                          staticClass: \"attrib-class-selector\",\n                          class: { active: _vm.attrib_class_vertex == false },\n                          attrs: { title: \"objects\" },\n                          on: {\n                            click: function($event) {\n                              return _vm.set_attrib_class_vertex(false)\n                            }\n                          }\n                        },\n                        [_c(\"v-icon\", { attrs: { name: \"square\" } })],\n                        1\n                      ),\n                      _c(\n                        \"div\",\n                        {\n                          staticClass: \"attrib-class-selector\",\n                          class: { active: _vm.attrib_class_vertex == true },\n                          attrs: { title: \"vertices\" },\n                          on: {\n                            click: function($event) {\n                              return _vm.set_attrib_class_vertex(true)\n                            }\n                          }\n                        },\n                        [_c(\"v-icon\", { attrs: { name: \"regular/circle\" } })],\n                        1\n                      )\n                    ])\n                  ])\n                ])\n              ]),\n              _c(\n                \"div\",\n                { staticClass: \"cell auto\" },\n                [\n                  _c(\"ag-grid-vue\", {\n                    staticClass: \"ag-theme-balham\",\n                    attrs: {\n                      rowData: _vm.table_data,\n                      columnDefs: _vm.columnDefs,\n                      modules: _vm.modules,\n                      defaultColDef: _vm.defaultColDef,\n                      columnTypes: _vm.columnTypes,\n                      getRowClass: _vm.getRowClass\n                    }\n                  })\n                ],\n                1\n              )\n            ])\n          ])\n        : _vm._e()\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Spreadsheet.vue?vue&type=template&id=1f1f2a99&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"TabMenu\" },\n    [\n      _c(\"DropDownMenu\", {\n        attrs: {\n          display_label: false,\n          always_visible: true,\n          entries: _vm.menu_entries,\n          sort_entries: true,\n          emphasis: _vm.filter\n        },\n        on: { select: _vm.on_select }\n      })\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TabMenu.vue?vue&type=template&id=bfd58e08&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"NetworkNode\",\n      class: _vm.class_object,\n      style: _vm.style_object\n    },\n    [\n      _c(\n        \"div\",\n        {\n          staticClass: \"node-body\",\n          style: _vm.node_body_style_object,\n          on: {\n            mousedown: _vm.on_body_mousedown,\n            mouseup: _vm.on_body_mouseup,\n            dblclick: _vm.on_body_dblclick,\n            contextmenu: _vm.on_contextmenu\n          }\n        },\n        [\n          _vm.display_icon\n            ? _c(\n                \"div\",\n                { staticClass: \"icon-container\" },\n                [_c(\"v-icon\", { attrs: { name: _vm.icon, scale: \"1\" } })],\n                1\n              )\n            : _vm._e()\n        ]\n      ),\n      _vm.is_errored\n        ? _c(\n            \"div\",\n            {\n              staticClass: \"error-flag-container\",\n              style: _vm.error_flag_container_style_object\n            },\n            [\n              _c(\n                \"div\",\n                { staticClass: \"error-flag\" },\n                [\n                  _c(\"v-icon\", {\n                    attrs: { name: \"exclamation-triangle\", scale: \"4\" }\n                  })\n                ],\n                1\n              )\n            ]\n          )\n        : _vm._e(),\n      _vm.has_bypass_flag\n        ? _c(\n            \"div\",\n            {\n              staticClass: \"flag-container\",\n              style: _vm.bypass_flag_container_style_object\n            },\n            [\n              _c(\"div\", {\n                staticClass: \"node-flag bypass-flag\",\n                class: _vm.bypass_flag_class_object,\n                style: _vm.bypass_flag_style_object,\n                on: {\n                  click: function($event) {\n                    $event.stopPropagation()\n                    $event.preventDefault()\n                    return _vm.on_bypass_flag_click($event)\n                  }\n                }\n              })\n            ]\n          )\n        : _vm._e(),\n      _vm.has_display_flag\n        ? _c(\n            \"div\",\n            {\n              staticClass: \"flag-container\",\n              style: _vm.display_flag_container_style_object\n            },\n            [\n              _c(\"div\", {\n                staticClass: \"node-flag display-flag\",\n                class: _vm.display_flag_class_object,\n                style: _vm.display_flag_style_object,\n                on: {\n                  click: function($event) {\n                    $event.stopPropagation()\n                    $event.preventDefault()\n                    return _vm.on_display_flag_click($event)\n                  }\n                }\n              })\n            ]\n          )\n        : _vm._e(),\n      _c(\n        \"div\",\n        {\n          staticClass: \"name-container disable-select\",\n          style: _vm.name_container_style_object\n        },\n        [\n          _c(\n            \"div\",\n            {\n              staticClass: \"name-element\",\n              on: {\n                click: function($event) {\n                  $event.stopPropagation()\n                  $event.preventDefault()\n                  return _vm.on_name_click($event)\n                }\n              }\n            },\n            [_vm._v(_vm._s(_vm.name))]\n          )\n        ]\n      ),\n      _c(\n        \"div\",\n        {\n          staticClass: \"comment-container\",\n          style: _vm.comment_container_style_object\n        },\n        [\n          _vm.display_comment\n            ? _c(\"div\", { staticClass: \"comment-element\" }, [\n                _vm._v(_vm._s(_vm.comment))\n              ])\n            : _vm._e()\n        ]\n      ),\n      _vm.children_allowed\n        ? _c(\n            \"div\",\n            {\n              staticClass: \"enter-button-container\",\n              style: _vm.enter_button_container_style_object\n            },\n            [\n              _c(\n                \"div\",\n                { staticClass: \"enter-button\", on: { click: _vm.open_node } },\n                [_c(\"v-icon\", { attrs: { name: \"angle-double-down\" } })],\n                1\n              )\n            ]\n          )\n        : _vm._e(),\n      _c(\n        \"div\",\n        {\n          staticClass: \"inputs-container\",\n          style: _vm.inputs_container_style_object\n        },\n        _vm._l(_vm.available_inputs, function(input, i) {\n          return _c(\n            \"div\",\n            {\n              staticClass: \"connection-pixel input-pixel\",\n              class: _vm.connection_pixel_input_class_objects[i],\n              style: _vm.inputs_pixel_style_objects[i]\n            },\n            [\n              _c(\n                \"div\",\n                {\n                  staticClass: \"connection-name-element\",\n                  class: _vm.connection_name_element_class_objects\n                },\n                [_vm._v(_vm._s(_vm.input_names[i]))]\n              ),\n              _c(\"div\", {\n                staticClass: \"connection-element\",\n                attrs: { title: _vm.input_titles[i] },\n                on: {\n                  mousedown: function($event) {\n                    return _vm.on_input_mousedown($event, i)\n                  },\n                  mouseup: function($event) {\n                    return _vm.on_input_mouseup($event, i)\n                  }\n                }\n              })\n            ]\n          )\n        }),\n        0\n      ),\n      _vm.has_outputs\n        ? _c(\n            \"div\",\n            {\n              staticClass: \"outputs-container\",\n              style: _vm.output_container_style_object\n            },\n            _vm._l(_vm.available_outputs, function(output, i) {\n              return _c(\n                \"div\",\n                {\n                  staticClass: \"connection-pixel output-pixel\",\n                  class: _vm.connection_pixel_output_class_objects[i],\n                  style: _vm.outputs_pixel_style_objects[i]\n                },\n                [\n                  _c(\n                    \"div\",\n                    {\n                      staticClass: \"connection-name-element\",\n                      class: _vm.connection_name_element_class_objects\n                    },\n                    [_vm._v(_vm._s(_vm.output_names[i]))]\n                  ),\n                  _c(\"div\", {\n                    staticClass: \"connection-element\",\n                    attrs: { title: _vm.output_titles[i] },\n                    on: {\n                      mousedown: function($event) {\n                        return _vm.on_output_mousedown($event, i)\n                      },\n                      mouseup: function($event) {\n                        return _vm.on_output_mouseup($event, i)\n                      }\n                    }\n                  })\n                ]\n              )\n            }),\n            0\n          )\n        : _vm._e(),\n      _vm._l(_vm.inputs, function(connection, i) {\n        return _vm.input_valid_states[i]\n          ? _c(\"Connection\", {\n              key: i,\n              attrs: {\n                input_index: i,\n                output_index: _vm.input_connection_output_indices[i],\n                src_json_node: _vm.input_json_nodes[i],\n                dest_json_node: _vm.json_node\n              }\n            })\n          : _vm._e()\n      }),\n      _vm.display_node_info\n        ? _c(\"NodeInfo\", { attrs: { graph_node_id: _vm.graph_node_id } })\n        : _vm._e()\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Node.vue?vue&type=template&id=0f96306c&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NetworkNodeInterractiveConnection\" }, [\n    _c(\"svg\", { style: _vm.svg_style_object }, [\n      _c(\"line\", {\n        attrs: {\n          x1: _vm.src_position.x,\n          y1: _vm.src_position.y,\n          x2: _vm.dest_position.x,\n          y2: _vm.dest_position.y\n        }\n      })\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterractiveConnection.vue?vue&type=template&id=f3a8d13c&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.param_visible\n    ? _c(\"div\", { staticClass: \"ParamContainer grid-x\" }, [\n        _c(\n          \"div\",\n          {\n            staticClass: \"cell small-3 text-right param_name\",\n            attrs: { title: _vm.label_tooltip },\n            on: {\n              click: _vm.toggle_expression_mode,\n              mousedown: _vm.open_numeric_slider_if_numeric_or_color,\n              contextmenu: _vm.on_contextmenu\n            }\n          },\n          [\n            _vm.display_label\n              ? _c(\"label\", { staticClass: \"disable-select\" }, [\n                  _vm._v(_vm._s(_vm.name))\n                ])\n              : _vm._e()\n          ]\n        ),\n        _c(\n          \"div\",\n          { staticClass: \"cell small-9\" },\n          [\n            _c(_vm.field_component_type, {\n              tag: \"Component\",\n              attrs: {\n                json_param: _vm.json_param,\n                displays_expression_result: _vm.displays_expression_result,\n                tabindex: _vm.tabindex\n              }\n            })\n          ],\n          1\n        )\n      ])\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Param.vue?vue&type=template&id=23a0544d&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"ThreejsViewer\" }, [\n    _c(\"div\", { ref: \"viewer\" })\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Threejs.vue?vue&type=template&id=8560bbca&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NetworkNodeConnection\" }, [\n    _c(\"svg\", { style: _vm.svg_style_object }, [\n      _c(\"line\", {\n        class: _vm.line_class_object,\n        attrs: {\n          x1: _vm.src_position.x,\n          y1: _vm.src_position.y,\n          x2: _vm.dest_position.x,\n          y2: _vm.dest_position.y\n        }\n      })\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Connection.vue?vue&type=template&id=0679f2b4&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"NetworkNodeInfo\",\n      on: {\n        mousedown: function($event) {\n          $event.stopPropagation()\n        },\n        mouseup: function($event) {\n          $event.stopPropagation()\n        },\n        dblclick: function($event) {\n          $event.stopPropagation()\n        }\n      }\n    },\n    [\n      _c(\"div\", { staticClass: \"arrow-left\" }),\n      _c(\n        \"div\",\n        {\n          staticClass: \"node_title_container\",\n          on: { click: _vm.on_name_click }\n        },\n        [_vm._v(_vm._s(_vm.node_name))]\n      ),\n      _c(\n        \"div\",\n        { staticClass: \"node_info_container\" },\n        [\n          _c(\n            \"div\",\n            {\n              staticClass: \"time_dependency icon_prefixed\",\n              class: _vm.time_dependency_class_object\n            },\n            [\n              _c(\"v-icon\", { attrs: { name: \"regular/clock\" } }),\n              _c(\"span\", [_vm._v(_vm._s(_vm.time_dependency_label))])\n            ],\n            1\n          ),\n          _vm.error_message\n            ? _c(\n                \"div\",\n                { staticClass: \"error_message icon_prefixed\" },\n                [\n                  _c(\"v-icon\", { attrs: { name: \"exclamation-triangle\" } }),\n                  _c(\"span\", [_vm._v(_vm._s(_vm.error_message))])\n                ],\n                1\n              )\n            : _c(\"div\", { staticClass: \"test\" }, [_vm._v(\"not errored\")]),\n          _c(\"div\", { staticClass: \"node_info_separator\" }),\n          _vm.current_node_info_type\n            ? _c(_vm.current_node_info_type, {\n                tag: \"Component\",\n                attrs: { graph_node_id: _vm.graph_node_id }\n              })\n            : _vm._e(),\n          _vm.current_node_info_type\n            ? _c(\"div\", { staticClass: \"node_info_separator\" })\n            : _vm._e(),\n          _c(\"div\", { staticClass: \"dependencies\" }, [\n            _c(\n              \"div\",\n              { staticClass: \"dependencies_section dependencies_predecessors\" },\n              [\n                _c(\"div\", { staticClass: \"dependencies_section_title\" }, [\n                  _vm._v(\"PREDECESSORS:\")\n                ]),\n                _c(\n                  \"div\",\n                  { staticClass: \"dependencies_list\" },\n                  _vm._l(_vm.scene_predecessor_paths, function(node_path, i) {\n                    return _c(\n                      \"div\",\n                      {\n                        staticClass: \"dependendies_item\",\n                        on: {\n                          click: function($event) {\n                            return _vm.go_to_node_path(node_path)\n                          }\n                        }\n                      },\n                      [_vm._v(_vm._s(node_path))]\n                    )\n                  }),\n                  0\n                )\n              ]\n            ),\n            _c(\n              \"div\",\n              { staticClass: \"dependencies_section dependencies_successors\" },\n              [\n                _c(\"div\", { staticClass: \"dependencies_section_title\" }, [\n                  _vm._v(\"SUCCESSORS:\")\n                ]),\n                _c(\n                  \"div\",\n                  { staticClass: \"dependencies_list\" },\n                  _vm._l(_vm.scene_successor_paths, function(node_path, i) {\n                    return _c(\n                      \"div\",\n                      {\n                        staticClass: \"dependendies_item\",\n                        on: {\n                          click: function($event) {\n                            return _vm.go_to_node_path(node_path)\n                          }\n                        }\n                      },\n                      [_vm._v(_vm._s(node_path))]\n                    )\n                  }),\n                  0\n                )\n              ]\n            )\n          ])\n        ],\n        1\n      )\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeInfo.vue?vue&type=template&id=95be7ed0&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"Field Toggle grid-x\",\n      class: _vm.class_object,\n      on: { contextmenu: _vm.on_contextmenu }\n    },\n    [\n      _c(\"div\", { staticClass: \"cell shrink\" }, [\n        _c(\"input\", {\n          attrs: { type: \"checkbox\", tabindex: _vm.tabindex },\n          domProps: { checked: _vm.value },\n          on: { change: _vm.on_checkbox_update }\n        })\n      ]),\n      _c(\n        \"div\",\n        { staticClass: \"cell auto\" },\n        [\n          _vm.is_field_visible\n            ? _c(\"Numeric\", {\n                attrs: {\n                  json_param: _vm.json_param,\n                  displays_expression_result: _vm.displays_expression_result,\n                  tabindex: _vm.tabindex + 1\n                }\n              })\n            : _c(\n                \"label\",\n                {\n                  staticClass: \"disable-select\",\n                  on: { click: _vm.toggle_param }\n                },\n                [_vm._v(_vm._s(_vm.name))]\n              )\n        ],\n        1\n      )\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Boolean.vue?vue&type=template&id=142cc982&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"Field Numeric\",\n      class: _vm.class_object,\n      on: { contextmenu: _vm.on_contextmenu }\n    },\n    [\n      _c(\"input\", {\n        staticClass: \"raw_input\",\n        class: _vm.input_value_class_object,\n        attrs: {\n          type: \"text\",\n          title: _vm.error_message,\n          tabindex: _vm.tabindex\n        },\n        domProps: { value: _vm.raw_input },\n        on: {\n          keypress: function($event) {\n            $event.stopPropagation()\n          },\n          keyup: function($event) {\n            $event.stopPropagation()\n            return _vm.on_keyup($event)\n          },\n          keydown: function($event) {\n            $event.stopPropagation()\n          },\n          change: function($event) {\n            $event.stopPropagation()\n            return _vm.on_update_value($event)\n          },\n          blur: function($event) {\n            $event.stopPropagation()\n            return _vm.on_update_value($event)\n          },\n          mousedown: _vm.open_numeric_slider,\n          paste: _vm.on_paste,\n          click: function($event) {\n            if (!$event.ctrlKey) {\n              return null\n            }\n            return _vm.reset_to_default($event)\n          }\n        }\n      }),\n      _c(\"input\", {\n        staticClass: \"expression_result\",\n        attrs: {\n          readonly: \"\",\n          type: \"text\",\n          title: _vm.value,\n          tabindex: _vm.tabindex\n        },\n        domProps: { value: _vm.value }\n      })\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Numeric.vue?vue&type=template&id=f4ad0432&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"Field Button\" }, [\n    _c(\n      \"button\",\n      {\n        staticClass: \"button expanded\",\n        attrs: { tabindex: _vm.tabindex },\n        on: {\n          click: function($event) {\n            $event.preventDefault()\n            return _vm.on_click($event)\n          }\n        }\n      },\n      [_vm._v(_vm._s(_vm.json_param.name))]\n    )\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=template&id=7c9511c8&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"Field Multiple Color grid-x\" }, [\n    _c(\"div\", { staticClass: \"cell shrink\" }, [\n      _c(\"input\", {\n        directives: [\n          {\n            name: \"model\",\n            rawName: \"v-model\",\n            value: _vm.input_color,\n            expression: \"input_color\"\n          }\n        ],\n        attrs: {\n          type: \"color\",\n          name: \"color_input_name\",\n          tabindex: _vm.tabindex + 1\n        },\n        domProps: { value: _vm.input_color },\n        on: {\n          input: function($event) {\n            if ($event.target.composing) {\n              return\n            }\n            _vm.input_color = $event.target.value\n          }\n        }\n      })\n    ]),\n    _c(\"div\", { staticClass: \"cell auto\" }, [\n      _c(\n        \"div\",\n        { staticClass: \"grid-x\" },\n        _vm._l(_vm.json_components, function(json_component, i) {\n          return _c(\n            \"div\",\n            { key: i, staticClass: \"cell\", class: _vm.cell_class_object },\n            [\n              _c(\"Numeric\", {\n                attrs: {\n                  json_param: json_component,\n                  displays_expression_result: _vm.displays_expression_result,\n                  tabindex: _vm.tabindex + 1 + i\n                }\n              })\n            ],\n            1\n          )\n        }),\n        0\n      )\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Color.vue?vue&type=template&id=26198086&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"Field Float\",\n      class: _vm.class_object,\n      on: { contextmenu: _vm.on_contextmenu }\n    },\n    [\n      _c(\"div\", { staticClass: \"grid-x\" }, [\n        _c(\"div\", { staticClass: \"cell auto\" }, [\n          _c(\"input\", {\n            staticClass: \"raw_input\",\n            class: _vm.input_value_class_object,\n            attrs: {\n              type: \"text\",\n              title: _vm.error_message,\n              tabindex: _vm.tabindex\n            },\n            domProps: { value: _vm.raw_input },\n            on: {\n              keypress: function($event) {\n                $event.stopPropagation()\n              },\n              keyup: function($event) {\n                $event.stopPropagation()\n                return _vm.on_keyup($event)\n              },\n              keydown: function($event) {\n                $event.stopPropagation()\n              },\n              change: function($event) {\n                $event.stopPropagation()\n                return _vm.on_update_value($event)\n              },\n              focus: function($event) {\n                $event.stopPropagation()\n                return _vm.on_focus($event)\n              },\n              blur: function($event) {\n                $event.stopPropagation()\n                return _vm.on_blur($event)\n              },\n              mousedown: _vm.open_numeric_slider,\n              paste: _vm.on_paste,\n              click: function($event) {\n                if (!$event.ctrlKey) {\n                  return null\n                }\n                return _vm.reset_to_default($event)\n              }\n            }\n          }),\n          _c(\"input\", {\n            staticClass: \"expression_result\",\n            attrs: {\n              readonly: \"\",\n              type: \"text\",\n              title: _vm.value,\n              tabindex: _vm.tabindex\n            },\n            domProps: { value: _vm.value }\n          })\n        ]),\n        _vm.display_slider\n          ? _c(\"div\", { staticClass: \"cell small-10 slider_container\" }, [\n              _c(\"input\", {\n                attrs: {\n                  type: \"range\",\n                  min: _vm.param_range[0],\n                  max: _vm.param_range[1],\n                  step: _vm.slider_step\n                },\n                domProps: { value: _vm.value },\n                on: {\n                  mousedown: _vm.on_slider_mousedown,\n                  mouseup: _vm.on_slider_mouseup,\n                  change: _vm.on_slider_change,\n                  input: _vm.on_slider_drag\n                }\n              })\n            ])\n          : _vm._e()\n      ])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Float.vue?vue&type=template&id=0defe394&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"Field Folder\" })\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Folder.vue?vue&type=template&id=35db0904&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"Field Integer\",\n      class: _vm.class_object,\n      on: { contextmenu: _vm.on_contextmenu }\n    },\n    [\n      _c(\"div\", { staticClass: \"grid-x\" }, [\n        _c(\"div\", { staticClass: \"cell auto\" }, [\n          _c(\"input\", {\n            staticClass: \"raw_input\",\n            class: _vm.input_value_class_object,\n            attrs: {\n              type: \"text\",\n              title: _vm.error_message,\n              tabindex: _vm.tabindex\n            },\n            domProps: { value: _vm.raw_input },\n            on: {\n              keypress: function($event) {\n                $event.stopPropagation()\n              },\n              keyup: function($event) {\n                $event.stopPropagation()\n                return _vm.on_keyup($event)\n              },\n              keydown: function($event) {\n                $event.stopPropagation()\n              },\n              change: function($event) {\n                $event.stopPropagation()\n                return _vm.on_update_value($event)\n              },\n              focus: function($event) {\n                $event.stopPropagation()\n                return _vm.on_focus($event)\n              },\n              blur: function($event) {\n                $event.stopPropagation()\n                return _vm.on_blur($event)\n              },\n              mousedown: _vm.open_numeric_slider,\n              paste: _vm.on_paste,\n              click: function($event) {\n                if (!$event.ctrlKey) {\n                  return null\n                }\n                return _vm.reset_to_default($event)\n              }\n            }\n          }),\n          _c(\"input\", {\n            staticClass: \"expression_result\",\n            attrs: {\n              readonly: \"\",\n              type: \"text\",\n              title: _vm.value,\n              tabindex: _vm.tabindex\n            },\n            domProps: { value: _vm.value }\n          })\n        ]),\n        _vm.display_slider\n          ? _c(\"div\", { staticClass: \"cell small-10 slider_container\" }, [\n              _c(\"input\", {\n                attrs: {\n                  type: \"range\",\n                  min: _vm.param_range[0],\n                  max: _vm.param_range[1],\n                  step: _vm.slider_step\n                },\n                domProps: { value: _vm.value },\n                on: {\n                  mousedown: _vm.on_slider_mousedown,\n                  mouseup: _vm.on_slider_mouseup,\n                  change: _vm.on_slider_change,\n                  input: _vm.on_slider_drag\n                }\n              })\n            ])\n          : _vm._e()\n      ])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Integer.vue?vue&type=template&id=9dab38d0&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"Field OperatorPath\",\n      class: _vm.class_object,\n      on: { contextmenu: _vm.on_contextmenu }\n    },\n    [\n      _c(\"div\", { staticClass: \"grid-x\" }, [\n        _c(\"div\", { staticClass: \"cell auto\" }, [\n          _c(\"input\", {\n            staticClass: \"raw_input\",\n            class: _vm.input_value_class_object,\n            attrs: {\n              type: \"text\",\n              title: _vm.error_message,\n              tabindex: _vm.tabindex\n            },\n            domProps: { value: _vm.raw_input },\n            on: {\n              keypress: function($event) {\n                $event.stopPropagation()\n              },\n              keyup: function($event) {\n                $event.stopPropagation()\n              },\n              keydown: function($event) {\n                $event.stopPropagation()\n              },\n              change: function($event) {\n                $event.stopPropagation()\n                return _vm.on_update_value($event)\n              },\n              blue: function($event) {\n                $event.stopPropagation()\n                return _vm.on_update_value($event)\n              }\n            }\n          }),\n          _c(\"input\", {\n            staticClass: \"expression_result\",\n            attrs: { readonly: \"\", type: \"text\", tabindex: _vm.tabindex },\n            domProps: { value: _vm.value }\n          })\n        ]),\n        _c(\"div\", { staticClass: \"cell shrink\" }, [\n          _c(\"div\", { staticClass: \"button-group\" }, [\n            _c(\n              \"div\",\n              {\n                staticClass: \"button tiny primary\",\n                attrs: { title: \"go to node\" },\n                on: { click: _vm.go_to_node }\n              },\n              [_c(\"v-icon\", { attrs: { name: \"angle-double-right\" } })],\n              1\n            ),\n            _c(\n              \"div\",\n              {\n                staticClass: \"button tiny warning\",\n                attrs: { title: \"select node\" },\n                on: { click: _vm.open_node_selector }\n              },\n              [_c(\"v-icon\", { attrs: { name: \"align-left\" } })],\n              1\n            )\n          ])\n        ])\n      ])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OperatorPath.vue?vue&type=template&id=26d7e102&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"Field Radio\" }, [\n    _c(\"div\", { staticClass: \"radio_inputs_container\" }, [\n      _c(\n        \"select\",\n        {\n          ref: \"select\",\n          staticClass: \"select\",\n          attrs: { tabindex: _vm.tabindex },\n          on: { change: _vm.set_from_select }\n        },\n        _vm._l(_vm.entries, function(entry, i) {\n          return _c(\n            \"option\",\n            {\n              key: i,\n              domProps: { value: entry.value, selected: _vm.selected_states[i] }\n            },\n            [_vm._v(_vm._s(entry.name))]\n          )\n        }),\n        0\n      )\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Radio.vue?vue&type=template&id=3d0c1855&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm._m(0)\n}\nvar staticRenderFns = [\n  function() {\n    var _vm = this\n    var _h = _vm.$createElement\n    var _c = _vm._self._c || _h\n    return _c(\"div\", { staticClass: \"Field Separator\" }, [\n      _c(\"div\", { staticClass: \"horizontal-border\" })\n    ])\n  }\n]\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Separator.vue?vue&type=template&id=e1dc1d82&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"Field String\",\n      class: _vm.class_object,\n      on: { contextmenu: _vm.on_contextmenu }\n    },\n    [\n      _vm.is_single_line\n        ? _c(\"div\", { staticClass: \"single_line_inputs_container\" }, [\n            _c(\"div\", { staticClass: \"grid-x\" }, [\n              _c(\"div\", { staticClass: \"cell auto\" }, [\n                _c(\"input\", {\n                  staticClass: \"raw_input\",\n                  attrs: { type: \"text\", tabindex: _vm.tabindex },\n                  domProps: { value: _vm.raw_input },\n                  on: {\n                    keypress: function($event) {\n                      $event.stopPropagation()\n                    },\n                    keyup: function($event) {\n                      $event.stopPropagation()\n                    },\n                    keydown: function($event) {\n                      $event.stopPropagation()\n                    },\n                    change: function($event) {\n                      $event.stopPropagation()\n                      return _vm.on_update_value($event)\n                    },\n                    blur: function($event) {\n                      $event.stopPropagation()\n                      return _vm.on_update_value($event)\n                    }\n                  }\n                }),\n                _c(\"input\", {\n                  staticClass: \"expression_result\",\n                  attrs: { readonly: \"\", type: \"text\", tabindex: _vm.tabindex },\n                  domProps: { value: _vm.value }\n                })\n              ]),\n              _vm.display_browse_button\n                ? _c(\"div\", { staticClass: \"cell shrink\" }, [\n                    _c(\n                      \"div\",\n                      {\n                        staticClass: \"button browse_button\",\n                        on: { click: _vm.browse_file }\n                      },\n                      [_vm._v(\"Browse Files\")]\n                    )\n                  ])\n                : _vm._e()\n            ])\n          ])\n        : _c(\"div\", { staticClass: \"multiline_inputs_container\" }, [\n            _c(\n              \"textarea\",\n              {\n                staticClass: \"value\",\n                attrs: { rows: _vm.rows, tabindex: _vm.tabindex },\n                on: {\n                  keypress: function($event) {\n                    $event.stopPropagation()\n                  },\n                  keyup: function($event) {\n                    $event.stopPropagation()\n                  },\n                  keydown: function($event) {\n                    $event.stopPropagation()\n                  },\n                  change: function($event) {\n                    $event.stopPropagation()\n                    return _vm.on_update_value($event)\n                  },\n                  blur: function($event) {\n                    $event.stopPropagation()\n                    return _vm.on_update_value($event)\n                  }\n                }\n              },\n              [_vm._v(_vm._s(_vm.raw_input))]\n            ),\n            _c(\n              \"textarea\",\n              {\n                staticClass: \"expression_result\",\n                attrs: { rows: _vm.rows, tabindex: _vm.tabindex, readonly: \"\" }\n              },\n              [_vm._v(_vm._s(_vm.result))]\n            )\n          ])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./String.vue?vue&type=template&id=0972c327&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"Field Multiple Vector grid-x\" },\n    _vm._l(_vm.json_components, function(json_component, i) {\n      return _c(\n        \"div\",\n        { key: i, staticClass: \"cell\", class: _vm.cell_class_object },\n        [\n          _c(\"Numeric\", {\n            attrs: {\n              json_param: json_component,\n              displays_expression_result: _vm.displays_expression_result,\n              tabindex: _vm.tabindex + i\n            }\n          })\n        ],\n        1\n      )\n    }),\n    0\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector2.vue?vue&type=template&id=bc988dae&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"Field Multiple Vector grid-x\" },\n    _vm._l(_vm.json_components, function(json_component, i) {\n      return _c(\n        \"div\",\n        { key: i, staticClass: \"cell\", class: _vm.cell_class_object },\n        [\n          _c(\"Numeric\", {\n            attrs: {\n              json_param: json_component,\n              displays_expression_result: _vm.displays_expression_result,\n              tabindex: _vm.tabindex + i\n            }\n          })\n        ],\n        1\n      )\n    }),\n    0\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector3.vue?vue&type=template&id=bc7c5eac&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"Field Multiple Vector grid-x\" },\n    _vm._l(_vm.json_components, function(json_component, i) {\n      return _c(\n        \"div\",\n        { key: i, staticClass: \"cell\", class: _vm.cell_class_object },\n        [\n          _c(\"Numeric\", {\n            attrs: {\n              json_param: json_component,\n              displays_expression_result: _vm.displays_expression_result,\n              tabindex: _vm.tabindex + i\n            }\n          })\n        ],\n        1\n      )\n    }),\n    0\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector4.vue?vue&type=template&id=bc602faa&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"Field Ramp\",\n      class: _vm.class_object,\n      on: { contextmenu: _vm.on_contextmenu }\n    },\n    [\n      _c(\"div\", { staticClass: \"grid-x\" }, [\n        _c(\"div\", { staticClass: \"cell auto\" }, [\n          _c(\"div\", { staticClass: \"points_container\" }, [\n            _c(\n              \"svg\",\n              { ref: \"svg\", on: { click: _vm.add_point } },\n              [\n                _vm._l(_vm.curve_points, function(curve_point, i) {\n                  return _c(\"circle\", {\n                    staticClass: \"interpolated_curve_point\",\n                    class: _vm.interpolated_curve_class_object,\n                    attrs: {\n                      cx: _vm.curve_point_positions_percent[i],\n                      cy: _vm.curve_point_values_percent[i]\n                    }\n                  })\n                }),\n                _vm._l(_vm.ramp_points, function(ramp_point, i) {\n                  return _c(\"circle\", {\n                    staticClass: \"control_point\",\n                    class: _vm.control_point_class_objects[i],\n                    attrs: {\n                      cx: _vm.control_point_positions_percent[i],\n                      cy: _vm.control_point_values_percent[i]\n                    },\n                    on: {\n                      mousedown: function($event) {\n                        $event.stopPropagation()\n                        return _vm.on_point_move_start($event, i)\n                      },\n                      click: function($event) {\n                        $event.stopPropagation()\n                      }\n                    }\n                  })\n                })\n              ],\n              2\n            )\n          ])\n        ])\n      ])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ramp.vue?vue&type=template&id=d48a23b0&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"NetworkNodeInfoSop\" },\n    [\n      _c(\"div\", { staticClass: \"node_info_sop_section inline objects_count\" }, [\n        _c(\"div\", { staticClass: \"node_info_sop_section_title\" }, [\n          _vm._v(\"objects count:\")\n        ]),\n        _c(\"div\", { staticClass: \"node_info_sop_section_content\" }, [\n          _c(\"span\", [_vm._v(_vm._s(_vm.objects_count))]),\n          _c(\n            \"span\",\n            {\n              staticClass: \"objects_count_visible\",\n              class: _vm.objects_count_visible_class_object\n            },\n            [_vm._v(\"(visible: \" + _vm._s(_vm.objects_visible_count) + \")\")]\n          )\n        ])\n      ]),\n      _vm._l(_vm.object_types, function(object_type) {\n        return _c(\n          \"div\",\n          { staticClass: \"node_info_sop_section inline objects_types\" },\n          [\n            _c(\"div\", { staticClass: \"node_info_sop_section_title\" }, [\n              _vm._v(_vm._s(object_type) + \":\")\n            ]),\n            _c(\"div\", { staticClass: \"node_info_sop_section_content\" }, [\n              _c(\"span\", [\n                _vm._v(_vm._s(_vm.objects_count_by_type[object_type]))\n              ])\n            ])\n          ]\n        )\n      }),\n      _c(\"div\", { staticClass: \"node_info_sop_section inline points_count\" }, [\n        _c(\"div\", { staticClass: \"node_info_sop_section_title\" }, [\n          _vm._v(\"points count:\")\n        ]),\n        _c(\"div\", { staticClass: \"node_info_sop_section_content\" }, [\n          _vm._v(_vm._s(_vm.points_count))\n        ])\n      ]),\n      _c(\"div\", { staticClass: \"node_info_separator\" }),\n      _c(\"div\", { staticClass: \"node_info_separator\" }),\n      _c(\n        \"div\",\n        { staticClass: \"node_info_sop_section attributes block\" },\n        [\n          _c(\"strong\", { staticClass: \"node_info_sop_section_title\" }, [\n            _vm._v(\"vertex attributes:\")\n          ]),\n          _vm._l(_vm.vertex_attribute_names, function(name) {\n            return _c(\n              \"div\",\n              {\n                staticClass: \"node_info_sop_section_content attribute_info\",\n                class: _vm.vertex_class_objects_by_name[name]\n              },\n              [\n                _vm._v(\n                  _vm._s(name) +\n                    \" (\" +\n                    _vm._s(_vm.vertex_human_labels_by_name[name]) +\n                    \")\"\n                )\n              ]\n            )\n          })\n        ],\n        2\n      ),\n      _c(\"div\", { staticClass: \"bbox_infos\" }, [\n        _c(\n          \"table\",\n          _vm._l(_vm.table_prop_names, function(prop_name) {\n            return _c(\n              \"tr\",\n              [\n                _c(\"td\", [_vm._v(_vm._s(prop_name))]),\n                _vm._l([0, 1, 2], function(j) {\n                  return _c(\"td\", { staticClass: \"number\" }, [\n                    _vm._v(_vm._s(_vm.table_props[prop_name][j]))\n                  ])\n                })\n              ],\n              2\n            )\n          }),\n          0\n        )\n      ])\n    ],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sop.vue?vue&type=template&id=030db833&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NetworkNodeInfoMat\" }, [\n    _c(\n      \"div\",\n      { staticClass: \"buttons\" },\n      _vm._l(_vm.shader_names, function(shader_name, i) {\n        return _c(\n          \"div\",\n          {\n            staticClass: \"button expanded\",\n            on: {\n              click: function($event) {\n                return _vm.copy_shader(shader_name)\n              }\n            }\n          },\n          [_vm._v(\"Copy \" + _vm._s(shader_name) + \" Shader\")]\n        )\n      }),\n      0\n    )\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mat.vue?vue&type=template&id=a4064c02&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NetworkNodeInfoGl\" }, [\n    _c(\n      \"div\",\n      { staticClass: \"buttons\" },\n      _vm._l(_vm.shader_names, function(shader_name, i) {\n        return _c(\n          \"div\",\n          {\n            staticClass: \"button expanded\",\n            on: {\n              click: function($event) {\n                return _vm.copy_shader(shader_name)\n              }\n            }\n          },\n          [_vm._v(\"Copy Shader \" + _vm._s(shader_name))]\n        )\n      }),\n      0\n    )\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Gl.vue?vue&type=template&id=4a5893d4&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NetworkNodeInfoCop\" }, [\n    _vm.resolution\n      ? _c(\"div\", { staticClass: \"node_info_cop_section inline resolution\" }, [\n          _c(\"div\", { staticClass: \"node_info_cop_section_title\" }, [\n            _vm._v(\"resolution:\")\n          ]),\n          _c(\"div\", { staticClass: \"node_info_cop_section_content\" }, [\n            _c(\"span\", [_vm._v(_vm._s(_vm.resolution))])\n          ])\n        ])\n      : _vm._e(),\n    _c(\"div\", { staticClass: \"node_info_cop_section\" }, [\n      _c(\"canvas\", { ref: \"canvas\" })\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cop.vue?vue&type=template&id=96abf7ba&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NetworkNodeInfoSopCache\" }, [\n    _c(\"div\", { staticClass: \"buttons\" }, [\n      _c(\n        \"div\",\n        { staticClass: \"button expanded\", on: { click: _vm.copy_cache } },\n        [_vm._v(\"Copy Cache\")]\n      )\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopCache.vue?vue&type=template&id=2685343f&lang=pug&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"NetworkNodeInfoSopParticlesSystemGPU\" }, [\n    _c(\n      \"div\",\n      { staticClass: \"buttons\" },\n      _vm._l(_vm.shader_names, function(shader_name, i) {\n        return _c(\n          \"div\",\n          {\n            staticClass: \"button expanded\",\n            on: {\n              click: function($event) {\n                return _vm.copy_shader(shader_name)\n              }\n            }\n          },\n          [_vm._v(\"Copy Shader \" + _vm._s(shader_name))]\n        )\n      }),\n      0\n    )\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","export * from \"-!../../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../node_modules/pug-plain-loader/index.js??ref--3!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopParticlesSystemGPU.vue?vue&type=template&id=38091b63&lang=pug&\"","import Vue from 'vue';\n\n// Vue composition api\nimport VueCompositionApi from '@vue/composition-api';\nVue.use(VueCompositionApi);\n\n// from https://github.com/vuejs/composition-api README\ndeclare module '@vue/composition-api/dist/component/component' {\n\tinterface SetupContext {\n\t\treadonly refs: {[key: string]: Vue | Element | Vue[] | Element[]};\n\t}\n}\nVue.config.productionTip = false;\n\n// Vuex\nimport Vuex from 'vuex';\nVue.use(Vuex);\nimport {EditorStore} from './store/Store';\nimport {StoreController} from './store/controllers/StoreController';\nif (EditorStore) {\n\tStoreController.set_store(EditorStore);\n} else {\n\tconsole.warn('store not ready for StoreController');\n}\n\n// icons\nimport './components/Icons';\n\n// to ensure that .vue components are loaded, see tips in webpack config\n// the still remaining issue is that when the file path is wrong, there is no warning in the editor\n// and the error message can be confusing\nimport EditorComponent from './components/editor/Editor.vue';\n\nimport 'src/engine/poly/registers/All';\n\nimport {SceneJsonExporterData} from 'src/engine/io/json/export/Scene';\nimport {SceneJsonImporter} from 'src/engine/io/json/import/Scene';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\n\ntype OnSaveCallback = (json: SceneJsonExporterData) => void;\n\nexport interface EditorProps {\n\tscene_update_allowed?: boolean;\n\tcurrent_node?: string;\n\tselected?: string;\n\tperf?: boolean;\n\tplay?: boolean;\n}\n\nexport class Editor {\n\tstatic _instance: Editor;\n\tprivate _loaded: boolean = false;\n\tprivate _on_save_callback: OnSaveCallback | undefined;\n\tprivate constructor() {}\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new Editor());\n\t}\n\n\tstatic async load_scene(element_or_id: HTMLElement | string, json: SceneJsonExporterData, props: EditorProps = {}) {\n\t\treturn await this.instance().load_scene(element_or_id, json, props);\n\t}\n\tstatic on_save(callback: OnSaveCallback) {\n\t\tthis.instance().set_on_save_callback(callback);\n\t}\n\n\tset_on_save_callback(callback: OnSaveCallback) {\n\t\tthis._on_save_callback = callback;\n\t}\n\tget on_save_callback() {\n\t\treturn this._on_save_callback;\n\t}\n\n\tasync load_scene(element_or_id: HTMLElement | string, json: SceneJsonExporterData, props: EditorProps) {\n\t\tif (this._loaded) {\n\t\t\treturn;\n\t\t}\n\t\tthis._loaded = true;\n\n\t\tconst scene: PolyScene = await SceneJsonImporter.load_data(json);\n\t\tStoreController.set_scene(scene);\n\t\t(window as any).scene = scene;\n\n\t\tif (props.current_node) {\n\t\t\tconst node = scene.node(props.current_node);\n\t\t\tif (node) {\n\t\t\t\tStoreController.editor.set_current_node(node);\n\t\t\t\tif (props.selected) {\n\t\t\t\t\tconst child_node = node.node(props.selected);\n\t\t\t\t\tif (child_node) {\n\t\t\t\t\t\tnode.children_controller?.selection.set([child_node]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(`child node '${props.selected}' not found for selected option`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.warn(`node '${props.current_node}' not found for current_node option`);\n\t\t\t}\n\t\t}\n\n\t\tnew Vue({\n\t\t\tel: element_or_id,\n\t\t\tstore: EditorStore,\n\t\t\trender: (createElement, props) => {\n\t\t\t\treturn createElement(EditorComponent, {\n\t\t\t\t\tprops: props,\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n}\n","import lodash_compact from 'lodash/compact';\nimport lodash_values from 'lodash/values';\nimport Vue from 'vue';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {StoreController} from '../controllers/StoreController';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\n\n// import {SceneJsonExporterData} from 'src/engine/io/json/export/Scene';\nimport {NodeSerializerData} from 'src/engine/nodes/utils/Serializer';\nimport {ParamSerializerData} from 'src/engine/params/utils/Serializer';\n// import {BaseParamType} from 'src/engine/params/_Base';\n\nexport type EngineNodeData = NodeSerializerData;\nexport type EngineParamData = ParamSerializerData;\nexport interface EngineState {\n\tscene_uuid: string | undefined;\n\tnodes_by_graph_node_id: Dictionary<EngineNodeData>;\n\tparams_by_graph_node_id: Dictionary<EngineParamData>;\n\tframe: number;\n\tframe_range: Number2;\n\tframe_range_locked: Boolean2;\n\tfps: number;\n\tplaying_state: boolean;\n}\n\nexport enum EngineMutation {\n\t// scene\n\tSCENE = 'SCENE',\n\tSCENE_FRAME_UPDATED = 'SCENE_FRAME_UPDATED',\n\tSCENE_FRAME_RANGE_UPDATED = 'SCENE_FRAME_RANGE_UPDATED',\n\tSCENE_PLAY_STATE_UPDATED = 'SCENE_PLAY_STATE_UPDATED',\n\t// node\n\tNODE_ERROR_UPDATED = 'NODE_ERROR_UPDATED',\n\tNODE_UI_DATA_POSITION_UPDATED = 'NODE_UI_DATA_POSITION_UPDATED',\n\tNODE_UI_DATA_COMMENT_UPDATED = 'NODE_UI_DATA_COMMENT_UPDATED',\n\tNODE_SELECTION_UPDATED = 'NODE_SELECTION_UPDATED',\n\tNODE_DISPLAY_FLAG_UPDATED = 'NODE_DISPLAY_FLAG_UPDATED',\n\tNODE_BYPASS_FLAG_UPDATED = 'NODE_BYPASS_FLAG_UPDATED',\n\tNODE_NAME_UPDATED = 'NODE_NAME_UPDATED',\n\tNODE_INPUTS_UPDATED = 'NODE_INPUTS_UPDATED',\n\tNODE_NAMED_INPUTS_UPDATED = 'NODE_NAMED_INPUTS_UPDATED',\n\tNODE_NAMED_OUTPUTS_UPDATED = 'NODE_NAMED_OUTPUTS_UPDATED',\n\tNODE_ADD_PARAMS_TO_STORE = 'NODE_ADD_PARAMS_TO_STORE',\n\tNODE_PARAMS_UPDATED = 'NODE_PARAMS_UPDATED',\n\tNODE_CREATED = 'NODE_CREATED',\n\tNODE_DELETED = 'NODE_DELETED',\n\t// param\n\tPARAM_RAW_INPUT_UPDATED = 'PARAM_RAW_INPUT_UPDATED',\n\tPARAM_VALUE_UPDATED = 'PARAM_VALUE_UPDATED',\n\tPARAM_EXPRESSION_UPDATED = 'PARAM_EXPRESSION_UPDATED',\n\tPARAM_ERROR_UPDATED = 'PARAM_ERROR_UPDATED',\n\tPARAM_VISIBLE_STATE = 'PARAM_VISIBLE_STATE',\n}\ntype EnginePayloadByMutationMapGeneric = {[key in EngineMutation]: any};\nexport interface EnginePayloadByMutationMap extends EnginePayloadByMutationMapGeneric {\n\t// scene\n\t[EngineMutation.SCENE]: undefined;\n\t[EngineMutation.SCENE_FRAME_UPDATED]: undefined;\n\t[EngineMutation.SCENE_FRAME_RANGE_UPDATED]: undefined;\n\t[EngineMutation.SCENE_PLAY_STATE_UPDATED]: undefined;\n\t// node\n\t[EngineMutation.NODE_ERROR_UPDATED]: string;\n\t[EngineMutation.NODE_UI_DATA_POSITION_UPDATED]: string;\n\t[EngineMutation.NODE_UI_DATA_COMMENT_UPDATED]: string;\n\t[EngineMutation.NODE_SELECTION_UPDATED]: string;\n\t[EngineMutation.NODE_DISPLAY_FLAG_UPDATED]: string;\n\t[EngineMutation.NODE_BYPASS_FLAG_UPDATED]: string;\n\t[EngineMutation.NODE_NAME_UPDATED]: string;\n\t[EngineMutation.NODE_INPUTS_UPDATED]: string;\n\t[EngineMutation.NODE_ADD_PARAMS_TO_STORE]: string;\n\t[EngineMutation.NODE_PARAMS_UPDATED]: string;\n\t[EngineMutation.NODE_CREATED]: {\n\t\tparent_id: string;\n\t\tchild_node_json: EngineNodeData;\n\t};\n\t[EngineMutation.NODE_DELETED]: {\n\t\tparent_id: string;\n\t\tchild_id: string;\n\t};\n\t// param\n\t[EngineMutation.PARAM_RAW_INPUT_UPDATED]: string;\n\t[EngineMutation.PARAM_VALUE_UPDATED]: string;\n\t[EngineMutation.PARAM_EXPRESSION_UPDATED]: string;\n\t[EngineMutation.PARAM_ERROR_UPDATED]: string;\n\t[EngineMutation.PARAM_VISIBLE_STATE]: string;\n}\n\n// actions payloads\n// interface EnginePayloadUpdateChildren {\n// \tjson_node: EngineNodeData;\n// \tchildren_ids: string[];\n// }\ninterface EnginePayloadNodeEmitter {\n\temitter: BaseNodeType;\n}\n// interface EnginePayloadParamEmitter {\n// \temitter: BaseParamType;\n// }\n// interface EnginePayloadNodeDeleted {\n// \temitter: BaseNodeType;\n// \tdata: {\n// \t\tparent: BaseNodeType;\n// \t};\n// }\n// interface EnginePayloadNodeCreated {\n// \temitter: BaseNodeType;\n// \tdata: {\n// \t\tchild_node: BaseNodeType;\n// \t};\n// }\n\nconst store_json_node = (state: EngineState, node: BaseNodeType) => state.nodes_by_graph_node_id[node.graph_node_id];\n// window.store_json_param= (state, param)->\n// \tstate.params_by_graph_node_id[param.graph_node_id()]\n\nfunction update_node_inputs_and_outputs(state: EngineState, node_id: string) {\n\tconst node = StoreController.engine.node(node_id);\n\tif (node) {\n\t\tconst json_node = store_json_node(state, node);\n\t\tif (json_node) {\n\t\t\tVue.set(json_node, 'inputs', node.serializer.input_ids());\n\t\t\tVue.set(json_node, 'input_connection_output_indices', node.serializer.connection_input_indices());\n\t\t\tVue.set(json_node, 'named_input_connections', node.serializer.named_input_connections());\n\t\t\tVue.set(json_node, 'named_output_connections', node.serializer.named_output_connections());\n\t\t}\n\t}\n}\n\nexport const EngineStoreModule = {\n\tnamespaced: true,\n\tstate(): EngineState {\n\t\treturn {\n\t\t\tscene_uuid: undefined,\n\t\t\tnodes_by_graph_node_id: {},\n\t\t\tparams_by_graph_node_id: {},\n\t\t\tframe: 0,\n\t\t\tframe_range: [0, 10],\n\t\t\tframe_range_locked: [true, true],\n\t\t\tfps: 30,\n\t\t\tplaying_state: false,\n\t\t};\n\t},\n\n\tgetters: {\n\t\tframe(state: EngineState) {\n\t\t\treturn state.frame;\n\t\t},\n\t\tframe_range(state: EngineState) {\n\t\t\treturn state.frame_range;\n\t\t},\n\t\tframe_range_locked(state: EngineState) {\n\t\t\treturn state.frame_range_locked;\n\t\t},\n\t\tfps(state: EngineState) {\n\t\t\treturn state.fps;\n\t\t},\n\t\tplaying_state(state: EngineState) {\n\t\t\treturn state.playing_state;\n\t\t},\n\t\tjson_node(state: EngineState) {\n\t\t\treturn (graph_node_id: string) => state.nodes_by_graph_node_id[graph_node_id];\n\t\t},\n\t\tjson_param(state: EngineState) {\n\t\t\treturn (graph_node_id: string) => state.params_by_graph_node_id[graph_node_id];\n\t\t},\n\t\tjson_nodes_by_name(state: EngineState) {\n\t\t\treturn (node_name: string) =>\n\t\t\t\tlodash_values(state.nodes_by_graph_node_id).filter((json_node) => json_node.name === node_name);\n\t\t},\n\n\t\tjson_root(state: EngineState) {\n\t\t\tconst scene: PolyScene = StoreController.scene;\n\t\t\tconst id = scene.root.graph_node_id;\n\t\t\treturn state.nodes_by_graph_node_id[id];\n\t\t},\n\n\t\tjson_children(state: EngineState) {\n\t\t\treturn function(json_node: EngineNodeData) {\n\t\t\t\tif (json_node) {\n\t\t\t\t\tconst children_ids = json_node.children;\n\t\t\t\t\tconst children = children_ids.map((children_id) => state.nodes_by_graph_node_id[children_id]);\n\n\t\t\t\t\t// check if any resolves to null\n\t\t\t\t\tconst compacted_children = lodash_compact(children);\n\t\t\t\t\tif (compacted_children.length !== children.length) {\n\t\t\t\t\t\tconsole.warn('some children resolved to null in engine/json_children!', children);\n\t\t\t\t\t}\n\t\t\t\t\t// updated_children_ids = lodash_map( compacted_children, (child)->child.graph_node_id )\n\t\t\t\t\t// POLY.store.commit 'engine/json_children_ids',\n\t\t\t\t\t// \tjson_node: json_node\n\t\t\t\t\t// \tchildren_ids: updated_children_ids\n\n\t\t\t\t\treturn compacted_children;\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tjson_params(state: EngineState) {\n\t\t\treturn function(json_node: EngineNodeData) {\n\t\t\t\tif (json_node) {\n\t\t\t\t\tconst param_ids = json_node.param_ids;\n\t\t\t\t\tconst params_data: ParamSerializerData[] = [];\n\t\t\t\t\tfor (let param_id of Object.keys(param_ids)) {\n\t\t\t\t\t\tconst param_data = state.params_by_graph_node_id[param_id];\n\t\t\t\t\t\tif (param_data) {\n\t\t\t\t\t\t\tparams_data.push(param_data);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn params_data;\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\t// json_spare_params(state:EngineState){\n\t\t// \treturn function(json_node:EngineNodeData){\n\t\t// \t\tif (json_node != null) {\n\t\t// \t\t\tlet json_params;\n\t\t// \t\t\tconst param_ids = json_node.spare_params;\n\t\t// \t\t\treturn json_params = lodash_map(param_ids, param_id=> state.params_by_graph_node_id[param_id]);\n\t\t// \t\t} else {\n\t\t// \t\t\treturn [];\n\t\t// \t\t}\n\t\t// \t};\n\t\t// },\n\t\t// json_param_components(state:EngineState){\n\t\t// \treturn function(json_param:){\n\t\t// \t\tif (json_param != null) {\n\t\t// \t\t\tlet json_params;\n\t\t// \t\t\tconst param_ids = json_param.components;\n\t\t// \t\t\treturn json_params = lodash_map(param_ids, param_id=> state.params_by_graph_node_id[param_id]);\n\t\t// \t\t} else {\n\t\t// \t\t\treturn [];\n\t\t// \t\t}\n\t\t// \t};\n\t\t// }\n\t},\n\n\t// TODO:\n\t// on_node_create\n\t// on_param_create (for spare param?)\n\tmutations: {\n\t\t// json_children_ids(state: EngineState, payload: EnginePayloadUpdateChildren) {\n\t\t// \tconst json_node = payload['json_node'];\n\t\t// \tconst children_ids = payload['children_ids'];\n\t\t// \tif (json_node) {\n\t\t// \t\tjson_node['children'] = children_ids;\n\t\t// \t}\n\t\t// },\n\n\t\t//\n\t\t//\n\t\t// Scene Mutations\n\t\t//\n\t\t//\n\t\t[EngineMutation.SCENE]: function(state: EngineState) {\n\t\t\tconst scene = StoreController.scene;\n\t\t\tconst include_node_param_components = false;\n\t\t\tconst nodes_by_graph_node_id: Dictionary<EngineNodeData> = {};\n\t\t\t// for (let node of scene.nodes_controller.all_nodes()) {\n\t\t\t// \tnodes_by_graph_node_id[node.graph_node_id] = node.to_json(include_node_param_components);\n\n\t\t\t// \tconst params = node.params.all; //lodash_compact(lodash_concat( lodash_values(node.params()), lodash_values(node.spare_params()) ));\n\t\t\t// \tfor (let param of params) {\n\t\t\t// \t\tparams_by_graph_node_id[param.graph_node_id] = param.to_json();\n\t\t\t// \t}\n\t\t\t// }\n\t\t\tfor (let node of scene.nodes_controller.all_nodes()) {\n\t\t\t\tnodes_by_graph_node_id[node.graph_node_id] = node.to_json(include_node_param_components);\n\t\t\t}\n\n\t\t\tstate.nodes_by_graph_node_id = nodes_by_graph_node_id;\n\t\t\tstate.params_by_graph_node_id = {}; //json.params_by_graph_node_id;\n\t\t\tstate.frame = scene.frame;\n\t\t\tVue.set(state.frame_range, 0, scene.frame_range[0]);\n\t\t\tVue.set(state.frame_range, 1, scene.frame_range[1]);\n\t\t\tVue.set(state.frame_range_locked, 0, scene.time_controller.frame_range_locked[0]);\n\t\t\tVue.set(state.frame_range_locked, 1, scene.time_controller.frame_range_locked[1]);\n\t\t\tstate.fps = scene.time_controller.fps;\n\t\t\tstate.scene_uuid = scene.uuid;\n\t\t},\n\n\t\t[EngineMutation.SCENE_FRAME_UPDATED]: function(state: EngineState) {\n\t\t\tstate.frame = StoreController.scene.frame;\n\t\t\t// const scene_context = payload['emitter'];\n\t\t\t// return (state.frame = scene_context.frame());\n\t\t},\n\t\t[EngineMutation.SCENE_FRAME_RANGE_UPDATED]: function(state: EngineState) {\n\t\t\tconst scene = StoreController.scene;\n\t\t\tVue.set(state.frame_range, 0, scene.frame_range[0]);\n\t\t\tVue.set(state.frame_range, 1, scene.frame_range[1]);\n\t\t\tVue.set(state.frame_range_locked, 0, scene.time_controller.frame_range_locked[0]);\n\t\t\tVue.set(state.frame_range_locked, 1, scene.time_controller.frame_range_locked[1]);\n\t\t\tstate.fps = scene.time_controller.fps;\n\t\t},\n\n\t\t[EngineMutation.SCENE_PLAY_STATE_UPDATED]: function(state: EngineState) {\n\t\t\tconst scene = StoreController.scene;\n\t\t\t// const scene_context = payload['emitter'];\n\t\t\tstate.playing_state = scene.time_controller.playing;\n\t\t},\n\n\t\t//\n\t\t//\n\t\t// Node Mutations\n\t\t//\n\t\t//\n\n\t\t[EngineMutation.NODE_ERROR_UPDATED]: (\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_ERROR_UPDATED]\n\t\t) => {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tif (node) {\n\t\t\t\tconst json_node = store_json_node(state, node);\n\t\t\t\tjson_node['error_message'] = node.states.error.message;\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.NODE_UI_DATA_POSITION_UPDATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_UI_DATA_POSITION_UPDATED]\n\t\t) {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tif (node) {\n\t\t\t\tconst json_node = store_json_node(state, node);\n\t\t\t\tif (json_node) {\n\t\t\t\t\tjson_node.ui_data_json.x = node.ui_data.position.x;\n\t\t\t\t\tjson_node.ui_data_json.y = node.ui_data.position.y;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.NODE_UI_DATA_COMMENT_UPDATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_UI_DATA_COMMENT_UPDATED]\n\t\t) {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tif (node) {\n\t\t\t\tconst json_node = store_json_node(state, node);\n\t\t\t\tif (json_node) {\n\t\t\t\t\tjson_node.ui_data_json.comment = node.ui_data.comment;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t[EngineMutation.NODE_SELECTION_UPDATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_SELECTION_UPDATED]\n\t\t) {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tif (node && node.children_allowed() && node.children_controller) {\n\t\t\t\tconst json_node = store_json_node(state, node);\n\t\t\t\tif (json_node) {\n\t\t\t\t\tif (json_node.selection) {\n\t\t\t\t\t\twhile (json_node.selection.pop()) {}\n\t\t\t\t\t\tconst new_ids = node.children_controller.selection.to_json();\n\t\t\t\t\t\tfor (let id of new_ids) {\n\t\t\t\t\t\t\tjson_node.selection.push(id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Vue.set(json_node, 'selection', node.children_controller.selection.to_json());\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.NODE_DISPLAY_FLAG_UPDATED](\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_DISPLAY_FLAG_UPDATED]\n\t\t) {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tif (node && node.flags?.display) {\n\t\t\t\tconst json_node = store_json_node(state, node);\n\t\t\t\tif (json_node && json_node.flags?.display != null) {\n\t\t\t\t\tjson_node.flags.display = node.flags.display.active;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t[EngineMutation.NODE_BYPASS_FLAG_UPDATED](\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_BYPASS_FLAG_UPDATED]\n\t\t) {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tif (node && node.flags?.bypass) {\n\t\t\t\tconst json_node = store_json_node(state, node);\n\t\t\t\tif (json_node && json_node.flags?.bypass != null) {\n\t\t\t\t\tjson_node.flags.bypass = node.flags.bypass.active;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.NODE_NAME_UPDATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_NAME_UPDATED]\n\t\t) {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tif (node) {\n\t\t\t\tconst json_node = store_json_node(state, node);\n\t\t\t\tif (json_node) {\n\t\t\t\t\tjson_node.name = node.name;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.NODE_INPUTS_UPDATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_INPUTS_UPDATED]\n\t\t) {\n\t\t\tupdate_node_inputs_and_outputs(state, node_id);\n\t\t},\n\t\t[EngineMutation.NODE_NAMED_INPUTS_UPDATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_NAMED_INPUTS_UPDATED]\n\t\t) {\n\t\t\tupdate_node_inputs_and_outputs(state, node_id);\n\t\t},\n\t\t[EngineMutation.NODE_NAMED_OUTPUTS_UPDATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_NAMED_OUTPUTS_UPDATED]\n\t\t) {\n\t\t\tupdate_node_inputs_and_outputs(state, node_id);\n\t\t},\n\t\t[EngineMutation.NODE_ADD_PARAMS_TO_STORE]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_ADD_PARAMS_TO_STORE]\n\t\t) {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tif (node) {\n\t\t\t\tfor (let param of node.params.all) {\n\t\t\t\t\tif (!state.params_by_graph_node_id[param.graph_node_id]) {\n\t\t\t\t\t\tVue.set(state.params_by_graph_node_id, param.graph_node_id, param.to_json());\n\t\t\t\t\t\tif (param.components) {\n\t\t\t\t\t\t\tfor (let component of param.components) {\n\t\t\t\t\t\t\t\tVue.set(state.params_by_graph_node_id, component.graph_node_id, component.to_json());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.NODE_PARAMS_UPDATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tnode_id: EnginePayloadByMutationMap[EngineMutation.NODE_PARAMS_UPDATED]\n\t\t) {\n\t\t\tconst node = StoreController.engine.node(node_id);\n\t\t\tconst json_node = StoreController.engine.json_node(node_id);\n\t\t\tif (node && json_node) {\n\t\t\t\tfor (let param_id of json_node.param_ids) {\n\t\t\t\t\tVue.delete(state.params_by_graph_node_id, param_id);\n\t\t\t\t}\n\t\t\t\tconst include_node_param_components = false;\n\t\t\t\tVue.set(json_node, 'param_ids', node.serializer.to_json_params(include_node_param_components));\n\t\t\t\tfor (let param of node.params.all) {\n\t\t\t\t\tVue.set(state.params_by_graph_node_id, param.graph_node_id, param.to_json());\n\t\t\t\t\tif (param.components) {\n\t\t\t\t\t\tfor (let component of param.components) {\n\t\t\t\t\t\t\tVue.set(state.params_by_graph_node_id, component.graph_node_id, component.to_json());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\toverride_clonable_state_update(state: EngineState, payload: EnginePayloadNodeEmitter) {\n\t\t\tconst node = payload['emitter'];\n\t\t\tconst json_node = store_json_node(state, node);\n\t\t\tif (json_node) {\n\t\t\t\tjson_node.override_clonable_state = node.io.inputs.override_clonable_state();\n\t\t\t\tjson_node.inputs_clonable_state_with_override = node.io.inputs.inputs_clonable_state_with_override();\n\t\t\t}\n\t\t},\n\n\t\t// node_inputs_updated(state: EngineState, payload: EnginePayloadNodeEmitter) {\n\t\t// \tconst node = payload['emitter'];\n\t\t// \tconst json_node = store_json_node(state, node);\n\t\t// \tif (json_node) {\n\t\t// \t\tconst json = node.to_json();\n\t\t// \t\tjson_node['inputs'] = json['inputs'];\n\t\t// \t\tjson_node['input_connection_output_indices'] = json['input_connection_output_indices'];\n\t\t// \t}\n\t\t// },\n\n\t\t// node_named_inputs_updated(state: EngineState, payload: EnginePayloadNodeEmitter) {\n\t\t// \tconst node = payload['emitter'];\n\t\t// \tconst json_node = store_json_node(state, node);\n\t\t// \tif (json_node) {\n\t\t// \t\tconst json = node.to_json();\n\t\t// \t\tjson_node['named_input_connections'] = json['named_input_connections'];\n\t\t// \t\tjson_node['named_input_connections'] = json['named_input_connections'];\n\t\t// \t}\n\t\t// },\n\n\t\t// node_named_outputs_updated(state: EngineState, payload: EnginePayloadNodeEmitter) {\n\t\t// \tconst node = payload['emitter'];\n\t\t// \tconst json_node = store_json_node(state, node);\n\t\t// \tif (json_node) {\n\t\t// \t\tconst json = node.to_json();\n\t\t// \t\tjson_node['named_output_connections'] = json['named_output_connections'];\n\t\t// \t}\n\t\t// },\n\n\t\t[EngineMutation.NODE_DELETED]: function(\n\t\t\tstate: EngineState,\n\t\t\tpayload: EnginePayloadByMutationMap[EngineMutation.NODE_DELETED]\n\t\t) {\n\t\t\tconst parent_node_id = payload['parent_id'];\n\t\t\tconst parent_data = state.nodes_by_graph_node_id[parent_node_id];\n\t\t\tif (parent_data) {\n\t\t\t\tconst child_id = payload['child_id'];\n\n\t\t\t\tconst index = parent_data.children.indexOf(child_id);\n\t\t\t\tparent_data.children.splice(index, 1);\n\n\t\t\t\tVue.delete(state.nodes_by_graph_node_id, child_id);\n\t\t\t}\n\t\t},\n\n\t\t[EngineMutation.NODE_CREATED]: function(\n\t\t\tstate: EngineState,\n\t\t\tpayload: EnginePayloadByMutationMap[EngineMutation.NODE_CREATED]\n\t\t) {\n\t\t\tconst parent_node_id = payload['parent_id'];\n\t\t\tconst parent_node = StoreController.engine.node(parent_node_id);\n\t\t\tif (parent_node) {\n\t\t\t\tconst child_node_json = payload['child_node_json'];\n\n\t\t\t\tVue.set(state.nodes_by_graph_node_id, child_node_json.graph_node_id, child_node_json);\n\t\t\t\tconst parent_data = state.nodes_by_graph_node_id[parent_node.graph_node_id];\n\t\t\t\tparent_data.children.push(child_node_json.graph_node_id);\n\t\t\t}\n\t\t},\n\n\t\t// node_dirty_updated: (state, payload)->\n\t\t// \tnode = payload['emitter']\n\n\t\t// \tif node? && state.nodes_by_graph_node_id[node.graph_node_id()]?\n\t\t// \t\tstate.nodes_by_graph_node_id[node.graph_node_id()].is_dirty = node.is_dirty()\n\n\t\t// [EngineMutation.PARAM_UPDATED](state: EngineState, payload: EnginePayloadNodeEmitter) {\n\t\t// \t// const node = payload['emitter'];\n\t\t// \t// console.log(\"store:param_updated\", param.full_path())\n\t\t// \t// node.params.all.forEach((param) =>\n\t\t// \t// \tVue.set(state.params_by_graph_node_id, param.graph_node_id, param.to_json())\n\t\t// \t// );\n\t\t// \t// const current = state.nodes_by_graph_node_id[node.graph_node_id];\n\t\t// \t// if (current != null) {\n\t\t// \t// \tVue.set(current, 'params', node.serializer.to_json_params());\n\t\t// \t// \tVue.set(current, 'spare_params', node.serializer.to_json_spare_params());\n\t\t// \t// }\n\t\t// },\n\t\t[EngineMutation.PARAM_RAW_INPUT_UPDATED](\n\t\t\tstate: EngineState,\n\t\t\tparam_id: EnginePayloadByMutationMap[EngineMutation.PARAM_RAW_INPUT_UPDATED]\n\t\t) {\n\t\t\tif (state.params_by_graph_node_id[param_id]) {\n\t\t\t\tconst param = StoreController.engine.param(param_id);\n\t\t\t\tif (param) {\n\t\t\t\t\tVue.set(state.params_by_graph_node_id[param_id], 'raw_input', param.serializer.raw_input());\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.PARAM_VALUE_UPDATED](\n\t\t\tstate: EngineState,\n\t\t\tparam_id: EnginePayloadByMutationMap[EngineMutation.PARAM_VALUE_UPDATED]\n\t\t) {\n\t\t\tif (state.params_by_graph_node_id[param_id]) {\n\t\t\t\tconst param = StoreController.engine.param(param_id);\n\t\t\t\tif (param) {\n\t\t\t\t\tVue.set(state.params_by_graph_node_id[param_id], 'value', param.serializer.value());\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.PARAM_EXPRESSION_UPDATED](\n\t\t\tstate: EngineState,\n\t\t\tparam_id: EnginePayloadByMutationMap[EngineMutation.PARAM_EXPRESSION_UPDATED]\n\t\t) {\n\t\t\tif (state.params_by_graph_node_id[param_id]) {\n\t\t\t\tconst param = StoreController.engine.param(param_id);\n\t\t\t\tif (param) {\n\t\t\t\t\tVue.set(state.params_by_graph_node_id[param_id], 'expression', param.serializer.expression());\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.PARAM_ERROR_UPDATED](\n\t\t\tstate: EngineState,\n\t\t\tparam_id: EnginePayloadByMutationMap[EngineMutation.PARAM_ERROR_UPDATED]\n\t\t) {\n\t\t\tif (state.params_by_graph_node_id[param_id]) {\n\t\t\t\tconst param = StoreController.engine.param(param_id);\n\t\t\t\tif (param) {\n\t\t\t\t\tVue.set(state.params_by_graph_node_id[param_id], 'error_message', param.serializer.error_message());\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[EngineMutation.PARAM_VISIBLE_STATE](\n\t\t\tstate: EngineState,\n\t\t\tparam_id: EnginePayloadByMutationMap[EngineMutation.PARAM_VISIBLE_STATE]\n\t\t) {\n\t\t\tif (state.params_by_graph_node_id[param_id]) {\n\t\t\t\tconst param = StoreController.engine.param(param_id);\n\t\t\t\tif (param) {\n\t\t\t\t\tstate.params_by_graph_node_id[param_id].is_visible = param.serializer.is_visible();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// param_deleted(state: EngineState, payload: EnginePayloadParamEmitter) {\n\t\t// \tconst param = payload['emitter'];\n\t\t// \tVue.delete(state.params_by_graph_node_id, param.graph_node_id);\n\t\t// },\n\n\t\t// param_dirty_updated: (state, payload)->\n\t\t// \tparam = payload['emitter']\n\n\t\t// \tif param? && state.params_by_graph_node_id[param.graph_node_id()]?\n\t\t// \t\tstate.params_by_graph_node_id[param.graph_node_id()].is_dirty = param.is_dirty()\n\n\t\t// param_visible_updated(state: EngineState, payload: EnginePayloadParamEmitter) {\n\t\t// \tconst param = payload['emitter'];\n\n\t\t// \tif (param && state.params_by_graph_node_id[param.graph_node_id]) {\n\t\t// \t\tstate.params_by_graph_node_id[param.graph_node_id].is_visible = param.options.is_visible();\n\t\t// \t}\n\t\t// },\n\t},\n};\n","export interface EditorClipboardState {\n\tnode_id: string | null;\n\tparam_id: string | null;\n\t// upload_name: string | null;\n}\n\nexport enum EditorClipboardMutation {\n\tNODE_ID = 'NODE_ID',\n\tPARAM_ID = 'PARAM_ID',\n\t// UPLOAD_NAME = 'UPLOAD_NAME',\n}\n\nexport const EditorClipboardStateModule = {\n\tnamespaced: true,\n\tstate(): EditorClipboardState {\n\t\treturn {\n\t\t\tnode_id: null,\n\t\t\tparam_id: null,\n\t\t\t// upload_name: null,\n\t\t};\n\t},\n\n\t// getters: {\n\t// \tupload_name(state:EditorClipboardState) {\n\t// \t\treturn state.upload_name;\n\t// \t},\n\t// \tparam(state) {\n\t// \t\treturn state.param;\n\t// \t},\n\t// },\n\n\tmutations: {\n\t\t[EditorClipboardMutation.NODE_ID]: (state: EditorClipboardState, payload: string) => {\n\t\t\tstate.node_id = payload;\n\t\t},\n\t\t[EditorClipboardMutation.PARAM_ID]: (state: EditorClipboardState, payload: string) => {\n\t\t\tstate.param_id = payload;\n\t\t},\n\t\t// [EditorClipboardMutation.UPLOAD_NAME]: (state: EditorClipboardState, payload: string) => {\n\t\t// \tstate.upload_name = payload;\n\t\t// },\n\t},\n};\n","export interface EditorContextMenuState {\n\tposition: Vector2Like;\n\tparam_id: string | null;\n\tnode_id: string | null;\n\t// upload_name: string | null;\n}\n\nexport enum EditorContextMenuMutation {\n\tPOSITION = 'POSITION',\n\tPARAM_ID = 'PARAM_ID',\n\tNODE_ID = 'NODE_ID',\n\t// UPLOAD_NAME = 'UPLOAD_NAME',\n}\n\nconst reset_menu = function(state: EditorContextMenuState) {\n\tstate.param_id = null;\n\tstate.node_id = null;\n\t// state.upload_name = null;\n};\n\nexport const EditorContextMenuStateModule = {\n\tnamespaced: true,\n\tstate(): EditorContextMenuState {\n\t\treturn {\n\t\t\tposition: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t},\n\t\t\tparam_id: null,\n\t\t\tnode_id: null,\n\t\t\t// upload_name: null,\n\t\t};\n\t},\n\n\t// getters: {\n\t// \tposition(state:EditorContextMenuState) {\n\t// \t\treturn state.position;\n\t// \t},\n\t// \tparam_id(state:EditorContextMenuState) {\n\t// \t\treturn state.param_id;\n\t// \t},\n\t// \tnode_id(state:EditorContextMenuState) {\n\t// \t\treturn state.node_id;\n\t// \t},\n\t// \tupload_name(state:EditorContextMenuState) {\n\t// \t\treturn state.upload_name;\n\t// \t},\n\t// },\n\n\tmutations: {\n\t\t[EditorContextMenuMutation.POSITION]: (state: EditorContextMenuState, position: Vector2Like) => {\n\t\t\tstate.position.x = position.x;\n\t\t\tstate.position.y = position.y;\n\t\t},\n\t\t[EditorContextMenuMutation.PARAM_ID]: (state: EditorContextMenuState, payload: string) => {\n\t\t\treset_menu(state);\n\t\t\tstate.param_id = payload;\n\t\t},\n\t\t[EditorContextMenuMutation.NODE_ID]: (state: EditorContextMenuState, payload: string) => {\n\t\t\treset_menu(state);\n\t\t\tstate.node_id = payload;\n\t\t},\n\t\t// [EditorContextMenuMutation.UPLOAD_NAME]: (state: EditorContextMenuState, payload: string) => {\n\t\t// \treset_menu(state);\n\t\t// \tstate.upload_name = payload;\n\t\t// },\n\t},\n};\n","type OnCloseCallback = () => void;\nexport interface EditorDialogAlertState {\n\tdisplay: boolean;\n\tmessage: string;\n\ttitle: string;\n\ton_close: OnCloseCallback | undefined;\n}\nexport interface EditorDialogAlertShowOptions {\n\tmessage: string;\n\ttitle: string;\n}\nexport interface EditorDialogAlertShowOptionsWithCallback extends EditorDialogAlertShowOptions {\n\ton_close: OnCloseCallback;\n}\nexport enum EditorDialogAlertMutation {\n\tSHOW = 'SHOW',\n\tHIDE = 'HIDE',\n}\n\nexport const EditorDialogAlertStateModule = {\n\tnamespaced: true,\n\tstate(): EditorDialogAlertState {\n\t\treturn {\n\t\t\tdisplay: false,\n\t\t\tmessage: '',\n\t\t\ttitle: 'Alert',\n\t\t\ton_close: undefined,\n\t\t};\n\t},\n\n\t// getters: {\n\t// \tdisplay(state) {\n\t// \t\treturn state.display;\n\t// \t},\n\t// \tmessage(state) {\n\t// \t\treturn state.message;\n\t// \t},\n\t// \ttitle(state) {\n\t// \t\treturn state.title;\n\t// \t},\n\t// },\n\n\tmutations: {\n\t\t[EditorDialogAlertMutation.SHOW]: (\n\t\t\tstate: EditorDialogAlertState,\n\t\t\tpayload: EditorDialogAlertShowOptionsWithCallback\n\t\t) => {\n\t\t\tstate.message = payload.message;\n\t\t\tstate.title = payload.title || 'Alert';\n\t\t\tstate.display = true;\n\t\t\tstate.on_close = payload.on_close;\n\t\t},\n\n\t\t[EditorDialogAlertMutation.HIDE]: (state: EditorDialogAlertState) => {\n\t\t\tstate.display = false;\n\t\t},\n\t},\n};\n","export type EditorDialogConfirmOnAcceptCallback = () => void;\nexport interface EditorDialogConfirmState {\n\tdisplay: boolean;\n\tquestion: string;\n\taccept_label: string;\n\ton_accept: EditorDialogConfirmOnAcceptCallback | undefined;\n}\nexport interface EditorDialogConfirmShowOptions {\n\tquestion: string;\n\taccept_label: string;\n}\nexport interface EditorDialogConfirmShowOptionsWithCallback extends EditorDialogConfirmShowOptions {\n\ton_accept: EditorDialogConfirmOnAcceptCallback;\n}\nexport enum EditorDialogConfirmMutation {\n\tSHOW = 'SHOW',\n\tHIDE = 'HIDE',\n}\n\nexport const EditorDialogConfirmStateModule = {\n\tnamespaced: true,\n\tstate(): EditorDialogConfirmState {\n\t\treturn {\n\t\t\tdisplay: false,\n\t\t\tquestion: 'Are you Sure?',\n\t\t\taccept_label: 'Delete',\n\t\t\ton_accept: undefined,\n\t\t};\n\t},\n\n\t// getters: {\n\t// \tdisplay(state) {\n\t// \t\treturn state.display;\n\t// \t},\n\t// \tquestion(state) {\n\t// \t\treturn state.question;\n\t// \t},\n\t// \taccept_label(state) {\n\t// \t\treturn state.accept_label;\n\t// \t},\n\t// },\n\n\tmutations: {\n\t\t[EditorDialogConfirmMutation.SHOW]: (\n\t\t\tstate: EditorDialogConfirmState,\n\t\t\tpayload: EditorDialogConfirmShowOptionsWithCallback\n\t\t) => {\n\t\t\tstate.question = payload.question;\n\t\t\tstate.accept_label = payload.accept_label;\n\t\t\tstate.on_accept = payload.on_accept;\n\t\t\tstate.display = true;\n\t\t},\n\n\t\t[EditorDialogConfirmMutation.HIDE]: (state: EditorDialogConfirmState) => {\n\t\t\tstate.display = false;\n\t\t\tstate.on_accept = undefined;\n\t\t},\n\t},\n};\n","export type EditorDialogPromptSaveCallback = (new_val: string) => void;\nexport interface EditorDialogPromptState {\n\tdisplay: boolean;\n\ttitle: string;\n\tdefault_value: string;\n\tconfirm_label: string;\n\ton_save: EditorDialogPromptSaveCallback | undefined;\n}\nexport enum EditorDialogPromptMutation {\n\tSHOW = 'SHOW',\n\tHIDE = 'HIDE',\n}\nexport interface EditorDialogPromptShowOptions {\n\ttitle: string;\n\tdefault_value: string;\n\tconfirm_label: string;\n}\nexport interface EditorDialogPromptShowOptionsWithCallback extends EditorDialogPromptShowOptions {\n\ton_save: EditorDialogPromptSaveCallback | undefined;\n}\n\nexport const EditorDialogPromptStateModule = {\n\tnamespaced: true,\n\tstate(): EditorDialogPromptState {\n\t\treturn {\n\t\t\tdisplay: false,\n\t\t\ttitle: '',\n\t\t\tdefault_value: '',\n\t\t\tconfirm_label: 'ok',\n\t\t\ton_save: undefined,\n\t\t};\n\t},\n\n\t// getters: {\n\t// \tdisplay(state) {\n\t// \t\treturn state.display;\n\t// \t},\n\t// \ttitle(state) {\n\t// \t\treturn state.title;\n\t// \t},\n\t// \tdefault_value(state) {\n\t// \t\treturn state.default_value;\n\t// \t},\n\t// \tconfirm_label(state) {\n\t// \t\treturn state.confirm_label;\n\t// \t},\n\t// },\n\n\tmutations: {\n\t\t[EditorDialogPromptMutation.SHOW]: (\n\t\t\tstate: EditorDialogPromptState,\n\t\t\tpayload: EditorDialogPromptShowOptionsWithCallback\n\t\t) => {\n\t\t\tstate.title = payload.title;\n\t\t\tstate.default_value = payload.default_value;\n\t\t\tstate.confirm_label = payload.confirm_label;\n\t\t\tstate.on_save = payload.on_save;\n\t\t\tstate.display = true;\n\t\t},\n\n\t\t[EditorDialogPromptMutation.HIDE]: (state: EditorDialogPromptState) => {\n\t\t\tstate.display = false;\n\t\t\tstate.on_save = undefined;\n\t\t},\n\t},\n};\n","import Vue from 'vue';\n\nexport interface EditorNetworkState {\n\tnode_ids_being_moved: Dictionary<boolean>;\n}\n\nexport enum EditorNetworkGetter {\n\tNODE_IDS_BEING_MOVED = 'NODE_IDS_BEING_MOVED',\n}\n\nexport enum EditorNetworkMutation {\n\tSET_NODE_IDS_BEING_MOVED = 'SET_NODE_IDS_BEING_MOVED',\n\tRESET_NODE_IDS_BEING_MOVED = 'RESET_NODE_IDS_BEING_MOVED',\n}\n\nexport const EditorNetworkStateModule = {\n\tnamespaced: true,\n\tstate(): EditorNetworkState {\n\t\treturn {\n\t\t\tnode_ids_being_moved: {},\n\t\t};\n\t},\n\n\tgetters: {\n\t\t[EditorNetworkGetter.NODE_IDS_BEING_MOVED]: (state: EditorNetworkState) => {\n\t\t\treturn state.node_ids_being_moved;\n\t\t},\n\t},\n\n\tmutations: {\n\t\t[EditorNetworkMutation.SET_NODE_IDS_BEING_MOVED]: (state: EditorNetworkState, payload: string[]) => {\n\t\t\tfor (let id of payload) {\n\t\t\t\tVue.set(state.node_ids_being_moved, id, true);\n\t\t\t}\n\t\t},\n\t\t[EditorNetworkMutation.RESET_NODE_IDS_BEING_MOVED]: (state: EditorNetworkState) => {\n\t\t\tVue.set(state, 'node_ids_being_moved', {});\n\t\t},\n\t},\n};\n","export interface EditorNumericSliderState {\n\tparam_id: string | null;\n\tposition: Vector2Like;\n}\nexport interface EditorNumericSliderShowOptions {\n\tparam_id: string | null;\n\tposition: Vector2Like;\n}\nexport enum EditorNumericSliderMutation {\n\tOPEN = 'OPEN',\n\tCLOSE = 'CLOSE',\n}\n\nexport const EditorNumericSliderStateModule = {\n\tnamespaced: true,\n\tstate() {\n\t\treturn {\n\t\t\tparam_id: null,\n\t\t\tposition: {x: 0, y: 0},\n\t\t};\n\t},\n\n\t// getters: {\n\t// \tparam_id(state) {\n\t// \t\treturn state.param_id;\n\t// \t},\n\t// \tposition(state) {\n\t// \t\treturn state.position;\n\t// \t},\n\t// },\n\n\tmutations: {\n\t\t[EditorNumericSliderMutation.OPEN]: (\n\t\t\tstate: EditorNumericSliderState,\n\t\t\tpayload: EditorNumericSliderShowOptions\n\t\t) => {\n\t\t\tstate.param_id = payload.param_id;\n\t\t\tstate.position.x = payload.position.x;\n\t\t\tstate.position.y = payload.position.y;\n\t\t},\n\n\t\t[EditorNumericSliderMutation.CLOSE]: (state: EditorNumericSliderState) => {\n\t\t\tstate.param_id = null;\n\t\t},\n\t},\n};\n","export interface EditorPanelState {\n\tfullscreen_panel_id: string | null;\n}\n\nexport enum EditorPanelMutation {\n\tFULLSCREEN_PANEL_ID = 'FULLSCREEN_PANEL_ID',\n}\n\nexport const EditorPanelStateModule = {\n\tnamespaced: true,\n\tstate(): EditorPanelState {\n\t\treturn {\n\t\t\tfullscreen_panel_id: null,\n\t\t};\n\t},\n\n\tmutations: {\n\t\t[EditorPanelMutation.FULLSCREEN_PANEL_ID]: (state: EditorPanelState, payload: string) => {\n\t\t\tstate.fullscreen_panel_id = payload;\n\t\t},\n\t},\n};\n","export interface EditorPanelNodeSelectorState {\n\t// panel_id: string | null;\n\tparam_id: string | null;\n}\nexport interface EditorPanelNodeSelectorOptions {\n\tparam_id: string;\n}\nexport enum EditorPanelNodeSelectorMutation {\n\tOPEN = 'OPEN',\n\tCLOSE = 'CLOSE',\n}\n\nexport const EditorPanelNodeSelectorStateModule = {\n\tnamespaced: true,\n\tstate(): EditorPanelNodeSelectorState {\n\t\treturn {param_id: null};\n\t},\n\n\t// getters: {\n\t// \tpanel_id(state:EditorPanelNodeSelectorState) {\n\t// \t\treturn state.panel_id;\n\t// \t},\n\t// },\n\n\tmutations: {\n\t\t[EditorPanelNodeSelectorMutation.OPEN]: (\n\t\t\tstate: EditorPanelNodeSelectorState,\n\t\t\tpayload: EditorPanelNodeSelectorOptions\n\t\t) => {\n\t\t\tstate.param_id = payload.param_id;\n\t\t},\n\t\t[EditorPanelNodeSelectorMutation.CLOSE]: (state: EditorPanelNodeSelectorState) => {\n\t\t\tstate.param_id = null;\n\t\t},\n\t},\n};\n","import lodash_camelCase from 'lodash/camelCase';\nimport lodash_upperFirst from 'lodash/upperFirst';\nexport enum PanelType {\n\tASSET = 'asset',\n\tCUSTOM_NODE_EDITOR = 'custom_node_editor',\n\tNETWORK = 'network',\n\tPARAMS = 'params',\n\tPARAM_EDIT = 'param_edit',\n\tPERFORMANCE = 'performance',\n\tSPREADSHEET = 'spreadsheet',\n\tVIEWER = 'viewer',\n}\nconst PanelTypeS: Array<PanelType> = [\n\tPanelType.ASSET,\n\tPanelType.CUSTOM_NODE_EDITOR,\n\tPanelType.NETWORK,\n\tPanelType.PARAMS,\n\tPanelType.PARAM_EDIT,\n\tPanelType.PERFORMANCE,\n\tPanelType.SPREADSHEET,\n\tPanelType.VIEWER,\n];\nconst GUEST_PanelTypeS: Array<PanelType> = [\n\tPanelType.NETWORK,\n\tPanelType.PARAMS,\n\tPanelType.PERFORMANCE,\n\tPanelType.SPREADSHEET,\n\tPanelType.VIEWER,\n];\n\nimport {MultiplePanelProps} from 'src/editor/components/types/props';\nimport {ref, Ref, computed} from '@vue/composition-api';\n\nexport interface ISetupMultiplePanelPanels {\n\tset_panel_types_from_split_panel: (index: number) => void;\n\tset_panel_types_from_json: (new_panel_types: PanelType[]) => void;\n\tset_current_panel_index: (index: number) => void;\n\tremove_tab: (index: number) => void;\n\tadd_tab: (type: PanelType) => void;\n\ttab_class_objects: Readonly<\n\t\tRef<\n\t\t\treadonly {\n\t\t\t\t[x: string]: boolean;\n\t\t\t\tactive: boolean;\n\t\t\t}[]\n\t\t>\n\t>;\n\ttab_delete_allowed: Readonly<Ref<boolean>>;\n\tcurrent_panel_type: Readonly<Ref<string>>;\n\tavailable_panel_types: Readonly<\n\t\tRef<\n\t\t\treadonly {\n\t\t\t\tid: PanelType;\n\t\t\t}[]\n\t\t>\n\t>;\n\tpanel_types: Ref<string[]>;\n\tcurrent_panel_index: Ref<number>;\n}\n\nexport function SetupMultiplePanelPanels(\n\tprops: MultiplePanelProps,\n\tsplit_panel1: Ref<HTMLElement | null>,\n\tsplit_panel2: Ref<HTMLElement | null>\n): ISetupMultiplePanelPanels {\n\tconst current_panel_index = ref(props.init_properties.current_panel_index || 0);\n\tconst panel_types = ref<string[]>(props.init_properties.panel_types || ['viewer', 'param', 'network']);\n\n\tconst available_panel_types = computed(() => {\n\t\tlet list = PanelTypeS;\n\t\tif (!props.scene_update_allowed) {\n\t\t\tlist = GUEST_PanelTypeS;\n\t\t}\n\t\treturn list.map((panel_type) => ({id: panel_type}));\n\t});\n\n\tconst current_panel_type = computed(() => {\n\t\tlet name = panel_types.value[current_panel_index.value];\n\t\tif (name == null) {\n\t\t\tname = panel_types.value[0];\n\t\t}\n\t\treturn lodash_upperFirst(lodash_camelCase(name));\n\t});\n\n\tconst tab_delete_allowed = computed(() => {\n\t\treturn panel_types.value.length > 1;\n\t});\n\n\tconst tab_class_objects = computed(() => {\n\t\treturn panel_types.value.map((panel_type, i) => {\n\t\t\treturn {\n\t\t\t\tactive: i === current_panel_index.value,\n\t\t\t\t[panel_type]: true,\n\t\t\t};\n\t\t});\n\t});\n\n\t// functions\n\tfunction add_tab(type: PanelType) {\n\t\tpanel_types.value.push(type);\n\t\tset_current_panel_index(panel_types.value.length - 1);\n\t}\n\tfunction remove_tab(index: number) {\n\t\tif (tab_delete_allowed.value) {\n\t\t\tpanel_types.value.splice(index, 1);\n\n\t\t\tif (current_panel_index.value >= panel_types.value.length) {\n\t\t\t\tcurrent_panel_index.value = panel_types.value.length - 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction set_current_panel_index(i: number) {\n\t\tcurrent_panel_index.value = i;\n\t}\n\n\tfunction set_panel_types_from_json(new_panel_types: PanelType[]) {\n\t\t// this is slightly tricky, as I would also ensure that current_panel_index is correctly set\n\t\t// if !this.scene_update_allowed\n\t\t// \tpanel_types = panel_types.filter (panel_type)=>\n\t\t// \t\tlodash_includes(GUEST_PanelTypeS, panel_type)\n\n\t\t// TODO: typescript check this\n\t\tpanel_types.value = new_panel_types;\n\t}\n\n\tfunction set_panel_types_from_split_panel(index: number) {\n\t\tif (split_panel1.value && split_panel2.value) {\n\t\t\tconst remaining_panel = index === 0 ? split_panel1.value : split_panel2.value;\n\t\t\t// TODO: typescript check this\n\t\t\tconsole.log('remaining_panel', remaining_panel);\n\t\t\t// panel_types.value = remaining_panel.$data.panel_types;\n\t\t}\n\t}\n\n\treturn {\n\t\tset_panel_types_from_split_panel,\n\t\tset_panel_types_from_json,\n\t\tset_current_panel_index,\n\t\tremove_tab,\n\t\tadd_tab,\n\t\ttab_class_objects,\n\t\ttab_delete_allowed,\n\t\tcurrent_panel_type,\n\t\tavailable_panel_types,\n\t\tpanel_types,\n\t\tcurrent_panel_index,\n\t};\n}\n","// importing scene to make it a module\nimport 'src/engine/scene/PolyScene';\n\nexport enum MultiplePanelSplitMode {\n\tHORIZONTAL = 'horizontal',\n\tVERTICAL = 'vertical',\n}\n\ntype ViewerPanelInitProperties = object;\nexport interface PanelInitProperties {\n\tpanel_types?: string[];\n\tcurrent_panel_index?: number;\n\tsplit_mode?: MultiplePanelSplitMode;\n\tsub_panels_init_properties?: [PanelInitProperties, PanelInitProperties];\n\tviewer?: ViewerPanelInitProperties;\n}\n\nexport interface MultiplePanelProps {\n\tinit_properties: PanelInitProperties;\n\tlevel: number;\n\tpanel_id: string;\n\tscene_update_allowed: boolean;\n}\n\nexport interface DropDownMenuEntry {\n\tid: string;\n\tlabel?: string;\n\tdisabled?: boolean;\n\tchildren?: DropDownMenuEntry[];\n}\n","import {PolyScene} from 'src/engine/scene/PolyScene';\nimport {CodeExporterDispatcher} from './Dispatcher';\nimport {CoreString} from 'src/core/String';\n\nexport class SceneCodeExporter {\n\tconstructor(private _scene: PolyScene) {}\n\n\tprocess(): string {\n\t\tconst lines: string[] = [];\n\n\t\tthis._scene.nodes_controller.reset_node_context_signatures();\n\n\t\tCodeExporterDispatcher.dispatch_node(this._scene.root)\n\t\t\t.create()\n\t\t\t.forEach((root_line) => {\n\t\t\t\tlines.push(root_line);\n\t\t\t});\n\n\t\tlines.push(`${this.var_name()}.set_frame(${this._scene.frame || 1})`);\n\t\tlines.push(`${this.var_name()}.set_frame_range(${this._scene.frame_range.join(',')})`);\n\t\tlines.push(`${this.var_name()}.time_controller.set_fps(${this._scene.time_controller.fps})`);\n\n\t\tconst camera_path = this._scene.cameras_controller.master_camera_node_path;\n\t\tif (camera_path) {\n\t\t\tlines.push(`${this.var_name()}.cameras_controller.set_master_camera_node_path('${camera_path}')`);\n\t\t}\n\t\tthis.add_semi_colons(lines);\n\t\treturn lines.join('\\n');\n\t}\n\tprivate add_semi_colons(lines: string[]) {\n\t\tconst characters_without_semi_colon = '{}';\n\t\tlines.forEach((line, i) => {\n\t\t\tconst last_char = line[line.length - 1];\n\t\t\tif (!characters_without_semi_colon.includes(last_char)) {\n\t\t\t\tlines[i] = `${line};`;\n\t\t\t}\n\t\t});\n\t}\n\n\tvar_name() {\n\t\t//\"window.scenes_by_uuid['#{this.name()}']\"\n\t\treturn 'scene';\n\t}\n\tstatic sanitize_string(word: string): string {\n\t\tword = word.replace(/'/g, \"\\\\'\"); // escapes ' (uses 2 \\, as opposed to the json exporter which uses only 1)\n\t\tword = CoreString.escape_line_breaks(word); // escapes line breaks (for shader code for instance)\n\t\treturn word;\n\t}\n}\n","import {EngineParamData} from 'src/editor/store/modules/Engine';\nimport {ParamSetCommand} from 'src/editor/history/commands/ParamSet';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {ParamValue} from 'src/engine/params/types/ParamValue';\nexport function SetupNumericSlider(json_param: EngineParamData, param: BaseParamType) {\n\tlet slider_start_value: ParamValue | undefined = undefined;\n\tlet slider_start_expression: string | undefined = undefined;\n\tfunction on_slider_mousedown(e: Event) {\n\t\tconst target = e.target as HTMLInputElement;\n\t\tif (target) {\n\t\t\tif (param.has_expression() && param.expression_controller) {\n\t\t\t\tslider_start_expression = param.expression_controller.expression;\n\t\t\t} else {\n\t\t\t\tslider_start_value = param.value;\n\t\t\t}\n\t\t}\n\t}\n\tfunction on_slider_mouseup(e: Event) {\n\t\tconst target = e.target as HTMLInputElement;\n\t\tif (target) {\n\t\t\tif (slider_start_expression) {\n\t\t\t\tconst cmd = new ParamSetCommand(param as any, param.value, slider_start_expression);\n\t\t\t\tcmd.push();\n\t\t\t} else {\n\t\t\t\tif (!param.is_value_equal(slider_start_value as any)) {\n\t\t\t\t\tconst cmd = new ParamSetCommand(param as any, param.value, slider_start_value);\n\t\t\t\t\tcmd.push();\n\t\t\t\t}\n\t\t\t}\n\t\t\tslider_start_value = undefined;\n\t\t\tslider_start_expression = undefined;\n\t\t}\n\t}\n\tfunction on_slider_drag(e: Event) {\n\t\tconst target = e.target as HTMLInputElement;\n\t\tif (target) {\n\t\t\tconst value = target.value;\n\t\t\tif (!param.is_raw_input_equal(value)) {\n\t\t\t\tparam.set(value);\n\t\t\t}\n\t\t}\n\t}\n\tfunction on_slider_change(e: Event) {\n\t\tconst target = e.target as HTMLInputElement;\n\t\tif (target) {\n\t\t}\n\t}\n\n\treturn {\n\t\ton_slider_mousedown,\n\t\ton_slider_mouseup,\n\t\ton_slider_drag,\n\t\ton_slider_change,\n\t};\n}\n","import {computed, Ref} from '@vue/composition-api';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {NodeSerializerData} from 'src/engine/nodes/utils/Serializer';\n\nexport interface SetupSelectedNodeOptions {\n\tfirst_selected_node_id: Readonly<Ref<string | null>>;\n\tfirst_selected_json_node: Readonly<Ref<Readonly<NodeSerializerData> | null>>;\n\tfirst_selected_node: () => BaseNodeType | null;\n\tselected_node_name: Readonly<Ref<string | undefined>>;\n\tselected_node_type: Readonly<Ref<string | undefined>>;\n}\n\nexport function SetupSelectedNode(): SetupSelectedNodeOptions {\n\tconst first_selected_node_id = computed(() => {\n\t\tconst parent_node_id = StoreController.editor.current_node_graph_id();\n\t\tif (parent_node_id) {\n\t\t\tconst parent_node_json = StoreController.engine.json_node(parent_node_id);\n\t\t\tif (parent_node_json && parent_node_json.selection) {\n\t\t\t\treturn parent_node_json.selection[0];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t});\n\tconst first_selected_json_node = computed(() => {\n\t\tif (first_selected_node_id.value) {\n\t\t\treturn StoreController.engine.json_node(first_selected_node_id.value);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\tconst selected_node_name = computed(() => {\n\t\treturn first_selected_json_node.value?.name;\n\t});\n\tconst selected_node_type = computed(() => {\n\t\treturn first_selected_json_node.value?.type;\n\t});\n\n\tfunction first_selected_node() {\n\t\tconst id = first_selected_node_id.value;\n\t\tif (id) {\n\t\t\treturn StoreController.engine.node(id);\n\t\t}\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tfirst_selected_node_id,\n\t\tfirst_selected_json_node,\n\t\tfirst_selected_node,\n\t\tselected_node_name,\n\t\tselected_node_type,\n\t};\n}\n","import { render, staticRenderFns } from \"./NodeTree.vue?vue&type=template&id=3a6e6a90&lang=pug&\"\nimport script from \"./NodeTree.vue?vue&type=script&lang=ts&\"\nexport * from \"./NodeTree.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./NodeTree.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('3a6e6a90')) {\n      api.createRecord('3a6e6a90', component.options)\n    } else {\n      api.reload('3a6e6a90', component.options)\n    }\n    module.hot.accept(\"./NodeTree.vue?vue&type=template&id=3a6e6a90&lang=pug&\", function () {\n      api.rerender('3a6e6a90', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/NodeTree.vue\"\nexport default component.exports","import {Editor, EditorProps} from './Editor';\nimport scene_data from 'src/../public/examples/scenes/default_simple.json';\nimport {SceneJsonExporterData} from 'src/engine/io/json/export/Scene';\nimport {CoreString} from '../core/String';\n\nvar url_params = new URLSearchParams(window.location.search);\nconst props: EditorProps = {\n\tcurrent_node: url_params.get('current_node') || undefined,\n\tselected: url_params.get('selected') || undefined,\n\tperf: url_params.has('perf') ? CoreString.to_boolean(url_params.get('perf') || '') : undefined,\n};\n\nEditor.load_scene('#app', scene_data as SceneJsonExporterData, props);\nEditor.on_save((json) => {\n\tconsole.log(JSON.stringify(json));\n});\n","import Vuex from 'vuex';\n\nimport {EngineStoreModule, EngineState} from './modules/Engine';\nimport {EditortoreModule, EditorState} from './modules/Editor';\n\nexport interface State {\n\tengine: EngineState;\n\teditor: EditorState;\n}\n\nexport const EditorStore = new Vuex.Store<State>({\n\tmodules: {\n\t\tengine: EngineStoreModule,\n\t\teditor: EditortoreModule,\n\t},\n});\n","import {PolyScene} from 'src/engine/scene/PolyScene';\n\nimport {State} from '../Store';\nimport {Store} from 'vuex';\nimport {BaseNodeType} from 'src/engine/nodes/_Base.js';\nimport {StoreController} from './StoreController';\n\nimport {EditorClipboardStoreController} from './editor/EditorClipboardStoreController';\nimport {EditorContextMenuStoreController} from './editor/EditorContextMenuStoreController';\nimport {EditorDialogAlertStoreController} from './editor/EditorDialogAlertStoreController';\nimport {EditorDialogConfirmStoreController} from './editor/EditorDialogConfirmStoreController';\nimport {EditorDialogPromptStoreController} from './editor/EditorDialogPromptStoreController';\nimport {EditorNetworkStoreController} from './editor/EditorNetworkStoreController';\nimport {EditorNumericSliderStoreController} from './editor/EditorNumericSliderStoreController';\nimport {EditorPanelStoreController} from './editor/EditorPanelStoreController';\nimport {EditorPanelNodeSelectorStoreController} from './editor/EditorPanelNodeSelectorController';\nimport {EngineNodeData} from '../modules/Engine';\n\nexport class EditorStoreControllerClass {\n\tprivate _store!: Store<State>;\n\tprivate _scene!: PolyScene;\n\n\tpublic readonly clipboard = EditorClipboardStoreController;\n\tpublic readonly context_menu = EditorContextMenuStoreController;\n\tpublic readonly dialog_alert = EditorDialogAlertStoreController;\n\tpublic readonly dialog_confirm = EditorDialogConfirmStoreController;\n\tpublic readonly dialog_prompt = EditorDialogPromptStoreController;\n\tpublic readonly network = EditorNetworkStoreController;\n\tpublic readonly numeric_slider = EditorNumericSliderStoreController;\n\tpublic readonly panel = EditorPanelStoreController;\n\tpublic readonly panel_node_selector = EditorPanelNodeSelectorStoreController;\n\n\tprivate static _instance: EditorStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\tset_scene(scene: PolyScene) {\n\t\tthis._scene = scene;\n\t}\n\tget scene() {\n\t\treturn this._scene;\n\t}\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t\tthis.clipboard.set_store(store);\n\t\tthis.context_menu.set_store(store);\n\t\tthis.dialog_alert.set_store(store);\n\t\tthis.dialog_confirm.set_store(store);\n\t\tthis.dialog_prompt.set_store(store);\n\t\tthis.network.set_store(store);\n\t\tthis.numeric_slider.set_store(store);\n\t\tthis.panel.set_store(store);\n\t\tthis.panel_node_selector.set_store(store);\n\t}\n\tclose_all_popups() {\n\t\tthis.context_menu.set_node_id(null);\n\t\tthis.context_menu.set_param_id(null);\n\t\t// this.dialog_alert.hide()\n\t\t// this.dialog_confirm.hide()\n\t\t// this.dialog_prompt.hide()\n\t\tthis.numeric_slider.close();\n\t\tthis.panel_node_selector.close();\n\t}\n\n\t// getters\n\tcurrent_node_graph_id(): string | undefined {\n\t\treturn this._store.getters['editor/current_node_id'];\n\t}\n\tcurrent_json_node(): EngineNodeData | null {\n\t\tconst id = this.current_node_graph_id();\n\t\tif (id) {\n\t\t\treturn StoreController.engine.json_node(id);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\tcurrent_node(): BaseNodeType {\n\t\tconst id = this.current_node_graph_id();\n\t\tif (id) {\n\t\t\tconst node = this._scene.graph.node_from_id(id);\n\t\t\tif (node) {\n\t\t\t\treturn node as BaseNodeType;\n\t\t\t}\n\t\t}\n\t\treturn StoreController.scene.root;\n\t}\n\n\t// mutations\n\tset_current_node(node: BaseNodeType) {\n\t\tthis._store.commit('editor/current_node', node);\n\t}\n\tgo_up() {\n\t\tconst parent = this.current_node().parent;\n\t\tif (parent) {\n\t\t\tthis.set_current_node(parent);\n\t\t}\n\t}\n\tgo_down() {\n\t\tconst node = this.current_node();\n\t\tif (node.children_allowed() && node.children_controller) {\n\t\t\tconst child_node = node.children_controller.selection.nodes()[0];\n\t\t\tif (child_node) {\n\t\t\t\tthis.set_current_node(child_node);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport const EditorStoreController = EditorStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {EditorClipboardMutation, EditorClipboardState} from '../../modules/editor/Clipboard';\n\nexport class EditorClipboardStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorClipboardStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorClipboardStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tget local_state(): EditorClipboardState {\n\t\treturn (<unknown>(this._store.state.editor as any).clipboard) as EditorClipboardState;\n\t}\n\tnode_id(): string | null {\n\t\treturn this.local_state.node_id;\n\t}\n\tparam_id(): string | null {\n\t\treturn this.local_state.param_id;\n\t}\n\t// upload_name(): string | null {\n\t// \treturn this.local_state.upload_name;\n\t// }\n\n\t// mutations\n\tset_node_id(node_id: string): void {\n\t\tthis._store.commit(`editor/clipboard/${EditorClipboardMutation.NODE_ID}`, node_id);\n\t}\n\tset_param_id(param_id: string): void {\n\t\tthis._store.commit(`editor/clipboard/${EditorClipboardMutation.PARAM_ID}`, param_id);\n\t}\n\t// set_upload_name(name: string): void {\n\t// \tthis._store.commit(`editor/context_menu/${EditorClipboardMutation.UPLOAD_NAME}`, name);\n\t// }\n}\n\nexport const EditorClipboardStoreController = EditorClipboardStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {EditorContextMenuMutation, EditorContextMenuState} from '../../modules/editor/ContextMenu';\n\nexport class EditorContextMenuStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorContextMenuStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorContextMenuStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tget local_state(): EditorContextMenuState {\n\t\treturn (<unknown>(this._store.state.editor as any).context_menu) as EditorContextMenuState;\n\t}\n\tposition(): Vector2Like {\n\t\treturn this.local_state.position;\n\t}\n\tnode_id(): string | null {\n\t\treturn this.local_state.node_id;\n\t}\n\tparam_id(): string | null {\n\t\treturn this.local_state.param_id;\n\t}\n\t// upload_name(): string | null {\n\t// \treturn this.local_state.upload_name;\n\t// }\n\n\t// mutations\n\tset_position(position: Vector2Like): void {\n\t\tthis._store.commit(`editor/context_menu/${EditorContextMenuMutation.POSITION}`, position);\n\t}\n\tset_node_id(node_id: string | null): void {\n\t\tthis._store.commit(`editor/context_menu/${EditorContextMenuMutation.NODE_ID}`, node_id);\n\t}\n\tset_param_id(param_id: string | null): void {\n\t\tthis._store.commit(`editor/context_menu/${EditorContextMenuMutation.PARAM_ID}`, param_id);\n\t}\n\t// set_upload_name(name: string): void {\n\t// \tthis._store.commit(`editor/context_menu/${EditorContextMenuMutation.UPLOAD_NAME}`, name);\n\t// }\n}\n\nexport const EditorContextMenuStoreController = EditorContextMenuStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {\n\tEditorDialogAlertMutation,\n\tEditorDialogAlertShowOptions,\n\tEditorDialogAlertShowOptionsWithCallback,\n\tEditorDialogAlertState,\n} from '../../modules/editor/DialogAlert';\n\nexport class EditorDialogAlertStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorDialogAlertStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorDialogAlertStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tget local_state(): EditorDialogAlertState {\n\t\treturn (<unknown>(this._store.state.editor as any).dialog_alert) as EditorDialogAlertState;\n\t}\n\tdisplay(): boolean {\n\t\treturn this.local_state.display;\n\t}\n\ttitle(): string {\n\t\treturn this.local_state.title;\n\t}\n\tmessage(): string {\n\t\treturn this.local_state.message;\n\t}\n\n\t// mutations\n\tasync show(options: EditorDialogAlertShowOptions): Promise<void> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst options_with_callback: EditorDialogAlertShowOptionsWithCallback = {\n\t\t\t\ttitle: options.title,\n\t\t\t\tmessage: options.message,\n\t\t\t\ton_close: resolve,\n\t\t\t};\n\t\t\tthis._store.commit(`editor/dialog_alert/${EditorDialogAlertMutation.SHOW}`, options_with_callback);\n\t\t});\n\n\t\t// window.POLY_alert = (component, message, options) => {\n\t\t// \treturn new Promise((resolve, reject) => {\n\t\t// \t\treturn component.$store.commit('editor/dialog_alert/show', {\n\t\t// \t\t\tmessage,\n\t\t// \t\t\ttitle: options['title'],\n\t\t// \t\t\ton_close: (new_value) => {\n\t\t// \t\t\t\treturn resolve();\n\t\t// \t\t\t},\n\t\t// \t\t});\n\t\t// \t});\n\t\t// };\n\t}\n\thide() {\n\t\tthis._store.commit(`editor/dialog_alert/${EditorDialogAlertMutation.HIDE}`);\n\t}\n}\n\nexport const EditorDialogAlertStoreController = EditorDialogAlertStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {\n\tEditorDialogConfirmMutation,\n\tEditorDialogConfirmShowOptions,\n\tEditorDialogConfirmShowOptionsWithCallback,\n\tEditorDialogConfirmState,\n\tEditorDialogConfirmOnAcceptCallback,\n} from '../../modules/editor/DialogConfirm';\n\nexport class EditorDialogConfirmStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorDialogConfirmStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorDialogConfirmStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tget local_state(): EditorDialogConfirmState {\n\t\treturn (<unknown>(this._store.state.editor as any).dialog_confirm) as EditorDialogConfirmState;\n\t}\n\tdisplay(): boolean {\n\t\treturn this.local_state.display;\n\t}\n\tquestion(): string {\n\t\treturn this.local_state.question;\n\t}\n\taccept_label(): string {\n\t\treturn this.local_state.accept_label;\n\t}\n\ton_accept(): EditorDialogConfirmOnAcceptCallback | undefined {\n\t\treturn this.local_state.on_accept;\n\t}\n\n\t// mutations\n\tasync show(options: EditorDialogConfirmShowOptions): Promise<string> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst options_with_callback: EditorDialogConfirmShowOptionsWithCallback = {\n\t\t\t\tquestion: options.question,\n\t\t\t\taccept_label: options.accept_label,\n\t\t\t\ton_accept: resolve,\n\t\t\t};\n\t\t\tthis._store.commit(`editor/dialog_confirm/${EditorDialogConfirmMutation.SHOW}`, options_with_callback);\n\t\t});\n\n\t\t// window.POLY_confirm = (component, question, options) => {\n\t\t// \tif (options == null) {\n\t\t// \t\toptions = {};\n\t\t// \t}\n\t\t// \toptions['accept_label'] = options['accept_label'] || 'Delete';\n\n\t\t// \treturn new Promise((resolve, reject) => {\n\t\t// \t\treturn component.$store.commit('editor/dialog_confirm/show', {\n\t\t// \t\t\tquestion,\n\t\t// \t\t\taccept_label: options['accept_label'],\n\t\t// \t\t\ton_accept: () => {\n\t\t// \t\t\t\treturn resolve(true);\n\t\t// \t\t\t},\n\t\t// \t\t});\n\t\t// \t});\n\t\t// };\n\t}\n\thide() {\n\t\tthis._store.commit(`editor/dialog_prompt/${EditorDialogConfirmMutation.HIDE}`);\n\t}\n}\n\nexport const EditorDialogConfirmStoreController = EditorDialogConfirmStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {\n\tEditorDialogPromptMutation,\n\tEditorDialogPromptShowOptions,\n\tEditorDialogPromptShowOptionsWithCallback,\n\tEditorDialogPromptState,\n\tEditorDialogPromptSaveCallback,\n} from '../../modules/editor/DialogPrompt';\n\nexport class EditorDialogPromptStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorDialogPromptStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorDialogPromptStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tget local_state(): EditorDialogPromptState {\n\t\treturn (<unknown>(this._store.state.editor as any).dialog_prompt) as EditorDialogPromptState;\n\t}\n\tdisplay(): boolean {\n\t\treturn this.local_state.display;\n\t}\n\ttitle(): string {\n\t\treturn this.local_state.title;\n\t}\n\tdefault_value(): string {\n\t\treturn this.local_state.default_value;\n\t}\n\tconfirm_label(): string {\n\t\treturn this.local_state.confirm_label;\n\t}\n\ton_save(): EditorDialogPromptSaveCallback | undefined {\n\t\treturn this.local_state.on_save;\n\t}\n\n\t// mutations\n\tasync show(options: EditorDialogPromptShowOptions): Promise<string> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst options_with_callback: EditorDialogPromptShowOptionsWithCallback = {\n\t\t\t\ttitle: options.title,\n\t\t\t\tconfirm_label: options.confirm_label,\n\t\t\t\tdefault_value: options.default_value,\n\t\t\t\ton_save: resolve,\n\t\t\t};\n\t\t\tthis._store.commit(`editor/dialog_prompt/${EditorDialogPromptMutation.SHOW}`, options_with_callback);\n\t\t});\n\n\t\t// window.POLY_confirm = (component, question, options) => {\n\t\t// \tif (options == null) {\n\t\t// \t\toptions = {};\n\t\t// \t}\n\t\t// \toptions['accept_label'] = options['accept_label'] || 'Delete';\n\n\t\t// \treturn new Promise((resolve, reject) => {\n\t\t// \t\treturn component.$store.commit('editor/dialog_confirm/show', {\n\t\t// \t\t\tquestion,\n\t\t// \t\t\taccept_label: options['accept_label'],\n\t\t// \t\t\ton_accept: () => {\n\t\t// \t\t\t\treturn resolve(true);\n\t\t// \t\t\t},\n\t\t// \t\t});\n\t\t// \t});\n\t\t// };\n\t}\n\thide() {\n\t\tthis._store.commit(`editor/dialog_prompt/${EditorDialogPromptMutation.HIDE}`);\n\t}\n}\n\nexport const EditorDialogPromptStoreController = EditorDialogPromptStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {EditorNetworkGetter, EditorNetworkMutation} from '../../modules/editor/Network';\n\nexport class EditorNetworkStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorNetworkStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorNetworkStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tnode_ids_being_moved(): Readonly<Dictionary<boolean>> {\n\t\treturn this._store.getters[`editor/network/${EditorNetworkGetter.NODE_IDS_BEING_MOVED}`];\n\t}\n\n\t// mutations\n\tset_node_ids_being_moved(ids: string[]) {\n\t\tthis._store.commit(`editor/network/${EditorNetworkMutation.SET_NODE_IDS_BEING_MOVED}`, ids);\n\t}\n\treset_node_ids_being_moved() {\n\t\tthis._store.commit(`editor/network/${EditorNetworkMutation.RESET_NODE_IDS_BEING_MOVED}`);\n\t}\n}\n\nexport const EditorNetworkStoreController = EditorNetworkStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {\n\tEditorNumericSliderMutation,\n\tEditorNumericSliderShowOptions,\n\tEditorNumericSliderState,\n} from '../../modules/editor/NumericSlider';\n\nexport class EditorNumericSliderStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorNumericSliderStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorNumericSliderStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tget local_state(): EditorNumericSliderState {\n\t\treturn (<unknown>(this._store.state.editor as any).numeric_slider) as EditorNumericSliderState;\n\t}\n\tparam_id(): string | null {\n\t\treturn this.local_state.param_id;\n\t}\n\tposition(): Vector2Like {\n\t\treturn this.local_state.position;\n\t}\n\n\t// mutations\n\topen(options: EditorNumericSliderShowOptions): void {\n\t\tthis._store.commit(`editor/numeric_slider/${EditorNumericSliderMutation.OPEN}`, options);\n\t}\n\tclose() {\n\t\tthis._store.commit(`editor/numeric_slider/${EditorNumericSliderMutation.CLOSE}`);\n\t}\n}\n\nexport const EditorNumericSliderStoreController = EditorNumericSliderStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {EditorPanelMutation, EditorPanelState} from '../../modules/editor/Panel';\n\nexport class EditorPanelStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorPanelStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorPanelStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tget local_state(): EditorPanelState {\n\t\treturn (<unknown>(this._store.state.editor as any).panel) as EditorPanelState;\n\t}\n\tfullscreen_panel_id(): string | null {\n\t\treturn this.local_state.fullscreen_panel_id;\n\t}\n\n\t// mutations\n\tset_fullscreen_panel_id(panel_id: string | null): void {\n\t\tthis._store.commit(`editor/panel/${EditorPanelMutation.FULLSCREEN_PANEL_ID}`, panel_id);\n\t\tsetTimeout(() => {\n\t\t\twindow.dispatchEvent(new Event('resize'));\n\t\t}, 0);\n\t}\n}\n\nexport const EditorPanelStoreController = EditorPanelStoreControllerClass.instance();\n","import {State} from '../../Store';\nimport {Store} from 'vuex';\nimport {\n\tEditorPanelNodeSelectorMutation,\n\tEditorPanelNodeSelectorState,\n\tEditorPanelNodeSelectorOptions,\n} from '../../modules/editor/PanelNodeSelector';\n\nexport class EditorPanelNodeSelectorStoreControllerClass {\n\tprivate _store!: Store<State>;\n\n\tprivate static _instance: EditorPanelNodeSelectorStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EditorPanelNodeSelectorStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t}\n\n\t// getters\n\tget local_state(): EditorPanelNodeSelectorState {\n\t\treturn (<unknown>(this._store.state.editor as any).panel_node_selector) as EditorPanelNodeSelectorState;\n\t}\n\tparam_id(): string | null {\n\t\treturn this.local_state.param_id;\n\t}\n\n\t// mutations\n\topen(options: EditorPanelNodeSelectorOptions): void {\n\t\tthis._store.commit(`editor/panel_node_selector/${EditorPanelNodeSelectorMutation.OPEN}`, options);\n\t}\n\tclose() {\n\t\tthis._store.commit(`editor/panel_node_selector/${EditorPanelNodeSelectorMutation.CLOSE}`);\n\t}\n}\n\nexport const EditorPanelNodeSelectorStoreController = EditorPanelNodeSelectorStoreControllerClass.instance();\n","import {PolyScene} from 'src/engine/scene/PolyScene';\n\nimport {State} from '../Store';\nimport {Store} from 'vuex';\nimport {EngineMutation, EngineNodeData, EngineParamData, EnginePayloadByMutationMap} from '../modules/Engine';\nimport {BaseNodeType, EmitDataByNodeEventMap} from 'src/engine/nodes/_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\nexport class EngineStoreControllerClass {\n\tprivate _store!: Store<State>;\n\tprivate _scene!: PolyScene;\n\n\tprivate static _instance: EngineStoreControllerClass;\n\tstatic instance() {\n\t\treturn (this._instance = this._instance || new EngineStoreControllerClass());\n\t}\n\n\tprivate constructor() {}\n\tset_scene(scene: PolyScene) {\n\t\tthis._scene = scene;\n\t\tthis.update_scene();\n\t}\n\tget scene() {\n\t\treturn this._scene;\n\t}\n\tset_store(store: Store<State>) {\n\t\tthis._store = store;\n\t\tthis.update_scene();\n\t}\n\n\tnode(id: string): BaseNodeType | null {\n\t\treturn this._scene.graph.node_from_id(id) as BaseNodeType;\n\t}\n\tparam(id: string): BaseParamType | null {\n\t\treturn this._scene.graph.node_from_id(id) as BaseParamType;\n\t}\n\n\t// getters\n\tjson_node(id: string): EngineNodeData | null {\n\t\treturn this._store.getters['engine/json_node'](id);\n\t}\n\tjson_param(id: string): EngineParamData | null {\n\t\treturn this._store.getters['engine/json_param'](id);\n\t}\n\tjson_children(id: string): EngineNodeData[] {\n\t\tconst json_node = this.json_node(id);\n\t\tif (json_node) {\n\t\t\treturn this._store.getters['engine/json_children'](json_node);\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n\tframe(): number {\n\t\treturn this._store.getters['engine/frame'];\n\t}\n\tframe_range(): Number2 {\n\t\treturn this._store.getters['engine/frame_range'];\n\t}\n\tframe_range_locked(): Boolean2 {\n\t\treturn this._store.getters['engine/frame_range_locked'];\n\t}\n\tplaying_state(): boolean {\n\t\treturn this._store.getters['engine/playing_state'];\n\t}\n\n\t// mutations\n\t// scene mutations\n\tupdate_scene() {\n\t\tif (this._store && this._scene) {\n\t\t\tthis._store.commit(`engine/${EngineMutation.SCENE}`);\n\t\t}\n\t}\n\tupdate_frame() {\n\t\tthis._store.commit(`engine/${EngineMutation.SCENE_FRAME_UPDATED}`);\n\t}\n\tupdate_frame_range() {\n\t\tthis._store.commit(`engine/${EngineMutation.SCENE_FRAME_RANGE_UPDATED}`);\n\t}\n\tupdate_play_state() {\n\t\tthis._store.commit(`engine/${EngineMutation.SCENE_PLAY_STATE_UPDATED}`);\n\t}\n\n\t// node mutations\n\tupdate_node_error(node_id: string) {\n\t\t// this._store.commit(`engine/${EngineMutation.NODE_ERROR_UPDATED}`, node_id);\n\t\tthis._commit(EngineMutation.NODE_ERROR_UPDATED, node_id);\n\t}\n\tupdate_node_ui_data_position(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_UI_DATA_POSITION_UPDATED, node_id);\n\t}\n\tupdate_node_ui_data_comment(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_UI_DATA_COMMENT_UPDATED, node_id);\n\t}\n\tupdate_node_selection(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_SELECTION_UPDATED, node_id);\n\t}\n\tupdate_node_display_flag(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_DISPLAY_FLAG_UPDATED, node_id);\n\t}\n\tupdate_node_bypass_flag(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_BYPASS_FLAG_UPDATED, node_id);\n\t}\n\tupdate_node_name(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_NAME_UPDATED, node_id);\n\t}\n\tupdate_node_inputs(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_INPUTS_UPDATED, node_id);\n\t}\n\tupdate_node_named_inputs(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_NAMED_INPUTS_UPDATED, node_id);\n\t}\n\tupdate_node_named_outputs(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_NAMED_OUTPUTS_UPDATED, node_id);\n\t}\n\tadd_node_params_to_store(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_ADD_PARAMS_TO_STORE, node_id);\n\t}\n\tupdate_params(node_id: string) {\n\t\tthis._commit(EngineMutation.NODE_PARAMS_UPDATED, node_id);\n\t}\n\tadd_node(node_id: string, data: EmitDataByNodeEventMap[NodeEvent.CREATED]) {\n\t\tthis._commit(EngineMutation.NODE_CREATED, {parent_id: node_id, child_node_json: data.child_node_json});\n\t}\n\tdelete_node(node_id: string, data: EmitDataByNodeEventMap[NodeEvent.DELETED]) {\n\t\tthis._commit(EngineMutation.NODE_DELETED, {parent_id: data.parent_id, child_id: node_id});\n\t}\n\n\t// params\n\tupdate_param_raw_input(param_id: string) {\n\t\tthis._commit(EngineMutation.PARAM_RAW_INPUT_UPDATED, param_id);\n\t}\n\tupdate_param_value(param_id: string) {\n\t\tthis._commit(EngineMutation.PARAM_VALUE_UPDATED, param_id);\n\t}\n\tupdate_param_expression(param_id: string) {\n\t\tthis._commit(EngineMutation.PARAM_EXPRESSION_UPDATED, param_id);\n\t}\n\tupdate_param_error(param_id: string) {\n\t\tthis._commit(EngineMutation.PARAM_ERROR_UPDATED, param_id);\n\t}\n\tupdate_param_visible_state(param_id: string) {\n\t\tthis._commit(EngineMutation.PARAM_VISIBLE_STATE, param_id);\n\t}\n\n\tprivate _commit<T extends EngineMutation>(mutation: T, arg: EnginePayloadByMutationMap[T]) {\n\t\tthis._store.commit(`engine/${mutation}`, arg);\n\t}\n}\n\nexport const EngineStoreController = EngineStoreControllerClass.instance();\n","// import lodash_find from 'lodash/find';\n// import lodash_each from 'lodash/each';\n// import lodash_includes from 'lodash/includes';\n// import lodash_filter from 'lodash/filter';\n// import lodash_keys from 'lodash/keys';\n// import lodash_map from 'lodash/map';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nimport {EditorClipboardStateModule} from './editor/Clipboard';\nimport {EditorContextMenuStateModule} from './editor/ContextMenu';\n// import CustomNode from './editor/CustomNode';\n// import DesktopLocalAssetUploadProgress from './editor/DesktopLocalAssetUploadProgress';\nimport {EditorDialogAlertStateModule} from './editor/DialogAlert';\n// import {EditorDialogPromptStateModule} from './editor/DialogConfirm';\nimport {EditorDialogPromptStateModule} from './editor/DialogPrompt';\n// import ParamNodeSelector from './editor/ParamNodeSelector';\nimport {EditorPanelStateModule} from './editor/Panel';\nimport {EditorPanelNodeSelectorStateModule} from './editor/PanelNodeSelector';\nimport {EditorNetworkStateModule} from './editor/Network';\nimport {EditorNumericSliderStateModule} from './editor/NumericSlider';\nimport {EditorDialogConfirmStateModule} from './editor/DialogConfirm';\n// import StatusBar from './editor/StatusBar';\n\n// const root_json_children = function(rootState, rootGetters, condition_method) {\n// \tconst json_root = rootGetters['engine/json_root'];\n// \tconst nodes_by_id = rootState.engine.nodes_by_graph_node_id;\n// \tlet json_nodes = lodash_map(lodash_keys(nodes_by_id), function(id) {\n// \t\tlet json_node;\n// \t\treturn (json_node = nodes_by_id[id]);\n// \t});\n\n// \tjson_nodes = lodash_filter(json_nodes, (json_node) =>\n// \t\tlodash_includes(json_root.children, json_node['graph_node_id'])\n// \t);\n\n// \treturn lodash_filter(json_nodes, condition_method);\n// };\n\n// const json_nodes_by_type = function(rootState, rootGetters, type) {\n// \tconst json_root = rootGetters['engine/json_root'];\n// \tconst nodes_by_id = rootState.engine.nodes_by_graph_node_id;\n// \tconst json_nodes = lodash_map(lodash_keys(nodes_by_id), function(id) {\n// \t\tlet json_node;\n// \t\treturn (json_node = nodes_by_id[id]);\n// \t});\n\n// \treturn lodash_filter(json_nodes, (json_node) => json_node['type'] === type);\n// };\n\nexport interface EditorState {\n\tcurrent_node_id?: string;\n\tcurrent_camera_name?: string;\n\tcurrent_node_selection_ids: string[];\n\t// forced_resize_count: 0\n\t// uploads_reload_required: boolean;\n\tdisplay_loader: boolean;\n\n\t// modules\n\t// dialog_alert: EditorDialogAlertState;\n\t// dialog_prompt: EditorDialogPromptState;\n}\n\nexport const EditortoreModule = {\n\tnamespaced: true,\n\tmodules: {\n\t\tclipboard: EditorClipboardStateModule,\n\t\tcontext_menu: EditorContextMenuStateModule,\n\t\t// custom_node: CustomNode,\n\t\t// desktop_local_asset_upload_progress: DesktopLocalAssetUploadProgress,\n\t\tdialog_alert: EditorDialogAlertStateModule,\n\t\tdialog_confirm: EditorDialogConfirmStateModule,\n\t\tdialog_prompt: EditorDialogPromptStateModule,\n\t\tnetwork: EditorNetworkStateModule,\n\t\tnumeric_slider: EditorNumericSliderStateModule,\n\t\t// param_node_selector: ParamNodeSelector,\n\t\tpanel: EditorPanelStateModule,\n\t\tpanel_node_selector: EditorPanelNodeSelectorStateModule,\n\t\t// status_bar: StatusBar,\n\t},\n\tstate(): EditorState {\n\t\treturn {\n\t\t\tcurrent_node_id: undefined,\n\t\t\tcurrent_camera_name: undefined,\n\t\t\tcurrent_node_selection_ids: [],\n\t\t\t// fps: null,\n\t\t\t// forced_resize_count: 0\n\t\t\t// uploads_reload_required: false,\n\t\t\tdisplay_loader: true,\n\t\t};\n\t},\n\t// network_properties:\n\t// \tcamera_settings_by_ids: {}\n\t// viewer_properties:\n\t// \tdisplay_topbar: true\n\t//camera_index: -1\n\t// pickers:\n\t// \tinterrupting: []\n\t// \tdefault: []\n\t// panels: []\n\n\tgetters: {\n\t\tdisplay_loader(state: EditorState) {\n\t\t\treturn state.display_loader;\n\t\t},\n\n\t\t// properties(state:EditorState) {\n\t\t// \tconst unsaved_keys = ['fps'];\n\t\t// \tconst props = {};\n\t\t// \tlodash_each(lodash_keys(state), function(key) {\n\t\t// \t\tif (!lodash_includes(unsaved_keys, key)) {\n\t\t// \t\t\treturn (props[key] = state[key]);\n\t\t// \t\t}\n\t\t// \t});\n\n\t\t// \treturn props;\n\t\t// },\n\n\t\t// viewer_properties: (state)->\n\t\t// \tstate.viewer_properties\n\n\t\tcurrent_node_id(state: EditorState) {\n\t\t\treturn state.current_node_id;\n\t\t},\n\t\t// current_json_node(state, getters, rootState) {\n\t\t// \treturn rootState.engine.nodes_by_graph_node_id[state.current_node_id];\n\t\t// },\n\t\t// fps(state) {\n\t\t// \treturn state.fps;\n\t\t// },\n\t\t// uploads_reload_required(state) {\n\t\t// \treturn state.uploads_reload_required;\n\t\t// },\n\n\t\t//\n\t\t//\n\t\t// CAMERAS\n\t\t//\n\t\t//\n\t\t// json_camera_nodes(state, getters, rootState, rootGetters) {\n\t\t// \tconst allowed_camera_types = ['perspective_camera', 'orthographic_camera', 'mapbox_camera'];\n\t\t// \treturn root_json_children(rootState, rootGetters, function(json_node) {\n\t\t// \t\tconst type = json_node['type'];\n\t\t// \t\treturn lodash_includes(allowed_camera_types, type);\n\t\t// \t});\n\t\t// },\n\t\t// // lodash_includes(type, 'camera')\n\t\t// mapbox_camera_nodes(state, getters, rootState, rootGetters) {\n\t\t// \treturn json_nodes_by_type(rootState, rootGetters, 'mapbox_camera');\n\t\t// },\n\n\t\t// current_json_camera_node(state, getters) {\n\t\t// \tconst json_cameras = getters['editor/json_camera_nodes'];\n\t\t// \tif (state.current_camera_name == null) {\n\t\t// \t\treturn json_cameras[0];\n\t\t// \t} else {\n\t\t// \t\tlet json_camera = lodash_find(\n\t\t// \t\t\tjson_cameras,\n\t\t// \t\t\t(json_camera) => json_camera.name === state.current_camera_name\n\t\t// \t\t);\n\n\t\t// \t\treturn json_camera != null ? json_camera : (json_camera = json_cameras[0]);\n\t\t// \t}\n\t\t// },\n\n\t\t//\n\t\t//\n\t\t// BY TYPE\n\t\t//\n\t\t//\n\t\t// json_event_nodes(state, getters, rootState, rootGetters) {\n\t\t// \treturn json_nodes_by_type(rootState, rootGetters, 'event');\n\t\t// },\n\n\t\t// json_picker_nodes(state, getters, rootState, rootGetters) {\n\t\t// \tconst json_nodes = json_nodes_by_type(rootState, rootGetters, 'picker');\n\t\t// \tconst non_bypassed_json_nodes = lodash_filter(json_nodes, (json_node) => !json_node['flags']['bypass']);\n\t\t// \treturn non_bypassed_json_nodes;\n\t\t// },\n\n\t\t// json_panel_nodes(state, getters, rootState, rootGetters) {\n\t\t// \treturn json_nodes_by_type(rootState, rootGetters, 'panel');\n\t\t// },\n\t},\n\n\t// network_camera_properties: (state)->\n\t// \tcurrent_node_id = state.current_node_id\n\t// \tproperties = lodash_cloneDeep state.network_properties.camera_settings_by_ids[current_node_id]\n\t// \tif !properties?\n\t// \t\tproperties = localStorage['network_camera_properties']\n\t// \t\ttry\n\t// \t\t\tproperties = JSON.parse(properties)\n\t// \t\t\tproperties = properties[current_node_id]\n\t// \t\tcatch\n\t// \t\t\tconsole.warn(\"could not parse network properties\", properties)\n\n\t// \tproperties\n\t// forced_resize_count: (state)->\n\t// \tstate.forced_resize_count\n\n\tmutations: {\n\t\t// properties: (state, properties)->\n\t\t// \tstate.current_node_id = properties.current_node_id\n\t\t// \tstate.current_camera_name = properties.current_camera_name\n\t\t// \tstate.current_node_selection_ids = properties.current_node_selection_ids\n\n\t\t// viewer_properties: (state, properties)->\n\t\t// \tVue.set(state, 'viewer_properties', properties)\n\n\t\t// network_camera_properties: (state, properties)->\n\t\t// \tcurrent_node_id = state.current_node_id\n\t\t// \tproperties = lodash_cloneDeep(properties)\n\t\t// \tstate.network_properties.camera_settings_by_ids[current_node_id] = properties\n\t\t// \tlocalStorage['network_camera_properties'] = JSON.stringify(state.network_properties.camera_settings_by_ids)\n\n\t\tcurrent_node(state: EditorState, node: BaseNodeType) {\n\t\t\tif (!node.children_allowed()) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tstate.current_node_id = node.graph_node_id;\n\t\t},\n\n\t\t// current_camera: (state, node)->\n\t\t// \tstate.current_camera_name = node.name()\n\t\t// fps(state, fps) {\n\t\t// \treturn (state.fps = fps);\n\t\t// },\n\n\t\t// force_resize: (state)->\n\t\t// \tstate.forced_resize_count += 1\n\n\t\t// set_uploads_reload_required(state) {\n\t\t// \treturn (state.uploads_reload_required = true);\n\t\t// },\n\t\t// unset_uploads_reload_required(state) {\n\t\t// \treturn (state.uploads_reload_required = false);\n\t\t// },\n\t\thide_loader(state: EditorState) {\n\t\t\treturn (state.display_loader = false);\n\t\t},\n\t},\n};\n","import Vue from 'vue';\n// font awesome from https://github.com/Justineo/vue-awesome\n// import 'vue-awesome/icons'\n// good link: https://www.w3schools.com/icons/fontawesome_icons_webapp.asp\nimport 'vue-awesome/icons/angle-left'; // decrement_frame\nimport 'vue-awesome/icons/angle-right'; // increment_frame\nimport 'vue-awesome/icons/angle-double-left'; // back to start\nimport 'vue-awesome/icons/angle-double-right'; // forward to end, operatorpath go to node\nimport 'vue-awesome/icons/angle-double-up'; // network go_up\nimport 'vue-awesome/icons/angle-double-down'; // network open_node\nimport 'vue-awesome/icons/align-left'; // operator_path open_node_selector\n// import 'vue-awesome/icons/code-branch';\n// import 'vue-awesome/icons/compress-arrows-alt';\n// import 'vue-awesome/icons/dot-circle';\nimport 'vue-awesome/icons/exclamation-triangle'; // node error\n// import 'vue-awesome/icons/map-marker-alt';\n// import 'vue-awesome/icons/palette';\nimport 'vue-awesome/icons/pause'; // playbar pause\nimport 'vue-awesome/icons/play'; // playbar play\nimport 'vue-awesome/icons/regular/circle'; // spreadsheet\nimport 'vue-awesome/icons/regular/check-square'; // spreadsheet\nimport 'vue-awesome/icons/regular/clock'; // time dependent node\nimport 'vue-awesome/icons/regular/square'; // spreadsheet\n// import 'vue-awesome/icons/sort-amount-up';\nimport 'vue-awesome/icons/spinner'; // spreadsheet\nimport 'vue-awesome/icons/square'; // spreadsheet\nimport 'vue-awesome/icons/times'; // close icons\nimport Icon from 'vue-awesome/components/Icon.vue';\nVue.component('v-icon', Icon);\n","import { render, staticRenderFns } from \"./Editor.vue?vue&type=template&id=73cf5ecf&lang=pug&\"\nimport script from \"./Editor.vue?vue&type=script&lang=ts&\"\nexport * from \"./Editor.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Editor.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('73cf5ecf')) {\n      api.createRecord('73cf5ecf', component.options)\n    } else {\n      api.reload('73cf5ecf', component.options)\n    }\n    module.hot.accept(\"./Editor.vue?vue&type=template&id=73cf5ecf&lang=pug&\", function () {\n      api.rerender('73cf5ecf', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/editor/Editor.vue\"\nexport default component.exports","import { render, staticRenderFns } from \"./Top.vue?vue&type=template&id=5389aaa9&lang=pug&\"\nimport script from \"./Top.vue?vue&type=script&lang=ts&\"\nexport * from \"./Top.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Top.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('5389aaa9')) {\n      api.createRecord('5389aaa9', component.options)\n    } else {\n      api.reload('5389aaa9', component.options)\n    }\n    module.hot.accept(\"./Top.vue?vue&type=template&id=5389aaa9&lang=pug&\", function () {\n      api.rerender('5389aaa9', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/editor/top/Top.vue\"\nexport default component.exports","import mod from \"-!../../../../node_modules/vue-style-loader/index.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDownMenu.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../node_modules/vue-style-loader/index.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDownMenu.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".dropdown_menu,.dropdown_menu_label,.dropdown_menu_label_content{display:inline-block}.dropdown_menu.on_hover:hover>.dropdown_menu_label>.dropdown_menu_pixel:not(.always_visible){display:block}.dropdown_menu li{display:block}.dropdown_menu .dropdown_menu_label{position:relative;cursor:pointer}.dropdown_menu .dropdown_menu_label .dropdown_menu_label_content:hover{opacity:.8}.dropdown_menu .dropdown_menu_label .dropdown_menu_pixel:not(.always_visible){display:none}.dropdown_menu .dropdown_menu_label .dropdown_menu_pixel.always_visible{display:block}.dropdown_menu .dropdown_menu_pixel{z-index:999;position:absolute;height:1px}.dropdown_menu .dropdown_menu_pixel.bottom_left:not(.right_aligned){bottom:0px;left:0px}.dropdown_menu .dropdown_menu_pixel.top_right{top:0px;left:100%}.dropdown_menu .dropdown_menu_pixel.right_aligned{bottom:0px;left:100%}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content{position:absolute;border:1px solid #7b7b7b;background-color:#bababa;overflow-x:hidden}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content.right_aligned{position:relative;right:100%}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content .dropdown_menu,.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content .dropdown_menu_label{display:block}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content ul{list-style-type:none;margin:0px}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content ul li .entry{padding:5px 10px;white-space:nowrap}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content ul li .entry .dropdown_menu_label{top:-5px}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content ul li .entry.disabled{cursor:default;color:#878787}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content ul li .entry.active{cursor:pointer}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content ul li .entry.active:hover{background-color:#aeaeae}.dropdown_menu .dropdown_menu_pixel .dropdown_menu_content ul li .entry .emphasis{color:#cc4b37;font-weight:bold;border-bottom:2px solid #cc4b37}.dropdown_menu .dropdown_menu_pixel .sub_entries_dropdown{position:absolute}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Top.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Top.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".TopMenu{background-color:#7b7b7b}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Alert.vue?vue&type=template&id=31ab1650&lang=pug&\"\nimport script from \"./Alert.vue?vue&type=script&lang=ts&\"\nexport * from \"./Alert.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Alert.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('31ab1650')) {\n      api.createRecord('31ab1650', component.options)\n    } else {\n      api.reload('31ab1650', component.options)\n    }\n    module.hot.accept(\"./Alert.vue?vue&type=template&id=31ab1650&lang=pug&\", function () {\n      api.rerender('31ab1650', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/dialogs/Alert.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Modal.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Polygon-Modal-Container{position:relative;width:0px;height:0px;top:0px;left:0px}.Polygon-Modal-Container .Polygon-Modal{position:absolute;z-index:100;border-radius:5px;border:2px solid gray;box-shadow:5px 5px 5px #737373;background-color:#add8e6}.Polygon-Modal-Container .Polygon-Modal .modal-grid{height:100%}.Polygon-Modal-Container .Polygon-Modal .modal-grid .Modal-title{font-weight:bold;cursor:pointer;padding:5px;border-bottom:1px solid gray}.Polygon-Modal-Container .Polygon-Modal .modal-grid .Modal-body{max-height:100%}.Polygon-Modal-Container .Polygon-Modal .modal-grid .Modal-size-handle{height:10px;background-color:green;cursor:se-resize}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Alert.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Alert.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".DialogAlert{background-color:#fff}.DialogAlert .message-container{padding:20px}.DialogAlert .buttons{padding:10px;margin-bottom:0px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Confirm.vue?vue&type=template&id=5266573c&lang=pug&\"\nimport script from \"./Confirm.vue?vue&type=script&lang=ts&\"\nexport * from \"./Confirm.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Confirm.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('5266573c')) {\n      api.createRecord('5266573c', component.options)\n    } else {\n      api.reload('5266573c', component.options)\n    }\n    module.hot.accept(\"./Confirm.vue?vue&type=template&id=5266573c&lang=pug&\", function () {\n      api.rerender('5266573c', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/dialogs/Confirm.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".DialogConfirm{background-color:#fff}.DialogConfirm .buttons{padding:10px;margin-bottom:10px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Prompt.vue?vue&type=template&id=698160d0&lang=pug&\"\nimport script from \"./Prompt.vue?vue&type=script&lang=ts&\"\nexport * from \"./Prompt.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Prompt.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('698160d0')) {\n      api.createRecord('698160d0', component.options)\n    } else {\n      api.reload('698160d0', component.options)\n    }\n    module.hot.accept(\"./Prompt.vue?vue&type=template&id=698160d0&lang=pug&\", function () {\n      api.rerender('698160d0', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/dialogs/Prompt.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Prompt.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Prompt.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".DialogPrompt{background-color:#fff}.DialogPrompt form{padding:10px}.DialogPrompt form input{margin:0}.DialogPrompt .buttons{padding:10px;margin-bottom:0px}.DialogPrompt .buttons .button{margin-bottom:0px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Multiple.vue?vue&type=template&id=4667f202&lang=pug&\"\nimport script from \"./Multiple.vue?vue&type=script&lang=ts&\"\nexport * from \"./Multiple.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Multiple.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('4667f202')) {\n      api.createRecord('4667f202', component.options)\n    } else {\n      api.reload('4667f202', component.options)\n    }\n    module.hot.accept(\"./Multiple.vue?vue&type=template&id=4667f202&lang=pug&\", function () {\n      api.rerender('4667f202', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/multiple/Multiple.vue\"\nexport default component.exports","import {MultiplePanelProps} from 'src/editor/components/types/props';\nimport {onBeforeMount} from '@vue/composition-api';\n\nimport {ISetupMultiplePanelPanels} from './Panels';\n\nexport function SetupMultiplePanelJson(\n\tprops: MultiplePanelProps,\n\tPanelsMixin: ISetupMultiplePanelPanels\n\t// image_element_ref: Ref<HTMLElement>,\n\t// {emit},\n) {\n\tonBeforeMount(() => {\n\t\t// from_json(props)\n\t});\n\n\tfunction on_component_created() {\n\t\tupdate_component_from_json();\n\t}\n\tfunction update_component_from_json() {\n\t\t// let panel_json;\n\t\t// if ((panel_json = this._from_json['panel']) != null) {\n\t\t// \tif (this.$refs.current_panel != null) {\n\t\t// \t\t// might not exist for dynamic components\n\t\t// \t\tthis.$refs.current_panel.from_json(panel_json);\n\t\t// \t}\n\t\t// }\n\t}\n\n\treturn {\n\t\ton_component_created,\n\t};\n}\n\n// export default component = {\n// \tprops: {\n// \t\tinit_properties: {\n// \t\t\ttype: Object,\n// \t\t\tdefault() {\n// \t\t\t\treturn {};\n// \t\t\t},\n// \t\t},\n// \t},\n\n// \tcreated() {\n// \t\treturn this.from_json(this.init_properties);\n// \t},\n\n// \tmethods: {\n// \t\ton_component_created() {\n// \t\t\treturn this.update_component_from_json();\n// \t\t},\n\n// \t\tupdate_component_from_json() {\n// \t\t\tlet panel_json;\n// \t\t\tif ((panel_json = this._from_json['panel']) != null) {\n// \t\t\t\tif (this.$refs.current_panel != null) {\n// \t\t\t\t\t// might not exist for dynamic components\n// \t\t\t\t\treturn this.$refs.current_panel.from_json(panel_json);\n// \t\t\t\t}\n// \t\t\t}\n// \t\t},\n\n// \t\tfrom_json(json) {\n// \t\t\tlet current_panel_index, panel_types;\n// \t\t\tthis.split_mode = json['split_mode'];\n// \t\t\tif (this.split_mode != null) {\n// \t\t\t\tlet split_panel_init_properties;\n// \t\t\t\tif ((split_panel_init_properties = json['split_panels']) != null) {\n// \t\t\t\t\tthis.split_panel_init_properties = split_panel_init_properties;\n// \t\t\t\t}\n// \t\t\t}\n\n// \t\t\tthis.split_ratio = json['split_ratio'] || 0.5;\n\n// \t\t\tif ((current_panel_index = json['current_panel_index']) != null) {\n// \t\t\t\tthis.current_panel_index = current_panel_index;\n// \t\t\t}\n\n// \t\t\tif ((panel_types = json['panel_types']) != null) {\n// \t\t\t\tthis.set_panel_types_from_json(panel_types);\n// \t\t\t}\n// \t\t\t// @panel_types = panel_types\n\n// \t\t\treturn this.$nextTick(() => {\n// \t\t\t\tthis._from_json = json;\n// \t\t\t\treturn this.update_component_from_json();\n// \t\t\t});\n// \t\t},\n\n// \t\tto_json() {\n// \t\t\tif (this.is_split) {\n// \t\t\t\treturn {\n// \t\t\t\t\tsplit_mode: this.split_mode,\n// \t\t\t\t\tsplit_ratio: this.split_ratio,\n// \t\t\t\t\tsplit_panels: [this.$refs.split_panel0.to_json(), this.$refs.split_panel1.to_json()],\n// \t\t\t\t};\n// \t\t\t} else {\n// \t\t\t\treturn this.to_json_unsplit();\n// \t\t\t}\n// \t\t},\n\n// \t\tto_json_unsplit() {\n// \t\t\treturn {\n// \t\t\t\tpanel_types: this.panel_types,\n// \t\t\t\tcurrent_panel_index: this.current_panel_index,\n// \t\t\t\tpanel: this.$refs.current_panel.to_json(),\n// \t\t\t};\n// \t\t},\n// \t},\n// };\n","import lodash_cloneDeep from 'lodash/cloneDeep';\nimport {CoreDom} from 'src/core/Dom';\nimport {MultiplePanelProps, PanelInitProperties, MultiplePanelSplitMode} from 'src/editor/components/types/props';\nimport {ref, Ref, onBeforeMount, computed, SetupContext} from '@vue/composition-api';\n\nenum MultiplePanelSplitLabel {\n\tHORIZONTAL = 'left/right',\n\tVERTICAL = 'top/bottom',\n}\n\nenum MultiplePanelSplitAction {\n\tDELETE = 'delete',\n}\n\nimport {ISetupMultiplePanelPanels} from './Panels';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nconst left_column_init_properties: PanelInitProperties = {\n\tsplit_mode: MultiplePanelSplitMode.VERTICAL,\n\tsub_panels_init_properties: [\n\t\t{\n\t\t\tpanel_types: ['viewer'],\n\t\t\tcurrent_panel_index: 0,\n\t\t},\n\t\t{\n\t\t\tpanel_types: ['param'],\n\t\t\tcurrent_panel_index: 0,\n\t\t},\n\t],\n};\n\nconst network_init_properties: PanelInitProperties = {\n\tpanel_types: ['network'],\n\tcurrent_panel_index: 0,\n};\n\nexport function SetupMultiplePanelSplit(\n\tprops: MultiplePanelProps,\n\tcontext: SetupContext,\n\telement: Ref<HTMLElement | null>,\n\tPanelsMixin: ISetupMultiplePanelPanels,\n\tinit_properties_for_split_panels: () => PanelInitProperties\n\t// image_element_ref: Ref<HTMLElement>,\n\t// {emit},\n) {\n\tconst split_mode = ref<MultiplePanelSplitMode | null>(props.init_properties.split_mode || null);\n\tconst split_panel_init_properties = ref<[PanelInitProperties, PanelInitProperties]>(\n\t\tprops.init_properties.sub_panels_init_properties || [left_column_init_properties, network_init_properties]\n\t);\n\tconst split_ratio = ref(0.5);\n\tconst cells_visible_state = computed(() => {\n\t\tconst fullscreen_panel_id = StoreController.editor.panel.fullscreen_panel_id();\n\t\tif (fullscreen_panel_id) {\n\t\t\tif (fullscreen_panel_id.includes(cell_panel_ids.value[0])) {\n\t\t\t\treturn [true, false];\n\t\t\t} else {\n\t\t\t\treturn [false, true];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [true, true];\n\t\t}\n\t});\n\tconst overriden_split_ratio = computed(() => {\n\t\tconst fullscreen_panel_id = StoreController.editor.panel.fullscreen_panel_id();\n\t\tif (fullscreen_panel_id) {\n\t\t\tif (fullscreen_panel_id.includes(cell_panel_ids.value[0])) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} else {\n\t\t\treturn split_ratio.value;\n\t\t}\n\t});\n\n\tonBeforeMount(() => {});\n\n\tconst is_split = computed(() => split_mode.value != null);\n\n\tconst is_split_horizontally = computed(\n\t\t() => is_split.value && split_mode.value == MultiplePanelSplitMode.HORIZONTAL\n\t);\n\tconst is_split_vertically = computed(() => is_split.value && split_mode.value == MultiplePanelSplitMode.VERTICAL);\n\tconst split_types = computed(() => {\n\t\tconst list = [\n\t\t\t{id: MultiplePanelSplitMode.HORIZONTAL as string, label: `split ${MultiplePanelSplitLabel.HORIZONTAL}`},\n\t\t\t{id: MultiplePanelSplitMode.VERTICAL as string, label: `split ${MultiplePanelSplitLabel.VERTICAL}`},\n\t\t];\n\n\t\tif (props.level > 0) {\n\t\t\tlist.push({id: MultiplePanelSplitAction.DELETE, label: 'delete'});\n\t\t}\n\n\t\treturn list;\n\t});\n\tconst split_container_class_object = computed(() => {\n\t\treturn {\n\t\t\t'split-panel-horizontal': is_split_horizontally.value,\n\t\t\t'split-panel-vertical': is_split_vertically.value,\n\t\t\t'full_height_container grid-x': is_split_horizontally.value,\n\t\t\t'full_height_container grid-y': is_split_vertically.value,\n\t\t};\n\t});\n\n\tconst full_screen_activated = computed(() => {\n\t\tconst fullscreen_panel_id = StoreController.editor.panel.fullscreen_panel_id();\n\t\treturn fullscreen_panel_id != null;\n\t});\n\tconst cell_panel_ids = computed(() => {\n\t\treturn [props.panel_id + ':0', props.panel_id + ':1'];\n\t});\n\tconst cell_style_objects = computed(() => {\n\t\tconst style_keys = is_split_horizontally.value ? 'width' : 'height';\n\t\tconst style0: Dictionary<string> = {};\n\t\tconst style1: Dictionary<string> = {};\n\t\tstyle0[style_keys] = `${100 * overriden_split_ratio.value}%`;\n\t\tstyle1[style_keys] = `${100 * (1 - overriden_split_ratio.value)}%`;\n\n\t\tif (!cells_visible_state.value[0]) {\n\t\t\tstyle0['display'] = 'none';\n\t\t}\n\t\tif (!cells_visible_state.value[1]) {\n\t\t\tstyle1['display'] = 'none';\n\t\t}\n\n\t\treturn [style0, style1];\n\t});\n\n\tconst split_panel_separator_style_object = computed(() => {\n\t\tif (is_split_horizontally.value) {\n\t\t\treturn {left: `${100 * split_ratio.value}%`};\n\t\t} else {\n\t\t\treturn {top: `${100 * split_ratio.value}%`};\n\t\t}\n\t});\n\n\t// functions\n\tfunction set_split_mode(mode: MultiplePanelSplitMode | MultiplePanelSplitAction) {\n\t\tif (mode === MultiplePanelSplitAction.DELETE) {\n\t\t\tcontext.emit('delete', props.panel_id);\n\t\t} else {\n\t\t\tsplit_mode.value = mode;\n\t\t\tsplit_panel_init_properties.value = [\n\t\t\t\tlodash_cloneDeep(init_properties_for_split_panels()),\n\t\t\t\tlodash_cloneDeep(init_properties_for_split_panels()),\n\t\t\t];\n\t\t}\n\t}\n\n\tfunction delete_split_panel(index: number) {\n\t\tPanelsMixin.set_panel_types_from_split_panel(index);\n\t\tsplit_mode.value = null;\n\t}\n\n\tconst current_element_bbox = {\n\t\tmin: {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t},\n\t\tsize: {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t},\n\t};\n\tfunction on_move_start(e: MouseEvent) {\n\t\tif (!element.value) {\n\t\t\treturn;\n\t\t}\n\t\tconst rect = element.value.getBoundingClientRect();\n\t\tcurrent_element_bbox.min.x = rect.left;\n\t\tcurrent_element_bbox.min.y = rect.top;\n\t\tcurrent_element_bbox.size.x = element.value.offsetWidth;\n\t\tcurrent_element_bbox.size.y = element.value.offsetHeight;\n\n\t\tCoreDom.add_drag_classes();\n\t\tdocument.addEventListener('mousemove', on_move_drag);\n\t\tdocument.addEventListener('mouseup', on_move_end);\n\t}\n\n\tfunction on_move_drag(e: MouseEvent) {\n\t\tconst current_mouse_pos = {\n\t\t\tx: e.pageX,\n\t\t\ty: e.pageY,\n\t\t};\n\n\t\tconst ratio = {\n\t\t\tx: (current_mouse_pos.x - current_element_bbox.min.x) / current_element_bbox.size.x,\n\t\t\ty: (current_mouse_pos.y - current_element_bbox.min.y) / current_element_bbox.size.y,\n\t\t};\n\n\t\tsplit_ratio.value = is_split_horizontally.value ? ratio.x : ratio.y;\n\t}\n\n\tfunction on_move_end(e: MouseEvent) {\n\t\tdocument.removeEventListener('mousemove', on_move_drag);\n\t\tdocument.removeEventListener('mouseup', on_move_end);\n\t\tCoreDom.remove_drag_classes();\n\n\t\twindow.dispatchEvent(new Event('resize'));\n\t}\n\n\treturn {\n\t\tis_split,\n\t\ton_move_start,\n\t\tdelete_split_panel,\n\t\tset_split_mode,\n\t\tsplit_mode,\n\t\tfull_screen_activated,\n\t\tsplit_panel_separator_style_object,\n\t\tcell_panel_ids,\n\t\tcell_style_objects,\n\t\tsplit_container_class_object,\n\t\tsplit_types,\n\t\tsplit_panel_init_properties,\n\t};\n}\n","import { render, staticRenderFns } from \"./Network.vue?vue&type=template&id=7de911dd&lang=pug&\"\nimport script from \"./Network.vue?vue&type=script&lang=ts&\"\nexport * from \"./Network.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Network.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('7de911dd')) {\n      api.createRecord('7de911dd', component.options)\n    } else {\n      api.reload('7de911dd', component.options)\n    }\n    module.hot.accept(\"./Network.vue?vue&type=template&id=7de911dd&lang=pug&\", function () {\n      api.rerender('7de911dd', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/Network.vue\"\nexport default component.exports","import {CameraAnimationHelper, CameraData} from '../helpers/CameraAnimation';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nexport interface SetupCameraOptions {\n\tzoom_container_style_object: Ref<{\n\t\ttransform: string;\n\t}>;\n\tpan_container_style_object: Ref<{left: string; top: string}>;\n\t// object_parents_style_object,\n\tsave_camera_history_for_json_node: (id: string) => void;\n}\n\nimport {watch, onMounted, Ref, computed} from '@vue/composition-api';\nexport function SetupCamera(\n\tcanvas: Ref<HTMLCanvasElement | null>,\n\tcamera_data: Ref<CameraData>,\n\tcamera_history: Dictionary<CameraData>,\n\tcam_animation_helper: CameraAnimationHelper\n): SetupCameraOptions {\n\tonMounted(() => {\n\t\tif (canvas.value) {\n\t\t\tcam_animation_helper.set_element(canvas.value);\n\t\t\tset_camera_helper_node();\n\t\t}\n\t});\n\n\tconst zoom_container_style_object = computed(() => {\n\t\treturn {\n\t\t\ttransform: `scale(${camera_data.value.zoom})`,\n\t\t};\n\t});\n\tconst pan_container_style_object = computed(() => {\n\t\treturn {\n\t\t\tleft: `${camera_data.value.position.x}px`,\n\t\t\ttop: `${camera_data.value.position.y}px`,\n\t\t};\n\t});\n\t// const object_parents_style_object = computed(() => {\n\t// \treturn {};\n\t// });\n\n\tconst current_node_graph_id = computed(() => StoreController.editor.current_node_graph_id());\n\twatch(current_node_graph_id, (node_graph_id, prev_node_graph_id) => {\n\t\tif (prev_node_graph_id) {\n\t\t\tsave_camera_history_for_json_node(prev_node_graph_id);\n\t\t}\n\t\tif (node_graph_id) {\n\t\t\tload_camera_history_for_json_node(node_graph_id);\n\t\t}\n\t\t// this.$nextTick(() => {\n\t\tset_camera_helper_node();\n\t\t// });\n\t});\n\n\t// functions\n\tfunction set_camera_helper_node() {\n\t\tcam_animation_helper.set_parent_node(StoreController.editor.current_node());\n\t}\n\n\t// function set_camera_history(history: Dictionary<CameraData>) {\n\t// \tcamera_history = json || {};\n\t// }\n\t// function camera_history() {\n\t// \tthis._camera_history = this._camera_history || {}\n\t// }\n\t// function camera_history_for_node(graph_node_id: string) {\n\t// \treturn camera_history[graph_node_id];\n\t// }\n\tfunction save_camera_history_for_json_node(graph_node_id: string) {\n\t\tcamera_history[graph_node_id] = {\n\t\t\tposition: {\n\t\t\t\tx: camera_data.value.position.x,\n\t\t\t\ty: camera_data.value.position.y,\n\t\t\t},\n\t\t\tzoom: camera_data.value.zoom,\n\t\t};\n\t}\n\tfunction load_camera_history_for_json_node(graph_node_id: string) {\n\t\tconst node_history = camera_history[graph_node_id];\n\t\tif (node_history) {\n\t\t\tcamera_data.value.zoom = node_history.zoom;\n\t\t\tcamera_data.value.position.x = node_history.position.x;\n\t\t\tcamera_data.value.position.y = node_history.position.y;\n\t\t}\n\t}\n\n\treturn {\n\t\tzoom_container_style_object,\n\t\tpan_container_style_object,\n\t\t// object_parents_style_object,\n\t\tsave_camera_history_for_json_node,\n\t};\n}\n","import {ClipBoardHelper} from '../helpers/ClipBoard';\nimport {NodeDeleteCommand} from 'src/editor/history/commands/NodeDelete';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {CameraAnimationHelper} from '../helpers/CameraAnimation';\nimport {TabMenuOptions} from './TabMenuOwner';\n\nexport function SetupEventKey(\n\tclipboard_helper: ClipBoardHelper,\n\tcam_animation_helper: CameraAnimationHelper,\n\ttab_menu_options: TabMenuOptions\n) {\n\tfunction on_key_press(event: KeyboardEvent) {\n\t\treturn false;\n\t}\n\t// better to have Tab on key down,\n\t// otherwise, it gets detected when switching windows with alt+tab\n\tfunction on_key_down(event: KeyboardEvent): boolean {\n\t\tlet key_processed = true;\n\t\tif (event.ctrlKey) {\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'x':\n\t\t\t\t\tcut();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'c':\n\t\t\t\t\tcopy();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'v':\n\t\t\t\t\tpaste();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tkey_processed = false;\n\t\t\t}\n\t\t} else {\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'Delete':\n\t\t\t\t\tdelete_selected_nodes();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'f':\n\t\t\t\t\tcam_animation_helper.frame_selection();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Escape':\n\t\t\t\t\ttab_menu_options.close_tab_menu();\n\t\t\t\t\ttab_menu_options.close_node_create();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Tab':\n\t\t\t\t\ttab_menu_options.toggle_tab_menu();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t//this.add_to_context_menu_filter(event.key)\n\t\t\t\t\tkey_processed = false;\n\t\t\t}\n\t\t}\n\n\t\treturn key_processed;\n\t}\n\n\tfunction on_key_up(event: KeyboardEvent) {\n\t\treturn false;\n\t}\n\n\tfunction delete_selected_nodes() {\n\t\tconst node = StoreController.editor.current_node();\n\t\tif (node && node.children_allowed() && node.children_controller) {\n\t\t\tconst command = new NodeDeleteCommand(node, node.children_controller.selection.nodes());\n\t\t\tcommand.push();\n\t\t}\n\t}\n\n\t//\n\t//\n\t// BUFFER COPY/PASTE\n\t//\n\t//\n\tfunction cut() {}\n\t//\n\tfunction copy() {\n\t\tconst node = StoreController.editor.current_node();\n\t\tif (node && node.children_allowed() && node.children_controller) {\n\t\t\tclipboard_helper.copy_from_node(node, node.children_controller.selection.nodes());\n\t\t}\n\t}\n\tfunction paste() {\n\t\tconst node = StoreController.editor.current_node();\n\t\tif (node) {\n\t\t\tclipboard_helper.paste_in_node(node, cam_animation_helper);\n\t\t}\n\t}\n\n\treturn {\n\t\ton_key_press,\n\t\ton_key_down,\n\t\ton_key_up,\n\t\tdelete_selected_nodes,\n\t\tcut,\n\t\tcopy,\n\t\tpaste,\n\t};\n}\n","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {NodesCodeExporter} from 'src/engine/io/code/export/Nodes';\nimport lodash_values from 'lodash/values';\n\n// TODO:\n// when I delete a node plugged on the second input (of a copy SOP for instance)\n// the re-created connections are messed up\n\nconst TMP_PARENT = 'tmp_parent';\n\nexport class NodeDeleteCommand extends BaseCommand {\n\tprivate _undo_code_lines: string[] = [];\n\tprivate _required_nodes_code_by_name: Dictionary<string> = {};\n\tprivate _required_outputs_code_by_name: Map<string, Map<number, string>> = new Map();\n\t// private _old_selected_nodes: BaseNode[]\n\t// private _old_display_node_name: string | undefined;\n\n\tconstructor(private _parent: BaseNodeType, private _nodes: BaseNodeType[]) {\n\t\tsuper();\n\t\tthis.prepare();\n\t}\n\n\tprepare() {\n\t\tconst exporter = new NodesCodeExporter(this._nodes);\n\t\tthis._undo_code_lines = exporter.process(TMP_PARENT);\n\n\t\tconst required_nodes_by_name: Dictionary<BaseNodeType> = {};\n\t\tthis._nodes.forEach((node) => {\n\t\t\tnode.io.inputs.inputs().forEach((input) => {\n\t\t\t\tif (input) {\n\t\t\t\t\tconst name = input.name;\n\t\t\t\t\trequired_nodes_by_name[name] = input;\n\t\t\t\t}\n\t\t\t});\n\t\t\tnode.io.connections.output_connections().forEach((output_connection) => {\n\t\t\t\tif (output_connection) {\n\t\t\t\t\tconst output_node = output_connection.node_dest;\n\t\t\t\t\tconst name = output_node.name;\n\t\t\t\t\trequired_nodes_by_name[name] = output_node;\n\t\t\t\t\tconst input_index = output_connection.input_index;\n\t\t\t\t\tconst output_index = output_connection.output_index;\n\n\t\t\t\t\tif (!this._required_outputs_code_by_name.get(name)) {\n\t\t\t\t\t\tthis._required_outputs_code_by_name.set(name, new Map());\n\t\t\t\t\t}\n\t\t\t\t\tconst line = `${name}.set_input(${input_index}, ${node.name}, ${output_index})`;\n\t\t\t\t\tthis._required_outputs_code_by_name.get(name)!.set(input_index, line);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tlodash_values(required_nodes_by_name).forEach((node) => {\n\t\t\tconst name = node.name;\n\t\t\tthis._required_nodes_code_by_name[name] = `const ${name} = ${TMP_PARENT}.node('${name}')`;\n\t\t});\n\n\t\t// this._old_selected_nodes = [];\n\t}\n\n\tdo() {\n\t\tthis._nodes.forEach((node) => {\n\t\t\tthis._remove_node(node);\n\t\t});\n\n\t\tthis._change_display_flag();\n\t}\n\n\tundo() {\n\t\tthis._parent.scene.lifecycle_controller.on_create_prevent(() => {\n\t\t\tconst start_lines: string[] = lodash_values(this._required_nodes_code_by_name);\n\t\t\tconst end_lines: string[] = [];\n\t\t\tthis._required_outputs_code_by_name.forEach((map, name) => {\n\t\t\t\tmap.forEach((line, index) => {\n\t\t\t\t\tend_lines.push(line);\n\t\t\t\t});\n\t\t\t});\n\t\t\tlodash_values(this._required_outputs_code_by_name).map((o) => lodash_values(o));\n\t\t\tconst empty_string_array: string[] = [];\n\t\t\tconst all_code_lines: string[] = empty_string_array.concat(start_lines, this._undo_code_lines, end_lines);\n\t\t\tconst code = all_code_lines.join('\\n');\n\t\t\tconst create_node_function = new Function(TMP_PARENT, code);\n\t\t\tcreate_node_function(this._parent);\n\t\t\t// this.nodes.forEach((node)=>{\n\t\t\t// \tthis.parent.add_node(node);\n\t\t\t// });\n\n\t\t\tthis._revert_display_flag();\n\t\t\t// this._revert_inputs();\n\t\t\t// this._revert_selection();\n\t\t});\n\t}\n\n\t// update selection (just remove from it)\n\t// update display flag (take any other node for now)\n\t// update inputs/outputs (how does a node know its output?? via the graph!)\n\t// set old dependencies dirty? (set_input takes care of it, but not expressions which cannot evaluate anymore)\n\tprivate _remove_node(node: BaseNodeType) {\n\t\t// this._remove_node_from_selection(node);\n\t\t// this._remove_inputs(node);\n\n\t\tthis._parent.remove_node(node);\n\t}\n\n\tprivate _change_display_flag() {\n\t\t// TODO: typescript check this\n\t\t// const display_node = this._parent.display_node();\n\t\t// if (display_node) {\n\t\t// \tif (lodash_includes(this._nodes, display_node)) {\n\t\t// \t\tthis._old_display_node_name = display_node.name();\n\t\t// \t\tthis._parent.set_display_node(this._parent.children()[0]);\n\t\t// \t}\n\t\t// }\n\t}\n\tprivate _revert_display_flag() {\n\t\t// TODO: typescript check this\n\t\t// if (this._old_display_node_name) {\n\t\t// \tconst old_display_node = this._parent.node(this._old_display_node_name);\n\t\t// \tthis._parent.set_display_node(old_display_node);\n\t\t// }\n\t}\n\n\t// private _remove_inputs(node){\n\t// \tconst output_nodes = node.outputs();\n\n\t// \tconst input = node.input(0);\n\t// \tconsole.log(output_nodes)\n\t// \toutput_nodes.forEach((output_node)=> {\n\n\t// \t\toutput_node.inputs().forEach((input_node, i)=>{\n\t// \t\t\tif(input_node && input_node.graph_node_id() == node.graph_node_id()){\n\t// \t\t\t\t// this._old_inputs[output.graph_node_id()] = output.input(0);\n\t// \t\t\t\toutput_node.set_input(i, null)\n\t// \t\t\t\tconsole.log(`removed ${i} from ${output_node.name()}`)\n\t// \t\t\t}\n\t// \t\t})\n\t// \t\toutput_node.set_input(0, input);\n\t// \t\tconsole.log(`set ${input.name()} to ${output_node.name()}`)\n\t// \t});\n\t// \tconsole.log(\"remove inputs done\")\n\t// }\n\t// private _revert_inputs() {\n\t// \tObject.keys(this._old_inputs).forEach((id)=> {\n\t// \t\tconst node = this._scene.graph().node_from_id(id);\n\t// \t\t// const input = this._old_inputs[id];\n\t// \t\tnode.set_input(0, input);\n\t// \t});\n\t// }\n\n\t// private _remove_node_from_selection(node: BaseNode){\n\t// \tif (this.parent.selection().contains(node)) {\n\t// \t\t// this._old_selected_nodes.push(node);\n\t// \t\tthis.parent.selection().remove(node);\n\t// \t}\n\t// }\n\n\t// private _revert_selection() {\n\t// \tthis._old_selected_nodes.forEach((node)=> {\n\t// \t\tthis.parent.selection().add(node);\n\t// \t});\n\t// }\n}\n","import lodash_sortBy from 'lodash/sortBy';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {SceneCodeExporter} from './Scene';\nimport {NodesCodeExporter} from './Nodes';\nimport {CodeExporterDispatcher} from './Dispatcher';\n\ninterface PositionData {\n\tposition_x_offset?: number;\n}\n\nexport class NodeCodeExporter {\n\t_lines: string[] = [];\n\tconstructor(protected _node: BaseNodeType) {}\n\n\tcreate(parent_var_name?: string): string[] {\n\t\tthis.reset();\n\n\t\tif (!this.is_root()) {\n\t\t\tthis.add_create(parent_var_name);\n\t\t\tthis.add_name();\n\t\t}\n\t\tthis.add_children();\n\t\tthis.add_selection();\n\n\t\tthis.add_position({});\n\t\tthis.add_input_clonable_state();\n\t\tthis.add_bypass_flag();\n\t\tthis.add_display_flag();\n\t\tthis.add_params();\n\t\tthis.add_custom();\n\n\t\tthis._lines.push(`${this.var_name()}.lifecycle.set_creation_completed();`);\n\n\t\treturn this._lines;\n\t}\n\n\tset_up(options: object = {}): string[] {\n\t\tthis.reset();\n\n\t\tthis.add_input();\n\t\t// this.add_position(options)\n\t\t// this.add_bypass_flag()\n\t\t// this.add_params()\n\t\t// this.add_children()\n\t\t// this.add_custom()\n\t\t// this.add_selection()\n\n\t\treturn this._lines;\n\t}\n\t// children_and_selection(): string[]{\n\t// \tthis.reset()\n\t// \tthis.add_children()\n\t// \tthis.add_selection()\n\t// }\n\tcreate_function_declare(parent_var_name = 'parent'): string[] {\n\t\tthis._node.scene.nodes_controller.register_node_context_signature(this._node);\n\n\t\tconst ls: string[] = [];\n\t\tls.push(`function ${this.function_name()}(${parent_var_name}){`);\n\t\tthis.create(parent_var_name).forEach((l) => {\n\t\t\tls.push(`\t${l}`);\n\t\t});\n\t\tls.push(`\treturn ${this.var_name()}`);\n\t\tls.push(`}`);\n\t\treturn ls;\n\t}\n\tcreate_function_call(parent_var_name?: string): string {\n\t\tif (parent_var_name == null) {\n\t\t\tif (this._node.parent) {\n\t\t\t\tparent_var_name = CodeExporterDispatcher.dispatch_node(this._node.parent).var_name(); //.visit(CodeExporterVisitor).var_name()\n\t\t\t}\n\t\t}\n\t\treturn `var ${this.var_name()} = ${this.function_name()}(${parent_var_name})`;\n\t}\n\n\tvar_name(): string {\n\t\tif (this.is_root()) {\n\t\t\tconst scene_exporter = new SceneCodeExporter(this._node.scene);\n\t\t\treturn `${scene_exporter.var_name()}.root`;\n\t\t} else {\n\t\t\t// add a _ in front in case the name starts by a number\n\t\t\t// return `context._${this._node.full_path().replace(/\\//g, '_').substr(1)}`;\n\t\t\treturn this._node.name.replace(/\\//g, '_');\n\t\t}\n\t}\n\tprotected function_name(): string {\n\t\treturn 'create_' + this.var_name().replace(/[^a-z0-9]/gim, '_');\n\t}\n\n\tprivate is_root() {\n\t\treturn this._node.parent === null && this._node.graph_node_id == this._node.root.graph_node_id;\n\t}\n\n\tprivate reset() {\n\t\tthis._lines = [];\n\t}\n\n\tprotected add_create(parent_var_name?: string) {\n\t\tif (parent_var_name == null) {\n\t\t\tif (this._node.parent) {\n\t\t\t\tconst parent_exporter = CodeExporterDispatcher.dispatch_node(this._node.parent);\n\t\t\t\tparent_var_name = parent_exporter.var_name();\n\t\t\t}\n\t\t}\n\t\tconst create_node_line = `var ${this.var_name()} = ${parent_var_name}.create_node('${this._node.type}')`;\n\t\tthis._lines.push(create_node_line);\n\t}\n\n\tprotected add_name() {\n\t\tif (this._node.graph_node_id !== this._node.root.graph_node_id) {\n\t\t\tthis._lines.push(`${this.var_name()}.set_name('${this._node.name}')`);\n\t\t}\n\t}\n\n\tprotected add_input() {\n\t\tthis._node.io.inputs.inputs().forEach((input, input_index) => {\n\t\t\t// const input = this._node.input(input_index);\n\t\t\tconst input_connection = this._node.io.connections.input_connection(input_index);\n\t\t\tif (input && input_connection) {\n\t\t\t\tconst output_index = input_connection.output_index;\n\t\t\t\tconst input_exporter = CodeExporterDispatcher.dispatch_node(input);\n\t\t\t\tlet line;\n\t\t\t\tif (this._node.io.inputs.has_named_inputs) {\n\t\t\t\t\tconst input_connection_point_name = this._node.io.inputs.named_input_connection_points[input_index]\n\t\t\t\t\t\t.name;\n\t\t\t\t\tconst output_name = input.io.outputs.named_output_connection_points[output_index].name;\n\t\t\t\t\tline = `${this.var_name()}.set_input('${input_connection_point_name}', ${input_exporter.var_name()}, '${output_name}')`;\n\t\t\t\t} else {\n\t\t\t\t\tline = `${this.var_name()}.set_input(${input_index}, ${input_exporter.var_name()})`;\n\t\t\t\t}\n\t\t\t\tthis._lines.push(line);\n\t\t\t}\n\t\t});\n\t}\n\tprotected add_position(options: PositionData = {}) {\n\t\tif (this._node.parent) {\n\t\t\t// if not root\n\t\t\tlet x_offset;\n\t\t\tconst pos = this._node.ui_data.position.clone();\n\t\t\tif ((x_offset = options['position_x_offset']) != null) {\n\t\t\t\tpos.x += x_offset;\n\t\t\t}\n\t\t\tthis._lines.push(`${this.var_name()}.ui_data.set_position(${pos.x}, ${pos.y})`);\n\t\t}\n\t}\n\n\tprotected add_params() {\n\t\tthis._node.params.all.forEach((param) => {\n\t\t\tconst param_exporter = CodeExporterDispatcher.dispatch_param(param);\n\t\t\tconst param_lines: string[] = param_exporter.process();\n\t\t\tparam_lines.forEach((param_line) => {\n\t\t\t\tthis._lines.push(param_line);\n\t\t\t});\n\t\t});\n\n\t\t// to ensure that gl nodes like the constant and attribute have their inputs/outputs updated\n\t\tthis._lines.push(`${this.var_name()}.params.run_on_scene_load_hooks()`);\n\t}\n\n\tprotected add_input_clonable_state() {\n\t\tif (this._node.io.inputs.override_clonable_state_allowed()) {\n\t\t\tconst override = this._node.io.inputs.override_clonable_state();\n\t\t\tif (override) {\n\t\t\t\tthis._lines.push(`${this.var_name()}.io.inputs.set_override_clonable_state(true)`);\n\t\t\t}\n\t\t}\n\t}\n\tprotected add_bypass_flag() {\n\t\tif (this._node.flags?.has_bypass()) {\n\t\t\tif (this._node.flags.bypass?.active) {\n\t\t\t\tthis._lines.push(`${this.var_name()}.flags.bypass.set(true)`);\n\t\t\t}\n\t\t}\n\t}\n\tprotected add_display_flag() {\n\t\tif (this._node.flags?.has_display()) {\n\t\t\tif (this._node.flags.display?.active) {\n\t\t\t\tthis._lines.push(`${this.var_name()}.flags.display.set(true)`);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected add_children() {\n\t\tconst children = lodash_sortBy(this._node.children(), (child) => child.name);\n\t\tconst nodes_exporter = new NodesCodeExporter(children);\n\t\tnodes_exporter.process().forEach((child_line) => {\n\t\t\tthis._lines.push(child_line);\n\t\t});\n\t}\n\t// protected add_children_function_declare(){\n\t// \tconst nodes_exporter = new NodesExporter(this._node.children())\n\t// \tnodes_exporter.create_function_declare().forEach(child_line=>{\n\t// \t\tthis._lines.push(child_line)\n\t// \t})\n\t// }\n\t// protected add_children_function_call(){\n\t// \tconst nodes_exporter = new NodesExporter(this._node.children())\n\t// \tnodes_exporter.create_function_call().forEach(child_line=>{\n\t// \t\tthis._lines.push(child_line)\n\t// \t})\n\t// }\n\n\tprotected add_custom() {}\n\n\tprotected add_selection() {\n\t\tif (this._node.children_controller?.selection != null) {\n\t\t\tfor (let node of this._node.children_controller.selection.nodes()) {\n\t\t\t\tconst node_exporter = CodeExporterDispatcher.dispatch_node(node);\n\t\t\t\tthis._lines.push(`${this.var_name()}.children_controller.selection.add(${node_exporter.var_name()})`);\n\t\t\t}\n\t\t}\n\t}\n}\n","import {ParamCodeExporter} from '../Param';\nimport {CodeExporterDispatcher} from '../Dispatcher';\nimport {TypedMultipleParam} from 'src/engine/params/_Multiple';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nexport class ParamMultipleCodeExporter extends ParamCodeExporter<TypedMultipleParam<ParamType>> {\n\tas_code_default_value_string() {\n\t\tlet values = this._param.components.map((c) => c.value);\n\t\treturn `[${values.join(',')}]`;\n\t}\n\tadd_main() {\n\t\tthis._param.components.forEach((component) => {\n\t\t\tCodeExporterDispatcher.dispatch_param(component)\n\t\t\t\t.process()\n\t\t\t\t.forEach((component_line) => {\n\t\t\t\t\tthis._lines.push(component_line);\n\t\t\t\t});\n\t\t});\n\t}\n}\n","import {ParamCodeExporter} from '../Param';\nimport {TypedNumericParam} from 'src/engine/params/_Numeric';\nimport {ParamType} from 'src/engine/poly/ParamType';\n\nexport class ParamNumericCodeExporter extends ParamCodeExporter<TypedNumericParam<ParamType>> {\n\tadd_main() {\n\t\tif (this._param.has_expression() && this._param.expression_controller) {\n\t\t\tconst escaped_expression = this._param.expression_controller.expression?.replace(/'/g, \"\\\\'\");\n\t\t\tthis._lines.push(this.prefix() + `.set('${escaped_expression}')`);\n\t\t} else {\n\t\t\tthis._lines.push(this.prefix() + `.set(${this._param.value})`);\n\t\t}\n\t}\n}\n","import {ParamCodeExporter} from '../Param';\nimport {OperatorPathParam} from 'src/engine/params/OperatorPath';\n\nexport class ParamOperatorPathCodeExporter extends ParamCodeExporter<OperatorPathParam> {\n\tas_code_default_value_string() {\n\t\treturn `'${this._param.default_value}'`;\n\t}\n\n\tadd_main() {\n\t\tlet val = this._param.value;\n\t\tval = val.replace(/'/g, \"\\\\'\");\n\t\tconst line = this.prefix() + `.set('${val}')`;\n\t\tthis._lines.push(line);\n\t}\n}\n","import lodash_isString from 'lodash/isString';\nimport {ParamCodeExporter} from '../Param';\nimport {SceneCodeExporter} from '../Scene';\nimport {StringParam} from 'src/engine/params/String';\n\nexport class ParamStringCodeExporter extends ParamCodeExporter<StringParam> {\n\tas_code_default_value_string() {\n\t\treturn `'${this._param.default_value}'`;\n\t}\n\n\tadd_main() {\n\t\t// if this.has_expression()\n\t\t// \tthis.as_code_prefix() + \".set_expression('#{this.expression()}')\"\n\t\t// else\n\t\tlet val = this._param.raw_input;\n\t\tif (lodash_isString(val)) {\n\t\t\tval = SceneCodeExporter.sanitize_string(val);\n\t\t}\n\t\t// if (this._param.has_expression()){\n\t\t// \tval = this.expression()\n\t\t// }\n\t\t// if (lodash_isString(val)){\n\t\t// \tval = val.replace(/'/g, \"\\\\'\"); // escapes '\n\t\t// \tval = val.replace(/(\\r\\n|\\n|\\r)/gm, \"\\\\n\"); // escapes line breaks (for shader code for instance)\n\t\t// }\n\t\tconst line = this.prefix() + `.set('${val}')`;\n\t\tthis._lines.push(line);\n\t}\n}\n","import {ParamCodeExporter} from '../Param';\nimport {RampParam} from 'src/engine/params/Ramp';\n\nexport class ParamRampCodeExporter extends ParamCodeExporter<RampParam> {\n\tdefault_value() {\n\t\treturn JSON.stringify(this._param.default_value_serialized);\n\t}\n\n\tadd_main() {\n\t\tlet val = this._param.value;\n\t\tconst json = val.to_json();\n\t\tconst line = this.prefix() + `.set('${JSON.stringify(json)}')`;\n\t\tthis._lines.push(line);\n\t}\n}\n","// import EventHelper from '../../Helper/Event';\nimport {MouseButton} from 'src/editor/core/MouseButton';\n\nimport {ref, computed} from '@vue/composition-api';\nimport {NodeAnimationHelper} from '../helpers/NodeAnimation';\nimport {ConnectionHelper} from '../helpers/Connection';\nimport {NodeSelectionHelper} from '../helpers/NodeSelection';\nimport {CameraAnimationHelper} from '../helpers/CameraAnimation';\nimport {NodeCreationHelper} from '../helpers/NodeCreation';\nimport {TabMenuOptions} from './TabMenuOwner';\nimport {KeyEventsDispatcher, KeyEventProcessor} from 'src/editor/helpers/KeyEventsDispatcher';\nimport {SetupCameraOptions} from './Camera';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nexport interface Helpers {\n\tnode_animation_helper: NodeAnimationHelper;\n\tconnection_helper: ConnectionHelper;\n\tnode_selection_helper: NodeSelectionHelper;\n\tcam_animation_helper: CameraAnimationHelper;\n\tnode_creation_helper: NodeCreationHelper;\n}\ninterface Options {\n\tevent_key_options: KeyEventProcessor;\n\ttab_menu_options: TabMenuOptions;\n\tcamera_options: SetupCameraOptions;\n}\n\nexport function SetupEventMouse(helpers: Helpers, options: Options) {\n\tconst {\n\t\tnode_animation_helper,\n\t\tconnection_helper,\n\t\tnode_selection_helper,\n\t\tcam_animation_helper,\n\t\tnode_creation_helper,\n\t} = helpers;\n\tconst {event_key_options, tab_menu_options, camera_options} = options;\n\n\tconst pan_in_progress = ref(false);\n\tconst zoom_in_progress = ref(false);\n\n\tconst canvas_class_object = computed(() => {\n\t\treturn {\n\t\t\tpan_in_progress: pan_in_progress.value,\n\t\t\tzoom_in_progress: zoom_in_progress.value,\n\t\t};\n\t});\n\n\tfunction on_mouse_down(event: MouseEvent) {\n\t\t// this._registered_mouse_down = true;\n\n\t\tswitch (event.button) {\n\t\t\tcase MouseButton.LEFT:\n\t\t\t\t// var intersect = this.ray_helper.intersected_mesh_with_callback(event, 'mouse_down', this.camera);\n\t\t\t\t// if (intersect != null) {\n\t\t\t\t// \tintersect.callbacks['mouse_down']();\n\t\t\t\t// } else {\n\t\t\t\t// \tif (this.node_selection_helper != null) {\n\t\t\t\t// \t\tthis.node_selection_helper.move_start(event);\n\t\t\t\t// \t}\n\t\t\t\t// }\n\t\t\t\tconst node_animation_started = node_animation_helper.move_start(event);\n\t\t\t\tif (node_animation_started) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst connection_started = connection_helper.move_start(event);\n\t\t\t\tif (connection_started) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tnode_selection_helper.move_start(event);\n\t\t\t\t//this.connection_helper.move_start(event);\n\t\t\t\tbreak;\n\n\t\t\tcase MouseButton.MIDDLE:\n\t\t\t\tcam_animation_helper.pan_start(event);\n\t\t\t\tpan_in_progress.value = true;\n\t\t\t\tbreak;\n\n\t\t\tcase MouseButton.RIGHT:\n\t\t\t\tcam_animation_helper.zoom_start(event);\n\t\t\t\tzoom_in_progress.value = true;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfunction on_mouse_move(event: MouseEvent) {\n\t\tKeyEventsDispatcher.instance().register_processor(event_key_options);\n\n\t\ttab_menu_options.update_tab_menu_position(event);\n\n\t\t// this._current_mouse_pos = {x: event.pageX, y: event.pageY};\n\t\t// this._current_mouse_pos_on_plane = this.ray_helper.intersect_plane_from_event(event, this.camera);\n\n\t\tcam_animation_helper.pan_progress(event);\n\t\tcam_animation_helper.zoom_progress(event);\n\n\t\tnode_animation_helper.move_progress(event);\n\t\tnode_creation_helper.move_progress(event);\n\t\tconnection_helper.move_progress(event);\n\t\tnode_selection_helper.move_progress(event);\n\t}\n\tfunction on_mouse_up(event: MouseEvent) {\n\t\tconst move_in_progress = node_animation_helper.move_in_progress() || cam_animation_helper.move_in_progress();\n\n\t\t// console.log(\"move_in_progress\", move_in_progress, this.node_selection_helper.mouse_barely_moved(event))\n\t\t//if (this.node_selection_helper != null) {\n\t\t// if(!move_in_progress){\n\t\tconst node_move_barely_moved = node_animation_helper.mouse_barely_moved();\n\t\tnode_selection_helper.move_end(event, move_in_progress, node_move_barely_moved);\n\t\t// }\n\t\t// if( move_in_progress && this.node_selection_helper.mouse_barely_moved(event) ){\n\t\t// \tthis.node_selection_helper.move_end(event, move_in_progress)\n\t\t// }\n\t\t//}\n\n\t\tcam_animation_helper.pan_end();\n\t\tcam_animation_helper.zoom_end();\n\t\tzoom_in_progress.value = false;\n\t\tpan_in_progress.value = false;\n\n\t\tnode_animation_helper.move_end();\n\t\tconnection_helper.move_end();\n\n\t\t// tab menu\n\t\ttab_menu_options.close_tab_menu();\n\t\t// if (!move_in_progress) {\n\t\t// \tif (this._registered_mouse_down) {\n\t\t// \t\t// in case we come here from a slider slide in another panel\n\t\t// \t\ttab_menu_options.toggle_tab_menu();\n\t\t// \t} else {\n\t\t// \t\ttab_menu_options.close_tab_menu();\n\t\t// \t}\n\t\t// } else {\n\t\t// \ttab_menu_options.close_tab_menu();\n\t\t// }\n\n\t\t// this._registered_mouse_down = false;\n\t\tconst id = StoreController.editor.current_node_graph_id();\n\t\tif (id) {\n\t\t\tcamera_options.save_camera_history_for_json_node(id);\n\t\t}\n\t}\n\n\t// function on_double_click(event: MouseEvent) {\n\t// \t// const intersect = this.ray_helper.intersected_mesh_with_callback(event, 'dbl_click', this.camera);\n\t// \t// if (intersect != null) {\n\t// \t// \treturn intersect.callbacks['dbl_click']();\n\t// \t// }\n\t// }\n\tfunction on_click(event: MouseEvent) {\n\t\ttab_menu_options.close_tab_menu();\n\t\tnode_creation_helper.create(event);\n\t}\n\tfunction on_context_menu(event: MouseEvent) {\n\t\t//this.toggle_tab_menu()\n\t\t//event.stopPropagation()\n\t\treturn false;\n\t}\n\tfunction on_wheel(event: WheelEvent) {\n\t\tcam_animation_helper.zoom(event);\n\t\tconst id = StoreController.editor.current_node_graph_id();\n\t\tif (id) {\n\t\t\tcamera_options.save_camera_history_for_json_node(id);\n\t\t}\n\t}\n\n\treturn {\n\t\tcanvas_class_object,\n\t\ton_mouse_down,\n\t\ton_mouse_move,\n\t\ton_mouse_up,\n\t\ton_click,\n\t\ton_context_menu,\n\t\ton_wheel,\n\t};\n}\n","import {CameraData} from '../helpers/CameraAnimation';\n\nexport interface NetworkPanelInitProperties {\n\tcamera: CameraData;\n\thistory: Dictionary<CameraData>;\n}\n\nexport function SetupJson(camera_data: CameraData, camera_history: Dictionary<CameraData>) {\n\tfunction from_json(json: NetworkPanelInitProperties) {\n\t\tconst camera_data = json['camera'];\n\t\tif (camera_data) {\n\t\t\tconst position = camera_data.position;\n\t\t\tconst zoom = camera_data.zoom;\n\t\t\t// this.camera = camera_data\n\t\t\tif (position) {\n\t\t\t\tcamera_data.position.x = position.x;\n\t\t\t\tcamera_data.position.y = position.y;\n\t\t\t}\n\t\t\tif (zoom) {\n\t\t\t\tcamera_data.zoom = zoom;\n\t\t\t}\n\t\t}\n\n\t\tconst json_camera_history = json['history'];\n\t\tif (json_camera_history) {\n\t\t\tfor (let id of Object.keys(json_camera_history)) {\n\t\t\t\tcamera_history[id] = json_camera_history[id];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction to_json(): NetworkPanelInitProperties {\n\t\treturn {\n\t\t\tcamera: {\n\t\t\t\tposition: {\n\t\t\t\t\tx: camera_data.position.x,\n\t\t\t\t\ty: camera_data.position.y,\n\t\t\t\t},\n\t\t\t\tzoom: camera_data.zoom,\n\t\t\t},\n\t\t\thistory: camera_history,\n\t\t};\n\t}\n\n\treturn {from_json, to_json};\n}\n","import {Ref, onMounted} from '@vue/composition-api';\nimport {NodeAnimationHelper} from '../helpers/NodeAnimation';\nexport function SetupNodeAnimation(\n\tnode_animation_helper: NodeAnimationHelper,\n\tnodes_container: Ref<HTMLElement | null>\n) {\n\tonMounted(() => {\n\t\tif (nodes_container.value) {\n\t\t\tnode_animation_helper.set_element(nodes_container.value);\n\t\t}\n\t});\n\n\treturn {};\n}\n","import {ConnectionHelper, ConnectionData} from '../helpers/Connection';\n// import {Constants} from '../helpers/Constants';\n\n// const PADDING = 5;\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {Ref, onMounted, computed} from '@vue/composition-api';\nexport function SetupNodeConnection(\n\tnode_connection_data: ConnectionData,\n\tconnection_helper: ConnectionHelper,\n\tnodes_container: Ref<HTMLElement | null>\n) {\n\tonMounted(() => {\n\t\tif (nodes_container.value) {\n\t\t\tconnection_helper.set_element(nodes_container.value);\n\t\t}\n\t});\n\n\tconst connection_src_json_node = computed(() => {\n\t\tconst id = node_connection_data.node_src_id;\n\t\tif (id) {\n\t\t\treturn StoreController.engine.json_node(id);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n\tconst connection_dest_json_node = computed(() => {\n\t\tconst id = node_connection_data.node_dest_id;\n\t\tif (id) {\n\t\t\treturn StoreController.engine.json_node(id);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\treturn {connection_src_json_node, connection_dest_json_node};\n}\n\n// export const NodeConnection = {\n\n// \tcomputed: {\n// \t\t,\n\n// node_connection_line_style_object(): object {\n// \tconst display = this.connection_line.active ? 'block' : 'none'\n// \tconst size = Constants.NODE_UNIT\n// \treturn {\n// \t\tdisplay: `${display}`,\n// \t\tleft: `${this.connection_line.position.x}px`,\n// \t\ttop: `${this.connection_line.position.y}px`,\n// \t\twidth: `${size}px`,\n// \t\theight: `${size}px`\n// \t}\n// }\n\n// connection_line_svg_style_object(){\n// \treturn {\n// \t\tleft: `${this.svg_src_point.x-PADDING}px`,\n// \t\ttop: `${this.svg_src_point.y-PADDING}px`,\n// \t\twidth: `${this.size.x + 2*PADDING}px`,\n// \t\theight: `${this.size.y + 2*PADDING}px`\n// \t}\n// },\n// connection_line_container_style_object(){\n// \tconst zoom = this.camera.zoom\n// \t// const zoom_inverse = (1/this.camera.zoom)\n// \tconst display = this.connection_line.active ? 'block' : 'none'\n// \treturn {\n// \t\tdisplay: display,\n// \t\tleft: `${-zoom*this.camera.position.x}px`,\n// \t\ttop: `${-zoom*this.camera.position.y}px`,\n// \t\ttransform: `scale(${this.camera.zoom})`\n// \t}\n// },\n\n// connection_line_start_point(){\n// \tif(this.connection_line.node_src_id){\n// \t\tconst json_node = this.$store.getters['engine/json_node'](this.connection_line.node_src_id)\n// \t\tconst pos = json_node.ui_data\n\n// \t\treturn {\n// \t\t\tx: (0.5 * Constants.NODE_UNIT + pos.x) + this.camera.position.x,\n// \t\t\ty: (4+10+ Constants.NODE_UNIT + pos.y) + this.camera.position.y\n// \t\t}\n// \t} else {\n// \t\tif(this.connection_line.node_dest_id){\n// \t\t\tconst json_node = this.$store.getters['engine/json_node'](this.connection_line.node_dest_id)\n// \t\t\tconst pos = json_node.ui_data\n\n// \t\t\treturn {\n// \t\t\t\tx: (0.5 * Constants.NODE_UNIT + pos.x) + this.camera.position.x,\n// \t\t\t\ty: (-4-10+ 0*Constants.NODE_UNIT + pos.y) + this.camera.position.y\n// \t\t\t}\n// \t\t} else {\n// \t\t\treturn {\n// \t\t\t\tx: 0,\n// \t\t\t\ty: 0\n// \t\t\t}\n// \t\t}\n// \t}\n// },\n// connection_line_end_point(){\n// \treturn {\n// \t\tx: this.connection_line.end_pos.x,\n// \t\ty: this.connection_line.end_pos.y\n// \t}\n// }\n// },\n\n// watch: {\n// \tjson_node(){\n// \t\tthis.$nextTick(() => {\n// \t\t\tthis.set_connection_helper_node()\n// \t\t});\n// \t}\n// },\n// methods: {\n// \tset_connection_helper_node(){\n// \t\tthis.connection_helper.set_parent_node(this.node)\n// \t}\n// }\n// };\n","import {NodeCreationHelper} from '../helpers/NodeCreation';\nimport {Constants} from '../helpers/Constants';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nimport {Ref, onMounted, computed, watch} from '@vue/composition-api';\nexport function SetupNodeCreation(nodes_container: Ref<HTMLElement | null>, node_creation_helper: NodeCreationHelper) {\n\tconst current_node_graph_id = computed(() => StoreController.editor.current_node_graph_id());\n\n\tonMounted(() => {\n\t\tif (nodes_container.value) {\n\t\t\tnode_creation_helper.set_element(nodes_container.value);\n\t\t}\n\t\tset_node_creation_helper_node();\n\t});\n\twatch(current_node_graph_id, (new_val, old_val) => {\n\t\tset_node_creation_helper_node();\n\t});\n\n\tconst node_creation_rectangle_style_object = computed(() => {\n\t\tconst active = node_creation_helper.active;\n\t\tif (active) {\n\t\t\tconst size = Constants.NODE_UNIT;\n\t\t\treturn {\n\t\t\t\tdisplay: 'block',\n\t\t\t\tleft: `${node_creation_helper.position.x}px`,\n\t\t\t\ttop: `${node_creation_helper.position.y}px`,\n\t\t\t\twidth: `${size}px`,\n\t\t\t\theight: `${size}px`,\n\t\t\t};\n\t\t} else {\n\t\t\treturn {display: 'none'};\n\t\t}\n\t});\n\n\tfunction set_node_creation_helper_node() {\n\t\tconst node = StoreController.editor.current_node();\n\t\tnode_creation_helper.set_parent_node(node);\n\t}\n\n\treturn {node_creation_rectangle_style_object};\n}\n","import {Helpers} from './EventMouse';\nimport {SetDisplayFlagCommand} from 'src/editor/history/commands/SetDisplayFlag';\nimport {SetBypassFlagCommand} from 'src/editor/history/commands/SetBypassFlag';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nexport function SetupNodeEvent(helpers: Helpers) {\n\tconst {node_animation_helper, connection_helper} = helpers;\n\n\tfunction on_capture_node_for_move(id: string) {\n\t\tnode_animation_helper.capture_node(id);\n\t}\n\t// function on_capture_node_for_selection(node: BaseNodeType) {\n\t// \tthis.debug_node_infos(node);\n\n\t// \tnode_selection_helper.capture_node(node);\n\t// }\n\n\tfunction on_capture_node_src_for_connection(id: string, index: number) {\n\t\tconnection_helper.capture_node_src(id, index);\n\t}\n\tfunction on_capture_node_dest_for_connection(id: string, index: number) {\n\t\tconnection_helper.capture_node_dest(id, index);\n\t}\n\tfunction on_capture_node_final_for_connection(id: string) {\n\t\tconnection_helper.capture_node_final(id);\n\t}\n\tfunction on_set_display_flag(id: string) {\n\t\tconst node = StoreController.engine.node(id)!;\n\t\tconst current_node = StoreController.editor.current_node();\n\t\tif (current_node && current_node.children_allowed() && current_node.children_controller) {\n\t\t\tconst selection = current_node.children_controller.selection;\n\t\t\tconst nodes = selection.contains(node) ? selection.nodes() : [node];\n\n\t\t\tconst cmd = new SetDisplayFlagCommand(nodes);\n\t\t\tcmd.push();\n\t\t}\n\t}\n\tfunction on_set_bypass_flag(id: string) {\n\t\tconst node = StoreController.engine.node(id)!;\n\t\tconst current_node = StoreController.editor.current_node();\n\t\tif (current_node && current_node.children_allowed() && current_node.children_controller) {\n\t\t\tconst selection = current_node.children_controller.selection;\n\t\t\tconst nodes = selection.contains(node) ? selection.nodes() : [node];\n\n\t\t\tconst cmd = new SetBypassFlagCommand(nodes);\n\t\t\tcmd.push();\n\t\t}\n\t}\n\n\treturn {\n\t\ton_capture_node_for_move,\n\t\ton_capture_node_src_for_connection,\n\t\ton_capture_node_dest_for_connection,\n\t\ton_capture_node_final_for_connection,\n\t\ton_set_display_flag,\n\t\ton_set_bypass_flag,\n\t};\n}\n","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class SetDisplayFlagCommand extends BaseCommand {\n\tprivate _first_node: BaseNodeType | undefined;\n\tprivate _old_node: BaseNodeType | undefined;\n\tprivate _new_display_state: boolean | undefined;\n\n\tconstructor(private _nodes: BaseNodeType[]) {\n\t\tsuper();\n\t\tthis._first_node = this._nodes[0];\n\t\tif (this._first_node) {\n\t\t\tconst parent = this._first_node.parent;\n\t\t\tif (parent) {\n\t\t\t\tif (parent.display_node_controller) {\n\t\t\t\t\tthis._old_node = parent.display_node_controller.display_node;\n\t\t\t\t} else {\n\t\t\t\t\tthis._new_display_state = !this._first_node.flags?.display?.active;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdo() {\n\t\tif (this._first_node && this._first_node.parent) {\n\t\t\tif (this._first_node.parent.display_node_controller) {\n\t\t\t\tthis._first_node.flags?.display?.set(true);\n\t\t\t\t// for (let node of this._nodes) {\n\t\t\t\t// \tnode.flags?.display?.set(true);\n\t\t\t\t// }\n\t\t\t} else {\n\t\t\t\tif (this._new_display_state != null) {\n\t\t\t\t\tfor (let node of this._nodes) {\n\t\t\t\t\t\tnode.flags?.display?.set(this._new_display_state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tundo() {\n\t\tif (this._first_node) {\n\t\t\tif (this._old_node) {\n\t\t\t\tthis._old_node.flags?.display?.set(true);\n\t\t\t} else {\n\t\t\t\tif (this._new_display_state != null) {\n\t\t\t\t\tfor (let node of this._nodes) {\n\t\t\t\t\t\tnode.flags?.display?.set(!this._new_display_state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class SetBypassFlagCommand extends BaseCommand {\n\tprivate _first_node: BaseNodeType | undefined;\n\tprivate _current_state: boolean | undefined;\n\n\tconstructor(private _nodes: BaseNodeType[]) {\n\t\tsuper();\n\t\tthis._first_node = _nodes[0];\n\t\tif (this._first_node) {\n\t\t\tthis._current_state = this._first_node.flags?.bypass?.active;\n\t\t}\n\t}\n\n\tdo() {\n\t\tif (this._first_node && this._current_state != null) {\n\t\t\tconst cooker = this._first_node.scene.cooker;\n\t\t\tcooker.block();\n\t\t\tfor (let node of this._nodes) {\n\t\t\t\tnode.flags?.bypass?.set(!this._current_state);\n\t\t\t}\n\t\t\tcooker.unblock();\n\t\t}\n\t}\n\n\tundo() {\n\t\tif (this._first_node && this._current_state != null) {\n\t\t\tfor (let node of this._nodes) {\n\t\t\t\tnode.flags?.bypass?.set(this._current_state);\n\t\t\t}\n\t\t}\n\t}\n}\n","import {StoreController} from 'src/editor/store/controllers/StoreController';\n\nimport {computed} from '@vue/composition-api';\nexport function SetupNodeNavigation() {\n\tconst current_node_graph_id = computed(() => StoreController.editor.current_node_graph_id());\n\tconst display_go_up_button = computed(() => {\n\t\tif (current_node_graph_id) {\n\t\t\treturn StoreController.editor.current_node() && StoreController.editor.current_node().parent != null;\n\t\t}\n\t\treturn false;\n\t});\n\n\tfunction go_up() {\n\t\tStoreController.editor.go_up();\n\t}\n\n\treturn {\n\t\tdisplay_go_up_button,\n\t\tgo_up,\n\t};\n}\n","import {Vector2} from 'three/src/math/Vector2';\nimport {NodeSelectionHelper, NodeSelectionData} from '../helpers/NodeSelection';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nimport {Ref, onMounted, computed, watch} from '@vue/composition-api';\nexport function SetupNodeSelection(\n\tnode_selection_data: NodeSelectionData,\n\tnode_selection_helper: NodeSelectionHelper,\n\tnodes_container: Ref<HTMLElement | null>\n) {\n\tconst current_node_graph_id = computed(() => StoreController.editor.current_node_graph_id());\n\n\tonMounted(() => {\n\t\tif (nodes_container.value) {\n\t\t\tnode_selection_helper.set_element(nodes_container.value);\n\t\t}\n\t\tset_selection_helper_node();\n\t});\n\twatch(current_node_graph_id, (new_val, old_val) => {\n\t\tset_selection_helper_node();\n\t});\n\n\tconst selection_rectangle_style_object = computed(() => {\n\t\tconst box = node_selection_helper.box();\n\t\tconst size = new Vector2();\n\t\tbox.getSize(size);\n\t\tconst display = node_selection_data.active ? 'block' : 'none';\n\t\treturn {\n\t\t\tdisplay: `${display}`,\n\t\t\tleft: `${box.min.x}px`,\n\t\t\ttop: `${box.min.y}px`,\n\t\t\twidth: `${size.x}px`,\n\t\t\theight: `${size.y}px`,\n\t\t};\n\t});\n\n\tfunction set_selection_helper_node() {\n\t\tconst node = StoreController.editor.current_node();\n\t\tif (node) {\n\t\t\tnode_selection_helper.set_parent_node(node);\n\t\t}\n\t}\n\n\treturn {selection_rectangle_style_object};\n}\n","// import lodash_last from 'lodash/last';\n\n// components\nimport {EventHelper} from 'src/core/EventHelper';\nimport {Vector2} from 'three/src/math/Vector2';\n\nimport {NodeCreationHelper} from '../helpers/NodeCreation';\n// import { DropDownMenuEntry } from 'src/editor/components/types/props';\n\ninterface TabMenuStyleObject {\n\tleft: string;\n\ttop: string;\n}\n\nexport interface TabMenuOptions {\n\ttab_menu_opened: Ref<boolean>;\n\ttab_menu_style_object: Ref<TabMenuStyleObject>;\n\topen_tab_menu: () => void;\n\tclose_tab_menu: () => void;\n\tclose_node_create: () => void;\n\ttoggle_tab_menu: () => void;\n\ton_tab_menu_select: (str: string) => void;\n\tupdate_tab_menu_position: (event: MouseEvent) => void;\n}\n\nimport {ref, Ref, computed} from '@vue/composition-api';\nexport function SetupTabMenu(\n\tcanvas: Ref<HTMLCanvasElement | null>,\n\tnode_creation_helper: NodeCreationHelper\n): TabMenuOptions {\n\tconst tab_menu_opened = ref(false);\n\tconst tab_menu_mouse_position = ref({x: 0, y: 0});\n\n\tconst tab_menu_style_object = computed(() => {\n\t\tconst left = tab_menu_mouse_position.value.x - 10;\n\t\treturn {\n\t\t\tleft: `${left}px`,\n\t\t\ttop: `${tab_menu_mouse_position.value.y}px`,\n\t\t};\n\t});\n\n\t// functions\n\tfunction update_tab_menu_position(event: MouseEvent) {\n\t\tif (!tab_menu_opened.value && canvas.value) {\n\t\t\tconst event_helper = new EventHelper(canvas.value);\n\t\t\tevent_helper.element_position(event, tab_menu_mouse_position.value as Vector2);\n\t\t}\n\t}\n\n\tfunction open_tab_menu() {\n\t\t_set_tab_menu_state(true);\n\t}\n\n\tfunction toggle_tab_menu() {\n\t\t_set_tab_menu_state(!tab_menu_opened.value);\n\t}\n\n\tfunction close_tab_menu() {\n\t\t_set_tab_menu_state(false);\n\t}\n\n\tfunction _set_tab_menu_state(state: boolean) {\n\t\ttab_menu_opened.value = state;\n\t}\n\n\tfunction on_tab_menu_select(entry: string) {\n\t\tconst elements = entry.split('/');\n\t\tconst last_element = elements[elements.length - 1];\n\t\tnode_creation_helper.activate(last_element);\n\t}\n\n\tfunction close_node_create() {\n\t\tnode_creation_helper.deactivate();\n\t}\n\n\treturn {\n\t\ttab_menu_opened,\n\t\ttab_menu_style_object,\n\t\topen_tab_menu,\n\t\ttoggle_tab_menu,\n\t\tclose_tab_menu,\n\t\ton_tab_menu_select,\n\t\tclose_node_create,\n\t\tupdate_tab_menu_position,\n\t};\n}\n","import { render, staticRenderFns } from \"./TabMenu.vue?vue&type=template&id=bfd58e08&lang=pug&\"\nimport script from \"./TabMenu.vue?vue&type=script&lang=ts&\"\nexport * from \"./TabMenu.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./TabMenu.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('bfd58e08')) {\n      api.createRecord('bfd58e08', component.options)\n    } else {\n      api.reload('bfd58e08', component.options)\n    }\n    module.hot.accept(\"./TabMenu.vue?vue&type=template&id=bfd58e08&lang=pug&\", function () {\n      api.rerender('bfd58e08', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/TabMenu.vue\"\nexport default component.exports","import mod from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TabMenu.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TabMenu.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".TabMenu{position:absolute}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Node.vue?vue&type=template&id=0f96306c&lang=pug&\"\nimport script from \"./Node.vue?vue&type=script&lang=ts&\"\nexport * from \"./Node.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Node.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('0f96306c')) {\n      api.createRecord('0f96306c', component.options)\n    } else {\n      api.reload('0f96306c', component.options)\n    }\n    module.hot.accept(\"./Node.vue?vue&type=template&id=0f96306c&lang=pug&\", function () {\n      api.rerender('0f96306c', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/Node.vue\"\nexport default component.exports","import {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {SetupContext} from '@vue/composition-api';\n\nexport interface SetupCaptureOptions {\n\tcapture_node_for_move: () => void;\n\tcapture_node_src_for_connection: (index: number) => void;\n\tcapture_node_dest_for_connection: (index: number) => void;\n\tcapture_node_final_for_connection: () => void;\n}\n\nexport function SetupCapture(json_node: EngineNodeData, context: SetupContext): SetupCaptureOptions {\n\tfunction capture_node_for_move() {\n\t\tcontext.emit('capture_node_for_move', json_node.graph_node_id);\n\t}\n\tfunction capture_node_src_for_connection(index: number) {\n\t\tcontext.emit('capture_node_src_for_connection', json_node.graph_node_id, index);\n\t}\n\tfunction capture_node_dest_for_connection(index: number) {\n\t\tcontext.emit('capture_node_dest_for_connection', json_node.graph_node_id, index);\n\t}\n\tfunction capture_node_final_for_connection() {\n\t\tcontext.emit('capture_node_final_for_connection', json_node.graph_node_id);\n\t}\n\n\treturn {\n\t\tcapture_node_for_move,\n\t\tcapture_node_src_for_connection,\n\t\tcapture_node_dest_for_connection,\n\t\tcapture_node_final_for_connection,\n\t};\n}\n","import {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nimport {computed, Ref} from '@vue/composition-api';\nexport function SetupChildrenOwner(\n\tjson_node: EngineNodeData,\n\tbody_size: Readonly<\n\t\tRef<\n\t\t\tReadonly<{\n\t\t\t\tx: number;\n\t\t\t\ty: number;\n\t\t\t}>\n\t\t>\n\t>,\n\tlayout_vertical: Readonly<Ref<boolean>>\n) {\n\tconst node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst children_allowed = computed(() => {\n\t\treturn node?.children_allowed() || false;\n\t});\n\tconst enter_button_container_style_object = computed(() => {\n\t\tif (layout_vertical.value) {\n\t\t\treturn {\n\t\t\t\tright: `${0.5 * body_size.value.x}px`,\n\t\t\t\ttop: `${0.0 * body_size.value.y}px`,\n\t\t\t};\n\t\t} else {\n\t\t\t// not needed until I do\n\t\t\t// return {\n\t\t\t// \tleft: `${-0.5*this.body_size.x}px`,\n\t\t\t// \ttop: `${-0.5*this.body_size.y}px`,\n\t\t\t// }\n\t\t}\n\t});\n\n\treturn {\n\t\tchildren_allowed,\n\t\tenter_button_container_style_object,\n\t};\n}\n","import {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {computed, Ref} from '@vue/composition-api';\nexport function SetupCommentable(\n\tjson_node: EngineNodeData,\n\tbody_size: Readonly<\n\t\tRef<\n\t\t\tReadonly<{\n\t\t\t\tx: number;\n\t\t\t\ty: number;\n\t\t\t}>\n\t\t>\n\t>,\n\tlayout_vertical: Readonly<Ref<boolean>>\n) {\n\tconst comment = computed(() => {\n\t\treturn json_node.ui_data_json.comment;\n\t});\n\tconst display_comment = computed(() => {\n\t\treturn comment.value != null && comment.value != '';\n\t});\n\tconst comment_container_style_object = computed(() => {\n\t\tif (layout_vertical.value) {\n\t\t\treturn {\n\t\t\t\tleft: `${0.5 * body_size.value.x}px`,\n\t\t\t\ttop: `${0.5 * body_size.value.y}px`,\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tleft: `${-0.5 * body_size.value.x}px`,\n\t\t\t\ttop: `${-0.5 * body_size.value.y}px`,\n\t\t\t};\n\t\t}\n\t});\n\n\treturn {\n\t\tdisplay_comment,\n\t\tcomment,\n\t\tcomment_container_style_object,\n\t};\n}\n","import {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nexport function SetupContextMenu(json_node: EngineNodeData) {\n\tfunction on_contextmenu(event: MouseEvent) {\n\t\tconst menu_node_id = StoreController.editor.context_menu.node_id();\n\t\tconst current_node_id = json_node.graph_node_id;\n\t\tif (menu_node_id == current_node_id) {\n\t\t\ton_contextmenu_close();\n\t\t} else {\n\t\t\tStoreController.editor.context_menu.set_node_id(current_node_id);\n\t\t}\n\t\tStoreController.editor.context_menu.set_position({\n\t\t\tx: event.pageX,\n\t\t\ty: event.pageY,\n\t\t});\n\t}\n\tfunction on_contextmenu_close() {\n\t\tStoreController.editor.context_menu.set_node_id(null);\n\t}\n\n\treturn {\n\t\ton_contextmenu,\n\t\ton_contextmenu_close,\n\t};\n}\n","import {Constants} from '../../../helpers/Constants';\nimport {EngineNodeData} from 'src/editor/store/modules/Engine';\n\nimport {Ref, computed} from '@vue/composition-api';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nexport function SetupBypassFlag(\n\tjson_node: EngineNodeData,\n\tbody_size: Readonly<\n\t\tRef<\n\t\t\tReadonly<{\n\t\t\t\tx: number;\n\t\t\t\ty: number;\n\t\t\t}>\n\t\t>\n\t>\n) {\n\tconst node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst has_bypass_flag: Readonly<Ref<Readonly<boolean>>> = computed(() => {\n\t\treturn json_node.flags?.bypass != null;\n\t});\n\tconst is_bypassed: Readonly<Ref<Readonly<boolean>>> = computed(() => {\n\t\treturn json_node.flags?.bypass == true;\n\t});\n\tconst bypass_flag_container_style_object = computed(() => {\n\t\treturn {\n\t\t\ttop: `${-0.5 * Constants.NODE_HEIGHT}px`,\n\t\t\tleft: `${-0.5 * (node?.ui_data.width() || 100) + 2}px`,\n\t\t\theight: `${body_size.value.y}px`,\n\t\t};\n\t});\n\tconst bypass_flag_style_object = computed(() => {\n\t\tconst v_padding = 5;\n\t\treturn {\n\t\t\ttop: `${v_padding}px`,\n\t\t\theight: `${body_size.value.y - 2 * v_padding}px`,\n\t\t};\n\t});\n\tconst bypass_flag_class_object = computed(() => {\n\t\treturn {\n\t\t\ton: is_bypassed.value,\n\t\t\toff: !is_bypassed.value,\n\t\t};\n\t});\n\n\treturn {\n\t\thas_bypass_flag,\n\t\tis_bypassed,\n\t\tbypass_flag_container_style_object,\n\t\tbypass_flag_style_object,\n\t\tbypass_flag_class_object,\n\t};\n}\n","import {Constants} from '../../../helpers/Constants';\nimport {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nimport {Ref, computed} from '@vue/composition-api';\nexport function SetupDisplayFlag(\n\tjson_node: EngineNodeData,\n\tbody_size: Readonly<\n\t\tRef<\n\t\t\tReadonly<{\n\t\t\t\tx: number;\n\t\t\t\ty: number;\n\t\t\t}>\n\t\t>\n\t>\n) {\n\tconst node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst has_display_flag: Readonly<Ref<boolean>> = computed(() => {\n\t\treturn json_node.flags?.display != null;\n\t});\n\tconst display_flag_container_style_object = computed(() => {\n\t\treturn {\n\t\t\ttop: `${-0.5 * Constants.NODE_HEIGHT}px`,\n\t\t\tleft: `${0.5 * (node?.ui_data.width() || 100) - 2}px`,\n\t\t\theight: `${body_size.value.y}px`,\n\t\t};\n\t});\n\tconst display_flag_style_object = computed(() => {\n\t\tconst v_padding = 5;\n\t\treturn {\n\t\t\ttop: `${v_padding}px`,\n\t\t\theight: `${body_size.value.y - 2 * v_padding}px`,\n\t\t};\n\t});\n\tconst display_flag_class_object = computed(() => {\n\t\tconst display = json_node.flags?.display == true;\n\t\treturn {\n\t\t\ton: display,\n\t\t\toff: !display,\n\t\t};\n\t});\n\n\treturn {\n\t\thas_display_flag,\n\t\tdisplay_flag_container_style_object,\n\t\tdisplay_flag_style_object,\n\t\tdisplay_flag_class_object,\n\t};\n}\n","import {Constants} from '../../../helpers/Constants';\n\nimport {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {Ref, computed} from '@vue/composition-api';\nexport function SetupErrored(\n\tjson_node: EngineNodeData,\n\tbody_size: Readonly<\n\t\tRef<\n\t\t\tReadonly<{\n\t\t\t\tx: number;\n\t\t\t\ty: number;\n\t\t\t}>\n\t\t>\n\t>\n) {\n\tconst node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst error_message = computed(() => {\n\t\tif (json_node) {\n\t\t\treturn json_node.error_message;\n\t\t}\n\t});\n\tconst is_errored: Readonly<Ref<boolean>> = computed(() => {\n\t\treturn error_message.value != null;\n\t});\n\tconst error_flag_container_style_object = computed(() => {\n\t\treturn {\n\t\t\ttop: `${-0.5 * Constants.NODE_HEIGHT}px`,\n\t\t\tleft: `${-0.5 * (node?.ui_data.width() || 100)}px`,\n\t\t\twidth: `${node?.ui_data.width() || 100}px`,\n\t\t\theight: `${body_size.value.y}px`,\n\t\t};\n\t});\n\n\treturn {\n\t\terror_message,\n\t\tis_errored,\n\t\terror_flag_container_style_object,\n\t};\n}\n","// import EventHelper from '../../Helper/Event';\nimport {MouseButton} from 'src/editor/core/MouseButton';\n\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {NodeSetNameCommand} from 'src/editor/history/commands/NodeSetName';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {SetupCaptureOptions} from './Capture';\nimport {SetupContext} from '@vue/composition-api';\nimport {SetupInfosOptions} from './Infos';\nexport function SetupEventMouse(\n\tjson_node: EngineNodeData,\n\tcontext: SetupContext,\n\tcapture_options: SetupCaptureOptions,\n\tinfos_options: SetupInfosOptions\n) {\n\tfunction on_body_mousedown(event: MouseEvent) {\n\t\tswitch (event.button) {\n\t\t\tcase MouseButton.LEFT:\n\t\t\t\tcapture_options.capture_node_for_move();\n\t\t\t\tbreak;\n\t\t\tcase MouseButton.MIDDLE:\n\t\t\t\tinfos_options.display_info();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tbreak;\n\n\t\t\t// case Core.Event.MOUSE_BUTTON_MIDDLE:\n\t\t\t// \tthis.cam_animation_helper.pan_start(event);\n\t\t\t// \tthis.pan_in_progress = true;\n\t\t\t// \tbreak\n\n\t\t\t// case Core.Event.MOUSE_BUTTON_RIGHT:\n\t\t\t// \tthis.cam_animation_helper.zoom_start(event);\n\t\t\t// \tthis.zoom_in_progress = true;\n\t\t\t// \tbreak\n\t\t}\n\t}\n\tfunction on_body_mouseup(event: MouseEvent) {\n\t\tif (event.button == MouseButton.MIDDLE) {\n\t\t\tinfos_options.hide_info();\n\t\t} else {\n\t\t\tcapture_options.capture_node_final_for_connection();\n\t\t}\n\t}\n\n\t// on_body_click(event: MouseEvent){\n\t// \tconsole.log(\"click\")\n\t// },\n\tfunction on_body_dblclick(event: MouseEvent) {\n\t\topen_node();\n\t}\n\tfunction open_node() {\n\t\tconst node = StoreController.engine.node(json_node.graph_node_id);\n\t\tif (node) {\n\t\t\tStoreController.editor.set_current_node(node);\n\t\t}\n\t}\n\t// on_click() {\n\t// \tthis.close_tab_menu();\n\t// },\n\t// on_context_menu(event: MouseEvent){\n\t// \t//this.toggle_tab_menu()\n\t// \t//event.stopPropagation()\n\t// \treturn false;\n\t// }\n\n\tfunction on_input_mousedown(event: MouseEvent, index: number) {\n\t\tcapture_options.capture_node_dest_for_connection(index);\n\t}\n\tfunction on_input_mouseup(event: MouseEvent, index: number) {\n\t\tcapture_options.capture_node_dest_for_connection(index);\n\t}\n\tfunction on_output_mousedown(event: MouseEvent, index: number) {\n\t\tcapture_options.capture_node_src_for_connection(index);\n\t}\n\tfunction on_output_mouseup(event: MouseEvent, index: number) {\n\t\tcapture_options.capture_node_src_for_connection(index);\n\t}\n\tfunction on_display_flag_click() {\n\t\tcontext.emit('set_display_flag', json_node.graph_node_id);\n\t}\n\tfunction on_bypass_flag_click() {\n\t\tcontext.emit('set_bypass_flag', json_node.graph_node_id);\n\t}\n\n\tasync function on_name_click() {\n\t\tconst new_name: string = await StoreController.editor.dialog_prompt.show({\n\t\t\ttitle: 'Rename Node:',\n\t\t\tdefault_value: json_node.name,\n\t\t\tconfirm_label: 'Update Name',\n\t\t});\n\t\t// const new_name = await window.POLY_prompt(this, 'Rename Node:', this.node.name(), {options: 'Update Name'});\n\n\t\tif (new_name != null && new_name.length > 0) {\n\t\t\tconst node = StoreController.engine.node(json_node.graph_node_id) as BaseNodeType;\n\t\t\tif (node) {\n\t\t\t\tconst cmd = new NodeSetNameCommand(node, new_name);\n\t\t\t\tcmd.push();\n\t\t\t}\n\t\t}\n\t}\n\tfunction on_name_mouseup() {\n\t\t// this is only here to prevent selection from being cleared\n\t\t// when clicking on the name to rename a node\n\t}\n\n\treturn {\n\t\ton_body_mousedown,\n\t\ton_body_mouseup,\n\t\ton_body_dblclick,\n\t\ton_input_mousedown,\n\t\ton_input_mouseup,\n\t\ton_output_mousedown,\n\t\ton_output_mouseup,\n\t\ton_display_flag_click,\n\t\ton_bypass_flag_click,\n\t\ton_name_click,\n\t\ton_name_mouseup,\n\t\topen_node,\n\t};\n}\n","import {EngineNodeData} from 'src/editor/store/modules/Engine';\n// import {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {computed} from '@vue/composition-api';\nexport function SetupIcon(json_node: EngineNodeData) {\n\t// const node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst icon = computed(() => {\n\t\t// TODO: it could make the engine lighter if refs to the icons were in the editor only\n\t\treturn null; //node?.ui_data.icon();\n\t});\n\tconst display_icon = computed(() => {\n\t\treturn icon.value != null;\n\t});\n\n\treturn {\n\t\ticon,\n\t\tdisplay_icon,\n\t};\n}\n","// import {BaseNodeSop} from 'src/Engine/Node/Sop/_Base'\n\nexport interface SetupInfosOptions {\n\tdisplay_info: () => void;\n\thide_info: () => void;\n\tdisplay_node_info: Ref<boolean>;\n}\n\nimport {ref, Ref} from '@vue/composition-api';\n// import { EngineNodeData } from 'src/editor/store/modules/Engine';\nexport function SetupInfos(/*json_node: EngineNodeData*/): SetupInfosOptions {\n\tconst display_node_info = ref(false);\n\n\tfunction display_info() {\n\t\tdisplay_node_info.value = true;\n\t}\n\tfunction hide_info() {\n\t\tdisplay_node_info.value = false;\n\t}\n\t// toggle_info_display(){\n\t// \tthis.display_node_info = !this.display_node_info\n\t// },\n\n\treturn {\n\t\tdisplay_node_info,\n\t\tdisplay_info,\n\t\thide_info,\n\t};\n}\n","import {Constants} from '../../../helpers/Constants';\nimport lodash_range from 'lodash/range';\n\nimport {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {BaseNodeClass} from 'src/engine/nodes/_Base';\nimport {computed, Ref} from '@vue/composition-api';\nexport function SetupInputs(\n\tjson_node: EngineNodeData,\n\tbody_size: Readonly<\n\t\tRef<\n\t\t\tReadonly<{\n\t\t\t\tx: number;\n\t\t\t\ty: number;\n\t\t\t}>\n\t\t>\n\t>,\n\tlayout_vertical: Readonly<Ref<boolean>>\n) {\n\tconst node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst inputs = computed(() => {\n\t\treturn json_node.inputs || [];\n\t});\n\tconst input_names = computed(() => {\n\t\tif (node) {\n\t\t\tif (node.io.inputs.has_named_inputs) {\n\t\t\t\treturn json_node.named_input_connections.map((i) => i.name);\n\t\t\t} else {\n\t\t\t\treturn (node.constructor as typeof BaseNodeClass).displayed_input_names();\n\t\t\t}\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t});\n\tconst input_titles = computed(() => {\n\t\tif (node) {\n\t\t\tif (node.io.inputs.has_named_inputs) {\n\t\t\t\treturn json_node.named_input_connections.map((i) => `${i.name} (${i.type})`);\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}\n\t});\n\tconst input_connection_output_indices = computed(() => {\n\t\treturn json_node.input_connection_output_indices || [];\n\t});\n\tconst input_json_nodes = computed(() => {\n\t\treturn json_node.inputs.map((graph_node_id) => {\n\t\t\tif (graph_node_id) {\n\t\t\t\treturn StoreController.engine.json_node(graph_node_id);\n\t\t\t}\n\t\t});\n\t});\n\tconst input_valid_states = computed(() => {\n\t\treturn json_node.inputs.map((graph_node_id) => {\n\t\t\treturn graph_node_id != null;\n\t\t});\n\t});\n\tconst max_inputs_count: Readonly<Ref<number>> = computed(() => {\n\t\treturn node?.io.inputs.max_inputs_count || 0;\n\t});\n\tconst available_inputs: Readonly<Ref<readonly number[]>> = computed(() => {\n\t\tlet count: number = max_inputs_count.value;\n\t\tif (node) {\n\t\t\tif (node.io.inputs.has_named_inputs) {\n\t\t\t\tcount = json_node.named_input_connections.length;\n\t\t\t}\n\t\t\treturn lodash_range(count);\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t});\n\tconst inputs_container_style_object = computed(() => {\n\t\tif (layout_vertical.value) {\n\t\t\treturn {\n\t\t\t\tbottom: `${0.5 * body_size.value.y}px`,\n\t\t\t\tleft: `${-0.5 * body_size.value.x}px`,\n\t\t\t\twidth: `${body_size.value.x}px`,\n\t\t\t\theight: `${Constants.CONNECTION_VERTICAL_MARGIN}px`,\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\ttop: `${-0.5 * body_size.value.y}px`,\n\t\t\t\tleft: `${-0.5 * body_size.value.x - Constants.CONNECTION_VERTICAL_MARGIN}px`,\n\t\t\t\twidth: `${Constants.CONNECTION_VERTICAL_MARGIN}px`,\n\t\t\t\theight: `${body_size.value.y}px`,\n\t\t\t};\n\t\t}\n\t});\n\t// input_style_objects() {\n\t// \tconst intervals_count = this.max_inputs_count + 1\n\t// \treturn lodash_range(this.max_inputs_count).map((input, i)=>{\n\t// \t\treturn {\n\t// \t\t\tmarginLeft: `${100*(i+2)/intervals_count}%`\n\t// \t\t}\n\t// \t})\n\t// },\n\tconst inputs_pixel_style_objects = computed(() => {\n\t\tif (layout_vertical.value) {\n\t\t\tconst intervals_count = available_inputs.value.length + 1;\n\t\t\treturn available_inputs.value.map((input, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tmarginLeft: `${(100 * (i + 1)) / intervals_count}%`,\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\treturn available_inputs.value.map((input, i) => {\n\t\t\t\treturn {\n\t\t\t\t\ttop: `${Constants.CONNECTION_VERTICAL_SPACING * i + Constants.CONNECTION_VERTICAL_START}px`,\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t});\n\tconst connection_pixel_input_class_objects = computed(() => {\n\t\tif (node) {\n\t\t\tif (node.io.inputs.has_named_inputs) {\n\t\t\t\treturn json_node.named_input_connections.map((connection, i) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t[connection.type]: true,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t});\n\n\treturn {\n\t\tinputs,\n\t\tinput_names,\n\t\tinput_titles,\n\t\tinput_connection_output_indices,\n\t\tinput_json_nodes,\n\t\tinput_valid_states,\n\t\tmax_inputs_count,\n\t\tavailable_inputs,\n\t\tinputs_container_style_object,\n\t\tinputs_pixel_style_objects,\n\t\tconnection_pixel_input_class_objects,\n\t};\n}\n","import {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {computed, Ref} from '@vue/composition-api';\nexport function SetupNamed(\n\tjson_node: EngineNodeData,\n\tbody_size: Readonly<\n\t\tRef<\n\t\t\tReadonly<{\n\t\t\t\tx: number;\n\t\t\t\ty: number;\n\t\t\t}>\n\t\t>\n\t>,\n\tlayout_vertical: Readonly<Ref<boolean>>\n) {\n\tconst node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst name = computed(() => {\n\t\treturn json_node.name;\n\t});\n\tconst name_container_style_object = computed(() => {\n\t\tif (layout_vertical.value) {\n\t\t\treturn {\n\t\t\t\tleft: `${0.5 * body_size.value.x}px`,\n\t\t\t\t// top: `${0.5*this.body_size.y}px`,\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tleft: `${-0.5 * body_size.value.x}px`,\n\t\t\t\ttop: `${-0.5 * body_size.value.y}px`,\n\t\t\t};\n\t\t}\n\t});\n\n\tconst connection_name_element_class_objects = computed(() => {\n\t\tif (node) {\n\t\t\tif (node.io.inputs.has_named_inputs || node.io.outputs.has_named_outputs) {\n\t\t\t\treturn {named_element: true};\n\t\t\t} else {\n\t\t\t\treturn {non_named_element: true};\n\t\t\t}\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t});\n\n\treturn {\n\t\tname,\n\t\tname_container_style_object,\n\t\tconnection_name_element_class_objects,\n\t};\n}\n","import {Constants} from '../../../helpers/Constants';\nimport lodash_range from 'lodash/range';\n\nimport {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {computed, Ref} from '@vue/composition-api';\nexport function SetupOutputs(\n\tjson_node: EngineNodeData,\n\tbody_size: Readonly<\n\t\tRef<\n\t\t\tReadonly<{\n\t\t\t\tx: number;\n\t\t\t\ty: number;\n\t\t\t}>\n\t\t>\n\t>,\n\tlayout_vertical: Readonly<Ref<boolean>>\n) {\n\tconst node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst has_outputs: Readonly<Ref<boolean>> = computed(() => {\n\t\tif (node) {\n\t\t\tif (node.io.outputs.has_named_outputs) {\n\t\t\t\treturn json_node.named_output_connections.length > 0;\n\t\t\t} else {\n\t\t\t\treturn node.io.outputs.has_outputs;\n\t\t\t}\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t});\n\tconst output_container_style_object = computed(() => {\n\t\tif (layout_vertical.value) {\n\t\t\treturn {\n\t\t\t\ttop: `${0.5 * body_size.value.y}px`,\n\t\t\t\tleft: `${-0.5 * body_size.value.x}px`,\n\t\t\t\twidth: `${body_size.value.x}px`,\n\t\t\t\theight: `${Constants.CONNECTION_VERTICAL_MARGIN}px`,\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\ttop: `${-0.5 * body_size.value.y}px`,\n\t\t\t\tleft: `${0.5 * body_size.value.x}px`,\n\t\t\t\twidth: `${Constants.CONNECTION_VERTICAL_MARGIN}px`,\n\t\t\t\theight: `${body_size.value.x}px`,\n\t\t\t};\n\t\t}\n\t});\n\tconst output_names: Readonly<Ref<readonly string[]>> = computed(() => {\n\t\tif (node) {\n\t\t\tif (node.io.outputs.has_named_outputs) {\n\t\t\t\treturn json_node.named_output_connections.map((o) => o.name);\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t});\n\tconst output_titles: Readonly<Ref<readonly string[]>> = computed(() => {\n\t\tif (node) {\n\t\t\tif (node.io.outputs.has_named_outputs) {\n\t\t\t\treturn json_node.named_output_connections.map((o) => `${o.name} (${o.type})`);\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t});\n\tconst max_outputs_count = computed(() => {\n\t\tif (node) {\n\t\t\tif (node.io.outputs.has_named_outputs) {\n\t\t\t\treturn json_node.named_output_connections.length;\n\t\t\t} else {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t});\n\tconst available_outputs = computed(() => {\n\t\treturn lodash_range(max_outputs_count.value);\n\t});\n\tconst outputs_pixel_style_objects = computed(() => {\n\t\tif (layout_vertical.value) {\n\t\t\t// const intervals_count = this.available_outputs.length + 1\n\t\t\treturn available_outputs.value.map((output, i) => {\n\t\t\t\treturn {\n\t\t\t\t\t// marginLeft: `${100*(i+1)/intervals_count}%`\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\treturn available_outputs.value.map((output, i) => {\n\t\t\t\treturn {\n\t\t\t\t\ttop: `${Constants.CONNECTION_VERTICAL_SPACING * i + Constants.CONNECTION_VERTICAL_START}px`,\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t});\n\tconst connection_pixel_output_class_objects = computed(() => {\n\t\tif (node) {\n\t\t\treturn json_node.named_output_connections.map((connection, i) => {\n\t\t\t\treturn {\n\t\t\t\t\t[connection.type]: true,\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t});\n\n\treturn {\n\t\thas_outputs,\n\t\toutput_container_style_object,\n\t\toutput_names,\n\t\toutput_titles,\n\t\tmax_outputs_count,\n\t\tavailable_outputs,\n\t\toutputs_pixel_style_objects,\n\t\tconnection_pixel_output_class_objects,\n\t};\n}\n","import {computed} from '@vue/composition-api';\nimport {EngineNodeData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {Vector2} from 'three/src/math/Vector2';\nexport function SetupPosition(json_node: EngineNodeData) {\n\t// const node = StoreController.engine.node(json_node.graph_node_id);\n\n\tconst position_v = new Vector2();\n\tconst position = computed(() => {\n\t\tposition_v.set(json_node.ui_data_json.x, json_node.ui_data_json.y);\n\t\treturn position_v;\n\t});\n\tconst is_being_moved = computed(() => {\n\t\tconst state_by_node_ids = StoreController.editor.network.node_ids_being_moved();\n\t\treturn state_by_node_ids[json_node.graph_node_id] || false;\n\t\t// const node_ids = this.$store.getters['editor/network/node_ids_being_moved'];\n\t\t// return lodash_includes(node_ids, this.node.graph_node_id());\n\t});\n\n\treturn {\n\t\tposition,\n\t\tis_being_moved,\n\t};\n}\n","import {computed, Ref} from '@vue/composition-api';\nimport {EngineNodeData} from 'src/editor/store/modules/Engine';\nexport function SetupSelection(json_node: EngineNodeData, json_parent: EngineNodeData) {\n\t// const json_selection = computed(()=>{\n\t// \treturn json_parent.selection\n\t// })\n\tconst is_selected: Readonly<Ref<boolean>> = computed(() => {\n\t\tif (json_parent.selection) {\n\t\t\tconst res: boolean = json_parent.selection.includes(json_node.graph_node_id);\n\t\t\treturn res;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t});\n\n\treturn {\n\t\tis_selected,\n\t};\n}\n","import { render, staticRenderFns } from \"./Connection.vue?vue&type=template&id=0679f2b4&lang=pug&\"\nimport script from \"./Connection.vue?vue&type=script&lang=ts&\"\nexport * from \"./Connection.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Connection.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('0679f2b4')) {\n      api.createRecord('0679f2b4', component.options)\n    } else {\n      api.reload('0679f2b4', component.options)\n    }\n    module.hot.accept(\"./Connection.vue?vue&type=template&id=0679f2b4&lang=pug&\", function () {\n      api.rerender('0679f2b4', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/Connection.vue\"\nexport default component.exports","import mod from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Connection.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Connection.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeConnection{position:absolute;width:0;height:0}.NetworkNodeConnection svg{position:absolute;pointer-events:none}.NetworkNodeConnection svg line{pointer-events:auto;stroke:#1779ba;stroke-width:2px}.NetworkNodeConnection svg line.is_src_not_cloned{stroke:purple;stroke-width:6px}.NetworkNodeConnection svg line.is_src_not_cloned:hover{stroke:#9a009a}.NetworkNodeConnection svg line:hover{stroke:#1a88d1}.NetworkNodeConnection svg line.mismatched_types{stroke:#cc4b37;stroke-width:6px}.NetworkNodeConnection svg line.bool{stroke:#e600e6}.NetworkNodeConnection svg line.int{stroke:#f38073}.NetworkNodeConnection svg line.float{stroke:#ff0}.NetworkNodeConnection svg line.vec2{stroke:#008f00}.NetworkNodeConnection svg line.vec3{stroke:#66f}.NetworkNodeConnection svg line.vec4{stroke:#990}.NetworkNodeConnection svg line.mat3{stroke:#99f}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./NodeInfo.vue?vue&type=template&id=95be7ed0&lang=pug&\"\nimport script from \"./NodeInfo.vue?vue&type=script&lang=ts&\"\nexport * from \"./NodeInfo.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./NodeInfo.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('95be7ed0')) {\n      api.createRecord('95be7ed0', component.options)\n    } else {\n      api.reload('95be7ed0', component.options)\n    }\n    module.hot.accept(\"./NodeInfo.vue?vue&type=template&id=95be7ed0&lang=pug&\", function () {\n      api.rerender('95be7ed0', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/NodeInfo.vue\"\nexport default component.exports","import {Vector2} from 'three/src/math/Vector2';\n\nimport {TypedSopNode} from './_Base';\n// import {ParamType} from 'src/Engine/Param/_Module'\n\n// import {Lifespan} from './Concerns/ParticlesSystemGPU/Lifespan';\n// import {GPUCompute} from './Concerns/ParticlesSystemGPU/GPUCompute';\n// import {RenderMaterial} from './Concerns/ParticlesSystemGPU/RenderMaterial';\n// import {ParticleShaderBuilder} from './Concerns/ParticlesSystemGPU/ParticleShaderBuilder'\n// import {AssemblerOwner} from 'src/Engine/Node/Gl/Assembler/Owner';\nimport {ShaderAssemblerParticles} from 'src/engine/nodes/gl/code/assemblers/Particles';\nimport {GlobalsTextureHandler} from 'src/engine/nodes/gl/code/globals/Texture';\n\n// SPECS:\n// - simulation shaders should update the particles at any frame, and resimulate accordingly when at later frames\n// - render material should update at any frame, without having to resimulate\n// - changing the input will recompute, when on first frame only (otherwise an animated geo could make it recompute all the time)\n\n// AssemblerOwner(\n// \tRenderMaterial(\n// \tLifespan(\n// \tGPUCompute(\nimport {InputCloneMode} from 'src/engine/poly/InputCloneMode';\nimport {BaseNodeType} from '../_Base';\nimport {BaseParamType} from 'src/engine/params/_Base';\nimport {NodeContext} from 'src/engine/poly/NodeContext';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {GlAssemblerController} from '../gl/code/Controller';\nimport {MaterialsObjNode} from '../obj/Materials';\nimport {GlNodeChildrenMap} from 'src/engine/poly/registers/Gl';\nimport {BaseGlNodeType} from '../gl/_Base';\nimport {ParticlesSystemGpuRenderController} from './utils/ParticlesSystemGPU/RenderController';\nimport {ParticlesSystemGpuComputeController} from './utils/ParticlesSystemGPU/GPUComputeController';\n\nimport {NodeParamsConfig, ParamConfig} from 'src/engine/nodes/utils/params/ParamsConfig';\nimport {ShaderName} from '../utils/shaders/ShaderName';\nimport {GlNodeFinder} from '../gl/code/utils/NodeFinder';\nclass ParticlesSystemGpuSopParamsConfig extends NodeParamsConfig {\n\t// gpu compute\n\tstart_frame = ParamConfig.FLOAT(1, {range: [1, 100]});\n\tauto_textures_size = ParamConfig.BOOLEAN(1);\n\tmax_textures_size = ParamConfig.VECTOR2([1024, 1024], {visible_if: {auto_textures_size: 1}});\n\ttextures_size = ParamConfig.VECTOR2([64, 64], {visible_if: {auto_textures_size: 0}});\n\treset = ParamConfig.BUTTON(null, {\n\t\tcallback: (node: BaseNodeType, param: BaseParamType) => {\n\t\t\tParticlesSystemGpuSopNode.PARAM_CALLBACK_reset(node as ParticlesSystemGpuSopNode);\n\t\t},\n\t});\n\n\t// render\n\t// this.self.within_param_folder(\"setup\", () => {\n\tmaterial = ParamConfig.OPERATOR_PATH('', {\n\t\tnode_selection: {\n\t\t\tcontext: NodeContext.MAT,\n\t\t},\n\t\tdependent_on_found_node: false,\n\t});\n}\nconst ParamsConfig = new ParticlesSystemGpuSopParamsConfig();\nexport class ParticlesSystemGpuSopNode extends TypedSopNode<ParticlesSystemGpuSopParamsConfig> {\n\tparams_config = ParamsConfig;\n\tstatic type() {\n\t\treturn 'particles_system_gpu';\n\t}\n\tprotected _assembler_controller: GlAssemblerController<ShaderAssemblerParticles> = new GlAssemblerController<\n\t\tShaderAssemblerParticles\n\t>(this, ShaderAssemblerParticles);\n\tget assembler_controller() {\n\t\treturn this._assembler_controller;\n\t}\n\n\tpublic readonly gpu_controller = new ParticlesSystemGpuComputeController(this);\n\tpublic readonly render_controller = new ParticlesSystemGpuRenderController(this);\n\n\tstatic require_webgl2() {\n\t\treturn true;\n\t}\n\tstatic PARAM_CALLBACK_reset(node: ParticlesSystemGpuSopNode) {\n\t\tnode.PARAM_CALLBACK_reset();\n\t}\n\tPARAM_CALLBACK_reset() {\n\t\tthis.gpu_controller.reset_gpu_compute_and_set_dirty();\n\t}\n\n\tstatic displayed_input_names(): string[] {\n\t\treturn ['points to emit particles from'];\n\t}\n\n\tprivate _reset_material_if_dirty_bound = this._reset_material_if_dirty.bind(this);\n\tinitialize_node() {\n\t\t// this._init_common_shader_builder(ShaderAssemblerParticles, {\n\t\t// \thas_display_flag: true,\n\t\t// \tupdate_on_dirty: false,\n\t\t// });\n\n\t\tthis.io.inputs.set_count(1);\n\t\t// set to never at the moment\n\t\t// otherwise the input is cloned on every frame inside cook_main()\n\t\tthis.io.inputs.init_inputs_clonable_state([InputCloneMode.NEVER]);\n\n\t\tthis.add_post_dirty_hook('_reset_material_if_dirty', this._reset_material_if_dirty_bound);\n\t}\n\n\tcreate_node<K extends keyof GlNodeChildrenMap>(type: K): GlNodeChildrenMap[K] {\n\t\treturn super.create_node(type) as GlNodeChildrenMap[K];\n\t}\n\tchildren() {\n\t\treturn super.children() as BaseGlNodeType[];\n\t}\n\tnodes_by_type<K extends keyof GlNodeChildrenMap>(type: K): GlNodeChildrenMap[K][] {\n\t\treturn super.nodes_by_type(type) as GlNodeChildrenMap[K][];\n\t}\n\n\t// create_params() {\n\t// \t// this._create_gpu_compute_params();\n\t// \t// this._create_render_params();\n\t// \tthis._create_lifespan_params();\n\t// }\n\n\tasync _reset_material_if_dirty() {\n\t\t// if(\n\t\t// \tdirty_trigger.graph_node_id &&\n\t\t// \tthis._render_material_node &&\n\t\t// \tdirty_trigger.graph_node_id() == this._render_material_node.graph_node_id()\n\t\t// ){\n\t\t// \tthis.remove_dirty_state()\n\t\t// } else {\n\t\tif (this.p.material.is_dirty) {\n\t\t\tthis.render_controller.reset_render_material();\n\t\t\tif (!this.is_on_frame_start()) {\n\t\t\t\tawait this.render_controller.init_render_material();\n\t\t\t}\n\t\t}\n\t\t// }\n\t\t// that seems to create an infinite loop\n\t\t// maybe only check if the type of geo has changed?\n\t\t// if(this.input_graph_node(0).is_dirty()){\n\t\t// \tthis.set_compilation_required()\n\t\t// }\n\t}\n\n\tis_on_frame_start(): boolean {\n\t\treturn this.scene.frame == this.pv.start_frame;\n\t}\n\n\tasync cook(input_contents: CoreGroup[]) {\n\t\tconst core_group = input_contents[0];\n\t\t// this._simulation_restart_required = false;\n\t\t// let set_group_required = false;\n\t\t// let points:CorePoint[] = [];\n\n\t\tawait this.compile_if_required();\n\t\tawait this.assembler_controller.assign_uniform_values();\n\n\t\tif (this.is_on_frame_start()) {\n\t\t\tthis.gpu_controller.reset_particle_groups();\n\t\t}\n\n\t\tif (!this.gpu_controller.initialized) {\n\t\t\tawait this.gpu_controller.init(core_group);\n\t\t\t// this.gpu_controller.init_particle_group_points(core_group)\n\t\t\t// await this.gpu_controller.create_gpu_compute();\n\t\t}\n\n\t\t// if (!this._gpu_compute) {\n\t\t// \tawait this.gpu_controller.create_gpu_compute(points);\n\t\t// \t// set_group_required = true\n\t\t// }\n\t\tif (!this.render_controller.initialized) {\n\t\t\tthis.render_controller.init_core_group(core_group);\n\t\t\tawait this.render_controller.init_render_material();\n\t\t}\n\n\t\t// if (this._simulation_restart_required) {\n\t\t// \tthis._restart_simulation();\n\t\t// }\n\n\t\tthis.gpu_controller.compute_similation();\n\t\t// if (frame >= this.pv.start_frame) {\n\t\t// \tif (this._last_simulated_frame == null) {\n\t\t// \t\tthis._last_simulated_frame = this._param_start_frame - 1;\n\t\t// \t}\n\t\t// \tif (frame > this._last_simulated_frame) {\n\t\t// \t\tthis._compute_simulation(frame - this._last_simulated_frame);\n\t\t// \t}\n\t\t// }\n\n\t\tif (this.is_on_frame_start()) {\n\t\t\tthis.set_core_group(core_group);\n\t\t} else {\n\t\t\tthis.cook_controller.end_cook();\n\t\t}\n\t}\n\tasync compile_if_required() {\n\t\tif (this.assembler_controller.compile_required()) {\n\t\t\t// && !this._param_locked){\n\t\t\tawait this.run_assembler();\n\t\t\tconst shaders_by_name: Map<ShaderName, string> = this.assembler_controller.assembler.shaders_by_name();\n\t\t\tthis.gpu_controller.set_shaders_by_name(shaders_by_name);\n\t\t\tthis.render_controller.set_shaders_by_name(shaders_by_name);\n\t\t\t// if (shaders_by_name) {\n\t\t\t// \tawait this.eval_params(this._new_params);\n\t\t\t// \tthis._shaders_by_name = lodash_cloneDeep(shaders_by_name);\n\t\t\t// } else {\n\t\t\t// \tconsole.warn('no shaders by name from assembler');\n\t\t\t// }\n\t\t\tthis.gpu_controller.reset_gpu_compute();\n\t\t\tthis.gpu_controller.reset_particle_groups(); // this\n\t\t}\n\t}\n\t// shaders_by_name() {\n\t// \treturn this._shaders_by_name;\n\t// }\n\t// shaders(): string[] {\n\t// \treturn Object.keys(this._shaders_by_name).map((k) => this._shaders_by_name[k]);\n\t// }\n\tprivate async run_assembler() {\n\t\tconst root_nodes = this._find_root_nodes();\n\t\tif (root_nodes.length > 0) {\n\t\t\tconst globals_handler = new GlobalsTextureHandler(GlobalsTextureHandler.PARTICLE_SIM_UV);\n\t\t\tthis.assembler_controller.set_assembler_globals_handler(globals_handler);\n\t\t\tthis.assembler_controller.assembler.set_root_nodes(root_nodes);\n\n\t\t\tthis.assembler_controller.assembler.compile();\n\t\t\tawait this.assembler_controller.post_compile();\n\t\t}\n\t}\n\n\tprivate _find_root_nodes() {\n\t\tconst nodes: BaseGlNodeType[] = GlNodeFinder.find_attribute_export_nodes(this);\n\t\tconst output_nodes = GlNodeFinder.find_output_nodes(this);\n\t\tif (output_nodes.length > 1) {\n\t\t\tthis.states.error.set('only one output node is allowed');\n\t\t\treturn [];\n\t\t}\n\t\tconst output_node = output_nodes[0];\n\t\tif (output_node) {\n\t\t\tnodes.push(output_node);\n\t\t}\n\t\treturn nodes;\n\t}\n\t// set_compilation_required_and_dirty() {\n\t// \tthis.assembler_controller.set_compilation_required_and_dirty();\n\t// }\n\n\ton_create() {\n\t\t// to ensure the doc can create a node to display param documentation\n\t\t// maybe there is a scene in the doc, so this isn't needed?\n\t\t// if(!this.scene()){return}\n\n\t\tconst globals = this.create_node('globals');\n\t\tconst output = this.create_node('output');\n\n\t\tglobals.ui_data.set_position(new Vector2(-200, 0));\n\t\toutput.ui_data.set_position(new Vector2(200, 0));\n\n\t\t// that's mostly to have the default shader work when creating the node\n\t\t// output.set_input('position', globals, 'position')\n\t\t// or instead we could create the default shader\n\t\tconst root = this.scene.root;\n\t\tconst mat_name = 'MAT';\n\t\tconst particles_mat_name = 'points_particles';\n\t\tconst MAT: MaterialsObjNode = root.nodes_by_type('materials')[0] || this.scene.root.create_node('materials');\n\t\tMAT.set_name(mat_name);\n\n\t\tconst create_points_mat = (MAT: MaterialsObjNode, name: string) => {\n\t\t\tconst points_mat = MAT.create_node('points')!;\n\t\t\tpoints_mat.set_name(name);\n\n\t\t\tconst points_mat_constant_point_size = points_mat.create_node('constant')!;\n\t\t\tpoints_mat_constant_point_size.set_name('constant_point_size');\n\t\t\tpoints_mat_constant_point_size.p.value_float.set(4); // to match the default point material\n\n\t\t\tconst points_mat_output1 = points_mat.node('output1');\n\t\t\tif (points_mat_output1) {\n\t\t\t\tpoints_mat_output1.set_input('gl_PointSize', points_mat_constant_point_size, 'value');\n\t\t\t}\n\n\t\t\treturn points_mat;\n\t\t};\n\t\tconst points_mat = MAT.node(particles_mat_name) || create_points_mat(MAT, particles_mat_name);\n\t\tif (points_mat) {\n\t\t\tthis.p.material.set(points_mat.full_path());\n\t\t}\n\t}\n}\n","import {BaseGlShaderAssembler} from './_Base';\n// import {GlobalsTextureHandler} from 'src/engine/nodes/gl/Assembler/Globals/Texture';\n\nimport TemplateDefault from '../templates/particles/Default.glsl';\n// import TemplatePosition from './Template/Particle/Position.glsl'\n// import TemplateVelocity from './Template/Particle/Velocity.glsl'\n// import TemplateAcceleration from './Template/Particle/Acceleration.glsl'\n\n// import {ShaderConfig} from './Config/ShaderConfig';\n// import {VariableConfig} from './Config/VariableConfig';\n// import {ShaderName, LineType} from 'src/Engine/Node/Gl/Assembler/Util/CodeBuilder';\nimport {AttributeGlNode} from '../../Attribute';\nimport {TextureAllocationsController} from '../utils/TextureAllocationsController';\nimport {ThreeToGl} from 'src/core/ThreeToGl';\nimport {BaseGlNodeType} from '../../_Base';\nimport {GlobalsGlNode} from '../../Globals';\nimport {TypedNodeTraverser} from '../../../utils/shaders/NodeTraverser';\nimport {ShaderName} from '../../../utils/shaders/ShaderName';\nimport {OutputGlNode} from '../../Output';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {TypedNamedConnectionPoint} from '../../../utils/connections/NamedConnectionPoint';\nimport {ConnectionPointType} from '../../../utils/connections/ConnectionPointType';\nimport {UniformGLDefinition} from '../../utils/GLDefinition';\nimport {GlobalsTextureHandler} from '../globals/Texture';\nimport {ShadersCollectionController} from '../utils/ShadersCollectionController';\n\nexport class ShaderAssemblerParticles extends BaseGlShaderAssembler {\n\tprivate _texture_allocations_controller: TextureAllocationsController | undefined;\n\n\tget _template_shader() {\n\t\treturn undefined;\n\t}\n\tprotected _template_shader_for_shader_name(shader_name: ShaderName) {\n\t\treturn TemplateDefault;\n\t}\n\t// async get_shaders(){\n\t// \tawait this.update_shaders()\n\t// \treturn this._shaders_by_name\n\t// }\n\n\tasync compile() {\n\t\tawait this.setup_shader_names_and_variables();\n\t\tawait this.update_shaders();\n\t}\n\n\troot_nodes_by_shader_name(shader_name: ShaderName): BaseGlNodeType[] {\n\t\t// return this._root_nodes\n\t\tconst list = [];\n\t\tfor (let node of this._root_nodes) {\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'output': {\n\t\t\t\t\tlist.push(node);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'attribute': {\n\t\t\t\t\t// TODO: typescript - gl - why is there a texture allocation controller in the base assembler?\n\t\t\t\t\tconst attrib_name = (node as AttributeGlNode).attribute_name;\n\t\t\t\t\tconst variable = this._texture_allocations_controller?.variable(attrib_name);\n\t\t\t\t\tif (variable && variable.allocation) {\n\t\t\t\t\t\tconst allocation_shader_name = variable.allocation.shader_name;\n\t\t\t\t\t\tif (allocation_shader_name == shader_name) {\n\t\t\t\t\t\t\tlist.push(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\tleaf_nodes_by_shader_name(shader_name: ShaderName): BaseGlNodeType[] {\n\t\tconst list = [];\n\t\tfor (let node of this._leaf_nodes) {\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'globals': {\n\t\t\t\t\tlist.push(node);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'attribute': {\n\t\t\t\t\t// TODO: typescript - gl - why is there a texture allocation controller in the base assembler? AND especially since there is no way to assign it?\n\t\t\t\t\tconst attrib_name: string = (node as AttributeGlNode).attribute_name;\n\t\t\t\t\tconst variable = this._texture_allocations_controller?.variable(attrib_name);\n\t\t\t\t\tif (variable && variable.allocation) {\n\t\t\t\t\t\tconst allocation_shader_name = variable.allocation.shader_name;\n\t\t\t\t\t\tif (allocation_shader_name == shader_name) {\n\t\t\t\t\t\t\tlist.push(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\tasync setup_shader_names_and_variables() {\n\t\tconst node_traverser = new TypedNodeTraverser<BaseGlNodeType>(this, this._gl_parent_node);\n\t\tthis._leaf_nodes = node_traverser.leaves_from_nodes(this._root_nodes);\n\n\t\tfor (let node of this._root_nodes) {\n\t\t\tawait node.params.eval_all();\n\t\t}\n\t\tfor (let node of this._leaf_nodes) {\n\t\t\tawait node.params.eval_all();\n\t\t}\n\n\t\tthis._texture_allocations_controller = new TextureAllocationsController();\n\t\tthis._texture_allocations_controller.allocate_connections_from_root_nodes(this._root_nodes, this._leaf_nodes);\n\n\t\t// const globals_handler = new GlobalsTextureHandler()\n\t\t// this.set_assembler_globals_handler(globals_handler)\n\t\tif (this.globals_handler) {\n\t\t\t((<unknown>this.globals_handler) as GlobalsTextureHandler)?.set_texture_allocations_controller(\n\t\t\t\tthis._texture_allocations_controller\n\t\t\t);\n\t\t}\n\n\t\tthis._reset_shader_configs();\n\t}\n\tasync update_shaders() {\n\t\tthis._shaders_by_name = new Map();\n\t\tthis._lines = new Map();\n\t\tfor (let shader_name of this.shader_names) {\n\t\t\tconst template = this._template_shader_for_shader_name(shader_name);\n\t\t\tthis._lines.set(shader_name, template.split('\\n'));\n\t\t}\n\t\tif (this._root_nodes.length > 0) {\n\t\t\t// this._output_node.set_assembler(this)\n\t\t\tawait this.build_code_from_nodes(this._root_nodes);\n\n\t\t\tthis._build_lines();\n\t\t}\n\t\t// this._material.uniforms = this.build_uniforms(template_shader)\n\t\tfor (let shader_name of this.shader_names) {\n\t\t\tconst lines = this._lines.get(shader_name);\n\t\t\tif (lines) {\n\t\t\t\tthis._shaders_by_name.set(shader_name, lines.join('\\n'));\n\t\t\t}\n\t\t}\n\t}\n\n\t//\n\t//\n\t// CHILDREN NODES PARAMS\n\t//\n\t//\n\tadd_output_params(output_child: OutputGlNode) {\n\t\toutput_child.add_param(ParamType.VECTOR3, 'position', [0, 0, 0]);\n\t\toutput_child.add_param(ParamType.VECTOR3, 'velocity', [0, 0, 0]);\n\t\toutput_child.add_param(ParamType.VECTOR3, 'acceleration', [0, 0, 0]);\n\t}\n\tadd_globals_params(globals_node: GlobalsGlNode) {\n\t\tglobals_node.io.outputs.set_named_output_connection_points([\n\t\t\tnew TypedNamedConnectionPoint('position', ConnectionPointType.VEC3),\n\t\t\tnew TypedNamedConnectionPoint('velocity', ConnectionPointType.VEC3),\n\t\t\tnew TypedNamedConnectionPoint('acceleration', ConnectionPointType.VEC3),\n\t\t\tnew TypedNamedConnectionPoint('frame', ConnectionPointType.FLOAT),\n\t\t]);\n\t}\n\tallow_attribute_exports() {\n\t\treturn true;\n\t}\n\n\tget texture_allocations_controller() {\n\t\treturn (this._texture_allocations_controller =\n\t\t\tthis._texture_allocations_controller || new TextureAllocationsController());\n\t}\n\n\t//\n\t//\n\t// CONFIGS\n\t//\n\t//\n\tcreate_shader_configs() {\n\t\treturn this._texture_allocations_controller?.create_shader_configs() || [];\n\t\t// [\n\t\t// \tnew ShaderConfig('position', ['position'], []),\n\t\t// \t// new ShaderConfig('fragment', ['color', 'alpha'], ['vertex']),\n\t\t// ]\n\t}\n\tcreate_variable_configs() {\n\t\treturn [\n\t\t\t// new VariableConfig('position', {\n\t\t\t// \tdefault: 'vec3( position )',\n\t\t\t// \tprefix: 'vec3 transformed = '\n\t\t\t// }),\n\t\t];\n\t}\n\tget shader_names(): ShaderName[] {\n\t\treturn this.texture_allocations_controller.shader_names() || [];\n\t}\n\tinput_names_for_shader_name(root_node: BaseGlNodeType, shader_name: ShaderName) {\n\t\treturn this.texture_allocations_controller.input_names_for_shader_name(root_node, shader_name) || [];\n\t\t// return this.shader_config(shader_name).input_names()\n\t}\n\n\t//\n\t//\n\t// TEMPLATE HOOKS\n\t//\n\t//\n\tprotected insert_define_after(shader_name: ShaderName) {\n\t\treturn '// INSERT DEFINE';\n\t}\n\tprotected insert_body_after(shader_name: ShaderName) {\n\t\treturn '// INSERT BODY';\n\t}\n\tprotected lines_to_remove(shader_name: ShaderName) {\n\t\treturn ['// INSERT DEFINE', '// INSERT BODY'];\n\t}\n\n\t//\n\t//\n\t// TEMPLATE CODE REPLACEMENT\n\t//\n\t//\n\tadd_export_body_line(\n\t\texport_node: BaseGlNodeType,\n\t\tinput_name: string,\n\t\tinput: BaseGlNodeType,\n\t\tvariable_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {\n\t\tif (input) {\n\t\t\tconst var_input = export_node.variable_for_input(input_name);\n\t\t\tconst new_var = ThreeToGl.vector3(var_input);\n\t\t\tif (new_var) {\n\t\t\t\tconst texture_variable = this.texture_allocations_controller.variable(variable_name);\n\n\t\t\t\t// if we are in the texture this variable is allocated to, we write it back\n\t\t\t\tconst shader_name = shaders_collection_controller.current_shader_name;\n\t\t\t\tif (texture_variable && texture_variable.allocation?.shader_name == shader_name) {\n\t\t\t\t\tconst component = texture_variable.component;\n\n\t\t\t\t\tconst line = `gl_FragColor.${component} = ${new_var}`;\n\t\t\t\t\tshaders_collection_controller.add_body_lines(export_node, [line], shader_name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tset_node_lines_output(output_node: BaseGlNodeType, shaders_collection_controller: ShadersCollectionController) {\n\t\tconst shader_name = shaders_collection_controller.current_shader_name;\n\t\tconst input_names = this.texture_allocations_controller.input_names_for_shader_name(output_node, shader_name);\n\t\tif (input_names) {\n\t\t\tfor (let input_name of input_names) {\n\t\t\t\tconst input = output_node.io.inputs.named_input(input_name);\n\n\t\t\t\tif (input) {\n\t\t\t\t\tconst variable_name = input_name;\n\t\t\t\t\tthis.add_export_body_line(\n\t\t\t\t\t\toutput_node,\n\t\t\t\t\t\tinput_name,\n\t\t\t\t\t\tinput,\n\t\t\t\t\t\tvariable_name,\n\t\t\t\t\t\tshaders_collection_controller\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// position reads the default attribute position\n\t\t\t\t\t// or maybe there is no need?\n\t\t\t\t\t// if(input_name == 'position'){\n\t\t\t\t\t// \tthis.globals_handler().read_attribute(output_node, 'vec3', 'position')\n\t\t\t\t\t// }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tset_node_lines_attribute(\n\t\tattribute_node: AttributeGlNode,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {\n\t\tif (attribute_node.is_importing) {\n\t\t\tconst gl_type = attribute_node.gl_type();\n\t\t\tconst attribute_name = attribute_node.attribute_name;\n\t\t\tconst new_value = this.globals_handler?.read_attribute(\n\t\t\t\tattribute_node,\n\t\t\t\tgl_type,\n\t\t\t\tattribute_name,\n\t\t\t\tshaders_collection_controller\n\t\t\t);\n\t\t\tconst var_name = attribute_node.gl_var_name(attribute_node.output_name);\n\t\t\tconst body_line = `${gl_type} ${var_name} = ${new_value}`;\n\t\t\tshaders_collection_controller.add_body_lines(attribute_node, [body_line]);\n\n\t\t\t// re-export to ensure it is available on next frame\n\t\t\tconst texture_variable = this.texture_allocations_controller.variable(attribute_name);\n\t\t\tconst shader_name = shaders_collection_controller.current_shader_name;\n\t\t\tif (texture_variable && texture_variable.allocation?.shader_name == shader_name) {\n\t\t\t\tconst variable = this.texture_allocations_controller.variable(attribute_name);\n\t\t\t\tif (variable) {\n\t\t\t\t\tconst component = variable.component;\n\t\t\t\t\tconst body_line = `gl_FragColor.${component} = ${var_name}`;\n\t\t\t\t\tshaders_collection_controller.add_body_lines(attribute_node, [body_line]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// this.add_import_body_line(\n\t\t\t// \tattribute_node,\n\t\t\t// \tshader_name,\n\t\t\t// \tAttribute.output_name(),\n\t\t\t// \tattribute_node.attribute_name()\n\t\t\t// \t)\n\t\t}\n\t\tif (attribute_node.is_exporting) {\n\t\t\tconst input = attribute_node.connected_input_node();\n\t\t\tif (input) {\n\t\t\t\tconst variable_name = attribute_node.attribute_name;\n\n\t\t\t\tthis.add_export_body_line(\n\t\t\t\t\tattribute_node,\n\t\t\t\t\tattribute_node.input_name,\n\t\t\t\t\tinput,\n\t\t\t\t\tvariable_name,\n\t\t\t\t\tshaders_collection_controller\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\tset_node_lines_globals(globals_node: GlobalsGlNode, shaders_collection_controller: ShadersCollectionController) {\n\t\tfor (let output_name of globals_node.io.outputs.used_output_names()) {\n\t\t\tswitch (output_name) {\n\t\t\t\tcase 'frame':\n\t\t\t\t\tthis._handle_globals_frame(globals_node, output_name, shaders_collection_controller);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis._handle_globals_default(globals_node, output_name, shaders_collection_controller);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _handle_globals_frame(\n\t\tglobals_node: GlobalsGlNode,\n\t\toutput_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {\n\t\tconst definition = new UniformGLDefinition(globals_node, ConnectionPointType.FLOAT, output_name);\n\t\tshaders_collection_controller.add_definitions(globals_node, [definition]);\n\n\t\tconst var_name = globals_node.gl_var_name(output_name);\n\t\tconst body_line = `float ${var_name} = ${output_name}`;\n\t\tshaders_collection_controller.add_body_lines(globals_node, [body_line]);\n\t\tthis.set_frame_dependent();\n\t}\n\n\tprivate _handle_globals_default(\n\t\tglobals_node: GlobalsGlNode,\n\t\toutput_name: string,\n\t\tshaders_collection_controller: ShadersCollectionController\n\t) {\n\t\tconst output_connection_point = globals_node.io.outputs.named_output_connection_points_by_name(output_name);\n\t\tif (output_connection_point) {\n\t\t\tconst gl_type = output_connection_point.type;\n\n\t\t\tconst attrib_read = this.globals_handler?.read_attribute(\n\t\t\t\tglobals_node,\n\t\t\t\tgl_type,\n\t\t\t\toutput_name,\n\t\t\t\tshaders_collection_controller\n\t\t\t);\n\t\t\tconst var_name = globals_node.gl_var_name(output_name);\n\t\t\tconst body_line = `${gl_type} ${var_name} = ${attrib_read}`;\n\t\t\tshaders_collection_controller.add_body_lines(globals_node, [body_line]);\n\t\t}\n\t}\n}\n","export default \"#include <common>\\n\\n// INSERT DEFINE\\n\\nvoid main() {\\n\\n\\tvec2 particleUV = (gl_FragCoord.xy / resolution.xy);\\n\\n\\t// INSERT BODY\\n\\n}\"","import lodash_flatten from 'lodash/flatten';\nimport lodash_uniq from 'lodash/uniq';\nimport lodash_sortBy from 'lodash/sortBy';\nimport lodash_includes from 'lodash/includes';\nimport {TextureAllocation} from './TextureAllocation';\nimport {BaseGlNodeType} from 'src/engine/nodes/gl/_Base';\n\n// import {TypedConnection, COMPONENTS_COUNT_BY_TYPE} from 'src/Engine/Node/Gl/GlData';\nimport {TextureVariable, TextureVariableData} from './TextureVariable';\nimport {ShaderConfig} from '../configs/ShaderConfig';\nimport {ShaderName, ParticleShaderNames} from 'src/engine/nodes/utils/shaders/ShaderName';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\nimport {ConnectionPointComponentsCountMap} from 'src/engine/nodes/utils/connections/ConnectionPointType';\nimport {AttributeGlNode} from '../../Attribute';\nimport {BaseNamedConnectionPointType} from 'src/engine/nodes/utils/connections/NamedConnectionPoint';\nimport {GlobalsGlNode} from '../../Globals';\n\nexport type TextureAllocationsControllerData = Dictionary<TextureVariableData[] | undefined>[];\n\nexport class TextureAllocationsController {\n\tprivate _allocations: TextureAllocation[] = [];\n\tprivate _next_allocation_index: number = 0;\n\n\tconstructor() {}\n\tallocate_connections_from_root_nodes(root_nodes: BaseGlNodeType[], leaf_nodes: BaseGlNodeType[]) {\n\t\t// const connections_by_node_id = {}\n\t\tconst variables = [];\n\n\t\t// TODO: let's go through the output node first, in case there is a name conflict, it will have priority\n\t\tfor (let node of root_nodes) {\n\t\t\tconst node_id = node.graph_node_id;\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'output': {\n\t\t\t\t\tfor (let connection_point of node.io.inputs.named_input_connection_points) {\n\t\t\t\t\t\tconst input = node.io.inputs.named_input(connection_point.name);\n\t\t\t\t\t\tif (input) {\n\t\t\t\t\t\t\t// connections_by_node_id[node_id] = connections_by_node_id[node_id] || []\n\t\t\t\t\t\t\t// connections_by_node_id[node_id].push(named_input)\n\t\t\t\t\t\t\tconst variable = new TextureVariable(\n\t\t\t\t\t\t\t\tconnection_point.name,\n\t\t\t\t\t\t\t\tConnectionPointComponentsCountMap[connection_point.type]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tvariable.add_graph_node_id(node_id);\n\t\t\t\t\t\t\tvariables.push(variable);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'attribute': {\n\t\t\t\t\tconst attrib_node = node as AttributeGlNode;\n\t\t\t\t\tconst named_input: BaseGlNodeType | null = attrib_node.connected_input_node();\n\t\t\t\t\tconst connection_point:\n\t\t\t\t\t\t| BaseNamedConnectionPointType\n\t\t\t\t\t\t| undefined = attrib_node.connected_input_connection_point();\n\t\t\t\t\tif (named_input && connection_point) {\n\t\t\t\t\t\t// connections_by_node_id[node_id] = connections_by_node_id[node_id] || []\n\t\t\t\t\t\t// connections_by_node_id[node_id].push(named_input)\n\t\t\t\t\t\tconst variable = new TextureVariable(\n\t\t\t\t\t\t\tattrib_node.attribute_name,\n\t\t\t\t\t\t\tConnectionPointComponentsCountMap[connection_point.type]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tvariable.add_graph_node_id(node_id);\n\t\t\t\t\t\tvariables.push(variable);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let node of leaf_nodes) {\n\t\t\tconst node_id = node.graph_node_id;\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'globals': {\n\t\t\t\t\tconst globals_node = node as GlobalsGlNode;\n\t\t\t\t\tconst output_names_attributes = ['position', 'normal', 'color', 'uv'];\n\t\t\t\t\t// const output_names_not_attributes = ['frame', 'gl_FragCoord', 'gl_PointCoord'];\n\t\t\t\t\tfor (let output_name of globals_node.io.outputs.used_output_names()) {\n\t\t\t\t\t\t// const is_attribute = !lodash_includes(output_names_not_attributes, output_name)\n\n\t\t\t\t\t\t// is_attribute, as opposed to frame, gl_FragCoord and gl_PointCoord which are either uniforms or provided by the renderer\n\t\t\t\t\t\tconst is_attribute = output_names_attributes.includes(output_name);\n\n\t\t\t\t\t\tif (is_attribute) {\n\t\t\t\t\t\t\tconst connection_point = globals_node.io.outputs.named_output_connection_points_by_name(\n\t\t\t\t\t\t\t\toutput_name\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (connection_point) {\n\t\t\t\t\t\t\t\tconst gl_type = connection_point.type;\n\t\t\t\t\t\t\t\tconst variable = new TextureVariable(\n\t\t\t\t\t\t\t\t\toutput_name,\n\t\t\t\t\t\t\t\t\tConnectionPointComponentsCountMap[gl_type]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tvariable.add_graph_node_id(node_id);\n\t\t\t\t\t\t\t\tvariables.push(variable);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'attribute': {\n\t\t\t\t\tconst attribute_node = node as AttributeGlNode;\n\t\t\t\t\tconst connection_point = attribute_node.output_connection_point();\n\t\t\t\t\tif (connection_point) {\n\t\t\t\t\t\t// connections_by_node_id[node_id] = connections_by_node_id[node_id] || []\n\t\t\t\t\t\t// connections_by_node_id[node_id].push(named_output)\n\t\t\t\t\t\tconst variable = new TextureVariable(\n\t\t\t\t\t\t\tattribute_node.attribute_name,\n\t\t\t\t\t\t\tConnectionPointComponentsCountMap[connection_point.type]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tvariable.add_graph_node_id(node_id);\n\t\t\t\t\t\tvariables.push(variable);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.allocate_variables(variables);\n\t}\n\tallocate_variables(variables: TextureVariable[]) {\n\t\tconst variables_by_size_inverse = lodash_sortBy(variables, (variable) => {\n\t\t\treturn -variable.size;\n\t\t});\n\t\tfor (let variable of variables_by_size_inverse) {\n\t\t\tthis.allocate_variable(variable);\n\t\t}\n\t}\n\tallocate_variable(new_variable: TextureVariable) {\n\t\tlet allocated = this.has_variable(new_variable.name);\n\t\tif (allocated) {\n\t\t\tconst allocated_variable = this.variables().filter((v) => v.name == new_variable.name)[0];\n\t\t\tnew_variable.graph_node_ids?.forEach((boolean, graph_node_id: string) => {\n\t\t\t\tallocated_variable.add_graph_node_id(graph_node_id);\n\t\t\t});\n\t\t} else {\n\t\t\tif (!allocated) {\n\t\t\t\tfor (let allocation of this._allocations) {\n\t\t\t\t\tif (!allocated && allocation.has_space_for_variable(new_variable)) {\n\t\t\t\t\t\tallocation.add_variable(new_variable);\n\t\t\t\t\t\tallocated = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!allocated) {\n\t\t\t\tconst new_allocation = new TextureAllocation(this.next_allocation_name());\n\t\t\t\tthis._allocations.push(new_allocation);\n\t\t\t\tnew_allocation.add_variable(new_variable);\n\t\t\t}\n\t\t}\n\t}\n\n\tnext_allocation_name(): ShaderName {\n\t\tconst name = ParticleShaderNames[this._next_allocation_index];\n\t\tthis._next_allocation_index += 1;\n\t\treturn name;\n\t}\n\n\tshader_names(): ShaderName[] {\n\t\tconst explicit_shader_names = this._allocations.map((a) => a.shader_name);\n\n\t\t// include dependencies if needed\n\t\t// TODO: typescript - do I need those?\n\t\t// if (lodash_includes(explicit_shader_names, 'acceleration')) {\n\t\t// \texplicit_shader_names.push('velocity');\n\t\t// }\n\t\t// if (lodash_includes(explicit_shader_names, 'velocity')) {\n\t\t// \texplicit_shader_names.push('position');\n\t\t// }\n\n\t\treturn lodash_uniq(explicit_shader_names);\n\t}\n\tcreate_shader_configs(): ShaderConfig[] {\n\t\treturn [\n\t\t\t// new ShaderConfig('position', ['position'], []),\n\t\t\t// new ShaderConfig('fragment', ['color', 'alpha'], ['vertex']),\n\t\t];\n\t}\n\tallocation_for_shader_name(shader_name: ShaderName): TextureAllocation {\n\t\treturn this._allocations.filter((a) => a.shader_name == shader_name)[0];\n\t}\n\tinput_names_for_shader_name(root_node: BaseGlNodeType, shader_name: ShaderName) {\n\t\tconst allocation = this.allocation_for_shader_name(shader_name);\n\t\tif (allocation) {\n\t\t\treturn allocation.input_names_for_node(root_node);\n\t\t}\n\t}\n\t// find_variable(root_node: BaseNodeGl, shader_name: ShaderName, input_name: string): TextureVariable{\n\t// \tconst allocation = this.allocation_for_shader_name(shader_name)\n\t// \tif(allocation){\n\t// \t\treturn allocation.find_variable_with_node(root_node, input_name)\n\t// \t}\n\t// }\n\tvariable(variable_name: string): TextureVariable | undefined {\n\t\tfor (let allocation of this._allocations) {\n\t\t\tconst variable = allocation.variable(variable_name);\n\t\t\tif (variable) {\n\t\t\t\treturn variable;\n\t\t\t}\n\t\t}\n\t}\n\tvariables(): TextureVariable[] {\n\t\treturn lodash_flatten(this._allocations.map((a) => a.variables || []));\n\t}\n\thas_variable(name: string): boolean {\n\t\tconst names = this.variables().map((v) => v.name);\n\t\treturn lodash_includes(names, name);\n\t}\n\t// allocation_for_variable(name:string):TextureAllocation{\n\t// \tfor(let allocation of this._allocations){\n\t// \t\tconst variables = allocation.variables()\n\t// \t\tfor(let variable of variables){\n\t// \t\t\tif(variable.name() == name){\n\t// \t\t\t\treturn allocation\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// }\n\tto_json(scene: PolyScene): TextureAllocationsControllerData {\n\t\treturn this._allocations.map((allocation: TextureAllocation) => {\n\t\t\tconst data = {\n\t\t\t\t[allocation.texture_name]: allocation.to_json(scene),\n\t\t\t};\n\t\t\treturn data;\n\t\t});\n\t}\n\tprint(scene: PolyScene) {\n\t\tconsole.log(JSON.stringify(this.to_json(scene), [''], 2));\n\t}\n}\n","import {TextureVariable, TextureVariableData} from './TextureVariable';\nimport {BaseGlNodeType} from 'src/engine/nodes/gl/_Base';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\nimport {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\n\nexport class TextureAllocation {\n\tprivate _variables: TextureVariable[] | undefined;\n\tprivate _size: number = 0;\n\n\tconstructor(private _shader_name: ShaderName) {}\n\n\tadd_variable(variable: TextureVariable) {\n\t\tthis._variables = this._variables || [];\n\t\tthis._variables.push(variable);\n\t\tvariable.set_position(this._size);\n\t\tvariable.set_allocation(this);\n\t\tthis._size += variable.size;\n\t}\n\n\thas_space_for_variable(variable: TextureVariable): boolean {\n\t\treturn this._size + variable.size <= 4;\n\t}\n\tget shader_name() {\n\t\treturn this._shader_name; //this._variables[0].name()\n\t}\n\tget texture_name(): string {\n\t\treturn `texture_${this._shader_name}`;\n\t}\n\n\tget variables(): TextureVariable[] | undefined {\n\t\treturn this._variables;\n\t}\n\tvariables_for_input_node(root_node: BaseGlNodeType): TextureVariable[] | undefined {\n\t\treturn this._variables?.filter((variable) => variable.graph_node_ids?.has(root_node.graph_node_id) || false);\n\t}\n\tinput_names_for_node(root_node: BaseGlNodeType): string[] | undefined {\n\t\treturn this.variables_for_input_node(root_node)?.map((v) => v.name);\n\t}\n\t// find_variable_with_node(root_node: BaseNodeGl, input_name: string): TextureVariable{\n\t// \treturn this.variables_for_input_node(root_node).filter(v=>v.name() == input_name)[0]\n\t// }\n\t// find_variable_without_node(input_name: string): TextureVariable{\n\t// \treturn this._variables.filter(v=>v.name() == input_name)[0]\n\t// }\n\tvariable(variable_name: string) {\n\t\tif (this._variables) {\n\t\t\tfor (let variable of this._variables) {\n\t\t\t\tif (variable.name == variable_name) {\n\t\t\t\t\treturn variable;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tto_json(scene: PolyScene): TextureVariableData[] | undefined {\n\t\treturn this._variables?.map((v) => v.to_json(scene));\n\t\t// for(let variable of this._variables){\n\t\t// \tdata[variable.name()] = variable.to_json(scene)\n\t\t// }\n\t\t// return data\n\t}\n}\n","import {TextureAllocation} from './TextureAllocation';\nimport {PolyScene} from 'src/engine/scene/PolyScene';\n\nexport interface TextureVariableData {\n\tname: string;\n\tnodes: string[];\n}\n\nexport class TextureVariable {\n\tprivate _allocation: TextureAllocation | undefined;\n\tprivate _position: number = -1;\n\n\tprivate _graph_node_ids: Map<string, boolean> | undefined;\n\n\tconstructor(private _name: string, private _size: number) {\n\t\tif (!_name) {\n\t\t\tthrow 'TextureVariable requires a name';\n\t\t}\n\t}\n\n\tset_allocation(allocation: TextureAllocation) {\n\t\tthis._allocation = allocation;\n\t}\n\tget allocation() {\n\t\treturn this._allocation;\n\t}\n\n\tget graph_node_ids() {\n\t\treturn this._graph_node_ids;\n\t}\n\tadd_graph_node_id(id: string) {\n\t\tthis._graph_node_ids = this._graph_node_ids || new Map();\n\t\tthis._graph_node_ids.set(id, true);\n\t}\n\tget name() {\n\t\treturn this._name;\n\t}\n\tget size() {\n\t\treturn this._size;\n\t}\n\n\tset_position(position: number) {\n\t\tthis._position = position;\n\t}\n\tget position() {\n\t\treturn this._position;\n\t}\n\tget component(): string {\n\t\treturn 'xyzw'\n\t\t\t.split('')\n\t\t\t.splice(this._position, this._size)\n\t\t\t.join('');\n\t}\n\tto_json(scene: PolyScene): TextureVariableData {\n\t\tconst names: string[] = [];\n\t\tif (this._graph_node_ids) {\n\t\t\tthis._graph_node_ids.forEach((boolean, node_id: string) => {\n\t\t\t\tconst name = scene.graph.node_from_id(node_id).name;\n\t\t\t\tnames.push(name);\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tname: this.name,\n\t\t\tnodes: names.sort(),\n\t\t};\n\t}\n}\n","import lodash_cloneDeep from 'lodash/cloneDeep';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\n// import {BaseNodeSop} from '../_Base'\nimport {Object3D} from 'three/src/core/Object3D';\nimport {BaseBuilderMatNodeType} from 'src/engine/nodes/mat/_BaseBuilder';\n\n// import computeShaderPosition from 'src/Engine/Node/Gl/Assembler/Template/Particle/Position.glsl'\n// import computeShaderVelocity from 'src/Engine/Node/Gl/Assembler/Template/Particle/Particle.v.glsl'\n// import particleVertexShader from 'src/Engine/Node/Gl/Assembler/Template/Particle/Particle.vert.glsl'\n// import particleFragmentShader from 'src/Engine/Node/Gl/Assembler/Template/Particle/Particle.frag.glsl'\nimport {GlobalsTextureHandler} from 'src/engine/nodes/gl/code/globals/Texture';\n\nimport {ParticlesSystemGpuSopNode} from 'src/engine/nodes/sop/ParticlesSystemGpu';\nimport {CoreMaterial, ShaderMaterialWithCustomMaterials} from 'src/core/geometry/Material';\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {Mesh} from 'three/src/objects/Mesh';\nimport {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\nimport {TextureAllocationsControllerData} from 'src/engine/nodes/gl/code/utils/TextureAllocationsController';\n\nexport class ParticlesSystemGpuRenderController {\n\tprivate _render_material: ShaderMaterial | undefined;\n\tprotected _particles_group_objects: Object3D[] = [];\n\tprivate _shaders_by_name: Map<ShaderName, string> | undefined;\n\tprivate _texture_allocations_json: TextureAllocationsControllerData | undefined;\n\n\tconstructor(private node: ParticlesSystemGpuSopNode) {}\n\n\t// _create_render_params() {\n\t// \tthis.self.within_param_folder(\"setup\", () => {\n\t// \t\tthis.self.add_param(ParamType.OPERATOR_PATH, \"material\", \"\", {\n\t// \t\t\tnode_selection: {\n\t// \t\t\t\tcontext: NodeContext.MAT\n\t// \t\t\t},\n\t// \t\t\tdependent_on_found_node: false\n\t// \t\t});\n\t// \t});\n\t// }\n\tset_shaders_by_name(shaders_by_name: Map<ShaderName, string>) {\n\t\tthis._shaders_by_name = shaders_by_name;\n\t\tthis.reset_render_material();\n\t}\n\n\tassign_render_material() {\n\t\tif (!this._render_material) {\n\t\t\t// throw 'cannot assign non existing material';\n\t\t\treturn;\n\t\t}\n\t\tfor (let object3d of this._particles_group_objects) {\n\t\t\tconst object = object3d as Mesh;\n\t\t\tif (object.geometry) {\n\t\t\t\tobject.material = this._render_material;\n\t\t\t\tCoreMaterial.apply_custom_materials(object, this._render_material as ShaderMaterialWithCustomMaterials);\n\t\t\t\tobject.matrixAutoUpdate = false;\n\t\t\t\tobject.updateMatrix();\n\t\t\t}\n\t\t}\n\t\t// if this material is recomputed on a frame after the frame_start\n\t\t// we need to:\n\t\t// - mark the material as needsUpdate (to ensure it gets recompiled by the renderer)\n\t\t// - update the uniforms (to ensure the material gets the right values, as the uniforms have been reset)\n\t\tthis._render_material.needsUpdate = true;\n\t\tthis.update_render_material_uniforms();\n\t}\n\tupdate_render_material_uniforms() {\n\t\tif (!this._render_material) {\n\t\t\treturn;\n\t\t}\n\t\t// if (!this.self._gpu_compute) {\n\t\t// \treturn;\n\t\t// }\n\n\t\t// for (let shader_name of Object.keys(this._shaders_by_name)) {\n\t\tthis._shaders_by_name?.forEach((string, shader_name) => {\n\t\t\tconst texture = this.node.gpu_controller.getCurrentRenderTarget(shader_name)?.texture;\n\t\t\tif (texture) {\n\t\t\t\tconst uniform_name = `texture_${shader_name}`;\n\t\t\t\tif (this._render_material) {\n\t\t\t\t\tthis._render_material.uniforms[uniform_name].value = texture;\n\t\t\t\t\tCoreMaterial.assign_custom_uniforms(this._render_material, uniform_name, texture);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\treset_render_material() {\n\t\tthis._render_material = undefined;\n\t\tthis._particles_group_objects = []; //this._particles_core_group.objects()\n\t}\n\tget initialized(): boolean {\n\t\treturn this._render_material != null;\n\t}\n\n\tinit_core_group(core_group: CoreGroup) {\n\t\tfor (let child of core_group.objects()) {\n\t\t\tthis._particles_group_objects.push(child);\n\t\t}\n\t}\n\tasync init_render_material() {\n\t\t// if (this.self.compile_required()) {\n\t\t// \treturn;\n\t\t// }\n\t\tif (this._render_material) {\n\t\t\treturn;\n\t\t}\n\n\t\t// const uniforms_particles = {\n\t\t// \t\"texture_position\": { value: null },\n\t\t// \t// \"debugX\": { value: 0 },\n\t\t// \t// \"textureVelocity\": { value: null },\n\t\t// \t// \"cameraConstant\": { value: 1 }, //( camera ) },\n\t\t// \t// \"density\": { value: 1.0 }\n\t\t// };\n\n\t\t// ShaderMaterial\n\t\tconst mat_node = this.node.p.material.found_node() as BaseBuilderMatNodeType; // TODO: typescript - ensure node selection is safe, as it would currently crash with a non builder mat selected\n\t\tif (mat_node) {\n\t\t\tconst new_texture_allocations_json: TextureAllocationsControllerData = this.node.assembler_controller.assembler.texture_allocations_controller.to_json(\n\t\t\t\tthis.node.scene\n\t\t\t);\n\n\t\t\tconst globals_handler = new GlobalsTextureHandler(GlobalsTextureHandler.UV_VARYING);\n\t\t\tglobals_handler.set_texture_allocations_controller(\n\t\t\t\tthis.node.assembler_controller.assembler.texture_allocations_controller\n\t\t\t);\n\t\t\tmat_node.assembler_controller.set_assembler_globals_handler(globals_handler);\n\t\t\tif (\n\t\t\t\t!this._texture_allocations_json ||\n\t\t\t\tJSON.stringify(this._texture_allocations_json) != JSON.stringify(new_texture_allocations_json)\n\t\t\t) {\n\t\t\t\t// we need to set the node to dirty if a recompile is needed\n\t\t\t\t// otherwise it won't cook\n\t\t\t\t// but we also need to check if the texture_allocation has changed,\n\t\t\t\t// otherwise we'll have an infinite loop\n\t\t\t\tthis._texture_allocations_json = lodash_cloneDeep(new_texture_allocations_json);\n\t\t\t\tmat_node.set_dirty();\n\t\t\t}\n\t\t\t// set compilation required in case the texture allocation has changed\n\t\t\t// but not needed as it is done by set_assembler_globals_handler\n\t\t\t//found_node.set_compilation_required() //_and_dirty()\n\t\t\tconst container = await mat_node.request_container();\n\t\t\tthis._render_material = container.material() as ShaderMaterial; //.clone()\n\t\t\t// this._render_material.needsUpdate = true\n\t\t\t// this.self._assembler.texture_allocations_controller().print()\n\t\t\t// throw \"DEBUGGIN...\"\n\t\t} else {\n\t\t\tthis.node.states.error.set('render material not valid');\n\t\t\t// this._render_material = this._render_material || new ShaderMaterial( {\n\t\t\t// \tuniforms: {},\n\t\t\t// \tvertexShader: particleVertexShader,\n\t\t\t// \tfragmentShader: particleFragmentShader\n\t\t\t// } );\n\t\t}\n\n\t\t// add uniforms\n\t\tif (this._render_material) {\n\t\t\tconst uniforms = this._render_material.uniforms;\n\t\t\t// for (let shader_name of Object.keys(this._shaders_by_name)) {\n\t\t\tthis._shaders_by_name?.forEach((shader, shader_name) => {\n\t\t\t\tconst uniform_name = `texture_${shader_name}`;\n\t\t\t\tconst uniform_value = {value: null};\n\t\t\t\tuniforms[uniform_name] = uniform_value;\n\t\t\t\tif (this._render_material) {\n\t\t\t\t\tCoreMaterial.init_custom_material_uniforms(this._render_material, uniform_name, uniform_value);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// this._render_material.extensions.drawBuffers = true;\n\t\tthis.assign_render_material();\n\t}\n}\n","import {Vector2} from 'three/src/math/Vector2';\n\nimport {_Math} from 'three/src/math/Math';\nimport {InstancedBufferAttribute} from 'three/src/core/InstancedBufferAttribute';\nimport {DataTexture} from 'three/src/textures/DataTexture';\nimport {BufferAttribute} from 'three/src/core/BufferAttribute';\n\n// import {BaseNodeSop} from '../_Base'\n\n// import {CoreConstant} from 'src/Core/Geometry/Constant'\n\nimport {CoreGroup} from 'src/core/geometry/Group';\nimport {CoreMath} from 'src/core/math/_Module';\n\n// import computeShaderPosition from 'src/Engine/Node/Gl/Assembler/Template/Particle/Position.glsl'\n// import computeShaderVelocity from 'src/Engine/Node/Gl/Assembler/Template/Particle/Particle.v.glsl'\n// import particleVertexShader from 'src/Engine/Node/Gl/Assembler/Template/Particle/Particle.vert.glsl'\n// import particleFragmentShader from 'src/Engine/Node/Gl/Assembler/Template/Particle/Particle.frag.glsl'\nimport {GlobalsTextureHandler} from 'src/engine/nodes/gl/code/globals/Texture';\nimport {GPUComputationRenderer} from './GPUComputationRenderer';\nimport {ParticlesSystemGpuSopNode} from 'src/engine/nodes/sop/ParticlesSystemGpu';\nimport {WebGLRenderer} from 'three/src/renderers/WebGLRenderer';\nimport {WebGLRenderTarget} from 'three/src/renderers/WebGLRenderTarget';\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial';\nimport {POLY} from 'src/engine/Poly';\nimport {CorePoint} from 'src/core/geometry/Point';\nimport {ShaderName} from 'src/engine/nodes/utils/shaders/ShaderName';\n\ninterface GPUComputationRendererVariable {\n\tname: string;\n\trenderTargets: WebGLRenderTarget[];\n\tmaterial: ShaderMaterial;\n}\ninterface GPUComputationRenderer {\n\tnew (x: number, y: number, renderer: WebGLRenderer): GPUComputationRenderer;\n\tcompute(): void;\n\tinit(): string | null;\n\taddVariable(name: string, fragment_shader: string, variable: DataTexture): GPUComputationRendererVariable;\n\tsetVariableDependencies(variable: GPUComputationRendererVariable, vars: GPUComputationRendererVariable[]): void;\n\trenderTexture(texture: DataTexture, render_target: WebGLRenderTarget): void;\n\tcreateTexture(): DataTexture;\n\tgetCurrentRenderTarget(variable: GPUComputationRendererVariable): WebGLRenderTarget;\n}\n\nexport class ParticlesSystemGpuComputeController {\n\tprotected _gpu_compute: GPUComputationRenderer | undefined;\n\tprotected _simulation_restart_required: boolean = false;\n\n\tprotected _renderer: WebGLRenderer | undefined;\n\t// private _particles_group: CoreGroup\n\n\tprotected _particles_core_group: CoreGroup | undefined;\n\tprotected _points: CorePoint[] = [];\n\n\tprivate variables_by_name: Map<ShaderName, GPUComputationRendererVariable> = new Map();\n\tprivate _created_textures_by_name: Map<ShaderName, DataTexture> = new Map();\n\tprivate _shaders_by_name: Map<ShaderName, string> | undefined;\n\tprotected _last_simulated_frame: number | undefined;\n\t// private _use_instancing: boolean = false\n\n\t// private _param_auto_textures_size: boolean;\n\t// private _param_max_textures_size: Vector2;\n\t// private _param_textures_sizes: Vector2;\n\tprivate _used_textures_size: Vector2 = new Vector2();\n\n\tconstructor(private node: ParticlesSystemGpuSopNode) {}\n\n\t// protected _create_gpu_compute_params() {\n\t// \tthis.self.within_param_folder('setup', () => {\n\t// \t\tthis.self.add_param(ParamType.INTEGER, 'start_frame', 1, {\n\t// \t\t\trange: [1, 100],\n\t// \t\t});\n\t// \t\tthis.self.add_param(ParamType.TOGGLE, 'auto_textures_size', 1);\n\t// \t\tthis.self.add_param(ParamType.VECTOR2, 'max_textures_size', [1024, 1024], {\n\t// \t\t\tvisible_if: {auto_textures_size: 1},\n\t// \t\t});\n\t// \t\tthis.self.add_param(ParamType.VECTOR2, 'textures_size', [64, 64], {\n\t// \t\t\tvisible_if: {auto_textures_size: 0},\n\t// \t\t});\n\t// \t\tthis.self.add_param(ParamType.BUTTON, 'reset', '', {\n\t// \t\t\tcallback: this._reset_gpu_compute_and_set_dirty.bind(this),\n\t// \t\t});\n\t// \t});\n\t// \t// this.self.add_param(ParamType.BUTTON, 'force_compute', '', {callback: this._force_compute.bind(this)})\n\t// }\n\n\tset_shaders_by_name(shaders_by_name: Map<ShaderName, string>) {\n\t\tthis._shaders_by_name = shaders_by_name;\n\t\tthis.reset_gpu_compute();\n\t}\n\tasync init(core_group: CoreGroup) {\n\t\tthis.init_particle_group_points(core_group);\n\t\tawait this.create_gpu_compute();\n\t}\n\n\tgetCurrentRenderTarget(shader_name: ShaderName) {\n\t\tconst variable = this.variables_by_name.get(shader_name);\n\t\tif (variable) {\n\t\t\treturn this._gpu_compute?.getCurrentRenderTarget(variable);\n\t\t}\n\t}\n\n\tinit_particle_group_points(core_group: CoreGroup) {\n\t\tthis.reset_gpu_compute();\n\n\t\tif (!core_group) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._particles_core_group = core_group;\n\t\t// this._particles_group_objects = []; //this._particles_core_group.objects()\n\n\t\t// in order to have proper copy on each children, I need to do .push for each\n\t\t// and not just my_array = group.children, as the array would then be empty\n\t\t// after have done .set_group(group)\n\t\t// I may need to rethink the whole\n\t\t// for (let child of this._particles_core_group.objects()) {\n\t\t// \tthis._particles_group_objects.push(child);\n\t\t// }\n\t\t// this._particles_core_group = new CoreGroup(this._particles_group)\n\t\tthis._points = this._get_points() || [];\n\t}\n\n\tcompute_similation() {\n\t\tconst frame = this.node.scene.frame;\n\t\tconst start_frame = this.node.pv.start_frame;\n\t\tif (frame >= start_frame) {\n\t\t\tif (this._last_simulated_frame == null) {\n\t\t\t\tthis._last_simulated_frame = start_frame - 1;\n\t\t\t}\n\t\t\tif (frame > this._last_simulated_frame) {\n\t\t\t\tthis._compute_simulation(frame - this._last_simulated_frame);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _compute_simulation(count = 1) {\n\t\tif (!this._gpu_compute) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.update_simulation_material_uniforms();\n\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tthis._gpu_compute.compute();\n\t\t}\n\t\tthis.node.render_controller.update_render_material_uniforms();\n\t\tthis._last_simulated_frame = this.node.scene.frame;\n\n\t\t// this._renderer.render(this._gpu_scene, this._gpu_camera)\n\t}\n\n\tasync create_gpu_compute() {\n\t\tif (this.node.pv.auto_textures_size) {\n\t\t\tconst nearest_power_of_two = CoreMath.nearestPower2(Math.sqrt(this._points.length));\n\t\t\tthis._used_textures_size.x = Math.min(nearest_power_of_two, this.node.pv.max_textures_size.x);\n\t\t\tthis._used_textures_size.y = Math.min(nearest_power_of_two, this.node.pv.max_textures_size.y);\n\t\t} else {\n\t\t\tif (\n\t\t\t\t!(_Math.isPowerOfTwo(this.node.pv.textures_size.x) && _Math.isPowerOfTwo(this.node.pv.textures_size.y))\n\t\t\t) {\n\t\t\t\tthis.node.states.error.set('texture size must be a power of 2');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst max_particles_count = this.node.pv.textures_size.x * this.node.pv.textures_size.y;\n\t\t\tif (this._points.length > max_particles_count) {\n\t\t\t\tthis.node.states.error.set(\n\t\t\t\t\t`max particles is set to (${this.node.pv.textures_size.x}x${this.node.pv.textures_size.y}=) ${max_particles_count}`\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._used_textures_size.copy(this.node.pv.textures_size);\n\t\t}\n\n\t\tthis.node.states.time_dependent.force_time_dependent();\n\t\tthis._init_particles_uvs();\n\t\t// we need to recreate the material if the texture allocation changes\n\t\tthis.node.render_controller.reset_render_material();\n\t\t// await this.node.render_controller.init_render_material();\n\n\t\tconst renderer = await POLY.renderers_controller.wait_for_renderer(); //new WebGLRenderer();\n\t\tif (renderer) {\n\t\t\tthis._renderer = renderer;\n\t\t} else {\n\t\t\tthis.node.states.error.set('no renderer found');\n\t\t}\n\t\t// console.log(this._renderer.extensions, this._renderer.capabilities)\n\t\t// if(!this._renderer.extensions.get( 'WEBGL_draw_buffers' )){\n\t\t// \tthis.self.set_error(\"this operator requires the browser extension WEBGL_draw_buffers\")\n\t\t// \talert(\"no extension found\")\n\t\t// \treturn\n\t\t// }\n\t\t// this._renderer = new WebGLRenderer();\n\t\t// this._gpu_scene = new Scene()\n\t\t// this._gpu_camera = new Camera()\n\t\t// this._renderer.setPixelRatio( window.devicePixelRatio );\n\t\t// this._renderer.setSize( this.node.pv.textures_size.x, this.node.pv.textures_size.y );\n\n\t\tconst compute = new GPUComputationRenderer(\n\t\t\tthis._used_textures_size.x,\n\t\t\tthis._used_textures_size.y,\n\t\t\tthis._renderer\n\t\t);\n\t\tthis._gpu_compute = (<unknown>compute) as GPUComputationRenderer;\n\n\t\tif (!this._gpu_compute) {\n\t\t\tthis.node.states.error.set('failed to create the GPUComputationRenderer');\n\t\t\treturn;\n\t\t}\n\n\t\tthis._last_simulated_frame = undefined;\n\n\t\t// document.body.style = ''\n\t\t// document.body.appendChild( renderer.domElement );\n\n\t\tthis.variables_by_name.forEach((variable, shader_name) => {\n\t\t\tvariable.renderTargets[0].dispose();\n\t\t\tvariable.renderTargets[1].dispose();\n\t\t\tthis.variables_by_name.delete(shader_name);\n\t\t});\n\t\t// for (let shader_name of Object.keys(this._shaders_by_name)) {\n\t\tconst all_variables: GPUComputationRendererVariable[] = [];\n\t\tthis._shaders_by_name?.forEach((string, shader_name) => {\n\t\t\tconst variable = this._gpu_compute?.addVariable(\n\t\t\t\t`texture_${shader_name}`,\n\t\t\t\tstring,\n\t\t\t\tthis._created_textures_by_name.get(shader_name)!\n\t\t\t);\n\t\t\tif (variable) {\n\t\t\t\tthis.variables_by_name.set(shader_name, variable);\n\t\t\t\tall_variables.push(variable);\n\t\t\t}\n\t\t});\n\n\t\t// this._gpu_compute.setVariableDependencies( this.var_v, [ this.var_P, this.var_v ] );\n\t\t// for (let shader_name of Object.keys(this._shaders_by_name)) {\n\t\tthis.variables_by_name?.forEach((variable, shader_name) => {\n\t\t\tthis._gpu_compute?.setVariableDependencies(\n\t\t\t\tvariable,\n\t\t\t\tall_variables // currently all depend on all\n\t\t\t);\n\t\t});\n\n\t\tthis._create_texture_render_targets();\n\t\tthis._fill_textures();\n\t\tthis.create_simulation_material_uniforms();\n\n\t\tvar error = this._gpu_compute.init();\n\n\t\tif (error !== null) {\n\t\t\tconsole.error(error);\n\t\t\tthis.node.states.error.set(error);\n\t\t}\n\t}\n\n\tprivate create_simulation_material_uniforms() {\n\t\tthis.variables_by_name.forEach((variable, shader_name) => {\n\t\t\tconst uniforms = variable.material.uniforms;\n\t\t\tuniforms['frame'] = {value: this.node.scene.frame};\n\n\t\t\tfor (let param_config of this.node.assembler_controller.assembler.param_configs()) {\n\t\t\t\tuniforms[param_config.uniform_name] = param_config.uniform;\n\t\t\t}\n\t\t});\n\t}\n\tprivate update_simulation_material_uniforms() {\n\t\tthis.variables_by_name.forEach((variable, shader_name) => {\n\t\t\tvariable.material.uniforms['frame'].value = this.node.scene.frame;\n\t\t});\n\t}\n\n\tprivate _init_particles_uvs() {\n\t\t// var uvs = new Float32Array( this.node.pv.textures_size.x * this.node.pv.textures_size.y * 2 );\n\t\tvar uvs = new Float32Array(this._points.length * 2);\n\t\t// const rows_count = Math.ceil(Math.min(\n\t\t// \tthis.node.pv.textures_size.y, (points.length / this.node.pv.textures_size.y)\n\t\t// ))\n\t\t// const columns_count = Math.ceil(Math.min(\n\t\t// \tthis.node.pv.textures_size.x, (points.length / rows_count)\n\t\t// ))\n\t\tlet p = 0;\n\t\tvar cmptr = 0;\n\t\tfor (var j = 0; j < this._used_textures_size.x; j++) {\n\t\t\tfor (var i = 0; i < this._used_textures_size.y; i++) {\n\t\t\t\tuvs[p++] = i / (this._used_textures_size.x - 1);\n\t\t\t\tuvs[p++] = j / (this._used_textures_size.y - 1);\n\n\t\t\t\tcmptr += 2;\n\t\t\t\tif (cmptr >= uvs.length) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst uv_attrib_name = GlobalsTextureHandler.UV_ATTRIB;\n\t\tif (this._particles_core_group) {\n\t\t\tfor (let core_geometry of this._particles_core_group.core_geometries()) {\n\t\t\t\t// geometry.setAttribute( 'position', new BufferAttribute( positions, 3 ) );\n\t\t\t\tconst geometry = core_geometry.geometry();\n\t\t\t\tconst attribute_constructor = core_geometry.marked_as_instance()\n\t\t\t\t\t? InstancedBufferAttribute\n\t\t\t\t\t: BufferAttribute;\n\t\t\t\tgeometry.setAttribute(uv_attrib_name, new attribute_constructor(uvs, 2));\n\t\t\t}\n\t\t}\n\t}\n\n\tcreated_textures_by_name() {\n\t\treturn this._created_textures_by_name;\n\t}\n\n\tprivate _fill_textures() {\n\t\tthis._created_textures_by_name.forEach((texture, shader_name) => {\n\t\t\tconst assembler = this.node.assembler_controller.assembler;\n\t\t\tconst texture_allocations_controller = assembler.texture_allocations_controller;\n\n\t\t\tconst texture_allocation = texture_allocations_controller.allocation_for_shader_name(shader_name);\n\t\t\tif (!texture_allocation) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst texture_variables = texture_allocation.variables;\n\t\t\tif (!texture_variables) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst array = texture.image.data;\n\n\t\t\tfor (let texture_variable of texture_variables) {\n\t\t\t\tconst texture_position = texture_variable.position;\n\t\t\t\tlet variable_name = texture_variable.name;\n\t\t\t\t// if(this._use_instancing){\n\t\t\t\t// \tvariable_name = GlobalsTextureHandler.variable_name_to_instance_attrib(variable_name)\n\t\t\t\t// }\n\n\t\t\t\tconst first_point = this._points[0];\n\t\t\t\tif (first_point) {\n\t\t\t\t\tconst has_attrib = first_point.has_attrib(variable_name);\n\t\t\t\t\tif (has_attrib) {\n\t\t\t\t\t\tconst attrib_size = first_point.attrib_size(variable_name);\n\t\t\t\t\t\tlet cmptr = texture_position;\n\t\t\t\t\t\tfor (let point of this._points) {\n\t\t\t\t\t\t\tif (attrib_size == 1) {\n\t\t\t\t\t\t\t\tconst val = point.attrib_value(variable_name);\n\t\t\t\t\t\t\t\tarray[cmptr] = val;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpoint.attrib_value(variable_name).toArray(array, cmptr);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcmptr += 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// var posArray = texture_P.image.data;\n\t\t// var velArray = texture_v.image.data;\n\n\t\t// let cmptr = 0\n\t\t// for(let point of points){\n\t\t// \tpoint.position().toArray(posArray, cmptr)\n\t\t// \tposArray[ cmptr + 3 ] = 1;\n\t\t// \tcmptr += 4\n\t\t// }\n\t}\n\n\treset_gpu_compute() {\n\t\tthis._gpu_compute = undefined;\n\t\tthis._simulation_restart_required = true;\n\t}\n\treset_gpu_compute_and_set_dirty() {\n\t\tthis.reset_gpu_compute();\n\t\tthis.node.set_dirty();\n\t}\n\treset_particle_groups() {\n\t\t// this._particles_group = null\n\t\t// this._particles_group_objects = [];\n\t\tthis._particles_core_group = undefined;\n\t}\n\tget initialized(): boolean {\n\t\treturn this._particles_core_group != null && this._gpu_compute != null;\n\t}\n\t// private _force_compute(){\n\t// \tthis.self.run_assembler()\n\t// }\n\n\tprivate _create_texture_render_targets() {\n\t\tthis._created_textures_by_name.forEach((texture, shader_name) => {\n\t\t\ttexture.dispose();\n\t\t});\n\n\t\tthis._created_textures_by_name.clear();\n\t\tthis.variables_by_name.forEach((texture_variable, shader_name) => {\n\t\t\tif (this._gpu_compute) {\n\t\t\t\tthis._created_textures_by_name.set(shader_name, this._gpu_compute.createTexture());\n\t\t\t}\n\t\t});\n\t}\n\tprotected _restart_simulation() {\n\t\tthis._last_simulated_frame = undefined;\n\n\t\tthis._create_texture_render_targets();\n\t\tconst points = this._get_points(); // TODO: typescript - not sure that's right\n\t\tif (!points) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._fill_textures();\n\n\t\t// for (let variable_name of Object.keys(this.variables_by_name)) {\n\t\tthis.variables_by_name.forEach((variable, shader_name) => {\n\t\t\tconst texture = this._created_textures_by_name.get(shader_name);\n\t\t\tif (this._gpu_compute && texture) {\n\t\t\t\tthis._gpu_compute.renderTexture(texture, variable.renderTargets[0]);\n\t\t\t\tthis._gpu_compute.renderTexture(texture, variable.renderTargets[1]);\n\t\t\t}\n\t\t});\n\t}\n\n\t// if we have a mix of marked_as_instance and non marked_as_instance\n\t// we take all geos that are the type that comes first\n\tprivate _get_points() {\n\t\tif (!this._particles_core_group) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet geometries = this._particles_core_group.core_geometries();\n\t\tconst first_geometry = geometries[0];\n\t\tif (first_geometry) {\n\t\t\tconst type = first_geometry.marked_as_instance();\n\t\t\t// this._use_instancing = type\n\t\t\tconst selected_geometries = [];\n\t\t\tfor (let geometry of geometries) {\n\t\t\t\tif (geometry.marked_as_instance() == type) {\n\t\t\t\t\tselected_geometries.push(geometry);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst points = [];\n\t\t\tfor (let geometry of selected_geometries) {\n\t\t\t\tfor (let point of geometry.points()) {\n\t\t\t\t\tpoints.push(point);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn points;\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n}\n","/**\n * @author yomboprime https://github.com/yomboprime\n *\n * GPUComputationRenderer, based on SimulationRenderer by zz85\n *\n * The GPUComputationRenderer uses the concept of variables. These variables are RGBA float textures that hold 4 floats\n * for each compute element (texel)\n *\n * Each variable has a fragment shader that defines the computation made to obtain the variable in question.\n * You can use as many variables you need, and make dependencies so you can use textures of other variables in the shader\n * (the sampler uniforms are added automatically) Most of the variables will need themselves as dependency.\n *\n * The renderer has actually two render targets per variable, to make ping-pong. Textures from the current frame are used\n * as inputs to render the textures of the next frame.\n *\n * The render targets of the variables can be used as input textures for your visualization shaders.\n *\n * Variable names should be valid identifiers and should not collide with THREE GLSL used identifiers.\n * a common approach could be to use 'texture' prefixing the variable name; i.e texturePosition, textureVelocity...\n *\n * The size of the computation (sizeX * sizeY) is defined as 'resolution' automatically in the shader. For example:\n * #DEFINE resolution vec2( 1024.0, 1024.0 )\n *\n * -------------\n *\n * Basic use:\n *\n * // Initialization...\n *\n * // Create computation renderer\n * var gpuCompute = new GPUComputationRenderer( 1024, 1024, renderer );\n *\n * // Create initial state float textures\n * var pos0 = gpuCompute.createTexture();\n * var vel0 = gpuCompute.createTexture();\n * // and fill in here the texture data...\n *\n * // Add texture variables\n * var velVar = gpuCompute.addVariable( \"textureVelocity\", fragmentShaderVel, pos0 );\n * var posVar = gpuCompute.addVariable( \"texturePosition\", fragmentShaderPos, vel0 );\n *\n * // Add variable dependencies\n * gpuCompute.setVariableDependencies( velVar, [ velVar, posVar ] );\n * gpuCompute.setVariableDependencies( posVar, [ velVar, posVar ] );\n *\n * // Add custom uniforms\n * velVar.material.uniforms.time = { value: 0.0 };\n *\n * // Check for completeness\n * var error = gpuCompute.init();\n * if ( error !== null ) {\n *\t\tconsole.error( error );\n  * }\n *\n *\n * // In each frame...\n *\n * // Compute!\n * gpuCompute.compute();\n *\n * // Update texture uniforms in your visualization materials with the gpu renderer output\n * myMaterial.uniforms.myTexture.value = gpuCompute.getCurrentRenderTarget( posVar ).texture;\n *\n * // Do your rendering\n * renderer.render( myScene, myCamera );\n *\n * -------------\n *\n * Also, you can use utility functions to create ShaderMaterial and perform computations (rendering between textures)\n * Note that the shaders can have multiple input textures.\n *\n * var myFilter1 = gpuCompute.createShaderMaterial( myFilterFragmentShader1, { theTexture: { value: null } } );\n * var myFilter2 = gpuCompute.createShaderMaterial( myFilterFragmentShader2, { theTexture: { value: null } } );\n *\n * var inputTexture = gpuCompute.createTexture();\n *\n * // Fill in here inputTexture...\n *\n * myFilter1.uniforms.theTexture.value = inputTexture;\n *\n * var myRenderTarget = gpuCompute.createRenderTarget();\n * myFilter2.uniforms.theTexture.value = myRenderTarget.texture;\n *\n * var outputRenderTarget = gpuCompute.createRenderTarget();\n *\n * // Now use the output texture where you want:\n * myMaterial.uniforms.map.value = outputRenderTarget.texture;\n *\n * // And compute each frame, before rendering to screen:\n * gpuCompute.doRenderTarget( myFilter1, myRenderTarget );\n * gpuCompute.doRenderTarget( myFilter2, outputRenderTarget );\n *\n *\n *\n * @param {int} sizeX Computation problem size is always 2d: sizeX * sizeY elements.\n * @param {int} sizeY Computation problem size is always 2d: sizeX * sizeY elements.\n * @param {WebGLRenderer} renderer The renderer\n*/\n\nimport {Camera} from 'three/src/cameras/Camera'\nimport {ClampToEdgeWrapping, FloatType, HalfFloatType, NearestFilter, RGBAFormat} from 'three/src/constants'\nimport {DataTexture} from 'three/src/textures/DataTexture'\nimport {Mesh} from 'three/src/objects/Mesh'\nimport {PlaneBufferGeometry} from 'three/src/geometries/PlaneGeometry'\nimport {Scene} from 'three/src/scenes/Scene'\nimport {ShaderMaterial} from 'three/src/materials/ShaderMaterial'\nimport {WebGLRenderTarget} from 'three/src/renderers/WebGLRenderTarget'\n// const THREE = {Camera, ClampToEdgeWrapping, FloatType, HalfFloatType, NearestFilter, RGBAFormat, DataTexture, mesh, PlaneBufferGeometry, Scene, ShaderMaterial, WebGLRenderTarget}\n\nvar GPUComputationRenderer = function ( sizeX, sizeY, renderer ) {\n\n\tthis.variables = [];\n\n\tthis.currentTextureIndex = 0;\n\n\tvar scene = new Scene();\n\n\tvar camera = new Camera();\n\tcamera.position.z = 1;\n\n\tvar passThruUniforms = {\n\t\tpassThruTexture: { value: null }\n\t};\n\n\tvar passThruShader = createShaderMaterial( getPassThroughFragmentShader(), passThruUniforms );\n\n\tvar mesh = new Mesh( new PlaneBufferGeometry( 2, 2 ), passThruShader );\n\tscene.add( mesh );\n\n\n\tthis.addVariable = function ( variableName, computeFragmentShader, initialValueTexture ) {\n\n\t\tvar material = this.createShaderMaterial( computeFragmentShader );\n\n\t\tvar variable = {\n\t\t\tname: variableName,\n\t\t\tinitialValueTexture: initialValueTexture,\n\t\t\tmaterial: material,\n\t\t\tdependencies: null,\n\t\t\trenderTargets: [],\n\t\t\twrapS: null,\n\t\t\twrapT: null,\n\t\t\tminFilter: NearestFilter,\n\t\t\tmagFilter: NearestFilter\n\t\t};\n\n\t\tthis.variables.push( variable );\n\n\t\treturn variable;\n\n\t};\n\n\tthis.setVariableDependencies = function ( variable, dependencies ) {\n\n\t\tvariable.dependencies = dependencies;\n\n\t};\n\n\tthis.init = function () {\n\n\t\tif ( ! renderer.capabilities.isWebGL2 &&\n\t\t\t ! renderer.extensions.get( \"OES_texture_float\" ) ) {\n\n\t\t\treturn \"No OES_texture_float support for float textures.\";\n\n\t\t}\n\n\t\tif ( renderer.capabilities.maxVertexTextures === 0 ) {\n\n\t\t\treturn \"No support for vertex shader textures.\";\n\n\t\t}\n\n\t\tfor ( var i = 0; i < this.variables.length; i ++ ) {\n\n\t\t\tvar variable = this.variables[ i ];\n\n\t\t\t// Creates rendertargets and initialize them with input texture\n\t\t\tvariable.renderTargets[ 0 ] = this.createRenderTarget( sizeX, sizeY, variable.wrapS, variable.wrapT, variable.minFilter, variable.magFilter );\n\t\t\tvariable.renderTargets[ 1 ] = this.createRenderTarget( sizeX, sizeY, variable.wrapS, variable.wrapT, variable.minFilter, variable.magFilter );\n\t\t\tthis.renderTexture( variable.initialValueTexture, variable.renderTargets[ 0 ] );\n\t\t\tthis.renderTexture( variable.initialValueTexture, variable.renderTargets[ 1 ] );\n\n\t\t\t// Adds dependencies uniforms to the ShaderMaterial\n\t\t\tvar material = variable.material;\n\t\t\tvar uniforms = material.uniforms;\n\t\t\tif ( variable.dependencies !== null ) {\n\n\t\t\t\tfor ( var d = 0; d < variable.dependencies.length; d ++ ) {\n\n\t\t\t\t\tvar depVar = variable.dependencies[ d ];\n\n\t\t\t\t\tif ( depVar.name !== variable.name ) {\n\n\t\t\t\t\t\t// Checks if variable exists\n\t\t\t\t\t\tvar found = false;\n\t\t\t\t\t\tfor ( var j = 0; j < this.variables.length; j ++ ) {\n\n\t\t\t\t\t\t\tif ( depVar.name === this.variables[ j ].name ) {\n\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( ! found ) {\n\n\t\t\t\t\t\t\treturn \"Variable dependency not found. Variable=\" + variable.name + \", dependency=\" + depVar.name;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tuniforms[ depVar.name ] = { value: null };\n\n\t\t\t\t\t// material.fragmentShader = \"\\nuniform sampler2D \" + depVar.name + \";\\n\" + material.fragmentShader;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.currentTextureIndex = 0;\n\n\t\treturn null;\n\n\t};\n\n\tthis.compute = function () {\n\n\t\tvar currentTextureIndex = this.currentTextureIndex;\n\t\tvar nextTextureIndex = this.currentTextureIndex === 0 ? 1 : 0;\n\n\t\tfor ( var i = 0, il = this.variables.length; i < il; i ++ ) {\n\n\t\t\tvar variable = this.variables[ i ];\n\n\t\t\t// Sets texture dependencies uniforms\n\t\t\tif ( variable.dependencies !== null ) {\n\n\t\t\t\tvar uniforms = variable.material.uniforms;\n\t\t\t\tfor ( var d = 0, dl = variable.dependencies.length; d < dl; d ++ ) {\n\n\t\t\t\t\tvar depVar = variable.dependencies[ d ];\n\n\t\t\t\t\tuniforms[ depVar.name ].value = depVar.renderTargets[ currentTextureIndex ].texture;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Performs the computation for this variable\n\t\t\tthis.doRenderTarget( variable.material, variable.renderTargets[ nextTextureIndex ] );\n\n\t\t}\n\n\t\tthis.currentTextureIndex = nextTextureIndex;\n\n\t};\n\n\tthis.getCurrentRenderTarget = function ( variable ) {\n\n\t\treturn variable.renderTargets[ this.currentTextureIndex ];\n\n\t};\n\n\tthis.getAlternateRenderTarget = function ( variable ) {\n\n\t\treturn variable.renderTargets[ this.currentTextureIndex === 0 ? 1 : 0 ];\n\n\t};\n\n\tfunction addResolutionDefine( materialShader ) {\n\n\t\tmaterialShader.defines.resolution = 'vec2( ' + sizeX.toFixed( 1 ) + ', ' + sizeY.toFixed( 1 ) + \" )\";\n\n\t}\n\tthis.addResolutionDefine = addResolutionDefine;\n\n\n\t// The following functions can be used to compute things manually\n\n\tfunction createShaderMaterial( computeFragmentShader, uniforms ) {\n\n\t\tuniforms = uniforms || {};\n\n\t\tvar material = new ShaderMaterial( {\n\t\t\tuniforms: uniforms,\n\t\t\tvertexShader: getPassThroughVertexShader(),\n\t\t\tfragmentShader: computeFragmentShader\n\t\t} );\n\n\t\taddResolutionDefine( material );\n\n\t\treturn material;\n\n\t}\n\n\tthis.createShaderMaterial = createShaderMaterial;\n\n\tthis.createRenderTarget = function ( sizeXTexture, sizeYTexture, wrapS, wrapT, minFilter, magFilter ) {\n\n\t\tsizeXTexture = sizeXTexture || sizeX;\n\t\tsizeYTexture = sizeYTexture || sizeY;\n\n\t\twrapS = wrapS || ClampToEdgeWrapping;\n\t\twrapT = wrapT || ClampToEdgeWrapping;\n\n\t\tminFilter = minFilter || NearestFilter;\n\t\tmagFilter = magFilter || NearestFilter;\n\n\t\tvar renderTarget = new WebGLRenderTarget( sizeXTexture, sizeYTexture, {\n\t\t\twrapS: wrapS,\n\t\t\twrapT: wrapT,\n\t\t\tminFilter: minFilter,\n\t\t\tmagFilter: magFilter,\n\t\t\tformat: RGBAFormat,\n\t\t\ttype: ( /(iPad|iPhone|iPod)/g.test( navigator.userAgent ) ) ? HalfFloatType : FloatType,\n\t\t\tstencilBuffer: false,\n\t\t\tdepthBuffer: false\n\t\t} );\n\n\t\treturn renderTarget;\n\n\t};\n\n\tthis.createTexture = function () {\n\n\t\tvar data = new Float32Array( sizeX * sizeY * 4 );\n\t\treturn new DataTexture( data, sizeX, sizeY, RGBAFormat, FloatType );\n\n\t};\n\n\tthis.renderTexture = function ( input, output ) {\n\n\t\t// Takes a texture, and render out in rendertarget\n\t\t// input = Texture\n\t\t// output = RenderTarget\n\n\t\tpassThruUniforms.passThruTexture.value = input;\n\n\t\tthis.doRenderTarget( passThruShader, output );\n\n\t\tpassThruUniforms.passThruTexture.value = null;\n\n\t};\n\n\tthis.doRenderTarget = function ( material, output ) {\n\n\t\tvar currentRenderTarget = renderer.getRenderTarget();\n\n\t\tmesh.material = material;\n\t\trenderer.setRenderTarget( output );\n\t\trenderer.render( scene, camera );\n\t\tmesh.material = passThruShader;\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t};\n\n\t// Shaders\n\n\tfunction getPassThroughVertexShader() {\n\n\t\treturn\t\"void main()\t{\\n\" +\n\t\t\t\t\"\\n\" +\n\t\t\t\t\"\tgl_Position = vec4( position, 1.0 );\\n\" +\n\t\t\t\t\"\\n\" +\n\t\t\t\t\"}\\n\";\n\n\t}\n\n\tfunction getPassThroughFragmentShader() {\n\n\t\treturn\t\"uniform sampler2D passThruTexture;\\n\" +\n\t\t\t\t\"\\n\" +\n\t\t\t\t\"void main() {\\n\" +\n\t\t\t\t\"\\n\" +\n\t\t\t\t\"\tvec2 uv = gl_FragCoord.xy / resolution.xy;\\n\" +\n\t\t\t\t\"\\n\" +\n\t\t\t\t\"\tgl_FragColor = texture2D( passThruTexture, uv );\\n\" +\n\t\t\t\t\"\\n\" +\n\t\t\t\t\"}\\n\";\n\n\t}\n\n};\n\nexport { GPUComputationRenderer };\n","import { render, staticRenderFns } from \"./Sop.vue?vue&type=template&id=030db833&lang=pug&\"\nimport script from \"./Sop.vue?vue&type=script&lang=ts&\"\nexport * from \"./Sop.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Sop.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('030db833')) {\n      api.createRecord('030db833', component.options)\n    } else {\n      api.reload('030db833', component.options)\n    }\n    module.hot.accept(\"./Sop.vue?vue&type=template&id=030db833&lang=pug&\", function () {\n      api.rerender('030db833', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/nodes/node_infos/Sop.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sop.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sop.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeInfoSop .bbox_infos table{margin-top:10px}.NetworkNodeInfoSop .bbox_infos table td{border:1px solid #000;text-align:center;padding:0px 5px}.NetworkNodeInfoSop .bbox_infos table td.number{white-space:nowrap}.NetworkNodeInfoSop .node_info_sop_section{white-space:nowrap}.NetworkNodeInfoSop .node_info_sop_section.inline .node_info_sop_section_title{display:inline-block;margin-right:5px}.NetworkNodeInfoSop .node_info_sop_section.inline .node_info_sop_section_content{display:inline-block}.NetworkNodeInfoSop .node_info_sop_section.object_names .node_info_sop_section_title{position:relative;top:0px}.NetworkNodeInfoSop .node_info_sop_section.object_names .node_info_sop_section_content{max-height:200px;overflow-y:scroll}.NetworkNodeInfoSop .objects_count_visible{margin-left:10px;opacity:.7}.NetworkNodeInfoSop .objects_count_visible.highlighted{opacity:1;font-weight:bold}.NetworkNodeInfoSop .attribute_info.string{color:#1779ba}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Mat.vue?vue&type=template&id=a4064c02&lang=pug&\"\nimport script from \"./Mat.vue?vue&type=script&lang=ts&\"\nexport * from \"./Mat.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Mat.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('a4064c02')) {\n      api.createRecord('a4064c02', component.options)\n    } else {\n      api.reload('a4064c02', component.options)\n    }\n    module.hot.accept(\"./Mat.vue?vue&type=template&id=a4064c02&lang=pug&\", function () {\n      api.rerender('a4064c02', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/nodes/node_infos/Mat.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mat.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Mat.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeInfoMat .button{margin-bottom:5px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Gl.vue?vue&type=template&id=4a5893d4&lang=pug&\"\nimport script from \"./Gl.vue?vue&type=script&lang=ts&\"\nexport * from \"./Gl.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Gl.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('4a5893d4')) {\n      api.createRecord('4a5893d4', component.options)\n    } else {\n      api.reload('4a5893d4', component.options)\n    }\n    module.hot.accept(\"./Gl.vue?vue&type=template&id=4a5893d4&lang=pug&\", function () {\n      api.rerender('4a5893d4', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/nodes/node_infos/Gl.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Gl.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Gl.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeInfoGl .button{margin-bottom:5px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Cop.vue?vue&type=template&id=96abf7ba&lang=pug&\"\nimport script from \"./Cop.vue?vue&type=script&lang=ts&\"\nexport * from \"./Cop.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Cop.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('96abf7ba')) {\n      api.createRecord('96abf7ba', component.options)\n    } else {\n      api.reload('96abf7ba', component.options)\n    }\n    module.hot.accept(\"./Cop.vue?vue&type=template&id=96abf7ba&lang=pug&\", function () {\n      api.rerender('96abf7ba', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/nodes/node_infos/Cop.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cop.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cop.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeInfoCop .bbox_infos table{margin-top:10px}.NetworkNodeInfoCop .bbox_infos table td{border:1px solid #000;text-align:center;padding:0px 5px}.NetworkNodeInfoCop .bbox_infos table td.number{white-space:nowrap}.NetworkNodeInfoCop .node_info_cop_section{white-space:nowrap}.NetworkNodeInfoCop .node_info_cop_section.inline .node_info_cop_section_title{display:inline-block;margin-right:5px}.NetworkNodeInfoCop .node_info_cop_section.inline .node_info_cop_section_content{display:inline-block}.NetworkNodeInfoCop canvas{max-width:512px;border:1px solid #d3d3d3}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./SopCache.vue?vue&type=template&id=2685343f&lang=pug&\"\nimport script from \"./SopCache.vue?vue&type=script&lang=ts&\"\nexport * from \"./SopCache.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SopCache.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('2685343f')) {\n      api.createRecord('2685343f', component.options)\n    } else {\n      api.reload('2685343f', component.options)\n    }\n    module.hot.accept(\"./SopCache.vue?vue&type=template&id=2685343f&lang=pug&\", function () {\n      api.rerender('2685343f', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/nodes/node_infos/SopCache.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopCache.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopCache.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeInfoMatShaderBuilder .button{margin-bottom:5px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./SopParticlesSystemGPU.vue?vue&type=template&id=38091b63&lang=pug&\"\nimport script from \"./SopParticlesSystemGPU.vue?vue&type=script&lang=ts&\"\nexport * from \"./SopParticlesSystemGPU.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SopParticlesSystemGPU.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('38091b63')) {\n      api.createRecord('38091b63', component.options)\n    } else {\n      api.reload('38091b63', component.options)\n    }\n    module.hot.accept(\"./SopParticlesSystemGPU.vue?vue&type=template&id=38091b63&lang=pug&\", function () {\n      api.rerender('38091b63', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/nodes/node_infos/SopParticlesSystemGPU.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopParticlesSystemGPU.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SopParticlesSystemGPU.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeInfoSopParticlesSystemGPU .button{margin-bottom:5px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeInfo.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeInfo.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeInfo{position:absolute;z-index:500;transform:translateY(-50%);margin-left:35px;background-color:#dad5e1;border:4px solid #716288}.NetworkNodeInfo .arrow-left{width:0;height:0;border-top:10px solid transparent;border-bottom:10px solid transparent;border-right:10px solid #716288;position:absolute;top:50%;transform:translate(-100%, -50%)}.NetworkNodeInfo .node_title_container{background-color:#716288;color:#fff;text-align:center;cursor:pointer}.NetworkNodeInfo .node_info_container{padding:20px}.NetworkNodeInfo .node_info_container .icon_prefixed svg{margin-right:10px;position:relative;top:3px}.NetworkNodeInfo .node_info_container .time_dependency{white-space:nowrap}.NetworkNodeInfo .node_info_container .time_dependency.time_dependent{color:#177e3e}.NetworkNodeInfo .node_info_container .error_message{color:#cc4b37}.NetworkNodeInfo .node_info_container .node_info_separator{margin:10px 0px;height:1px;background-color:#a59ab6}.NetworkNodeInfo .node_info_container .dependencies .dependencies_section{margin-top:10px}.NetworkNodeInfo .node_info_container .dependencies .dependencies_section .dependencies_section_title{font-weight:bold}.NetworkNodeInfo .node_info_container .dependencies .dependencies_section .dependencies_list .dependendies_item{cursor:pointer}.NetworkNodeInfo .node_info_container .dependencies .dependencies_section .dependencies_list .dependendies_item:hover{background-color:#cdc6d6}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Node.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Node.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNode{position:absolute;width:0px;height:0px}.NetworkNode.selected .node-body{border:3px solid #54ff00 !important}.NetworkNode.is_being_moved .node-body{box-shadow:4px 4px 8px #8b7ca1}.NetworkNode.bypassed .node-body{background-color:#a59ab6;border:3px solid #988bab}.NetworkNode.bypassed .node-body .icon-container{opacity:.2}.NetworkNode.bypassed .name-container,.NetworkNode.bypassed .comment-container{opacity:.4}.NetworkNode.layout_horizontal .name-container{transform:translateY(-100%)}.NetworkNode.layout_horizontal .name-container .name-element{margin:0}.NetworkNode.layout_horizontal .inputs-container{position:absolute}.NetworkNode.layout_horizontal .inputs-container .output-pixel{left:100%}.NetworkNode.layout_horizontal .outputs-container{position:absolute}.NetworkNode.layout_horizontal .outputs-container .output-pixel{top:10px;left:100%}.NetworkNode .node-body{position:absolute;background-color:#dad5e1;border-radius:3px;cursor:move;z-index:8}.NetworkNode .node-body:hover{border:1px solid #584d6a}.NetworkNode .node-body .icon-container{opacity:.5;margin:auto;text-align:center;height:100%}.NetworkNode .node-body .icon-container svg{position:relative;top:50%;transform:translateY(-50%)}.NetworkNode .error-flag-container{position:absolute;pointer-events:none}.NetworkNode .error-flag-container .error-flag{position:absolute;left:-80px;margin-right:20px;color:#cc4b37}.NetworkNode .flag-container{position:absolute;z-index:9}.NetworkNode .flag-container .node-flag{position:absolute;width:10px;cursor:pointer}.NetworkNode .flag-container .node-flag.bypass-flag{left:0px}.NetworkNode .flag-container .node-flag.bypass-flag.on{background-color:#ff0}.NetworkNode .flag-container .node-flag.bypass-flag.off{background-color:#fff}.NetworkNode .flag-container .node-flag.display-flag{right:0px}.NetworkNode .flag-container .node-flag.display-flag.on{background-color:#1779ba}.NetworkNode .flag-container .node-flag.display-flag.off{background-color:#fff}.NetworkNode .name-container{position:absolute;transform:translateY(-50%);z-index:5}.NetworkNode .name-container .name-element{margin-left:10px;cursor:text}.NetworkNode .comment-container{position:absolute;width:200px;z-index:4}.NetworkNode .comment-container .comment-element{font-size:.8rem;margin-left:10px;margin-top:-10px;padding:5px;background-color:#add8e6;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.NetworkNode .enter-button-container{position:absolute;transform:translateY(-50%);z-index:6}.NetworkNode .enter-button-container .enter-button{margin-right:10px;padding:5px;border-radius:25px;width:25px;height:25px;text-align:center;background-color:#90ee90;cursor:pointer;line-height:0}.NetworkNode .enter-button-container .enter-button:hover{background-color:#64e764}.NetworkNode .enter-button-container .enter-button svg{display:inline-block;margin:auto;position:relative}.NetworkNode .connection-pixel{position:absolute}.NetworkNode .connection-pixel.bool .connection-name-element{background-color:#e06be4}.NetworkNode .connection-pixel.bool .connection-element{background-color:#e600e6 !important}.NetworkNode .connection-pixel.int .connection-name-element{background-color:#e7abaa}.NetworkNode .connection-pixel.int .connection-element{background-color:#f38073 !important}.NetworkNode .connection-pixel.float .connection-name-element{background-color:#e1ddb4}.NetworkNode .connection-pixel.float .connection-element{background-color:#ff0 !important}.NetworkNode .connection-pixel.vec2 .connection-name-element{background-color:#aec7b4}.NetworkNode .connection-pixel.vec2 .connection-element{background-color:#008f00 !important}.NetworkNode .connection-pixel.vec3 .connection-name-element{background-color:#ccf}.NetworkNode .connection-pixel.vec3 .connection-element{background-color:#66f !important}.NetworkNode .connection-pixel.vec4 .connection-name-element{background-color:#cdc9b4}.NetworkNode .connection-pixel.vec4 .connection-element{background-color:#990 !important}.NetworkNode .connection-pixel.mat3 .connection-name-element{background-color:#bab7f0}.NetworkNode .connection-pixel.mat3 .connection-element{background-color:#99f !important}.NetworkNode .connection-pixel.color .connection-name-element{background-color:#ed6b71}.NetworkNode .connection-pixel.color .connection-element{background-color:red !important}.NetworkNode .connection-pixel:hover{z-index:999}.NetworkNode .connection-pixel:hover .connection-name-element.non_named_element{display:block}.NetworkNode .connection-pixel .connection-name-element{position:absolute;pointer-events:none;background-color:#dad5e1;line-height:1;padding:2px 4px;border-radius:2px;border:1px solid #a59ab6}.NetworkNode .connection-pixel .connection-name-element.named_element{z-index:19;font-size:.5rem}.NetworkNode .connection-pixel .connection-name-element.non_named_element{z-index:21;font-size:.8rem;padding:5px 10px;display:none;top:-20px;left:0px;transform:translate(-50%, -100%)}.NetworkNode .connection-pixel .connection-element{width:12px;height:12px;border-radius:100px;transform:translate(-50%, -50%);position:relative;z-index:20;cursor:pointer}.NetworkNode .connection-pixel .connection-element:hover{width:16px;height:16px}.NetworkNode .inputs-container{position:absolute}.NetworkNode .inputs-container .input-pixel{top:0;width:0;height:0}.NetworkNode .inputs-container .input-pixel .connection-name-element.named_element{padding-left:10px;transform:translate(0%, -50%)}.NetworkNode .inputs-container .input-pixel .connection-element{border:1px solid #010304;background-color:#1779ba}.NetworkNode .outputs-container{position:absolute}.NetworkNode .outputs-container .output-pixel{bottom:0;width:0;height:0;left:50%}.NetworkNode .outputs-container .output-pixel .connection-name-element.named_element{padding-right:10px;transform:translate(-100%, -50%)}.NetworkNode .outputs-container .output-pixel .connection-element{border:1px solid #0b3e1e;background-color:#3adb76}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./InterractiveConnection.vue?vue&type=template&id=f3a8d13c&lang=pug&\"\nimport script from \"./InterractiveConnection.vue?vue&type=script&lang=ts&\"\nexport * from \"./InterractiveConnection.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./InterractiveConnection.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('f3a8d13c')) {\n      api.createRecord('f3a8d13c', component.options)\n    } else {\n      api.reload('f3a8d13c', component.options)\n    }\n    module.hot.accept(\"./InterractiveConnection.vue?vue&type=template&id=f3a8d13c&lang=pug&\", function () {\n      api.rerender('f3a8d13c', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/network/components/InterractiveConnection.vue\"\nexport default component.exports","import mod from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterractiveConnection.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InterractiveConnection.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NetworkNodeInterractiveConnection{position:absolute;width:0;height:0}.NetworkNodeInterractiveConnection svg{position:absolute;pointer-events:none}.NetworkNodeInterractiveConnection svg line{stroke:#3adb76;stroke-width:4}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import {Vector2} from 'three/src/math/Vector2';\nimport {EventHelper} from 'src/core/EventHelper';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {Constants} from './Constants';\n\nimport {CameraData} from './CameraAnimation';\nimport {NodeCreateCommand} from 'src/editor/history/commands/NodeCreate';\n\nexport interface NodeCreationData {\n\tactive: boolean;\n\tposition: Vector2Like;\n}\n\n// TODO: allow pressing esc to cancel\nexport class NodeCreationHelper {\n\tprivate parent_node: BaseNodeType | undefined;\n\tprivate _node_type: string | undefined;\n\t// private position: Vector2\n\tprivate move_progress_position: Vector2 = new Vector2();\n\tprivate create_position: Vector2 = new Vector2();\n\tprivate event_helper: EventHelper = new EventHelper(document.body);\n\n\tconstructor(private data: NodeCreationData, private camera_data: CameraData) {\n\t\t//\n\t}\n\tset_element(element: HTMLElement) {\n\t\tthis.event_helper.set_element(element);\n\t}\n\n\tset_parent_node(parent_node: BaseNodeType) {\n\t\tthis.parent_node = parent_node;\n\t\tthis._node_type = undefined;\n\t}\n\n\tget active() {\n\t\treturn this.data.active;\n\t}\n\tget position() {\n\t\treturn this.data.position;\n\t}\n\tactivate(node_type: string) {\n\t\tthis._node_type = node_type;\n\t\tthis.data.active = true;\n\t}\n\tdeactivate() {\n\t\t//return this._mesh.visible = false;\n\t\tthis.data.active = false;\n\t}\n\tactivated(): boolean {\n\t\treturn this.data.active;\n\t}\n\n\tmove_progress(event: MouseEvent) {\n\t\t//return if !this.activated() # we don't check if it's activated here\n\t\t// as otherwise the position will not be set if the user just closes the tab menu\n\t\t// without moving the mouse\n\n\t\tthis.event_helper.element_position(event, this.move_progress_position);\n\t\tthis.move_progress_position.divideScalar(this.camera_data.zoom);\n\t\tthis.data.position.x = this.move_progress_position.x - 0.5 * Constants.NODE_UNIT;\n\t\tthis.data.position.y = this.move_progress_position.y - 0.5 * Constants.NODE_UNIT;\n\t\t// return this._update_transform();\n\t}\n\n\t// _update_transform() {\n\t// \t// this._mesh.position.x = this.move_end_position.x;\n\t// \t// return this._mesh.position.y = this.move_end_position.y;\n\t// }\n\n\tcreate(event: MouseEvent) {\n\t\tif (!this.activated()) {\n\t\t\treturn;\n\t\t}\n\n\t\t// const cam_pos = this.camera_data.position\n\t\t// const pos = {\n\t\t// \tx: this.data.position.x/this.camera_data.zoom - cam_pos.x,\n\t\t// \ty: this.data.position.y/this.camera_data.zoom - cam_pos.y,\n\t\t// }\n\t\tthis.event_helper.element_position(event, this.create_position);\n\t\tthis.create_position.divideScalar(this.camera_data.zoom);\n\t\tconst precision = 1 * Constants.NODE_HEIGHT;\n\t\tthis.create_position.x = precision * Math.round(this.create_position.x / precision);\n\t\tthis.create_position.y = precision * Math.round(this.create_position.y / precision);\n\n\t\tif (this.parent_node && this._node_type) {\n\t\t\tconst command = new NodeCreateCommand(this.parent_node, this._node_type, this.create_position.clone());\n\t\t\tcommand.push();\n\t\t}\n\n\t\tthis.deactivate();\n\t}\n\n\t// _create_rectangle(index: number) {\n\t// \tthis._update_position();\n\t// }\n\n\t// _update_position() {\n\t// \tconst size = 0.5;\n\t// \tconst min = {x: -size, y: -size};\n\t// \tconst max = {x: +size, y: +size};\n\t// \tconst z = 1;\n\t// \tconst positions = [min.x, min.y, z, min.x, max.y, z, max.x, max.y, z, max.x, min.y, z];\n\t// \t// const position_attribute = this._geometry.getAttribute('position');\n\t// \t// const { array } = position_attribute;\n\t// \t// lodash_each(positions, (pos, i)=> array[i] = pos);\n\t// \t// return position_attribute.needsUpdate = true;\n\t// }\n}\n","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {Vector2} from 'three/src/math/Vector2';\n\nexport class NodeCreateCommand extends BaseCommand {\n\tprivate _node: BaseNodeType | undefined;\n\n\tconstructor(private _parent: BaseNodeType, private _node_type: string, private _node_pos: Vector2) {\n\t\tsuper();\n\t}\n\n\tdo() {\n\t\tthis._node = this._parent.create_node(this._node_type);\n\t\tif (this._node) {\n\t\t\tthis._node.ui_data.set_position(this._node_pos);\n\t\t}\n\t}\n\n\tundo() {\n\t\tif (this._node) {\n\t\t\tthis._parent.remove_node(this._node);\n\t\t}\n\t}\n}\n","import {Vector2} from 'three/src/math/Vector2';\nimport {Box2} from 'three/src/math/Box2';\nimport {CoreMath} from 'src/core/math/_Module';\nimport {EventHelper} from 'src/core/EventHelper';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nconst ZOOM_PROJ_VECTOR = new Vector2(1, 1);\n\nexport interface CameraData {\n\tposition: {x: number; y: number};\n\tzoom: number;\n}\n\nexport class CameraAnimationHelper {\n\t// public camera_position: Vector2 = new Vector2(50,50)\n\t// private properties_by_current_node: object = {}\n\t// private _parent_node: BaseNode\n\n\tprivate event_helper: EventHelper = new EventHelper(document.body);\n\n\tprivate pan_start_mouse_position: Vector2 = new Vector2();\n\tprivate pan_start_camera_position: Vector2 = new Vector2();\n\tprivate mouse_position: Vector2 = new Vector2();\n\tprivate pan_progress_position: Vector2 = new Vector2();\n\tprivate _pan_in_progress: boolean = false;\n\n\tprivate zoom_start_mouse_position: Vector2 = new Vector2();\n\tprivate zoom_current_mouse_position: Vector2 = new Vector2();\n\tprivate _zoom_offset: Vector2 = new Vector2();\n\tprivate _zoom_in_progress: boolean = false;\n\n\tprivate min_zoom: number = 0.1;\n\tprivate max_zoom: number = 2;\n\t// private _zoom_offset: number\n\n\tprivate parent_node: BaseNodeType | undefined;\n\n\tconstructor(private data: CameraData) {}\n\n\tset_element(element: HTMLElement) {\n\t\tthis.event_helper.set_element(element);\n\t}\n\tset_parent_node(node: BaseNodeType) {\n\t\tthis.parent_node = node;\n\t}\n\tposition(): Vector2 {\n\t\treturn new Vector2(this.data.position.x, this.data.position.y);\n\t}\n\t// camera_position(){\n\t// \treturn this._camera_position\n\t// }\n\n\t// set_parent_node(parent_node: BaseNode){\n\t// \t//if (previous_parent_node = @_parent_node)?\n\t// \t\t//@data_by_parent_node_id[previous_parent_node.graph_node_id()] =\n\t// \t\t//\tposition: @camera.position.clone()\n\t// \t\t//\tzoom: @camera.zoom\n\n\t// \t// const previous_parent_node = this._parent_node;\n\t// \tthis._parent_node = parent_node;\n\t// \t// if ((this._parent_node != null) && (this._parent_node !== previous_parent_node)) {\n\t// \t\t// this._update_camera_from_json();\n\t// \t// }\n\t// }\n\t//if (data = @data_by_parent_node_id[@_parent_node.graph_node_id()])?\n\t//\t@camera.position.copy(data['position'])\n\t//\t@camera.zoom = data['zoom']\n\t//\t@camera.updateProjectionMatrix()\n\n\tmove_in_progress(): boolean {\n\t\treturn this.is_pan_in_progress() || this.is_zoom_in_progress();\n\t}\n\n\t//\n\t//\n\t// NAVIGATION\n\t//\n\t//\n\n\treset() {\n\t\t// this.camera.position.x = 0;\n\t\t// this.camera.position.y = 0;\n\t}\n\n\t//\n\t// PAN\n\t//\n\tpan_start(event: MouseEvent) {\n\t\tthis.event_helper.element_position(event, this.pan_start_mouse_position);\n\t\tthis.pan_start_camera_position.x = this.data.position.x;\n\t\tthis.pan_start_camera_position.y = this.data.position.y;\n\t\tthis._pan_in_progress = true;\n\t\t// this.pan_camera = this.camera.clone();\n\t\t// this.pan_start_position = this.ray_helper.intersect_plane_from_event(event, this.pan_camera);\n\t\t// this.pan_start_camera_position = this.camera.position.clone();\n\t}\n\n\tpan_progress(event: MouseEvent) {\n\t\tif (!this.is_pan_in_progress()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.event_helper.element_position(event, this.mouse_position);\n\t\tconst pan_mouse_offset = this.mouse_position /*.clone()*/\n\t\t\t.sub(this.pan_start_mouse_position)\n\t\t\t.divideScalar(this.data.zoom);\n\n\t\tthis.pan_progress_position.copy(this.pan_start_camera_position).add(pan_mouse_offset);\n\t\tthis.data.position.x = this.pan_progress_position.x;\n\t\tthis.data.position.y = this.pan_progress_position.y;\n\t\t// const pan_prev_position = (this.pan_current_position || this.pan_start_position).clone();\n\t\t// this.pan_current_position = this.ray_helper.intersect_plane_from_event(event, this.pan_camera);\n\n\t\t// const pan_offset = this.pan_start_position.clone().sub(this.pan_current_position);\n\t\t// const new_pos = this.pan_start_camera_position.clone().add(pan_offset);\n\n\t\t// this.camera.position.x = new_pos.x;\n\t\t// this.camera.position.y = new_pos.y;\n\t\t// this.camera.updateProjectionMatrix();\n\t\treturn true;\n\t}\n\n\tpan_end(/*event: MouseEvent*/) {\n\t\t// const pan_was_in_progress = this.is_pan_in_progress();\n\t\tthis._pan_in_progress = false;\n\t\t// this.pan_camera = null;\n\t\t// this.pan_current_position = null;\n\n\t\t// this._update_json();\n\n\t\t// return pan_was_in_progress;\n\t}\n\n\tis_pan_in_progress(): boolean {\n\t\treturn this._pan_in_progress;\n\t}\n\n\t//\n\t// ZOOM\n\t//\n\tzoom_start(event: MouseEvent) {\n\t\tthis.event_helper.element_position(event, this.zoom_start_mouse_position);\n\t\tthis._zoom_in_progress = true;\n\t\t// this.zoom_camera = this.camera.clone();\n\t\t// this.zoom_start_position = this.ray_helper.intersect_plane_from_event(event, this.zoom_camera);\n\t\t// this.zoom_start_camera_position = this.camera.position.clone();\n\t\t// return this.zoom_start_camera_zoom = this.camera.zoom;\n\t}\n\n\tzoom_progress(event: MouseEvent) {\n\t\tif (!this.is_zoom_in_progress()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.event_helper.element_position(event, this.zoom_current_mouse_position);\n\n\t\t// // const zoom_prev_position = (this.zoom_current_position || this.zoom_start_position).clone();\n\t\t// this.zoom_current_position = this.ray_helper.intersect_plane_from_event(event, this.zoom_camera);\n\n\t\tthis._zoom_offset.copy(this.zoom_start_mouse_position);\n\t\tthis._zoom_offset.sub(this.zoom_current_mouse_position);\n\n\t\tconst dot = this._zoom_offset.dot(ZOOM_PROJ_VECTOR);\n\t\tconst new_zoom = this.data.zoom - 0.001 * dot;\n\n\t\tthis.set_zoom(new_zoom);\n\t\tthis.zoom_start_mouse_position.copy(this.zoom_current_mouse_position);\n\t\t// return true;\n\t}\n\n\tzoom_end(/*event: MouseEvent*/) {\n\t\t// const zoom_was_in_progress = this.is_zoom_in_progress();\n\t\t// this.zoom_start_position = null;\n\t\t// this.zoom_camera = null;\n\t\t// this.zoom_current_position = null;\n\t\t// this._zoom_offset = null;\n\t\t// this.zoom_start_mouse_position = null\n\t\tthis._zoom_in_progress = false;\n\t\t// return zoom_was_in_progress;\n\t}\n\n\tis_zoom_in_progress(): boolean {\n\t\t//@zoom_camera?\n\t\treturn this._zoom_in_progress;\n\t\t// return (this._zoom_offset != null) && (this._zoom_offset.length() > 0.01);\n\t}\n\n\tzoom(wheel_event: WheelEvent) {\n\t\tconst direction_in = wheel_event.deltaY < 0;\n\t\tconst current_zoom = this.data.zoom;\n\n\t\tlet mult = 0.9;\n\t\tif (direction_in) {\n\t\t\tmult = 1 / mult;\n\t\t}\n\n\t\tconst new_zoom = current_zoom * mult;\n\t\tthis.set_zoom(new_zoom);\n\t}\n\tset_zoom(new_zoom: number) {\n\t\tnew_zoom = CoreMath.clamp(new_zoom, this.min_zoom, this.max_zoom);\n\n\t\tthis.data.zoom = new_zoom;\n\n\t\t// this._update_json();\n\t}\n\n\tframe_selection() {\n\t\tif (!this.parent_node) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.parent_node.children_allowed() || !this.parent_node.children_controller) {\n\t\t\treturn;\n\t\t}\n\t\tconst selected_nodes = this.parent_node.children_controller.selection.nodes();\n\t\tconst nodes = selected_nodes.length > 0 ? selected_nodes : this.parent_node.children();\n\n\t\tconst box = new Box2();\n\t\tnodes.forEach((node) => {\n\t\t\tbox.expandByPoint(node.ui_data.position);\n\t\t});\n\t\tconst center = new Vector2();\n\t\tbox.getCenter(center);\n\n\t\tthis.data.position.x = -center.x;\n\t\tthis.data.position.y = -center.y;\n\t}\n}\n","import {Vector2} from 'three/src/math/Vector2';\nimport lodash_max from 'lodash/max';\nimport lodash_map from 'lodash/map';\nimport lodash_min from 'lodash/min';\n// import lodash_includes from 'lodash/includes';\n// import lodash_filter from 'lodash/filter';\n\n// import History from 'src/Editor/History/_Module';\nimport {NodesCodeExporter} from 'src/engine/io/code/export/Nodes';\nimport {CameraAnimationHelper} from './CameraAnimation';\nimport {Constants} from './Constants';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {NodeEvent} from 'src/engine/poly/NodeEvent';\n\nexport class ClipBoardHelper {\n\t_nodes_by_parent_node_type: Dictionary<BaseNodeType> = {};\n\n\tconstructor() {}\n\n\t// caches.open('clipboard').then (cache) =>\n\t// \t@_cache = cache\n\n\tcopy_from_node(parent_node: BaseNodeType, child_nodes: BaseNodeType[]) {\n\t\t//return if !@_cache?\n\t\t//@_nodes_by_parent_node_type[parent_node.type()] = child_nodes\n\n\t\tconst code = this.create_code_for_nodes(parent_node, child_nodes);\n\t\tif (code && parent_node.children_controller) {\n\t\t\tthis.write_cache(parent_node.children_controller.context, code);\n\t\t}\n\t}\n\n\tpaste_in_node(parent_node: BaseNodeType, cam_animation_helper: CameraAnimationHelper) {\n\t\t//return if !@_cache?\n\n\t\tparent_node.scene.lifecycle_controller.on_create_prevent(() => {\n\t\t\tif (parent_node.children_controller) {\n\t\t\t\tconst code = this.read_cache(parent_node.children_controller.context);\n\t\t\t\tif (code) {\n\t\t\t\t\tconst current_node_ids: string[] = parent_node.children().map((c) => c.graph_node_id);\n\n\t\t\t\t\tparent_node.scene.cooker.block();\n\n\t\t\t\t\t//code = lodash_flatten(code_lines).join(\";\\n\")\n\t\t\t\t\tconst code_wrapped_timestamp = Math.floor(performance.now() * 10000);\n\t\t\t\t\tconst code_wrapped_function_name = `paste_clipboard_${code_wrapped_timestamp}`;\n\t\t\t\t\tconst code_wrapped = `const ${code_wrapped_function_name} = function(parent){ const context={}; ${code}}; ${code_wrapped_function_name}(parent_node.scene.node('${parent_node.full_path()}'))`;\n\t\t\t\t\t// console.log(code_wrapped)\n\t\t\t\t\teval(code_wrapped);\n\n\t\t\t\t\tparent_node.scene.cooker.unblock();\n\n\t\t\t\t\t// select the newly created nodes\n\t\t\t\t\tconst new_node_ids = parent_node\n\t\t\t\t\t\t.children()\n\t\t\t\t\t\t.map((c) => c.graph_node_id)\n\t\t\t\t\t\t.filter((id) => {\n\t\t\t\t\t\t\treturn !current_node_ids.includes(id);\n\t\t\t\t\t\t});\n\t\t\t\t\tconst new_nodes = new_node_ids.map((id) =>\n\t\t\t\t\t\tparent_node.scene.graph.node_from_id(id)\n\t\t\t\t\t) as BaseNodeType[];\n\n\t\t\t\t\tconst camera_position = cam_animation_helper.position();\n\t\t\t\t\tthis.offset_nodes(new_nodes, camera_position.multiplyScalar(-1));\n\t\t\t\t\tnew_nodes.forEach((node) => {\n\t\t\t\t\t\tnode.emit(NodeEvent.PARAMS_UPDATED);\n\t\t\t\t\t});\n\n\t\t\t\t\t// console.log('new_nodes', new_nodes, new_nodes.length);\n\t\t\t\t\tparent_node.children_controller.selection.set(new_nodes);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\toffset_nodes(nodes: BaseNodeType[], camera_position: Vector2) {\n\t\tconst positions = nodes.map((node) => node.ui_data.position);\n\t\tconst min = new Vector2(lodash_min(lodash_map(positions, 'x')), lodash_min(lodash_map(positions, 'y')));\n\t\tconst max = new Vector2(lodash_max(lodash_map(positions, 'x')), lodash_max(lodash_map(positions, 'y')));\n\t\tconst center = min.add(max).multiplyScalar(0.5);\n\t\tconst offset = camera_position.sub(center);\n\n\t\tconst precision = 1 * Constants.NODE_UNIT;\n\t\toffset.x = precision * Math.round(offset.x / precision);\n\t\toffset.y = precision * Math.round(offset.y / precision);\n\n\t\tnodes.forEach((node) => {\n\t\t\tnode.ui_data.translate(offset, true);\n\t\t});\n\t}\n\t//this.$store.scene.set_auto_update(true)\n\n\t// child_nodes = @_nodes[parent_node.type()]\n\n\t// command = new History.Command.Multiple()\n\t// move_offset = new Vector2(2, 0)\n\n\t// lodash_each child_nodes, (child_node)=>\n\t// \tcloned_child_node = child_node.clone()\n\t// \tcommand.push_command( new History.Command.NodeAdd(parent_node, cloned_child_node) )\n\n\t// \tcommand.push_command( new History.Command.NodeMove([cloned_child_node], move_offset) )\n\n\t// \t# TODO: only connect if the input is under the same parent?\n\t// \t# or also just connect to one that has the same name?\n\t// \tlodash_each child_node.inputs(), (input, index)=>\n\t// \t\tcommand.push_command( new History.Command.NodeConnect(input, cloned_child_node, index) )\n\n\t// command.push()\n\n\tprivate create_code_for_nodes(parent_node: BaseNodeType, nodes: BaseNodeType[]): string | undefined {\n\t\tconst positions = lodash_map(nodes, (node) => node.ui_data.position);\n\t\tconst positions_xs = lodash_map(positions, 'x');\n\t\tconst min_x = lodash_min(positions_xs);\n\t\tconst max_x = lodash_max(positions_xs);\n\t\tif (max_x != null && min_x != null) {\n\t\t\tconst position_x_offset = max_x - min_x + 2;\n\n\t\t\tconst parent_var_name = 'parent_node';\n\t\t\tconst exporter = new NodesCodeExporter(nodes);\n\t\t\tconst lines: string[] = exporter.process_with_existing_nodes(\n\t\t\t\tparent_node,\n\t\t\t\tparent_var_name,\n\t\t\t\tposition_x_offset\n\t\t\t);\n\t\t\treturn lines.join('\\n');\n\t\t}\n\t}\n\t//code_lines = []\n\t//code_lines.push( parent_node.as_code_declare() )\n\t//lodash_each nodes, (node)->\n\t//\tcode_lines.push( node.as_code_create(parent_var_name) )\n\t//lodash_each nodes, (node)->\n\t//\tcode_lines.push( node.as_code_set_up({position_x_offset: position_x_offset}) )\n\n\t// code_lines = lodash_flatten(code_lines)\n\t// code_lines = lodash_map code_lines, (code_line, i)->\n\t// \t[\n\t// \t\t\"console.log('#{i}')\"\n\t// \t\tcode_line\n\t// \t]\n\t// TODO: set display flag\n\t//code_lines.push( parent_node.as_code_set_up_custom() )\n\n\t//code = lodash_flatten(code_lines).join(\";\\n\")\n\n\tprivate write_cache(cache_name: string, text: string) {\n\t\t//return if !@_cache?\n\t\t//@_nodes_by_parent_node_type[parent_node.type()] = child_nodes\n\t\t//@_cache.put( cache_name, new Response(text) )\n\t\tlocalStorage.setItem(cache_name, text);\n\t}\n\n\tprivate read_cache(cache_name: string): string | null {\n\t\t// @_cache.match(cache_name).then (response) =>\n\t\t// \tif response?\n\t\t// \t\tresponse.text().then (text)=>\n\t\t// \t\t\tcallback(text)\n\t\t// \telse\n\t\tconst code = localStorage.getItem(cache_name);\n\t\tif (code == null) {\n\t\t\tconsole.warn(`no cache available at ${cache_name}`);\n\t\t}\n\t\treturn code;\n\t}\n}\n","import lodash_compact from 'lodash/compact';\nimport {Vector2} from 'three/src/math/Vector2';\nimport {CoreDom} from 'src/core/Dom';\nimport {EventHelper} from 'src/core/EventHelper';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {Constants} from './Constants';\nimport {CameraData} from './CameraAnimation';\nimport {NodeMoveCommand} from 'src/editor/history/commands/NodeMove';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nexport class NodeAnimationHelper {\n\tprivate _captured_node: BaseNodeType | undefined;\n\tprivate node_start_positions: Vector2[] = [];\n\tprivate start_position: Vector2 = new Vector2();\n\tprivate move_progress_current_position: Vector2 = new Vector2();\n\tprivate move_offset: Vector2 = new Vector2();\n\tprivate event_helper: EventHelper = new EventHelper(document.body);\n\tprivate _move_in_progress: boolean = false;\n\n\tconstructor(private camera_data: CameraData) {}\n\t//\n\tset_element(element: HTMLElement) {\n\t\tthis.event_helper.set_element(element);\n\t}\n\n\tcapture_node(id: string) {\n\t\tconst node = StoreController.engine.node(id) || undefined;\n\t\tthis._captured_node = node;\n\t}\n\tprivate has_captured_nodes(): boolean {\n\t\treturn this.captured_nodes().length > 0;\n\t}\n\n\tcaptured_nodes(): BaseNodeType[] {\n\t\tif (this._captured_node) {\n\t\t\tconst parent = this._captured_node.parent;\n\t\t\tif (parent && parent.children_allowed() && parent.children_controller) {\n\t\t\t\tif (parent.children_controller.selection.contains(this._captured_node)) {\n\t\t\t\t\treturn parent.children_controller.selection.nodes();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn lodash_compact([this._captured_node]);\n\t}\n\n\t//\n\t//\n\t// MOVE\n\t//\n\t//\n\tmove_start(event: MouseEvent): boolean {\n\t\tif (!this.has_captured_nodes()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tCoreDom.add_drag_classes();\n\t\tthis._move_in_progress = true;\n\n\t\tconst nodes = this.captured_nodes();\n\t\tthis.node_start_positions = nodes.map((node) => {\n\t\t\tconst pos = node.ui_data.position.clone();\n\t\t\tconst precision = 1 * Constants.NODE_UNIT;\n\t\t\tpos.x = precision * Math.round(pos.x / precision);\n\t\t\tpos.y = precision * Math.round(pos.y / precision);\n\t\t\treturn pos;\n\t\t});\n\t\tthis.event_helper.element_position(event, this.start_position);\n\t\tthis.start_position.divideScalar(this.camera_data.zoom);\n\n\t\tthis.move_offset.set(0, 0); // = new Vector2(0, 0);\n\n\t\tconst node_ids = nodes.map((n) => n.graph_node_id);\n\t\tStoreController.editor.network.set_node_ids_being_moved(node_ids);\n\n\t\treturn true;\n\t}\n\n\tmove_progress(event: MouseEvent) {\n\t\tif (!this.has_captured_nodes()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.event_helper.element_position(event, this.move_progress_current_position);\n\t\tthis.move_progress_current_position.divideScalar(this.camera_data.zoom);\n\t\t// const move_current_position = this.ray_helper.intersect_plane_from_event(event, this.camera);\n\n\t\tthis.move_offset.copy(this.move_progress_current_position).sub(this.start_position);\n\t\t// this.move_offset.divideScalar(this.camera_data.zoom)\n\n\t\tconst nodes = this.captured_nodes();\n\t\tnodes.forEach((node, i) => {\n\t\t\tconst new_pos = this.node_start_positions[i].clone().add(this.move_offset);\n\t\t\tnode.ui_data.set_position(new_pos);\n\t\t});\n\t}\n\n\tmove_end(/*event: MouseEvent*/) {\n\t\tif (!this.has_captured_nodes()) {\n\t\t\treturn;\n\t\t}\n\n\t\tCoreDom.remove_drag_classes();\n\n\t\tconst nodes = this.captured_nodes();\n\t\t// snap\n\t\tconst precision = 1 * Constants.NODE_UNIT;\n\t\tif (nodes.length > 0 && this.move_offset) {\n\t\t\tconst offset = this.move_offset.clone();\n\t\t\toffset.x = precision * Math.round(offset.x / precision);\n\t\t\toffset.y = precision * Math.round(offset.y / precision);\n\n\t\t\tnodes.forEach((node, i) => {\n\t\t\t\treturn node.ui_data.set_position(this.node_start_positions[i]);\n\t\t\t});\n\n\t\t\tif (Math.abs(offset.x) > 0 || Math.abs(offset.y) > 0) {\n\t\t\t\tconst command = new NodeMoveCommand(nodes, offset);\n\t\t\t\tcommand.push();\n\t\t\t}\n\t\t}\n\n\t\t// release\n\t\tStoreController.editor.network.reset_node_ids_being_moved();\n\t\tthis._captured_node = undefined;\n\t\tthis.node_start_positions = [];\n\t\t// this.start_position = null;\n\t\t// this.move_offset = null;\n\t\tthis._move_in_progress = false;\n\t}\n\n\tmove_in_progress(): boolean {\n\t\treturn this._move_in_progress;\n\t}\n\tmouse_barely_moved(): boolean {\n\t\t// if (!(this.start_position != null && this.move_offset != null)) {\n\t\t// \treturn true;\n\t\t// }\n\n\t\treturn this.move_offset.length() < 5;\n\n\t\t// const delta = {\n\t\t// \tx: this.move_offset.x,\n\t\t// \ty: this.move_offset.y,\n\t\t// };\n\t\t// const max_dist = 0.05;\n\t\t// return Math.abs(delta.x) < max_dist && Math.abs(delta.y) < max_dist;\n\t}\n}\n","import {Vector2} from 'three/src/math/Vector2';\nimport {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class NodeMoveCommand extends BaseCommand {\n\tprivate _inverted_offset: Vector2 = new Vector2();\n\tconstructor(private _nodes: BaseNodeType[], private _offset: Vector2) {\n\t\tsuper();\n\t\tthis._inverted_offset.copy(this._offset).multiplyScalar(-1);\n\t}\n\n\tdo() {\n\t\tthis._nodes.forEach((node) => {\n\t\t\tnode.ui_data.translate(this._offset, true);\n\t\t});\n\t}\n\n\tundo() {\n\t\tthis._nodes.forEach((node) => {\n\t\t\tnode.ui_data.translate(this._inverted_offset, true);\n\t\t});\n\t}\n}\n","import {Vector2} from 'three/src/math/Vector2';\nimport {CoreDom} from 'src/core/Dom';\nimport {EventHelper} from 'src/core/EventHelper';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {CameraData} from './CameraAnimation';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {NodeConnectCommand} from 'src/editor/history/commands/NodeConnect';\n// import Material from './Material';\n\nexport interface ConnectionData {\n\tnode_src_id: string | null;\n\tnode_dest_id: string | null;\n\toutput_index: number;\n\tinput_index: number;\n\tmouse_start: Vector2Like;\n\tmouse_progress: Vector2Like;\n\tactive: boolean;\n}\n\nexport class ConnectionHelper {\n\t// private node_src: BaseNode\n\t// private node_dest: BaseNode\n\t// private input_index: number\n\tprivate start_position: Vector2 = new Vector2();\n\tprivate move_position: Vector2 = new Vector2();\n\tprivate event_helper: EventHelper = new EventHelper(document.body);\n\n\tconstructor(private data: ConnectionData, private camera_data: CameraData) {}\n\tset_element(element: HTMLElement) {\n\t\tthis.event_helper.set_element(element);\n\t}\n\n\t// line() {\n\t// \treturn this._mesh;\n\t// }\n\n\tcapture_node_src(id: string, index: number) {\n\t\t// this.node_src = node;\n\t\tconst node = StoreController.engine.node(id)!;\n\t\tthis.data.node_src_id = node.graph_node_id;\n\t\tthis.data.output_index = index;\n\t\t// if(this.both_end_captured()){ this.create_connection()}\n\t}\n\tcapture_node_dest(id: string, index: number) {\n\t\t// this.node_dest = node;\n\t\t// this.input_index = index;\n\t\tconst node = StoreController.engine.node(id)!;\n\t\tthis.data.node_dest_id = node.graph_node_id;\n\t\tthis.data.input_index = index;\n\t\t// if(this.both_end_captured()){ this.create_connection()}\n\t}\n\tcapture_node_final(id: string) {\n\t\tconst node = StoreController.engine.node(id)!;\n\t\tif (this.data.node_dest_id) {\n\t\t\tthis.data.node_src_id = node.graph_node_id;\n\t\t} else {\n\t\t\tif (this.data.node_src_id) {\n\t\t\t\tthis.data.node_dest_id = node.graph_node_id;\n\t\t\t\tthis.data.input_index = 0; //TODO: connect to the next available node?\n\t\t\t}\n\t\t}\n\n\t\tif (this.both_end_captured()) {\n\t\t\tthis.create_connection();\n\t\t}\n\t\tthis.reset();\n\t}\n\t//\n\t//\n\t// MOVE\n\t//\n\t//\n\tmove_start(event: MouseEvent): boolean {\n\t\tif (!this.has_captured_node()) {\n\t\t\treturn false;\n\t\t}\n\t\tCoreDom.add_drag_classes();\n\n\t\t// this.data.mouse_start = this.event_helper.element_position_old(event).divideScalar(this.camera_data.zoom)\n\t\tthis.event_helper.element_position(event, this.start_position);\n\t\tthis.start_position.divideScalar(this.camera_data.zoom);\n\t\tthis.data.mouse_start.x = this.start_position.x;\n\t\tthis.data.mouse_start.y = this.start_position.y;\n\n\t\tthis.data.mouse_progress = this.data.mouse_start;\n\t\tthis.data.active = true;\n\t\t// this.move_start_position = this.ray_helper.intersect_plane_from_event(event, this.camera);\n\t\t// this.move_current_position = this.move_start_position;\n\t\t// this._update_position();\n\t\t// return this._mesh\n\t\treturn true;\n\t}\n\n\tmove_progress(event: MouseEvent) {\n\t\tif (!this.has_captured_node()) {\n\t\t\treturn;\n\t\t}\n\n\t\t// this.data.mouse_progress = this.event_helper.element_position_old(event).divideScalar(this.camera_data.zoom)\n\t\tthis.event_helper.element_position(event, this.move_position);\n\t\tthis.move_position.divideScalar(this.camera_data.zoom);\n\t\tthis.data.mouse_progress = this.move_position;\n\t\t// this.data.mouse_progress.x = this.move_position.x\n\t\t// this.data.mouse_progress.y = this.move_position.y\n\n\t\t// this.data.mouse_delta = current_pos.sub(this.start_position)\n\t\t// this.data.line_end.x -= this.camera_data.position.x\n\t\t// this.data.line_end.y -= this.camera_data.position.y\n\t\t// this.move_current_position = this.ray_helper.intersect_plane_from_event(event, this.camera);\n\t\t// return this._update_position();\n\t}\n\n\tmove_end() {\n\t\tif (!this.has_captured_node()) {\n\t\t\treturn;\n\t\t}\n\t\tCoreDom.remove_drag_classes();\n\n\t\t// const intersect = this.ray_helper.intersected_mesh_with_callback(event, 'move_end', this.camera);\n\t\t// if (intersect) {\n\t\t// \tintersect.callbacks['move_end']();\n\t\t// }\n\n\t\t// const command = (() => {\n\t\t// \tif ((this.node_src != null) && (this.node_dest != null)) { // both input and output present\n\t\t// \treturn new History.Command.NodeConnect(this.node_src, this.node_dest, this.input_index);\n\t\t// } else if ((this.node_src == null) && (this.node_dest != null)) { // node_dest only\n\t\t// \treturn new History.Command.NodeConnect(this.node_src, this.node_dest, this.input_index);\n\t\t// }\n\t\t// })();\n\t\t// if (command != null) {\n\t\t// \tcommand.push(this.component);\n\t\t// }\n\n\t\tif (this.both_end_captured()) {\n\t\t\tthis.create_connection();\n\t\t} else {\n\t\t\tif (this.data.node_dest_id != null && this.data.node_src_id == null) {\n\t\t\t\tthis.disconnect_dest();\n\t\t\t}\n\t\t}\n\n\t\tthis.reset();\n\t}\n\n\tcreate_connection() {\n\t\tif (!this.data.node_src_id || !this.data.node_dest_id) {\n\t\t\treturn;\n\t\t}\n\t\tconst node_src = StoreController.scene.graph.node_from_id(this.data.node_src_id) as BaseNodeType;\n\t\tconst node_dest = StoreController.scene.graph.node_from_id(this.data.node_dest_id) as BaseNodeType;\n\t\tconst cmd = new NodeConnectCommand(node_src, node_dest, this.data.input_index, this.data.output_index);\n\t\tcmd.push();\n\t}\n\tdisconnect_dest() {\n\t\tif (!this.data.node_dest_id) {\n\t\t\treturn;\n\t\t}\n\t\tconst node_dest = StoreController.scene.graph.node_from_id(this.data.node_dest_id) as BaseNodeType;\n\t\tconst cmd = new NodeConnectCommand(null, node_dest, this.data.input_index);\n\t\tcmd.push();\n\t}\n\n\tprivate reset() {\n\t\t// this.node_dest = null;\n\t\t// this.node_src = null;\n\t\t// this.input_index = null;\n\n\t\tthis.data.node_src_id = null;\n\t\tthis.data.node_dest_id = null;\n\t\tthis.data.mouse_start.x = 0;\n\t\tthis.data.mouse_start.y = 0;\n\t\tthis.data.mouse_progress.x = 0;\n\t\tthis.data.mouse_progress.y = 0;\n\t\t// this.data.index = null;\n\t\tthis.data.active = false;\n\t}\n\n\tprivate has_captured_node(): boolean {\n\t\treturn (this.data.node_dest_id || this.data.node_src_id) != null;\n\t}\n\tprivate both_end_captured(): boolean {\n\t\treturn this.data.node_dest_id != null && this.data.node_src_id != null;\n\t}\n\n\t// _start_position(): Vector3 {\n\t// \tconst pos = this.move_start_position || new Vector3(0,0,0);\n\t// \tpos.z = 0;\n\t// \treturn pos;\n\t// }\n\t// _end_position(): Vector3 {\n\t// \tconst pos = this.move_current_position || new Vector3(0,1,0);\n\t// \tpos.z = 0;\n\t// \treturn pos;\n\t// }\n\n\t// _create_line() {\n\t// \treturn this._mesh;\n\t// }\n\n\t// _update_position(){\n\t// \tthis._geometry.vertices[0] = this._start_position();\n\t// \tthis._geometry.vertices[1] = this._end_position();\n\t// \treturn this._geometry.verticesNeedUpdate = true;\n\t// }\n\n\t// src_position(): Vector2 {\n\t// \tif(this.node_src){\n\t// \t\tconst pos = this.node_src.ui_data().position().clone()\n\n\t// \t\tpos.y += 10+Constants.NODE_UNIT\n\t// \t\treturn pos\n\t// \t} else {\n\t// \t\treturn this.data.line_end\n\t// \t}\n\t// }\n\t// dest_position() {\n\t// \tif(this.node_dest){\n\t// \t\tconst pos = this.node_dest.ui_data().position().clone()\n\t// \t\tpos.y -= 10\n\t// \t\treturn pos\n\t// \t} else {\n\t// \t\treturn this.data.line_end\n\t// \t}\n\t// }\n}\n","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class NodeConnectCommand extends BaseCommand {\n\tprivate _old_node_src: BaseNodeType | null;\n\tprivate _old_node_output_index: number | undefined;\n\n\tconstructor(\n\t\tprivate _node_src: BaseNodeType | null,\n\t\tprivate _node_dest: BaseNodeType,\n\t\tprivate _input_index: number,\n\t\tprivate _output_index?: number\n\t) {\n\t\tsuper();\n\n\t\tthis._old_node_src = this._node_dest.io.inputs.input(this._input_index);\n\t\tconst input_connection = this._node_dest.io.inputs.named_input_connection_points[this._input_index];\n\t\tif (input_connection) {\n\t\t\tconst input_connections = this._node_dest.io.connections.input_connections();\n\t\t\tif (input_connections) {\n\t\t\t\tconst input_connection = input_connections[this._input_index];\n\t\t\t\tif (input_connection) {\n\t\t\t\t\tthis._old_node_output_index = input_connection.output_index;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdo() {\n\t\tthis._node_dest.set_input(this._input_index, this._node_src, this._output_index);\n\t}\n\n\tundo() {\n\t\tthis._node_dest.set_input(this._input_index, this._old_node_src, this._old_node_output_index);\n\t}\n}\n","import {Vector2} from 'three/src/math/Vector2';\nimport {Box2} from 'three/src/math/Box2';\nimport {CoreDom} from 'src/core/Dom';\nimport {EventHelper} from 'src/core/EventHelper';\nimport {Constants} from './Constants';\n\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {CameraData} from './CameraAnimation';\nimport {NodeSelectCommand, SelectionMethod} from 'src/editor/history/commands/NodeSelect';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\n\nexport interface NodeSelectionData {\n\tstart: Vector2Like;\n\tend: Vector2Like;\n\tactive: boolean;\n}\n\nexport class NodeSelectionHelper {\n\tprivate event_helper: EventHelper = new EventHelper(document.body);\n\n\tprivate parent_node: BaseNodeType | undefined;\n\tprivate method: SelectionMethod = SelectionMethod.ADD;\n\tprivate start_position: Vector2 = new Vector2();\n\tprivate end_position: Vector2 = new Vector2();\n\tprivate node_around_mouse_position: Vector2 = new Vector2();\n\n\tconstructor(private data: NodeSelectionData, private camera_data: CameraData) {}\n\n\tset_element(element: HTMLElement) {\n\t\tthis.event_helper.set_element(element);\n\t}\n\n\tset_parent_node(parent_node: BaseNodeType) {\n\t\tthis.parent_node = parent_node;\n\t}\n\n\tcapture_node(id: string) {\n\t\tconst node = StoreController.engine.node(id);\n\t\tif (node) {\n\t\t\tthis.capture_nodes([node]);\n\t\t} else {\n\t\t\tthis.capture_nodes([]);\n\t\t}\n\t}\n\tcapture_nodes(nodes: BaseNodeType[]) {\n\t\tif (this.parent_node && this.parent_node.children_allowed() && this.parent_node.children_controller) {\n\t\t\tif (!this.parent_node.children_controller.selection.equals(nodes)) {\n\t\t\t\tconst command = new NodeSelectCommand(this.parent_node, nodes, this.method);\n\t\t\t\tcommand.push();\n\t\t\t} else {\n\t\t\t\t// console.log(\"selection has not changed\");\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn('selection has no parent node');\n\t\t}\n\t}\n\tclear_selection() {\n\t\tthis.capture_nodes([]);\n\t}\n\n\tmouse_barely_moved(event: MouseEvent): boolean {\n\t\t// if (!((this.start_position != null) && (this.end_position != null))) { return true; }\n\n\t\t// const delta = {\n\t\t// \tx: this.end_position.x - this.start_position.x,\n\t\t// \ty: this.end_position.y - this.start_position.y\n\t\t// };\n\t\tconst delta = this.start_position.distanceTo(this.end_position);\n\t\treturn delta < 3;\n\n\t\t// const max_dist = 0.05;\n\t\t// return (Math.abs(delta.x) < max_dist) && (Math.abs(delta.y) < max_dist);\n\t}\n\n\t//\n\t//\n\t// MOVE\n\t//\n\t//\n\tmove_start(event: MouseEvent) {\n\t\tCoreDom.add_drag_classes();\n\n\t\tthis.event_helper.element_position(event, this.start_position);\n\t\tthis.start_position.divideScalar(this.camera_data.zoom);\n\t\t// this.start_position.multiplyScalar(this.camera_data.zoom)\n\t\tthis.data.start.x = this.start_position.x;\n\t\tthis.data.start.y = this.start_position.y;\n\t\tthis.data.end.x = this.data.start.x;\n\t\tthis.data.end.y = this.data.start.y;\n\t\tthis.data.active = true;\n\t\t// this.move_start_position = this.ray_helper.intersect_plane_from_event(event, this.camera);\n\t\t// this.move_end_position = this.move_start_position;\n\t\t// this._update_position();\n\t\t// return this._mesh.visible = true;\n\t}\n\n\tmove_progress(event: MouseEvent) {\n\t\tif (!this.data.active) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.event_helper.element_position(event, this.end_position);\n\t\tthis.end_position.divideScalar(this.camera_data.zoom);\n\t\tthis.data.end.x = this.end_position.x;\n\t\tthis.data.end.y = this.end_position.y;\n\t\t// this.move_end_position = this.ray_helper.intersect_plane_from_event(event, this.camera);\n\t\t// this._update_position();\n\t}\n\n\tmove_end(event: MouseEvent, move_in_progress: boolean, move_barely_moved: boolean) {\n\t\tCoreDom.remove_drag_classes();\n\t\t// this.move_end_position = this.ray_helper.intersect_plane_from_event(event, this.camera);\n\n\t\tif (event.ctrlKey) {\n\t\t\tthis.method = SelectionMethod.ADD;\n\t\t} else {\n\t\t\tif (event.shiftKey) {\n\t\t\t\tthis.method = SelectionMethod.REMOVE;\n\t\t\t} else {\n\t\t\t\tthis.method = SelectionMethod.OVERRIDE;\n\t\t\t}\n\t\t}\n\n\t\tlet nodes = this.nodes_inside_box();\n\t\tif (move_barely_moved) {\n\t\t\tconst found_node = this.node_around_mouse(event);\n\t\t\tif (found_node) {\n\t\t\t\tnodes = [found_node];\n\t\t\t}\n\t\t}\n\n\t\tif (!move_in_progress || (move_in_progress && move_barely_moved)) {\n\t\t\tif (this.mouse_barely_moved(event)) {\n\t\t\t\tif (nodes.length == 0) {\n\t\t\t\t\tthis.clear_selection();\n\t\t\t\t} else {\n\t\t\t\t\tthis.capture_nodes(nodes);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (nodes.length > 0) {\n\t\t\t\t\tthis.capture_nodes(nodes);\n\t\t\t\t} else {\n\t\t\t\t\tthis.clear_selection();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// this._mesh.visible = false;\n\t\t// this.start_position = null\n\t\t// this.end_position = null\n\t\tthis.data.active = false;\n\t}\n\n\t// _position_from_event: (event)->\n\t// \t{\n\t// \t\tx: event.screenX,\n\t// \t\ty: event.screenY,\n\t// \t}\n\n\tnode_around_mouse(event: MouseEvent) {\n\t\tthis.event_helper.element_position(event, this.node_around_mouse_position);\n\t\tthis.node_around_mouse_position.divideScalar(this.camera_data.zoom);\n\t\tconst corner = this.node_around_mouse_position;\n\t\tconst box = new Box2(corner, corner);\n\t\tlet found_node = null;\n\t\tif (this.parent_node) {\n\t\t\tfor (let node of this.parent_node.children()) {\n\t\t\t\tconst node_box = this.node_box(node);\n\t\t\t\tif (box.intersectsBox(node_box)) {\n\t\t\t\t\tfound_node = found_node || node;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn found_node;\n\t}\n\n\tbox(): Box2 {\n\t\tconst r = this.data;\n\t\tconst min = new Vector2(Math.min(r.end.x, r.start.x), Math.min(r.end.y, r.start.y));\n\t\tconst max = new Vector2(Math.max(r.end.x, r.start.x), Math.max(r.end.y, r.start.y));\n\t\t// const size = new Vector2(\n\t\t// \tMath.abs( r.end.x - r.start.x ),\n\t\t// \tMath.abs( r.end.y - r.start.y )\n\t\t// )\n\t\treturn new Box2(min, max);\n\t}\n\n\tprivate nodes_inside_box(): BaseNodeType[] {\n\t\t// const min = this._min_position();\n\t\t// const max = this._max_position();\n\n\t\t// const bbox = new Box2(\n\t\t// \tnew Vector2(min.x, min.y),\n\t\t// \tnew Vector2(max.x, max.y)\n\t\t// \t);\n\t\tconst box = this.box();\n\t\t// const cam_pos = this.camera_data.position\n\t\t// const camera_position_offset = new Vector2(cam_pos.x, cam_pos.y)\n\t\tconst nodes = [];\n\n\t\tif (this.parent_node) {\n\t\t\tfor (let node of this.parent_node.children()) {\n\t\t\t\t// const pos = node.ui_data().position();\n\t\t\t\t// const adjusted_pos = pos.clone().multiplyScalar(50).sub(this.camera_data.position)\n\t\t\t\tconst node_box = this.node_box(node); //.translate(camera_position_offset)\n\t\t\t\tif (box.intersectsBox(node_box)) {\n\t\t\t\t\tnodes.push(node);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn nodes;\n\t}\n\n\tprivate node_box(node: BaseNodeType): Box2 {\n\t\t// const pos_mult = Constants.NODE_POS_MULT\n\t\tconst size = Constants.NODE_UNIT;\n\t\tconst pos = node.ui_data.position.clone(); //.multiplyScalar(pos_mult)\n\t\treturn new Box2(pos.clone().subScalar(size * 0.5), pos.clone().addScalar(size * 0.5));\n\t}\n}\n","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\nimport {TypeAssert} from 'src/engine/poly/Assert';\n\n// OVERRIDE = 'OVERRIDE';\n// ADD = 'ADD';\n// REMOVE = 'REMOVE';\n\nexport enum SelectionMethod {\n\tOVERRIDE = 'OVERRIDE',\n\tADD = 'ADD',\n\tREMOVE = 'REMOVE',\n}\n\nexport class NodeSelectCommand extends BaseCommand {\n\tprivate _old_nodes: BaseNodeType[] | undefined;\n\n\tconstructor(private _parent: BaseNodeType, private nodes: BaseNodeType[], private _method: SelectionMethod) {\n\t\tsuper();\n\t\tif (this._parent.children_allowed() && this._parent.children_controller) {\n\t\t\tthis._old_nodes = this._parent.children_controller.selection.nodes();\n\t\t}\n\t}\n\n\tdo() {\n\t\tif (this._parent.children_allowed() && this._parent.children_controller) {\n\t\t\tconst selection = this._parent.children_controller.selection;\n\t\t\tswitch (this._method) {\n\t\t\t\tcase SelectionMethod.OVERRIDE:\n\t\t\t\t\treturn selection.set(this.nodes);\n\t\t\t\tcase SelectionMethod.ADD:\n\t\t\t\t\treturn selection.add(this.nodes);\n\t\t\t\tcase SelectionMethod.REMOVE:\n\t\t\t\t\treturn selection.remove(this.nodes);\n\t\t\t}\n\t\t\tTypeAssert.unreachable(this._method);\n\t\t}\n\t}\n\n\tundo() {\n\t\tif (this._parent.children_allowed() && this._parent.children_controller) {\n\t\t\tif (this._old_nodes) {\n\t\t\t\tthis._parent.children_controller.selection.set(this._old_nodes);\n\t\t\t}\n\t\t}\n\t}\n}\n","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Network.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Network.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".above-event-catcher{position:relative;z-index:10}.Panel.Network{position:relative}.Panel.Network .buttons-container-height-0{height:0px;padding-left:5px;padding-top:5px}.Panel.Network .buttons-container-height-0 .go-up-button-container{margin-right:5px}.Panel.Network .buttons-container-height-0 .go-up-button-container .go-up-button{padding:5px;border-radius:25px;width:25px;height:25px;text-align:center;background-color:#90ee90;cursor:pointer;opacity:.7;line-height:0}.Panel.Network .buttons-container-height-0 .go-up-button-container .go-up-button:hover{opacity:1}.Panel.Network .buttons-container-height-0 .go-up-button-container .go-up-button svg{display:inline-block;margin:auto;position:relative}.Panel.Network .canvas_container,.Panel.Network .canvas,.Panel.Network .object_parents{width:100%;height:100%}.Panel.Network .canvas_container .canvas{overflow:hidden;position:relative}.Panel.Network .canvas_container .canvas.pan_in_progress{cursor:move}.Panel.Network .canvas_container .canvas.zoom_in_progress{cursor:zoom-in}.Panel.Network .canvas_container .canvas .selection-rectangle{pointer-events:none;position:absolute;border:3px solid green;z-index:10;background-color:gray;opacity:.2}.Panel.Network .canvas_container .canvas .node-creation-rectangle{pointer-events:none;position:absolute;border:3px solid green;z-index:10}.Panel.Network .canvas_container .canvas .zoom-container{position:absolute;top:50%;left:50%;width:20px;height:20px}.Panel.Network .canvas_container .canvas .zoom-container .pan-container{position:absolute;width:10px;height:10px}.Panel.Network .canvas_container .canvas .zoom-container .pan-container .nodes-container{position:relative;width:0;height:0;top:0;left:0}.Panel.Network .canvas_container .canvas .zoom-container .pan-container .nodes-container .nodes-container-events-catcher{position:absolute;width:50000px;height:50000px;top:-25000px;left:-25000px}.Panel.Network .canvas_container .canvas .zoom-container .pan-container .nodes-container svg.connection-line-container{position:absolute;top:0px;left:0px;width:100%;height:100%;z-index:10;pointer-events:none}.Panel.Network .canvas_container .canvas .zoom-container .pan-container .nodes-container svg.connection-line-container line{stroke:gray;stroke-width:2}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Params.vue?vue&type=template&id=594125ff&lang=pug&\"\nimport script from \"./Params.vue?vue&type=script&lang=ts&\"\nexport * from \"./Params.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Params.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('594125ff')) {\n      api.createRecord('594125ff', component.options)\n    } else {\n      api.reload('594125ff', component.options)\n    }\n    module.hot.accept(\"./Params.vue?vue&type=template&id=594125ff&lang=pug&\", function () {\n      api.rerender('594125ff', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/Params.vue\"\nexport default component.exports","import {ref, onMounted, computed, watch, Ref} from '@vue/composition-api';\nimport {EngineParamData} from 'src/editor/store/modules/Engine';\nimport {StoreController} from 'src/editor/store/controllers/StoreController';\nimport {SetupSelectedNodeOptions} from '../../../../components/mixins/SelectedNode';\nimport {ParamType} from 'src/engine/poly/ParamType';\nimport {NodeSerializerData} from 'src/engine/nodes/utils/Serializer';\n// import {FolderParam} from 'src/engine/params/Folder';\n\nexport function SetupFolders(selected_node_options: SetupSelectedNodeOptions) {\n\tconst active_folder_param_id = ref<string | null>(null);\n\tconst history_active_folder_id_by_param_graph_id: Map<string, string> = new Map<string, string>();\n\n\tconst json_node: Ref<NodeSerializerData | null> = computed(() => {\n\t\treturn selected_node_options.first_selected_json_node.value;\n\t});\n\tconst json_params = computed(() => {\n\t\tif (json_node.value) {\n\t\t\treturn json_node.value.param_ids.map((param_id) => StoreController.engine.json_param(param_id));\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t});\n\tconst top_folder_json_params = computed(() => {\n\t\treturn json_params.value.filter((json_param) => {\n\t\t\tif (json_param) {\n\t\t\t\treturn _is_json_param_top_folder(json_param);\n\t\t\t}\n\t\t});\n\t});\n\tconst display_top_folders = computed(() => {\n\t\t// no need to display folders if there is only 1\n\t\treturn top_folder_json_params.value.length > 1;\n\t});\n\n\t// const top_folder_names = computed(() => {\n\t// \treturn top_folder_json_params.value.map((json_param) => {\n\t// \t\tif (json_param) {\n\t// \t\t\treturn json_param.name;\n\t// \t\t}\n\t// \t});\n\t// });\n\tconst NO_FOLDER_NAME = '';\n\tconst param_ids_by_top_folder_ids = computed(() => {\n\t\tlet last_folder_param_id: string = NO_FOLDER_NAME;\n\t\tconst dict: Dictionary<string[]> = {};\n\t\tif (json_node.value) {\n\t\t\tconst json_params = json_node.value.param_ids.map((param_id) =>\n\t\t\t\tStoreController.engine.json_param(param_id)\n\t\t\t);\n\t\t\tjson_params.forEach((json_param) => {\n\t\t\t\tif (json_param) {\n\t\t\t\t\tif (_is_json_param_top_folder(json_param)) {\n\t\t\t\t\t\tlast_folder_param_id = json_param.graph_node_id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdict[last_folder_param_id] = dict[last_folder_param_id] || [];\n\t\t\t\t\t\tdict[last_folder_param_id].push(json_param.graph_node_id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn dict;\n\t});\n\n\tconst folder_class_objects = computed(() => {\n\t\treturn top_folder_json_params.value.map((json_param) => {\n\t\t\treturn {\n\t\t\t\tactive: active_folder_param_id.value == json_param?.graph_node_id,\n\t\t\t};\n\t\t});\n\t});\n\tfunction _is_json_param_top_folder(json_param: EngineParamData) {\n\t\tif (json_param.type == ParamType.FOLDER) {\n\t\t\tconst param = StoreController.engine.param(json_param.graph_node_id);\n\t\t\tif (param) {\n\t\t\t\tif (param.options.level == 0) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t// const selected_node_json_params_for_current_folder = computed(() => {\n\t// \tif (selected_node_json_params_by_folder_name) {\n\t// \t\treturn selected_node_json_params_by_folder_name[active_folder_name] || [];\n\t// \t} else {\n\t// \t\treturn [];\n\t// \t}\n\t// });\n\t// const param_tab_indices = computed(() => {\n\t// \treturn selected_node_json_params_for_current_folder.map((p, i) => 1000 + i * 100);\n\t// });\n\t// const spare_param_tab_indices = computed(() => {\n\t// \treturn selected_node_json_spare_params.map((p, i) => 2000 + i * 100);\n\t// });\n\n\tconst selected_node_json_params_for_current_folder = computed(() => {\n\t\tif (json_node.value) {\n\t\t\t// check that params have been added to the store\n\t\t\tconst first_id = json_node.value.param_ids[0];\n\t\t\tif (first_id) {\n\t\t\t\tconst first_json_param = StoreController.engine.json_param(first_id);\n\t\t\t\tif (!first_json_param) {\n\t\t\t\t\tStoreController.engine.add_node_params_to_store(json_node.value.graph_node_id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// get the list\n\t\t\tlet json_params: (EngineParamData | null)[] | undefined = undefined;\n\t\t\tif (active_folder_param_id.value) {\n\t\t\t\tconst ids = param_ids_by_top_folder_ids.value[active_folder_param_id.value];\n\t\t\t\tif (ids) {\n\t\t\t\t\tjson_params = ids.map((id) => StoreController.engine.json_param(id));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!json_params) {\n\t\t\t\tjson_params = json_node.value.param_ids.map((id) => StoreController.engine.json_param(id));\n\t\t\t}\n\n\t\t\treturn json_params.filter((json_param) => {\n\t\t\t\tif (json_param) {\n\t\t\t\t\tconst param = StoreController.engine.param(json_param.graph_node_id);\n\t\t\t\t\treturn param && param.parent_param == null;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t});\n\n\tonMounted(() => {\n\t\t// _selected_folder_by_node_id = _selected_folder_by_node_id || {};\n\t\tinit_folder_name();\n\t});\n\n\twatch(selected_node_options.first_selected_node_id, (new_id, old_id) => {\n\t\tif (new_id) {\n\t\t\tinit_folder_name();\n\t\t}\n\t});\n\n\t// // functions\n\tfunction init_folder_name() {\n\t\tif (json_node.value) {\n\t\t\tconst node_id = json_node.value.graph_node_id;\n\t\t\tif (history_active_folder_id_by_param_graph_id.has(node_id)) {\n\t\t\t\tconst folder_id = history_active_folder_id_by_param_graph_id.get(node_id);\n\t\t\t\tif (folder_id) {\n\t\t\t\t\tset_active_folder_id(folder_id);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (top_folder_json_params.value[0]) {\n\t\t\t\t\tset_active_folder_id(top_folder_json_params.value[0]?.graph_node_id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// \tconst folder_name = _selected_folder_by_node_id[selected_json_node.graph_node_id];\n\t\t// \tif (folder_name) {\n\t\t// \t\tset_active_folder(folder_name);\n\t\t// \t}\n\t\t// } else {\n\t\t// \tif (selected_node_folder_names.indexOf(active_folder_name) < 0) {\n\t\t// \t\tset_active_folder(selected_node_folder_names[0]);\n\t\t// \t}\n\t\t// }\n\t}\n\tfunction set_active_folder_id(folder_id: string) {\n\t\tactive_folder_param_id.value = folder_id;\n\n\t\tif (json_node.value) {\n\t\t\thistory_active_folder_id_by_param_graph_id.set(json_node.value.graph_node_id, folder_id);\n\t\t}\n\t}\n\n\treturn {\n\t\tdisplay_top_folders,\n\t\ttop_folder_json_params,\n\t\tselected_node_json_params_for_current_folder,\n\t\tfolder_class_objects,\n\t\t// functions\n\t\tset_active_folder_id,\n\t};\n\t// return {\n\t// \tactive_folder_name,\n\t// \tfolder_class_objects,\n\t// \tselected_node_json_params_for_current_folder,\n\t// \tparam_tab_indices,\n\t// \tspare_param_tab_indices,\n\t// \t// functions\n\t// \tinit_folder_name,\n\t// \tset_active_folder,\n\t// };\n}\n","import { render, staticRenderFns } from \"./Param.vue?vue&type=template&id=23a0544d&lang=pug&\"\nimport script from \"./Param.vue?vue&type=script&lang=ts&\"\nexport * from \"./Param.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Param.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('23a0544d')) {\n      api.createRecord('23a0544d', component.options)\n    } else {\n      api.reload('23a0544d', component.options)\n    }\n    module.hot.accept(\"./Param.vue?vue&type=template&id=23a0544d&lang=pug&\", function () {\n      api.rerender('23a0544d', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/Param.vue\"\nexport default component.exports","import { render, staticRenderFns } from \"./Boolean.vue?vue&type=template&id=142cc982&lang=pug&\"\nimport script from \"./Boolean.vue?vue&type=script&lang=ts&\"\nexport * from \"./Boolean.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Boolean.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('142cc982')) {\n      api.createRecord('142cc982', component.options)\n    } else {\n      api.reload('142cc982', component.options)\n    }\n    module.hot.accept(\"./Boolean.vue?vue&type=template&id=142cc982&lang=pug&\", function () {\n      api.rerender('142cc982', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Boolean.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Boolean.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Boolean.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Field.Toggle input.raw_input{display:block}.Field.Toggle input.expression_result{display:none}.Field.Toggle.displays_expression_result input.raw_input{display:none}.Field.Toggle.displays_expression_result input.expression_result{display:block}.Field.Toggle input{margin:0px}.Field.Toggle input.has_expression{background-color:#86b586}.Field.Toggle input[type=checkbox]{cursor:pointer;-ms-transform:scale(1.4);-moz-transform:scale(1.4);-webkit-transform:scale(1.4);-o-transform:scale(1.4);transform:scale(1.4);margin-right:5px;position:relative;top:2px}.Field.Toggle label{padding:5px;cursor:pointer}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Button.vue?vue&type=template&id=7c9511c8&lang=pug&\"\nimport script from \"./Button.vue?vue&type=script&lang=ts&\"\nexport * from \"./Button.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Button.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('7c9511c8')) {\n      api.createRecord('7c9511c8', component.options)\n    } else {\n      api.reload('7c9511c8', component.options)\n    }\n    module.hot.accept(\"./Button.vue?vue&type=template&id=7c9511c8&lang=pug&\", function () {\n      api.rerender('7c9511c8', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Button.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Color.vue?vue&type=template&id=26198086&lang=pug&\"\nimport script from \"./Color.vue?vue&type=script&lang=ts&\"\nexport * from \"./Color.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Color.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('26198086')) {\n      api.createRecord('26198086', component.options)\n    } else {\n      api.reload('26198086', component.options)\n    }\n    module.hot.accept(\"./Color.vue?vue&type=template&id=26198086&lang=pug&\", function () {\n      api.rerender('26198086', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Color.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Color.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Color.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Field.Color input[type=color]{cursor:pointer;width:30px;height:100%;padding:0px;margin-right:5px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Float.vue?vue&type=template&id=0defe394&lang=pug&\"\nimport script from \"./Float.vue?vue&type=script&lang=ts&\"\nexport * from \"./Float.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Float.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('0defe394')) {\n      api.createRecord('0defe394', component.options)\n    } else {\n      api.reload('0defe394', component.options)\n    }\n    module.hot.accept(\"./Float.vue?vue&type=template&id=0defe394&lang=pug&\", function () {\n      api.rerender('0defe394', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Float.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Float.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Float.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Folder.vue?vue&type=template&id=35db0904&lang=pug&\"\nimport script from \"./Folder.vue?vue&type=script&lang=ts&\"\nexport * from \"./Folder.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Folder.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('35db0904')) {\n      api.createRecord('35db0904', component.options)\n    } else {\n      api.reload('35db0904', component.options)\n    }\n    module.hot.accept(\"./Folder.vue?vue&type=template&id=35db0904&lang=pug&\", function () {\n      api.rerender('35db0904', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Folder.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Folder.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Folder.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Integer.vue?vue&type=template&id=9dab38d0&lang=pug&\"\nimport script from \"./Integer.vue?vue&type=script&lang=ts&\"\nexport * from \"./Integer.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Integer.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('9dab38d0')) {\n      api.createRecord('9dab38d0', component.options)\n    } else {\n      api.reload('9dab38d0', component.options)\n    }\n    module.hot.accept(\"./Integer.vue?vue&type=template&id=9dab38d0&lang=pug&\", function () {\n      api.rerender('9dab38d0', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Integer.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Integer.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Integer.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./OperatorPath.vue?vue&type=template&id=26d7e102&lang=pug&\"\nimport script from \"./OperatorPath.vue?vue&type=script&lang=ts&\"\nexport * from \"./OperatorPath.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./OperatorPath.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('26d7e102')) {\n      api.createRecord('26d7e102', component.options)\n    } else {\n      api.reload('26d7e102', component.options)\n    }\n    module.hot.accept(\"./OperatorPath.vue?vue&type=template&id=26d7e102&lang=pug&\", function () {\n      api.rerender('26d7e102', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/OperatorPath.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OperatorPath.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OperatorPath.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Field.OperatorPath .button-group{position:relative;top:1px;margin-right:5px}.Field.OperatorPath .button-group .button{margin-left:5px;margin-bottom:0px;line-height:0;padding:.7em 1em}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Radio.vue?vue&type=template&id=3d0c1855&lang=pug&\"\nimport script from \"./Radio.vue?vue&type=script&lang=ts&\"\nexport * from \"./Radio.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Radio.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('3d0c1855')) {\n      api.createRecord('3d0c1855', component.options)\n    } else {\n      api.reload('3d0c1855', component.options)\n    }\n    module.hot.accept(\"./Radio.vue?vue&type=template&id=3d0c1855&lang=pug&\", function () {\n      api.rerender('3d0c1855', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Radio.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Radio.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Radio.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Field.Radio input,.Field.Radio label{cursor:pointer}.Field.Radio select.select{margin-bottom:0}.Field.Radio label{padding-top:5px;padding-left:10px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Separator.vue?vue&type=template&id=e1dc1d82&lang=pug&\"\nimport script from \"./Separator.vue?vue&type=script&lang=ts&\"\nexport * from \"./Separator.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Separator.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('e1dc1d82')) {\n      api.createRecord('e1dc1d82', component.options)\n    } else {\n      api.reload('e1dc1d82', component.options)\n    }\n    module.hot.accept(\"./Separator.vue?vue&type=template&id=e1dc1d82&lang=pug&\", function () {\n      api.rerender('e1dc1d82', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Separator.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Separator.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Separator.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Field.Separator .horizontal-border{height:2px;background-color:#a9a9a9;margin:10px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./String.vue?vue&type=template&id=0972c327&lang=pug&\"\nimport script from \"./String.vue?vue&type=script&lang=ts&\"\nexport * from \"./String.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./String.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('0972c327')) {\n      api.createRecord('0972c327', component.options)\n    } else {\n      api.reload('0972c327', component.options)\n    }\n    module.hot.accept(\"./String.vue?vue&type=template&id=0972c327&lang=pug&\", function () {\n      api.rerender('0972c327', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/String.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./String.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./String.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Field.String input.raw_input,.Field.String textarea.raw_input{display:block}.Field.String input.expression_result,.Field.String textarea.expression_result{display:none}.Field.String.displays_expression_result input.raw_input,.Field.String.displays_expression_result textarea.raw_input{display:none}.Field.String.displays_expression_result input.expression_result,.Field.String.displays_expression_result textarea.expression_result{display:block}.Field.String input,.Field.String textarea{margin:0px}.Field.String input.has_expression:not(.is_errored),.Field.String textarea.has_expression:not(.is_errored){background-color:#86b586}.Field.String input.is_errored,.Field.String textarea.is_errored{background-color:#cc4b37}.Field.String.displays_expression_only input,.Field.String.displays_expression_only textarea{border:0;background-color:transparent;box-shadow:none}.Field.String .browse_button{margin-left:10px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Vector2.vue?vue&type=template&id=bc988dae&lang=pug&\"\nimport script from \"./Vector2.vue?vue&type=script&lang=ts&\"\nexport * from \"./Vector2.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Vector2.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('bc988dae')) {\n      api.createRecord('bc988dae', component.options)\n    } else {\n      api.reload('bc988dae', component.options)\n    }\n    module.hot.accept(\"./Vector2.vue?vue&type=template&id=bc988dae&lang=pug&\", function () {\n      api.rerender('bc988dae', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Vector2.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector2.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector2.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Vector3.vue?vue&type=template&id=bc7c5eac&lang=pug&\"\nimport script from \"./Vector3.vue?vue&type=script&lang=ts&\"\nexport * from \"./Vector3.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Vector3.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('bc7c5eac')) {\n      api.createRecord('bc7c5eac', component.options)\n    } else {\n      api.reload('bc7c5eac', component.options)\n    }\n    module.hot.accept(\"./Vector3.vue?vue&type=template&id=bc7c5eac&lang=pug&\", function () {\n      api.rerender('bc7c5eac', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Vector3.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector3.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector3.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Vector4.vue?vue&type=template&id=bc602faa&lang=pug&\"\nimport script from \"./Vector4.vue?vue&type=script&lang=ts&\"\nexport * from \"./Vector4.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Vector4.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('bc602faa')) {\n      api.createRecord('bc602faa', component.options)\n    } else {\n      api.reload('bc602faa', component.options)\n    }\n    module.hot.accept(\"./Vector4.vue?vue&type=template&id=bc602faa&lang=pug&\", function () {\n      api.rerender('bc602faa', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Vector4.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector4.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Vector4.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Ramp.vue?vue&type=template&id=d48a23b0&lang=pug&\"\nimport script from \"./Ramp.vue?vue&type=script&lang=ts&\"\nexport * from \"./Ramp.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Ramp.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('d48a23b0')) {\n      api.createRecord('d48a23b0', component.options)\n    } else {\n      api.reload('d48a23b0', component.options)\n    }\n    module.hot.accept(\"./Ramp.vue?vue&type=template&id=d48a23b0&lang=pug&\", function () {\n      api.rerender('d48a23b0', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/params/components/fields/Ramp.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ramp.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ramp.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Field.Ramp .points_container{background-color:#fff}.Field.Ramp .points_container svg{display:block;height:160px;width:100%}.Field.Ramp .points_container svg circle.control_point{r:5;stroke:#000;stroke-width:1;fill:gray;cursor:pointer}.Field.Ramp .points_container svg circle.control_point:hover,.Field.Ramp .points_container svg circle.control_point.dragged{stroke-width:2;fill:#d3d3d3}.Field.Ramp .points_container svg circle.interpolated_curve_point{r:2;fill:#000}.Field.Ramp .points_container svg circle.interpolated_curve_point.point_about_to_be_removed{fill:red}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Param.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Param.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".ParamContainer{padding:1px 0px;overflow:hidden}.ParamContainer .param_menu_container{position:relative;height:1px;width:100%;background-color:red}.ParamContainer .param_name{position:relative;z-index:1}.ParamContainer .param_name label{font-size:.8rem;color:#111;cursor:pointer;margin:5px;padding:0rem 10px}.ParamContainer .param_name label:hover{background-color:#5bbb7f}.ParamContainer .Field{position:relative;z-index:2}.ParamContainer .Field input.raw_input{display:block}.ParamContainer .Field input.expression_result{display:none}.ParamContainer .Field.displays_expression_result input.raw_input{display:none}.ParamContainer .Field.displays_expression_result input.expression_result{display:block}.ParamContainer .Field input,.ParamContainer .Field select{margin:0px;padding:.2rem;font-size:.8rem;height:2rem}.ParamContainer .Field input.has_expression:not(.is_errored),.ParamContainer .Field select.has_expression:not(.is_errored){background-color:#c5dcc5}.ParamContainer .Field input.is_errored,.ParamContainer .Field select.is_errored{background-color:#d15d4b}.ParamContainer .Field .slider_container{padding:0px 10px}.ParamContainer .Field .slider_container input[type=range]{width:100%;height:100%;padding:0;margin:0;-webkit-appearance:none;appearance:none;outline:none;background-color:transparent}.ParamContainer .Field .slider_container input[type=range]:hover::-webkit-slider-thumb{background-color:#2196e3}.ParamContainer .Field .slider_container input[type=range]:hover::-moz-range-thumb{background-color:#2196e3}.ParamContainer .Field .slider_container input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;position:relative;top:-7px;width:16px;height:16px;border-radius:16px;background-color:#1779ba;cursor:pointer}.ParamContainer .Field .slider_container input[type=range]::-moz-range-thumb{-webkit-appearance:none;appearance:none;position:relative;top:-7px;width:16px;height:16px;border-radius:16px;background-color:#1779ba;cursor:pointer}.ParamContainer .Field .slider_container input[type=range]::-webkit-slider-runnable-track{width:100%;height:2px;background:#fff}.ParamContainer .Field .slider_container input[type=range]::-moz-range-track{width:100%;height:2px;background:#fff}.ParamContainer .Field.Multiple.grid-x .cell .Field.Numeric:not:first-child{padding-left:2px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Params.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Params.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Panel.Params .params_container{overflow-y:auto}.Panel.Params .node_name_container,.Panel.Params .node_help_button{margin:10px 5px}.Panel.Params .node_name_container .node_name{cursor:pointer}.Panel.Params .node_name_container .node_name:hover{color:#000}.Panel.Params .node_name_container .node_type{margin-left:10px;opacity:.75;font-style:italic}.Panel.Params .node_help_button{color:#111;display:inline-block;cursor:pointer;margin-right:10px;padding:0px 10px;border-bottom:2px solid transparent}.Panel.Params .node_help_button:hover{color:#1779ba;border-bottom:2px solid #1779ba}.Panel.Params .params_container{padding-right:10px;padding-bottom:10px}.Panel.Params .params_container .params_folder .folder_name{padding:2px 5px;font-size:.8rem;margin-bottom:5px;cursor:pointer;text-align:center;background-color:#b5e0c5;border-bottom:2px solid #42a165}.Panel.Params .params_container .params_folder .folder_name:hover{opacity:.8;background-color:#42a165}.Panel.Params .params_container .params_folder.active .folder_name{background-color:#42a165}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Viewer.vue?vue&type=template&id=3a6d707f&lang=pug&\"\nimport script from \"./Viewer.vue?vue&type=script&lang=ts&\"\nexport * from \"./Viewer.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Viewer.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('3a6d707f')) {\n      api.createRecord('3a6d707f', component.options)\n    } else {\n      api.reload('3a6d707f', component.options)\n    }\n    module.hot.accept(\"./Viewer.vue?vue&type=template&id=3a6d707f&lang=pug&\", function () {\n      api.rerender('3a6d707f', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/viewer/Viewer.vue\"\nexport default component.exports","import { render, staticRenderFns } from \"./Threejs.vue?vue&type=template&id=8560bbca&lang=pug&\"\nimport script from \"./Threejs.vue?vue&type=script&lang=ts&\"\nexport * from \"./Threejs.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Threejs.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('8560bbca')) {\n      api.createRecord('8560bbca', component.options)\n    } else {\n      api.reload('8560bbca', component.options)\n    }\n    module.hot.accept(\"./Threejs.vue?vue&type=template&id=8560bbca&lang=pug&\", function () {\n      api.rerender('8560bbca', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/viewer/components/Threejs.vue\"\nexport default component.exports","import mod from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Threejs.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../../node_modules/vue-style-loader/index.js!../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Threejs.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".ThreejsViewer{height:100%}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Panel.Viewer canvas,.Panel.Viewer #mapbox_container{width:100%;height:100%}.Panel.Viewer .viewer_top_bar{background-color:#a8c8dc}.Panel.Viewer .viewer_top_bar .viewer_top_bar-controls-right{padding-right:10px}.Panel.Viewer .viewer_top_bar input{margin-bottom:0px;padding:0px}.Panel.Viewer .viewer_top_bar input[type=color]{width:20px;height:20px}.Panel.Viewer .viewer_top_bar .color-bg-input-container{margin-top:4px}.Panel.Viewer .viewers_container{position:relative}.Panel.Viewer .viewers_container .panel_container{position:absolute;min-width:360px;top:0px;left:0px;padding:10px 10px;opacity:.85}.Panel.Viewer .viewers_container .panel_container:hover{opacity:1}.Panel.Viewer .full-screen-button{margin-right:10px;height:100%;position:relative;cursor:pointer;line-height:0}.Panel.Viewer .full-screen-button svg{position:relative;top:50%;transform:translateY(-50%)}.Panel.Viewer .full-screen-button:hover{opacity:.7}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Spreadsheet.vue?vue&type=template&id=1f1f2a99&lang=pug&\"\nimport script from \"./Spreadsheet.vue?vue&type=script&lang=ts&\"\nexport * from \"./Spreadsheet.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Spreadsheet.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('1f1f2a99')) {\n      api.createRecord('1f1f2a99', component.options)\n    } else {\n      api.reload('1f1f2a99', component.options)\n    }\n    module.hot.accept(\"./Spreadsheet.vue?vue&type=template&id=1f1f2a99&lang=pug&\", function () {\n      api.rerender('1f1f2a99', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/panels/spreadsheet/Spreadsheet.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Spreadsheet.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Spreadsheet.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Panel.Spreadsheet .ag-theme-balham{height:100%}.Panel.Spreadsheet .spreadsheet-drop-down-container{position:relative;cursor:pointer;display:inline-block}.Panel.Spreadsheet .spreadsheet-drop-down-container:hover .spreadsheet-drop-down-label{color:#7b7b7b;background-color:#111}.Panel.Spreadsheet .spreadsheet-drop-down-container:hover .spreadsheet-drop-down-content{display:block}.Panel.Spreadsheet .spreadsheet-drop-down-container .spreadsheet-drop-down-label{padding:2px 5px;margin:2px;display:inline-block;background-color:#6e6e6e;border:1px solid #464646;border-radius:3px}.Panel.Spreadsheet .spreadsheet-drop-down-container .spreadsheet-drop-down-content{display:none;z-index:100;position:absolute;top:100%;left:10px;width:auto;background-color:#7b7b7b;border:1px solid #464646}.Panel.Spreadsheet .spreadsheet-drop-down-container .spreadsheet-drop-down-content .spreadsheet-drop-down-separator{padding:10px 0px}.Panel.Spreadsheet .spreadsheet-drop-down-container .spreadsheet-drop-down-content .spreadsheet-drop-down-entry{min-width:100px;padding:2px 5px}.Panel.Spreadsheet .spreadsheet-drop-down-container .spreadsheet-drop-down-content .spreadsheet-drop-down-entry:hover{background-color:#6e6e6e}.Panel.Spreadsheet .spreadsheet-drop-down-container .spreadsheet-drop-down-content .spreadsheet-drop-down-entry .attr-selection-icon{display:inline-block;position:relative;top:3px}.Panel.Spreadsheet .spreadsheet-drop-down-container .spreadsheet-drop-down-content .spreadsheet-drop-down-entry .attr-name{display:inline-block;margin-left:5px}.Panel.Spreadsheet .attrib-class-selectors{margin-left:20px}.Panel.Spreadsheet .attrib-class-selectors .attrib-class-selector{display:inline-block;margin-left:2px;border:1px solid #111;border-radius:5px;padding:2px 10px;cursor:pointer}.Panel.Spreadsheet .attrib-class-selectors .attrib-class-selector:hover{background-color:#616161}.Panel.Spreadsheet .attrib-class-selectors .attrib-class-selector.active{background-color:#1673b1;color:#7b7b7b}.Panel.Spreadsheet .attrib-class-selectors .attrib-class-selector svg{position:relative;top:2px}.Panel.Spreadsheet .row-odd{background-color:#e6e6e6}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Multiple.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Multiple.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Panel{background-color:#7b7b7b}.Panel.Network{background-color:#a59ab6}.Panel.Params{background-color:#a3d9b7}.Panel.ParamEdit{background-color:#d9efe1}.Panel.Viewer{background-color:#96bcd5}.Panel.Performance{background-color:#e6e61a}.Panel.Asset{background-color:#d5c596}.Panel.Spreadsheet{background-color:#d096c9}.Panel.CustomNodeEditor{background-color:#4d8eb8}.Panel.Multiple .split_panel_separator{min-width:4px;min-height:4px;background-color:transparent}.Panel.Multiple .split_panel_separator:hover{background-color:#497a9b}.Panel.Multiple .split-panel-horizontal,.Panel.Multiple .split-panel-vertical{position:relative}.Panel.Multiple .split-panel-horizontal>.split_panel_separator{position:absolute;top:0px;height:100%;cursor:ew-resize}.Panel.Multiple .split-panel-horizontal>.split_panel_separator .split_panel_separator_line{width:1px;height:100%;background-color:#1779ba}.Panel.Multiple .split-panel-vertical>.split_panel_separator{position:absolute;left:0px;width:100%;cursor:ns-resize;transform:translateY(-100%)}.Panel.Multiple .split-panel-vertical>.split_panel_separator .split_panel_separator_line{position:relative;top:4px;height:1px;background-color:#1779ba}.Panel.Multiple .panel_tabs{padding-left:5px}.Panel.Multiple .panel_tabs ul.tab_list{position:relative;top:3px;margin:0px}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container{display:inline-block;margin-left:4px;font-size:.75rem;cursor:pointer;background-color:#7b7b7b;border:1px solid #484848;border-bottom:0px;border-top-left-radius:3px;border-top-right-radius:3px;color:#333}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.network{background-color:#a59ab6}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.params{background-color:#a3d9b7}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.param_edit{background-color:#d9efe1}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.viewer{background-color:#96bcd5}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.performance{background-color:#e6e61a}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.asset{background-color:#d5c596}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.spreadsheet{background-color:#d096c9}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.custom_node_editor{background-color:#4d8eb8}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.new_panel{background-color:#949494}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container.active{color:#000;padding-bottom:4px;top:-3px;position:relative}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container .tab_item{padding:0px 5px}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container .tab_item .panel_type_close{margin-left:5px;position:relative;top:1px}.Panel.Multiple .panel_tabs ul.tab_list li.tab_item_container .tab_item .panel_type_close:hover{opacity:.6}.Panel.Multiple .panel_tabs .split_menu_container_container{position:relative}.Panel.Multiple .panel_tabs .split_menu_container_container .split_menu_container{background-color:#949494;position:absolute;top:5px;right:4px;border-radius:20px;border:1px solid #000;line-height:1}.Panel.Multiple .panel_tabs .split_menu_container_container .split_menu_container .dropdown_menu_label{top:-1px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Navigation.vue?vue&type=template&id=3ad40df0&lang=pug&\"\nimport script from \"./Navigation.vue?vue&type=script&lang=ts&\"\nexport * from \"./Navigation.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Navigation.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('3ad40df0')) {\n      api.createRecord('3ad40df0', component.options)\n    } else {\n      api.reload('3ad40df0', component.options)\n    }\n    module.hot.accept(\"./Navigation.vue?vue&type=template&id=3ad40df0&lang=pug&\", function () {\n      api.rerender('3ad40df0', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/editor/top/Navigation.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navigation.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NavigationBar{background-color:#7b7b7b;font-size:.8rem}.NavigationBar ul.path_elements,.NavigationBar .button-group{padding:2px 2px}.NavigationBar .button-group{margin:0px 5px}.NavigationBar .button-group .button{margin-top:4px;margin-bottom:0px;line-height:0;padding:4px 4px}.NavigationBar .button-group .button.backward{margin-left:0px}.NavigationBar .button-group .button.forward{margin-left:2px}.NavigationBar ul.path_elements{margin:2px;border-radius:3px;background-color:#aeaeae}.NavigationBar ul.path_elements .path_element{display:inline-block}.NavigationBar ul.path_elements .path_element:not(:last-child) .path_element_name{margin-left:5px;background-color:#949494}.NavigationBar ul.path_elements .path_element:not(:last-child) .path_element_name:hover{cursor:pointer;background-color:gray;opacity:.75}.NavigationBar ul.path_elements .path_element .path_element_name,.NavigationBar ul.path_elements .path_element .path_separator{padding:5px;display:inline-block}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./PlayBar.vue?vue&type=template&id=06281ded&lang=pug&\"\nimport script from \"./PlayBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./PlayBar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./PlayBar.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('06281ded')) {\n      api.createRecord('06281ded', component.options)\n    } else {\n      api.reload('06281ded', component.options)\n    }\n    module.hot.accept(\"./PlayBar.vue?vue&type=template&id=06281ded&lang=pug&\", function () {\n      api.rerender('06281ded', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/editor/widgets/PlayBar.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlayBar.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlayBar.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Bar.Play input,.Bar.Play .button{margin-bottom:0px}.Bar.Play .button{padding:.5em 1em}.Bar.Play .play_bar_scrubber{position:relative;cursor:pointer;background-color:#bababa;overflow:hidden}.Bar.Play .play_bar_scrubber .frame_indicator{position:absolute;top:0px;height:100%;min-width:10px;background-color:#6294b5}.Bar.Play .play_bar_scrubber .frame_indicator:hover{background-color:#739fbd}.Bar.Play .play_bar_buttons_container{padding:5px}.Bar.Play .play_bar_buttons_container .play_bar_buttons{margin:0px 10px}.Bar.Play input[type=number]{display:inline-block;margin-bottom:0;padding:2px;text-align:right;height:auto;width:80px}.Bar.Play .frame-range input{margin-left:1px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./PanelNodeSelector.vue?vue&type=template&id=058e1753&lang=pug&\"\nimport script from \"./PanelNodeSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./PanelNodeSelector.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./PanelNodeSelector.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('058e1753')) {\n      api.createRecord('058e1753', component.options)\n    } else {\n      api.reload('058e1753', component.options)\n    }\n    module.hot.accept(\"./PanelNodeSelector.vue?vue&type=template&id=058e1753&lang=pug&\", function () {\n      api.rerender('058e1753', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/editor/widgets/PanelNodeSelector.vue\"\nexport default component.exports","import mod from \"-!../../../../node_modules/vue-style-loader/index.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeTree.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../node_modules/vue-style-loader/index.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeTree.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NodeTree{margin-bottom:5px}.NodeTree.selected .node_name{background-color:#62a9d0}.NodeTree .expand_button{cursor:pointer;padding:0px 5px}.NodeTree .expand_button:hover{opacity:.8}.NodeTree .node_name{cursor:pointer;padding:0px 5px}.NodeTree .node_name:hover{background-color:#8fc5dd}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PanelNodeSelector.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PanelNodeSelector.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NodeSelector{background-color:red}.NodeSelector .buttons{margin-bottom:10px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./NumericSlider.vue?vue&type=template&id=3f81e4a4&lang=pug&\"\nimport script from \"./NumericSlider.vue?vue&type=script&lang=ts&\"\nexport * from \"./NumericSlider.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./NumericSlider.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('3f81e4a4')) {\n      api.createRecord('3f81e4a4', component.options)\n    } else {\n      api.reload('3f81e4a4', component.options)\n    }\n    module.hot.accept(\"./NumericSlider.vue?vue&type=template&id=3f81e4a4&lang=pug&\", function () {\n      api.rerender('3f81e4a4', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/NumericSlider.vue\"\nexport default component.exports","import mod from \"-!../../../../node_modules/vue-style-loader/index.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumericSlider.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../node_modules/vue-style-loader/index.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumericSlider.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".NumericSlider{position:absolute;z-index:999;width:0px;height:0px}.NumericSlider .increment_starters_container{position:absolute;top:-175px;left:-25px;border:1px solid #fff}.NumericSlider .increment_starters_container.integer{top:-125px}.NumericSlider .increment_starters_container .increment_starter{background-color:#000;color:#fff;width:50px;height:50px;border-bottom:1px solid #fff;padding:5px}.NumericSlider .increment_starters_container .increment_starter:hover,.NumericSlider .increment_starters_container .increment_starter.active{background-color:#ff0;color:#000}.NumericSlider .increment_starters_container .increment_starter.inactive .increment_label{top:10px}.NumericSlider .increment_starters_container .increment_starter .increment_label,.NumericSlider .increment_starters_container .increment_starter .value_label{position:relative;font-size:.7rem}.NumericSlider .increment_starters_container .increment_starter .value_label{top:5px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./NodeContextMenu.vue?vue&type=template&id=be934afe&lang=pug&\"\nimport script from \"./NodeContextMenu.vue?vue&type=script&lang=ts&\"\nexport * from \"./NodeContextMenu.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./NodeContextMenu.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('be934afe')) {\n      api.createRecord('be934afe', component.options)\n    } else {\n      api.reload('be934afe', component.options)\n    }\n    module.hot.accept(\"./NodeContextMenu.vue?vue&type=template&id=be934afe&lang=pug&\", function () {\n      api.rerender('be934afe', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/context_menus/NodeContextMenu.vue\"\nexport default component.exports","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class NodeSetCommentCommand extends BaseCommand {\n\tprivate _old_comment: string | undefined;\n\n\tconstructor(private _node: BaseNodeType, private _new_comment: string) {\n\t\tsuper();\n\t\tthis._old_comment = this._node.ui_data.comment;\n\t}\n\n\tdo() {\n\t\tthis._node.ui_data.set_comment(this._new_comment);\n\t}\n\n\tundo() {\n\t\tthis._node.ui_data.set_comment(this._old_comment);\n\t}\n}\n","import {BaseCommand} from './_Base';\nimport {BaseNodeType} from 'src/engine/nodes/_Base';\n\nexport class NodeSetOverrideClonableStateCommand extends BaseCommand {\n\tprivate _old_state: boolean;\n\n\tconstructor(private _node: BaseNodeType, private _new_state: boolean) {\n\t\tsuper();\n\t\tthis._old_state = this._node.io.inputs.override_clonable_state();\n\t}\n\n\tdo() {\n\t\tthis._node.io.inputs.set_override_clonable_state(this._new_state);\n\t}\n\n\tundo() {\n\t\tthis._node.io.inputs.set_override_clonable_state(this._old_state);\n\t}\n}\n","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeContextMenu.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NodeContextMenu.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".ParamMenu{position:absolute}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./ParamContextMenu.vue?vue&type=template&id=e9fcae08&lang=pug&\"\nimport script from \"./ParamContextMenu.vue?vue&type=script&lang=ts&\"\nexport * from \"./ParamContextMenu.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ParamContextMenu.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('e9fcae08')) {\n      api.createRecord('e9fcae08', component.options)\n    } else {\n      api.reload('e9fcae08', component.options)\n    }\n    module.hot.accept(\"./ParamContextMenu.vue?vue&type=template&id=e9fcae08&lang=pug&\", function () {\n      api.rerender('e9fcae08', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/widgets/context_menus/ParamContextMenu.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamContextMenu.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParamContextMenu.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".ParamMenu{position:absolute}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { render, staticRenderFns } from \"./Retractable.vue?vue&type=template&id=146d1eee&lang=pug&\"\nimport script from \"./Retractable.vue?vue&type=script&lang=ts&\"\nexport * from \"./Retractable.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Retractable.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/gui/work/web/polygonjs/dev/polygonjs-editor/app/javascript/polygonjs-engine/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('146d1eee')) {\n      api.createRecord('146d1eee', component.options)\n    } else {\n      api.reload('146d1eee', component.options)\n    }\n    module.hot.accept(\"./Retractable.vue?vue&type=template&id=146d1eee&lang=pug&\", function () {\n      api.rerender('146d1eee', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/editor/components/editor/widgets/Retractable.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Retractable.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../../node_modules/vue-style-loader/index.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Retractable.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".Retractable .retractable-toggler{background-color:red;cursor:pointer;opacity:.5}.Retractable .retractable-toggler:hover{opacity:1}.Retractable .retractable-toggler.horizontal{width:100%;height:5px}.Retractable .retractable-toggler.vertical{width:5px;height:100%}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import mod from \"-!../../../../node_modules/vue-style-loader/index.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../../../node_modules/vue-style-loader/index.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js??ref--4-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=sass&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"/*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}.foundation-mq{font-family:\\\"small=0em&medium=40em&large=64em&xlarge=75em&xxlarge=90em\\\"}html{box-sizing:border-box;font-size:100%}*,*::before,*::after{box-sizing:inherit}body{margin:0;padding:0;background:#fefefe;font-family:\\\"Helvetica Neue\\\",Helvetica,Roboto,Arial,sans-serif;font-weight:normal;line-height:1.5;color:#0a0a0a;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}img{display:inline-block;vertical-align:middle;max-width:100%;height:auto;-ms-interpolation-mode:bicubic}textarea{height:auto;min-height:50px;border-radius:0}select{box-sizing:border-box;width:100%;border-radius:0}.map_canvas img,.map_canvas embed,.map_canvas object,.mqa-display img,.mqa-display embed,.mqa-display object{max-width:none !important}button{padding:0;appearance:none;border:0;border-radius:0;background:transparent;line-height:1;cursor:auto}[data-whatinput=mouse] button{outline:0}pre{overflow:auto}button,input,optgroup,select,textarea{font-family:inherit}.is-visible{display:block !important}.is-hidden{display:none !important}.grid-container{padding-right:0.625rem;padding-left:0.625rem;max-width:75rem;margin-left:auto;margin-right:auto}@media print,screen and (min-width: 40em){.grid-container{padding-right:0.9375rem;padding-left:0.9375rem}}.grid-container.fluid{padding-right:0.625rem;padding-left:0.625rem;max-width:100%;margin-left:auto;margin-right:auto}@media print,screen and (min-width: 40em){.grid-container.fluid{padding-right:0.9375rem;padding-left:0.9375rem}}.grid-container.full{padding-right:0;padding-left:0;max-width:100%;margin-left:auto;margin-right:auto}.grid-x{display:flex;flex-flow:row wrap}.cell{flex:0 0 auto;min-height:0px;min-width:0px;width:100%}.cell.auto{flex:1 1 0px}.cell.shrink{flex:0 0 auto}.grid-x>.auto{width:auto}.grid-x>.shrink{width:auto}.grid-x>.small-shrink,.grid-x>.small-full,.grid-x>.small-1,.grid-x>.small-2,.grid-x>.small-3,.grid-x>.small-4,.grid-x>.small-5,.grid-x>.small-6,.grid-x>.small-7,.grid-x>.small-8,.grid-x>.small-9,.grid-x>.small-10,.grid-x>.small-11,.grid-x>.small-12{flex-basis:auto}@media print,screen and (min-width: 40em){.grid-x>.medium-shrink,.grid-x>.medium-full,.grid-x>.medium-1,.grid-x>.medium-2,.grid-x>.medium-3,.grid-x>.medium-4,.grid-x>.medium-5,.grid-x>.medium-6,.grid-x>.medium-7,.grid-x>.medium-8,.grid-x>.medium-9,.grid-x>.medium-10,.grid-x>.medium-11,.grid-x>.medium-12{flex-basis:auto}}@media print,screen and (min-width: 64em){.grid-x>.large-shrink,.grid-x>.large-full,.grid-x>.large-1,.grid-x>.large-2,.grid-x>.large-3,.grid-x>.large-4,.grid-x>.large-5,.grid-x>.large-6,.grid-x>.large-7,.grid-x>.large-8,.grid-x>.large-9,.grid-x>.large-10,.grid-x>.large-11,.grid-x>.large-12{flex-basis:auto}}.grid-x>.small-12,.grid-x>.small-11,.grid-x>.small-10,.grid-x>.small-9,.grid-x>.small-8,.grid-x>.small-7,.grid-x>.small-6,.grid-x>.small-5,.grid-x>.small-4,.grid-x>.small-3,.grid-x>.small-2,.grid-x>.small-1{flex:0 0 auto}.grid-x>.small-1{width:8.3333333333%}.grid-x>.small-2{width:16.6666666667%}.grid-x>.small-3{width:25%}.grid-x>.small-4{width:33.3333333333%}.grid-x>.small-5{width:41.6666666667%}.grid-x>.small-6{width:50%}.grid-x>.small-7{width:58.3333333333%}.grid-x>.small-8{width:66.6666666667%}.grid-x>.small-9{width:75%}.grid-x>.small-10{width:83.3333333333%}.grid-x>.small-11{width:91.6666666667%}.grid-x>.small-12{width:100%}@media print,screen and (min-width: 40em){.grid-x>.medium-auto{flex:1 1 0px;width:auto}.grid-x>.medium-12,.grid-x>.medium-11,.grid-x>.medium-10,.grid-x>.medium-9,.grid-x>.medium-8,.grid-x>.medium-7,.grid-x>.medium-6,.grid-x>.medium-5,.grid-x>.medium-4,.grid-x>.medium-3,.grid-x>.medium-2,.grid-x>.medium-1,.grid-x>.medium-shrink{flex:0 0 auto}.grid-x>.medium-shrink{width:auto}.grid-x>.medium-1{width:8.3333333333%}.grid-x>.medium-2{width:16.6666666667%}.grid-x>.medium-3{width:25%}.grid-x>.medium-4{width:33.3333333333%}.grid-x>.medium-5{width:41.6666666667%}.grid-x>.medium-6{width:50%}.grid-x>.medium-7{width:58.3333333333%}.grid-x>.medium-8{width:66.6666666667%}.grid-x>.medium-9{width:75%}.grid-x>.medium-10{width:83.3333333333%}.grid-x>.medium-11{width:91.6666666667%}.grid-x>.medium-12{width:100%}}@media print,screen and (min-width: 64em){.grid-x>.large-auto{flex:1 1 0px;width:auto}.grid-x>.large-12,.grid-x>.large-11,.grid-x>.large-10,.grid-x>.large-9,.grid-x>.large-8,.grid-x>.large-7,.grid-x>.large-6,.grid-x>.large-5,.grid-x>.large-4,.grid-x>.large-3,.grid-x>.large-2,.grid-x>.large-1,.grid-x>.large-shrink{flex:0 0 auto}.grid-x>.large-shrink{width:auto}.grid-x>.large-1{width:8.3333333333%}.grid-x>.large-2{width:16.6666666667%}.grid-x>.large-3{width:25%}.grid-x>.large-4{width:33.3333333333%}.grid-x>.large-5{width:41.6666666667%}.grid-x>.large-6{width:50%}.grid-x>.large-7{width:58.3333333333%}.grid-x>.large-8{width:66.6666666667%}.grid-x>.large-9{width:75%}.grid-x>.large-10{width:83.3333333333%}.grid-x>.large-11{width:91.6666666667%}.grid-x>.large-12{width:100%}}.grid-margin-x:not(.grid-x)>.cell{width:auto}.grid-margin-y:not(.grid-y)>.cell{height:auto}.grid-margin-x{margin-left:-0.625rem;margin-right:-0.625rem}@media print,screen and (min-width: 40em){.grid-margin-x{margin-left:-0.9375rem;margin-right:-0.9375rem}}.grid-margin-x>.cell{width:calc(100% - 1.25rem);margin-left:0.625rem;margin-right:0.625rem}@media print,screen and (min-width: 40em){.grid-margin-x>.cell{width:calc(100% - 1.875rem);margin-left:0.9375rem;margin-right:0.9375rem}}.grid-margin-x>.auto{width:auto}.grid-margin-x>.shrink{width:auto}.grid-margin-x>.small-1{width:calc(8.3333333333% - 1.25rem)}.grid-margin-x>.small-2{width:calc(16.6666666667% - 1.25rem)}.grid-margin-x>.small-3{width:calc(25% - 1.25rem)}.grid-margin-x>.small-4{width:calc(33.3333333333% - 1.25rem)}.grid-margin-x>.small-5{width:calc(41.6666666667% - 1.25rem)}.grid-margin-x>.small-6{width:calc(50% - 1.25rem)}.grid-margin-x>.small-7{width:calc(58.3333333333% - 1.25rem)}.grid-margin-x>.small-8{width:calc(66.6666666667% - 1.25rem)}.grid-margin-x>.small-9{width:calc(75% - 1.25rem)}.grid-margin-x>.small-10{width:calc(83.3333333333% - 1.25rem)}.grid-margin-x>.small-11{width:calc(91.6666666667% - 1.25rem)}.grid-margin-x>.small-12{width:calc(100% - 1.25rem)}@media print,screen and (min-width: 40em){.grid-margin-x>.auto{width:auto}.grid-margin-x>.shrink{width:auto}.grid-margin-x>.small-1{width:calc(8.3333333333% - 1.875rem)}.grid-margin-x>.small-2{width:calc(16.6666666667% - 1.875rem)}.grid-margin-x>.small-3{width:calc(25% - 1.875rem)}.grid-margin-x>.small-4{width:calc(33.3333333333% - 1.875rem)}.grid-margin-x>.small-5{width:calc(41.6666666667% - 1.875rem)}.grid-margin-x>.small-6{width:calc(50% - 1.875rem)}.grid-margin-x>.small-7{width:calc(58.3333333333% - 1.875rem)}.grid-margin-x>.small-8{width:calc(66.6666666667% - 1.875rem)}.grid-margin-x>.small-9{width:calc(75% - 1.875rem)}.grid-margin-x>.small-10{width:calc(83.3333333333% - 1.875rem)}.grid-margin-x>.small-11{width:calc(91.6666666667% - 1.875rem)}.grid-margin-x>.small-12{width:calc(100% - 1.875rem)}.grid-margin-x>.medium-auto{width:auto}.grid-margin-x>.medium-shrink{width:auto}.grid-margin-x>.medium-1{width:calc(8.3333333333% - 1.875rem)}.grid-margin-x>.medium-2{width:calc(16.6666666667% - 1.875rem)}.grid-margin-x>.medium-3{width:calc(25% - 1.875rem)}.grid-margin-x>.medium-4{width:calc(33.3333333333% - 1.875rem)}.grid-margin-x>.medium-5{width:calc(41.6666666667% - 1.875rem)}.grid-margin-x>.medium-6{width:calc(50% - 1.875rem)}.grid-margin-x>.medium-7{width:calc(58.3333333333% - 1.875rem)}.grid-margin-x>.medium-8{width:calc(66.6666666667% - 1.875rem)}.grid-margin-x>.medium-9{width:calc(75% - 1.875rem)}.grid-margin-x>.medium-10{width:calc(83.3333333333% - 1.875rem)}.grid-margin-x>.medium-11{width:calc(91.6666666667% - 1.875rem)}.grid-margin-x>.medium-12{width:calc(100% - 1.875rem)}}@media print,screen and (min-width: 64em){.grid-margin-x>.large-auto{width:auto}.grid-margin-x>.large-shrink{width:auto}.grid-margin-x>.large-1{width:calc(8.3333333333% - 1.875rem)}.grid-margin-x>.large-2{width:calc(16.6666666667% - 1.875rem)}.grid-margin-x>.large-3{width:calc(25% - 1.875rem)}.grid-margin-x>.large-4{width:calc(33.3333333333% - 1.875rem)}.grid-margin-x>.large-5{width:calc(41.6666666667% - 1.875rem)}.grid-margin-x>.large-6{width:calc(50% - 1.875rem)}.grid-margin-x>.large-7{width:calc(58.3333333333% - 1.875rem)}.grid-margin-x>.large-8{width:calc(66.6666666667% - 1.875rem)}.grid-margin-x>.large-9{width:calc(75% - 1.875rem)}.grid-margin-x>.large-10{width:calc(83.3333333333% - 1.875rem)}.grid-margin-x>.large-11{width:calc(91.6666666667% - 1.875rem)}.grid-margin-x>.large-12{width:calc(100% - 1.875rem)}}.grid-padding-x .grid-padding-x{margin-right:-0.625rem;margin-left:-0.625rem}@media print,screen and (min-width: 40em){.grid-padding-x .grid-padding-x{margin-right:-0.9375rem;margin-left:-0.9375rem}}.grid-container:not(.full)>.grid-padding-x{margin-right:-0.625rem;margin-left:-0.625rem}@media print,screen and (min-width: 40em){.grid-container:not(.full)>.grid-padding-x{margin-right:-0.9375rem;margin-left:-0.9375rem}}.grid-padding-x>.cell{padding-right:0.625rem;padding-left:0.625rem}@media print,screen and (min-width: 40em){.grid-padding-x>.cell{padding-right:0.9375rem;padding-left:0.9375rem}}.small-up-1>.cell{width:100%}.small-up-2>.cell{width:50%}.small-up-3>.cell{width:33.3333333333%}.small-up-4>.cell{width:25%}.small-up-5>.cell{width:20%}.small-up-6>.cell{width:16.6666666667%}.small-up-7>.cell{width:14.2857142857%}.small-up-8>.cell{width:12.5%}@media print,screen and (min-width: 40em){.medium-up-1>.cell{width:100%}.medium-up-2>.cell{width:50%}.medium-up-3>.cell{width:33.3333333333%}.medium-up-4>.cell{width:25%}.medium-up-5>.cell{width:20%}.medium-up-6>.cell{width:16.6666666667%}.medium-up-7>.cell{width:14.2857142857%}.medium-up-8>.cell{width:12.5%}}@media print,screen and (min-width: 64em){.large-up-1>.cell{width:100%}.large-up-2>.cell{width:50%}.large-up-3>.cell{width:33.3333333333%}.large-up-4>.cell{width:25%}.large-up-5>.cell{width:20%}.large-up-6>.cell{width:16.6666666667%}.large-up-7>.cell{width:14.2857142857%}.large-up-8>.cell{width:12.5%}}.grid-margin-x.small-up-1>.cell{width:calc(100% - 1.25rem)}.grid-margin-x.small-up-2>.cell{width:calc(50% - 1.25rem)}.grid-margin-x.small-up-3>.cell{width:calc(33.3333333333% - 1.25rem)}.grid-margin-x.small-up-4>.cell{width:calc(25% - 1.25rem)}.grid-margin-x.small-up-5>.cell{width:calc(20% - 1.25rem)}.grid-margin-x.small-up-6>.cell{width:calc(16.6666666667% - 1.25rem)}.grid-margin-x.small-up-7>.cell{width:calc(14.2857142857% - 1.25rem)}.grid-margin-x.small-up-8>.cell{width:calc(12.5% - 1.25rem)}@media print,screen and (min-width: 40em){.grid-margin-x.small-up-1>.cell{width:calc(100% - 1.875rem)}.grid-margin-x.small-up-2>.cell{width:calc(50% - 1.875rem)}.grid-margin-x.small-up-3>.cell{width:calc(33.3333333333% - 1.875rem)}.grid-margin-x.small-up-4>.cell{width:calc(25% - 1.875rem)}.grid-margin-x.small-up-5>.cell{width:calc(20% - 1.875rem)}.grid-margin-x.small-up-6>.cell{width:calc(16.6666666667% - 1.875rem)}.grid-margin-x.small-up-7>.cell{width:calc(14.2857142857% - 1.875rem)}.grid-margin-x.small-up-8>.cell{width:calc(12.5% - 1.875rem)}.grid-margin-x.medium-up-1>.cell{width:calc(100% - 1.875rem)}.grid-margin-x.medium-up-2>.cell{width:calc(50% - 1.875rem)}.grid-margin-x.medium-up-3>.cell{width:calc(33.3333333333% - 1.875rem)}.grid-margin-x.medium-up-4>.cell{width:calc(25% - 1.875rem)}.grid-margin-x.medium-up-5>.cell{width:calc(20% - 1.875rem)}.grid-margin-x.medium-up-6>.cell{width:calc(16.6666666667% - 1.875rem)}.grid-margin-x.medium-up-7>.cell{width:calc(14.2857142857% - 1.875rem)}.grid-margin-x.medium-up-8>.cell{width:calc(12.5% - 1.875rem)}}@media print,screen and (min-width: 64em){.grid-margin-x.large-up-1>.cell{width:calc(100% - 1.875rem)}.grid-margin-x.large-up-2>.cell{width:calc(50% - 1.875rem)}.grid-margin-x.large-up-3>.cell{width:calc(33.3333333333% - 1.875rem)}.grid-margin-x.large-up-4>.cell{width:calc(25% - 1.875rem)}.grid-margin-x.large-up-5>.cell{width:calc(20% - 1.875rem)}.grid-margin-x.large-up-6>.cell{width:calc(16.6666666667% - 1.875rem)}.grid-margin-x.large-up-7>.cell{width:calc(14.2857142857% - 1.875rem)}.grid-margin-x.large-up-8>.cell{width:calc(12.5% - 1.875rem)}}.small-margin-collapse{margin-right:0;margin-left:0}.small-margin-collapse>.cell{margin-right:0;margin-left:0}.small-margin-collapse>.small-1{width:8.3333333333%}.small-margin-collapse>.small-2{width:16.6666666667%}.small-margin-collapse>.small-3{width:25%}.small-margin-collapse>.small-4{width:33.3333333333%}.small-margin-collapse>.small-5{width:41.6666666667%}.small-margin-collapse>.small-6{width:50%}.small-margin-collapse>.small-7{width:58.3333333333%}.small-margin-collapse>.small-8{width:66.6666666667%}.small-margin-collapse>.small-9{width:75%}.small-margin-collapse>.small-10{width:83.3333333333%}.small-margin-collapse>.small-11{width:91.6666666667%}.small-margin-collapse>.small-12{width:100%}@media print,screen and (min-width: 40em){.small-margin-collapse>.medium-1{width:8.3333333333%}.small-margin-collapse>.medium-2{width:16.6666666667%}.small-margin-collapse>.medium-3{width:25%}.small-margin-collapse>.medium-4{width:33.3333333333%}.small-margin-collapse>.medium-5{width:41.6666666667%}.small-margin-collapse>.medium-6{width:50%}.small-margin-collapse>.medium-7{width:58.3333333333%}.small-margin-collapse>.medium-8{width:66.6666666667%}.small-margin-collapse>.medium-9{width:75%}.small-margin-collapse>.medium-10{width:83.3333333333%}.small-margin-collapse>.medium-11{width:91.6666666667%}.small-margin-collapse>.medium-12{width:100%}}@media print,screen and (min-width: 64em){.small-margin-collapse>.large-1{width:8.3333333333%}.small-margin-collapse>.large-2{width:16.6666666667%}.small-margin-collapse>.large-3{width:25%}.small-margin-collapse>.large-4{width:33.3333333333%}.small-margin-collapse>.large-5{width:41.6666666667%}.small-margin-collapse>.large-6{width:50%}.small-margin-collapse>.large-7{width:58.3333333333%}.small-margin-collapse>.large-8{width:66.6666666667%}.small-margin-collapse>.large-9{width:75%}.small-margin-collapse>.large-10{width:83.3333333333%}.small-margin-collapse>.large-11{width:91.6666666667%}.small-margin-collapse>.large-12{width:100%}}.small-padding-collapse{margin-right:0;margin-left:0}.small-padding-collapse>.cell{padding-right:0;padding-left:0}@media print,screen and (min-width: 40em){.medium-margin-collapse{margin-right:0;margin-left:0}.medium-margin-collapse>.cell{margin-right:0;margin-left:0}}@media print,screen and (min-width: 40em){.medium-margin-collapse>.small-1{width:8.3333333333%}.medium-margin-collapse>.small-2{width:16.6666666667%}.medium-margin-collapse>.small-3{width:25%}.medium-margin-collapse>.small-4{width:33.3333333333%}.medium-margin-collapse>.small-5{width:41.6666666667%}.medium-margin-collapse>.small-6{width:50%}.medium-margin-collapse>.small-7{width:58.3333333333%}.medium-margin-collapse>.small-8{width:66.6666666667%}.medium-margin-collapse>.small-9{width:75%}.medium-margin-collapse>.small-10{width:83.3333333333%}.medium-margin-collapse>.small-11{width:91.6666666667%}.medium-margin-collapse>.small-12{width:100%}}@media print,screen and (min-width: 40em){.medium-margin-collapse>.medium-1{width:8.3333333333%}.medium-margin-collapse>.medium-2{width:16.6666666667%}.medium-margin-collapse>.medium-3{width:25%}.medium-margin-collapse>.medium-4{width:33.3333333333%}.medium-margin-collapse>.medium-5{width:41.6666666667%}.medium-margin-collapse>.medium-6{width:50%}.medium-margin-collapse>.medium-7{width:58.3333333333%}.medium-margin-collapse>.medium-8{width:66.6666666667%}.medium-margin-collapse>.medium-9{width:75%}.medium-margin-collapse>.medium-10{width:83.3333333333%}.medium-margin-collapse>.medium-11{width:91.6666666667%}.medium-margin-collapse>.medium-12{width:100%}}@media print,screen and (min-width: 64em){.medium-margin-collapse>.large-1{width:8.3333333333%}.medium-margin-collapse>.large-2{width:16.6666666667%}.medium-margin-collapse>.large-3{width:25%}.medium-margin-collapse>.large-4{width:33.3333333333%}.medium-margin-collapse>.large-5{width:41.6666666667%}.medium-margin-collapse>.large-6{width:50%}.medium-margin-collapse>.large-7{width:58.3333333333%}.medium-margin-collapse>.large-8{width:66.6666666667%}.medium-margin-collapse>.large-9{width:75%}.medium-margin-collapse>.large-10{width:83.3333333333%}.medium-margin-collapse>.large-11{width:91.6666666667%}.medium-margin-collapse>.large-12{width:100%}}@media print,screen and (min-width: 40em){.medium-padding-collapse{margin-right:0;margin-left:0}.medium-padding-collapse>.cell{padding-right:0;padding-left:0}}@media print,screen and (min-width: 64em){.large-margin-collapse{margin-right:0;margin-left:0}.large-margin-collapse>.cell{margin-right:0;margin-left:0}}@media print,screen and (min-width: 64em){.large-margin-collapse>.small-1{width:8.3333333333%}.large-margin-collapse>.small-2{width:16.6666666667%}.large-margin-collapse>.small-3{width:25%}.large-margin-collapse>.small-4{width:33.3333333333%}.large-margin-collapse>.small-5{width:41.6666666667%}.large-margin-collapse>.small-6{width:50%}.large-margin-collapse>.small-7{width:58.3333333333%}.large-margin-collapse>.small-8{width:66.6666666667%}.large-margin-collapse>.small-9{width:75%}.large-margin-collapse>.small-10{width:83.3333333333%}.large-margin-collapse>.small-11{width:91.6666666667%}.large-margin-collapse>.small-12{width:100%}}@media print,screen and (min-width: 64em){.large-margin-collapse>.medium-1{width:8.3333333333%}.large-margin-collapse>.medium-2{width:16.6666666667%}.large-margin-collapse>.medium-3{width:25%}.large-margin-collapse>.medium-4{width:33.3333333333%}.large-margin-collapse>.medium-5{width:41.6666666667%}.large-margin-collapse>.medium-6{width:50%}.large-margin-collapse>.medium-7{width:58.3333333333%}.large-margin-collapse>.medium-8{width:66.6666666667%}.large-margin-collapse>.medium-9{width:75%}.large-margin-collapse>.medium-10{width:83.3333333333%}.large-margin-collapse>.medium-11{width:91.6666666667%}.large-margin-collapse>.medium-12{width:100%}}@media print,screen and (min-width: 64em){.large-margin-collapse>.large-1{width:8.3333333333%}.large-margin-collapse>.large-2{width:16.6666666667%}.large-margin-collapse>.large-3{width:25%}.large-margin-collapse>.large-4{width:33.3333333333%}.large-margin-collapse>.large-5{width:41.6666666667%}.large-margin-collapse>.large-6{width:50%}.large-margin-collapse>.large-7{width:58.3333333333%}.large-margin-collapse>.large-8{width:66.6666666667%}.large-margin-collapse>.large-9{width:75%}.large-margin-collapse>.large-10{width:83.3333333333%}.large-margin-collapse>.large-11{width:91.6666666667%}.large-margin-collapse>.large-12{width:100%}}@media print,screen and (min-width: 64em){.large-padding-collapse{margin-right:0;margin-left:0}.large-padding-collapse>.cell{padding-right:0;padding-left:0}}.small-offset-0{margin-left:0%}.grid-margin-x>.small-offset-0{margin-left:calc(0% + 0.625rem)}.small-offset-1{margin-left:8.3333333333%}.grid-margin-x>.small-offset-1{margin-left:calc(8.3333333333% + 0.625rem)}.small-offset-2{margin-left:16.6666666667%}.grid-margin-x>.small-offset-2{margin-left:calc(16.6666666667% + 0.625rem)}.small-offset-3{margin-left:25%}.grid-margin-x>.small-offset-3{margin-left:calc(25% + 0.625rem)}.small-offset-4{margin-left:33.3333333333%}.grid-margin-x>.small-offset-4{margin-left:calc(33.3333333333% + 0.625rem)}.small-offset-5{margin-left:41.6666666667%}.grid-margin-x>.small-offset-5{margin-left:calc(41.6666666667% + 0.625rem)}.small-offset-6{margin-left:50%}.grid-margin-x>.small-offset-6{margin-left:calc(50% + 0.625rem)}.small-offset-7{margin-left:58.3333333333%}.grid-margin-x>.small-offset-7{margin-left:calc(58.3333333333% + 0.625rem)}.small-offset-8{margin-left:66.6666666667%}.grid-margin-x>.small-offset-8{margin-left:calc(66.6666666667% + 0.625rem)}.small-offset-9{margin-left:75%}.grid-margin-x>.small-offset-9{margin-left:calc(75% + 0.625rem)}.small-offset-10{margin-left:83.3333333333%}.grid-margin-x>.small-offset-10{margin-left:calc(83.3333333333% + 0.625rem)}.small-offset-11{margin-left:91.6666666667%}.grid-margin-x>.small-offset-11{margin-left:calc(91.6666666667% + 0.625rem)}@media print,screen and (min-width: 40em){.medium-offset-0{margin-left:0%}.grid-margin-x>.medium-offset-0{margin-left:calc(0% + 0.9375rem)}.medium-offset-1{margin-left:8.3333333333%}.grid-margin-x>.medium-offset-1{margin-left:calc(8.3333333333% + 0.9375rem)}.medium-offset-2{margin-left:16.6666666667%}.grid-margin-x>.medium-offset-2{margin-left:calc(16.6666666667% + 0.9375rem)}.medium-offset-3{margin-left:25%}.grid-margin-x>.medium-offset-3{margin-left:calc(25% + 0.9375rem)}.medium-offset-4{margin-left:33.3333333333%}.grid-margin-x>.medium-offset-4{margin-left:calc(33.3333333333% + 0.9375rem)}.medium-offset-5{margin-left:41.6666666667%}.grid-margin-x>.medium-offset-5{margin-left:calc(41.6666666667% + 0.9375rem)}.medium-offset-6{margin-left:50%}.grid-margin-x>.medium-offset-6{margin-left:calc(50% + 0.9375rem)}.medium-offset-7{margin-left:58.3333333333%}.grid-margin-x>.medium-offset-7{margin-left:calc(58.3333333333% + 0.9375rem)}.medium-offset-8{margin-left:66.6666666667%}.grid-margin-x>.medium-offset-8{margin-left:calc(66.6666666667% + 0.9375rem)}.medium-offset-9{margin-left:75%}.grid-margin-x>.medium-offset-9{margin-left:calc(75% + 0.9375rem)}.medium-offset-10{margin-left:83.3333333333%}.grid-margin-x>.medium-offset-10{margin-left:calc(83.3333333333% + 0.9375rem)}.medium-offset-11{margin-left:91.6666666667%}.grid-margin-x>.medium-offset-11{margin-left:calc(91.6666666667% + 0.9375rem)}}@media print,screen and (min-width: 64em){.large-offset-0{margin-left:0%}.grid-margin-x>.large-offset-0{margin-left:calc(0% + 0.9375rem)}.large-offset-1{margin-left:8.3333333333%}.grid-margin-x>.large-offset-1{margin-left:calc(8.3333333333% + 0.9375rem)}.large-offset-2{margin-left:16.6666666667%}.grid-margin-x>.large-offset-2{margin-left:calc(16.6666666667% + 0.9375rem)}.large-offset-3{margin-left:25%}.grid-margin-x>.large-offset-3{margin-left:calc(25% + 0.9375rem)}.large-offset-4{margin-left:33.3333333333%}.grid-margin-x>.large-offset-4{margin-left:calc(33.3333333333% + 0.9375rem)}.large-offset-5{margin-left:41.6666666667%}.grid-margin-x>.large-offset-5{margin-left:calc(41.6666666667% + 0.9375rem)}.large-offset-6{margin-left:50%}.grid-margin-x>.large-offset-6{margin-left:calc(50% + 0.9375rem)}.large-offset-7{margin-left:58.3333333333%}.grid-margin-x>.large-offset-7{margin-left:calc(58.3333333333% + 0.9375rem)}.large-offset-8{margin-left:66.6666666667%}.grid-margin-x>.large-offset-8{margin-left:calc(66.6666666667% + 0.9375rem)}.large-offset-9{margin-left:75%}.grid-margin-x>.large-offset-9{margin-left:calc(75% + 0.9375rem)}.large-offset-10{margin-left:83.3333333333%}.grid-margin-x>.large-offset-10{margin-left:calc(83.3333333333% + 0.9375rem)}.large-offset-11{margin-left:91.6666666667%}.grid-margin-x>.large-offset-11{margin-left:calc(91.6666666667% + 0.9375rem)}}.grid-y{display:flex;flex-flow:column nowrap}.grid-y>.cell{height:auto;max-height:none}.grid-y>.auto{height:auto}.grid-y>.shrink{height:auto}.grid-y>.small-shrink,.grid-y>.small-full,.grid-y>.small-1,.grid-y>.small-2,.grid-y>.small-3,.grid-y>.small-4,.grid-y>.small-5,.grid-y>.small-6,.grid-y>.small-7,.grid-y>.small-8,.grid-y>.small-9,.grid-y>.small-10,.grid-y>.small-11,.grid-y>.small-12{flex-basis:auto}@media print,screen and (min-width: 40em){.grid-y>.medium-shrink,.grid-y>.medium-full,.grid-y>.medium-1,.grid-y>.medium-2,.grid-y>.medium-3,.grid-y>.medium-4,.grid-y>.medium-5,.grid-y>.medium-6,.grid-y>.medium-7,.grid-y>.medium-8,.grid-y>.medium-9,.grid-y>.medium-10,.grid-y>.medium-11,.grid-y>.medium-12{flex-basis:auto}}@media print,screen and (min-width: 64em){.grid-y>.large-shrink,.grid-y>.large-full,.grid-y>.large-1,.grid-y>.large-2,.grid-y>.large-3,.grid-y>.large-4,.grid-y>.large-5,.grid-y>.large-6,.grid-y>.large-7,.grid-y>.large-8,.grid-y>.large-9,.grid-y>.large-10,.grid-y>.large-11,.grid-y>.large-12{flex-basis:auto}}.grid-y>.small-12,.grid-y>.small-11,.grid-y>.small-10,.grid-y>.small-9,.grid-y>.small-8,.grid-y>.small-7,.grid-y>.small-6,.grid-y>.small-5,.grid-y>.small-4,.grid-y>.small-3,.grid-y>.small-2,.grid-y>.small-1{flex:0 0 auto}.grid-y>.small-1{height:8.3333333333%}.grid-y>.small-2{height:16.6666666667%}.grid-y>.small-3{height:25%}.grid-y>.small-4{height:33.3333333333%}.grid-y>.small-5{height:41.6666666667%}.grid-y>.small-6{height:50%}.grid-y>.small-7{height:58.3333333333%}.grid-y>.small-8{height:66.6666666667%}.grid-y>.small-9{height:75%}.grid-y>.small-10{height:83.3333333333%}.grid-y>.small-11{height:91.6666666667%}.grid-y>.small-12{height:100%}@media print,screen and (min-width: 40em){.grid-y>.medium-auto{flex:1 1 0px;height:auto}.grid-y>.medium-12,.grid-y>.medium-11,.grid-y>.medium-10,.grid-y>.medium-9,.grid-y>.medium-8,.grid-y>.medium-7,.grid-y>.medium-6,.grid-y>.medium-5,.grid-y>.medium-4,.grid-y>.medium-3,.grid-y>.medium-2,.grid-y>.medium-1,.grid-y>.medium-shrink{flex:0 0 auto}.grid-y>.medium-shrink{height:auto}.grid-y>.medium-1{height:8.3333333333%}.grid-y>.medium-2{height:16.6666666667%}.grid-y>.medium-3{height:25%}.grid-y>.medium-4{height:33.3333333333%}.grid-y>.medium-5{height:41.6666666667%}.grid-y>.medium-6{height:50%}.grid-y>.medium-7{height:58.3333333333%}.grid-y>.medium-8{height:66.6666666667%}.grid-y>.medium-9{height:75%}.grid-y>.medium-10{height:83.3333333333%}.grid-y>.medium-11{height:91.6666666667%}.grid-y>.medium-12{height:100%}}@media print,screen and (min-width: 64em){.grid-y>.large-auto{flex:1 1 0px;height:auto}.grid-y>.large-12,.grid-y>.large-11,.grid-y>.large-10,.grid-y>.large-9,.grid-y>.large-8,.grid-y>.large-7,.grid-y>.large-6,.grid-y>.large-5,.grid-y>.large-4,.grid-y>.large-3,.grid-y>.large-2,.grid-y>.large-1,.grid-y>.large-shrink{flex:0 0 auto}.grid-y>.large-shrink{height:auto}.grid-y>.large-1{height:8.3333333333%}.grid-y>.large-2{height:16.6666666667%}.grid-y>.large-3{height:25%}.grid-y>.large-4{height:33.3333333333%}.grid-y>.large-5{height:41.6666666667%}.grid-y>.large-6{height:50%}.grid-y>.large-7{height:58.3333333333%}.grid-y>.large-8{height:66.6666666667%}.grid-y>.large-9{height:75%}.grid-y>.large-10{height:83.3333333333%}.grid-y>.large-11{height:91.6666666667%}.grid-y>.large-12{height:100%}}.grid-padding-y .grid-padding-y{margin-top:-0.625rem;margin-bottom:-0.625rem}@media print,screen and (min-width: 40em){.grid-padding-y .grid-padding-y{margin-top:-0.9375rem;margin-bottom:-0.9375rem}}.grid-padding-y>.cell{padding-top:0.625rem;padding-bottom:0.625rem}@media print,screen and (min-width: 40em){.grid-padding-y>.cell{padding-top:0.9375rem;padding-bottom:0.9375rem}}.grid-margin-y{margin-top:-0.625rem;margin-bottom:-0.625rem}@media print,screen and (min-width: 40em){.grid-margin-y{margin-top:-0.9375rem;margin-bottom:-0.9375rem}}.grid-margin-y>.cell{height:calc(100% - 1.25rem);margin-top:0.625rem;margin-bottom:0.625rem}@media print,screen and (min-width: 40em){.grid-margin-y>.cell{height:calc(100% - 1.875rem);margin-top:0.9375rem;margin-bottom:0.9375rem}}.grid-margin-y>.auto{height:auto}.grid-margin-y>.shrink{height:auto}.grid-margin-y>.small-1{height:calc(8.3333333333% - 1.25rem)}.grid-margin-y>.small-2{height:calc(16.6666666667% - 1.25rem)}.grid-margin-y>.small-3{height:calc(25% - 1.25rem)}.grid-margin-y>.small-4{height:calc(33.3333333333% - 1.25rem)}.grid-margin-y>.small-5{height:calc(41.6666666667% - 1.25rem)}.grid-margin-y>.small-6{height:calc(50% - 1.25rem)}.grid-margin-y>.small-7{height:calc(58.3333333333% - 1.25rem)}.grid-margin-y>.small-8{height:calc(66.6666666667% - 1.25rem)}.grid-margin-y>.small-9{height:calc(75% - 1.25rem)}.grid-margin-y>.small-10{height:calc(83.3333333333% - 1.25rem)}.grid-margin-y>.small-11{height:calc(91.6666666667% - 1.25rem)}.grid-margin-y>.small-12{height:calc(100% - 1.25rem)}@media print,screen and (min-width: 40em){.grid-margin-y>.auto{height:auto}.grid-margin-y>.shrink{height:auto}.grid-margin-y>.small-1{height:calc(8.3333333333% - 1.875rem)}.grid-margin-y>.small-2{height:calc(16.6666666667% - 1.875rem)}.grid-margin-y>.small-3{height:calc(25% - 1.875rem)}.grid-margin-y>.small-4{height:calc(33.3333333333% - 1.875rem)}.grid-margin-y>.small-5{height:calc(41.6666666667% - 1.875rem)}.grid-margin-y>.small-6{height:calc(50% - 1.875rem)}.grid-margin-y>.small-7{height:calc(58.3333333333% - 1.875rem)}.grid-margin-y>.small-8{height:calc(66.6666666667% - 1.875rem)}.grid-margin-y>.small-9{height:calc(75% - 1.875rem)}.grid-margin-y>.small-10{height:calc(83.3333333333% - 1.875rem)}.grid-margin-y>.small-11{height:calc(91.6666666667% - 1.875rem)}.grid-margin-y>.small-12{height:calc(100% - 1.875rem)}.grid-margin-y>.medium-auto{height:auto}.grid-margin-y>.medium-shrink{height:auto}.grid-margin-y>.medium-1{height:calc(8.3333333333% - 1.875rem)}.grid-margin-y>.medium-2{height:calc(16.6666666667% - 1.875rem)}.grid-margin-y>.medium-3{height:calc(25% - 1.875rem)}.grid-margin-y>.medium-4{height:calc(33.3333333333% - 1.875rem)}.grid-margin-y>.medium-5{height:calc(41.6666666667% - 1.875rem)}.grid-margin-y>.medium-6{height:calc(50% - 1.875rem)}.grid-margin-y>.medium-7{height:calc(58.3333333333% - 1.875rem)}.grid-margin-y>.medium-8{height:calc(66.6666666667% - 1.875rem)}.grid-margin-y>.medium-9{height:calc(75% - 1.875rem)}.grid-margin-y>.medium-10{height:calc(83.3333333333% - 1.875rem)}.grid-margin-y>.medium-11{height:calc(91.6666666667% - 1.875rem)}.grid-margin-y>.medium-12{height:calc(100% - 1.875rem)}}@media print,screen and (min-width: 64em){.grid-margin-y>.large-auto{height:auto}.grid-margin-y>.large-shrink{height:auto}.grid-margin-y>.large-1{height:calc(8.3333333333% - 1.875rem)}.grid-margin-y>.large-2{height:calc(16.6666666667% - 1.875rem)}.grid-margin-y>.large-3{height:calc(25% - 1.875rem)}.grid-margin-y>.large-4{height:calc(33.3333333333% - 1.875rem)}.grid-margin-y>.large-5{height:calc(41.6666666667% - 1.875rem)}.grid-margin-y>.large-6{height:calc(50% - 1.875rem)}.grid-margin-y>.large-7{height:calc(58.3333333333% - 1.875rem)}.grid-margin-y>.large-8{height:calc(66.6666666667% - 1.875rem)}.grid-margin-y>.large-9{height:calc(75% - 1.875rem)}.grid-margin-y>.large-10{height:calc(83.3333333333% - 1.875rem)}.grid-margin-y>.large-11{height:calc(91.6666666667% - 1.875rem)}.grid-margin-y>.large-12{height:calc(100% - 1.875rem)}}.grid-frame{overflow:hidden;position:relative;flex-wrap:nowrap;align-items:stretch;width:100vw}.cell .grid-frame{width:100%}.cell-block{overflow-x:auto;max-width:100%;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar}.cell-block-y{overflow-y:auto;max-height:100%;min-height:100%;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar}.cell-block-container{display:flex;flex-direction:column;max-height:100%}.cell-block-container>.grid-x{max-height:100%;flex-wrap:nowrap}@media print,screen and (min-width: 40em){.medium-grid-frame{overflow:hidden;position:relative;flex-wrap:nowrap;align-items:stretch;width:100vw}.cell .medium-grid-frame{width:100%}.medium-cell-block{overflow-x:auto;max-width:100%;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar}.medium-cell-block-container{display:flex;flex-direction:column;max-height:100%}.medium-cell-block-container>.grid-x{max-height:100%;flex-wrap:nowrap}.medium-cell-block-y{overflow-y:auto;max-height:100%;min-height:100%;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar}}@media print,screen and (min-width: 64em){.large-grid-frame{overflow:hidden;position:relative;flex-wrap:nowrap;align-items:stretch;width:100vw}.cell .large-grid-frame{width:100%}.large-cell-block{overflow-x:auto;max-width:100%;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar}.large-cell-block-container{display:flex;flex-direction:column;max-height:100%}.large-cell-block-container>.grid-x{max-height:100%;flex-wrap:nowrap}.large-cell-block-y{overflow-y:auto;max-height:100%;min-height:100%;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar}}.grid-y.grid-frame{width:auto;overflow:hidden;position:relative;flex-wrap:nowrap;align-items:stretch;height:100vh}@media print,screen and (min-width: 40em){.grid-y.medium-grid-frame{width:auto;overflow:hidden;position:relative;flex-wrap:nowrap;align-items:stretch;height:100vh}}@media print,screen and (min-width: 64em){.grid-y.large-grid-frame{width:auto;overflow:hidden;position:relative;flex-wrap:nowrap;align-items:stretch;height:100vh}}.cell .grid-y.grid-frame{height:100%}@media print,screen and (min-width: 40em){.cell .grid-y.medium-grid-frame{height:100%}}@media print,screen and (min-width: 64em){.cell .grid-y.large-grid-frame{height:100%}}.grid-margin-y{margin-top:-0.625rem;margin-bottom:-0.625rem}@media print,screen and (min-width: 40em){.grid-margin-y{margin-top:-0.9375rem;margin-bottom:-0.9375rem}}.grid-margin-y>.cell{height:calc(100% - 1.25rem);margin-top:0.625rem;margin-bottom:0.625rem}@media print,screen and (min-width: 40em){.grid-margin-y>.cell{height:calc(100% - 1.875rem);margin-top:0.9375rem;margin-bottom:0.9375rem}}.grid-margin-y>.auto{height:auto}.grid-margin-y>.shrink{height:auto}.grid-margin-y>.small-1{height:calc(8.3333333333% - 1.25rem)}.grid-margin-y>.small-2{height:calc(16.6666666667% - 1.25rem)}.grid-margin-y>.small-3{height:calc(25% - 1.25rem)}.grid-margin-y>.small-4{height:calc(33.3333333333% - 1.25rem)}.grid-margin-y>.small-5{height:calc(41.6666666667% - 1.25rem)}.grid-margin-y>.small-6{height:calc(50% - 1.25rem)}.grid-margin-y>.small-7{height:calc(58.3333333333% - 1.25rem)}.grid-margin-y>.small-8{height:calc(66.6666666667% - 1.25rem)}.grid-margin-y>.small-9{height:calc(75% - 1.25rem)}.grid-margin-y>.small-10{height:calc(83.3333333333% - 1.25rem)}.grid-margin-y>.small-11{height:calc(91.6666666667% - 1.25rem)}.grid-margin-y>.small-12{height:calc(100% - 1.25rem)}@media print,screen and (min-width: 40em){.grid-margin-y>.auto{height:auto}.grid-margin-y>.shrink{height:auto}.grid-margin-y>.small-1{height:calc(8.3333333333% - 1.875rem)}.grid-margin-y>.small-2{height:calc(16.6666666667% - 1.875rem)}.grid-margin-y>.small-3{height:calc(25% - 1.875rem)}.grid-margin-y>.small-4{height:calc(33.3333333333% - 1.875rem)}.grid-margin-y>.small-5{height:calc(41.6666666667% - 1.875rem)}.grid-margin-y>.small-6{height:calc(50% - 1.875rem)}.grid-margin-y>.small-7{height:calc(58.3333333333% - 1.875rem)}.grid-margin-y>.small-8{height:calc(66.6666666667% - 1.875rem)}.grid-margin-y>.small-9{height:calc(75% - 1.875rem)}.grid-margin-y>.small-10{height:calc(83.3333333333% - 1.875rem)}.grid-margin-y>.small-11{height:calc(91.6666666667% - 1.875rem)}.grid-margin-y>.small-12{height:calc(100% - 1.875rem)}.grid-margin-y>.medium-auto{height:auto}.grid-margin-y>.medium-shrink{height:auto}.grid-margin-y>.medium-1{height:calc(8.3333333333% - 1.875rem)}.grid-margin-y>.medium-2{height:calc(16.6666666667% - 1.875rem)}.grid-margin-y>.medium-3{height:calc(25% - 1.875rem)}.grid-margin-y>.medium-4{height:calc(33.3333333333% - 1.875rem)}.grid-margin-y>.medium-5{height:calc(41.6666666667% - 1.875rem)}.grid-margin-y>.medium-6{height:calc(50% - 1.875rem)}.grid-margin-y>.medium-7{height:calc(58.3333333333% - 1.875rem)}.grid-margin-y>.medium-8{height:calc(66.6666666667% - 1.875rem)}.grid-margin-y>.medium-9{height:calc(75% - 1.875rem)}.grid-margin-y>.medium-10{height:calc(83.3333333333% - 1.875rem)}.grid-margin-y>.medium-11{height:calc(91.6666666667% - 1.875rem)}.grid-margin-y>.medium-12{height:calc(100% - 1.875rem)}}@media print,screen and (min-width: 64em){.grid-margin-y>.large-auto{height:auto}.grid-margin-y>.large-shrink{height:auto}.grid-margin-y>.large-1{height:calc(8.3333333333% - 1.875rem)}.grid-margin-y>.large-2{height:calc(16.6666666667% - 1.875rem)}.grid-margin-y>.large-3{height:calc(25% - 1.875rem)}.grid-margin-y>.large-4{height:calc(33.3333333333% - 1.875rem)}.grid-margin-y>.large-5{height:calc(41.6666666667% - 1.875rem)}.grid-margin-y>.large-6{height:calc(50% - 1.875rem)}.grid-margin-y>.large-7{height:calc(58.3333333333% - 1.875rem)}.grid-margin-y>.large-8{height:calc(66.6666666667% - 1.875rem)}.grid-margin-y>.large-9{height:calc(75% - 1.875rem)}.grid-margin-y>.large-10{height:calc(83.3333333333% - 1.875rem)}.grid-margin-y>.large-11{height:calc(91.6666666667% - 1.875rem)}.grid-margin-y>.large-12{height:calc(100% - 1.875rem)}}.grid-frame.grid-margin-y{height:calc(100vh + 1.25rem)}@media print,screen and (min-width: 40em){.grid-frame.grid-margin-y{height:calc(100vh + 1.875rem)}}@media print,screen and (min-width: 64em){.grid-frame.grid-margin-y{height:calc(100vh + 1.875rem)}}@media print,screen and (min-width: 40em){.grid-margin-y.medium-grid-frame{height:calc(100vh + 1.875rem)}}@media print,screen and (min-width: 64em){.grid-margin-y.large-grid-frame{height:calc(100vh + 1.875rem)}}div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}p{margin-bottom:1rem;font-size:inherit;line-height:1.6;text-rendering:optimizeLegibility}em,i{font-style:italic;line-height:inherit}strong,b{font-weight:bold;line-height:inherit}small{font-size:80%;line-height:inherit}h1,.h1,h2,.h2,h3,.h3,h4,.h4,h5,.h5,h6,.h6{font-family:\\\"Helvetica Neue\\\",Helvetica,Roboto,Arial,sans-serif;font-style:normal;font-weight:normal;color:inherit;text-rendering:optimizeLegibility}h1 small,.h1 small,h2 small,.h2 small,h3 small,.h3 small,h4 small,.h4 small,h5 small,.h5 small,h6 small,.h6 small{line-height:0;color:#cacaca}h1,.h1{font-size:1.5rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}h2,.h2{font-size:1.25rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}h3,.h3{font-size:1.1875rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}h4,.h4{font-size:1.125rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}h5,.h5{font-size:1.0625rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}h6,.h6{font-size:1rem;line-height:1.4;margin-top:0;margin-bottom:.5rem}@media print,screen and (min-width: 40em){h1,.h1{font-size:3rem}h2,.h2{font-size:2.5rem}h3,.h3{font-size:1.9375rem}h4,.h4{font-size:1.5625rem}h5,.h5{font-size:1.25rem}h6,.h6{font-size:1rem}}a{line-height:inherit;color:#1779ba;text-decoration:none;cursor:pointer}a:hover,a:focus{color:#1468a0}a img{border:0}hr{clear:both;max-width:75rem;height:0;margin:1.25rem auto;border-top:0;border-right:0;border-bottom:1px solid #cacaca;border-left:0}ul,ol,dl{margin-bottom:1rem;list-style-position:outside;line-height:1.6}li{font-size:inherit}ul{margin-left:1.25rem;list-style-type:disc}ol{margin-left:1.25rem}ul ul,ul ol,ol ul,ol ol{margin-left:1.25rem;margin-bottom:0}dl{margin-bottom:1rem}dl dt{margin-bottom:.3rem;font-weight:bold}blockquote{margin:0 0 1rem;padding:.5625rem 1.25rem 0 1.1875rem;border-left:1px solid #cacaca}blockquote,blockquote p{line-height:1.6;color:#8a8a8a}abbr,abbr[title]{border-bottom:1px dotted #0a0a0a;cursor:help;text-decoration:none}figure{margin:0}kbd{margin:0;padding:.125rem .25rem 0;background-color:#e6e6e6;font-family:Consolas,\\\"Liberation Mono\\\",Courier,monospace;color:#0a0a0a}.subheader{margin-top:.2rem;margin-bottom:.5rem;font-weight:normal;line-height:1.4;color:#8a8a8a}.lead{font-size:125%;line-height:1.6}.stat{font-size:2.5rem;line-height:1}p+.stat{margin-top:-1rem}ul.no-bullet,ol.no-bullet{margin-left:0;list-style:none}.cite-block,cite{display:block;color:#8a8a8a;font-size:.8125rem}.cite-block:before,cite:before{content:\\\" \\\"}.code-inline,code{border:1px solid #cacaca;background-color:#e6e6e6;font-family:Consolas,\\\"Liberation Mono\\\",Courier,monospace;font-weight:normal;color:#0a0a0a;display:inline;max-width:100%;word-wrap:break-word;padding:.125rem .3125rem .0625rem}.code-block{border:1px solid #cacaca;background-color:#e6e6e6;font-family:Consolas,\\\"Liberation Mono\\\",Courier,monospace;font-weight:normal;color:#0a0a0a;display:block;overflow:auto;white-space:pre;padding:1rem;margin-bottom:1.5rem}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}@media print,screen and (min-width: 40em){.medium-text-left{text-align:left}.medium-text-right{text-align:right}.medium-text-center{text-align:center}.medium-text-justify{text-align:justify}}@media print,screen and (min-width: 64em){.large-text-left{text-align:left}.large-text-right{text-align:right}.large-text-center{text-align:center}.large-text-justify{text-align:justify}}.show-for-print{display:none !important}@media print{*{background:transparent !important;color:#000 !important;color-adjust:economy;box-shadow:none !important;text-shadow:none !important}.show-for-print{display:block !important}.hide-for-print{display:none !important}table.show-for-print{display:table !important}thead.show-for-print{display:table-header-group !important}tbody.show-for-print{display:table-row-group !important}tr.show-for-print{display:table-row !important}td.show-for-print{display:table-cell !important}th.show-for-print{display:table-cell !important}a,a:visited{text-decoration:underline}a[href]:after{content:\\\" (\\\" attr(href) \\\")\\\"}.ir a:after,a[href^=\\\"javascript:\\\"]:after,a[href^=\\\"#\\\"]:after{content:\\\"\\\"}abbr[title]:after{content:\\\" (\\\" attr(title) \\\")\\\"}pre,blockquote{border:1px solid #8a8a8a;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:.5cm}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}.print-break-inside{page-break-inside:auto}}.button{display:inline-block;vertical-align:middle;margin:0 0 1rem 0;padding:.85em 1em;border:1px solid transparent;border-radius:0;transition:background-color .25s ease-out,color .25s ease-out;font-family:inherit;font-size:.9rem;-webkit-appearance:none;line-height:1;text-align:center;cursor:pointer}[data-whatinput=mouse] .button{outline:0}.button.tiny{font-size:.6rem}.button.small{font-size:.75rem}.button.large{font-size:1.25rem}.button.expanded{display:block;width:100%;margin-right:0;margin-left:0}.button,.button.disabled,.button[disabled],.button.disabled:hover,.button[disabled]:hover,.button.disabled:focus,.button[disabled]:focus{background-color:#1779ba;color:#fefefe}.button:hover,.button:focus{background-color:#14679e;color:#fefefe}.button.primary,.button.primary.disabled,.button.primary[disabled],.button.primary.disabled:hover,.button.primary[disabled]:hover,.button.primary.disabled:focus,.button.primary[disabled]:focus{background-color:#1779ba;color:#fefefe}.button.primary:hover,.button.primary:focus{background-color:#126195;color:#fefefe}.button.secondary,.button.secondary.disabled,.button.secondary[disabled],.button.secondary.disabled:hover,.button.secondary[disabled]:hover,.button.secondary.disabled:focus,.button.secondary[disabled]:focus{background-color:#767676;color:#fefefe}.button.secondary:hover,.button.secondary:focus{background-color:#5e5e5e;color:#fefefe}.button.success,.button.success.disabled,.button.success[disabled],.button.success.disabled:hover,.button.success[disabled]:hover,.button.success.disabled:focus,.button.success[disabled]:focus{background-color:#3adb76;color:#0a0a0a}.button.success:hover,.button.success:focus{background-color:#22bb5b;color:#0a0a0a}.button.warning,.button.warning.disabled,.button.warning[disabled],.button.warning.disabled:hover,.button.warning[disabled]:hover,.button.warning.disabled:focus,.button.warning[disabled]:focus{background-color:#ffae00;color:#0a0a0a}.button.warning:hover,.button.warning:focus{background-color:#cc8b00;color:#0a0a0a}.button.alert,.button.alert.disabled,.button.alert[disabled],.button.alert.disabled:hover,.button.alert[disabled]:hover,.button.alert.disabled:focus,.button.alert[disabled]:focus{background-color:#cc4b37;color:#fefefe}.button.alert:hover,.button.alert:focus{background-color:#a53b2a;color:#fefefe}.button.hollow,.button.hollow:hover,.button.hollow:focus,.button.hollow.disabled,.button.hollow.disabled:hover,.button.hollow.disabled:focus,.button.hollow[disabled],.button.hollow[disabled]:hover,.button.hollow[disabled]:focus{background-color:transparent}.button.hollow,.button.hollow.disabled,.button.hollow[disabled],.button.hollow.disabled:hover,.button.hollow[disabled]:hover,.button.hollow.disabled:focus,.button.hollow[disabled]:focus{border:1px solid #1779ba;color:#1779ba}.button.hollow:hover,.button.hollow:focus{border-color:#0c3d5d;color:#0c3d5d}.button.hollow.primary,.button.hollow.primary.disabled,.button.hollow.primary[disabled],.button.hollow.primary.disabled:hover,.button.hollow.primary[disabled]:hover,.button.hollow.primary.disabled:focus,.button.hollow.primary[disabled]:focus{border:1px solid #1779ba;color:#1779ba}.button.hollow.primary:hover,.button.hollow.primary:focus{border-color:#0c3d5d;color:#0c3d5d}.button.hollow.secondary,.button.hollow.secondary.disabled,.button.hollow.secondary[disabled],.button.hollow.secondary.disabled:hover,.button.hollow.secondary[disabled]:hover,.button.hollow.secondary.disabled:focus,.button.hollow.secondary[disabled]:focus{border:1px solid #767676;color:#767676}.button.hollow.secondary:hover,.button.hollow.secondary:focus{border-color:#3b3b3b;color:#3b3b3b}.button.hollow.success,.button.hollow.success.disabled,.button.hollow.success[disabled],.button.hollow.success.disabled:hover,.button.hollow.success[disabled]:hover,.button.hollow.success.disabled:focus,.button.hollow.success[disabled]:focus{border:1px solid #3adb76;color:#3adb76}.button.hollow.success:hover,.button.hollow.success:focus{border-color:#157539;color:#157539}.button.hollow.warning,.button.hollow.warning.disabled,.button.hollow.warning[disabled],.button.hollow.warning.disabled:hover,.button.hollow.warning[disabled]:hover,.button.hollow.warning.disabled:focus,.button.hollow.warning[disabled]:focus{border:1px solid #ffae00;color:#ffae00}.button.hollow.warning:hover,.button.hollow.warning:focus{border-color:#805700;color:#805700}.button.hollow.alert,.button.hollow.alert.disabled,.button.hollow.alert[disabled],.button.hollow.alert.disabled:hover,.button.hollow.alert[disabled]:hover,.button.hollow.alert.disabled:focus,.button.hollow.alert[disabled]:focus{border:1px solid #cc4b37;color:#cc4b37}.button.hollow.alert:hover,.button.hollow.alert:focus{border-color:#67251a;color:#67251a}.button.clear,.button.clear:hover,.button.clear:focus,.button.clear.disabled,.button.clear.disabled:hover,.button.clear.disabled:focus,.button.clear[disabled],.button.clear[disabled]:hover,.button.clear[disabled]:focus{border-color:transparent;background-color:transparent}.button.clear,.button.clear.disabled,.button.clear[disabled],.button.clear.disabled:hover,.button.clear[disabled]:hover,.button.clear.disabled:focus,.button.clear[disabled]:focus{color:#1779ba}.button.clear:hover,.button.clear:focus{color:#0c3d5d}.button.clear.primary,.button.clear.primary.disabled,.button.clear.primary[disabled],.button.clear.primary.disabled:hover,.button.clear.primary[disabled]:hover,.button.clear.primary.disabled:focus,.button.clear.primary[disabled]:focus{color:#1779ba}.button.clear.primary:hover,.button.clear.primary:focus{color:#0c3d5d}.button.clear.secondary,.button.clear.secondary.disabled,.button.clear.secondary[disabled],.button.clear.secondary.disabled:hover,.button.clear.secondary[disabled]:hover,.button.clear.secondary.disabled:focus,.button.clear.secondary[disabled]:focus{color:#767676}.button.clear.secondary:hover,.button.clear.secondary:focus{color:#3b3b3b}.button.clear.success,.button.clear.success.disabled,.button.clear.success[disabled],.button.clear.success.disabled:hover,.button.clear.success[disabled]:hover,.button.clear.success.disabled:focus,.button.clear.success[disabled]:focus{color:#3adb76}.button.clear.success:hover,.button.clear.success:focus{color:#157539}.button.clear.warning,.button.clear.warning.disabled,.button.clear.warning[disabled],.button.clear.warning.disabled:hover,.button.clear.warning[disabled]:hover,.button.clear.warning.disabled:focus,.button.clear.warning[disabled]:focus{color:#ffae00}.button.clear.warning:hover,.button.clear.warning:focus{color:#805700}.button.clear.alert,.button.clear.alert.disabled,.button.clear.alert[disabled],.button.clear.alert.disabled:hover,.button.clear.alert[disabled]:hover,.button.clear.alert.disabled:focus,.button.clear.alert[disabled]:focus{color:#cc4b37}.button.clear.alert:hover,.button.clear.alert:focus{color:#67251a}.button.disabled,.button[disabled]{opacity:.25;cursor:not-allowed}.button.dropdown::after{display:block;width:0;height:0;border:inset .4em;content:\\\"\\\";border-bottom-width:0;border-top-style:solid;border-color:#fefefe transparent transparent;position:relative;top:.4em;display:inline-block;float:right;margin-left:1em}.button.dropdown.hollow::after,.button.dropdown.clear::after{border-top-color:#1779ba}.button.dropdown.hollow.primary::after,.button.dropdown.clear.primary::after{border-top-color:#1779ba}.button.dropdown.hollow.secondary::after,.button.dropdown.clear.secondary::after{border-top-color:#767676}.button.dropdown.hollow.success::after,.button.dropdown.clear.success::after{border-top-color:#3adb76}.button.dropdown.hollow.warning::after,.button.dropdown.clear.warning::after{border-top-color:#ffae00}.button.dropdown.hollow.alert::after,.button.dropdown.clear.alert::after{border-top-color:#cc4b37}.button.arrow-only::after{top:-0.1em;float:none;margin-left:0}a.button:hover,a.button:focus{text-decoration:none}[type=text],[type=password],[type=date],[type=datetime],[type=datetime-local],[type=month],[type=week],[type=email],[type=number],[type=search],[type=tel],[type=time],[type=url],[type=color],textarea{display:block;box-sizing:border-box;width:100%;height:2.4375rem;margin:0 0 1rem;padding:.5rem;border:1px solid #cacaca;border-radius:0;background-color:#fefefe;box-shadow:inset 0 1px 2px rgba(10,10,10,.1);font-family:inherit;font-size:1rem;font-weight:normal;line-height:1.5;color:#0a0a0a;transition:box-shadow .5s,border-color .25s ease-in-out;appearance:none}[type=text]:focus,[type=password]:focus,[type=date]:focus,[type=datetime]:focus,[type=datetime-local]:focus,[type=month]:focus,[type=week]:focus,[type=email]:focus,[type=number]:focus,[type=search]:focus,[type=tel]:focus,[type=time]:focus,[type=url]:focus,[type=color]:focus,textarea:focus{outline:none;border:1px solid #8a8a8a;background-color:#fefefe;box-shadow:0 0 5px #cacaca;transition:box-shadow .5s,border-color .25s ease-in-out}textarea{max-width:100%}textarea[rows]{height:auto}input:disabled,input[readonly],textarea:disabled,textarea[readonly]{background-color:#e6e6e6;cursor:not-allowed}[type=submit],[type=button]{appearance:none;border-radius:0}input[type=search]{box-sizing:border-box}::placeholder{color:#cacaca}[type=file],[type=checkbox],[type=radio]{margin:0 0 1rem}[type=checkbox]+label,[type=radio]+label{display:inline-block;vertical-align:baseline;margin-left:.5rem;margin-right:1rem;margin-bottom:0}[type=checkbox]+label[for],[type=radio]+label[for]{cursor:pointer}label>[type=checkbox],label>[type=radio]{margin-right:.5rem}[type=file]{width:100%}label{display:block;margin:0;font-size:.875rem;font-weight:normal;line-height:1.8;color:#0a0a0a}label.middle{margin:0 0 1rem;padding:.5625rem 0}.help-text{margin-top:-0.5rem;font-size:.8125rem;font-style:italic;color:#0a0a0a}.input-group{display:flex;width:100%;margin-bottom:1rem;align-items:stretch}.input-group>:first-child,.input-group>:first-child.input-group-button>*{border-radius:0 0 0 0}.input-group>:last-child,.input-group>:last-child.input-group-button>*{border-radius:0 0 0 0}.input-group-button a,.input-group-button input,.input-group-button button,.input-group-button label,.input-group-button,.input-group-field,.input-group-label{margin:0;white-space:nowrap}.input-group-label{padding:0 1rem;border:1px solid #cacaca;background:#e6e6e6;color:#0a0a0a;text-align:center;white-space:nowrap;display:flex;flex:0 0 auto;align-items:center}.input-group-label:first-child{border-right:0}.input-group-label:last-child{border-left:0}.input-group-field{border-radius:0;flex:1 1 0px;min-width:0}.input-group-button{padding-top:0;padding-bottom:0;text-align:center;display:flex;flex:0 0 auto}.input-group-button a,.input-group-button input,.input-group-button button,.input-group-button label{align-self:stretch;height:auto;padding-top:0;padding-bottom:0;font-size:1rem}fieldset{margin:0;padding:0;border:0}legend{max-width:100%;margin-bottom:.5rem}.fieldset{margin:1.125rem 0;padding:1.25rem;border:1px solid #cacaca}.fieldset legend{margin:0;margin-left:-0.1875rem;padding:0 .1875rem}select{height:2.4375rem;margin:0 0 1rem;padding:.5rem;appearance:none;border:1px solid #cacaca;border-radius:0;background-color:#fefefe;font-family:inherit;font-size:1rem;font-weight:normal;line-height:1.5;color:#0a0a0a;background-image:url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='32' height='24' viewBox='0 0 32 24'><polygon points='0,0 32,0 16,24' style='fill: rgb%28138, 138, 138%29'></polygon></svg>\\\");background-origin:content-box;background-position:right -1rem center;background-repeat:no-repeat;background-size:9px 6px;padding-right:1.5rem;transition:box-shadow .5s,border-color .25s ease-in-out}@media screen and (min-width: 0\\\\0 ){select{background-image:url(\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAYCAYAAACbU/80AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIpJREFUeNrEkckNgDAMBBfRkEt0ObRBBdsGXUDgmQfK4XhH2m8czQAAy27R3tsw4Qfe2x8uOO6oYLb6GlOor3GF+swURAOmUJ+RwtEJs9WvTGEYxBXqI1MQAZhCfUQKRzDMVj+TwrAIV6jvSUEkYAr1LSkcyTBb/V+KYfX7xAeusq3sLDtGH3kEGACPWIflNZfhRQAAAABJRU5ErkJggg==\\\")}}select:focus{outline:none;border:1px solid #8a8a8a;background-color:#fefefe;box-shadow:0 0 5px #cacaca;transition:box-shadow .5s,border-color .25s ease-in-out}select:disabled{background-color:#e6e6e6;cursor:not-allowed}select::-ms-expand{display:none}select[multiple]{height:auto;background-image:none}select:not([multiple]){padding-top:0;padding-bottom:0}.is-invalid-input:not(:focus){border-color:#cc4b37;background-color:#f9ecea}.is-invalid-input:not(:focus)::placeholder{color:#cc4b37}.is-invalid-label{color:#cc4b37}.form-error{display:none;margin-top:-0.5rem;margin-bottom:1rem;font-size:.75rem;font-weight:bold;color:#cc4b37}.form-error.is-visible{display:block}table{border-collapse:collapse;width:100%;margin-bottom:1rem;border-radius:0}thead,tbody,tfoot{border:1px solid #f1f1f1;background-color:#fefefe}caption{padding:.5rem .625rem .625rem;font-weight:bold}thead{background:#f8f8f8;color:#0a0a0a}tfoot{background:#f1f1f1;color:#0a0a0a}thead tr,tfoot tr{background:transparent}thead th,thead td,tfoot th,tfoot td{padding:.5rem .625rem .625rem;font-weight:bold;text-align:left}tbody th,tbody td{padding:.5rem .625rem .625rem}tbody tr:nth-child(even){border-bottom:0;background-color:#f1f1f1}table.unstriped tbody{background-color:#fefefe}table.unstriped tbody tr{border-bottom:0;border-bottom:1px solid #f1f1f1;background-color:#fefefe}@media print,screen and (max-width: 63.99875em){table.stack thead{display:none}table.stack tfoot{display:none}table.stack tr,table.stack th,table.stack td{display:block}table.stack td{border-top:0}}table.scroll{display:block;width:100%;overflow-x:auto}table.hover thead tr:hover{background-color:#f3f3f3}table.hover tfoot tr:hover{background-color:#ececec}table.hover tbody tr:hover{background-color:#f9f9f9}table.hover:not(.unstriped) tr:nth-of-type(even):hover{background-color:#ececec}.table-scroll{overflow-x:auto}.hide{display:none !important}.invisible{visibility:hidden}@media print,screen and (max-width: 39.99875em){.hide-for-small-only{display:none !important}}@media screen and (max-width: 0em),screen and (min-width: 40em){.show-for-small-only{display:none !important}}@media print,screen and (min-width: 40em){.hide-for-medium{display:none !important}}@media screen and (max-width: 39.99875em){.show-for-medium{display:none !important}}@media print,screen and (min-width: 40em)and (max-width: 63.99875em){.hide-for-medium-only{display:none !important}}@media screen and (max-width: 39.99875em),screen and (min-width: 64em){.show-for-medium-only{display:none !important}}@media print,screen and (min-width: 64em){.hide-for-large{display:none !important}}@media screen and (max-width: 63.99875em){.show-for-large{display:none !important}}@media print,screen and (min-width: 64em)and (max-width: 74.99875em){.hide-for-large-only{display:none !important}}@media screen and (max-width: 63.99875em),screen and (min-width: 75em){.show-for-large-only{display:none !important}}.show-for-sr,.show-on-focus{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important}.show-on-focus:active,.show-on-focus:focus{position:static !important;width:auto !important;height:auto !important;overflow:visible !important;clip:auto !important;white-space:normal !important}.show-for-landscape,.hide-for-portrait{display:block !important}@media screen and (orientation: landscape){.show-for-landscape,.hide-for-portrait{display:block !important}}@media screen and (orientation: portrait){.show-for-landscape,.hide-for-portrait{display:none !important}}.hide-for-landscape,.show-for-portrait{display:none !important}@media screen and (orientation: landscape){.hide-for-landscape,.show-for-portrait{display:none !important}}@media screen and (orientation: portrait){.hide-for-landscape,.show-for-portrait{display:block !important}}.Editor{background-color:#7b7b7b;color:#111;overflow:hidden}.full_height_container{height:100%}.full_page_height{height:100vh}.button{margin-bottom:0px}select.select{background-image:none}.disable-select{user-select:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none}.cursor_col_resize{cursor:col-resize}\", \"\"]);\n// Exports\nmodule.exports = exports;\n"],"sourceRoot":""}